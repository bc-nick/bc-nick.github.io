"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonpCheckout"] = self["webpackJsonpCheckout"] || []).push([["checkout-sdk-js_dist_esm_integrations_braintree_js"],{

/***/ "../checkout-sdk-js/dist/esm/integrations/braintree.js":
/*!*************************************************************!*\
  !*** ../checkout-sdk-js/dist/esm/integrations/braintree.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createBraintreeAchPaymentStrategy: () => (/* binding */ K),\n/* harmony export */   createBraintreeCreditCardPaymentStrategy: () => (/* binding */ et),\n/* harmony export */   createBraintreeFastlaneCustomerStrategy: () => (/* binding */ lt),\n/* harmony export */   createBraintreeFastlanePaymentStrategy: () => (/* binding */ je),\n/* harmony export */   createBraintreeLocalMethodsPaymentStrategy: () => (/* binding */ ze),\n/* harmony export */   createBraintreePaypalButtonStrategy: () => (/* binding */ bt),\n/* harmony export */   createBraintreePaypalCreditButtonStrategy: () => (/* binding */ St),\n/* harmony export */   createBraintreePaypalCreditCustomerStrategy: () => (/* binding */ at),\n/* harmony export */   createBraintreePaypalCustomerStrategy: () => (/* binding */ nt),\n/* harmony export */   createBraintreePaypalPaymentStrategy: () => (/* binding */ be),\n/* harmony export */   createBraintreeVenmoButtonStrategy: () => (/* binding */ Nt),\n/* harmony export */   createBraintreeVenmoPaymentStrategy: () => (/* binding */ $e),\n/* harmony export */   createBraintreeVisaCheckoutButtonStrategy: () => (/* binding */ Ot),\n/* harmony export */   createBraintreeVisaCheckoutCustomerStrategy: () => (/* binding */ yt),\n/* harmony export */   createBraintreeVisaCheckoutPaymentStrategy: () => (/* binding */ He)\n/* harmony export */ });\n/* harmony import */ var _bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @bigcommerce/script-loader */ \"../checkout-sdk-js/node_modules/@bigcommerce/script-loader/lib/index.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash */ \"../checkout-sdk-js/node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _braintree_browser_detection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @braintree/browser-detection */ \"../checkout-sdk-js/node_modules/@braintree/browser-detection/dist/browser-detection.js\");\n/* harmony import */ var _bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @bigcommerce/request-sender */ \"../checkout-sdk-js/node_modules/@bigcommerce/request-sender/esm/index.js\");\n/* harmony import */ var _bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @bigcommerce/form-poster */ \"../checkout-sdk-js/node_modules/@bigcommerce/form-poster/lib/index.js\");\nvar h,y,m;class p extends Error{constructor(e){var t;super(e||\"An unexpected error has occurred.\"),this.name=\"StandardError\",this.type=\"standard\",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,\"function\"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class g extends p{constructor(e){super(e||\"Unable to proceed because the client library of a payment method is not loaded or ready to be used.\"),this.name=\"PaymentMethodClientUnavailableError\",this.type=\"payment_method_client_unavailable\"}}!function(e){e.Sandbox=\"sandbox\",e.Production=\"production\"}(h||(h={})),function(e){e.Client=\"client\",e.DataCollector=\"dataCollector\",e.Fastlane=\"fastlane\",e.GooglePayment=\"googlePayment\",e.HostedFields=\"hostedFields\",e.LocalPayment=\"localPayment\",e.Paypal=\"paypal\",e.PaypalCheckout=\"paypalCheckout\",e.ThreeDSecure=\"threeDSecure\",e.UsBankAccount=\"usBankAccount\",e.Venmo=\"venmo\",e.VisaCheckout=\"visaCheckout\"}(y||(y={})),function(e){e.CardCode=\"cardCode\",e.CardCodeVerification=\"cardCodeVerification\",e.CardExpiry=\"cardExpiry\",e.CardName=\"cardName\",e.CardNumber=\"cardNumber\",e.CardNumberVerification=\"cardNumberVerification\"}(m||(m={}));const v=\"3.128.0\",f=\"3.123.2\",b=\"3.106.0\",w={[b]:{[y.Client]:\"sha384-26BXDNnJI23JYRyFBj4xe4sVNrUSSiSSu11kxVXNM/vEPONm4LuL00w6ZaTgQewt\",[y.PaypalCheckout]:\"sha384-B+vzbZwnQtzWBthpkT4TXKUibO65tyeK7eCxSvpblgprTep2+IAXB2Cxxjrn710O\",[y.Paypal]:\"sha384-uyAGL1/3+XJAHnGoNy4eCoXdzJ4f7Ilzp+6w9PNnEjs6DCCz9WMyJjMN1gzc78U+\",[y.LocalPayment]:\"sha384-LIvOEMkIVEwVuYBdVOQc1AC5YbGGlwyfUheS0ACK218D2STuVYQlZ4FyEPowAEfT\",[y.DataCollector]:\"sha384-1bo9JDz+Kscthc085cCKWur8CLwUoBpoNyxsDi7932mCl0zFq3A5mv+FQLw9GHpV\",[y.UsBankAccount]:\"sha384-xmHBVaU+w74V+OebD3AaPONFxHUGMf+QRs8G/JxVPXNNP7MDa2jL0ICWHIe2tTfJ\",[y.GooglePayment]:\"sha384-WKDJl8mqoP82qZpMGH6AbZxnvXnSW8ILV4M64CyMLiugGMwu7LyP89wjCkHqsiBe\",[y.ThreeDSecure]:\"sha384-VQUlpGHzsGvs5XeiGFip7EXRsvoHWEXDVmgCacfbyieZI9mdBOqq3NSoyo28OCOB\",[y.VisaCheckout]:\"sha384-yx7mADfzTN0T43Q6rlH49LIg1EJ0iUZgBp/EczX9LXsUGkySgxrD+nWHQRBkyfoT\",[y.Venmo]:\"sha384-QX4rPjoj1ZDhuG0aSyKs56lEKDqTMTcjYxUHY1SzO5VZDsqIE2NTkqot7KNSCyov\",[y.HostedFields]:\"sha384-VvYBACfSu0Cr/J32uKmxG7AXcNOJE1AzIIL3kbikyS7YKp5fz5Is+NzNP/lyauNy\",[y.Fastlane]:\"sha384-9oGsZMRZwpGtDEDYa/dFt76dECqj1xAni9gIKgc3KfMIiRnR73nEeeUDLiBzxhFa\"},[f]:{[y.Client]:\"sha384-o+nbQGcwNNxIBeXeu3+XmbSq+Cg8R3EN3N0l5hXCgMMU2RGY0t1z0LroSEIAbfAO\",[y.PaypalCheckout]:\"sha384-WrfbWPBS4mH86GAoycPSgiH8hQ8KH7A67C93Hjhunv/xhNk2YpBn3wbFA4Fhg9U/\",[y.Paypal]:\"sha384-VF389nvvrRUgDsTXMxTYORDtVegB9IQa3Cxr//DyJnLYnz8/X8VCzEvck2c+Megt\",[y.LocalPayment]:\"sha384-tZKx2rEQbfmZpoPSY5VPmJEhaq4X75dLvwHMs3VE9U+C8lPyw+hWTIL1+GPvWCIH\",[y.DataCollector]:\"sha384-E6k3wOpP7syCDDwaRDLF06942Y00NkbwJvWi2OQXwwKzGwG5fd3E7RFUvCCecfvO\",[y.UsBankAccount]:\"sha384-258FON8LZGG0W9Qaz4Jij83pZHu30YnKjJA7gNulLBh6CclkucgF+tHDQuYFRYfW\",[y.GooglePayment]:\"sha384-taJ2p/0+n0VH328POAoBiuEbL3tnHUTE9S42hK1V+Txs3X+QYjZOyKW35JgHRFfO\",[y.ThreeDSecure]:\"sha384-+NSZH4Zj3sO5bdWvPKhU5N16QDxeueTVTnUVeleeESkhLSaz4Ob1hh/5myecc9Ym\",[y.VisaCheckout]:\"sha384-66DiBjghxk1OmBj8aksN8gbQ+CwoQcx1vPfiXUN08g1iQVM+BwewF0p7toM3i7SS\",[y.Venmo]:\"sha384-B5UwY42kE4RoLoWbQ7YpqosUlUad2/DlGWiw0HhoZbSPk30CQAaSA10ohyLDTkDU\",[y.HostedFields]:\"sha384-Aw9EesSaUeWxe36PqEHiOyOyOq8M6CIb1gw7/yHNVPRzGtFXXcd2OQ8qXrIlOj2P\",[y.Fastlane]:\"sha384-rhBL1hpZ71JqG+2TsT0Dih47mbjx8cjJCpeZjk9tw3df1gFMKfCTmMyZunhr7H4Y\"},[v]:{[y.Client]:\"sha384-0WNxksIpRP+fYZiIdr12g6DBUQfLDzYCQJZtR/C8KkcwSGhPHfcFp3tTaGcMyFTq\",[y.PaypalCheckout]:\"sha384-lWM1jk4BOxoDNV6Kop7tVNvQgINlmEVz0c/OwM+HNHK3QC8xqwd54Ovrt2QRDTjh\",[y.Paypal]:\"sha384-fXUmVxC2EMZBDXZ7eTHSTL/LFBrHej/MSXT/vTBXvra4lzgLNGvREAp+x0GYObuH\",[y.LocalPayment]:\"sha384-pha1xGuGSkmZH5x9aqHvRaO4xLea7rmQ/79PFj9zxNzxuFcOWZg7gOP7FibygOEC\",[y.DataCollector]:\"sha384-Q6PI2F9eekWbAxhroybl+aEcvqhdowN/EQlGwBUyJOzPFn9982u9xl6SU6XfGKzc\",[y.UsBankAccount]:\"sha384-W3RLQSKJL1tQ3+Y7mP6tmkamtZ8bV4Yw/XxL9Jj5JtXHraD8loMF8hAIG5m2zK7F\",[y.GooglePayment]:\"sha384-TITQMsFWA3elDNGP2mWz2oKBo4qjt+TlqzovcaPoeBiAh/wPBi6nae50ADdgU1/i\",[y.ThreeDSecure]:\"sha384-YiycYN89ZlL/Evcaq4y1ajW1mhd7JYfZBDuOwHtIn4/Jnm20GL+/XCM+zYAwWD8D\",[y.VisaCheckout]:\"sha384-/OdaTv9qrkKzjObtUe6yzfDhHozFW/+uXlrSl736sOZRJpjGQETvpYXqMFFg69xv\",[y.Venmo]:\"sha384-dA+ojdW9vbJS4JavcXyOs9d5uZHJg5dNtYupoPSH2zsXIiYDVS5amLb/u8qmQ6oz\",[y.HostedFields]:\"sha384-31ZkS58+iaWsW06ftW52zzVZFp43WPd7pNYRiddYynSNg6Oh7WGbSFGorAUH6T1z\",[y.Fastlane]:\"sha384-jlbrwNvL3HvLAUCtLSmrnQ2GH1udCUrRS/bVmReAS5fuIVvcW8Pko/Gkg82tlgtr\"}};var C,S,P,I,O,k,E,T,A=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class z{constructor(e,t,i){this.scriptLoader=e,this.braintreeHostWindow=t,this.braintreeSDKVersionManager=i}loadClient(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.Client,\"client.min.js\")})}loadFastlane(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.Fastlane,\"fastlane.min.js\")})}loadPaypalCheckout(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.PaypalCheckout,\"paypal-checkout.min.js\")})}loadPaypal(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.Paypal,\"paypal.min.js\")})}loadLocalPayment(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.LocalPayment,\"local-payment.min.js\")})}loadDataCollector(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.DataCollector,\"data-collector.min.js\")})}loadUsBankAccount(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.UsBankAccount,\"us-bank-account.min.js\")})}loadGooglePayment(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.GooglePayment,\"google-payment.min.js\")})}load3DS(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.ThreeDSecure,\"three-d-secure.min.js\")})}loadVisaCheckout(){return this.loadBraintreeModuleOrThrow(y.VisaCheckout,\"visa-checkout.min.js\")}loadVenmoCheckout(){return this.loadBraintreeModuleOrThrow(y.Venmo,\"venmo.min.js\")}loadHostedFields(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.HostedFields,\"hosted-fields.min.js\")})}loadVisaCheckoutSdk(e){return A(this,void 0,void 0,function*(){if(this.braintreeHostWindow.V)return this.braintreeHostWindow.V;const t=e?\"sha384-0eu1s1GtqzXlL9DtLgmwzC5WWlEH/ADRM0n38cVQkvtT+W/gey96rcb1LwuUOPDm\":\"sha384-1f1csvP3ZFxg4dILH1GaY4LHlZ0oX7Rk83rxmLlwbnIi4TM0NYzXoev1VoEiVDS6\";return this.scriptLoader.loadScript(`//${e?\"sandbox-\":\"\"}assets.secure.checkout.visa.com/checkout-widget/resources/js/integration/v1/sdk.js`,{async:!0,attributes:{integrity:t,crossorigin:\"anonymous\"}}).then(()=>{if(!this.braintreeHostWindow.V)throw new g;return this.braintreeHostWindow.V})})}loadBraintreeModuleOrThrow(e,t){return A(this,void 0,void 0,function*(){let i=this.getBraintreeModule(e);if(i)return i;const n=this.braintreeSDKVersionManager.getSDKVersion(),r=`//js.braintreegateway.com/web/${n}/js/${t}`,o=n in w?this.getIntegrityValuesByModuleName(e,n):void 0;if(yield this.scriptLoader.loadScript(r,o?{async:!0,attributes:{integrity:o,crossorigin:\"anonymous\"}}:void 0),i=this.getBraintreeModule(e),!i)throw new g;return i})}getBraintreeModule(e){var t;return null===(t=this.braintreeHostWindow.braintree)||void 0===t?void 0:t[e]}getIntegrityValuesByModuleName(e,t){const i=w[t][e];if(!i)throw new Error(\"Unexpected fileName value\");return i}}class N extends p{constructor(e){super(e||\"Unsupported browser error\"),this.name=\"UnsupportedBrowserError\",this.type=\"unsupported_browser\"}}!function(e){e[e.CheckoutButtonNotInitialized=0]=\"CheckoutButtonNotInitialized\",e[e.CustomerNotInitialized=1]=\"CustomerNotInitialized\",e[e.PaymentNotInitialized=2]=\"PaymentNotInitialized\",e[e.ShippingNotInitialized=3]=\"ShippingNotInitialized\",e[e.SpamProtectionNotInitialized=4]=\"SpamProtectionNotInitialized\"}(C||(C={}));class M extends p{constructor(e){super(function(e){switch(e){case C.CustomerNotInitialized:return\"Unable to proceed because the customer step of checkout has not been initialized.\";case C.PaymentNotInitialized:return\"Unable to proceed because the payment step of checkout has not been initialized.\";case C.ShippingNotInitialized:return\"Unable to proceed because the shipping step of checkout has not been initialized.\";case C.SpamProtectionNotInitialized:return\"Unable to proceed because the checkout spam protection has not been initialized.\";default:return\"Unable to proceed because the required component has not been initialized.\"}}(e)),this.subtype=e,this.name=\"NotInitializedError\",this.type=\"not_initialized\"}}function D(e){return Boolean(\"object\"==typeof e&&null!==e&&(\"type\"in e||\"message\"in e||\"code\"in e))}!function(e){e.ESTIMATED=\"ESTIMATED\",e.FINAL=\"FINAL\",e.NOT_CURRENTLY_KNOWN=\"NOT_CURRENTLY_KNOWN\"}(S||(S={})),function(e){e.Completed=\"COMPLETED\",e.Pending=\"PENDING\",e.Failed=\"FAILED\"}(P||(P={})),function(e){e.TRUSTLY=\"trustly\"}(I||(I={})),function(e){e.SUCCEEDED=\"succeeded\",e.FAILED=\"failed\",e.CANCELED=\"cancelled\",e.UNRECOGNIZED=\"unrecognized\"}(O||(O={})),function(e){e.Customer=\"CUSTOMER\",e.Merchant=\"MERCHANT\",e.Network=\"NETWORK\",e.Internal=\"INTERNAL\",e.Unknown=\"UNKNOWN\"}(k||(k={})),function(e){e.KountNotEnabled=\"DATA_COLLECTOR_KOUNT_NOT_ENABLED\"}(E||(E={})),function(e){e.Visa=\"visa\",e.Mastercard=\"mastercard\",e.AmericanExpress=\"american-express\",e.DinersClub=\"diners-club\",e.Discover=\"discover\",e.Jcb=\"jcb\",e.UnionPay=\"union-pay\",e.Maestro=\"maestro\",e.Elo=\"elo\",e.Mir=\"mir\",e.Hiper=\"hiper\",e.Hipercard=\"hipercard\"}(T||(T={}));var _=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class B{constructor(e){this.braintreeScriptLoader=e}initialize(e){this.setClientToken(e)}deinitialize(){return _(this,void 0,void 0,function*(){yield this.teardownModule(this.dataCollector),this.dataCollector=void 0})}getClient(){return _(this,void 0,void 0,function*(){if(!this.client){const e=this.getClientTokenOrThrow(),t=yield this.braintreeScriptLoader.loadClient();this.client=yield t.create({authorization:e})}return this.client})}getDataCollectorOrThrow(e){return _(this,void 0,void 0,function*(){const t={deviceData:void 0,teardown:()=>Promise.resolve()};if(!this.dataCollector)try{const t=yield this.getClient(),i=yield this.braintreeScriptLoader.loadDataCollector(),n=Object.assign({client:t,kount:!0},e);this.dataCollector=yield i.create(n)}catch(e){if(D(e)&&e.code===E.KountNotEnabled)return t;throw e}return this.dataCollector})}getBraintreeGooglePayment(){return _(this,void 0,void 0,function*(){if(!this.googlePayment){const[e,t]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.loadGooglePayment()]);this.googlePayment=yield t.create({client:e})}return this.googlePayment})}getBraintreeThreeDS(){return _(this,void 0,void 0,function*(){if(!this.threeDS){const[e,t]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.load3DS()]);this.threeDS=yield t.create({client:e,version:2})}return this.threeDS})}getBraintreeLocalPayment(e){return _(this,void 0,void 0,function*(){if(!this.braintreeLocalPayment){const[t,i]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.loadLocalPayment()]);this.braintreeLocalPayment=yield new Promise((n,r)=>{i.create({client:t,merchantAccountId:e},(e,t)=>{e&&r(e),n(t)})})}return this.braintreeLocalPayment})}getUsBankAccount(){return _(this,void 0,void 0,function*(){if(!this.usBankAccount){const e=yield this.getClient(),t=yield this.braintreeScriptLoader.loadUsBankAccount();this.usBankAccount=yield t.create({client:e})}return this.usBankAccount})}getBraintreeVisaCheckout(){return this.visaCheckout||(this.visaCheckout=Promise.all([this.getClient(),this.braintreeScriptLoader.loadVisaCheckout()]).then(([e,t])=>t.create({client:e}))),this.visaCheckout}getVisaCheckoutSdk(e){return _(this,void 0,void 0,function*(){return this.visaCheckoutSDK||(this.visaCheckoutSDK=yield this.braintreeScriptLoader.loadVisaCheckoutSdk(e)),this.visaCheckoutSDK})}getVenmoCheckoutOrThrow(){return _(this,void 0,void 0,function*(){if(!this.braintreeVenmo){const e=yield this.getClient(),t=yield this.braintreeScriptLoader.loadVenmoCheckout(),i={client:e,allowDesktop:!0,paymentMethodUsage:\"multi_use\"},n=yield t.create(i);if(!n.isBrowserSupported())throw new N;this.braintreeVenmo=n}return this.braintreeVenmo})}setClientToken(e){this.clientToken=e}getClientTokenOrThrow(){if(!this.clientToken)throw new M(C.PaymentNotInitialized);return this.clientToken}teardownModule(e){return e?e.teardown():Promise.resolve()}}function x(e,t,i=!0){var n;return null!==(n=e[t])&&void 0!==n?n:i}class F{constructor(e){this.paymentIntegrationService=e,this.braintreeWindow=window}getSDKVersion(){const e=this.paymentIntegrationService.getState().getStoreConfig(),t=(null==e?void 0:e.checkoutSettings.features)||{};return this.getPreloadedSDKVersion()||(x(t,\"PAYPAL-5809.braintree_hosted_fields_fix_version\")?v:x(t,\"PAYPAL-5636.update_braintree_sdk_version\")?f:b)}getPreloadedSDKVersion(){const e=this.braintreeWindow.braintree;if(e){const i=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.find)(Object.values(e),e=>!!e.VERSION);return null==i?void 0:i.VERSION}}}function L(e,t){return Object.assign(e,{resolveIds:t})}class V extends p{constructor(e){super(e||\"Invalid arguments have been provided.\"),this.name=\"InvalidArgumentError\",this.type=\"invalid_argument\"}}var j;!function(e){e[e.MissingBillingAddress=0]=\"MissingBillingAddress\",e[e.MissingCart=1]=\"MissingCart\",e[e.MissingCheckout=2]=\"MissingCheckout\",e[e.MissingConsignments=3]=\"MissingConsignments\",e[e.MissingCustomer=4]=\"MissingCustomer\",e[e.MissingCheckoutConfig=5]=\"MissingCheckoutConfig\",e[e.MissingOrder=6]=\"MissingOrder\",e[e.MissingOrderConfig=7]=\"MissingOrderConfig\",e[e.MissingOrderId=8]=\"MissingOrderId\",e[e.MissingPayment=9]=\"MissingPayment\",e[e.MissingPaymentId=10]=\"MissingPaymentId\",e[e.MissingPaymentInstrument=11]=\"MissingPaymentInstrument\",e[e.MissingPaymentMethod=12]=\"MissingPaymentMethod\",e[e.MissingPaymentRedirectUrl=13]=\"MissingPaymentRedirectUrl\",e[e.MissingPaymentStatus=14]=\"MissingPaymentStatus\",e[e.MissingPaymentToken=15]=\"MissingPaymentToken\",e[e.MissingShippingAddress=16]=\"MissingShippingAddress\"}(j||(j={}));class U extends p{constructor(e){super(function(e){switch(e){case j.MissingBillingAddress:return\"Unable to proceed because billing address data is unavailable.\";case j.MissingCart:return\"Unable to proceed because cart data is unavailable.\";case j.MissingConsignments:return\"Unable to proceed because consignments data is unavailable.\";case j.MissingCheckout:return\"Unable to proceed because checkout data is unavailable.\";case j.MissingCustomer:return\"Unable to proceed because customer data is unavailable.\";case j.MissingCheckoutConfig:case j.MissingOrderConfig:return\"Unable to proceed because configuration data is unavailable.\";case j.MissingOrder:return\"Unable to proceed because order data is unavailable.\";case j.MissingOrderId:return\"Unable to proceed because order ID is unavailable or not generated yet.\";case j.MissingPayment:return\"Unable to proceed because payment data is unavailable.\";case j.MissingPaymentToken:return\"Unable to proceed because the token required to submit a payment is missing.\";case j.MissingPaymentMethod:return\"Unable to proceed because payment method data is unavailable or not properly configured.\";case j.MissingShippingAddress:return\"Unable to proceed because shipping address data is unavailable.\";default:return\"Unable to proceed because the required data is unavailable.\"}}(e)),this.subtype=e,this.name=\"MissingDataError\",this.type=\"missing_data\"}}class R extends V{constructor(e){let t=\"Unable to submit payment for the order because the payload is invalid.\";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(\", \")}.`),super(t),this.name=\"PaymentArgumentInvalidError\"}}function H(e){return Boolean(e.instrumentId)}class W extends p{constructor(){super(\"The current order does not need to be finalized at this stage.\"),this.name=\"OrderFinalizationNotRequiredError\",this.type=\"order_finalization_not_required\"}}function q(e){return!(\"object\"!=typeof e||null===e||void 0!==e.shouldSaveInstrument&&\"boolean\"!=typeof e.shouldSaveInstrument||void 0!==e.shouldSetAsDefaultInstrument&&\"boolean\"!=typeof e.shouldSetAsDefaultInstrument)}class $ extends p{constructor(e){super(e||\"Unable to proceed because the client library of a payment method has thrown an unexpected error.\"),this.name=\"PaymentMethodFailedError\",this.type=\"payment_method_client_invalid\"}}function G(e){return!!e&&\"accountNumber\"in e&&\"routingNumber\"in e&&\"ownershipType\"in e&&\"accountType\"in e}var Y=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class J{constructor(e,t){this.paymentIntegrationService=e,this.braintreeSdk=t}initialize(e){return Y(this,void 0,void 0,function*(){const{methodId:t,braintreeach:i}=e||{};if(!t)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');this.getMandateText=null==i?void 0:i.getMandateText,yield this.paymentIntegrationService.loadPaymentMethod(t);const n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t),{clientToken:r,initializationData:o}=n;if(!r||!o)throw new U(j.MissingPaymentMethod);this.braintreeSdk.initialize(r);try{this.usBankAccount=yield this.braintreeSdk.getUsBankAccount()}catch(e){this.handleBraintreeError(e)}})}execute(e,t){return Y(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!i)throw new R([\"payment\"]);const r=H(i.paymentData||{}),o=r?yield this.tokenizePaymentForVaultedInstrument(i):yield this.tokenizePayment(i),a=r?yield this.preparePaymentDataForVaultedInstrument(o,i):yield this.preparePaymentData(o,i);yield this.paymentIntegrationService.submitOrder(n,t),yield this.paymentIntegrationService.submitPayment(a)})}finalize(){return Promise.reject(new W)}deinitialize(){return Y(this,void 0,void 0,function*(){return yield this.braintreeSdk.deinitialize(),Promise.resolve()})}tokenizePayment({paymentData:e}){return Y(this,void 0,void 0,function*(){const t=this.getUsBankAccountOrThrow();if(!G(e))throw new R([\"payment.paymentData\"]);const i=H(e)?\"The data are used for stored instrument verification\":\"function\"==typeof this.getMandateText&&this.getMandateText();if(!i)throw new V(\"Unable to proceed because getMandateText is not provided or returned undefined value.\");try{const{nonce:n}=yield t.tokenize({bankDetails:this.getBankDetails(e),mandateText:i});return n}catch(e){this.handleBraintreeError(e)}})}tokenizePaymentForVaultedInstrument(e){return Y(this,void 0,void 0,function*(){const{methodId:t,paymentData:i={}}=e,n=this.paymentIntegrationService.getState(),{config:r}=n.getPaymentMethodOrThrow(t);if(!r.isVaultingEnabled)throw new V(\"Vaulting is disabled but a vaulted instrument was being used for this transaction\");return G(i)?this.tokenizePayment(e):null})}preparePaymentData(e,t){return Y(this,void 0,void 0,function*(){const{methodId:i,paymentData:n={}}=t;if(!G(n))throw new R([\"payment.paymentData\"]);const{deviceData:r}=yield this.braintreeSdk.getDataCollectorOrThrow(),{shouldSaveInstrument:o,shouldSetAsDefaultInstrument:a,routingNumber:s,accountNumber:d}=n;return{methodId:i,paymentData:{deviceSessionId:r,shouldSetAsDefaultInstrument:a,shouldSaveInstrument:o,formattedPayload:{tokenized_bank_account:{issuer:s,masked_account_number:d.substr(-4),token:e}}}}})}preparePaymentDataForVaultedInstrument(e,t){return Y(this,void 0,void 0,function*(){const{methodId:i,paymentData:n={}}=t;if(!H(n)||!q(n))throw new R([\"payment.paymentData\"]);const{deviceData:r}=yield this.braintreeSdk.getDataCollectorOrThrow(),{instrumentId:o,shouldSetAsDefaultInstrument:a}=n;return{methodId:i,paymentData:Object.assign({deviceSessionId:r,instrumentId:o,shouldSetAsDefaultInstrument:a},e&&{nonce:e})}})}getBankDetails(e){const t=this.paymentIntegrationService.getState().getBillingAddressOrThrow(),i=e.ownershipType.toLowerCase(),n=e.accountType.toLowerCase();return Object.assign(Object.assign({accountNumber:e.accountNumber,routingNumber:e.routingNumber,ownershipType:i},\"personal\"===i?{firstName:e.firstName,lastName:e.lastName}:{businessName:e.businessName}),{accountType:n,billingAddress:{streetAddress:t.address1,extendedAddress:t.address2,locality:t.city,region:t.stateOrProvinceCode,postalCode:t.postalCode}})}getUsBankAccountOrThrow(){if(!this.usBankAccount)throw new M(C.PaymentNotInitialized);return this.usBankAccount}handleBraintreeError(e){if(!D(e))throw e;throw new $(e.message)}}const K=L(t=>new J(t,(t=>{const i=new F(t),n=new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),window,i);return new B(n)})(t)),[{id:\"braintreeach\"}]);class X extends p{constructor(e,t){super(t||\"Unable to proceed because the payment form contains invalid data.\"),this.details=e,this.name=\"PaymentInvalidFormError\",this.type=\"payment_invalid_form\"}}class Q extends p{constructor(e){super(e||\"Payment process was cancelled.\"),this.name=\"PaymentMethodCancelledError\",this.type=\"payment_cancelled\"}}class Z{constructor(e){const t=new Promise((e,t)=>{this.cancel=t});this.promise=Promise.race([e,t])}}const ee=[\"buttons\",\"messages\"];var te,ie,ne,re,oe,ae;!function(e){e.HORIZONTAL=\"horizontal\",e.VERTICAL=\"vertical\"}(te||(te={})),function(e){e.SMALL=\"small\",e.MEDIUM=\"medium\",e.LARGE=\"large\",e.RESPONSIVE=\"responsive\"}(ie||(ie={})),function(e){e.GOLD=\"gold\",e.BLUE=\"blue\",e.SIlVER=\"silver\",e.BLACK=\"black\",e.WHITE=\"white\"}(ne||(ne={})),function(e){e.CHECKOUT=\"checkout\",e.PAY=\"pay\",e.BUYNOW=\"buynow\",e.PAYPAL=\"paypal\",e.CREDIT=\"credit\"}(re||(re={})),function(e){e.PILL=\"pill\",e.RECT=\"rect\"}(oe||(oe={})),function(e){e.CART=\"cart\",e.HOME=\"homepage\",e.PAYMENT=\"payment\",e.PRODUCT=\"product\"}(ae||(ae={}));var se=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class de{constructor(e,t,i){this.braintreeScriptLoader=e,this.braintreeHostWindow=t,this.overlay=i,this.dataCollectors={}}initialize(e,t){this.clientToken=e,this.threeDSecureOptions=t}getBraintreeFastlane(e,t,i){return se(this,void 0,void 0,function*(){if(t&&(window.localStorage.setItem(\"axoEnv\",\"sandbox\"),window.localStorage.setItem(\"fastlaneEnv\",\"sandbox\")),!this.braintreeHostWindow.braintreeFastlane){const t=this.getClientTokenOrThrow(),n=yield this.getClient(),r=yield this.getSessionId(e),o=yield this.braintreeScriptLoader.loadFastlane(),a={root:{backgroundColorPrimary:\"transparent\"}};this.braintreeHostWindow.braintreeFastlane=yield o.create({authorization:t,client:n,deviceData:r,styles:i||a})}return this.braintreeHostWindow.braintreeFastlane})}getClient(){return se(this,void 0,void 0,function*(){if(!this.client){const e=this.getClientTokenOrThrow(),t=yield this.braintreeScriptLoader.loadClient();this.client=t.create({authorization:e})}return this.client})}getPaypal(){return this.braintreePaypal||(this.braintreePaypal=Promise.all([this.getClient(),this.braintreeScriptLoader.loadPaypal()]).then(([e,t])=>t.create({client:e}))),this.braintreePaypal}paypal(e){var{shouldSaveInstrument:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"shouldSaveInstrument\"]);const n=(0,_braintree_browser_detection__WEBPACK_IMPORTED_MODULE_2__.supportsPopups)();return this.getPaypal().then(e=>{var r;return n&&(null===(r=this.overlay)||void 0===r||r.show({onClick:()=>e.focusWindow()})),e.tokenize(Object.assign({enableShippingAddress:!0,flow:t?\"vault\":\"checkout\",useraction:\"commit\"},i))}).then(e=>{var t;return null===(t=this.overlay)||void 0===t||t.remove(),e}).catch(e=>{var t;throw null===(t=this.overlay)||void 0===t||t.remove(),e})}getPaypalCheckout(e,t,i){return se(this,void 0,void 0,function*(){const n=yield this.getClient(),r=yield this.braintreeScriptLoader.loadPaypalCheckout(),o={client:n};return this.paypalCheckout=yield r.create(o,(n,r)=>{var o;if(n)return i(n);const a=Object.assign(Object.assign({currency:e.currency},e.isCreditEnabled&&{\"enable-funding\":\"paylater\"}),{components:ee.toString(),intent:e.intent,commit:null===(o=e.commit)||void 0===o||o});this.braintreeHostWindow.paypal?t(r):r.loadPayPalSDK(a,()=>t(r))}),this.paypalCheckout})}getDataCollector(e){return se(this,void 0,void 0,function*(){const t=(null==e?void 0:e.paypal)?\"paypal\":\"default\";let i=this.dataCollectors[t];if(!i){try{const t=yield this.getClient(),n=yield this.braintreeScriptLoader.loadDataCollector(),r=Object.assign({client:t,kount:!0},e);i=yield n.create(r)}catch(e){if(!D(e)||\"DATA_COLLECTOR_KOUNT_NOT_ENABLED\"!==e.code)throw e;i={deviceData:void 0,teardown:()=>Promise.resolve()}}this.dataCollectors[t]=i}return i})}getBraintreeEnv(e=!1){return e?h.Sandbox:h.Production}mapToBraintreeShippingAddressOverride(e){return{recipientName:`${e.firstName} ${e.lastName}`,line1:e.address1,line2:e.address2,city:e.city,state:e.stateOrProvinceCode,postalCode:e.postalCode,countryCode:e.countryCode,phone:e.phone}}mapToLegacyShippingAddress(e){const{email:t,phone:i,shippingAddress:n}=e,r=(null==n?void 0:n.recipientName)||\"\",[o,a]=r.split(\" \");return{email:t,first_name:o||\"\",last_name:a||\"\",phone_number:i,address_line_1:null==n?void 0:n.line1,address_line_2:null==n?void 0:n.line2,city:null==n?void 0:n.city,state:null==n?void 0:n.state,country_code:null==n?void 0:n.countryCode,postal_code:null==n?void 0:n.postalCode}}mapToLegacyBillingAddress(e){const{billingAddress:t,email:i,firstName:n,lastName:r,phone:o,shippingAddress:a}=e,s=t||a;return{email:i,first_name:n,last_name:r,phone_number:o,address_line_1:null==s?void 0:s.line1,address_line_2:null==s?void 0:s.line2,city:null==s?void 0:s.city,state:null==s?void 0:s.state,country_code:null==s?void 0:s.countryCode,postal_code:null==s?void 0:s.postalCode}}removeElement(e){const t=e&&document.getElementById(e);t&&t.remove()}getSessionId(e){return se(this,void 0,void 0,function*(){const{deviceData:t}=yield this.getDataCollector({riskCorrelationId:e});return t})}teardown(){return se(this,void 0,void 0,function*(){yield this.teardownModule(this.dataCollectors.default),yield this.teardownModule(this.dataCollectors.paypal),this.dataCollectors={},yield this.teardownModule(this.paypalCheckout),this.paypalCheckout=void 0})}get3DS(){return se(this,void 0,void 0,function*(){return this.threeDS||(this.threeDS=Promise.all([this.getClient(),this.braintreeScriptLoader.load3DS()]).then(([e,t])=>t.create({client:e,version:2}))),this.threeDS})}getVenmoCheckout(e){return se(this,void 0,void 0,function*(){if(!this.venmoCheckout){const t=yield this.getClient(),i=yield this.braintreeScriptLoader.loadVenmoCheckout(),n=Object.assign({client:t,allowDesktop:!0,paymentMethodUsage:\"multi_use\"},e||{});this.venmoCheckout=yield new Promise((e,t)=>{i.create(n,(i,n)=>i?t(i):n.isBrowserSupported()?void e(n):t(new N))})}return this.venmoCheckout})}verifyCard(e,t,i){return se(this,void 0,void 0,function*(){const n=yield this.tokenizeCard(e,t);return this.challenge3DSVerification(n,i)})}tokenizeCard(e,t){return se(this,void 0,void 0,function*(){const{paymentData:n}=e;if(!function(e){if(\"object\"!=typeof e||null===e)return!1;const t=e;return\"object\"==typeof t.ccExpiry&&null!==t.ccExpiry&&\"string\"==typeof t.ccNumber&&\"string\"==typeof t.ccName}(n))throw new R([\"payment.paymentData\"]);const r=this.getErrorsRequiredFields(n);if(!(0,lodash__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(r))throw new X(r);const o=this.mapToCreditCard(n,t),a=yield this.getClient(),{creditCards:s}=yield a.request(o);return{nonce:s[0].nonce,bin:s[0].details.bin}})}challenge3DSVerification(e,t){return se(this,void 0,void 0,function*(){const i=yield this.get3DS();return this.present3DSChallenge(i,t,e)})}teardownModule(e){return e?e.teardown():Promise.resolve()}getClientTokenOrThrow(){if(!this.clientToken)throw new M(C.PaymentNotInitialized);return this.clientToken}getErrorsRequiredFields(e){const{ccNumber:t,ccExpiry:i}=e,n={};return t||(n.ccNumber=[{message:\"Credit card number is required\",type:\"required\"}]),i||(n.ccExpiry=[{message:\"Expiration date is required\",type:\"required\"}]),n}mapToCreditCard(e,t){return{data:{creditCard:{cardholderName:e.ccName,number:e.ccNumber,cvv:e.ccCvv,expirationDate:`${e.ccExpiry.month}/${e.ccExpiry.year}`,options:{validate:!1},billingAddress:t&&{countryCodeAlpha2:t.countryCode,locality:t.city,countryName:t.country,postalCode:t.postalCode,streetAddress:t.address2?`${t.address1} ${t.address2}`:t.address1}}},endpoint:\"payment_methods/credit_cards\",method:\"post\"}}present3DSChallenge(e,t,i){const{nonce:n,bin:r}=i;if(!this.threeDSecureOptions||!n)throw new M(C.PaymentNotInitialized);const{addFrame:o,removeFrame:a,challengeRequested:s=!0,additionalInformation:d}=this.threeDSecureOptions,l=()=>se(this,void 0,void 0,function*(){const t=yield e.cancelVerifyCard();return u.cancel(new Q),t}),c=t.toFixed(2),u=new Z(e.verifyCard({addFrame:(e,t)=>{o&&o(e,t,l)},amount:Number(c),bin:r,challengeRequested:s,nonce:n,removeFrame:a,onLookupComplete:(e,t)=>{t()},collectDeviceData:!0,additionalInformation:d}));return u.promise}}class le{constructor(e){this.paymentIntegrationService=e,this.braintreeHostWindow=window}render(e,t,i){const n=t&&document.getElementById(t);if(this.braintreeHostWindow.paypal&&n){const r=this.paymentIntegrationService.getState(),o=r.getCartOrThrow(),a=r.getBillingAddressOrThrow(),s=r.getPaymentMethodOrThrow(e);if(!s.initializationData)return;const{paypalBNPLConfiguration:d=[]}=s.initializationData,l=i===ae.PAYMENT?\"checkout\":i,c=d&&d.find(({id:e})=>e===l);if(!c||!c.status)return;i===ae.CART&&(n.removeAttribute(\"data-pp-style-logo-type\"),n.removeAttribute(\"data-pp-style-logo-position\"),n.removeAttribute(\"data-pp-style-text-color\"),n.removeAttribute(\"data-pp-style-text-size\")),this.braintreeHostWindow.paypal.Messages({amount:o.cartAmount,buyerCountry:a.countryCode,placement:i,style:this.getPaypalMessagesStylesFromBNPLConfig(c)}).render(`#${t}`)}}getPaypalMessagesStylesFromBNPLConfig({styles:e}){const t={};return e.color&&(t.color=e.color),e.layout&&(t.layout=e.layout),(e[\"logo-type\"]||e[\"logo-position\"])&&(t.logo={},e[\"logo-type\"]&&(t.logo.type=e[\"logo-type\"]),e[\"logo-position\"]&&(t.logo.position=e[\"logo-position\"])),e.ratio&&(t.ratio=e.ratio),(e[\"text-color\"]||e[\"text-size\"])&&(t.text={},e[\"text-color\"]&&(t.text.color=e[\"text-color\"]),e[\"text-size\"]&&(t.text.size=+e[\"text-size\"])),t}}class ce{constructor(e){const{element:t,closeElement:i,mainElement:n}=this._createElements(e);this._element=t,this._closeElement=i,this._mainElement=n}show(e){this._mainElement.parentElement||(this._registerClick(e),document.body.appendChild(this._mainElement),setTimeout(()=>this._element.style.opacity=\"1\"))}remove(){this._mainElement.parentElement&&(this._unregisterClick&&this._unregisterClick(),this._removeAfterTransition(),setTimeout(()=>this._element.style.opacity=\"0\"))}_createElements(e){const t=document.createElement(\"div\"),{background:i=\"rgba(0, 0, 0, 0.8)\",id:n=\"checkoutOverlay\",transitionDuration:r=400,hasCloseButton:o=!1,innerHtml:a=null}=e||{};let s,d,l,c,u=t;if(n&&(t.id=n),a){const e=document.createElement(\"div\");c=`${n}--overlayText`,e.className=c,e.appendChild(a),t.appendChild(e)}return o&&(l=`${n}--close`,s=document.createElement(\"div\"),s.className=l,d=`${n}--layout`,u=document.createElement(\"div\"),u.className=d,u.appendChild(t),u.appendChild(s)),u.appendChild(function(e){const{id:t,background:i,transitionDuration:n,classLayout:r,classOverlayText:o,classClose:a}=e,s=document.createElement(\"style\"),d=r?`, .${r}`:\"\";return s.id=`${t}--styles`,s.type=\"text/css\",s.innerText=`\\n        #${t}${d} {\\n            display: block;\\n            height: 100%;\\n            width: 100%;\\n            left: 0;\\n            top: 0;\\n            position: fixed;\\n            z-index: 2147483647;\\n        }\\n        #${t} {\\n            transition: opacity ${n}ms ease-out;\\n            background: ${i};\\n            opacity: 0;\\n        }\\n    `,o&&(s.innerText+=`\\n             #${t} {\\n                display: flex;\\n                align-items: center;\\n                justify-content: center;\\n             }\\n             #${t} .${o} {\\n                color: white;\\n                max-width: 330px;\\n                font-size: 1.2em;\\n                text-align: center;\\n             }\\n        `),a&&(s.innerText+=`\\n            #${t} {\\n                opacity: 1;\\n            }\\n            .${r} .${a} {\\n                position: fixed;\\n                right: 16px;\\n                top: 16px;\\n                width: 16px;\\n                height: 16px;\\n                opacity: 0.6;\\n                cursor: pointer;\\n                z-index: 3147483647;\\n            }\\n            .${r} .${a}::after, .${r} .${a}::before {\\n                position: absolute;\\n                left: 8px;\\n                content: '';\\n                height: 16px;\\n                width: 2px;\\n                background-color: #fff;\\n            }\\n            .${r} .${a}::after {\\n                transform: rotate(-45deg);\\n            }\\n            .${r} .${a}::before {\\n                transform: rotate(45deg);\\n            }\\n        `),s}({id:n,background:i,transitionDuration:r,classLayout:d,classOverlayText:c,classClose:l})),{element:t,closeElement:s,mainElement:u}}_addEventListener(e,t){e&&t&&e.addEventListener(\"click\",t)}_removeEventListener(e,t){e&&t&&e.removeEventListener(\"click\",t)}_registerClick(e){if(this._unregisterClick&&this._unregisterClick(),e){const{onClick:t,onClickClose:i}=e;this._addEventListener(this._element,t),this._addEventListener(this._closeElement,i),this._unregisterClick=()=>{this._removeEventListener(this._element,t),this._removeEventListener(this._closeElement,i),this._unregisterClick=void 0}}}_removeAfterTransition(){const e=t=>{\"opacity\"===t.propertyName&&(this._mainElement.parentElement&&this._mainElement.remove(),this._element.removeEventListener(\"transitionend\",e))};this._element.addEventListener(\"transitionend\",e)}}const ue={size:70,color:\"#d9d9d9\",backgroundColor:\"#ffffff\"},he=\"embedded-checkout-loading-indicator-rotation\";class ye{constructor(e){this.styles=Object.assign(Object.assign({},ue),e&&e.styles),this.containerStyles=Object.assign({},e&&e.containerStyles),this.defineAnimation(),this.container=this.buildContainer(),this.indicator=this.buildIndicator(),this.container.appendChild(this.indicator)}show(e){if(e){const t=document.getElementById(e);if(!t)throw new Error(\"Unable to attach the loading indicator because the parent ID is not valid.\");t.appendChild(this.container)}this.container.style.visibility=\"visible\",this.container.style.opacity=\"1\"}hide(){const e=()=>{this.container.style.visibility=\"hidden\",this.container.removeEventListener(\"transitionend\",e)};this.container.addEventListener(\"transitionend\",e),this.container.style.opacity=\"0\"}buildContainer(){const e=document.createElement(\"div\");return e.style.display=\"block\",e.style.bottom=\"0\",e.style.left=\"0\",e.style.height=\"100%\",e.style.width=\"100%\",e.style.position=\"absolute\",e.style.right=\"0\",e.style.top=\"0\",e.style.transition=\"all 250ms ease-out\",e.style.opacity=\"0\",this.setStyleAttribute(e,this.containerStyles),e}buildIndicator(){const e=document.createElement(\"div\");return e.style.display=\"block\",e.style.width=`${this.styles.size}px`,e.style.height=`${this.styles.size}px`,e.style.borderRadius=`${this.styles.size}px`,e.style.border=\"solid 1px\",e.style.borderColor=`${this.styles.backgroundColor} ${this.styles.backgroundColor} ${this.styles.color} ${this.styles.color}`,e.style.margin=\"0 auto\",e.style.position=\"absolute\",e.style.left=\"0\",e.style.right=\"0\",e.style.top=\"50%\",e.style.transform=\"translateY(-50%) rotate(0deg)\",e.style.transformStyle=\"preserve-3d\",e.style.animation=`${he} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`,e}setStyleAttribute(e,t){Object.keys(t).forEach(i=>{e.style.setProperty(i,t[i])})}defineAnimation(){var e;if(document.getElementById(he))return;const t=document.createElement(\"style\");t.id=he,null===(e=document.head)||void 0===e||e.appendChild(t),t.sheet instanceof CSSStyleSheet&&t.sheet.insertRule(`\\n                @keyframes ${he} {\\n                    0% { transform: translateY(-50%) rotate(0deg); }\\n                    100% { transform: translateY(-50%) rotate(360deg); }\\n                }\\n            `,0)}}const me={\"background-color\":\"rgba(0, 0, 0, 0.4)\",\"z-index\":\"1000\"};function pe(e){return\"object\"==typeof e&&null!==e&&\"name\"in e&&\"BraintreeError\"===e.name}function ge(e){return{recipientName:`${e.firstName} ${e.lastName}`,line1:e.address1,line2:e.address2,city:e.city,state:e.stateOrProvinceCode,postalCode:e.postalCode,countryCode:e.countryCode,phone:e.phone}}var ve=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class fe{constructor(e,t,i,n){this.paymentIntegrationService=e,this.braintreeIntegrationService=t,this.braintreeMessages=i,this.loadingIndicator=n,this.braintreeHostWindow=window}initialize(e){return ve(this,void 0,void 0,function*(){const{braintree:t,methodId:i}=e;if(this.braintree=t,this.paymentMethod&&this.paymentMethod.nonce||(this.paymentMethod=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(i)),this.paymentMethod.clientToken&&(null==t?void 0:t.bannerContainerId))return yield this.loadPaypal(),this.loadPaypalCheckoutInstance();if(this.paymentMethod.clientToken)return this.loadPaypal();const n=yield this.paymentIntegrationService.loadPaymentMethod(i);if(this.paymentMethod=n.getPaymentMethodOrThrow(i),null==t?void 0:t.bannerContainerId)return this.loadPaypalCheckoutInstance();if(!this.paymentMethod.clientToken)throw new U(j.MissingPaymentMethod);return this.loadPaypal()})}execute(e,t){var i;return ve(this,void 0,void 0,function*(){const{payment:n}=e,r=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]),{onError:o}=this.braintree||{};if(!n)throw new R([\"payment\"]);try{const e=yield this.preparePaymentData(n,r.useStoreCredit);yield this.paymentIntegrationService.submitOrder(r,t),yield this.paymentIntegrationService.submitPayment(e)}catch(e){this.isProviderError(e)&&(yield this.loadPaypal(),null===(i=this.paypalButtonRender)||void 0===i||i.close(),yield this.loadPaypalCheckoutInstance(),yield new Promise((e,t)=>{o&&\"function\"==typeof o&&o(new Error(\"INSTRUMENT_DECLINED\")),t()})),this.handleError(e)}})}finalize(){return Promise.reject(new W)}deinitialize(){var e;return this.braintreeTokenizePayload=void 0,null===(e=this.paypalButtonRender)||void 0===e||e.close(),this.braintreeIntegrationService.teardown()}preparePaymentData(e,t){var i;return ve(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState(),r=n.getOutstandingBalance(t),o=n.getStoreConfig();if(!r)throw new U(j.MissingCheckout);if(!o)throw new U(j.MissingCheckoutConfig);if(!this.paymentMethod)throw new M(C.PaymentNotInitialized);const{currency:a,storeProfile:{storeLanguage:s}}=o,{nonce:d,config:{isVaultingEnabled:l}}=this.paymentMethod,{methodId:c,paymentData:u={}}=e,h=(null===(i=this.braintreeTokenizePayload)||void 0===i?void 0:i.nonce)||d;if(h){const t=yield this.paymentIntegrationService.loadPaymentMethod(c);return this.paymentMethod=t.getPaymentMethod(c),Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(h)})}if(H(u)||(y=u,Boolean(y.instrumentId)&&!Object.prototype.hasOwnProperty.call(y,\"ccNumber\")&&!Object.prototype.hasOwnProperty.call(y,\"ccCvv\"))){if(!l)throw new V(\"Vaulting is disabled but a vaulted instrument was being used for this transaction\");return Promise.resolve(e)}var y;if(!q(u))throw new U(j.MissingPayment);const{shouldSaveInstrument:m,shouldSetAsDefaultInstrument:p}=u;if(m&&!l)throw new V(\"Vaulting is disabled but shouldSaveInstrument is set to true\");const g=n.getShippingAddress(),v=g?ge(g):void 0;return Promise.all([this.braintreeIntegrationService.paypal({amount:r,locale:s,currency:a.code,offerCredit:\"braintreepaypalcredit\"===this.paymentMethod.id,shippingAddressOverride:v,shouldSaveInstrument:m||!1,shippingAddressEditable:!1}),this.braintreeIntegrationService.getSessionId()]).then(([{nonce:t,details:i}={},n])=>Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(t,i&&i.email,n,m,p)}))})}formattedPayload(e,t,i,n,r){return{formattedPayload:{vault_payment_instrument:n||null,set_as_default_stored_instrument:r||null,device_info:i||null,paypal_account:{token:e,email:t||null}}}}loadPaypalCheckoutInstance(){return ve(this,void 0,void 0,function*(){const{clientToken:e,initializationData:t,id:i}=this.paymentMethod||{};if(!e)throw new U(j.MissingPaymentMethod);try{this.braintreeIntegrationService.initialize(e);const n={currency:this.paymentIntegrationService.getState().getCartOrThrow().currency.code,intent:null==t?void 0:t.intent,isCreditEnabled:null==t?void 0:t.isCreditEnabled},r=\"braintreepaypalcredit\"===i||!(null==t?void 0:t.isCreditEnabled);yield this.braintreeIntegrationService.getPaypalCheckout(n,e=>{var t;r&&i&&(null===(t=this.braintree)||void 0===t?void 0:t.bannerContainerId)&&this.renderPayPalMessages(i,this.braintree.bannerContainerId),this.renderPayPalButton(e)},this.handleError)}catch(e){this.handleError(e)}})}renderPayPalMessages(e,t){this.braintreeMessages.render(e,t,ae.PAYMENT)}renderPayPalButton(e){const{onPaymentError:t,submitForm:i,onRenderButton:n,containerId:r,onError:o}=this.braintree||{};if(!r)return;if(!this.paymentMethod)throw new M(C.PaymentNotInitialized);this.loadingIndicatorContainer=r.split(\"#\")[1];const{id:a,config:{testMode:s}}=this.paymentMethod,{paypal:d}=this.braintreeHostWindow,l=null==d?void 0:d.FUNDING.PAYPAL;d&&l?(this.paypalButtonRender=d.Buttons({env:s?\"sandbox\":\"production\",commit:!1,fundingSource:l,onClick:()=>{this.toggleLoadingIndicator(!0)},createOrder:()=>this.setupPayment(e,a,t),onApprove:t=>ve(this,void 0,void 0,function*(){this.braintreeTokenizePayload=yield this.tokenizePaymentOrThrow(t,e),i&&\"function\"==typeof i&&i()}),onCancel:()=>{this.toggleLoadingIndicator(!1)},onError:e=>{this.toggleLoadingIndicator(!1),null==o||o(e)}}),n&&\"function\"==typeof n&&n(),this.paypalButtonRender.isEligible()&&this.paypalButtonRender.render(`${r}`)):this.removeElement(r.split(\"#\")[1])}setupPayment(e,t,i){return ve(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState();try{const i=n.getCustomer(),r=n.getPaymentMethodOrThrow(t),o=n.getCheckoutOrThrow().outstandingBalance,a=n.getStoreConfigOrThrow().currency.code,s=n.getShippingAddress()||(null==i?void 0:i.addresses[0]),d=s?ge(s):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:d,amount:o,currency:a,offerCredit:!1,intent:r.initializationData.intent})}catch(e){throw i&&(pe(e)||e instanceof p)&&i(e),e}})}tokenizePaymentOrThrow(e,t,i){return ve(this,void 0,void 0,function*(){try{return yield t.tokenizePayment(e)}catch(e){throw i&&(pe(e)||e instanceof p)&&i(e),e}})}loadPaypal(){return ve(this,void 0,void 0,function*(){const{clientToken:e,initializationData:t}=this.paymentMethod||{};if(!e||!t)throw new U(j.MissingPaymentMethod);try{this.braintreeIntegrationService.initialize(e),yield this.braintreeIntegrationService.getPaypal()}catch(e){this.handleError(e)}return Promise.resolve()})}handleError(e){if(!pe(e))throw e;if(\"PAYPAL_POPUP_CLOSED\"===e.code)throw new Q(e.message);throw new $(e.message)}isProviderError(e){var t,i,n;return!!function(e){return\"object\"==typeof e&&null!==e&&\"errors\"in e}(e)&&\"2046\"===(null===(n=null===(i=((null===(t=null==e?void 0:e.errors)||void 0===t?void 0:t.filter(e=>e.provider_error))||[])[0])||void 0===i?void 0:i.provider_error)||void 0===n?void 0:n.code)}removeElement(e){const t=e&&document.getElementById(e);t&&t.remove()}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}}const be=L(t=>{const i=window,n=new ce,r=new F(t),o=new de(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,r),i,n),a=new le(t);return new fe(t,o,a,new ye({containerStyles:me}))},[{id:\"braintreepaypal\"},{id:\"braintreepaypalcredit\"}]);var we;!function(e){e.Json=\"application/json\",e.JsonV1=\"application/vnd.bc.v1+json\"}(we||(we={}));const Ce=we,Se={\"X-Checkout-SDK-Version\":\"1.841.0\"};class Pe{constructor(e){this.requestSender=e}getOrderStatus(e=\"braintreelocalmethods\",t){return i=this,n=void 0,o=function*(){const i=`/api/storefront/initialization/${e}`,n=Object.assign({\"X-API-INTERNAL\":\"This API endpoint is for internal use only and may change in the future\",\"Content-Type\":Ce.Json},Se);return(yield this.requestSender.get(i,Object.assign({headers:n},t))).body},new((r=void 0)||(r=Promise))(function(e,t){function a(e){try{d(o.next(e))}catch(e){t(e)}}function s(e){try{d(o.throw(e))}catch(e){t(e)}}function d(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r(function(e){e(i)})).then(a,s)}d((o=o.apply(i,n||[])).next())});// removed by dead control flow\n var i, n, r, o; }}const Ie={body:{},headers:{},status:0};class Oe extends p{constructor(e,{message:t,errors:i}={}){const{body:n,headers:r,status:o}=e||Ie;super(t||\"An unexpected error has occurred.\"),this.name=\"RequestError\",this.type=\"request\",this.body=n,this.headers=r,this.status=o,this.errors=i||[]}}class ke extends Oe{constructor(e){super(e,{message:\"There is a problem processing your payment. Please try again later.\"}),this.name=\"PaymentMethodInvalidError\",this.type=\"payment_method_invalid\"}}class Ee extends Oe{constructor(e){super(e,{message:\"The request has timed out or aborted.\"}),this.name=\"TimeoutError\",this.type=\"timeout\"}}var Te=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Ae{constructor(e,t,i,n,r=3e3,a=3e5){this.paymentIntegrationService=e,this.braintreeSdk=t,this.braintreeRequestSender=i,this.loadingIndicator=n,this.pollingInterval=r,this.maxPollingIntervalTime=a,this.isLPMsUpdateExperimentEnabled=!1,this.pollingTimer=0,this.stopPolling=lodash__WEBPACK_IMPORTED_MODULE_1__.noop,this.isPollingEnabled=!1}initialize(e){return Te(this,void 0,void 0,function*(){const{gatewayId:t,methodId:i,braintreelocalmethods:n}=e;if(this.gatewayId=t,!i)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new V('Unable to initialize payment because \"options.gatewayId\" argument is not provided.');if(!n)throw new V('Unable to initialize payment because \"options.braintreelocalmethods\" argument is not provided.');this.braintreelocalmethods=n,this.loadingIndicatorContainer=n.container.split(\"#\")[1],yield this.paymentIntegrationService.loadPaymentMethod(t);const r=this.paymentIntegrationService.getState(),o=r.getPaymentMethodOrThrow(t),{clientToken:a,config:s,initializationData:d}=o,l=r.getStoreConfigOrThrow().checkoutSettings.features;if(this.isPollingEnabled=x(l,\"PAYPAL-5258.braintree_local_methods_polling\"),this.isLPMsUpdateExperimentEnabled=x(l,\"PAYPAL-4853.add_new_payment_flow_for_braintree_lpms\"),!a||!d||!s.merchantId)throw new U(j.MissingPaymentMethod);try{this.braintreeSdk.initialize(a),this.isNonInstantPaymentMethod(i)||(this.braintreeLocalPayment=yield this.braintreeSdk.getBraintreeLocalPayment(s.merchantId))}catch(e){this.handleError(e)}})}finalize(){return Promise.reject(new W)}deinitialize(){return Te(this,void 0,void 0,function*(){return this.toggleLoadingIndicator(!1),Promise.resolve()})}execute(e,t){return Te(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!i)throw new R([\"payment\"]);const{methodId:r}=i;this.toggleLoadingIndicator(!0),this.isNonInstantPaymentMethod(r)?yield this.executeWithNotInstantLPM(r):yield this.executeWithInstantLPM(r,n,t)})}executeWithNotInstantLPM(e){return Te(this,void 0,void 0,function*(){try{const t=yield this.getLPMsBasicPaymentData();yield this.paymentIntegrationService.submitOrder(),yield this.paymentIntegrationService.submitPayment({methodId:e,paymentData:Object.assign(Object.assign({},t),{formattedPayload:{method:e}})})}catch(e){if(this.isBraintreeRedirectError(e)){const t=e.body.additional_action_required.data.redirect_url;return new Promise((e,i)=>{window.location.replace(t),this.toggleLoadingIndicator(!1),i()})}return this.handleError(e),Promise.reject(e)}})}executeWithInstantLPM(e,t,i){return Te(this,void 0,void 0,function*(){if(!this.braintreeLocalPayment)throw new ke;yield new Promise((n,r)=>{var o;null===(o=this.braintreeLocalPayment)||void 0===o||o.startPayment(this.getInstantLPMConfig(e,t,i),this.getInstantLPMCallback(n,r,e,t,i))})})}getLPMsBasicPaymentData(){return Te(this,void 0,void 0,function*(){const{deviceData:e}=yield this.braintreeSdk.getDataCollectorOrThrow();return{deviceSessionId:e}})}getInstantLPMConfig(e,t,i){const n=this.paymentIntegrationService.getState(),r=n.getCartOrThrow(),o=n.getBillingAddressOrThrow(),{firstName:a,lastName:s,countryCode:d}=o,{currency:l,email:c,lineItems:u}=r,h=u.physicalItems.length>0,y=n.getCheckoutOrThrow().outstandingBalance,m=n.getStoreConfigOrThrow().links.checkoutLink;return{paymentType:e,amount:y,fallback:{url:m,buttonText:\"Complete Payment\"},currencyCode:l.code,shippingAddressRequired:h,email:c,givenName:a,surname:s,address:{countryCode:d},onPaymentStart:(n,r)=>Te(this,void 0,void 0,function*(){if(!this.isLPMsUpdateExperimentEnabled)return this.orderId=n.paymentId,void r();const o=yield this.getLPMsBasicPaymentData(),a=Object.assign(Object.assign({},o),{formattedPayload:{method:e,[`${e}_account`]:{order_id:n.paymentId}}});try{yield this.paymentIntegrationService.submitOrder(t,i),yield this.paymentIntegrationService.submitPayment({methodId:e,paymentData:a})}catch(t){if(this.isBraintreeOrderSavedResponse(t)&&t.body.additional_action_required.data.order_id_saved_successfully)return r(),this.isPollingEnabled?new Promise((t,i)=>{this.initializePollingMechanism(e,t,i,this.gatewayId)}):void 0;throw t}})}}getInstantLPMCallback(e,t,i,n,r){const o=this.paymentIntegrationService.getState().getCartOrThrow();return(a,s)=>Te(this,void 0,void 0,function*(){if(a)return\"LOCAL_PAYMENT_WINDOW_CLOSED\"===a.code?(this.toggleLoadingIndicator(!1),this.resetPollingMechanism(),t()):(this.isPollingEnabled&&this.resetPollingMechanism(),this.toggleLoadingIndicator(!1),t(new ke));const d=yield this.getLPMsBasicPaymentData(),l=Object.assign(Object.assign({},d),{formattedPayload:{method:i,[`${i}_account`]:Object.assign({email:o.email,token:s.nonce},this.isLPMsUpdateExperimentEnabled?{}:{order_id:this.orderId})}});try{return this.isLPMsUpdateExperimentEnabled||(yield this.paymentIntegrationService.submitOrder(n,r)),yield this.paymentIntegrationService.submitPayment({methodId:i,paymentData:l}),e(void 0)}catch(e){return this.handleError(e),t(e)}})}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}handleError(e){const{onError:t}=this.braintreelocalmethods||{};this.isPollingEnabled&&this.resetPollingMechanism(),this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}isNonInstantPaymentMethod(e){return e.toUpperCase()in I}isBraintreeRedirectError(e){var t;if(\"object\"!=typeof e||null===e)return!1;const{body:i}=e;return!!i&&!!(null===(t=i.additional_action_required)||void 0===t?void 0:t.data.redirect_url)}isBraintreeOrderSavedResponse(e){var t;if(\"object\"!=typeof e||null===e)return!1;const{body:i}=e;return!!i&&(null===(t=i.additional_action_required)||void 0===t?void 0:t.data.hasOwnProperty(\"order_id_saved_successfully\"))}initializePollingMechanism(e,t,i,n){return Te(this,void 0,void 0,function*(){yield new Promise((e,t)=>{const i=setTimeout(e,this.pollingInterval);this.stopPolling=()=>(clearTimeout(i),this.toggleLoadingIndicator(!1),t())});try{this.pollingTimer+=this.pollingInterval;const r=yield this.braintreeRequestSender.getOrderStatus(n,{params:{useMetadata:!1}}),o=r.status===P.Pending,a=r.status===P.Completed,s=r.status===P.Failed;if(a)return this.deinitializePollingMechanism(),t();if(s)return i();if(!a&&o&&this.pollingTimer<this.maxPollingIntervalTime)return yield this.initializePollingMechanism(e,t,i,n);yield this.reinitializeStrategy({methodId:e,gatewayId:n,braintreelocalmethods:this.braintreelocalmethods}),this.handleError(new Ee)}catch(e){i()}})}deinitializePollingMechanism(){this.stopPolling(),this.pollingTimer=0}resetPollingMechanism(){this.deinitializePollingMechanism()}reinitializeStrategy(e){return Te(this,void 0,void 0,function*(){yield this.deinitialize(),yield this.initialize(e)})}}const ze=L(t=>{const i=window,n=new F(t),r=new B(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n)),o=(0,_bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_3__.createRequestSender)(),a=new Pe(o);return new Ae(t,r,a,new ye({styles:{backgroundColor:\"black\"}}))},[{gateway:\"braintreelocalmethods\"}]);function Ne(e){return\"string\"!=typeof e}function Me(e,t){if(t||e)return function(e){var t,i;const n={},r=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)(e.root,Ne),o=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)(e.input,Ne),a=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)(e.toggle,Ne),d=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)(null===(t=e.text)||void 0===t?void 0:t.body,Ne),l=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)(null===(i=e.text)||void 0===i?void 0:i.caption,Ne),c=e.branding;return Object.keys(r).length&&(n.root=r),Object.keys(o).length&&(n.input=o),Object.keys(a).length&&(n.toggle=a),Object.keys(d).length&&(n.text={},n.text.body=d),Object.keys(l).length&&(n.text=Object.assign({},n.text),n.text.caption=l),c&&(n.branding=c),n}(function(e,t){var i,n,r,o,a,s,d,l,c,u,h,y,m,p,g,v,f,b,w,C,S,P;return{root:{backgroundColorPrimary:(null==e?void 0:e.fastlaneRootSettingsBackgroundColor)||(null===(i=null==t?void 0:t.root)||void 0===i?void 0:i.backgroundColorPrimary),errorColor:(null==e?void 0:e.fastlaneRootSettingsErrorColor)||(null===(n=null==t?void 0:t.root)||void 0===n?void 0:n.errorColor),fontFamily:(null==e?void 0:e.fastlaneRootSettingsFontFamily)||(null===(r=null==t?void 0:t.root)||void 0===r?void 0:r.fontFamily),fontSizeBase:(null==e?void 0:e.fastlaneRootSettingsFontSize)||(null===(o=null==t?void 0:t.root)||void 0===o?void 0:o.fontSizeBase),padding:(null==e?void 0:e.fastlaneRootSettingsPadding)||(null===(a=null==t?void 0:t.root)||void 0===a?void 0:a.padding),primaryColor:(null==e?void 0:e.fastlaneRootSettingsPrimaryColor)||(null===(s=null==t?void 0:t.root)||void 0===s?void 0:s.primaryColor)},input:{borderRadius:(null==e?void 0:e.fastlaneInputSettingsBorderRadius)||(null===(d=null==t?void 0:t.input)||void 0===d?void 0:d.borderRadius),borderColor:(null==e?void 0:e.fastlaneInputSettingsBorderColor)||(null===(l=null==t?void 0:t.input)||void 0===l?void 0:l.borderColor),focusBorderColor:(null==e?void 0:e.fastlaneInputSettingsFocusBorderBase)||(null===(c=null==t?void 0:t.input)||void 0===c?void 0:c.focusBorderColor),backgroundColor:(null==e?void 0:e.fastlaneInputSettingsBackgroundColor)||(null===(u=null==t?void 0:t.input)||void 0===u?void 0:u.backgroundColor),borderWidth:(null==e?void 0:e.fastlaneInputSettingsBorderWidth)||(null===(h=null==t?void 0:t.input)||void 0===h?void 0:h.borderWidth),textColorBase:(null==e?void 0:e.fastlaneInputSettingsTextColorBase)||(null===(y=null==t?void 0:t.input)||void 0===y?void 0:y.textColorBase)},toggle:{colorPrimary:(null==e?void 0:e.fastlaneToggleSettingsColorPrimary)||(null===(m=null==t?void 0:t.toggle)||void 0===m?void 0:m.colorPrimary),colorSecondary:(null==e?void 0:e.fastlaneToggleSettingsColorSecondary)||(null===(p=null==t?void 0:t.toggle)||void 0===p?void 0:p.colorSecondary)},text:{body:{color:(null==e?void 0:e.fastlaneTextBodySettingsColor)||(null===(v=null===(g=null==t?void 0:t.text)||void 0===g?void 0:g.body)||void 0===v?void 0:v.color),fontSize:(null==e?void 0:e.fastlaneTextBodySettingsFontSize)||(null===(b=null===(f=null==t?void 0:t.text)||void 0===f?void 0:f.body)||void 0===b?void 0:b.fontSize)},caption:{color:(null==e?void 0:e.fastlaneTextCaptionSettingsColor)||(null===(C=null===(w=null==t?void 0:t.text)||void 0===w?void 0:w.caption)||void 0===C?void 0:C.color),fontSize:(null==e?void 0:e.fastlaneTextCaptionSettingsFontSize)||(null===(P=null===(S=null==t?void 0:t.text)||void 0===S?void 0:S.caption)||void 0===P?void 0:P.fontSize)}},branding:(null==e?void 0:e.fastlaneBrandingSettings)||(null==t?void 0:t.branding)}}(e,t))}function De(e){return!!e&&(\"authenticationState\"in e||\"addresses\"in e||\"instruments\"in e)}var _e,Be=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class xe{constructor(e,t,i){this.paymentIntegrationService=e,this.braintreeFastlaneUtils=t,this.braintreeSdk=i}initialize(e){var t;return Be(this,void 0,void 0,function*(){const{methodId:i,braintreefastlane:n}=e;if(!i)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!n)throw new V('Unable to initialize payment because \"options.braintreefastlane\" argument is not provided.');if(!n.onInit||\"function\"!=typeof n.onInit)throw new V('Unable to initialize payment because \"options.braintreefastlane.onInit\" argument is not provided or it is not a function.');if(!n.onChange||\"function\"!=typeof n.onChange)throw new V('Unable to initialize payment because \"options.braintreefastlane.onChange\" argument is not provided or it is not a function.');yield this.paymentIntegrationService.loadPaymentMethod(i);const r=this.paymentIntegrationService.getState(),o=r.getPaymentMethodOrThrow(i),{initializationData:a,clientToken:s}=o||{},{isFastlaneStylingEnabled:d}=a||{},l=x(r.getStoreConfigOrThrow().checkoutSettings.features,\"PROJECT-7080.braintree_fastlane_three_ds\");this.is3DSEnabled=o.config.is3dsEnabled,s&&l&&this.braintreeSdk.initialize(s);const c=Me(d?null===(t=o.initializationData)||void 0===t?void 0:t.fastlaneStyles:void 0,n.styles);yield this.braintreeFastlaneUtils.initializeBraintreeFastlaneOrThrow(i,c),this.shouldRunAuthenticationFlow()&&(yield this.braintreeFastlaneUtils.runPayPalAuthenticationFlowOrThrow()),yield this.initializeCardComponent(),this.onError=n.onError,n.onInit(e=>this.renderBraintreeCardComponent(e)),n.onChange(()=>this.handleBraintreeStoredInstrumentChange(i))})}execute(e,t){return Be(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!i)throw new R([\"payment\"]);yield this.paymentIntegrationService.submitOrder(n,t);const r=yield this.preparePaymentPayload(i.methodId);yield this.paymentIntegrationService.submitPayment(r),this.braintreeFastlaneUtils.removeSessionIdFromCookies()})}finalize(){return Promise.reject(new W)}deinitialize(){return Be(this,void 0,void 0,function*(){return this.braintreeCardComponent=void 0,Promise.resolve()})}initializeCardComponent(){return Be(this,void 0,void 0,function*(){const e=this.paymentIntegrationService.getState(),{phone:t,firstName:i,lastName:n}=e.getBillingAddressOrThrow(),r=`${i} ${n}`,o={styles:{},fields:Object.assign({cardholderName:{prefill:r,enabled:!0}},t&&{phoneNumber:{prefill:t}})},a=this.braintreeFastlaneUtils.getBraintreeFastlaneComponentOrThrow();this.braintreeCardComponent=yield a(o)})}renderBraintreeCardComponent(e){const t=this.getBraintreeCardComponentOrThrow();if(!e)throw new V('Unable to initialize payment because \"container\" argument is not provided.');t.render(e)}preparePaymentPayload(e){var t,i;return Be(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState(),r=n.getBillingAddressOrThrow(),o=`${r.firstName} ${r.lastName}`,a=this.getPayPalInstruments()[0],s=yield this.braintreeFastlaneUtils.getDeviceSessionId(),d=x(n.getStoreConfigOrThrow().checkoutSettings.features,\"PROJECT-7080.braintree_fastlane_three_ds\");if(a){const t=this.is3DSEnabled&&d?yield this.get3DS(a.bigpayToken,(null==a?void 0:a.iin)||\"\"):void 0;return{methodId:e,paymentData:{deviceSessionId:s,formattedPayload:{paypal_fastlane_token:{token:t||a.bigpayToken}}}}}const{getPaymentToken:l}=this.getBraintreeCardComponentOrThrow(),c=yield l({name:{fullName:o},billingAddress:this.mapToPayPalAddress(r)}),u=(null===(i=null===(t=c.paymentSource.card)||void 0===t?void 0:t.binDetails)||void 0===i?void 0:i.bin)||\"\",h=this.is3DSEnabled&&d?yield this.get3DS(c.id,u):void 0;return{methodId:e,paymentData:{deviceSessionId:s,nonce:h||c.id}}})}get3DS(e,t){return Be(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState(),n=yield this.braintreeSdk.getBraintreeThreeDS(),r=i.getOrderOrThrow();return new Promise((i,o)=>{n.verifyCard({amount:null==r?void 0:r.orderAmount,nonce:e,bin:t,onLookupComplete:(e,t)=>{n.on(\"customer-canceled\",()=>{\"function\"==typeof this.onError&&this.onError(new Q),o(new Q)}),t()}},(e,t)=>(e&&\"THREEDS_VERIFY_CARD_CANCELED_BY_MERCHANT\"===e.code&&(\"function\"==typeof this.onError&&this.onError(new Q),o(new Q)),i(t.nonce)))})})}mapToPayPalAddress(e){return{streetAddress:(null==e?void 0:e.address1)||\"\",locality:(null==e?void 0:e.city)||\"\",region:(null==e?void 0:e.stateOrProvinceCode)||(null==e?void 0:e.stateOrProvince)||\"\",postalCode:(null==e?void 0:e.postalCode)||\"\",countryCodeAlpha2:(null==e?void 0:e.countryCode)||\"\"}}shouldRunAuthenticationFlow(){const e=this.paymentIntegrationService.getState(),t=e.getCartOrThrow(),i=e.getCustomerOrThrow(),n=e.getPaymentProviderCustomer(),r=De(n)?n:{},o=this.braintreeFastlaneUtils.getSessionIdFromCookies();return!(!i.isGuest||(null==r?void 0:r.authenticationState)===O.CANCELED||(null==r?void 0:r.authenticationState)||o!==t.id)}getBraintreeCardComponentOrThrow(){if(!this.braintreeCardComponent)throw new g;return this.braintreeCardComponent}getPayPalInstruments(){const e=this.paymentIntegrationService.getState().getPaymentProviderCustomerOrThrow();return(De(e)?e:{}).instruments||[]}handleBraintreeStoredInstrumentChange(e){return Be(this,void 0,void 0,function*(){const t=this.braintreeFastlaneUtils.getBraintreeFastlaneOrThrow(),{selectionChanged:i,selectedCard:n}=yield t.profile.showCardSelector();if(i){const t=this.paymentIntegrationService.getState().getPaymentProviderCustomer(),i=De(t)?t:{},r=this.braintreeFastlaneUtils.mapPayPalToBcInstrument(e,[n]);if(r&&r.length>0)return yield this.paymentIntegrationService.updatePaymentProviderCustomer(Object.assign(Object.assign({},i),{instruments:[...r]})),r[0]}})}}!function(e){e.CVV=\"cvv\",e.PAN=\"pan\"}(_e||(_e={}));class Fe{static get(e){const t=`${encodeURIComponent(`${e}`)}=`,i=document.cookie;let n=null;const r=i.indexOf(t);if(r>-1){let e=i.indexOf(\";\",r);-1===e&&(e=i.length),n=decodeURIComponent(i.substring(r+t.length,e))}return n}static set(e,t,i={secure:!0}){let n=`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;const{expires:r,path:o,domain:a,secure:s}=i;if(r)n+=`; expires=${r.toUTCString()}`;else{const e=new Date,t=60;e.setTime(e.getTime()+60*t*1e3),n+=`; expires=${e.toUTCString()}`}o&&(n+=`; path=${o}`),a&&(n+=`; domain=${a}`),s&&(n+=\"; secure\"),document.cookie=n}static remove(e,t){Fe.set(e,\"\",Object.assign({expires:new Date(0)},t))}}var Le=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Ve{constructor(e,t){this.paymentIntegrationService=e,this.braintreeIntegrationService=t}getDeviceSessionId(){return Le(this,void 0,void 0,function*(){const e=this.paymentIntegrationService.getState().getCart();return this.braintreeIntegrationService.getSessionId(null==e?void 0:e.id)})}initializeBraintreeFastlaneOrThrow(e,t){return Le(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState(),n=i.getCart(),{clientToken:r,config:o}=i.getPaymentMethodOrThrow(e);if(!r)throw new U(j.MissingPaymentMethod);this.methodId=e,this.braintreeIntegrationService.initialize(r),this.braintreeFastlane=yield this.braintreeIntegrationService.getBraintreeFastlane(null==n?void 0:n.id,o.testMode,t)})}getBraintreeFastlaneOrThrow(){if(!this.braintreeFastlane)throw new g;return this.braintreeFastlane}getBraintreeFastlaneComponentOrThrow(){return this.getBraintreeFastlaneOrThrow().FastlaneCardComponent}runPayPalAuthenticationFlowOrThrow(e,t){var i;return Le(this,void 0,void 0,function*(){try{const n=this.getMethodIdOrThrow(),r=this.getBraintreeFastlaneOrThrow(),{lookupCustomerByEmail:o,triggerAuthenticationFlow:a}=r.identity,s=this.paymentIntegrationService.getState(),d=s.getCartOrThrow(),l=s.getCustomer(),c=s.getBillingAddress(),{isFastlaneShippingOptionAutoSelectEnabled:u}=s.getPaymentMethodOrThrow(n).initializationData||{},h=e||(null==l?void 0:l.email)||(null==c?void 0:c.email)||\"\",{customerContextId:y}=yield o(h);if(!y)return yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:O.UNRECOGNIZED,addresses:[],instruments:[]}),void this.saveSessionIdToCookies(d.id);const{authenticationState:m,profileData:p}=yield a(y),g=(null===(i=null==p?void 0:p.shippingAddress)||void 0===i?void 0:i.phoneNumber)||\"\";if(m===O.CANCELED)return yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:m,addresses:[],instruments:[]}),void this.removeSessionIdFromCookies();const v=this.mapPayPalToBcAddress([p.shippingAddress],[g])||[],f=this.getPayPalBillingAddresses(p),b=f?this.mapPayPalToBcAddress([f],[g]):[],w=p.card?this.mapPayPalToBcInstrument(n,[p.card]):[],C=this.mergeShippingAndBillingAddresses(v,b);if(this.saveSessionIdToCookies(d.id),yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:m,addresses:C,instruments:w}),b.length>0&&d.lineItems.physicalItems.length>0&&(yield this.paymentIntegrationService.updateBillingAddress(b[0])),b.length>0&&d.lineItems.digitalItems.length>0&&0===d.lineItems.physicalItems.length){const{firstName:e,lastName:t}=C[0],i=Object.assign(Object.assign({},b[0]),{firstName:e,lastName:t});yield this.paymentIntegrationService.updateBillingAddress(i)}v.length>0&&d.lineItems.physicalItems.length>0&&(yield this.paymentIntegrationService.updateShippingAddress(v[0]),t&&u&&(yield this.setShippingOption()))}catch(e){}})}getSessionIdFromCookies(){return Fe.get(\"bc-fastlane-sessionId\")||\"\"}saveSessionIdToCookies(e){const t=new Date;t.setDate(t.getDate()+14),Fe.set(\"bc-fastlane-sessionId\",e,{expires:t,secure:!0})}removeSessionIdFromCookies(){Fe.remove(\"bc-fastlane-sessionId\")}mapPayPalToBcInstrument(e,t){if(t)return t.map(t=>{const{id:i,paymentSource:n}=t,{brand:r,expiry:o,lastDigits:a,binDetails:s}=n.card,[d,l]=o.split(\"-\");return{bigpayToken:i,brand:r,defaultInstrument:!1,expiryMonth:l,expiryYear:d,iin:(null==s?void 0:s.bin)||\"\",last4:a,method:e,provider:e,trustedShippingAddress:!1,type:\"card\",untrustedShippingCardVerificationMode:_e.PAN}})}mapPayPalToBcAddress(e,t){if(!e)return[];const i=this.paymentIntegrationService.getState().getCountries()||[],n=e=>{const t=i.find(t=>t.code===e);return(null==t?void 0:t.name)||\"\"};return e.map(e=>({id:Date.now(),type:\"paypal-address\",firstName:e.firstName||\"\",lastName:e.lastName||\"\",company:e.company||\"\",address1:e.streetAddress,address2:e.extendedAddress||\"\",city:e.locality,stateOrProvince:e.region,stateOrProvinceCode:e.region,country:n(e.countryCodeAlpha2),countryCode:e.countryCodeAlpha2,postalCode:e.postalCode,phone:t&&t[0]||\"\",customFields:[]}))}getPayPalBillingAddresses(e){const{card:t,name:i}=e||{};if(!t)return;const{firstName:r,lastName:o}=t.paymentSource.card.billingAddress,{firstName:a,lastName:s}=i||{},{shippingAddress:d}=e||{},l=Object.assign(Object.assign({},t.paymentSource.card.billingAddress),{firstName:r||a,lastName:o||s});return d&&(0,lodash__WEBPACK_IMPORTED_MODULE_1__.isEqual)(this.normalizeAddress(l),this.normalizeAddress(d))?d:l}normalizeAddress(e){return (0,lodash__WEBPACK_IMPORTED_MODULE_1__.omit)(e,[\"id\"])}mergeShippingAndBillingAddresses(e,t){const i=t.filter(t=>!e.some(e=>(0,lodash__WEBPACK_IMPORTED_MODULE_1__.isEqual)(this.normalizeAddress(e),this.normalizeAddress(t))));return[...e,...i]}getMethodIdOrThrow(){if(!this.methodId)throw new V('Unable to proceed because \"methodId\" argument is not provided.');return this.methodId}setShippingOption(){var e;return Le(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState().getConsignments()||[],i=(null===(e=t[0])||void 0===e?void 0:e.availableShippingOptions)||[],n=i.find(e=>e.isRecommended);if(n||i.length){const e=n||i[0];yield this.paymentIntegrationService.selectShippingOption(e.id)}})}}const je=L(t=>{const i=window,n=new F(t),r=new de(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),i),o=new Ve(t,r),a=new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),s=new B(a);return new xe(t,o,s)},[{id:\"braintreeacceleratedcheckout\"}]);var Ue=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Re{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i}initialize(e){return Ue(this,void 0,void 0,function*(){const{braintreevisacheckout:t,methodId:i}=e;if(!t)throw new V('Unable to initialize payment because \"options.braintreevisacheckout\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(i);const n=this.paymentIntegrationService.getState();this.paymentMethod=n.getPaymentMethodOrThrow(i);const r=n.getCheckoutOrThrow(),a=n.getStoreConfigOrThrow(),{clientToken:s,config:d}=this.paymentMethod||{};if(!s)throw new U(j.MissingPaymentMethod);const{onError:l=lodash__WEBPACK_IMPORTED_MODULE_1__.noop,onPaymentSelect:c=lodash__WEBPACK_IMPORTED_MODULE_1__.noop}=t;this.braintreeSdk.initialize(s);const u=yield this.braintreeSdk.getBraintreeVisaCheckout(),h=yield this.braintreeSdk.getVisaCheckoutSdk(null==d?void 0:d.testMode),y=u.createInitOptions({settings:{locale:a.storeProfile.storeLanguage,shipping:{collectShipping:!1}},paymentRequest:{currencyCode:a.currency.code,subtotal:String(r.subtotal)}});yield h.init(y),h.on(\"payment.success\",e=>this.tokenizePayment(u,e).then(()=>Promise.all([this.paymentIntegrationService.loadCheckout(),this.paymentIntegrationService.loadPaymentMethod(i)])).then(()=>c()).catch(e=>l(e))),h.on(\"payment.error\",(e,t)=>l(t))})}execute(e,t){var i,n;return Ue(this,void 0,void 0,function*(){const{payment:r}=e,o=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!r)throw new V('Unable to submit payment because \"payload.payment\" argument is not provided.');if(!(null===(n=null===(i=this.paymentMethod)||void 0===i?void 0:i.initializationData)||void 0===n?void 0:n.nonce))throw new U(j.MissingPaymentMethod);const{nonce:a}=this.paymentMethod.initializationData;try{yield this.paymentIntegrationService.submitOrder(o,t),yield this.paymentIntegrationService.submitPayment(Object.assign(Object.assign({},r),{paymentData:{nonce:a}}))}catch(e){this.handleError(e)}})}finalize(){return Promise.reject(new W)}deinitialize(){return Ue(this,void 0,void 0,function*(){yield this.braintreeSdk.deinitialize()})}tokenizePayment(e,t){return Ue(this,void 0,void 0,function*(){return Promise.all([e.tokenize(t),this.braintreeSdk.getDataCollectorOrThrow()]).then(([e,t])=>{const i=this.paymentIntegrationService.getState(),n=i.getShippingAddress(),r=i.getBillingAddress(),{shippingAddress:o=this.mapToVisaCheckoutAddress(n),billingAddress:a=this.mapToVisaCheckoutAddress(r)}=e;return this.postForm(Object.assign(Object.assign({},e),{shippingAddress:o,billingAddress:a}),t)})})}mapToVisaCheckoutAddress(e){return e?{firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phone,streetAddress:e.address1,extendedAddress:e.address2,locality:e.city,region:e.stateOrProvinceCode,countryCode:e.countryCode,postalCode:e.postalCode}:{}}postForm(e,t){const{userData:i,billingAddress:n,shippingAddress:r,details:o}=e,{userEmail:a}=i,{deviceData:s}=t;return this.formPoster.postForm(\"/checkout.php\",{payment_type:e.type,nonce:e.nonce,provider:\"braintreevisacheckout\",action:\"set_external_checkout\",device_data:s,card_information:JSON.stringify({type:o.cardType,number:o.lastTwo}),billing_address:JSON.stringify(this.getAddress(a,n)),shipping_address:JSON.stringify(this.getAddress(a,r))})}getAddress(e,t={}){return{email:e,first_name:t.firstName,last_name:t.lastName,phone_number:t.phoneNumber,address_line_1:t.streetAddress,address_line_2:t.extendedAddress,city:t.locality,state:t.region,country_code:t.countryCode,postal_code:t.postalCode}}handleError(e){if(e instanceof Error&&\"BraintreeError\"===e.name)throw new $(e.message);throw e}}const He=L(t=>{const i=window,n=new F(t),r=new B(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n));return new Re(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),r)},[{id:\"braintreevisacheckout\"}]);var We=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class qe{constructor(e,t){this.paymentIntegrationService=e,this.braintreeIntegrationService=t}initialize(e){return We(this,void 0,void 0,function*(){const{methodId:t}=e;yield this.paymentIntegrationService.loadPaymentMethod(t);const i=this.paymentIntegrationService.getState();this.venmoOptions=e.braintreevenmo;const n=i.getPaymentMethodOrThrow(t);yield this.initializeBraintreeVenmo(n)})}execute(e){return We(this,void 0,void 0,function*(){const{payment:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!t)throw new R([\"payment\"]);try{const e=yield this.preparePaymentData(t);yield this.paymentIntegrationService.submitOrder(i),yield this.paymentIntegrationService.submitPayment(e)}catch(e){this.handleError(e)}})}finalize(){return Promise.reject(new W)}deinitialize(){return We(this,void 0,void 0,function*(){return yield this.braintreeIntegrationService.teardown(),Promise.resolve()})}handleError(e){if(!D(e))throw e;if(\"PAYPAL_POPUP_CLOSED\"===e.code)throw new Q(e.message);throw new $(e.message)}initializeBraintreeVenmo(e){var t;return We(this,void 0,void 0,function*(){const{clientToken:i}=e;if(!i)throw new U(j.MissingPaymentMethod);const n=x(this.paymentIntegrationService.getState().getStoreConfigOrThrow().checkoutSettings.features,\"PAYPAL-5406.braintree_venmo_web_fallback_support\");try{this.braintreeIntegrationService.initialize(i),this.braintreeVenmoCheckout=yield this.braintreeIntegrationService.getVenmoCheckout(Object.assign(Object.assign({},void 0!==(null===(t=this.venmoOptions)||void 0===t?void 0:t.allowDesktop)?{allowDesktop:this.venmoOptions.allowDesktop}:{}),n?{mobileWebFallBack:n}:{}))}catch(e){this.handleError(e)}})}preparePaymentData(e){return We(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState(),{nonce:i}=t.getPaymentMethodOrThrow(e.methodId);if(i)return Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(i)});const n=yield this.braintreeVenmoTokenize(),r=yield this.braintreeIntegrationService.getSessionId();return Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(n.nonce,n.details.email,r)})})}formattedPayload(e,t,i){return{formattedPayload:{vault_payment_instrument:null,set_as_default_stored_instrument:null,device_info:i||null,paypal_account:{token:e,email:t||null}}}}braintreeVenmoTokenize(){return new Promise((e,t)=>{var i;null===(i=this.braintreeVenmoCheckout)||void 0===i||i.tokenize((i,n)=>{if(i)return t(i);e(n)})})}}const $e=L(t=>{const i=window,n=(0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),r=new F(t),o=new z(n,i,r),a=new de(o,i);return new qe(t,a)},[{id:\"braintreevenmo\"}]);var Ge=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Ye{constructor(e,t,i){this.paymentIntegrationService=e,this.braintreeIntegrationService=t,this.braintreeHostedForm=i}initialize(e){return Ge(this,void 0,void 0,function*(){const{methodId:t,gatewayId:i,braintree:n}=e;yield this.paymentIntegrationService.loadPaymentMethod(t);const r=this.paymentIntegrationService.getState();this.paymentMethod=r.getPaymentMethodOrThrow(t);const{clientToken:o}=this.paymentMethod;if(!o)throw new U(j.MissingPaymentMethod);this.threeDSecure=null==n?void 0:n.threeDSecure;try{this.braintreeIntegrationService.initialize(o,this.threeDSecure),this.isHostedPaymentFormEnabled(t,i)&&(null==n?void 0:n.form)&&(yield this.braintreeHostedForm.initialize(n.form,n.unsupportedCardBrands,o),this.isHostedFormInitialized=this.braintreeHostedForm.isInitialized()),this.is3dsEnabled=this.paymentMethod.config.is3dsEnabled,this.deviceSessionId=yield this.braintreeIntegrationService.getSessionId(),this.shouldInitializeBraintreeFastlane()&&(yield this.initializeBraintreeFastlaneOrThrow(t))}catch(e){return this.handleError(e,t)}})}execute(e){return Ge(this,void 0,void 0,function*(){const{payment:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!t)throw new R([\"payment\"]);this.isHostedFormInitialized&&this.braintreeHostedForm.validate(),yield this.paymentIntegrationService.submitOrder(i);const n=this.paymentIntegrationService.getState(),r=n.getBillingAddressOrThrow(),o=n.getOrderOrThrow().orderAmount;try{const e=this.isHostedFormInitialized?yield this.prepareHostedPaymentData(t,r,o):yield this.preparePaymentData(t,r,o);yield this.paymentIntegrationService.submitPayment(Object.assign(Object.assign({},t),{paymentData:e}))}catch(e){return this.processAdditionalAction(e,t,o)}})}finalize(){return Promise.reject(new W)}deinitialize(){return Ge(this,void 0,void 0,function*(){return this.isHostedFormInitialized=!1,yield Promise.all([this.braintreeIntegrationService.teardown(),this.braintreeHostedForm.deinitialize()]),Promise.resolve()})}handleError(e,t){if(pe(e)){if(!(t&&this.paymentIntegrationService.getState().isPaymentMethodInitialized({methodId:t})||\"HOSTED_FIELDS_INVALID_FIELD_SELECTOR\"!==e.code))return;throw new $(e.message)}throw e}preparePaymentData(e,t,i){return Ge(this,void 0,void 0,function*(){const{paymentData:n}=e,r={deviceSessionId:this.deviceSessionId};if(this.isSubmittingWithStoredCard(e))return Object.assign(Object.assign({},r),n);const{shouldSaveInstrument:o=!1,shouldSetAsDefaultInstrument:a=!1}=q(n)?n:{},{nonce:s}=this.shouldPerform3DSVerification(e)?yield this.braintreeIntegrationService.verifyCard(e,t,i):yield this.braintreeIntegrationService.tokenizeCard(e,t);return Object.assign(Object.assign({},r),{nonce:s,shouldSaveInstrument:o,shouldSetAsDefaultInstrument:a})})}prepareHostedPaymentData(e,t,i){return Ge(this,void 0,void 0,function*(){const{paymentData:n}=e,r={deviceSessionId:this.deviceSessionId};if(this.isSubmittingWithStoredCard(e)){const{nonce:e}=yield this.braintreeHostedForm.tokenizeForStoredCardVerification();return Object.assign(Object.assign(Object.assign({},r),n),{nonce:e})}const{shouldSaveInstrument:o=!1,shouldSetAsDefaultInstrument:a=!1}=q(n)?n:{},{nonce:s}=this.shouldPerform3DSVerification(e)?yield this.verifyCardWithHostedForm(t,i):yield this.braintreeHostedForm.tokenize(t);return Object.assign(Object.assign({},r),{shouldSaveInstrument:o,shouldSetAsDefaultInstrument:a,nonce:s})})}verifyCardWithHostedForm(e,t){return Ge(this,void 0,void 0,function*(){const i=yield this.braintreeHostedForm.tokenize(e);return this.braintreeIntegrationService.challenge3DSVerification(i,t)})}processAdditionalAction(e,t,i){return Ge(this,void 0,void 0,function*(){if(!(e=>\"object\"==typeof e&&null!==e&&\"body\"in e)(e)||!(0,lodash__WEBPACK_IMPORTED_MODULE_1__.some)(e.body.errors,{code:\"three_d_secure_required\"}))return this.handleError(e);try{const{payer_auth_request:n}=function(e){return\"object\"==typeof e&&null!==e&&\"name\"in e&&\"body\"in e&&\"status\"in e.body&&\"three_ds_result\"in e.body&&\"payer_auth_request\"in e.body.three_ds_result&&\"errors\"in e.body}(e)&&e.body.three_ds_result||{},{paymentData:r}=t,o=this.paymentIntegrationService.getState();if(!r||!H(r))throw new R([\"instrumentId\"]);const a=o.getCardInstrumentOrThrow(r.instrumentId),{nonce:s}=yield this.braintreeIntegrationService.challenge3DSVerification({nonce:n||\"\",bin:a.iin},i);yield this.paymentIntegrationService.submitPayment(Object.assign(Object.assign({},t),{paymentData:{deviceSessionId:this.deviceSessionId,nonce:s}}))}catch(e){return this.handleError(e)}})}isHostedPaymentFormEnabled(e,t){return!!e&&!0===this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e,t).config.isHostedFormEnabled}isSubmittingWithStoredCard(e){return!(!e.paymentData||!H(e.paymentData))}shouldPerform3DSVerification(e){return!(!this.is3dsEnabled||this.isSubmittingWithStoredCard(e))}shouldInitializeBraintreeFastlane(){var e;const t=this.paymentIntegrationService.getState().getPaymentProviderCustomerOrThrow(),i=De(t)?t:{};return(null===(e=this.paymentMethod)||void 0===e?void 0:e.initializationData.isAcceleratedCheckoutEnabled)&&!(null==i?void 0:i.authenticationState)}initializeBraintreeFastlaneOrThrow(e){return Ge(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState(),i=t.getCartOrThrow(),n=t.getPaymentMethodOrThrow(e),{clientToken:r,config:o}=n;if(!r)throw new U(j.MissingPaymentMethod);this.braintreeIntegrationService.initialize(r,this.threeDSecure),yield this.braintreeIntegrationService.getBraintreeFastlane(i.id,o.testMode)})}}function Je(e){return\"cardNumber\"in e}function Ke(e){if(!D(e))return!1;const{details:t}=e;return void 0===t||\"object\"==typeof t&&null!==t&&void 0===t.invalidFieldKeys||(i=t,Array.isArray(i)&&i.every(e=>\"string\"==typeof e));// removed by dead control flow\n var i; }var Xe,Qe=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};!function(e){e[e.CreditCard=0]=\"CreditCard\",e[e.StoredCardVerification=1]=\"StoredCardVerification\"}(Xe||(Xe={}));class Ze{constructor(e,t){this.braintreeScriptLoader=e,this.braintreeSDKVersionManager=t,this.isInitializedHostedForm=!1,this.handleBlur=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onBlur)||void 0===i||i.call(t,{fieldType:this.mapFieldType(e.emittedBy),errors:this.mapErrors(e.fields)})},this.handleFocus=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onFocus)||void 0===i||i.call(t,{fieldType:this.mapFieldType(e.emittedBy)})},this.handleCardTypeChange=e=>{var t,i;const n=1===e.cards.length?e.cards[0].type.replace(/^master-card$/,\"mastercard\"):void 0;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onCardTypeChange)||void 0===i||i.call(t,{cardType:n})},this.handleInputSubmitRequest=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onEnter)||void 0===i||i.call(t,{fieldType:this.mapFieldType(e.emittedBy)})},this.handleValidityChange=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onValidate)||void 0===i||i.call(t,{isValid:this.isValidForm(e),errors:this.mapValidationErrors(e.fields)})}}initialize(e,t,n){var r,o,a,s,d;return Qe(this,void 0,void 0,function*(){this.clientToken=n,this.formOptions=e,this.type=Je(e.fields)?Xe.CreditCard:Xe.StoredCardVerification;const l=this.mapFieldOptions(e.fields,t);(0,lodash__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(l)?this.isInitializedHostedForm=!1:(this.cardFields=yield this.createHostedFields({fields:l,styles:e.styles&&this.mapStyleOptions(e.styles)}),null===(r=this.cardFields)||void 0===r||r.on(\"blur\",this.handleBlur),null===(o=this.cardFields)||void 0===o||o.on(\"focus\",this.handleFocus),null===(a=this.cardFields)||void 0===a||a.on(\"cardTypeChange\",this.handleCardTypeChange),null===(s=this.cardFields)||void 0===s||s.on(\"validityChange\",this.handleValidityChange),null===(d=this.cardFields)||void 0===d||d.on(\"inputSubmitRequest\",this.handleInputSubmitRequest),this.isInitializedHostedForm=!0)})}isInitialized(){return!!this.isInitializedHostedForm}deinitialize(){var e;return Qe(this,void 0,void 0,function*(){this.isInitializedHostedForm&&(this.isInitializedHostedForm=!1,yield null===(e=this.cardFields)||void 0===e?void 0:e.teardown())})}validate(){if(!this.cardFields)throw new M(C.PaymentNotInitialized);const e=this.cardFields.getState();if(!this.isValidForm(e)){this.handleValidityChange(e);const t=this.mapValidationErrors(e.fields);throw new X(t)}}tokenize(e){var t,i,n,o,a;return Qe(this,void 0,void 0,function*(){if(!this.cardFields)throw new M(C.PaymentNotInitialized);try{const o=yield this.cardFields.tokenize((0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)({billingAddress:e&&this.mapBillingAddress(e)},lodash__WEBPACK_IMPORTED_MODULE_1__.isNil));return null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onValidate)||void 0===i||i.call(t,{isValid:!0,errors:{}}),{nonce:o.nonce,bin:null===(n=o.details)||void 0===n?void 0:n.bin}}catch(e){if(Ke(e)){const t=this.mapTokenizeError(e);if(t)throw null===(a=null===(o=this.formOptions)||void 0===o?void 0:o.onValidate)||void 0===a||a.call(o,{isValid:!1,errors:t}),new X(t)}throw e}})}tokenizeForStoredCardVerification(){var e,t,i,n,r;return Qe(this,void 0,void 0,function*(){if(!this.cardFields)throw new M(C.PaymentNotInitialized);try{const n=yield this.cardFields.tokenize();return null===(t=null===(e=this.formOptions)||void 0===e?void 0:e.onValidate)||void 0===t||t.call(e,{isValid:!0,errors:{}}),{nonce:n.nonce,bin:null===(i=n.details)||void 0===i?void 0:i.bin}}catch(e){if(Ke(e)){const t=this.mapTokenizeError(e,!0);if(t)throw null===(r=null===(n=this.formOptions)||void 0===n?void 0:n.onValidate)||void 0===r||r.call(n,{isValid:!1,errors:t}),new X(t)}throw e}})}createHostedFields(e){return Qe(this,void 0,void 0,function*(){const t=yield this.getClient(),i=yield this.braintreeScriptLoader.loadHostedFields(),n=this.braintreeSDKVersionManager.getSDKVersion()===v?Object.assign(Object.assign({},e),{preventCursorJumps:!0}):e;return i.create(Object.assign(Object.assign({},n),{client:t}))})}getClient(){return Qe(this,void 0,void 0,function*(){if(!this.clientToken)throw new M(C.PaymentNotInitialized);if(!this.client){const e=yield this.braintreeScriptLoader.loadClient();this.client=e.create({authorization:this.clientToken})}return this.client})}mapBillingAddress(e){return{countryName:e.country,postalCode:e.postalCode,streetAddress:e.address2?`${e.address1} ${e.address2}`:e.address1}}mapFieldOptions(e,t){if(Je(e)){const i={};return null==t||t.forEach(e=>{(e=>Object.values(T).includes(e))(e)&&(i[e]=!1)}),(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)({number:Object.assign({container:`#${e.cardNumber.containerId}`,placeholder:e.cardNumber.placeholder,internalLabel:e.cardNumber.accessibilityLabel},Object.keys(i).length>0?{supportedCardBrands:i}:{}),expirationDate:{container:`#${e.cardExpiry.containerId}`,placeholder:e.cardExpiry.placeholder,internalLabel:e.cardExpiry.accessibilityLabel},cvv:e.cardCode&&{container:`#${e.cardCode.containerId}`,placeholder:e.cardCode.placeholder,internalLabel:e.cardCode.accessibilityLabel},cardholderName:{container:`#${e.cardName.containerId}`,placeholder:e.cardName.placeholder,internalLabel:e.cardName.accessibilityLabel}},lodash__WEBPACK_IMPORTED_MODULE_1__.isNil)}return (0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)({number:e.cardNumberVerification&&{container:`#${e.cardNumberVerification.containerId}`,placeholder:e.cardNumberVerification.placeholder},cvv:e.cardCodeVerification&&{container:`#${e.cardCodeVerification.containerId}`,placeholder:e.cardCodeVerification.placeholder}},lodash__WEBPACK_IMPORTED_MODULE_1__.isNil)}mapStyleOptions(e){const t=(e={})=>(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)({color:e.color,\"font-family\":e.fontFamily,\"font-size\":e.fontSize,\"font-weight\":e.fontWeight},lodash__WEBPACK_IMPORTED_MODULE_1__.isNil);return{input:t(e.default),\".invalid\":t(e.error),\":focus\":t(e.focus)}}mapFieldType(e){switch(e){case\"number\":return this.type===Xe.StoredCardVerification?m.CardNumberVerification:m.CardNumber;case\"expirationDate\":return m.CardExpiry;case\"cvv\":return this.type===Xe.StoredCardVerification?m.CardCodeVerification:m.CardCode;case\"cardholderName\":return m.CardName;default:throw new Error(\"Unexpected field type\")}}mapErrors(e){const t={};if(e)for(const[i,n]of Object.entries(e))if(n&&this.isValidParam(i)){const{isValid:e,isEmpty:r,isPotentiallyValid:o}=n;t[i]={isValid:e,isEmpty:r,isPotentiallyValid:o}}return t}mapValidationErrors(e){return Object.keys(e).reduce((t,i)=>{var n;return Object.assign(Object.assign({},t),{[this.mapFieldType(i)]:(null===(n=e[i])||void 0===n?void 0:n.isValid)?void 0:[this.createInvalidError(this.mapFieldType(i))]})},{})}mapTokenizeError(e,t=!1){var i,n;if(\"HOSTED_FIELDS_FIELDS_EMPTY\"===e.code){const e=[this.createRequiredError(this.mapFieldType(\"cvv\"))];return t?{[this.mapFieldType(\"cvv\")]:e}:{[this.mapFieldType(\"cvv\")]:e,[this.mapFieldType(\"expirationDate\")]:[this.createRequiredError(this.mapFieldType(\"expirationDate\"))],[this.mapFieldType(\"number\")]:[this.createRequiredError(this.mapFieldType(\"number\"))],[this.mapFieldType(\"cardholderName\")]:[this.createRequiredError(this.mapFieldType(\"cardholderName\"))]}}return null===(n=null===(i=e.details)||void 0===i?void 0:i.invalidFieldKeys)||void 0===n?void 0:n.reduce((e,t)=>{const i=this.mapFieldType(t);return Object.assign(Object.assign({},e),{[i]:[this.createInvalidError(i)]})},{})}createRequiredError(e){var t;return{fieldType:e,message:null!==(t={[m.CardCode]:\"CVV is required\",[m.CardCodeVerification]:\"CVV is required\",[m.CardNumber]:\"Credit card number is required\",[m.CardNumberVerification]:\"Credit card number is required\",[m.CardExpiry]:\"Expiration date is required\",[m.CardName]:\"Full name is required\"}[e])&&void 0!==t?t:\"Field is required\",type:\"required\"}}createInvalidError(e){var t,i,n,r;const o={[m.CardCode]:{message:\"Invalid card code\",type:\"invalid_card_code\"},[m.CardCodeVerification]:{message:\"Invalid card code\",type:\"invalid_card_code\"},[m.CardNumber]:{message:\"Invalid card number\",type:\"invalid_card_number\"},[m.CardNumberVerification]:{message:\"Invalid card number\",type:\"invalid_card_number\"},[m.CardExpiry]:{message:\"Invalid card expiry\",type:\"invalid_card_expiry\"},[m.CardName]:{message:\"Invalid card name\",type:\"invalid_card_name\"}};return{fieldType:e,message:null!==(i=null===(t=o[e])||void 0===t?void 0:t.message)&&void 0!==i?i:\"Invalid field\",type:null!==(r=null===(n=o[e])||void 0===n?void 0:n.type)&&void 0!==r?r:\"invalid\"}}isValidForm(e){return Object.keys(e.fields).every(t=>{var i;return null===(i=e.fields[t])||void 0===i?void 0:i.isValid})}isValidParam(e){return[\"number\",\"cvv\",\"expirationDate\",\"postalCode\",\"cardholderName\",\"cardType\"].includes(e)}}const et=L(t=>{const i=window,n=new F(t),r=new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),o=new de(r,i),a=new Ze(r,n);return new Ye(t,o,a)},[{id:\"braintree\"}]);var tt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class it{constructor(e,t,i,n){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeHostWindow=n}initialize(e){return tt(this,void 0,void 0,function*(){const{braintreepaypal:t,methodId:i}=e,{container:n,onError:r}=t||{};if(!i)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new V('Unable to initialize payment because \"options.braintreepaypal\" argument is not provided.');if(!n)throw new V('Unable to initialize payment because \"options.braintreepaypal.container\" argument is not provided.');let o,a=this.paymentIntegrationService.getState();try{if(o=a.getPaymentMethodOrThrow(i),!o.clientToken)throw new U(j.MissingPaymentToken)}catch(e){a=yield this.paymentIntegrationService.loadPaymentMethod(i),o=a.getPaymentMethodOrThrow(i)}const{clientToken:s,config:d,initializationData:l}=o,{paymentButtonStyles:c}=l||{},{checkoutTopButtonStyles:u}=c||{};if(!s||!l)throw new U(j.MissingPaymentMethod);const h={currency:a.getCartOrThrow().currency.code,intent:l.intent,isCreditEnabled:l.isCreditEnabled,commit:!1};this.braintreeIntegrationService.initialize(s),yield this.braintreeIntegrationService.getPaypalCheckout(h,e=>{this.renderPayPalButton(e,t,i,Boolean(d.testMode),u)},e=>this.handleError(e,n,r))})}deinitialize(){return tt(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}signIn(e,t){return tt(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return tt(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}renderPayPalButton(e,t,i,n,r){const{container:a,onClick:s=lodash__WEBPACK_IMPORTED_MODULE_1__.noop}=t,{paypal:d}=this.braintreeHostWindow,l=null==d?void 0:d.FUNDING.PAYPAL;if(d&&l){const o=d.Buttons({env:this.braintreeIntegrationService.getBraintreeEnv(n),fundingSource:l,style:Object.assign(Object.assign({},r),{height:40}),createOrder:()=>this.setupPayment(e,t,i),onApprove:n=>this.tokenizePayment(n,e,i,t),onClick:s});o.isEligible()&&o.render(`#${a}`)}else this.braintreeIntegrationService.removeElement(a)}setupPayment(e,t,i){var n;return tt(this,void 0,void 0,function*(){try{yield this.paymentIntegrationService.loadDefaultCheckout();const t=this.paymentIntegrationService.getState(),r=t.getCheckoutOrThrow().outstandingBalance,o=t.getCartOrThrow().currency.code,a=t.getCustomer(),s=t.getPaymentMethodOrThrow(i),d=null==a?void 0:a.addresses[0],l=d?this.braintreeIntegrationService.mapToBraintreeShippingAddressOverride(d):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:l,amount:r,currency:o,offerCredit:!1,intent:null===(n=s.initializationData)||void 0===n?void 0:n.intent})}catch(e){const{container:i,onError:n}=t;this.handleError(e,i,n)}})}tokenizePayment(e,t,i,n){return tt(this,void 0,void 0,function*(){try{const{deviceData:n}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),r=yield t.tokenizePayment(e),{details:o,nonce:a}=r,s=this.braintreeIntegrationService.mapToLegacyBillingAddress(o),d=this.braintreeIntegrationService.mapToLegacyShippingAddress(o);return this.formPoster.postForm(\"/checkout.php\",{payment_type:\"paypal\",provider:i,action:\"set_external_checkout\",nonce:a,device_data:n,billing_address:JSON.stringify(s),shipping_address:JSON.stringify(d)}),r}catch(e){const{container:t,onError:i}=n;this.handleError(e,t,i)}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!D(e))throw e;i(e)}}const nt=L(t=>{const i=window,n=new F(t),r=new de(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),i);return new it(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),r,i)},[{id:\"braintreepaypal\"}]);var rt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ot{constructor(e,t,i,n){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeHostWindow=n}initialize(e){return rt(this,void 0,void 0,function*(){const{braintreepaypalcredit:t,methodId:i}=e,{container:n,onError:r}=t||{};if(!i)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new V('Unable to initialize payment because \"options.braintreepaypalcredit\" argument is not provided.');if(!n)throw new V('Unable to initialize payment because \"options.braintreepaypalcredit.container\" argument is not provided.');let o,a=this.paymentIntegrationService.getState();try{if(o=a.getPaymentMethodOrThrow(i),!o.clientToken)throw new U(j.MissingPaymentToken)}catch(e){a=yield this.paymentIntegrationService.loadPaymentMethod(i),o=a.getPaymentMethodOrThrow(i)}const{clientToken:s,config:d,initializationData:l}=o,{paymentButtonStyles:c}=l||{},{checkoutTopButtonStyles:u}=c||{};if(!s||!l)throw new U(j.MissingPaymentMethod);const h={currency:a.getCartOrThrow().currency.code,intent:l.intent,isCreditEnabled:l.isCreditEnabled,commit:!1};this.braintreeIntegrationService.initialize(s),yield this.braintreeIntegrationService.getPaypalCheckout(h,e=>{this.renderPayPalButton(e,t,i,Boolean(d.testMode),Object.assign(Object.assign({},u),{height:40}))},e=>this.handleError(e,n,r))})}deinitialize(){return rt(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}signIn(e,t){return rt(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return rt(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}renderPayPalButton(e,t,i,n,r){const{container:a,onClick:s=lodash__WEBPACK_IMPORTED_MODULE_1__.noop}=t,{paypal:d}=this.braintreeHostWindow;let l=!1;d&&[d.FUNDING.PAYLATER,d.FUNDING.CREDIT].forEach(o=>{if(!l){const c=d.Buttons({env:n?\"sandbox\":\"production\",fundingSource:o,style:r,createOrder:()=>this.setupPayment(e,t,i),onApprove:n=>this.tokenizePayment(n,e,i,t),onClick:s});c.isEligible()&&(c.render(`#${a}`),l=!0)}}),d&&l||this.braintreeIntegrationService.removeElement(a)}setupPayment(e,t,i){var n;return rt(this,void 0,void 0,function*(){try{yield this.paymentIntegrationService.loadDefaultCheckout();const t=this.paymentIntegrationService.getState(),r=t.getCheckoutOrThrow().outstandingBalance,o=t.getCartOrThrow().currency.code,a=t.getCustomer(),s=t.getPaymentMethodOrThrow(i),d=null==a?void 0:a.addresses[0],l=d?this.braintreeIntegrationService.mapToBraintreeShippingAddressOverride(d):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:l,amount:r,currency:o,offerCredit:!0,intent:null===(n=s.initializationData)||void 0===n?void 0:n.intent})}catch(e){const{container:i,onError:n}=t;this.handleError(e,i,n)}})}tokenizePayment(e,t,i,n){return rt(this,void 0,void 0,function*(){try{const{deviceData:n}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),r=yield t.tokenizePayment(e),{details:o,nonce:a}=r,s=this.braintreeIntegrationService.mapToLegacyBillingAddress(o),d=this.braintreeIntegrationService.mapToLegacyShippingAddress(o);return this.formPoster.postForm(\"/checkout.php\",{payment_type:\"paypal\",provider:i,action:\"set_external_checkout\",nonce:a,device_data:n,billing_address:JSON.stringify(s),shipping_address:JSON.stringify(d)}),r}catch(e){const{container:t,onError:i}=n;this.handleError(e,t,i)}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!D(e))throw e;i(e)}}const at=L(t=>{const i=window,n=new F(t),r=new de(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),i);return new ot(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),r,i)},[{id:\"braintreepaypalcredit\"}]);var st=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class dt{constructor(e,t){this.paymentIntegrationService=e,this.braintreeFastlaneUtils=t,this.isAcceleratedCheckoutEnabled=!1}initialize({methodId:e,braintreefastlane:t}){var i;return st(this,void 0,void 0,function*(){if(!e)throw new V('Unable to proceed because \"methodId\" argument is not provided.');const n=yield this.getValidPaymentMethodOrThrow(e),{isAcceleratedCheckoutEnabled:r,isFastlaneStylingEnabled:o}=n.initializationData||{},a=o?null===(i=n.initializationData)||void 0===i?void 0:i.fastlaneStyles:void 0;this.isAcceleratedCheckoutEnabled=!!r;try{if(this.isAcceleratedCheckoutEnabled){const e=Me(a,null==t?void 0:t.styles);yield this.braintreeFastlaneUtils.initializeBraintreeFastlaneOrThrow(n.id,e)}}catch(e){}return Promise.resolve()})}deinitialize(){return st(this,void 0,void 0,function*(){return Promise.resolve()})}signIn(e,t){return st(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return st(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){return st(this,void 0,void 0,function*(){const{checkoutPaymentMethodExecuted:t,continueWithCheckoutCallback:i}=e||{};if(\"function\"!=typeof i)throw new V('Unable to proceed because \"continueWithCheckoutCallback\" argument is not provided and it must be a function.');const n=this.paymentIntegrationService.getState().getCustomerOrThrow();if(this.isAcceleratedCheckoutEnabled&&n.isGuest){const e=yield this.shouldRunAuthenticationFlow();t&&\"function\"==typeof t&&t(),e&&(yield this.braintreeFastlaneUtils.runPayPalAuthenticationFlowOrThrow(void 0,!0))}i()})}shouldRunAuthenticationFlow(){var e;return st(this,void 0,void 0,function*(){const t=\"braintreeacceleratedcheckout\";try{yield this.paymentIntegrationService.loadPaymentMethod(t);const i=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t);return(null===(e=i.initializationData)||void 0===e?void 0:e.shouldRunAcceleratedCheckout)||!1}catch(e){return!1}})}getValidPaymentMethodOrThrow(e){return st(this,void 0,void 0,function*(){let t=e;try{yield this.paymentIntegrationService.loadPaymentMethod(t)}catch(i){t=\"braintree\"===e?\"braintreeacceleratedcheckout\":\"braintree\",yield this.paymentIntegrationService.loadPaymentMethod(t)}return this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t)})}}const lt=L(t=>{const i=window,n=new F(t),r=new de(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),i),o=new Ve(t,r);return new dt(t,o)},[{id:\"braintreeacceleratedcheckout\"},{id:\"braintree\"}]);class ct extends p{constructor(e){super(e||\"Not implemented.\"),this.name=\"NotImplementedError\",this.type=\"not_implemented\"}}var ut=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ht{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i,this.buttonClassName=\"visa-checkout-wrapper\",this.onError=lodash__WEBPACK_IMPORTED_MODULE_1__.noop}initialize(e){return ut(this,void 0,void 0,function*(){const{braintreevisacheckout:t,methodId:i}=e;if(!i)throw new V('Unable to proceed because \"methodId\" argument is not provided.');if(!t)throw new V('Unable to proceed because \"options.braintreevisacheckout\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(i);const n=this.paymentIntegrationService.getState(),r=n.getCheckoutOrThrow(),{clientToken:a,config:s}=n.getPaymentMethodOrThrow(i),d=n.getStoreConfigOrThrow();if(!a)throw new U(j.MissingPaymentMethod);this.braintreeSdk.initialize(a);const l=yield this.braintreeSdk.getBraintreeVisaCheckout(),c=yield this.braintreeSdk.getVisaCheckoutSdk(s.testMode),{container:u,onError:h}=t;this.onError=h||lodash__WEBPACK_IMPORTED_MODULE_1__.noop;const y=l.createInitOptions({paymentRequest:{currencyCode:d.currency.code,subtotal:String(r.subtotal)},settings:{locale:d.storeProfile.storeLanguage,shipping:{collectShipping:!0}}}),m=this.createSignInButton(u,this.buttonClassName);yield c.init(y),c.on(\"payment.success\",e=>this.tokenizePayment(l,e).then(()=>this.paymentIntegrationService.loadCheckout()).catch(e=>this.handleError(e))),c.on(\"payment.error\",(e,t)=>this.handleError(t)),m.style.visibility=\"visible\"})}deinitialize(){return ut(this,void 0,void 0,function*(){yield this.braintreeSdk.deinitialize()})}signIn(){throw new ct('In order to sign in via VisaCheckout, the shopper must click on \"Visa Checkout\" button.')}signOut(e){return ut(this,void 0,void 0,function*(){return yield this.paymentIntegrationService.signOutCustomer(e),Promise.resolve()})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}tokenizePayment(e,t){return ut(this,void 0,void 0,function*(){return Promise.all([e.tokenize(t),this.braintreeSdk.getDataCollectorOrThrow()]).then(([e,t])=>{const i=this.paymentIntegrationService.getState(),n=i.getShippingAddress(),r=i.getBillingAddress(),{shippingAddress:o=this.mapToVisaCheckoutAddress(n),billingAddress:a=this.mapToVisaCheckoutAddress(r)}=e;return this.postForm(Object.assign(Object.assign({},e),{shippingAddress:o,billingAddress:a}),t)})})}postForm(e,t){const{userData:i,billingAddress:n,shippingAddress:r,details:o}=e,{userEmail:a}=i,{deviceData:s}=t;return this.formPoster.postForm(\"/checkout.php\",{payment_type:e.type,nonce:e.nonce,provider:\"braintreevisacheckout\",action:\"set_external_checkout\",device_data:s,card_information:JSON.stringify({type:o.cardType,number:o.lastTwo}),billing_address:JSON.stringify(this.getAddress(a,n)),shipping_address:JSON.stringify(this.getAddress(a,r))})}mapToVisaCheckoutAddress(e){return e?{firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phone,streetAddress:e.address1,extendedAddress:e.address2,locality:e.city,region:e.stateOrProvinceCode,countryCode:e.countryCode,postalCode:e.postalCode}:{}}getAddress(e,t={}){return{email:e,first_name:t.firstName,last_name:t.lastName,phone_number:t.phoneNumber,address_line_1:t.streetAddress,address_line_2:t.extendedAddress,city:t.locality,state:t.region,country_code:t.countryCode,postal_code:t.postalCode}}createSignInButton(e,t){const i=document.querySelector(`#${e}`);if(!i)throw new Error(\"Unable to proceed because the provided container ID is not valid.\");return this.insertVisaCheckoutButton(i,t)}insertVisaCheckoutButton(e,t){const i=document.createElement(\"div\");return i.style.display=\"flex\",i.style.flexDirection=\"column\",i.style.visibility=\"hidden\",i.style.width=\"max-content\",i.className=t,i.innerHTML='\\n            <img\\n                alt=\"Visa Checkout\"\\n                class=\"v-button\"\\n                role=\"button\"\\n                src=\"https://secure.checkout.visa.com/wallet-services-web/xo/button.png?acceptCanadianVisaDebit=false&cobrand=true&height=34&width=178\"\\n                />\\n            <a class=\"v-learn v-learn-default\" style=\"text-align: right; display: block; font-size: 10px; color: #003366;\" href=\"#\" data-locale=\"en_US\">Tell Me More</a>',e.appendChild(i),i}handleError(e){if(\"function\"!=typeof this.onError)throw e;this.onError(e)}}const yt=L(t=>{const i=window,n=new F(t),r=new B(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n));return new ht(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),r)},[{id:\"braintreevisacheckout\"}]);class mt extends p{constructor(e){super(e||\"An unexpected error has occurred during buy now cart creation process. Please try again later.\"),this.name=\"BuyNowCartCreationError\",this.type=\"buy_now_cart_creation_error\"}}function pt(e){const{color:t,fundingicons:i,height:n=40,layout:o,shape:a,size:d,tagline:l}=e||{},c={color:t,fundingicons:i,height:gt(n),layout:o,shape:a||\"rect\",size:d,tagline:l};return (0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)(c,lodash__WEBPACK_IMPORTED_MODULE_1__.isNil)}function gt(e){const t=Number(e);return!t||Number.isNaN(t)?40:t>55?55:t<25?25:t}var vt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ft{constructor(e,t,i,n){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeHostWindow=n}initialize(e){return vt(this,void 0,void 0,function*(){const{braintreepaypal:t,containerId:i,methodId:n}=e;if(!n)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!i)throw new V('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!t)throw new V('Unable to initialize payment because \"options.braintreepaypal\" argument is not provided.');let r,o=this.paymentIntegrationService.getState();if(t.buyNowInitializeOptions){if(!t.currencyCode)throw new V('Unable to initialize payment because \"options.braintreepaypalcredit.currencyCode\" argument is not provided.');r=t.currencyCode}else yield this.paymentIntegrationService.loadDefaultCheckout(),o=this.paymentIntegrationService.getState(),r=o.getCartOrThrow().currency.code;const a=o.getPaymentMethodOrThrow(n),{clientToken:s,config:d,initializationData:l}=a;if(!s||!l)throw new U(j.MissingPaymentMethod);const c={currency:r,intent:l.intent,isCreditEnabled:l.isCreditEnabled};this.braintreeIntegrationService.initialize(s),yield this.braintreeIntegrationService.getPaypalCheckout(c,e=>{this.renderPayPalButton(e,t,i,n,!!d.testMode)},e=>this.handleError(e,i,t.onError))})}deinitialize(){return vt(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}renderPayPalButton(e,t,i,n,r){const{style:o,shouldProcessPayment:a,onAuthorizeError:s,onEligibilityFailure:d}=t,{paypal:l}=this.braintreeHostWindow;if(l){const c=l.Buttons({env:r?\"sandbox\":\"production\",fundingSource:l.FUNDING.PAYPAL,style:pt(o),createOrder:()=>this.setupPayment(e,t,n),onApprove:t=>this.tokenizePayment(t,e,n,a,s)});c.isEligible()?c.render(`#${i}`):d&&\"function\"==typeof d&&d()}else this.braintreeIntegrationService.removeElement(i)}setupPayment(e,t,i){var n;return vt(this,void 0,void 0,function*(){const{onPaymentError:r,shippingAddress:o,buyNowInitializeOptions:a}=t;try{const r=\"function\"==typeof(null==a?void 0:a.getBuyNowCartRequestBody)?yield this.createBuyNowCart(a.getBuyNowCartRequestBody()):void 0;this.buyNowCartId=null==r?void 0:r.id;const s=this.paymentIntegrationService.getState(),d=s.getCustomer(),l=s.getPaymentMethodOrThrow(i),c=r?r.cartAmount:s.getCartOrThrow().cartAmount,u=r?t.currencyCode:s.getCartOrThrow().currency.code,h=o||(null==d?void 0:d.addresses[0]),y=h?ge(h):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:y,amount:c,currency:u,offerCredit:!1,intent:null===(n=l.initializationData)||void 0===n?void 0:n.intent})}catch(e){throw r&&(D(e)||e instanceof p)&&r(e),e}})}tokenizePayment(e,t,i,n,r){return vt(this,void 0,void 0,function*(){try{const{deviceData:r}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),o=yield t.tokenizePayment(e),{details:a,nonce:s}=o,d=this.braintreeIntegrationService.mapToLegacyBillingAddress(a),l=this.braintreeIntegrationService.mapToLegacyShippingAddress(a);return this.formPoster.postForm(\"/checkout.php\",Object.assign({payment_type:\"paypal\",provider:i,action:n?\"process_payment\":\"set_external_checkout\",nonce:s,device_data:r,billing_address:JSON.stringify(d),shipping_address:JSON.stringify(l)},this.buyNowCartId&&{cart_id:this.buyNowCartId})),o}catch(e){throw r&&(D(e)||e instanceof p)&&r(e),e}})}createBuyNowCart(e){return vt(this,void 0,void 0,function*(){if(!e)throw new U(j.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(e)}catch(e){throw new mt}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!D(e))throw e;i(e)}}const bt=L(t=>{const i=window,n=new F(t),r=new de(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),i);return new ft(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),r,i)},[{id:\"braintreepaypal\"}]);var wt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Ct{constructor(e,t,i,n,r){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeMessages=n,this.braintreeHostWindow=r}initialize(e){var t,i;return wt(this,void 0,void 0,function*(){const{braintreepaypalcredit:n,containerId:r,methodId:o}=e;if(!o)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!r)throw new V('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!n)throw new V('Unable to initialize payment because \"options.braintreepaypalcredit\" argument is not provided.');let a,s=this.paymentIntegrationService.getState();if(n.buyNowInitializeOptions){if(!n.currencyCode)throw new V('Unable to initialize payment because \"options.braintreepaypalcredit.currencyCode\" argument is not provided.');a=n.currencyCode}else yield this.paymentIntegrationService.loadDefaultCheckout(),s=this.paymentIntegrationService.getState(),a=s.getCartOrThrow().currency.code;const d=s.getPaymentMethodOrThrow(o),{clientToken:l,config:c,initializationData:u}=d;if(!l||!u)throw new U(j.MissingPaymentMethod);const h={currency:a,intent:u.intent,isCreditEnabled:u.isCreditEnabled},y=x(null!==(i=null===(t=s.getStoreConfig())||void 0===t?void 0:t.checkoutSettings.features)&&void 0!==i?i:{},\"PAYPAL-5663.hide_braintree_card_banner_implementation_in_checkout_sdk\");this.braintreeIntegrationService.initialize(l),yield this.braintreeIntegrationService.getPaypalCheckout(h,e=>{!y&&n.messagingContainerId&&this.renderPayPalMessages(o,n.messagingContainerId),this.renderPayPalButton(e,n,r,o,!!c.testMode)},e=>this.handleError(e,r,n.onError))})}deinitialize(){return wt(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}renderPayPalMessages(e,t){this.braintreeMessages.render(e,t,ae.CART)}renderPayPalButton(e,t,i,n,r){const{style:o,shouldProcessPayment:a,onAuthorizeError:s,onEligibilityFailure:d}=t,{paypal:l}=this.braintreeHostWindow;let c=!1;l&&[l.FUNDING.PAYLATER,l.FUNDING.CREDIT].forEach(u=>{const h=u===l.FUNDING.CREDIT?Object.assign({label:re.CREDIT},pt(o)):pt(o);if(!c){const o=l.Buttons({env:r?\"sandbox\":\"production\",fundingSource:u,style:h,createOrder:()=>this.setupPayment(e,t,n),onApprove:t=>this.tokenizePayment(t,e,n,a,s)});o.isEligible()?(o.render(`#${i}`),c=!0):l.FUNDING.CREDIT&&d&&\"function\"==typeof d&&d()}}),l&&c||this.braintreeIntegrationService.removeElement(i)}setupPayment(e,t,i){var n;return wt(this,void 0,void 0,function*(){const{onPaymentError:r,shippingAddress:o,buyNowInitializeOptions:a}=t;try{const r=\"function\"==typeof(null==a?void 0:a.getBuyNowCartRequestBody)?yield this.createBuyNowCart(a.getBuyNowCartRequestBody()):void 0;this.buyNowCartId=null==r?void 0:r.id;const s=this.paymentIntegrationService.getState(),d=s.getCustomer(),l=s.getPaymentMethodOrThrow(i),c=r?r.cartAmount:s.getCartOrThrow().cartAmount,u=r?t.currencyCode:s.getCartOrThrow().currency.code,h=o||(null==d?void 0:d.addresses[0]),y=h?ge(h):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:y,amount:c,currency:u,offerCredit:!0,intent:null===(n=l.initializationData)||void 0===n?void 0:n.intent})}catch(e){throw r&&(D(e)||e instanceof p)&&r(e),e}})}tokenizePayment(e,t,i,n,r){return wt(this,void 0,void 0,function*(){try{const{deviceData:r}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),o=yield t.tokenizePayment(e),{details:a,nonce:s}=o,d=this.braintreeIntegrationService.mapToLegacyBillingAddress(a),l=this.braintreeIntegrationService.mapToLegacyShippingAddress(a);return this.formPoster.postForm(\"/checkout.php\",Object.assign({payment_type:\"paypal\",provider:i,action:n?\"process_payment\":\"set_external_checkout\",nonce:s,device_data:r,billing_address:JSON.stringify(d),shipping_address:JSON.stringify(l)},this.buyNowCartId&&{cart_id:this.buyNowCartId})),o}catch(e){throw r&&(D(e)||e instanceof p)&&r(e),e}})}createBuyNowCart(e){return wt(this,void 0,void 0,function*(){if(!e)throw new U(j.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(e)}catch(e){throw new mt}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!D(e))throw e;i(e)}}const St=L(t=>{const i=window,n=new F(t),r=new de(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),i),o=new le(t);return new Ct(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),r,o,i)},[{id:\"braintreepaypalcredit\"}]);var Pt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class It{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i}initialize(e){return Pt(this,void 0,void 0,function*(){const{containerId:t,methodId:i}=e;if(!i)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new V('Unable to initialize payment because \"options.containerId\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(i);const n=this.paymentIntegrationService.getState(),{clientToken:r,initializationData:o,config:a}=n.getPaymentMethodOrThrow(i);if(!r||!o)throw new U(j.MissingPaymentMethod);this.braintreeSdk.initialize(r);const s=yield this.braintreeSdk.getBraintreeVisaCheckout(),{currency:{code:d},cartAmount:l}=n.getCartOrThrow(),c=yield this.braintreeSdk.getVisaCheckoutSdk(a.testMode),u=s.createInitOptions({paymentRequest:{currencyCode:d,subtotal:String(l)},settings:{shipping:{collectShipping:!0}}});this.createSignInButton(t),yield c.init(u),c.on(\"payment.success\",e=>Pt(this,void 0,void 0,function*(){yield this.paymentSuccess(s,e)}))})}deinitialize(){return Promise.resolve()}paymentSuccess(e,t){return Pt(this,void 0,void 0,function*(){return Promise.all([e.tokenize(t),this.braintreeSdk.getDataCollectorOrThrow()]).then(([e,t])=>{const i=this.paymentIntegrationService.getState(),n=i.getShippingAddress(),r=i.getBillingAddress(),{shippingAddress:o=this.toVisaCheckoutAddress(n),billingAddress:a=this.toVisaCheckoutAddress(r)}=e;return this.postForm(Object.assign(Object.assign({},e),{shippingAddress:o,billingAddress:a}),t)})})}postForm(e,t){const{userData:i,billingAddress:n,shippingAddress:r,details:o}=e,{userEmail:a}=i,{deviceData:s}=t;return this.formPoster.postForm(\"/checkout.php\",{payment_type:e.type,nonce:e.nonce,provider:\"braintreevisacheckout\",action:\"set_external_checkout\",device_data:s,card_information:JSON.stringify({type:o.cardType,number:o.lastTwo}),billing_address:JSON.stringify(this.getAddress(a,n)),shipping_address:JSON.stringify(this.getAddress(a,r))})}toVisaCheckoutAddress(e){return e?{firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phone,streetAddress:e.address1,extendedAddress:e.address2,locality:e.city,region:e.stateOrProvinceCode,countryCode:e.countryCode,postalCode:e.postalCode}:{}}getAddress(e,t={}){return{email:e,first_name:t.firstName,last_name:t.lastName,phone_number:t.phoneNumber,address_line_1:t.streetAddress,address_line_2:t.extendedAddress,city:t.locality,state:t.region,country_code:t.countryCode,postal_code:t.postalCode}}createSignInButton(e){const t=document.querySelector(`#${e}`);if(!t)throw new Error(\"Need a container to place the button\");return this.insertVisaCheckoutButton(t)}insertVisaCheckoutButton(e){const t=document.createElement(\"div\");return t.style.display=\"flex\",t.style.flexDirection=\"column\",t.style.alignItems=\"flex-end\",t.innerHTML='\\n            <img\\n                alt=\"Visa Checkout\"\\n                class=\"v-button\"\\n                role=\"button\"\\n                src=\"https://secure.checkout.visa.com/wallet-services-web/xo/button.png?acceptCanadianVisaDebit=false&cobrand=true&height=34&width=178\"\\n                />\\n            <a class=\"v-learn v-learn-default\" style=\"text-align: right; display: block; font-size: 10px; color: #003366;\" href=\"#\" data-locale=\"en_US\">Tell Me More</a>',e.appendChild(t),t}}const Ot=L(t=>{const i=window,n=new F(t),r=new B(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n));return new It(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),r)},[{id:\"braintreevisacheckout\"}]);function kt(e){const{billingAddress:t,email:i,firstName:n,lastName:r,phone:o,shippingAddress:a}=e,s=t||a;return{email:i,first_name:n,last_name:r,phone_number:o,address_line_1:null==s?void 0:s.line1,address_line_2:null==s?void 0:s.line2,city:null==s?void 0:s.city,state:null==s?void 0:s.state,country_code:null==s?void 0:s.countryCode,postal_code:null==s?void 0:s.postalCode}}function Et(e){const{email:t,phone:i,shippingAddress:n}=e,r=(null==n?void 0:n.recipientName)||\"\",[o,a]=r.split(\" \");return{email:t,first_name:o||\"\",last_name:a||\"\",phone_number:i,address_line_1:null==n?void 0:n.line1,address_line_2:null==n?void 0:n.line2,city:null==n?void 0:n.city,state:null==n?void 0:n.state,country_code:null==n?void 0:n.countryCode,postal_code:null==n?void 0:n.postalCode}}var Tt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};const At=e=>{const{color:t,height:i}=e;return{backgroundColor:(n=t||\"\",n===ne.WHITE?\"#FFFFFF\":\"#3D95CE\"),backgroundPosition:\"50% 50%\",backgroundSize:\"80px auto\",backgroundImage:`url(\"/app/assets/img/payment-providers/venmo-logo-${t===ne.WHITE?ne.BLUE:ne.WHITE}.svg\")`,backgroundRepeat:\"no-repeat\",borderRadius:\"4px\",cursor:\"pointer\",transition:\"0.2s ease\",minHeight:`${i||40}px`,minWidth:\"150px\",height:\"100%\",width:\"100%\",border:t===ne.WHITE?\"1px solid black\":\"none\"};// removed by dead control flow\n var n; };class zt{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i,this.onError=lodash__WEBPACK_IMPORTED_MODULE_1__.noop}initialize(e){return Tt(this,void 0,void 0,function*(){const{braintreevenmo:t,containerId:i,methodId:n}=e;if(!n)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');const r=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(n),{clientToken:o,initializationData:a}=r,{paymentButtonStyles:s}=a,{cartButtonStyles:d}=s||{},l=(null==t?void 0:t.style)||d;if(!o||!a)throw new U(j.MissingPaymentMethod);if(!i)throw new V('Unable to initialize payment because \"options.containerId\" argument is not provided.');yield this.paymentIntegrationService.loadDefaultCheckout(),this.onError=(null==t?void 0:t.onError)||this.handleError,this.braintreeSdk.initialize(o);try{const e=yield this.braintreeSdk.getVenmoCheckoutOrThrow();this.renderVenmoButton(e,i,null==t?void 0:t.buyNowInitializeOptions,l)}catch(e){(pe(e)||function(e){return e instanceof N}(e))&&this.handleInitializationVenmoError(e,i)}})}deinitialize(){return Tt(this,void 0,void 0,function*(){return yield this.braintreeSdk.deinitialize(),Promise.resolve()})}handleError(e){throw new Error(e.message)}createBuyNowCart(e){return Tt(this,void 0,void 0,function*(){if(\"function\"==typeof(null==e?void 0:e.getBuyNowCartRequestBody)){const t=null==e?void 0:e.getBuyNowCartRequestBody();if(!t)throw new U(j.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(t)}catch(e){throw new mt}}})}handleInitializationVenmoError(e,t){return this.removeVenmoContainer(t),this.onError(e)}removeVenmoContainer(e){const t=document.getElementById(e);t&&t.remove()}renderVenmoButton(e,t,i,n){const r=document.getElementById(t),{color:o}=n||{};if(!r)throw new V(\"Unable to create wallet button without valid container ID.\");r.setAttribute(\"aria-label\",\"Venmo\"),Object.assign(r.style,At(n||{})),r.addEventListener(\"click\",()=>Tt(this,void 0,void 0,function*(){r.setAttribute(\"disabled\",\"true\");const t=yield this.createBuyNowCart(i);e.tokenize&&e.tokenize((e,i)=>Tt(this,void 0,void 0,function*(){r.removeAttribute(\"disabled\"),e&&this.onError(e),yield this.handlePostForm(i,null==t?void 0:t.id)}))})),o===ne.BLUE&&(r.addEventListener(\"mouseenter\",()=>{r.style.backgroundColor=\"#0a7fc2\"}),r.addEventListener(\"mouseleave\",()=>{r.style.backgroundColor=At(n||{}).backgroundColor}))}handlePostForm(e,t){return Tt(this,void 0,void 0,function*(){const{deviceData:i}=yield this.braintreeSdk.getDataCollectorOrThrow(),{nonce:n,details:r}=e;this.formPoster.postForm(\"/checkout.php\",Object.assign({nonce:n,provider:\"braintreevenmo\",payment_type:\"paypal\",device_data:i,action:\"set_external_checkout\",billing_address:JSON.stringify(kt(r)),shipping_address:JSON.stringify(Et(r))},t&&{cart_id:t}))})}}const Nt=L(t=>{const i=window,n=(0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),r=new F(t),o=new z(n,i,r),a=new B(o);return new zt(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),a)},[{id:\"braintreevenmo\"}]);\n//# sourceMappingURL=braintree.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vY2hlY2tvdXQtc2RrLWpzL2Rpc3QvZXNtL2ludGVncmF0aW9ucy9icmFpbnRyZWUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNXLFVBQVUsc0JBQXNCLGVBQWUsTUFBTSx1VEFBdVQsa0JBQWtCLGVBQWUsK01BQStNLGFBQWEsOENBQThDLFNBQVMsZUFBZSxvVUFBb1UsU0FBUyxlQUFlLGdNQUFnTSxTQUFTLEdBQUcsNkNBQTZDLEtBQUssa2pDQUFrakMsTUFBTSxrakNBQWtqQyxNQUFNLG9qQ0FBb2pDLHdDQUF3Qyx5Q0FBeUMsY0FBYyxJQUFJLGFBQWEsU0FBUyxNQUFNLGNBQWMsSUFBSSxjQUFjLFNBQVMsTUFBTSxjQUFjLE1BQU0sZ0VBQWdFLEtBQUssYUFBYSwrQkFBK0IsR0FBRyxRQUFRLG1CQUFtQixpRkFBaUYsYUFBYSx3Q0FBd0MsaUVBQWlFLEVBQUUsZUFBZSx3Q0FBd0MscUVBQXFFLEVBQUUscUJBQXFCLHdDQUF3QyxrRkFBa0YsRUFBRSxhQUFhLHdDQUF3QyxpRUFBaUUsRUFBRSxtQkFBbUIsd0NBQXdDLDhFQUE4RSxFQUFFLG9CQUFvQix3Q0FBd0MsZ0ZBQWdGLEVBQUUsb0JBQW9CLHdDQUF3QyxpRkFBaUYsRUFBRSxvQkFBb0Isd0NBQXdDLGdGQUFnRixFQUFFLFVBQVUsd0NBQXdDLCtFQUErRSxFQUFFLG1CQUFtQiw4RUFBOEUsb0JBQW9CLCtEQUErRCxtQkFBbUIsd0NBQXdDLDhFQUE4RSxFQUFFLHVCQUF1Qix3Q0FBd0MsZ0VBQWdFLDhKQUE4Six5Q0FBeUMsZ0JBQWdCLHFGQUFxRixxQkFBcUIscUNBQXFDLFlBQVksMkNBQTJDLGtDQUFrQyxFQUFFLEVBQUUsZ0NBQWdDLHdDQUF3QyxpQ0FBaUMsY0FBYywyRkFBMkYsRUFBRSxNQUFNLEVBQUUsMkRBQTJELDJDQUEyQyxxQkFBcUIscUNBQXFDLHFEQUFxRCxTQUFTLEVBQUUsc0JBQXNCLE1BQU0sNkVBQTZFLG9DQUFvQyxnQkFBZ0IsbURBQW1ELFVB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Q0FBQyxDQUFDLGNBQWMseUNBQXlDLE1BQU0sMENBQTBDLEdBQUcsdUdBQXVHLDhFQUE4RSxtQ0FBbUMsSUFBSSxzQkFBc0IsSUFBSSxtQkFBbUIsTUFBTSwrQkFBK0IsOENBQThDLDBHQUEwRyxxSkFBcUosSUFBSSwwREFBMEQsdUVBQXVFLFNBQVMsb0JBQW9CLHNCQUFzQixnREFBZ0QsRUFBRSxlQUFlLHlDQUF5QyxnRUFBZ0UsRUFBRSxlQUFlLDJCQUEyQixvQkFBb0IseUNBQXlDLGtFQUFrRSxvREFBb0QsaUNBQWlDLElBQUksZ0VBQWdFLFNBQVMsZUFBZSxFQUFFLG9DQUFvQyxvREFBb0Qsd0JBQXdCLG1DQUFtQyxjQUFjLDJCQUEyQixvQ0FBb0MsUUFBUSxPQUFPLGdGQUFnRixtRUFBbUUsb0VBQW9FLGtDQUFrQyx1Q0FBdUMsZ0VBQWdFLGtHQUFrRyxHQUFHLHNEQUFzRCxrQ0FBa0MsdUNBQXVDLGdDQUFnQyxrQkFBa0IsR0FBRyxvQkFBb0IseUNBQXlDLE1BQU0sYUFBYSxvREFBb0Qsa0JBQWtCLEdBQUcsd0RBQXdELGtMQUFrTCxLQUFLLFVBQVUsR0FBRyxHQUFHLGVBQWUsaUJBQWlCLDJFQUFDLHdDQUF3QyxnQkFBZ0IsMEVBQUMsTUFBTSxHQUFHLG9CQUFvQixHQUFzckI7QUFDbmg1SCIsInNvdXJjZXMiOlsid2VicGFjazovL2NoZWNrb3V0Ly4uL2NoZWNrb3V0LXNkay1qcy9kaXN0L2VzbS9pbnRlZ3JhdGlvbnMvYnJhaW50cmVlLmpzP2I5MzUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0e2dldFNjcmlwdExvYWRlciBhcyBlfWZyb21cIkBiaWdjb21tZXJjZS9zY3JpcHQtbG9hZGVyXCI7aW1wb3J0e2ZpbmQgYXMgdCxpc0VtcHR5IGFzIGksaXNFcXVhbCBhcyBuLGlzTmlsIGFzIHIsbm9vcCBhcyBvLG9taXQgYXMgYSxvbWl0QnkgYXMgcyxzb21lIGFzIGR9ZnJvbVwibG9kYXNoXCI7aW1wb3J0e3N1cHBvcnRzUG9wdXBzIGFzIGx9ZnJvbVwiQGJyYWludHJlZS9icm93c2VyLWRldGVjdGlvblwiO2ltcG9ydHtjcmVhdGVSZXF1ZXN0U2VuZGVyIGFzIGN9ZnJvbVwiQGJpZ2NvbW1lcmNlL3JlcXVlc3Qtc2VuZGVyXCI7aW1wb3J0e2NyZWF0ZUZvcm1Qb3N0ZXIgYXMgdX1mcm9tXCJAYmlnY29tbWVyY2UvZm9ybS1wb3N0ZXJcIjt2YXIgaCx5LG07Y2xhc3MgcCBleHRlbmRzIEVycm9ye2NvbnN0cnVjdG9yKGUpe3ZhciB0O3N1cGVyKGV8fFwiQW4gdW5leHBlY3RlZCBlcnJvciBoYXMgb2NjdXJyZWQuXCIpLHRoaXMubmFtZT1cIlN0YW5kYXJkRXJyb3JcIix0aGlzLnR5cGU9XCJzdGFuZGFyZFwiLHQ9bmV3LnRhcmdldC5wcm90b3R5cGUsT2JqZWN0LnNldFByb3RvdHlwZU9mP09iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLHQpOnRoaXMuX19wcm90b19fPXQsXCJmdW5jdGlvblwiPT10eXBlb2YgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2U/RXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcyxuZXcudGFyZ2V0KTp0aGlzLnN0YWNrPW5ldyBFcnJvcih0aGlzLm1lc3NhZ2UpLnN0YWNrfX1jbGFzcyBnIGV4dGVuZHMgcHtjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIGNsaWVudCBsaWJyYXJ5IG9mIGEgcGF5bWVudCBtZXRob2QgaXMgbm90IGxvYWRlZCBvciByZWFkeSB0byBiZSB1c2VkLlwiKSx0aGlzLm5hbWU9XCJQYXltZW50TWV0aG9kQ2xpZW50VW5hdmFpbGFibGVFcnJvclwiLHRoaXMudHlwZT1cInBheW1lbnRfbWV0aG9kX2NsaWVudF91bmF2YWlsYWJsZVwifX0hZnVuY3Rpb24oZSl7ZS5TYW5kYm94PVwic2FuZGJveFwiLGUuUHJvZHVjdGlvbj1cInByb2R1Y3Rpb25cIn0oaHx8KGg9e30pKSxmdW5jdGlvbihlKXtlLkNsaWVudD1cImNsaWVudFwiLGUuRGF0YUNvbGxlY3Rvcj1cImRhdGFDb2xsZWN0b3JcIixlLkZhc3RsYW5lPVwiZmFzdGxhbmVcIixlLkdvb2dsZVBheW1lbnQ9XCJnb29nbGVQYXltZW50XCIsZS5Ib3N0ZWRGaWVsZHM9XCJob3N0ZWRGaWVsZHNcIixlLkxvY2FsUGF5bWVudD1cImxvY2FsUGF5bWVudFwiLGUuUGF5cGFsPVwicGF5cGFsXCIsZS5QYXlwYWxDaGVja291dD1cInBheXBhbENoZWNrb3V0XCIsZS5UaHJlZURTZWN1cmU9XCJ0aHJlZURTZWN1cmVcIixlLlVzQmFua0FjY291bnQ9XCJ1c0JhbmtBY2NvdW50XCIsZS5WZW5tbz1cInZlbm1vXCIsZS5WaXNhQ2hlY2tvdXQ9XCJ2aXNhQ2hlY2tvdXRcIn0oeXx8KHk9e30pKSxmdW5jdGlvbihlKXtlLkNhcmRDb2RlPVwiY2FyZENvZGVcIixlLkNhcmRDb2RlVmVyaWZpY2F0aW9uPVwiY2FyZENvZGVWZXJpZmljYXRpb25cIixlLkNhcmRFeHBpcnk9XCJjYXJkRXhwaXJ5XCIsZS5DYXJkTmFtZT1cImNhcmROYW1lXCIsZS5DYXJkTnVtYmVyPVwiY2FyZE51bWJlclwiLGUuQ2FyZE51bWJlclZlcmlmaWNhdGlvbj1cImNhcmROdW1iZXJWZXJpZmljYXRpb25cIn0obXx8KG09e30pKTtjb25zdCB2PVwiMy4xMjguMFwiLGY9XCIzLjEyMy4yXCIsYj1cIjMuMTA2LjBcIix3PXtbYl06e1t5LkNsaWVudF06XCJzaGEzODQtMjZCWERObkpJMjNKWVJ5RkJqNHhlNHNWTnJVU1NpU1N1MTFreFZYTk0vdkVQT05tNEx1TDAwdzZaYVRnUWV3dFwiLFt5LlBheXBhbENoZWNrb3V0XTpcInNoYTM4NC1CK3Z6Ylp3blF0eldCdGhwa1Q0VFhLVWliTzY1dHllSzdlQ3hTdnBibGdwclRlcDIrSUFYQjJDeHhqcm43MTBPXCIsW3kuUGF5cGFsXTpcInNoYTM4NC11eUFHTDEvMytYSkFIbkdvTnk0ZUNvWGR6SjRmN0lsenArNnc5UE5uRWpzNkRDQ3o5V015SmpNTjFnemM3OFUrXCIsW3kuTG9jYWxQYXltZW50XTpcInNoYTM4NC1MSXZPRU1rSVZFd1Z1WUJkVk9RYzFBQzVZYkdHbHd5ZlVoZVMwQUNLMjE4RDJTVHVWWVFsWjRGeUVQb3dBRWZUXCIsW3kuRGF0YUNvbGxlY3Rvcl06XCJzaGEzODQtMWJvOUpEeitLc2N0aGMwODVjQ0tXdXI4Q0x3VW9CcG9OeXhzRGk3OTMybUNsMHpGcTNBNW12K0ZRTHc5R0hwVlwiLFt5LlVzQmFua0FjY291bnRdOlwic2hhMzg0LXhtSEJWYVUrdzc0VitPZWJEM0FhUE9ORnhIVUdNZitRUnM4Ry9KeFZQWE5OUDdNRGEyakwwSUNXSEllMnRUZkpcIixbeS5Hb29nbGVQYXltZW50XTpcInNoYTM4NC1XS0RKbDhtcW9QODJxWnBNR0g2QWJaeG52WG5TVzhJTFY0TTY0Q3lNTGl1Z0dNd3U3THlQODl3akNrSHFzaUJlXCIsW3kuVGhyZWVEU2VjdXJlXTpcInNoYTM4NC1WUVVscEdIenNHdnM1WGVpR0ZpcDdFWFJzdm9IV0VYRFZtZ0NhY2ZieWllWkk5bWRCT3FxM05Tb3lvMjhPQ09CXCIsW3kuVmlzYUNoZWNrb3V0XTpcInNoYTM4NC15eDdtQURmelROMFQ0M1E2cmxINDlMSWcxRUowaVVaZ0JwL0Vjelg5TFhzVUdreVNneHJEK25XSFFSQmt5Zm9UXCIsW3kuVmVubW9dOlwic2hhMzg0LVFYNHJQam9qMVpEaHVHMGFTeUtzNTZsRUtEcVRNVGNqWXhVSFkxU3pPNVZaRHNxSUUyTlRrcW90N0tOU0N5b3ZcIixbeS5Ib3N0ZWRGaWVsZHNdOlwic2hhMzg0LVZ2WUJBQ2ZTdTBDci9KMzJ1S214RzdBWGNOT0pFMUF6SUlMM2tiaWt5UzdZS3A1Zno1SXMrTnpOUC9seWF1TnlcIixbeS5GYXN0bGFuZV06XCJzaGEzODQtOW9Hc1pNUlp3cEd0REVEWWEvZEZ0NzZkRUNxajF4QW5pOWdJS2djM0tmTUlpUm5SNzNuRWVlVURMaUJ6eGhGYVwifSxbZl06e1t5LkNsaWVudF06XCJzaGEzODQtbytuYlFHY3dOTnhJQmVYZXUzK1htYlNxK0NnOFIzRU4zTjBsNWhYQ2dNTVUyUkdZMHQxejBMcm9TRUlBYmZBT1wiLFt5LlBheXBhbENoZWNrb3V0XTpcInNoYTM4NC1XcmZiV1BCUzRtSDg2R0FveWNQU2dpSDhoUThLSDdBNjdDOTNIamh1bnYveGhOazJZcEJuM3diRkE0RmhnOVUvXCIsW3kuUGF5cGFsXTpcInNoYTM4NC1WRjM4OW52dnJSVWdEc1RYTXhUWU9SRHRWZWdCOUlRYTNDeHIvL0R5Sm5MWW56OC9YOFZDekV2Y2syYytNZWd0XCIsW3kuTG9jYWxQYXltZW50XTpcInNoYTM4NC10Wkt4MnJFUWJmbVpwb1BTWTVWUG1KRWhhcTRYNzVkTHZ3SE1zM1ZFOVUrQzhsUHl3K2hXVElMMStHUHZXQ0lIXCIsW3kuRGF0YUNvbGxlY3Rvcl06XCJzaGEzODQtRTZrM3dPcFA3c3lDRER3YVJETEYwNjk0MlkwME5rYndKdldpMk9RWHd3S3pHd0c1ZmQzRTdSRlV2Q0NlY2Z2T1wiLFt5LlVzQmFua0FjY291bnRdOlwic2hhMzg0LTI1OEZPTjhMWkdHMFc5UWF6NEppajgzcFpIdTMwWW5LakpBN2dOdWxMQmg2Q2Nsa3VjZ0YrdEhEUXVZRlJZZldcIixbeS5Hb29nbGVQYXltZW50XTpcInNoYTM4NC10YUoycC8wK24wVkgzMjhQT0FvQml1RWJMM3RuSFVURTlTNDJoSzFWK1R4czNYK1FZalpPeUtXMzVKZ0hSRmZPXCIsW3kuVGhyZWVEU2VjdXJlXTpcInNoYTM4NC0rTlNaSDRaajNzTzViZFd2UEtoVTVOMTZRRHhldWVUVlRuVVZlbGVlRVNraExTYXo0T2IxaGgvNW15ZWNjOVltXCIsW3kuVmlzYUNoZWNrb3V0XTpcInNoYTM4NC02NkRpQmpnaHhrMU9tQmo4YWtzTjhnYlErQ3dvUWN4MXZQZmlYVU4wOGcxaVFWTStCd2V3RjBwN3RvTTNpN1NTXCIsW3kuVmVubW9dOlwic2hhMzg0LUI1VXdZNDJrRTRSb0xvV2JRN1lwcW9zVWxVYWQyL0RsR1dpdzBIaG9aYlNQazMwQ1FBYVNBMTBvaHlMRFRrRFVcIixbeS5Ib3N0ZWRGaWVsZHNdOlwic2hhMzg0LUF3OUVlc1NhVWVXeGUzNlBxRUhpT3lPeU9xOE02Q0liMWd3Ny95SE5WUFJ6R3RGWFhjZDJPUThxWHJJbE9qMlBcIixbeS5GYXN0bGFuZV06XCJzaGEzODQtcmhCTDFocFo3MUpxRysyVHNUMERpaDQ3bWJqeDhjakpDcGVaams5dHczZGYxZ0ZNS2ZDVG1NeVp1bmhyN0g0WVwifSxbdl06e1t5LkNsaWVudF06XCJzaGEzODQtMFdOeGtzSXBSUCtmWVppSWRyMTJnNkRCVVFmTER6WUNRSlp0Ui9DOEtrY3dTR2hQSGZjRnAzdFRhR2NNeUZUcVwiLFt5LlBheXBhbENoZWNrb3V0XTpcInNoYTM4NC1sV00xams0Qk94b0ROVjZLb3A3dFZOdlFnSU5sbUVWejBjL093TStITkhLM1FDOHhxd2Q1NE92cnQyUVJEVGpoXCIsW3kuUGF5cGFsXTpcInNoYTM4NC1mWFVtVnhDMkVNWkJEWFo3ZVRIU1RML0xGQnJIZWovTVNYVC92VEJYdnJhNGx6Z0xOR3ZSRUFwK3gwR1lPYnVIXCIsW3kuTG9jYWxQYXltZW50XTpcInNoYTM4NC1waGExeEd1R1NrbVpINXg5YXFIdlJhTzR4TGVhN3JtUS83OVBGajl6eE56eHVGY09XWmc3Z09QN0ZpYnlnT0VDXCIsW3kuRGF0YUNvbGxlY3Rvcl06XCJzaGEzODQtUTZQSTJGOWVla1diQXhocm95YmwrYUVjdnFoZG93Ti9FUWxHd0JVeUpPelBGbjk5ODJ1OXhsNlNVNlhmR0t6Y1wiLFt5LlVzQmFua0FjY291bnRdOlwic2hhMzg0LVczUkxRU0tKTDF0UTMrWTdtUDZ0bWthbXRaOGJWNFl3L1h4TDlKajVKdFhIcmFEOGxvTUY4aEFJRzVtMnpLN0ZcIixbeS5Hb29nbGVQYXltZW50XTpcInNoYTM4NC1USVRRTXNGV0EzZWxETkdQMm1XejJvS0JvNHFqdCtUbHF6b3ZjYVBvZUJpQWgvd1BCaTZuYWU1MEFEZGdVMS9pXCIsW3kuVGhyZWVEU2VjdXJlXTpcInNoYTM4NC1ZaXljWU44OVpsTC9FdmNhcTR5MWFqVzFtaGQ3SllmWkJEdU93SHRJbjQvSm5tMjBHTCsvWENNK3pZQXdXRDhEXCIsW3kuVmlzYUNoZWNrb3V0XTpcInNoYTM4NC0vT2RhVHY5cXJrS3pqT2J0VWU2eXpmRGhIb3pGVy8rdVhsclNsNzM2c09aUkpwakdRRVR2cFlYcU1GRmc2OXh2XCIsW3kuVmVubW9dOlwic2hhMzg0LWRBK29qZFc5dmJKUzRKYXZjWHlPczlkNXVaSEpnNWROdFl1cG9QU0gyenNYSWlZRFZTNWFtTGIvdThxbVE2b3pcIixbeS5Ib3N0ZWRGaWVsZHNdOlwic2hhMzg0LTMxWmtTNTgraWFXc1cwNmZ0VzUyenpWWkZwNDNXUGQ3cE5ZUmlkZFl5blNOZzZPaDdXR2JTRkdvckFVSDZUMXpcIixbeS5GYXN0bGFuZV06XCJzaGEzODQtamxicndOdkwzSHZMQVVDdExTbXJuUTJHSDF1ZENVclJTL2JWbVJlQVM1ZnVJVnZjVzhQa28vR2tnODJ0bGd0clwifX07dmFyIEMsUyxQLEksTyxrLEUsVCxBPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIHp7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMuc2NyaXB0TG9hZGVyPWUsdGhpcy5icmFpbnRyZWVIb3N0V2luZG93PXQsdGhpcy5icmFpbnRyZWVTREtWZXJzaW9uTWFuYWdlcj1pfWxvYWRDbGllbnQoKXtyZXR1cm4gQSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coeS5DbGllbnQsXCJjbGllbnQubWluLmpzXCIpfSl9bG9hZEZhc3RsYW5lKCl7cmV0dXJuIEEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHkuRmFzdGxhbmUsXCJmYXN0bGFuZS5taW4uanNcIil9KX1sb2FkUGF5cGFsQ2hlY2tvdXQoKXtyZXR1cm4gQSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coeS5QYXlwYWxDaGVja291dCxcInBheXBhbC1jaGVja291dC5taW4uanNcIil9KX1sb2FkUGF5cGFsKCl7cmV0dXJuIEEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHkuUGF5cGFsLFwicGF5cGFsLm1pbi5qc1wiKX0pfWxvYWRMb2NhbFBheW1lbnQoKXtyZXR1cm4gQSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coeS5Mb2NhbFBheW1lbnQsXCJsb2NhbC1wYXltZW50Lm1pbi5qc1wiKX0pfWxvYWREYXRhQ29sbGVjdG9yKCl7cmV0dXJuIEEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHkuRGF0YUNvbGxlY3RvcixcImRhdGEtY29sbGVjdG9yLm1pbi5qc1wiKX0pfWxvYWRVc0JhbmtBY2NvdW50KCl7cmV0dXJuIEEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHkuVXNCYW5rQWNjb3VudCxcInVzLWJhbmstYWNjb3VudC5taW4uanNcIil9KX1sb2FkR29vZ2xlUGF5bWVudCgpe3JldHVybiBBKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyh5Lkdvb2dsZVBheW1lbnQsXCJnb29nbGUtcGF5bWVudC5taW4uanNcIil9KX1sb2FkM0RTKCl7cmV0dXJuIEEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHkuVGhyZWVEU2VjdXJlLFwidGhyZWUtZC1zZWN1cmUubWluLmpzXCIpfSl9bG9hZFZpc2FDaGVja291dCgpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHkuVmlzYUNoZWNrb3V0LFwidmlzYS1jaGVja291dC5taW4uanNcIil9bG9hZFZlbm1vQ2hlY2tvdXQoKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyh5LlZlbm1vLFwidmVubW8ubWluLmpzXCIpfWxvYWRIb3N0ZWRGaWVsZHMoKXtyZXR1cm4gQSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coeS5Ib3N0ZWRGaWVsZHMsXCJob3N0ZWQtZmllbGRzLm1pbi5qc1wiKX0pfWxvYWRWaXNhQ2hlY2tvdXRTZGsoZSl7cmV0dXJuIEEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5WKXJldHVybiB0aGlzLmJyYWludHJlZUhvc3RXaW5kb3cuVjtjb25zdCB0PWU/XCJzaGEzODQtMGV1MXMxR3RxelhsTDlEdExnbXd6QzVXV2xFSC9BRFJNMG4zOGNWUWt2dFQrVy9nZXk5NnJjYjFMd3VVT1BEbVwiOlwic2hhMzg0LTFmMWNzdlAzWkZ4ZzRkSUxIMUdhWTRMSGxaMG9YN1JrODNyeG1MbHdibklpNFRNME5ZelhvZXYxVm9FaVZEUzZcIjtyZXR1cm4gdGhpcy5zY3JpcHRMb2FkZXIubG9hZFNjcmlwdChgLy8ke2U/XCJzYW5kYm94LVwiOlwiXCJ9YXNzZXRzLnNlY3VyZS5jaGVja291dC52aXNhLmNvbS9jaGVja291dC13aWRnZXQvcmVzb3VyY2VzL2pzL2ludGVncmF0aW9uL3YxL3Nkay5qc2Ase2FzeW5jOiEwLGF0dHJpYnV0ZXM6e2ludGVncml0eTp0LGNyb3Nzb3JpZ2luOlwiYW5vbnltb3VzXCJ9fSkudGhlbigoKT0+e2lmKCF0aGlzLmJyYWludHJlZUhvc3RXaW5kb3cuVil0aHJvdyBuZXcgZztyZXR1cm4gdGhpcy5icmFpbnRyZWVIb3N0V2luZG93LlZ9KX0pfWxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KGUsdCl7cmV0dXJuIEEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2xldCBpPXRoaXMuZ2V0QnJhaW50cmVlTW9kdWxlKGUpO2lmKGkpcmV0dXJuIGk7Y29uc3Qgbj10aGlzLmJyYWludHJlZVNES1ZlcnNpb25NYW5hZ2VyLmdldFNES1ZlcnNpb24oKSxyPWAvL2pzLmJyYWludHJlZWdhdGV3YXkuY29tL3dlYi8ke259L2pzLyR7dH1gLG89biBpbiB3P3RoaXMuZ2V0SW50ZWdyaXR5VmFsdWVzQnlNb2R1bGVOYW1lKGUsbik6dm9pZCAwO2lmKHlpZWxkIHRoaXMuc2NyaXB0TG9hZGVyLmxvYWRTY3JpcHQocixvP3thc3luYzohMCxhdHRyaWJ1dGVzOntpbnRlZ3JpdHk6byxjcm9zc29yaWdpbjpcImFub255bW91c1wifX06dm9pZCAwKSxpPXRoaXMuZ2V0QnJhaW50cmVlTW9kdWxlKGUpLCFpKXRocm93IG5ldyBnO3JldHVybiBpfSl9Z2V0QnJhaW50cmVlTW9kdWxlKGUpe3ZhciB0O3JldHVybiBudWxsPT09KHQ9dGhpcy5icmFpbnRyZWVIb3N0V2luZG93LmJyYWludHJlZSl8fHZvaWQgMD09PXQ/dm9pZCAwOnRbZV19Z2V0SW50ZWdyaXR5VmFsdWVzQnlNb2R1bGVOYW1lKGUsdCl7Y29uc3QgaT13W3RdW2VdO2lmKCFpKXRocm93IG5ldyBFcnJvcihcIlVuZXhwZWN0ZWQgZmlsZU5hbWUgdmFsdWVcIik7cmV0dXJuIGl9fWNsYXNzIE4gZXh0ZW5kcyBwe2NvbnN0cnVjdG9yKGUpe3N1cGVyKGV8fFwiVW5zdXBwb3J0ZWQgYnJvd3NlciBlcnJvclwiKSx0aGlzLm5hbWU9XCJVbnN1cHBvcnRlZEJyb3dzZXJFcnJvclwiLHRoaXMudHlwZT1cInVuc3VwcG9ydGVkX2Jyb3dzZXJcIn19IWZ1bmN0aW9uKGUpe2VbZS5DaGVja291dEJ1dHRvbk5vdEluaXRpYWxpemVkPTBdPVwiQ2hlY2tvdXRCdXR0b25Ob3RJbml0aWFsaXplZFwiLGVbZS5DdXN0b21lck5vdEluaXRpYWxpemVkPTFdPVwiQ3VzdG9tZXJOb3RJbml0aWFsaXplZFwiLGVbZS5QYXltZW50Tm90SW5pdGlhbGl6ZWQ9Ml09XCJQYXltZW50Tm90SW5pdGlhbGl6ZWRcIixlW2UuU2hpcHBpbmdOb3RJbml0aWFsaXplZD0zXT1cIlNoaXBwaW5nTm90SW5pdGlhbGl6ZWRcIixlW2UuU3BhbVByb3RlY3Rpb25Ob3RJbml0aWFsaXplZD00XT1cIlNwYW1Qcm90ZWN0aW9uTm90SW5pdGlhbGl6ZWRcIn0oQ3x8KEM9e30pKTtjbGFzcyBNIGV4dGVuZHMgcHtjb25zdHJ1Y3RvcihlKXtzdXBlcihmdW5jdGlvbihlKXtzd2l0Y2goZSl7Y2FzZSBDLkN1c3RvbWVyTm90SW5pdGlhbGl6ZWQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBjdXN0b21lciBzdGVwIG9mIGNoZWNrb3V0IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIjtjYXNlIEMuUGF5bWVudE5vdEluaXRpYWxpemVkOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgcGF5bWVudCBzdGVwIG9mIGNoZWNrb3V0IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIjtjYXNlIEMuU2hpcHBpbmdOb3RJbml0aWFsaXplZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHNoaXBwaW5nIHN0ZXAgb2YgY2hlY2tvdXQgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkLlwiO2Nhc2UgQy5TcGFtUHJvdGVjdGlvbk5vdEluaXRpYWxpemVkOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgY2hlY2tvdXQgc3BhbSBwcm90ZWN0aW9uIGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIjtkZWZhdWx0OnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgcmVxdWlyZWQgY29tcG9uZW50IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIn19KGUpKSx0aGlzLnN1YnR5cGU9ZSx0aGlzLm5hbWU9XCJOb3RJbml0aWFsaXplZEVycm9yXCIsdGhpcy50eXBlPVwibm90X2luaXRpYWxpemVkXCJ9fWZ1bmN0aW9uIEQoZSl7cmV0dXJuIEJvb2xlYW4oXCJvYmplY3RcIj09dHlwZW9mIGUmJm51bGwhPT1lJiYoXCJ0eXBlXCJpbiBlfHxcIm1lc3NhZ2VcImluIGV8fFwiY29kZVwiaW4gZSkpfSFmdW5jdGlvbihlKXtlLkVTVElNQVRFRD1cIkVTVElNQVRFRFwiLGUuRklOQUw9XCJGSU5BTFwiLGUuTk9UX0NVUlJFTlRMWV9LTk9XTj1cIk5PVF9DVVJSRU5UTFlfS05PV05cIn0oU3x8KFM9e30pKSxmdW5jdGlvbihlKXtlLkNvbXBsZXRlZD1cIkNPTVBMRVRFRFwiLGUuUGVuZGluZz1cIlBFTkRJTkdcIixlLkZhaWxlZD1cIkZBSUxFRFwifShQfHwoUD17fSkpLGZ1bmN0aW9uKGUpe2UuVFJVU1RMWT1cInRydXN0bHlcIn0oSXx8KEk9e30pKSxmdW5jdGlvbihlKXtlLlNVQ0NFRURFRD1cInN1Y2NlZWRlZFwiLGUuRkFJTEVEPVwiZmFpbGVkXCIsZS5DQU5DRUxFRD1cImNhbmNlbGxlZFwiLGUuVU5SRUNPR05JWkVEPVwidW5yZWNvZ25pemVkXCJ9KE98fChPPXt9KSksZnVuY3Rpb24oZSl7ZS5DdXN0b21lcj1cIkNVU1RPTUVSXCIsZS5NZXJjaGFudD1cIk1FUkNIQU5UXCIsZS5OZXR3b3JrPVwiTkVUV09SS1wiLGUuSW50ZXJuYWw9XCJJTlRFUk5BTFwiLGUuVW5rbm93bj1cIlVOS05PV05cIn0oa3x8KGs9e30pKSxmdW5jdGlvbihlKXtlLktvdW50Tm90RW5hYmxlZD1cIkRBVEFfQ09MTEVDVE9SX0tPVU5UX05PVF9FTkFCTEVEXCJ9KEV8fChFPXt9KSksZnVuY3Rpb24oZSl7ZS5WaXNhPVwidmlzYVwiLGUuTWFzdGVyY2FyZD1cIm1hc3RlcmNhcmRcIixlLkFtZXJpY2FuRXhwcmVzcz1cImFtZXJpY2FuLWV4cHJlc3NcIixlLkRpbmVyc0NsdWI9XCJkaW5lcnMtY2x1YlwiLGUuRGlzY292ZXI9XCJkaXNjb3ZlclwiLGUuSmNiPVwiamNiXCIsZS5VbmlvblBheT1cInVuaW9uLXBheVwiLGUuTWFlc3Rybz1cIm1hZXN0cm9cIixlLkVsbz1cImVsb1wiLGUuTWlyPVwibWlyXCIsZS5IaXBlcj1cImhpcGVyXCIsZS5IaXBlcmNhcmQ9XCJoaXBlcmNhcmRcIn0oVHx8KFQ9e30pKTt2YXIgXz1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBCe2NvbnN0cnVjdG9yKGUpe3RoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyPWV9aW5pdGlhbGl6ZShlKXt0aGlzLnNldENsaWVudFRva2VuKGUpfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBfKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnRlYXJkb3duTW9kdWxlKHRoaXMuZGF0YUNvbGxlY3RvciksdGhpcy5kYXRhQ29sbGVjdG9yPXZvaWQgMH0pfWdldENsaWVudCgpe3JldHVybiBfKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5jbGllbnQpe2NvbnN0IGU9dGhpcy5nZXRDbGllbnRUb2tlbk9yVGhyb3coKSx0PXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRDbGllbnQoKTt0aGlzLmNsaWVudD15aWVsZCB0LmNyZWF0ZSh7YXV0aG9yaXphdGlvbjplfSl9cmV0dXJuIHRoaXMuY2xpZW50fSl9Z2V0RGF0YUNvbGxlY3Rvck9yVGhyb3coZSl7cmV0dXJuIF8odGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9e2RldmljZURhdGE6dm9pZCAwLHRlYXJkb3duOigpPT5Qcm9taXNlLnJlc29sdmUoKX07aWYoIXRoaXMuZGF0YUNvbGxlY3Rvcil0cnl7Y29uc3QgdD15aWVsZCB0aGlzLmdldENsaWVudCgpLGk9eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZERhdGFDb2xsZWN0b3IoKSxuPU9iamVjdC5hc3NpZ24oe2NsaWVudDp0LGtvdW50OiEwfSxlKTt0aGlzLmRhdGFDb2xsZWN0b3I9eWllbGQgaS5jcmVhdGUobil9Y2F0Y2goZSl7aWYoRChlKSYmZS5jb2RlPT09RS5Lb3VudE5vdEVuYWJsZWQpcmV0dXJuIHQ7dGhyb3cgZX1yZXR1cm4gdGhpcy5kYXRhQ29sbGVjdG9yfSl9Z2V0QnJhaW50cmVlR29vZ2xlUGF5bWVudCgpe3JldHVybiBfKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5nb29nbGVQYXltZW50KXtjb25zdFtlLHRdPXlpZWxkIFByb21pc2UuYWxsKFt0aGlzLmdldENsaWVudCgpLHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRHb29nbGVQYXltZW50KCldKTt0aGlzLmdvb2dsZVBheW1lbnQ9eWllbGQgdC5jcmVhdGUoe2NsaWVudDplfSl9cmV0dXJuIHRoaXMuZ29vZ2xlUGF5bWVudH0pfWdldEJyYWludHJlZVRocmVlRFMoKXtyZXR1cm4gXyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMudGhyZWVEUyl7Y29uc3RbZSx0XT15aWVsZCBQcm9taXNlLmFsbChbdGhpcy5nZXRDbGllbnQoKSx0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkM0RTKCldKTt0aGlzLnRocmVlRFM9eWllbGQgdC5jcmVhdGUoe2NsaWVudDplLHZlcnNpb246Mn0pfXJldHVybiB0aGlzLnRocmVlRFN9KX1nZXRCcmFpbnRyZWVMb2NhbFBheW1lbnQoZSl7cmV0dXJuIF8odGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLmJyYWludHJlZUxvY2FsUGF5bWVudCl7Y29uc3RbdCxpXT15aWVsZCBQcm9taXNlLmFsbChbdGhpcy5nZXRDbGllbnQoKSx0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkTG9jYWxQYXltZW50KCldKTt0aGlzLmJyYWludHJlZUxvY2FsUGF5bWVudD15aWVsZCBuZXcgUHJvbWlzZSgobixyKT0+e2kuY3JlYXRlKHtjbGllbnQ6dCxtZXJjaGFudEFjY291bnRJZDplfSwoZSx0KT0+e2UmJnIoZSksbih0KX0pfSl9cmV0dXJuIHRoaXMuYnJhaW50cmVlTG9jYWxQYXltZW50fSl9Z2V0VXNCYW5rQWNjb3VudCgpe3JldHVybiBfKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy51c0JhbmtBY2NvdW50KXtjb25zdCBlPXlpZWxkIHRoaXMuZ2V0Q2xpZW50KCksdD15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkVXNCYW5rQWNjb3VudCgpO3RoaXMudXNCYW5rQWNjb3VudD15aWVsZCB0LmNyZWF0ZSh7Y2xpZW50OmV9KX1yZXR1cm4gdGhpcy51c0JhbmtBY2NvdW50fSl9Z2V0QnJhaW50cmVlVmlzYUNoZWNrb3V0KCl7cmV0dXJuIHRoaXMudmlzYUNoZWNrb3V0fHwodGhpcy52aXNhQ2hlY2tvdXQ9UHJvbWlzZS5hbGwoW3RoaXMuZ2V0Q2xpZW50KCksdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZFZpc2FDaGVja291dCgpXSkudGhlbigoW2UsdF0pPT50LmNyZWF0ZSh7Y2xpZW50OmV9KSkpLHRoaXMudmlzYUNoZWNrb3V0fWdldFZpc2FDaGVja291dFNkayhlKXtyZXR1cm4gXyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMudmlzYUNoZWNrb3V0U0RLfHwodGhpcy52aXNhQ2hlY2tvdXRTREs9eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZFZpc2FDaGVja291dFNkayhlKSksdGhpcy52aXNhQ2hlY2tvdXRTREt9KX1nZXRWZW5tb0NoZWNrb3V0T3JUaHJvdygpe3JldHVybiBfKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5icmFpbnRyZWVWZW5tbyl7Y29uc3QgZT15aWVsZCB0aGlzLmdldENsaWVudCgpLHQ9eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZFZlbm1vQ2hlY2tvdXQoKSxpPXtjbGllbnQ6ZSxhbGxvd0Rlc2t0b3A6ITAscGF5bWVudE1ldGhvZFVzYWdlOlwibXVsdGlfdXNlXCJ9LG49eWllbGQgdC5jcmVhdGUoaSk7aWYoIW4uaXNCcm93c2VyU3VwcG9ydGVkKCkpdGhyb3cgbmV3IE47dGhpcy5icmFpbnRyZWVWZW5tbz1ufXJldHVybiB0aGlzLmJyYWludHJlZVZlbm1vfSl9c2V0Q2xpZW50VG9rZW4oZSl7dGhpcy5jbGllbnRUb2tlbj1lfWdldENsaWVudFRva2VuT3JUaHJvdygpe2lmKCF0aGlzLmNsaWVudFRva2VuKXRocm93IG5ldyBNKEMuUGF5bWVudE5vdEluaXRpYWxpemVkKTtyZXR1cm4gdGhpcy5jbGllbnRUb2tlbn10ZWFyZG93bk1vZHVsZShlKXtyZXR1cm4gZT9lLnRlYXJkb3duKCk6UHJvbWlzZS5yZXNvbHZlKCl9fWZ1bmN0aW9uIHgoZSx0LGk9ITApe3ZhciBuO3JldHVybiBudWxsIT09KG49ZVt0XSkmJnZvaWQgMCE9PW4/bjppfWNsYXNzIEZ7Y29uc3RydWN0b3IoZSl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVXaW5kb3c9d2luZG93fWdldFNES1ZlcnNpb24oKXtjb25zdCBlPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFN0b3JlQ29uZmlnKCksdD0obnVsbD09ZT92b2lkIDA6ZS5jaGVja291dFNldHRpbmdzLmZlYXR1cmVzKXx8e307cmV0dXJuIHRoaXMuZ2V0UHJlbG9hZGVkU0RLVmVyc2lvbigpfHwoeCh0LFwiUEFZUEFMLTU4MDkuYnJhaW50cmVlX2hvc3RlZF9maWVsZHNfZml4X3ZlcnNpb25cIik/djp4KHQsXCJQQVlQQUwtNTYzNi51cGRhdGVfYnJhaW50cmVlX3Nka192ZXJzaW9uXCIpP2Y6Yil9Z2V0UHJlbG9hZGVkU0RLVmVyc2lvbigpe2NvbnN0IGU9dGhpcy5icmFpbnRyZWVXaW5kb3cuYnJhaW50cmVlO2lmKGUpe2NvbnN0IGk9dChPYmplY3QudmFsdWVzKGUpLGU9PiEhZS5WRVJTSU9OKTtyZXR1cm4gbnVsbD09aT92b2lkIDA6aS5WRVJTSU9OfX19ZnVuY3Rpb24gTChlLHQpe3JldHVybiBPYmplY3QuYXNzaWduKGUse3Jlc29sdmVJZHM6dH0pfWNsYXNzIFYgZXh0ZW5kcyBwe2NvbnN0cnVjdG9yKGUpe3N1cGVyKGV8fFwiSW52YWxpZCBhcmd1bWVudHMgaGF2ZSBiZWVuIHByb3ZpZGVkLlwiKSx0aGlzLm5hbWU9XCJJbnZhbGlkQXJndW1lbnRFcnJvclwiLHRoaXMudHlwZT1cImludmFsaWRfYXJndW1lbnRcIn19dmFyIGo7IWZ1bmN0aW9uKGUpe2VbZS5NaXNzaW5nQmlsbGluZ0FkZHJlc3M9MF09XCJNaXNzaW5nQmlsbGluZ0FkZHJlc3NcIixlW2UuTWlzc2luZ0NhcnQ9MV09XCJNaXNzaW5nQ2FydFwiLGVbZS5NaXNzaW5nQ2hlY2tvdXQ9Ml09XCJNaXNzaW5nQ2hlY2tvdXRcIixlW2UuTWlzc2luZ0NvbnNpZ25tZW50cz0zXT1cIk1pc3NpbmdDb25zaWdubWVudHNcIixlW2UuTWlzc2luZ0N1c3RvbWVyPTRdPVwiTWlzc2luZ0N1c3RvbWVyXCIsZVtlLk1pc3NpbmdDaGVja291dENvbmZpZz01XT1cIk1pc3NpbmdDaGVja291dENvbmZpZ1wiLGVbZS5NaXNzaW5nT3JkZXI9Nl09XCJNaXNzaW5nT3JkZXJcIixlW2UuTWlzc2luZ09yZGVyQ29uZmlnPTddPVwiTWlzc2luZ09yZGVyQ29uZmlnXCIsZVtlLk1pc3NpbmdPcmRlcklkPThdPVwiTWlzc2luZ09yZGVySWRcIixlW2UuTWlzc2luZ1BheW1lbnQ9OV09XCJNaXNzaW5nUGF5bWVudFwiLGVbZS5NaXNzaW5nUGF5bWVudElkPTEwXT1cIk1pc3NpbmdQYXltZW50SWRcIixlW2UuTWlzc2luZ1BheW1lbnRJbnN0cnVtZW50PTExXT1cIk1pc3NpbmdQYXltZW50SW5zdHJ1bWVudFwiLGVbZS5NaXNzaW5nUGF5bWVudE1ldGhvZD0xMl09XCJNaXNzaW5nUGF5bWVudE1ldGhvZFwiLGVbZS5NaXNzaW5nUGF5bWVudFJlZGlyZWN0VXJsPTEzXT1cIk1pc3NpbmdQYXltZW50UmVkaXJlY3RVcmxcIixlW2UuTWlzc2luZ1BheW1lbnRTdGF0dXM9MTRdPVwiTWlzc2luZ1BheW1lbnRTdGF0dXNcIixlW2UuTWlzc2luZ1BheW1lbnRUb2tlbj0xNV09XCJNaXNzaW5nUGF5bWVudFRva2VuXCIsZVtlLk1pc3NpbmdTaGlwcGluZ0FkZHJlc3M9MTZdPVwiTWlzc2luZ1NoaXBwaW5nQWRkcmVzc1wifShqfHwoaj17fSkpO2NsYXNzIFUgZXh0ZW5kcyBwe2NvbnN0cnVjdG9yKGUpe3N1cGVyKGZ1bmN0aW9uKGUpe3N3aXRjaChlKXtjYXNlIGouTWlzc2luZ0JpbGxpbmdBZGRyZXNzOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBiaWxsaW5nIGFkZHJlc3MgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIGouTWlzc2luZ0NhcnQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGNhcnQgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIGouTWlzc2luZ0NvbnNpZ25tZW50czpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgY29uc2lnbm1lbnRzIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBqLk1pc3NpbmdDaGVja291dDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgY2hlY2tvdXQgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIGouTWlzc2luZ0N1c3RvbWVyOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBjdXN0b21lciBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2Ugai5NaXNzaW5nQ2hlY2tvdXRDb25maWc6Y2FzZSBqLk1pc3NpbmdPcmRlckNvbmZpZzpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgY29uZmlndXJhdGlvbiBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2Ugai5NaXNzaW5nT3JkZXI6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIG9yZGVyIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBqLk1pc3NpbmdPcmRlcklkOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBvcmRlciBJRCBpcyB1bmF2YWlsYWJsZSBvciBub3QgZ2VuZXJhdGVkIHlldC5cIjtjYXNlIGouTWlzc2luZ1BheW1lbnQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHBheW1lbnQgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIGouTWlzc2luZ1BheW1lbnRUb2tlbjpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHRva2VuIHJlcXVpcmVkIHRvIHN1Ym1pdCBhIHBheW1lbnQgaXMgbWlzc2luZy5cIjtjYXNlIGouTWlzc2luZ1BheW1lbnRNZXRob2Q6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHBheW1lbnQgbWV0aG9kIGRhdGEgaXMgdW5hdmFpbGFibGUgb3Igbm90IHByb3Blcmx5IGNvbmZpZ3VyZWQuXCI7Y2FzZSBqLk1pc3NpbmdTaGlwcGluZ0FkZHJlc3M6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHNoaXBwaW5nIGFkZHJlc3MgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtkZWZhdWx0OnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgcmVxdWlyZWQgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIn19KGUpKSx0aGlzLnN1YnR5cGU9ZSx0aGlzLm5hbWU9XCJNaXNzaW5nRGF0YUVycm9yXCIsdGhpcy50eXBlPVwibWlzc2luZ19kYXRhXCJ9fWNsYXNzIFIgZXh0ZW5kcyBWe2NvbnN0cnVjdG9yKGUpe2xldCB0PVwiVW5hYmxlIHRvIHN1Ym1pdCBwYXltZW50IGZvciB0aGUgb3JkZXIgYmVjYXVzZSB0aGUgcGF5bG9hZCBpcyBpbnZhbGlkLlwiO2UmJih0PWAke3R9IE1ha2Ugc3VyZSB0aGUgZm9sbG93aW5nIGZpZWxkcyBhcmUgcHJvdmlkZWQgY29ycmVjdGx5OiAke2Uuam9pbihcIiwgXCIpfS5gKSxzdXBlcih0KSx0aGlzLm5hbWU9XCJQYXltZW50QXJndW1lbnRJbnZhbGlkRXJyb3JcIn19ZnVuY3Rpb24gSChlKXtyZXR1cm4gQm9vbGVhbihlLmluc3RydW1lbnRJZCl9Y2xhc3MgVyBleHRlbmRzIHB7Y29uc3RydWN0b3IoKXtzdXBlcihcIlRoZSBjdXJyZW50IG9yZGVyIGRvZXMgbm90IG5lZWQgdG8gYmUgZmluYWxpemVkIGF0IHRoaXMgc3RhZ2UuXCIpLHRoaXMubmFtZT1cIk9yZGVyRmluYWxpemF0aW9uTm90UmVxdWlyZWRFcnJvclwiLHRoaXMudHlwZT1cIm9yZGVyX2ZpbmFsaXphdGlvbl9ub3RfcmVxdWlyZWRcIn19ZnVuY3Rpb24gcShlKXtyZXR1cm4hKFwib2JqZWN0XCIhPXR5cGVvZiBlfHxudWxsPT09ZXx8dm9pZCAwIT09ZS5zaG91bGRTYXZlSW5zdHJ1bWVudCYmXCJib29sZWFuXCIhPXR5cGVvZiBlLnNob3VsZFNhdmVJbnN0cnVtZW50fHx2b2lkIDAhPT1lLnNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQmJlwiYm9vbGVhblwiIT10eXBlb2YgZS5zaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50KX1jbGFzcyAkIGV4dGVuZHMgcHtjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIGNsaWVudCBsaWJyYXJ5IG9mIGEgcGF5bWVudCBtZXRob2QgaGFzIHRocm93biBhbiB1bmV4cGVjdGVkIGVycm9yLlwiKSx0aGlzLm5hbWU9XCJQYXltZW50TWV0aG9kRmFpbGVkRXJyb3JcIix0aGlzLnR5cGU9XCJwYXltZW50X21ldGhvZF9jbGllbnRfaW52YWxpZFwifX1mdW5jdGlvbiBHKGUpe3JldHVybiEhZSYmXCJhY2NvdW50TnVtYmVyXCJpbiBlJiZcInJvdXRpbmdOdW1iZXJcImluIGUmJlwib3duZXJzaGlwVHlwZVwiaW4gZSYmXCJhY2NvdW50VHlwZVwiaW4gZX12YXIgWT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBKe2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVTZGs9dH1pbml0aWFsaXplKGUpe3JldHVybiBZKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHttZXRob2RJZDp0LGJyYWludHJlZWFjaDppfT1lfHx7fTtpZighdCl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt0aGlzLmdldE1hbmRhdGVUZXh0PW51bGw9PWk/dm9pZCAwOmkuZ2V0TWFuZGF0ZVRleHQseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKHQpO2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCkse2NsaWVudFRva2VuOnIsaW5pdGlhbGl6YXRpb25EYXRhOm99PW47aWYoIXJ8fCFvKXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRNZXRob2QpO3RoaXMuYnJhaW50cmVlU2RrLmluaXRpYWxpemUocik7dHJ5e3RoaXMudXNCYW5rQWNjb3VudD15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXRVc0JhbmtBY2NvdW50KCl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVCcmFpbnRyZWVFcnJvcihlKX19KX1leGVjdXRlKGUsdCl7cmV0dXJuIFkodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6aX09ZSxuPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7cjxuLmxlbmd0aDtyKyspdC5pbmRleE9mKG5bcl0pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bcl0pJiYoaVtuW3JdXT1lW25bcl1dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKTtpZighaSl0aHJvdyBuZXcgUihbXCJwYXltZW50XCJdKTtjb25zdCByPUgoaS5wYXltZW50RGF0YXx8e30pLG89cj95aWVsZCB0aGlzLnRva2VuaXplUGF5bWVudEZvclZhdWx0ZWRJbnN0cnVtZW50KGkpOnlpZWxkIHRoaXMudG9rZW5pemVQYXltZW50KGkpLGE9cj95aWVsZCB0aGlzLnByZXBhcmVQYXltZW50RGF0YUZvclZhdWx0ZWRJbnN0cnVtZW50KG8saSk6eWllbGQgdGhpcy5wcmVwYXJlUGF5bWVudERhdGEobyxpKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIobix0KSx5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChhKX0pfWZpbmFsaXplKCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBXKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gWSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmRlaW5pdGlhbGl6ZSgpLFByb21pc2UucmVzb2x2ZSgpfSl9dG9rZW5pemVQYXltZW50KHtwYXltZW50RGF0YTplfSl7cmV0dXJuIFkodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5nZXRVc0JhbmtBY2NvdW50T3JUaHJvdygpO2lmKCFHKGUpKXRocm93IG5ldyBSKFtcInBheW1lbnQucGF5bWVudERhdGFcIl0pO2NvbnN0IGk9SChlKT9cIlRoZSBkYXRhIGFyZSB1c2VkIGZvciBzdG9yZWQgaW5zdHJ1bWVudCB2ZXJpZmljYXRpb25cIjpcImZ1bmN0aW9uXCI9PXR5cGVvZiB0aGlzLmdldE1hbmRhdGVUZXh0JiZ0aGlzLmdldE1hbmRhdGVUZXh0KCk7aWYoIWkpdGhyb3cgbmV3IFYoXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGdldE1hbmRhdGVUZXh0IGlzIG5vdCBwcm92aWRlZCBvciByZXR1cm5lZCB1bmRlZmluZWQgdmFsdWUuXCIpO3RyeXtjb25zdHtub25jZTpufT15aWVsZCB0LnRva2VuaXplKHtiYW5rRGV0YWlsczp0aGlzLmdldEJhbmtEZXRhaWxzKGUpLG1hbmRhdGVUZXh0Oml9KTtyZXR1cm4gbn1jYXRjaChlKXt0aGlzLmhhbmRsZUJyYWludHJlZUVycm9yKGUpfX0pfXRva2VuaXplUGF5bWVudEZvclZhdWx0ZWRJbnN0cnVtZW50KGUpe3JldHVybiBZKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHttZXRob2RJZDp0LHBheW1lbnREYXRhOmk9e319PWUsbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSx7Y29uZmlnOnJ9PW4uZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCk7aWYoIXIuaXNWYXVsdGluZ0VuYWJsZWQpdGhyb3cgbmV3IFYoXCJWYXVsdGluZyBpcyBkaXNhYmxlZCBidXQgYSB2YXVsdGVkIGluc3RydW1lbnQgd2FzIGJlaW5nIHVzZWQgZm9yIHRoaXMgdHJhbnNhY3Rpb25cIik7cmV0dXJuIEcoaSk/dGhpcy50b2tlbml6ZVBheW1lbnQoZSk6bnVsbH0pfXByZXBhcmVQYXltZW50RGF0YShlLHQpe3JldHVybiBZKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHttZXRob2RJZDppLHBheW1lbnREYXRhOm49e319PXQ7aWYoIUcobikpdGhyb3cgbmV3IFIoW1wicGF5bWVudC5wYXltZW50RGF0YVwiXSk7Y29uc3R7ZGV2aWNlRGF0YTpyfT15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXREYXRhQ29sbGVjdG9yT3JUaHJvdygpLHtzaG91bGRTYXZlSW5zdHJ1bWVudDpvLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6YSxyb3V0aW5nTnVtYmVyOnMsYWNjb3VudE51bWJlcjpkfT1uO3JldHVybnttZXRob2RJZDppLHBheW1lbnREYXRhOntkZXZpY2VTZXNzaW9uSWQ6cixzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OmEsc2hvdWxkU2F2ZUluc3RydW1lbnQ6byxmb3JtYXR0ZWRQYXlsb2FkOnt0b2tlbml6ZWRfYmFua19hY2NvdW50Ontpc3N1ZXI6cyxtYXNrZWRfYWNjb3VudF9udW1iZXI6ZC5zdWJzdHIoLTQpLHRva2VuOmV9fX19fSl9cHJlcGFyZVBheW1lbnREYXRhRm9yVmF1bHRlZEluc3RydW1lbnQoZSx0KXtyZXR1cm4gWSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6aSxwYXltZW50RGF0YTpuPXt9fT10O2lmKCFIKG4pfHwhcShuKSl0aHJvdyBuZXcgUihbXCJwYXltZW50LnBheW1lbnREYXRhXCJdKTtjb25zdHtkZXZpY2VEYXRhOnJ9PXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldERhdGFDb2xsZWN0b3JPclRocm93KCkse2luc3RydW1lbnRJZDpvLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6YX09bjtyZXR1cm57bWV0aG9kSWQ6aSxwYXltZW50RGF0YTpPYmplY3QuYXNzaWduKHtkZXZpY2VTZXNzaW9uSWQ6cixpbnN0cnVtZW50SWQ6byxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OmF9LGUmJntub25jZTplfSl9fSl9Z2V0QmFua0RldGFpbHMoZSl7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRCaWxsaW5nQWRkcmVzc09yVGhyb3coKSxpPWUub3duZXJzaGlwVHlwZS50b0xvd2VyQ2FzZSgpLG49ZS5hY2NvdW50VHlwZS50b0xvd2VyQ2FzZSgpO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe2FjY291bnROdW1iZXI6ZS5hY2NvdW50TnVtYmVyLHJvdXRpbmdOdW1iZXI6ZS5yb3V0aW5nTnVtYmVyLG93bmVyc2hpcFR5cGU6aX0sXCJwZXJzb25hbFwiPT09aT97Zmlyc3ROYW1lOmUuZmlyc3ROYW1lLGxhc3ROYW1lOmUubGFzdE5hbWV9OntidXNpbmVzc05hbWU6ZS5idXNpbmVzc05hbWV9KSx7YWNjb3VudFR5cGU6bixiaWxsaW5nQWRkcmVzczp7c3RyZWV0QWRkcmVzczp0LmFkZHJlc3MxLGV4dGVuZGVkQWRkcmVzczp0LmFkZHJlc3MyLGxvY2FsaXR5OnQuY2l0eSxyZWdpb246dC5zdGF0ZU9yUHJvdmluY2VDb2RlLHBvc3RhbENvZGU6dC5wb3N0YWxDb2RlfX0pfWdldFVzQmFua0FjY291bnRPclRocm93KCl7aWYoIXRoaXMudXNCYW5rQWNjb3VudCl0aHJvdyBuZXcgTShDLlBheW1lbnROb3RJbml0aWFsaXplZCk7cmV0dXJuIHRoaXMudXNCYW5rQWNjb3VudH1oYW5kbGVCcmFpbnRyZWVFcnJvcihlKXtpZighRChlKSl0aHJvdyBlO3Rocm93IG5ldyAkKGUubWVzc2FnZSl9fWNvbnN0IEs9TCh0PT5uZXcgSih0LCh0PT57Y29uc3QgaT1uZXcgRih0KSxuPW5ldyB6KGUoKSx3aW5kb3csaSk7cmV0dXJuIG5ldyBCKG4pfSkodCkpLFt7aWQ6XCJicmFpbnRyZWVhY2hcIn1dKTtjbGFzcyBYIGV4dGVuZHMgcHtjb25zdHJ1Y3RvcihlLHQpe3N1cGVyKHR8fFwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgcGF5bWVudCBmb3JtIGNvbnRhaW5zIGludmFsaWQgZGF0YS5cIiksdGhpcy5kZXRhaWxzPWUsdGhpcy5uYW1lPVwiUGF5bWVudEludmFsaWRGb3JtRXJyb3JcIix0aGlzLnR5cGU9XCJwYXltZW50X2ludmFsaWRfZm9ybVwifX1jbGFzcyBRIGV4dGVuZHMgcHtjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIlBheW1lbnQgcHJvY2VzcyB3YXMgY2FuY2VsbGVkLlwiKSx0aGlzLm5hbWU9XCJQYXltZW50TWV0aG9kQ2FuY2VsbGVkRXJyb3JcIix0aGlzLnR5cGU9XCJwYXltZW50X2NhbmNlbGxlZFwifX1jbGFzcyBae2NvbnN0cnVjdG9yKGUpe2NvbnN0IHQ9bmV3IFByb21pc2UoKGUsdCk9Pnt0aGlzLmNhbmNlbD10fSk7dGhpcy5wcm9taXNlPVByb21pc2UucmFjZShbZSx0XSl9fWNvbnN0IGVlPVtcImJ1dHRvbnNcIixcIm1lc3NhZ2VzXCJdO3ZhciB0ZSxpZSxuZSxyZSxvZSxhZTshZnVuY3Rpb24oZSl7ZS5IT1JJWk9OVEFMPVwiaG9yaXpvbnRhbFwiLGUuVkVSVElDQUw9XCJ2ZXJ0aWNhbFwifSh0ZXx8KHRlPXt9KSksZnVuY3Rpb24oZSl7ZS5TTUFMTD1cInNtYWxsXCIsZS5NRURJVU09XCJtZWRpdW1cIixlLkxBUkdFPVwibGFyZ2VcIixlLlJFU1BPTlNJVkU9XCJyZXNwb25zaXZlXCJ9KGllfHwoaWU9e30pKSxmdW5jdGlvbihlKXtlLkdPTEQ9XCJnb2xkXCIsZS5CTFVFPVwiYmx1ZVwiLGUuU0lsVkVSPVwic2lsdmVyXCIsZS5CTEFDSz1cImJsYWNrXCIsZS5XSElURT1cIndoaXRlXCJ9KG5lfHwobmU9e30pKSxmdW5jdGlvbihlKXtlLkNIRUNLT1VUPVwiY2hlY2tvdXRcIixlLlBBWT1cInBheVwiLGUuQlVZTk9XPVwiYnV5bm93XCIsZS5QQVlQQUw9XCJwYXlwYWxcIixlLkNSRURJVD1cImNyZWRpdFwifShyZXx8KHJlPXt9KSksZnVuY3Rpb24oZSl7ZS5QSUxMPVwicGlsbFwiLGUuUkVDVD1cInJlY3RcIn0ob2V8fChvZT17fSkpLGZ1bmN0aW9uKGUpe2UuQ0FSVD1cImNhcnRcIixlLkhPTUU9XCJob21lcGFnZVwiLGUuUEFZTUVOVD1cInBheW1lbnRcIixlLlBST0RVQ1Q9XCJwcm9kdWN0XCJ9KGFlfHwoYWU9e30pKTt2YXIgc2U9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgZGV7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyPWUsdGhpcy5icmFpbnRyZWVIb3N0V2luZG93PXQsdGhpcy5vdmVybGF5PWksdGhpcy5kYXRhQ29sbGVjdG9ycz17fX1pbml0aWFsaXplKGUsdCl7dGhpcy5jbGllbnRUb2tlbj1lLHRoaXMudGhyZWVEU2VjdXJlT3B0aW9ucz10fWdldEJyYWludHJlZUZhc3RsYW5lKGUsdCxpKXtyZXR1cm4gc2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKHQmJih3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJheG9FbnZcIixcInNhbmRib3hcIiksd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiZmFzdGxhbmVFbnZcIixcInNhbmRib3hcIikpLCF0aGlzLmJyYWludHJlZUhvc3RXaW5kb3cuYnJhaW50cmVlRmFzdGxhbmUpe2NvbnN0IHQ9dGhpcy5nZXRDbGllbnRUb2tlbk9yVGhyb3coKSxuPXlpZWxkIHRoaXMuZ2V0Q2xpZW50KCkscj15aWVsZCB0aGlzLmdldFNlc3Npb25JZChlKSxvPXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRGYXN0bGFuZSgpLGE9e3Jvb3Q6e2JhY2tncm91bmRDb2xvclByaW1hcnk6XCJ0cmFuc3BhcmVudFwifX07dGhpcy5icmFpbnRyZWVIb3N0V2luZG93LmJyYWludHJlZUZhc3RsYW5lPXlpZWxkIG8uY3JlYXRlKHthdXRob3JpemF0aW9uOnQsY2xpZW50Om4sZGV2aWNlRGF0YTpyLHN0eWxlczppfHxhfSl9cmV0dXJuIHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5icmFpbnRyZWVGYXN0bGFuZX0pfWdldENsaWVudCgpe3JldHVybiBzZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuY2xpZW50KXtjb25zdCBlPXRoaXMuZ2V0Q2xpZW50VG9rZW5PclRocm93KCksdD15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkQ2xpZW50KCk7dGhpcy5jbGllbnQ9dC5jcmVhdGUoe2F1dGhvcml6YXRpb246ZX0pfXJldHVybiB0aGlzLmNsaWVudH0pfWdldFBheXBhbCgpe3JldHVybiB0aGlzLmJyYWludHJlZVBheXBhbHx8KHRoaXMuYnJhaW50cmVlUGF5cGFsPVByb21pc2UuYWxsKFt0aGlzLmdldENsaWVudCgpLHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRQYXlwYWwoKV0pLnRoZW4oKFtlLHRdKT0+dC5jcmVhdGUoe2NsaWVudDplfSkpKSx0aGlzLmJyYWludHJlZVBheXBhbH1wYXlwYWwoZSl7dmFye3Nob3VsZFNhdmVJbnN0cnVtZW50OnR9PWUsaT1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wic2hvdWxkU2F2ZUluc3RydW1lbnRcIl0pO2NvbnN0IG49bCgpO3JldHVybiB0aGlzLmdldFBheXBhbCgpLnRoZW4oZT0+e3ZhciByO3JldHVybiBuJiYobnVsbD09PShyPXRoaXMub3ZlcmxheSl8fHZvaWQgMD09PXJ8fHIuc2hvdyh7b25DbGljazooKT0+ZS5mb2N1c1dpbmRvdygpfSkpLGUudG9rZW5pemUoT2JqZWN0LmFzc2lnbih7ZW5hYmxlU2hpcHBpbmdBZGRyZXNzOiEwLGZsb3c6dD9cInZhdWx0XCI6XCJjaGVja291dFwiLHVzZXJhY3Rpb246XCJjb21taXRcIn0saSkpfSkudGhlbihlPT57dmFyIHQ7cmV0dXJuIG51bGw9PT0odD10aGlzLm92ZXJsYXkpfHx2b2lkIDA9PT10fHx0LnJlbW92ZSgpLGV9KS5jYXRjaChlPT57dmFyIHQ7dGhyb3cgbnVsbD09PSh0PXRoaXMub3ZlcmxheSl8fHZvaWQgMD09PXR8fHQucmVtb3ZlKCksZX0pfWdldFBheXBhbENoZWNrb3V0KGUsdCxpKXtyZXR1cm4gc2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IG49eWllbGQgdGhpcy5nZXRDbGllbnQoKSxyPXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRQYXlwYWxDaGVja291dCgpLG89e2NsaWVudDpufTtyZXR1cm4gdGhpcy5wYXlwYWxDaGVja291dD15aWVsZCByLmNyZWF0ZShvLChuLHIpPT57dmFyIG87aWYobilyZXR1cm4gaShuKTtjb25zdCBhPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7Y3VycmVuY3k6ZS5jdXJyZW5jeX0sZS5pc0NyZWRpdEVuYWJsZWQmJntcImVuYWJsZS1mdW5kaW5nXCI6XCJwYXlsYXRlclwifSkse2NvbXBvbmVudHM6ZWUudG9TdHJpbmcoKSxpbnRlbnQ6ZS5pbnRlbnQsY29tbWl0Om51bGw9PT0obz1lLmNvbW1pdCl8fHZvaWQgMD09PW98fG99KTt0aGlzLmJyYWludHJlZUhvc3RXaW5kb3cucGF5cGFsP3Qocik6ci5sb2FkUGF5UGFsU0RLKGEsKCk9PnQocikpfSksdGhpcy5wYXlwYWxDaGVja291dH0pfWdldERhdGFDb2xsZWN0b3IoZSl7cmV0dXJuIHNlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PShudWxsPT1lP3ZvaWQgMDplLnBheXBhbCk/XCJwYXlwYWxcIjpcImRlZmF1bHRcIjtsZXQgaT10aGlzLmRhdGFDb2xsZWN0b3JzW3RdO2lmKCFpKXt0cnl7Y29uc3QgdD15aWVsZCB0aGlzLmdldENsaWVudCgpLG49eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZERhdGFDb2xsZWN0b3IoKSxyPU9iamVjdC5hc3NpZ24oe2NsaWVudDp0LGtvdW50OiEwfSxlKTtpPXlpZWxkIG4uY3JlYXRlKHIpfWNhdGNoKGUpe2lmKCFEKGUpfHxcIkRBVEFfQ09MTEVDVE9SX0tPVU5UX05PVF9FTkFCTEVEXCIhPT1lLmNvZGUpdGhyb3cgZTtpPXtkZXZpY2VEYXRhOnZvaWQgMCx0ZWFyZG93bjooKT0+UHJvbWlzZS5yZXNvbHZlKCl9fXRoaXMuZGF0YUNvbGxlY3RvcnNbdF09aX1yZXR1cm4gaX0pfWdldEJyYWludHJlZUVudihlPSExKXtyZXR1cm4gZT9oLlNhbmRib3g6aC5Qcm9kdWN0aW9ufW1hcFRvQnJhaW50cmVlU2hpcHBpbmdBZGRyZXNzT3ZlcnJpZGUoZSl7cmV0dXJue3JlY2lwaWVudE5hbWU6YCR7ZS5maXJzdE5hbWV9ICR7ZS5sYXN0TmFtZX1gLGxpbmUxOmUuYWRkcmVzczEsbGluZTI6ZS5hZGRyZXNzMixjaXR5OmUuY2l0eSxzdGF0ZTplLnN0YXRlT3JQcm92aW5jZUNvZGUscG9zdGFsQ29kZTplLnBvc3RhbENvZGUsY291bnRyeUNvZGU6ZS5jb3VudHJ5Q29kZSxwaG9uZTplLnBob25lfX1tYXBUb0xlZ2FjeVNoaXBwaW5nQWRkcmVzcyhlKXtjb25zdHtlbWFpbDp0LHBob25lOmksc2hpcHBpbmdBZGRyZXNzOm59PWUscj0obnVsbD09bj92b2lkIDA6bi5yZWNpcGllbnROYW1lKXx8XCJcIixbbyxhXT1yLnNwbGl0KFwiIFwiKTtyZXR1cm57ZW1haWw6dCxmaXJzdF9uYW1lOm98fFwiXCIsbGFzdF9uYW1lOmF8fFwiXCIscGhvbmVfbnVtYmVyOmksYWRkcmVzc19saW5lXzE6bnVsbD09bj92b2lkIDA6bi5saW5lMSxhZGRyZXNzX2xpbmVfMjpudWxsPT1uP3ZvaWQgMDpuLmxpbmUyLGNpdHk6bnVsbD09bj92b2lkIDA6bi5jaXR5LHN0YXRlOm51bGw9PW4/dm9pZCAwOm4uc3RhdGUsY291bnRyeV9jb2RlOm51bGw9PW4/dm9pZCAwOm4uY291bnRyeUNvZGUscG9zdGFsX2NvZGU6bnVsbD09bj92b2lkIDA6bi5wb3N0YWxDb2RlfX1tYXBUb0xlZ2FjeUJpbGxpbmdBZGRyZXNzKGUpe2NvbnN0e2JpbGxpbmdBZGRyZXNzOnQsZW1haWw6aSxmaXJzdE5hbWU6bixsYXN0TmFtZTpyLHBob25lOm8sc2hpcHBpbmdBZGRyZXNzOmF9PWUscz10fHxhO3JldHVybntlbWFpbDppLGZpcnN0X25hbWU6bixsYXN0X25hbWU6cixwaG9uZV9udW1iZXI6byxhZGRyZXNzX2xpbmVfMTpudWxsPT1zP3ZvaWQgMDpzLmxpbmUxLGFkZHJlc3NfbGluZV8yOm51bGw9PXM/dm9pZCAwOnMubGluZTIsY2l0eTpudWxsPT1zP3ZvaWQgMDpzLmNpdHksc3RhdGU6bnVsbD09cz92b2lkIDA6cy5zdGF0ZSxjb3VudHJ5X2NvZGU6bnVsbD09cz92b2lkIDA6cy5jb3VudHJ5Q29kZSxwb3N0YWxfY29kZTpudWxsPT1zP3ZvaWQgMDpzLnBvc3RhbENvZGV9fXJlbW92ZUVsZW1lbnQoZSl7Y29uc3QgdD1lJiZkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlKTt0JiZ0LnJlbW92ZSgpfWdldFNlc3Npb25JZChlKXtyZXR1cm4gc2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2RldmljZURhdGE6dH09eWllbGQgdGhpcy5nZXREYXRhQ29sbGVjdG9yKHtyaXNrQ29ycmVsYXRpb25JZDplfSk7cmV0dXJuIHR9KX10ZWFyZG93bigpe3JldHVybiBzZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy50ZWFyZG93bk1vZHVsZSh0aGlzLmRhdGFDb2xsZWN0b3JzLmRlZmF1bHQpLHlpZWxkIHRoaXMudGVhcmRvd25Nb2R1bGUodGhpcy5kYXRhQ29sbGVjdG9ycy5wYXlwYWwpLHRoaXMuZGF0YUNvbGxlY3RvcnM9e30seWllbGQgdGhpcy50ZWFyZG93bk1vZHVsZSh0aGlzLnBheXBhbENoZWNrb3V0KSx0aGlzLnBheXBhbENoZWNrb3V0PXZvaWQgMH0pfWdldDNEUygpe3JldHVybiBzZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMudGhyZWVEU3x8KHRoaXMudGhyZWVEUz1Qcm9taXNlLmFsbChbdGhpcy5nZXRDbGllbnQoKSx0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkM0RTKCldKS50aGVuKChbZSx0XSk9PnQuY3JlYXRlKHtjbGllbnQ6ZSx2ZXJzaW9uOjJ9KSkpLHRoaXMudGhyZWVEU30pfWdldFZlbm1vQ2hlY2tvdXQoZSl7cmV0dXJuIHNlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy52ZW5tb0NoZWNrb3V0KXtjb25zdCB0PXlpZWxkIHRoaXMuZ2V0Q2xpZW50KCksaT15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkVmVubW9DaGVja291dCgpLG49T2JqZWN0LmFzc2lnbih7Y2xpZW50OnQsYWxsb3dEZXNrdG9wOiEwLHBheW1lbnRNZXRob2RVc2FnZTpcIm11bHRpX3VzZVwifSxlfHx7fSk7dGhpcy52ZW5tb0NoZWNrb3V0PXlpZWxkIG5ldyBQcm9taXNlKChlLHQpPT57aS5jcmVhdGUobiwoaSxuKT0+aT90KGkpOm4uaXNCcm93c2VyU3VwcG9ydGVkKCk/dm9pZCBlKG4pOnQobmV3IE4pKX0pfXJldHVybiB0aGlzLnZlbm1vQ2hlY2tvdXR9KX12ZXJpZnlDYXJkKGUsdCxpKXtyZXR1cm4gc2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IG49eWllbGQgdGhpcy50b2tlbml6ZUNhcmQoZSx0KTtyZXR1cm4gdGhpcy5jaGFsbGVuZ2UzRFNWZXJpZmljYXRpb24obixpKX0pfXRva2VuaXplQ2FyZChlLHQpe3JldHVybiBzZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cGF5bWVudERhdGE6bn09ZTtpZighZnVuY3Rpb24oZSl7aWYoXCJvYmplY3RcIiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiExO2NvbnN0IHQ9ZTtyZXR1cm5cIm9iamVjdFwiPT10eXBlb2YgdC5jY0V4cGlyeSYmbnVsbCE9PXQuY2NFeHBpcnkmJlwic3RyaW5nXCI9PXR5cGVvZiB0LmNjTnVtYmVyJiZcInN0cmluZ1wiPT10eXBlb2YgdC5jY05hbWV9KG4pKXRocm93IG5ldyBSKFtcInBheW1lbnQucGF5bWVudERhdGFcIl0pO2NvbnN0IHI9dGhpcy5nZXRFcnJvcnNSZXF1aXJlZEZpZWxkcyhuKTtpZighaShyKSl0aHJvdyBuZXcgWChyKTtjb25zdCBvPXRoaXMubWFwVG9DcmVkaXRDYXJkKG4sdCksYT15aWVsZCB0aGlzLmdldENsaWVudCgpLHtjcmVkaXRDYXJkczpzfT15aWVsZCBhLnJlcXVlc3Qobyk7cmV0dXJue25vbmNlOnNbMF0ubm9uY2UsYmluOnNbMF0uZGV0YWlscy5iaW59fSl9Y2hhbGxlbmdlM0RTVmVyaWZpY2F0aW9uKGUsdCl7cmV0dXJuIHNlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPXlpZWxkIHRoaXMuZ2V0M0RTKCk7cmV0dXJuIHRoaXMucHJlc2VudDNEU0NoYWxsZW5nZShpLHQsZSl9KX10ZWFyZG93bk1vZHVsZShlKXtyZXR1cm4gZT9lLnRlYXJkb3duKCk6UHJvbWlzZS5yZXNvbHZlKCl9Z2V0Q2xpZW50VG9rZW5PclRocm93KCl7aWYoIXRoaXMuY2xpZW50VG9rZW4pdGhyb3cgbmV3IE0oQy5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO3JldHVybiB0aGlzLmNsaWVudFRva2VufWdldEVycm9yc1JlcXVpcmVkRmllbGRzKGUpe2NvbnN0e2NjTnVtYmVyOnQsY2NFeHBpcnk6aX09ZSxuPXt9O3JldHVybiB0fHwobi5jY051bWJlcj1be21lc3NhZ2U6XCJDcmVkaXQgY2FyZCBudW1iZXIgaXMgcmVxdWlyZWRcIix0eXBlOlwicmVxdWlyZWRcIn1dKSxpfHwobi5jY0V4cGlyeT1be21lc3NhZ2U6XCJFeHBpcmF0aW9uIGRhdGUgaXMgcmVxdWlyZWRcIix0eXBlOlwicmVxdWlyZWRcIn1dKSxufW1hcFRvQ3JlZGl0Q2FyZChlLHQpe3JldHVybntkYXRhOntjcmVkaXRDYXJkOntjYXJkaG9sZGVyTmFtZTplLmNjTmFtZSxudW1iZXI6ZS5jY051bWJlcixjdnY6ZS5jY0N2dixleHBpcmF0aW9uRGF0ZTpgJHtlLmNjRXhwaXJ5Lm1vbnRofS8ke2UuY2NFeHBpcnkueWVhcn1gLG9wdGlvbnM6e3ZhbGlkYXRlOiExfSxiaWxsaW5nQWRkcmVzczp0JiZ7Y291bnRyeUNvZGVBbHBoYTI6dC5jb3VudHJ5Q29kZSxsb2NhbGl0eTp0LmNpdHksY291bnRyeU5hbWU6dC5jb3VudHJ5LHBvc3RhbENvZGU6dC5wb3N0YWxDb2RlLHN0cmVldEFkZHJlc3M6dC5hZGRyZXNzMj9gJHt0LmFkZHJlc3MxfSAke3QuYWRkcmVzczJ9YDp0LmFkZHJlc3MxfX19LGVuZHBvaW50OlwicGF5bWVudF9tZXRob2RzL2NyZWRpdF9jYXJkc1wiLG1ldGhvZDpcInBvc3RcIn19cHJlc2VudDNEU0NoYWxsZW5nZShlLHQsaSl7Y29uc3R7bm9uY2U6bixiaW46cn09aTtpZighdGhpcy50aHJlZURTZWN1cmVPcHRpb25zfHwhbil0aHJvdyBuZXcgTShDLlBheW1lbnROb3RJbml0aWFsaXplZCk7Y29uc3R7YWRkRnJhbWU6byxyZW1vdmVGcmFtZTphLGNoYWxsZW5nZVJlcXVlc3RlZDpzPSEwLGFkZGl0aW9uYWxJbmZvcm1hdGlvbjpkfT10aGlzLnRocmVlRFNlY3VyZU9wdGlvbnMsbD0oKT0+c2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9eWllbGQgZS5jYW5jZWxWZXJpZnlDYXJkKCk7cmV0dXJuIHUuY2FuY2VsKG5ldyBRKSx0fSksYz10LnRvRml4ZWQoMiksdT1uZXcgWihlLnZlcmlmeUNhcmQoe2FkZEZyYW1lOihlLHQpPT57byYmbyhlLHQsbCl9LGFtb3VudDpOdW1iZXIoYyksYmluOnIsY2hhbGxlbmdlUmVxdWVzdGVkOnMsbm9uY2U6bixyZW1vdmVGcmFtZTphLG9uTG9va3VwQ29tcGxldGU6KGUsdCk9Pnt0KCl9LGNvbGxlY3REZXZpY2VEYXRhOiEwLGFkZGl0aW9uYWxJbmZvcm1hdGlvbjpkfSkpO3JldHVybiB1LnByb21pc2V9fWNsYXNzIGxle2NvbnN0cnVjdG9yKGUpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdz13aW5kb3d9cmVuZGVyKGUsdCxpKXtjb25zdCBuPXQmJmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHQpO2lmKHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5wYXlwYWwmJm4pe2NvbnN0IHI9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksbz1yLmdldENhcnRPclRocm93KCksYT1yLmdldEJpbGxpbmdBZGRyZXNzT3JUaHJvdygpLHM9ci5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKTtpZighcy5pbml0aWFsaXphdGlvbkRhdGEpcmV0dXJuO2NvbnN0e3BheXBhbEJOUExDb25maWd1cmF0aW9uOmQ9W119PXMuaW5pdGlhbGl6YXRpb25EYXRhLGw9aT09PWFlLlBBWU1FTlQ/XCJjaGVja291dFwiOmksYz1kJiZkLmZpbmQoKHtpZDplfSk9PmU9PT1sKTtpZighY3x8IWMuc3RhdHVzKXJldHVybjtpPT09YWUuQ0FSVCYmKG4ucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcC1zdHlsZS1sb2dvLXR5cGVcIiksbi5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXBwLXN0eWxlLWxvZ28tcG9zaXRpb25cIiksbi5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXBwLXN0eWxlLXRleHQtY29sb3JcIiksbi5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXBwLXN0eWxlLXRleHQtc2l6ZVwiKSksdGhpcy5icmFpbnRyZWVIb3N0V2luZG93LnBheXBhbC5NZXNzYWdlcyh7YW1vdW50Om8uY2FydEFtb3VudCxidXllckNvdW50cnk6YS5jb3VudHJ5Q29kZSxwbGFjZW1lbnQ6aSxzdHlsZTp0aGlzLmdldFBheXBhbE1lc3NhZ2VzU3R5bGVzRnJvbUJOUExDb25maWcoYyl9KS5yZW5kZXIoYCMke3R9YCl9fWdldFBheXBhbE1lc3NhZ2VzU3R5bGVzRnJvbUJOUExDb25maWcoe3N0eWxlczplfSl7Y29uc3QgdD17fTtyZXR1cm4gZS5jb2xvciYmKHQuY29sb3I9ZS5jb2xvciksZS5sYXlvdXQmJih0LmxheW91dD1lLmxheW91dCksKGVbXCJsb2dvLXR5cGVcIl18fGVbXCJsb2dvLXBvc2l0aW9uXCJdKSYmKHQubG9nbz17fSxlW1wibG9nby10eXBlXCJdJiYodC5sb2dvLnR5cGU9ZVtcImxvZ28tdHlwZVwiXSksZVtcImxvZ28tcG9zaXRpb25cIl0mJih0LmxvZ28ucG9zaXRpb249ZVtcImxvZ28tcG9zaXRpb25cIl0pKSxlLnJhdGlvJiYodC5yYXRpbz1lLnJhdGlvKSwoZVtcInRleHQtY29sb3JcIl18fGVbXCJ0ZXh0LXNpemVcIl0pJiYodC50ZXh0PXt9LGVbXCJ0ZXh0LWNvbG9yXCJdJiYodC50ZXh0LmNvbG9yPWVbXCJ0ZXh0LWNvbG9yXCJdKSxlW1widGV4dC1zaXplXCJdJiYodC50ZXh0LnNpemU9K2VbXCJ0ZXh0LXNpemVcIl0pKSx0fX1jbGFzcyBjZXtjb25zdHJ1Y3RvcihlKXtjb25zdHtlbGVtZW50OnQsY2xvc2VFbGVtZW50OmksbWFpbkVsZW1lbnQ6bn09dGhpcy5fY3JlYXRlRWxlbWVudHMoZSk7dGhpcy5fZWxlbWVudD10LHRoaXMuX2Nsb3NlRWxlbWVudD1pLHRoaXMuX21haW5FbGVtZW50PW59c2hvdyhlKXt0aGlzLl9tYWluRWxlbWVudC5wYXJlbnRFbGVtZW50fHwodGhpcy5fcmVnaXN0ZXJDbGljayhlKSxkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuX21haW5FbGVtZW50KSxzZXRUaW1lb3V0KCgpPT50aGlzLl9lbGVtZW50LnN0eWxlLm9wYWNpdHk9XCIxXCIpKX1yZW1vdmUoKXt0aGlzLl9tYWluRWxlbWVudC5wYXJlbnRFbGVtZW50JiYodGhpcy5fdW5yZWdpc3RlckNsaWNrJiZ0aGlzLl91bnJlZ2lzdGVyQ2xpY2soKSx0aGlzLl9yZW1vdmVBZnRlclRyYW5zaXRpb24oKSxzZXRUaW1lb3V0KCgpPT50aGlzLl9lbGVtZW50LnN0eWxlLm9wYWNpdHk9XCIwXCIpKX1fY3JlYXRlRWxlbWVudHMoZSl7Y29uc3QgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHtiYWNrZ3JvdW5kOmk9XCJyZ2JhKDAsIDAsIDAsIDAuOClcIixpZDpuPVwiY2hlY2tvdXRPdmVybGF5XCIsdHJhbnNpdGlvbkR1cmF0aW9uOnI9NDAwLGhhc0Nsb3NlQnV0dG9uOm89ITEsaW5uZXJIdG1sOmE9bnVsbH09ZXx8e307bGV0IHMsZCxsLGMsdT10O2lmKG4mJih0LmlkPW4pLGEpe2NvbnN0IGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtjPWAke259LS1vdmVybGF5VGV4dGAsZS5jbGFzc05hbWU9YyxlLmFwcGVuZENoaWxkKGEpLHQuYXBwZW5kQ2hpbGQoZSl9cmV0dXJuIG8mJihsPWAke259LS1jbG9zZWAscz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHMuY2xhc3NOYW1lPWwsZD1gJHtufS0tbGF5b3V0YCx1PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksdS5jbGFzc05hbWU9ZCx1LmFwcGVuZENoaWxkKHQpLHUuYXBwZW5kQ2hpbGQocykpLHUuYXBwZW5kQ2hpbGQoZnVuY3Rpb24oZSl7Y29uc3R7aWQ6dCxiYWNrZ3JvdW5kOmksdHJhbnNpdGlvbkR1cmF0aW9uOm4sY2xhc3NMYXlvdXQ6cixjbGFzc092ZXJsYXlUZXh0Om8sY2xhc3NDbG9zZTphfT1lLHM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpLGQ9cj9gLCAuJHtyfWA6XCJcIjtyZXR1cm4gcy5pZD1gJHt0fS0tc3R5bGVzYCxzLnR5cGU9XCJ0ZXh0L2Nzc1wiLHMuaW5uZXJUZXh0PWBcXG4gICAgICAgICMke3R9JHtkfSB7XFxuICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XFxuICAgICAgICAgICAgaGVpZ2h0OiAxMDAlO1xcbiAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xcbiAgICAgICAgICAgIGxlZnQ6IDA7XFxuICAgICAgICAgICAgdG9wOiAwO1xcbiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcXG4gICAgICAgICAgICB6LWluZGV4OiAyMTQ3NDgzNjQ3O1xcbiAgICAgICAgfVxcbiAgICAgICAgIyR7dH0ge1xcbiAgICAgICAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgJHtufW1zIGVhc2Utb3V0O1xcbiAgICAgICAgICAgIGJhY2tncm91bmQ6ICR7aX07XFxuICAgICAgICAgICAgb3BhY2l0eTogMDtcXG4gICAgICAgIH1cXG4gICAgYCxvJiYocy5pbm5lclRleHQrPWBcXG4gICAgICAgICAgICAgIyR7dH0ge1xcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xcbiAgICAgICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xcbiAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcXG4gICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAjJHt0fSAuJHtvfSB7XFxuICAgICAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTtcXG4gICAgICAgICAgICAgICAgbWF4LXdpZHRoOiAzMzBweDtcXG4gICAgICAgICAgICAgICAgZm9udC1zaXplOiAxLjJlbTtcXG4gICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xcbiAgICAgICAgICAgICB9XFxuICAgICAgICBgKSxhJiYocy5pbm5lclRleHQrPWBcXG4gICAgICAgICAgICAjJHt0fSB7XFxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIC4ke3J9IC4ke2F9IHtcXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkO1xcbiAgICAgICAgICAgICAgICByaWdodDogMTZweDtcXG4gICAgICAgICAgICAgICAgdG9wOiAxNnB4O1xcbiAgICAgICAgICAgICAgICB3aWR0aDogMTZweDtcXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAxNnB4O1xcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwLjY7XFxuICAgICAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcXG4gICAgICAgICAgICAgICAgei1pbmRleDogMzE0NzQ4MzY0NztcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgLiR7cn0gLiR7YX06OmFmdGVyLCAuJHtyfSAuJHthfTo6YmVmb3JlIHtcXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgICAgICAgICAgICAgICBsZWZ0OiA4cHg7XFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnO1xcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDE2cHg7XFxuICAgICAgICAgICAgICAgIHdpZHRoOiAycHg7XFxuICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIC4ke3J9IC4ke2F9OjphZnRlciB7XFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKC00NWRlZyk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIC4ke3J9IC4ke2F9OjpiZWZvcmUge1xcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZSg0NWRlZyk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgYCksc30oe2lkOm4sYmFja2dyb3VuZDppLHRyYW5zaXRpb25EdXJhdGlvbjpyLGNsYXNzTGF5b3V0OmQsY2xhc3NPdmVybGF5VGV4dDpjLGNsYXNzQ2xvc2U6bH0pKSx7ZWxlbWVudDp0LGNsb3NlRWxlbWVudDpzLG1haW5FbGVtZW50OnV9fV9hZGRFdmVudExpc3RlbmVyKGUsdCl7ZSYmdCYmZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIix0KX1fcmVtb3ZlRXZlbnRMaXN0ZW5lcihlLHQpe2UmJnQmJmUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsdCl9X3JlZ2lzdGVyQ2xpY2soZSl7aWYodGhpcy5fdW5yZWdpc3RlckNsaWNrJiZ0aGlzLl91bnJlZ2lzdGVyQ2xpY2soKSxlKXtjb25zdHtvbkNsaWNrOnQsb25DbGlja0Nsb3NlOml9PWU7dGhpcy5fYWRkRXZlbnRMaXN0ZW5lcih0aGlzLl9lbGVtZW50LHQpLHRoaXMuX2FkZEV2ZW50TGlzdGVuZXIodGhpcy5fY2xvc2VFbGVtZW50LGkpLHRoaXMuX3VucmVnaXN0ZXJDbGljaz0oKT0+e3RoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5fZWxlbWVudCx0KSx0aGlzLl9yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuX2Nsb3NlRWxlbWVudCxpKSx0aGlzLl91bnJlZ2lzdGVyQ2xpY2s9dm9pZCAwfX19X3JlbW92ZUFmdGVyVHJhbnNpdGlvbigpe2NvbnN0IGU9dD0+e1wib3BhY2l0eVwiPT09dC5wcm9wZXJ0eU5hbWUmJih0aGlzLl9tYWluRWxlbWVudC5wYXJlbnRFbGVtZW50JiZ0aGlzLl9tYWluRWxlbWVudC5yZW1vdmUoKSx0aGlzLl9lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsZSkpfTt0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsZSl9fWNvbnN0IHVlPXtzaXplOjcwLGNvbG9yOlwiI2Q5ZDlkOVwiLGJhY2tncm91bmRDb2xvcjpcIiNmZmZmZmZcIn0saGU9XCJlbWJlZGRlZC1jaGVja291dC1sb2FkaW5nLWluZGljYXRvci1yb3RhdGlvblwiO2NsYXNzIHlle2NvbnN0cnVjdG9yKGUpe3RoaXMuc3R5bGVzPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx1ZSksZSYmZS5zdHlsZXMpLHRoaXMuY29udGFpbmVyU3R5bGVzPU9iamVjdC5hc3NpZ24oe30sZSYmZS5jb250YWluZXJTdHlsZXMpLHRoaXMuZGVmaW5lQW5pbWF0aW9uKCksdGhpcy5jb250YWluZXI9dGhpcy5idWlsZENvbnRhaW5lcigpLHRoaXMuaW5kaWNhdG9yPXRoaXMuYnVpbGRJbmRpY2F0b3IoKSx0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmluZGljYXRvcil9c2hvdyhlKXtpZihlKXtjb25zdCB0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGUpO2lmKCF0KXRocm93IG5ldyBFcnJvcihcIlVuYWJsZSB0byBhdHRhY2ggdGhlIGxvYWRpbmcgaW5kaWNhdG9yIGJlY2F1c2UgdGhlIHBhcmVudCBJRCBpcyBub3QgdmFsaWQuXCIpO3QuYXBwZW5kQ2hpbGQodGhpcy5jb250YWluZXIpfXRoaXMuY29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHk9XCJ2aXNpYmxlXCIsdGhpcy5jb250YWluZXIuc3R5bGUub3BhY2l0eT1cIjFcIn1oaWRlKCl7Y29uc3QgZT0oKT0+e3RoaXMuY29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHk9XCJoaWRkZW5cIix0aGlzLmNvbnRhaW5lci5yZW1vdmVFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLGUpfTt0aGlzLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLGUpLHRoaXMuY29udGFpbmVyLnN0eWxlLm9wYWNpdHk9XCIwXCJ9YnVpbGRDb250YWluZXIoKXtjb25zdCBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7cmV0dXJuIGUuc3R5bGUuZGlzcGxheT1cImJsb2NrXCIsZS5zdHlsZS5ib3R0b209XCIwXCIsZS5zdHlsZS5sZWZ0PVwiMFwiLGUuc3R5bGUuaGVpZ2h0PVwiMTAwJVwiLGUuc3R5bGUud2lkdGg9XCIxMDAlXCIsZS5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCIsZS5zdHlsZS5yaWdodD1cIjBcIixlLnN0eWxlLnRvcD1cIjBcIixlLnN0eWxlLnRyYW5zaXRpb249XCJhbGwgMjUwbXMgZWFzZS1vdXRcIixlLnN0eWxlLm9wYWNpdHk9XCIwXCIsdGhpcy5zZXRTdHlsZUF0dHJpYnV0ZShlLHRoaXMuY29udGFpbmVyU3R5bGVzKSxlfWJ1aWxkSW5kaWNhdG9yKCl7Y29uc3QgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3JldHVybiBlLnN0eWxlLmRpc3BsYXk9XCJibG9ja1wiLGUuc3R5bGUud2lkdGg9YCR7dGhpcy5zdHlsZXMuc2l6ZX1weGAsZS5zdHlsZS5oZWlnaHQ9YCR7dGhpcy5zdHlsZXMuc2l6ZX1weGAsZS5zdHlsZS5ib3JkZXJSYWRpdXM9YCR7dGhpcy5zdHlsZXMuc2l6ZX1weGAsZS5zdHlsZS5ib3JkZXI9XCJzb2xpZCAxcHhcIixlLnN0eWxlLmJvcmRlckNvbG9yPWAke3RoaXMuc3R5bGVzLmJhY2tncm91bmRDb2xvcn0gJHt0aGlzLnN0eWxlcy5iYWNrZ3JvdW5kQ29sb3J9ICR7dGhpcy5zdHlsZXMuY29sb3J9ICR7dGhpcy5zdHlsZXMuY29sb3J9YCxlLnN0eWxlLm1hcmdpbj1cIjAgYXV0b1wiLGUuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiLGUuc3R5bGUubGVmdD1cIjBcIixlLnN0eWxlLnJpZ2h0PVwiMFwiLGUuc3R5bGUudG9wPVwiNTAlXCIsZS5zdHlsZS50cmFuc2Zvcm09XCJ0cmFuc2xhdGVZKC01MCUpIHJvdGF0ZSgwZGVnKVwiLGUuc3R5bGUudHJhbnNmb3JtU3R5bGU9XCJwcmVzZXJ2ZS0zZFwiLGUuc3R5bGUuYW5pbWF0aW9uPWAke2hlfSA1MDBtcyBpbmZpbml0ZSBjdWJpYy1iZXppZXIoMC42OSwgMC4zMSwgMC41NiwgMC44MylgLGV9c2V0U3R5bGVBdHRyaWJ1dGUoZSx0KXtPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGk9PntlLnN0eWxlLnNldFByb3BlcnR5KGksdFtpXSl9KX1kZWZpbmVBbmltYXRpb24oKXt2YXIgZTtpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChoZSkpcmV0dXJuO2NvbnN0IHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO3QuaWQ9aGUsbnVsbD09PShlPWRvY3VtZW50LmhlYWQpfHx2b2lkIDA9PT1lfHxlLmFwcGVuZENoaWxkKHQpLHQuc2hlZXQgaW5zdGFuY2VvZiBDU1NTdHlsZVNoZWV0JiZ0LnNoZWV0Lmluc2VydFJ1bGUoYFxcbiAgICAgICAgICAgICAgICBAa2V5ZnJhbWVzICR7aGV9IHtcXG4gICAgICAgICAgICAgICAgICAgIDAlIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpIHJvdGF0ZSgwZGVnKTsgfVxcbiAgICAgICAgICAgICAgICAgICAgMTAwJSB7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKSByb3RhdGUoMzYwZGVnKTsgfVxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgYCwwKX19Y29uc3QgbWU9e1wiYmFja2dyb3VuZC1jb2xvclwiOlwicmdiYSgwLCAwLCAwLCAwLjQpXCIsXCJ6LWluZGV4XCI6XCIxMDAwXCJ9O2Z1bmN0aW9uIHBlKGUpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmXCJuYW1lXCJpbiBlJiZcIkJyYWludHJlZUVycm9yXCI9PT1lLm5hbWV9ZnVuY3Rpb24gZ2UoZSl7cmV0dXJue3JlY2lwaWVudE5hbWU6YCR7ZS5maXJzdE5hbWV9ICR7ZS5sYXN0TmFtZX1gLGxpbmUxOmUuYWRkcmVzczEsbGluZTI6ZS5hZGRyZXNzMixjaXR5OmUuY2l0eSxzdGF0ZTplLnN0YXRlT3JQcm92aW5jZUNvZGUscG9zdGFsQ29kZTplLnBvc3RhbENvZGUsY291bnRyeUNvZGU6ZS5jb3VudHJ5Q29kZSxwaG9uZTplLnBob25lfX12YXIgdmU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgZmV7Y29uc3RydWN0b3IoZSx0LGksbil7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2U9dCx0aGlzLmJyYWludHJlZU1lc3NhZ2VzPWksdGhpcy5sb2FkaW5nSW5kaWNhdG9yPW4sdGhpcy5icmFpbnRyZWVIb3N0V2luZG93PXdpbmRvd31pbml0aWFsaXplKGUpe3JldHVybiB2ZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7YnJhaW50cmVlOnQsbWV0aG9kSWQ6aX09ZTtpZih0aGlzLmJyYWludHJlZT10LHRoaXMucGF5bWVudE1ldGhvZCYmdGhpcy5wYXltZW50TWV0aG9kLm5vbmNlfHwodGhpcy5wYXltZW50TWV0aG9kPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KGkpKSx0aGlzLnBheW1lbnRNZXRob2QuY2xpZW50VG9rZW4mJihudWxsPT10P3ZvaWQgMDp0LmJhbm5lckNvbnRhaW5lcklkKSlyZXR1cm4geWllbGQgdGhpcy5sb2FkUGF5cGFsKCksdGhpcy5sb2FkUGF5cGFsQ2hlY2tvdXRJbnN0YW5jZSgpO2lmKHRoaXMucGF5bWVudE1ldGhvZC5jbGllbnRUb2tlbilyZXR1cm4gdGhpcy5sb2FkUGF5cGFsKCk7Y29uc3Qgbj15aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSk7aWYodGhpcy5wYXltZW50TWV0aG9kPW4uZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSksbnVsbD09dD92b2lkIDA6dC5iYW5uZXJDb250YWluZXJJZClyZXR1cm4gdGhpcy5sb2FkUGF5cGFsQ2hlY2tvdXRJbnN0YW5jZSgpO2lmKCF0aGlzLnBheW1lbnRNZXRob2QuY2xpZW50VG9rZW4pdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudE1ldGhvZCk7cmV0dXJuIHRoaXMubG9hZFBheXBhbCgpfSl9ZXhlY3V0ZShlLHQpe3ZhciBpO3JldHVybiB2ZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cGF5bWVudDpufT1lLHI9ZnVuY3Rpb24oZSx0KXt2YXIgaT17fTtmb3IodmFyIG4gaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxuKSYmdC5pbmRleE9mKG4pPDAmJihpW25dPWVbbl0pO2lmKG51bGwhPWUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPTA7Zm9yKG49T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtyPG4ubGVuZ3RoO3IrKyl0LmluZGV4T2YobltyXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsbltyXSkmJihpW25bcl1dPWVbbltyXV0pfXJldHVybiBpfShlLFtcInBheW1lbnRcIl0pLHtvbkVycm9yOm99PXRoaXMuYnJhaW50cmVlfHx7fTtpZighbil0aHJvdyBuZXcgUihbXCJwYXltZW50XCJdKTt0cnl7Y29uc3QgZT15aWVsZCB0aGlzLnByZXBhcmVQYXltZW50RGF0YShuLHIudXNlU3RvcmVDcmVkaXQpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihyLHQpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGUpfWNhdGNoKGUpe3RoaXMuaXNQcm92aWRlckVycm9yKGUpJiYoeWllbGQgdGhpcy5sb2FkUGF5cGFsKCksbnVsbD09PShpPXRoaXMucGF5cGFsQnV0dG9uUmVuZGVyKXx8dm9pZCAwPT09aXx8aS5jbG9zZSgpLHlpZWxkIHRoaXMubG9hZFBheXBhbENoZWNrb3V0SW5zdGFuY2UoKSx5aWVsZCBuZXcgUHJvbWlzZSgoZSx0KT0+e28mJlwiZnVuY3Rpb25cIj09dHlwZW9mIG8mJm8obmV3IEVycm9yKFwiSU5TVFJVTUVOVF9ERUNMSU5FRFwiKSksdCgpfSkpLHRoaXMuaGFuZGxlRXJyb3IoZSl9fSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFcpfWRlaW5pdGlhbGl6ZSgpe3ZhciBlO3JldHVybiB0aGlzLmJyYWludHJlZVRva2VuaXplUGF5bG9hZD12b2lkIDAsbnVsbD09PShlPXRoaXMucGF5cGFsQnV0dG9uUmVuZGVyKXx8dm9pZCAwPT09ZXx8ZS5jbG9zZSgpLHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRlYXJkb3duKCl9cHJlcGFyZVBheW1lbnREYXRhKGUsdCl7dmFyIGk7cmV0dXJuIHZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHI9bi5nZXRPdXRzdGFuZGluZ0JhbGFuY2UodCksbz1uLmdldFN0b3JlQ29uZmlnKCk7aWYoIXIpdGhyb3cgbmV3IFUoai5NaXNzaW5nQ2hlY2tvdXQpO2lmKCFvKXRocm93IG5ldyBVKGouTWlzc2luZ0NoZWNrb3V0Q29uZmlnKTtpZighdGhpcy5wYXltZW50TWV0aG9kKXRocm93IG5ldyBNKEMuUGF5bWVudE5vdEluaXRpYWxpemVkKTtjb25zdHtjdXJyZW5jeTphLHN0b3JlUHJvZmlsZTp7c3RvcmVMYW5ndWFnZTpzfX09byx7bm9uY2U6ZCxjb25maWc6e2lzVmF1bHRpbmdFbmFibGVkOmx9fT10aGlzLnBheW1lbnRNZXRob2Qse21ldGhvZElkOmMscGF5bWVudERhdGE6dT17fX09ZSxoPShudWxsPT09KGk9dGhpcy5icmFpbnRyZWVUb2tlbml6ZVBheWxvYWQpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLm5vbmNlKXx8ZDtpZihoKXtjb25zdCB0PXlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChjKTtyZXR1cm4gdGhpcy5wYXltZW50TWV0aG9kPXQuZ2V0UGF5bWVudE1ldGhvZChjKSxPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3BheW1lbnREYXRhOnRoaXMuZm9ybWF0dGVkUGF5bG9hZChoKX0pfWlmKEgodSl8fCh5PXUsQm9vbGVhbih5Lmluc3RydW1lbnRJZCkmJiFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoeSxcImNjTnVtYmVyXCIpJiYhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHksXCJjY0N2dlwiKSkpe2lmKCFsKXRocm93IG5ldyBWKFwiVmF1bHRpbmcgaXMgZGlzYWJsZWQgYnV0IGEgdmF1bHRlZCBpbnN0cnVtZW50IHdhcyBiZWluZyB1c2VkIGZvciB0aGlzIHRyYW5zYWN0aW9uXCIpO3JldHVybiBQcm9taXNlLnJlc29sdmUoZSl9dmFyIHk7aWYoIXEodSkpdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudCk7Y29uc3R7c2hvdWxkU2F2ZUluc3RydW1lbnQ6bSxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OnB9PXU7aWYobSYmIWwpdGhyb3cgbmV3IFYoXCJWYXVsdGluZyBpcyBkaXNhYmxlZCBidXQgc2hvdWxkU2F2ZUluc3RydW1lbnQgaXMgc2V0IHRvIHRydWVcIik7Y29uc3QgZz1uLmdldFNoaXBwaW5nQWRkcmVzcygpLHY9Zz9nZShnKTp2b2lkIDA7cmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5wYXlwYWwoe2Ftb3VudDpyLGxvY2FsZTpzLGN1cnJlbmN5OmEuY29kZSxvZmZlckNyZWRpdDpcImJyYWludHJlZXBheXBhbGNyZWRpdFwiPT09dGhpcy5wYXltZW50TWV0aG9kLmlkLHNoaXBwaW5nQWRkcmVzc092ZXJyaWRlOnYsc2hvdWxkU2F2ZUluc3RydW1lbnQ6bXx8ITEsc2hpcHBpbmdBZGRyZXNzRWRpdGFibGU6ITF9KSx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRTZXNzaW9uSWQoKV0pLnRoZW4oKFt7bm9uY2U6dCxkZXRhaWxzOml9PXt9LG5dKT0+T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHtwYXltZW50RGF0YTp0aGlzLmZvcm1hdHRlZFBheWxvYWQodCxpJiZpLmVtYWlsLG4sbSxwKX0pKX0pfWZvcm1hdHRlZFBheWxvYWQoZSx0LGksbixyKXtyZXR1cm57Zm9ybWF0dGVkUGF5bG9hZDp7dmF1bHRfcGF5bWVudF9pbnN0cnVtZW50Om58fG51bGwsc2V0X2FzX2RlZmF1bHRfc3RvcmVkX2luc3RydW1lbnQ6cnx8bnVsbCxkZXZpY2VfaW5mbzppfHxudWxsLHBheXBhbF9hY2NvdW50Ont0b2tlbjplLGVtYWlsOnR8fG51bGx9fX19bG9hZFBheXBhbENoZWNrb3V0SW5zdGFuY2UoKXtyZXR1cm4gdmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2NsaWVudFRva2VuOmUsaW5pdGlhbGl6YXRpb25EYXRhOnQsaWQ6aX09dGhpcy5wYXltZW50TWV0aG9kfHx7fTtpZighZSl0aHJvdyBuZXcgVShqLk1pc3NpbmdQYXltZW50TWV0aG9kKTt0cnl7dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuaW5pdGlhbGl6ZShlKTtjb25zdCBuPXtjdXJyZW5jeTp0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGUsaW50ZW50Om51bGw9PXQ/dm9pZCAwOnQuaW50ZW50LGlzQ3JlZGl0RW5hYmxlZDpudWxsPT10P3ZvaWQgMDp0LmlzQ3JlZGl0RW5hYmxlZH0scj1cImJyYWludHJlZXBheXBhbGNyZWRpdFwiPT09aXx8IShudWxsPT10P3ZvaWQgMDp0LmlzQ3JlZGl0RW5hYmxlZCk7eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5cGFsQ2hlY2tvdXQobixlPT57dmFyIHQ7ciYmaSYmKG51bGw9PT0odD10aGlzLmJyYWludHJlZSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuYmFubmVyQ29udGFpbmVySWQpJiZ0aGlzLnJlbmRlclBheVBhbE1lc3NhZ2VzKGksdGhpcy5icmFpbnRyZWUuYmFubmVyQ29udGFpbmVySWQpLHRoaXMucmVuZGVyUGF5UGFsQnV0dG9uKGUpfSx0aGlzLmhhbmRsZUVycm9yKX1jYXRjaChlKXt0aGlzLmhhbmRsZUVycm9yKGUpfX0pfXJlbmRlclBheVBhbE1lc3NhZ2VzKGUsdCl7dGhpcy5icmFpbnRyZWVNZXNzYWdlcy5yZW5kZXIoZSx0LGFlLlBBWU1FTlQpfXJlbmRlclBheVBhbEJ1dHRvbihlKXtjb25zdHtvblBheW1lbnRFcnJvcjp0LHN1Ym1pdEZvcm06aSxvblJlbmRlckJ1dHRvbjpuLGNvbnRhaW5lcklkOnIsb25FcnJvcjpvfT10aGlzLmJyYWludHJlZXx8e307aWYoIXIpcmV0dXJuO2lmKCF0aGlzLnBheW1lbnRNZXRob2QpdGhyb3cgbmV3IE0oQy5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO3RoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj1yLnNwbGl0KFwiI1wiKVsxXTtjb25zdHtpZDphLGNvbmZpZzp7dGVzdE1vZGU6c319PXRoaXMucGF5bWVudE1ldGhvZCx7cGF5cGFsOmR9PXRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdyxsPW51bGw9PWQ/dm9pZCAwOmQuRlVORElORy5QQVlQQUw7ZCYmbD8odGhpcy5wYXlwYWxCdXR0b25SZW5kZXI9ZC5CdXR0b25zKHtlbnY6cz9cInNhbmRib3hcIjpcInByb2R1Y3Rpb25cIixjb21taXQ6ITEsZnVuZGluZ1NvdXJjZTpsLG9uQ2xpY2s6KCk9Pnt0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITApfSxjcmVhdGVPcmRlcjooKT0+dGhpcy5zZXR1cFBheW1lbnQoZSxhLHQpLG9uQXBwcm92ZTp0PT52ZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dGhpcy5icmFpbnRyZWVUb2tlbml6ZVBheWxvYWQ9eWllbGQgdGhpcy50b2tlbml6ZVBheW1lbnRPclRocm93KHQsZSksaSYmXCJmdW5jdGlvblwiPT10eXBlb2YgaSYmaSgpfSksb25DYW5jZWw6KCk9Pnt0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpfSxvbkVycm9yOmU9Pnt0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLG51bGw9PW98fG8oZSl9fSksbiYmXCJmdW5jdGlvblwiPT10eXBlb2YgbiYmbigpLHRoaXMucGF5cGFsQnV0dG9uUmVuZGVyLmlzRWxpZ2libGUoKSYmdGhpcy5wYXlwYWxCdXR0b25SZW5kZXIucmVuZGVyKGAke3J9YCkpOnRoaXMucmVtb3ZlRWxlbWVudChyLnNwbGl0KFwiI1wiKVsxXSl9c2V0dXBQYXltZW50KGUsdCxpKXtyZXR1cm4gdmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCk7dHJ5e2NvbnN0IGk9bi5nZXRDdXN0b21lcigpLHI9bi5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyh0KSxvPW4uZ2V0Q2hlY2tvdXRPclRocm93KCkub3V0c3RhbmRpbmdCYWxhbmNlLGE9bi5nZXRTdG9yZUNvbmZpZ09yVGhyb3coKS5jdXJyZW5jeS5jb2RlLHM9bi5nZXRTaGlwcGluZ0FkZHJlc3MoKXx8KG51bGw9PWk/dm9pZCAwOmkuYWRkcmVzc2VzWzBdKSxkPXM/Z2Uocyk6dm9pZCAwO3JldHVybiB5aWVsZCBlLmNyZWF0ZVBheW1lbnQoe2Zsb3c6XCJjaGVja291dFwiLGVuYWJsZVNoaXBwaW5nQWRkcmVzczohMCxzaGlwcGluZ0FkZHJlc3NFZGl0YWJsZTohMSxzaGlwcGluZ0FkZHJlc3NPdmVycmlkZTpkLGFtb3VudDpvLGN1cnJlbmN5OmEsb2ZmZXJDcmVkaXQ6ITEsaW50ZW50OnIuaW5pdGlhbGl6YXRpb25EYXRhLmludGVudH0pfWNhdGNoKGUpe3Rocm93IGkmJihwZShlKXx8ZSBpbnN0YW5jZW9mIHApJiZpKGUpLGV9fSl9dG9rZW5pemVQYXltZW50T3JUaHJvdyhlLHQsaSl7cmV0dXJuIHZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7cmV0dXJuIHlpZWxkIHQudG9rZW5pemVQYXltZW50KGUpfWNhdGNoKGUpe3Rocm93IGkmJihwZShlKXx8ZSBpbnN0YW5jZW9mIHApJiZpKGUpLGV9fSl9bG9hZFBheXBhbCgpe3JldHVybiB2ZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7Y2xpZW50VG9rZW46ZSxpbml0aWFsaXphdGlvbkRhdGE6dH09dGhpcy5wYXltZW50TWV0aG9kfHx7fTtpZighZXx8IXQpdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudE1ldGhvZCk7dHJ5e3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmluaXRpYWxpemUoZSkseWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5cGFsKCl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX1yZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9KX1oYW5kbGVFcnJvcihlKXtpZighcGUoZSkpdGhyb3cgZTtpZihcIlBBWVBBTF9QT1BVUF9DTE9TRURcIj09PWUuY29kZSl0aHJvdyBuZXcgUShlLm1lc3NhZ2UpO3Rocm93IG5ldyAkKGUubWVzc2FnZSl9aXNQcm92aWRlckVycm9yKGUpe3ZhciB0LGksbjtyZXR1cm4hIWZ1bmN0aW9uKGUpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmXCJlcnJvcnNcImluIGV9KGUpJiZcIjIwNDZcIj09PShudWxsPT09KG49bnVsbD09PShpPSgobnVsbD09PSh0PW51bGw9PWU/dm9pZCAwOmUuZXJyb3JzKXx8dm9pZCAwPT09dD92b2lkIDA6dC5maWx0ZXIoZT0+ZS5wcm92aWRlcl9lcnJvcikpfHxbXSlbMF0pfHx2b2lkIDA9PT1pP3ZvaWQgMDppLnByb3ZpZGVyX2Vycm9yKXx8dm9pZCAwPT09bj92b2lkIDA6bi5jb2RlKX1yZW1vdmVFbGVtZW50KGUpe2NvbnN0IHQ9ZSYmZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSk7dCYmdC5yZW1vdmUoKX10b2dnbGVMb2FkaW5nSW5kaWNhdG9yKGUpe2UmJnRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj90aGlzLmxvYWRpbmdJbmRpY2F0b3Iuc2hvdyh0aGlzLmxvYWRpbmdJbmRpY2F0b3JDb250YWluZXIpOnRoaXMubG9hZGluZ0luZGljYXRvci5oaWRlKCl9fWNvbnN0IGJlPUwodD0+e2NvbnN0IGk9d2luZG93LG49bmV3IGNlLHI9bmV3IEYodCksbz1uZXcgZGUobmV3IHooZSgpLGksciksaSxuKSxhPW5ldyBsZSh0KTtyZXR1cm4gbmV3IGZlKHQsbyxhLG5ldyB5ZSh7Y29udGFpbmVyU3R5bGVzOm1lfSkpfSxbe2lkOlwiYnJhaW50cmVlcGF5cGFsXCJ9LHtpZDpcImJyYWludHJlZXBheXBhbGNyZWRpdFwifV0pO3ZhciB3ZTshZnVuY3Rpb24oZSl7ZS5Kc29uPVwiYXBwbGljYXRpb24vanNvblwiLGUuSnNvblYxPVwiYXBwbGljYXRpb24vdm5kLmJjLnYxK2pzb25cIn0od2V8fCh3ZT17fSkpO2NvbnN0IENlPXdlLFNlPXtcIlgtQ2hlY2tvdXQtU0RLLVZlcnNpb25cIjpcIjEuODQxLjBcIn07Y2xhc3MgUGV7Y29uc3RydWN0b3IoZSl7dGhpcy5yZXF1ZXN0U2VuZGVyPWV9Z2V0T3JkZXJTdGF0dXMoZT1cImJyYWludHJlZWxvY2FsbWV0aG9kc1wiLHQpe3JldHVybiBpPXRoaXMsbj12b2lkIDAsbz1mdW5jdGlvbiooKXtjb25zdCBpPWAvYXBpL3N0b3JlZnJvbnQvaW5pdGlhbGl6YXRpb24vJHtlfWAsbj1PYmplY3QuYXNzaWduKHtcIlgtQVBJLUlOVEVSTkFMXCI6XCJUaGlzIEFQSSBlbmRwb2ludCBpcyBmb3IgaW50ZXJuYWwgdXNlIG9ubHkgYW5kIG1heSBjaGFuZ2UgaW4gdGhlIGZ1dHVyZVwiLFwiQ29udGVudC1UeXBlXCI6Q2UuSnNvbn0sU2UpO3JldHVybih5aWVsZCB0aGlzLnJlcXVlc3RTZW5kZXIuZ2V0KGksT2JqZWN0LmFzc2lnbih7aGVhZGVyczpufSx0KSkpLmJvZHl9LG5ldygocj12b2lkIDApfHwocj1Qcm9taXNlKSkoZnVuY3Rpb24oZSx0KXtmdW5jdGlvbiBhKGUpe3RyeXtkKG8ubmV4dChlKSl9Y2F0Y2goZSl7dChlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChvLnRocm93KGUpKX1jYXRjaChlKXt0KGUpfX1mdW5jdGlvbiBkKHQpe3ZhciBpO3QuZG9uZT9lKHQudmFsdWUpOihpPXQudmFsdWUsaSBpbnN0YW5jZW9mIHI/aTpuZXcgcihmdW5jdGlvbihlKXtlKGkpfSkpLnRoZW4oYSxzKX1kKChvPW8uYXBwbHkoaSxufHxbXSkpLm5leHQoKSl9KTt2YXIgaSxuLHIsb319Y29uc3QgSWU9e2JvZHk6e30saGVhZGVyczp7fSxzdGF0dXM6MH07Y2xhc3MgT2UgZXh0ZW5kcyBwe2NvbnN0cnVjdG9yKGUse21lc3NhZ2U6dCxlcnJvcnM6aX09e30pe2NvbnN0e2JvZHk6bixoZWFkZXJzOnIsc3RhdHVzOm99PWV8fEllO3N1cGVyKHR8fFwiQW4gdW5leHBlY3RlZCBlcnJvciBoYXMgb2NjdXJyZWQuXCIpLHRoaXMubmFtZT1cIlJlcXVlc3RFcnJvclwiLHRoaXMudHlwZT1cInJlcXVlc3RcIix0aGlzLmJvZHk9bix0aGlzLmhlYWRlcnM9cix0aGlzLnN0YXR1cz1vLHRoaXMuZXJyb3JzPWl8fFtdfX1jbGFzcyBrZSBleHRlbmRzIE9le2NvbnN0cnVjdG9yKGUpe3N1cGVyKGUse21lc3NhZ2U6XCJUaGVyZSBpcyBhIHByb2JsZW0gcHJvY2Vzc2luZyB5b3VyIHBheW1lbnQuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCJ9KSx0aGlzLm5hbWU9XCJQYXltZW50TWV0aG9kSW52YWxpZEVycm9yXCIsdGhpcy50eXBlPVwicGF5bWVudF9tZXRob2RfaW52YWxpZFwifX1jbGFzcyBFZSBleHRlbmRzIE9le2NvbnN0cnVjdG9yKGUpe3N1cGVyKGUse21lc3NhZ2U6XCJUaGUgcmVxdWVzdCBoYXMgdGltZWQgb3V0IG9yIGFib3J0ZWQuXCJ9KSx0aGlzLm5hbWU9XCJUaW1lb3V0RXJyb3JcIix0aGlzLnR5cGU9XCJ0aW1lb3V0XCJ9fXZhciBUZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBBZXtjb25zdHJ1Y3RvcihlLHQsaSxuLHI9M2UzLGE9M2U1KXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJyYWludHJlZVNkaz10LHRoaXMuYnJhaW50cmVlUmVxdWVzdFNlbmRlcj1pLHRoaXMubG9hZGluZ0luZGljYXRvcj1uLHRoaXMucG9sbGluZ0ludGVydmFsPXIsdGhpcy5tYXhQb2xsaW5nSW50ZXJ2YWxUaW1lPWEsdGhpcy5pc0xQTXNVcGRhdGVFeHBlcmltZW50RW5hYmxlZD0hMSx0aGlzLnBvbGxpbmdUaW1lcj0wLHRoaXMuc3RvcFBvbGxpbmc9byx0aGlzLmlzUG9sbGluZ0VuYWJsZWQ9ITF9aW5pdGlhbGl6ZShlKXtyZXR1cm4gVGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2dhdGV3YXlJZDp0LG1ldGhvZElkOmksYnJhaW50cmVlbG9jYWxtZXRob2RzOm59PWU7aWYodGhpcy5nYXRld2F5SWQ9dCwhaSl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdCl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5nYXRld2F5SWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIW4pdGhyb3cgbmV3IFYoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVlbG9jYWxtZXRob2RzXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3RoaXMuYnJhaW50cmVlbG9jYWxtZXRob2RzPW4sdGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyPW4uY29udGFpbmVyLnNwbGl0KFwiI1wiKVsxXSx5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QodCk7Y29uc3Qgcj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxvPXIuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCkse2NsaWVudFRva2VuOmEsY29uZmlnOnMsaW5pdGlhbGl6YXRpb25EYXRhOmR9PW8sbD1yLmdldFN0b3JlQ29uZmlnT3JUaHJvdygpLmNoZWNrb3V0U2V0dGluZ3MuZmVhdHVyZXM7aWYodGhpcy5pc1BvbGxpbmdFbmFibGVkPXgobCxcIlBBWVBBTC01MjU4LmJyYWludHJlZV9sb2NhbF9tZXRob2RzX3BvbGxpbmdcIiksdGhpcy5pc0xQTXNVcGRhdGVFeHBlcmltZW50RW5hYmxlZD14KGwsXCJQQVlQQUwtNDg1My5hZGRfbmV3X3BheW1lbnRfZmxvd19mb3JfYnJhaW50cmVlX2xwbXNcIiksIWF8fCFkfHwhcy5tZXJjaGFudElkKXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRNZXRob2QpO3RyeXt0aGlzLmJyYWludHJlZVNkay5pbml0aWFsaXplKGEpLHRoaXMuaXNOb25JbnN0YW50UGF5bWVudE1ldGhvZChpKXx8KHRoaXMuYnJhaW50cmVlTG9jYWxQYXltZW50PXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldEJyYWludHJlZUxvY2FsUGF5bWVudChzLm1lcmNoYW50SWQpKX1jYXRjaChlKXt0aGlzLmhhbmRsZUVycm9yKGUpfX0pfWZpbmFsaXplKCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBXKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gVGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLFByb21pc2UucmVzb2x2ZSgpfSl9ZXhlY3V0ZShlLHQpe3JldHVybiBUZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cGF5bWVudDppfT1lLG49ZnVuY3Rpb24oZSx0KXt2YXIgaT17fTtmb3IodmFyIG4gaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxuKSYmdC5pbmRleE9mKG4pPDAmJihpW25dPWVbbl0pO2lmKG51bGwhPWUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPTA7Zm9yKG49T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtyPG4ubGVuZ3RoO3IrKyl0LmluZGV4T2YobltyXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsbltyXSkmJihpW25bcl1dPWVbbltyXV0pfXJldHVybiBpfShlLFtcInBheW1lbnRcIl0pO2lmKCFpKXRocm93IG5ldyBSKFtcInBheW1lbnRcIl0pO2NvbnN0e21ldGhvZElkOnJ9PWk7dGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCEwKSx0aGlzLmlzTm9uSW5zdGFudFBheW1lbnRNZXRob2Qocik/eWllbGQgdGhpcy5leGVjdXRlV2l0aE5vdEluc3RhbnRMUE0ocik6eWllbGQgdGhpcy5leGVjdXRlV2l0aEluc3RhbnRMUE0ocixuLHQpfSl9ZXhlY3V0ZVdpdGhOb3RJbnN0YW50TFBNKGUpe3JldHVybiBUZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e2NvbnN0IHQ9eWllbGQgdGhpcy5nZXRMUE1zQmFzaWNQYXltZW50RGF0YSgpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcigpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KHttZXRob2RJZDplLHBheW1lbnREYXRhOk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7Zm9ybWF0dGVkUGF5bG9hZDp7bWV0aG9kOmV9fSl9KX1jYXRjaChlKXtpZih0aGlzLmlzQnJhaW50cmVlUmVkaXJlY3RFcnJvcihlKSl7Y29uc3QgdD1lLmJvZHkuYWRkaXRpb25hbF9hY3Rpb25fcmVxdWlyZWQuZGF0YS5yZWRpcmVjdF91cmw7cmV0dXJuIG5ldyBQcm9taXNlKChlLGkpPT57d2luZG93LmxvY2F0aW9uLnJlcGxhY2UodCksdGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKSxpKCl9KX1yZXR1cm4gdGhpcy5oYW5kbGVFcnJvcihlKSxQcm9taXNlLnJlamVjdChlKX19KX1leGVjdXRlV2l0aEluc3RhbnRMUE0oZSx0LGkpe3JldHVybiBUZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuYnJhaW50cmVlTG9jYWxQYXltZW50KXRocm93IG5ldyBrZTt5aWVsZCBuZXcgUHJvbWlzZSgobixyKT0+e3ZhciBvO251bGw9PT0obz10aGlzLmJyYWludHJlZUxvY2FsUGF5bWVudCl8fHZvaWQgMD09PW98fG8uc3RhcnRQYXltZW50KHRoaXMuZ2V0SW5zdGFudExQTUNvbmZpZyhlLHQsaSksdGhpcy5nZXRJbnN0YW50TFBNQ2FsbGJhY2sobixyLGUsdCxpKSl9KX0pfWdldExQTXNCYXNpY1BheW1lbnREYXRhKCl7cmV0dXJuIFRlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtkZXZpY2VEYXRhOmV9PXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldERhdGFDb2xsZWN0b3JPclRocm93KCk7cmV0dXJue2RldmljZVNlc3Npb25JZDplfX0pfWdldEluc3RhbnRMUE1Db25maWcoZSx0LGkpe2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkscj1uLmdldENhcnRPclRocm93KCksbz1uLmdldEJpbGxpbmdBZGRyZXNzT3JUaHJvdygpLHtmaXJzdE5hbWU6YSxsYXN0TmFtZTpzLGNvdW50cnlDb2RlOmR9PW8se2N1cnJlbmN5OmwsZW1haWw6YyxsaW5lSXRlbXM6dX09cixoPXUucGh5c2ljYWxJdGVtcy5sZW5ndGg+MCx5PW4uZ2V0Q2hlY2tvdXRPclRocm93KCkub3V0c3RhbmRpbmdCYWxhbmNlLG09bi5nZXRTdG9yZUNvbmZpZ09yVGhyb3coKS5saW5rcy5jaGVja291dExpbms7cmV0dXJue3BheW1lbnRUeXBlOmUsYW1vdW50OnksZmFsbGJhY2s6e3VybDptLGJ1dHRvblRleHQ6XCJDb21wbGV0ZSBQYXltZW50XCJ9LGN1cnJlbmN5Q29kZTpsLmNvZGUsc2hpcHBpbmdBZGRyZXNzUmVxdWlyZWQ6aCxlbWFpbDpjLGdpdmVuTmFtZTphLHN1cm5hbWU6cyxhZGRyZXNzOntjb3VudHJ5Q29kZTpkfSxvblBheW1lbnRTdGFydDoobixyKT0+VGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLmlzTFBNc1VwZGF0ZUV4cGVyaW1lbnRFbmFibGVkKXJldHVybiB0aGlzLm9yZGVySWQ9bi5wYXltZW50SWQsdm9pZCByKCk7Y29uc3Qgbz15aWVsZCB0aGlzLmdldExQTXNCYXNpY1BheW1lbnREYXRhKCksYT1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sbykse2Zvcm1hdHRlZFBheWxvYWQ6e21ldGhvZDplLFtgJHtlfV9hY2NvdW50YF06e29yZGVyX2lkOm4ucGF5bWVudElkfX19KTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKHQsaSkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoe21ldGhvZElkOmUscGF5bWVudERhdGE6YX0pfWNhdGNoKHQpe2lmKHRoaXMuaXNCcmFpbnRyZWVPcmRlclNhdmVkUmVzcG9uc2UodCkmJnQuYm9keS5hZGRpdGlvbmFsX2FjdGlvbl9yZXF1aXJlZC5kYXRhLm9yZGVyX2lkX3NhdmVkX3N1Y2Nlc3NmdWxseSlyZXR1cm4gcigpLHRoaXMuaXNQb2xsaW5nRW5hYmxlZD9uZXcgUHJvbWlzZSgodCxpKT0+e3RoaXMuaW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oZSx0LGksdGhpcy5nYXRld2F5SWQpfSk6dm9pZCAwO3Rocm93IHR9fSl9fWdldEluc3RhbnRMUE1DYWxsYmFjayhlLHQsaSxuLHIpe2NvbnN0IG89dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKTtyZXR1cm4oYSxzKT0+VGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKGEpcmV0dXJuXCJMT0NBTF9QQVlNRU5UX1dJTkRPV19DTE9TRURcIj09PWEuY29kZT8odGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKSx0aGlzLnJlc2V0UG9sbGluZ01lY2hhbmlzbSgpLHQoKSk6KHRoaXMuaXNQb2xsaW5nRW5hYmxlZCYmdGhpcy5yZXNldFBvbGxpbmdNZWNoYW5pc20oKSx0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLHQobmV3IGtlKSk7Y29uc3QgZD15aWVsZCB0aGlzLmdldExQTXNCYXNpY1BheW1lbnREYXRhKCksbD1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZCkse2Zvcm1hdHRlZFBheWxvYWQ6e21ldGhvZDppLFtgJHtpfV9hY2NvdW50YF06T2JqZWN0LmFzc2lnbih7ZW1haWw6by5lbWFpbCx0b2tlbjpzLm5vbmNlfSx0aGlzLmlzTFBNc1VwZGF0ZUV4cGVyaW1lbnRFbmFibGVkP3t9OntvcmRlcl9pZDp0aGlzLm9yZGVySWR9KX19KTt0cnl7cmV0dXJuIHRoaXMuaXNMUE1zVXBkYXRlRXhwZXJpbWVudEVuYWJsZWR8fCh5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIobixyKSkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoe21ldGhvZElkOmkscGF5bWVudERhdGE6bH0pLGUodm9pZCAwKX1jYXRjaChlKXtyZXR1cm4gdGhpcy5oYW5kbGVFcnJvcihlKSx0KGUpfX0pfXRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoZSl7ZSYmdGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyP3RoaXMubG9hZGluZ0luZGljYXRvci5zaG93KHRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcik6dGhpcy5sb2FkaW5nSW5kaWNhdG9yLmhpZGUoKX1oYW5kbGVFcnJvcihlKXtjb25zdHtvbkVycm9yOnR9PXRoaXMuYnJhaW50cmVlbG9jYWxtZXRob2RzfHx7fTt0aGlzLmlzUG9sbGluZ0VuYWJsZWQmJnRoaXMucmVzZXRQb2xsaW5nTWVjaGFuaXNtKCksdGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKSx0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0JiZ0KGUpfWlzTm9uSW5zdGFudFBheW1lbnRNZXRob2QoZSl7cmV0dXJuIGUudG9VcHBlckNhc2UoKWluIEl9aXNCcmFpbnRyZWVSZWRpcmVjdEVycm9yKGUpe3ZhciB0O2lmKFwib2JqZWN0XCIhPXR5cGVvZiBlfHxudWxsPT09ZSlyZXR1cm4hMTtjb25zdHtib2R5Oml9PWU7cmV0dXJuISFpJiYhIShudWxsPT09KHQ9aS5hZGRpdGlvbmFsX2FjdGlvbl9yZXF1aXJlZCl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuZGF0YS5yZWRpcmVjdF91cmwpfWlzQnJhaW50cmVlT3JkZXJTYXZlZFJlc3BvbnNlKGUpe3ZhciB0O2lmKFwib2JqZWN0XCIhPXR5cGVvZiBlfHxudWxsPT09ZSlyZXR1cm4hMTtjb25zdHtib2R5Oml9PWU7cmV0dXJuISFpJiYobnVsbD09PSh0PWkuYWRkaXRpb25hbF9hY3Rpb25fcmVxdWlyZWQpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmRhdGEuaGFzT3duUHJvcGVydHkoXCJvcmRlcl9pZF9zYXZlZF9zdWNjZXNzZnVsbHlcIikpfWluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKGUsdCxpLG4pe3JldHVybiBUZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgbmV3IFByb21pc2UoKGUsdCk9Pntjb25zdCBpPXNldFRpbWVvdXQoZSx0aGlzLnBvbGxpbmdJbnRlcnZhbCk7dGhpcy5zdG9wUG9sbGluZz0oKT0+KGNsZWFyVGltZW91dChpKSx0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLHQoKSl9KTt0cnl7dGhpcy5wb2xsaW5nVGltZXIrPXRoaXMucG9sbGluZ0ludGVydmFsO2NvbnN0IHI9eWllbGQgdGhpcy5icmFpbnRyZWVSZXF1ZXN0U2VuZGVyLmdldE9yZGVyU3RhdHVzKG4se3BhcmFtczp7dXNlTWV0YWRhdGE6ITF9fSksbz1yLnN0YXR1cz09PVAuUGVuZGluZyxhPXIuc3RhdHVzPT09UC5Db21wbGV0ZWQscz1yLnN0YXR1cz09PVAuRmFpbGVkO2lmKGEpcmV0dXJuIHRoaXMuZGVpbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbSgpLHQoKTtpZihzKXJldHVybiBpKCk7aWYoIWEmJm8mJnRoaXMucG9sbGluZ1RpbWVyPHRoaXMubWF4UG9sbGluZ0ludGVydmFsVGltZSlyZXR1cm4geWllbGQgdGhpcy5pbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbShlLHQsaSxuKTt5aWVsZCB0aGlzLnJlaW5pdGlhbGl6ZVN0cmF0ZWd5KHttZXRob2RJZDplLGdhdGV3YXlJZDpuLGJyYWludHJlZWxvY2FsbWV0aG9kczp0aGlzLmJyYWludHJlZWxvY2FsbWV0aG9kc30pLHRoaXMuaGFuZGxlRXJyb3IobmV3IEVlKX1jYXRjaChlKXtpKCl9fSl9ZGVpbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbSgpe3RoaXMuc3RvcFBvbGxpbmcoKSx0aGlzLnBvbGxpbmdUaW1lcj0wfXJlc2V0UG9sbGluZ01lY2hhbmlzbSgpe3RoaXMuZGVpbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbSgpfXJlaW5pdGlhbGl6ZVN0cmF0ZWd5KGUpe3JldHVybiBUZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5kZWluaXRpYWxpemUoKSx5aWVsZCB0aGlzLmluaXRpYWxpemUoZSl9KX19Y29uc3QgemU9TCh0PT57Y29uc3QgaT13aW5kb3csbj1uZXcgRih0KSxyPW5ldyBCKG5ldyB6KGUoKSxpLG4pKSxvPWMoKSxhPW5ldyBQZShvKTtyZXR1cm4gbmV3IEFlKHQscixhLG5ldyB5ZSh7c3R5bGVzOntiYWNrZ3JvdW5kQ29sb3I6XCJibGFja1wifX0pKX0sW3tnYXRld2F5OlwiYnJhaW50cmVlbG9jYWxtZXRob2RzXCJ9XSk7ZnVuY3Rpb24gTmUoZSl7cmV0dXJuXCJzdHJpbmdcIiE9dHlwZW9mIGV9ZnVuY3Rpb24gTWUoZSx0KXtpZih0fHxlKXJldHVybiBmdW5jdGlvbihlKXt2YXIgdCxpO2NvbnN0IG49e30scj1zKGUucm9vdCxOZSksbz1zKGUuaW5wdXQsTmUpLGE9cyhlLnRvZ2dsZSxOZSksZD1zKG51bGw9PT0odD1lLnRleHQpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmJvZHksTmUpLGw9cyhudWxsPT09KGk9ZS50ZXh0KXx8dm9pZCAwPT09aT92b2lkIDA6aS5jYXB0aW9uLE5lKSxjPWUuYnJhbmRpbmc7cmV0dXJuIE9iamVjdC5rZXlzKHIpLmxlbmd0aCYmKG4ucm9vdD1yKSxPYmplY3Qua2V5cyhvKS5sZW5ndGgmJihuLmlucHV0PW8pLE9iamVjdC5rZXlzKGEpLmxlbmd0aCYmKG4udG9nZ2xlPWEpLE9iamVjdC5rZXlzKGQpLmxlbmd0aCYmKG4udGV4dD17fSxuLnRleHQuYm9keT1kKSxPYmplY3Qua2V5cyhsKS5sZW5ndGgmJihuLnRleHQ9T2JqZWN0LmFzc2lnbih7fSxuLnRleHQpLG4udGV4dC5jYXB0aW9uPWwpLGMmJihuLmJyYW5kaW5nPWMpLG59KGZ1bmN0aW9uKGUsdCl7dmFyIGksbixyLG8sYSxzLGQsbCxjLHUsaCx5LG0scCxnLHYsZixiLHcsQyxTLFA7cmV0dXJue3Jvb3Q6e2JhY2tncm91bmRDb2xvclByaW1hcnk6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVSb290U2V0dGluZ3NCYWNrZ3JvdW5kQ29sb3IpfHwobnVsbD09PShpPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PWk/dm9pZCAwOmkuYmFja2dyb3VuZENvbG9yUHJpbWFyeSksZXJyb3JDb2xvcjoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVJvb3RTZXR0aW5nc0Vycm9yQ29sb3IpfHwobnVsbD09PShuPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PW4/dm9pZCAwOm4uZXJyb3JDb2xvciksZm9udEZhbWlseToobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVJvb3RTZXR0aW5nc0ZvbnRGYW1pbHkpfHwobnVsbD09PShyPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PXI/dm9pZCAwOnIuZm9udEZhbWlseSksZm9udFNpemVCYXNlOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lUm9vdFNldHRpbmdzRm9udFNpemUpfHwobnVsbD09PShvPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PW8/dm9pZCAwOm8uZm9udFNpemVCYXNlKSxwYWRkaW5nOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lUm9vdFNldHRpbmdzUGFkZGluZyl8fChudWxsPT09KGE9bnVsbD09dD92b2lkIDA6dC5yb290KXx8dm9pZCAwPT09YT92b2lkIDA6YS5wYWRkaW5nKSxwcmltYXJ5Q29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVSb290U2V0dGluZ3NQcmltYXJ5Q29sb3IpfHwobnVsbD09PShzPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PXM/dm9pZCAwOnMucHJpbWFyeUNvbG9yKX0saW5wdXQ6e2JvcmRlclJhZGl1czoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUlucHV0U2V0dGluZ3NCb3JkZXJSYWRpdXMpfHwobnVsbD09PShkPW51bGw9PXQ/dm9pZCAwOnQuaW5wdXQpfHx2b2lkIDA9PT1kP3ZvaWQgMDpkLmJvcmRlclJhZGl1cyksYm9yZGVyQ29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVJbnB1dFNldHRpbmdzQm9yZGVyQ29sb3IpfHwobnVsbD09PShsPW51bGw9PXQ/dm9pZCAwOnQuaW5wdXQpfHx2b2lkIDA9PT1sP3ZvaWQgMDpsLmJvcmRlckNvbG9yKSxmb2N1c0JvcmRlckNvbG9yOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lSW5wdXRTZXR0aW5nc0ZvY3VzQm9yZGVyQmFzZSl8fChudWxsPT09KGM9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PWM/dm9pZCAwOmMuZm9jdXNCb3JkZXJDb2xvciksYmFja2dyb3VuZENvbG9yOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lSW5wdXRTZXR0aW5nc0JhY2tncm91bmRDb2xvcil8fChudWxsPT09KHU9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PXU/dm9pZCAwOnUuYmFja2dyb3VuZENvbG9yKSxib3JkZXJXaWR0aDoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUlucHV0U2V0dGluZ3NCb3JkZXJXaWR0aCl8fChudWxsPT09KGg9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PWg/dm9pZCAwOmguYm9yZGVyV2lkdGgpLHRleHRDb2xvckJhc2U6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVJbnB1dFNldHRpbmdzVGV4dENvbG9yQmFzZSl8fChudWxsPT09KHk9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PXk/dm9pZCAwOnkudGV4dENvbG9yQmFzZSl9LHRvZ2dsZTp7Y29sb3JQcmltYXJ5OihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lVG9nZ2xlU2V0dGluZ3NDb2xvclByaW1hcnkpfHwobnVsbD09PShtPW51bGw9PXQ/dm9pZCAwOnQudG9nZ2xlKXx8dm9pZCAwPT09bT92b2lkIDA6bS5jb2xvclByaW1hcnkpLGNvbG9yU2Vjb25kYXJ5OihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lVG9nZ2xlU2V0dGluZ3NDb2xvclNlY29uZGFyeSl8fChudWxsPT09KHA9bnVsbD09dD92b2lkIDA6dC50b2dnbGUpfHx2b2lkIDA9PT1wP3ZvaWQgMDpwLmNvbG9yU2Vjb25kYXJ5KX0sdGV4dDp7Ym9keTp7Y29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVUZXh0Qm9keVNldHRpbmdzQ29sb3IpfHwobnVsbD09PSh2PW51bGw9PT0oZz1udWxsPT10P3ZvaWQgMDp0LnRleHQpfHx2b2lkIDA9PT1nP3ZvaWQgMDpnLmJvZHkpfHx2b2lkIDA9PT12P3ZvaWQgMDp2LmNvbG9yKSxmb250U2l6ZToobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVRleHRCb2R5U2V0dGluZ3NGb250U2l6ZSl8fChudWxsPT09KGI9bnVsbD09PShmPW51bGw9PXQ/dm9pZCAwOnQudGV4dCl8fHZvaWQgMD09PWY/dm9pZCAwOmYuYm9keSl8fHZvaWQgMD09PWI/dm9pZCAwOmIuZm9udFNpemUpfSxjYXB0aW9uOntjb2xvcjoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVRleHRDYXB0aW9uU2V0dGluZ3NDb2xvcil8fChudWxsPT09KEM9bnVsbD09PSh3PW51bGw9PXQ/dm9pZCAwOnQudGV4dCl8fHZvaWQgMD09PXc/dm9pZCAwOncuY2FwdGlvbil8fHZvaWQgMD09PUM/dm9pZCAwOkMuY29sb3IpLGZvbnRTaXplOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lVGV4dENhcHRpb25TZXR0aW5nc0ZvbnRTaXplKXx8KG51bGw9PT0oUD1udWxsPT09KFM9bnVsbD09dD92b2lkIDA6dC50ZXh0KXx8dm9pZCAwPT09Uz92b2lkIDA6Uy5jYXB0aW9uKXx8dm9pZCAwPT09UD92b2lkIDA6UC5mb250U2l6ZSl9fSxicmFuZGluZzoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUJyYW5kaW5nU2V0dGluZ3MpfHwobnVsbD09dD92b2lkIDA6dC5icmFuZGluZyl9fShlLHQpKX1mdW5jdGlvbiBEZShlKXtyZXR1cm4hIWUmJihcImF1dGhlbnRpY2F0aW9uU3RhdGVcImluIGV8fFwiYWRkcmVzc2VzXCJpbiBlfHxcImluc3RydW1lbnRzXCJpbiBlKX12YXIgX2UsQmU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgeGV7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscz10LHRoaXMuYnJhaW50cmVlU2RrPWl9aW5pdGlhbGl6ZShlKXt2YXIgdDtyZXR1cm4gQmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e21ldGhvZElkOmksYnJhaW50cmVlZmFzdGxhbmU6bn09ZTtpZighaSl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighbil0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVmYXN0bGFuZVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighbi5vbkluaXR8fFwiZnVuY3Rpb25cIiE9dHlwZW9mIG4ub25Jbml0KXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZWZhc3RsYW5lLm9uSW5pdFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZCBvciBpdCBpcyBub3QgYSBmdW5jdGlvbi4nKTtpZighbi5vbkNoYW5nZXx8XCJmdW5jdGlvblwiIT10eXBlb2Ygbi5vbkNoYW5nZSl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVmYXN0bGFuZS5vbkNoYW5nZVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZCBvciBpdCBpcyBub3QgYSBmdW5jdGlvbi4nKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSk7Y29uc3Qgcj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxvPXIuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSkse2luaXRpYWxpemF0aW9uRGF0YTphLGNsaWVudFRva2VuOnN9PW98fHt9LHtpc0Zhc3RsYW5lU3R5bGluZ0VuYWJsZWQ6ZH09YXx8e30sbD14KHIuZ2V0U3RvcmVDb25maWdPclRocm93KCkuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlcyxcIlBST0pFQ1QtNzA4MC5icmFpbnRyZWVfZmFzdGxhbmVfdGhyZWVfZHNcIik7dGhpcy5pczNEU0VuYWJsZWQ9by5jb25maWcuaXMzZHNFbmFibGVkLHMmJmwmJnRoaXMuYnJhaW50cmVlU2RrLmluaXRpYWxpemUocyk7Y29uc3QgYz1NZShkP251bGw9PT0odD1vLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuZmFzdGxhbmVTdHlsZXM6dm9pZCAwLG4uc3R5bGVzKTt5aWVsZCB0aGlzLmJyYWludHJlZUZhc3RsYW5lVXRpbHMuaW5pdGlhbGl6ZUJyYWludHJlZUZhc3RsYW5lT3JUaHJvdyhpLGMpLHRoaXMuc2hvdWxkUnVuQXV0aGVudGljYXRpb25GbG93KCkmJih5aWVsZCB0aGlzLmJyYWludHJlZUZhc3RsYW5lVXRpbHMucnVuUGF5UGFsQXV0aGVudGljYXRpb25GbG93T3JUaHJvdygpKSx5aWVsZCB0aGlzLmluaXRpYWxpemVDYXJkQ29tcG9uZW50KCksdGhpcy5vbkVycm9yPW4ub25FcnJvcixuLm9uSW5pdChlPT50aGlzLnJlbmRlckJyYWludHJlZUNhcmRDb21wb25lbnQoZSkpLG4ub25DaGFuZ2UoKCk9PnRoaXMuaGFuZGxlQnJhaW50cmVlU3RvcmVkSW5zdHJ1bWVudENoYW5nZShpKSl9KX1leGVjdXRlKGUsdCl7cmV0dXJuIEJlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Oml9PWUsbj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSk7aWYoIWkpdGhyb3cgbmV3IFIoW1wicGF5bWVudFwiXSk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKG4sdCk7Y29uc3Qgcj15aWVsZCB0aGlzLnByZXBhcmVQYXltZW50UGF5bG9hZChpLm1ldGhvZElkKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChyKSx0aGlzLmJyYWludHJlZUZhc3RsYW5lVXRpbHMucmVtb3ZlU2Vzc2lvbklkRnJvbUNvb2tpZXMoKX0pfWZpbmFsaXplKCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBXKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gQmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmJyYWludHJlZUNhcmRDb21wb25lbnQ9dm9pZCAwLFByb21pc2UucmVzb2x2ZSgpfSl9aW5pdGlhbGl6ZUNhcmRDb21wb25lbnQoKXtyZXR1cm4gQmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGU9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkse3Bob25lOnQsZmlyc3ROYW1lOmksbGFzdE5hbWU6bn09ZS5nZXRCaWxsaW5nQWRkcmVzc09yVGhyb3coKSxyPWAke2l9ICR7bn1gLG89e3N0eWxlczp7fSxmaWVsZHM6T2JqZWN0LmFzc2lnbih7Y2FyZGhvbGRlck5hbWU6e3ByZWZpbGw6cixlbmFibGVkOiEwfX0sdCYme3Bob25lTnVtYmVyOntwcmVmaWxsOnR9fSl9LGE9dGhpcy5icmFpbnRyZWVGYXN0bGFuZVV0aWxzLmdldEJyYWludHJlZUZhc3RsYW5lQ29tcG9uZW50T3JUaHJvdygpO3RoaXMuYnJhaW50cmVlQ2FyZENvbXBvbmVudD15aWVsZCBhKG8pfSl9cmVuZGVyQnJhaW50cmVlQ2FyZENvbXBvbmVudChlKXtjb25zdCB0PXRoaXMuZ2V0QnJhaW50cmVlQ2FyZENvbXBvbmVudE9yVGhyb3coKTtpZighZSl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwiY29udGFpbmVyXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3QucmVuZGVyKGUpfXByZXBhcmVQYXltZW50UGF5bG9hZChlKXt2YXIgdCxpO3JldHVybiBCZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPW4uZ2V0QmlsbGluZ0FkZHJlc3NPclRocm93KCksbz1gJHtyLmZpcnN0TmFtZX0gJHtyLmxhc3ROYW1lfWAsYT10aGlzLmdldFBheVBhbEluc3RydW1lbnRzKClbMF0scz15aWVsZCB0aGlzLmJyYWludHJlZUZhc3RsYW5lVXRpbHMuZ2V0RGV2aWNlU2Vzc2lvbklkKCksZD14KG4uZ2V0U3RvcmVDb25maWdPclRocm93KCkuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlcyxcIlBST0pFQ1QtNzA4MC5icmFpbnRyZWVfZmFzdGxhbmVfdGhyZWVfZHNcIik7aWYoYSl7Y29uc3QgdD10aGlzLmlzM0RTRW5hYmxlZCYmZD95aWVsZCB0aGlzLmdldDNEUyhhLmJpZ3BheVRva2VuLChudWxsPT1hP3ZvaWQgMDphLmlpbil8fFwiXCIpOnZvaWQgMDtyZXR1cm57bWV0aG9kSWQ6ZSxwYXltZW50RGF0YTp7ZGV2aWNlU2Vzc2lvbklkOnMsZm9ybWF0dGVkUGF5bG9hZDp7cGF5cGFsX2Zhc3RsYW5lX3Rva2VuOnt0b2tlbjp0fHxhLmJpZ3BheVRva2VufX19fX1jb25zdHtnZXRQYXltZW50VG9rZW46bH09dGhpcy5nZXRCcmFpbnRyZWVDYXJkQ29tcG9uZW50T3JUaHJvdygpLGM9eWllbGQgbCh7bmFtZTp7ZnVsbE5hbWU6b30sYmlsbGluZ0FkZHJlc3M6dGhpcy5tYXBUb1BheVBhbEFkZHJlc3Mocil9KSx1PShudWxsPT09KGk9bnVsbD09PSh0PWMucGF5bWVudFNvdXJjZS5jYXJkKXx8dm9pZCAwPT09dD92b2lkIDA6dC5iaW5EZXRhaWxzKXx8dm9pZCAwPT09aT92b2lkIDA6aS5iaW4pfHxcIlwiLGg9dGhpcy5pczNEU0VuYWJsZWQmJmQ/eWllbGQgdGhpcy5nZXQzRFMoYy5pZCx1KTp2b2lkIDA7cmV0dXJue21ldGhvZElkOmUscGF5bWVudERhdGE6e2RldmljZVNlc3Npb25JZDpzLG5vbmNlOmh8fGMuaWR9fX0pfWdldDNEUyhlLHQpe3JldHVybiBCZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxuPXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldEJyYWludHJlZVRocmVlRFMoKSxyPWkuZ2V0T3JkZXJPclRocm93KCk7cmV0dXJuIG5ldyBQcm9taXNlKChpLG8pPT57bi52ZXJpZnlDYXJkKHthbW91bnQ6bnVsbD09cj92b2lkIDA6ci5vcmRlckFtb3VudCxub25jZTplLGJpbjp0LG9uTG9va3VwQ29tcGxldGU6KGUsdCk9PntuLm9uKFwiY3VzdG9tZXItY2FuY2VsZWRcIiwoKT0+e1wiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXMub25FcnJvciYmdGhpcy5vbkVycm9yKG5ldyBRKSxvKG5ldyBRKX0pLHQoKX19LChlLHQpPT4oZSYmXCJUSFJFRURTX1ZFUklGWV9DQVJEX0NBTkNFTEVEX0JZX01FUkNIQU5UXCI9PT1lLmNvZGUmJihcImZ1bmN0aW9uXCI9PXR5cGVvZiB0aGlzLm9uRXJyb3ImJnRoaXMub25FcnJvcihuZXcgUSksbyhuZXcgUSkpLGkodC5ub25jZSkpKX0pfSl9bWFwVG9QYXlQYWxBZGRyZXNzKGUpe3JldHVybntzdHJlZXRBZGRyZXNzOihudWxsPT1lP3ZvaWQgMDplLmFkZHJlc3MxKXx8XCJcIixsb2NhbGl0eToobnVsbD09ZT92b2lkIDA6ZS5jaXR5KXx8XCJcIixyZWdpb246KG51bGw9PWU/dm9pZCAwOmUuc3RhdGVPclByb3ZpbmNlQ29kZSl8fChudWxsPT1lP3ZvaWQgMDplLnN0YXRlT3JQcm92aW5jZSl8fFwiXCIscG9zdGFsQ29kZToobnVsbD09ZT92b2lkIDA6ZS5wb3N0YWxDb2RlKXx8XCJcIixjb3VudHJ5Q29kZUFscGhhMjoobnVsbD09ZT92b2lkIDA6ZS5jb3VudHJ5Q29kZSl8fFwiXCJ9fXNob3VsZFJ1bkF1dGhlbnRpY2F0aW9uRmxvdygpe2NvbnN0IGU9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksdD1lLmdldENhcnRPclRocm93KCksaT1lLmdldEN1c3RvbWVyT3JUaHJvdygpLG49ZS5nZXRQYXltZW50UHJvdmlkZXJDdXN0b21lcigpLHI9RGUobik/bjp7fSxvPXRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5nZXRTZXNzaW9uSWRGcm9tQ29va2llcygpO3JldHVybiEoIWkuaXNHdWVzdHx8KG51bGw9PXI/dm9pZCAwOnIuYXV0aGVudGljYXRpb25TdGF0ZSk9PT1PLkNBTkNFTEVEfHwobnVsbD09cj92b2lkIDA6ci5hdXRoZW50aWNhdGlvblN0YXRlKXx8byE9PXQuaWQpfWdldEJyYWludHJlZUNhcmRDb21wb25lbnRPclRocm93KCl7aWYoIXRoaXMuYnJhaW50cmVlQ2FyZENvbXBvbmVudCl0aHJvdyBuZXcgZztyZXR1cm4gdGhpcy5icmFpbnRyZWVDYXJkQ29tcG9uZW50fWdldFBheVBhbEluc3RydW1lbnRzKCl7Y29uc3QgZT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50UHJvdmlkZXJDdXN0b21lck9yVGhyb3coKTtyZXR1cm4oRGUoZSk/ZTp7fSkuaW5zdHJ1bWVudHN8fFtdfWhhbmRsZUJyYWludHJlZVN0b3JlZEluc3RydW1lbnRDaGFuZ2UoZSl7cmV0dXJuIEJlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5nZXRCcmFpbnRyZWVGYXN0bGFuZU9yVGhyb3coKSx7c2VsZWN0aW9uQ2hhbmdlZDppLHNlbGVjdGVkQ2FyZDpufT15aWVsZCB0LnByb2ZpbGUuc2hvd0NhcmRTZWxlY3RvcigpO2lmKGkpe2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudFByb3ZpZGVyQ3VzdG9tZXIoKSxpPURlKHQpP3Q6e30scj10aGlzLmJyYWludHJlZUZhc3RsYW5lVXRpbHMubWFwUGF5UGFsVG9CY0luc3RydW1lbnQoZSxbbl0pO2lmKHImJnIubGVuZ3RoPjApcmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVQYXltZW50UHJvdmlkZXJDdXN0b21lcihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30saSkse2luc3RydW1lbnRzOlsuLi5yXX0pKSxyWzBdfX0pfX0hZnVuY3Rpb24oZSl7ZS5DVlY9XCJjdnZcIixlLlBBTj1cInBhblwifShfZXx8KF9lPXt9KSk7Y2xhc3MgRmV7c3RhdGljIGdldChlKXtjb25zdCB0PWAke2VuY29kZVVSSUNvbXBvbmVudChgJHtlfWApfT1gLGk9ZG9jdW1lbnQuY29va2llO2xldCBuPW51bGw7Y29uc3Qgcj1pLmluZGV4T2YodCk7aWYocj4tMSl7bGV0IGU9aS5pbmRleE9mKFwiO1wiLHIpOy0xPT09ZSYmKGU9aS5sZW5ndGgpLG49ZGVjb2RlVVJJQ29tcG9uZW50KGkuc3Vic3RyaW5nKHIrdC5sZW5ndGgsZSkpfXJldHVybiBufXN0YXRpYyBzZXQoZSx0LGk9e3NlY3VyZTohMH0pe2xldCBuPWAke2VuY29kZVVSSUNvbXBvbmVudChlKX09JHtlbmNvZGVVUklDb21wb25lbnQodCl9YDtjb25zdHtleHBpcmVzOnIscGF0aDpvLGRvbWFpbjphLHNlY3VyZTpzfT1pO2lmKHIpbis9YDsgZXhwaXJlcz0ke3IudG9VVENTdHJpbmcoKX1gO2Vsc2V7Y29uc3QgZT1uZXcgRGF0ZSx0PTYwO2Uuc2V0VGltZShlLmdldFRpbWUoKSs2MCp0KjFlMyksbis9YDsgZXhwaXJlcz0ke2UudG9VVENTdHJpbmcoKX1gfW8mJihuKz1gOyBwYXRoPSR7b31gKSxhJiYobis9YDsgZG9tYWluPSR7YX1gKSxzJiYobis9XCI7IHNlY3VyZVwiKSxkb2N1bWVudC5jb29raWU9bn1zdGF0aWMgcmVtb3ZlKGUsdCl7RmUuc2V0KGUsXCJcIixPYmplY3QuYXNzaWduKHtleHBpcmVzOm5ldyBEYXRlKDApfSx0KSl9fXZhciBMZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBWZXtjb25zdHJ1Y3RvcihlLHQpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlPXR9Z2V0RGV2aWNlU2Vzc2lvbklkKCl7cmV0dXJuIExlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBlPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnQoKTtyZXR1cm4gdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U2Vzc2lvbklkKG51bGw9PWU/dm9pZCAwOmUuaWQpfSl9aW5pdGlhbGl6ZUJyYWludHJlZUZhc3RsYW5lT3JUaHJvdyhlLHQpe3JldHVybiBMZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxuPWkuZ2V0Q2FydCgpLHtjbGllbnRUb2tlbjpyLGNvbmZpZzpvfT1pLmdldFBheW1lbnRNZXRob2RPclRocm93KGUpO2lmKCFyKXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRNZXRob2QpO3RoaXMubWV0aG9kSWQ9ZSx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKHIpLHRoaXMuYnJhaW50cmVlRmFzdGxhbmU9eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0QnJhaW50cmVlRmFzdGxhbmUobnVsbD09bj92b2lkIDA6bi5pZCxvLnRlc3RNb2RlLHQpfSl9Z2V0QnJhaW50cmVlRmFzdGxhbmVPclRocm93KCl7aWYoIXRoaXMuYnJhaW50cmVlRmFzdGxhbmUpdGhyb3cgbmV3IGc7cmV0dXJuIHRoaXMuYnJhaW50cmVlRmFzdGxhbmV9Z2V0QnJhaW50cmVlRmFzdGxhbmVDb21wb25lbnRPclRocm93KCl7cmV0dXJuIHRoaXMuZ2V0QnJhaW50cmVlRmFzdGxhbmVPclRocm93KCkuRmFzdGxhbmVDYXJkQ29tcG9uZW50fXJ1blBheVBhbEF1dGhlbnRpY2F0aW9uRmxvd09yVGhyb3coZSx0KXt2YXIgaTtyZXR1cm4gTGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtjb25zdCBuPXRoaXMuZ2V0TWV0aG9kSWRPclRocm93KCkscj10aGlzLmdldEJyYWludHJlZUZhc3RsYW5lT3JUaHJvdygpLHtsb29rdXBDdXN0b21lckJ5RW1haWw6byx0cmlnZ2VyQXV0aGVudGljYXRpb25GbG93OmF9PXIuaWRlbnRpdHkscz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxkPXMuZ2V0Q2FydE9yVGhyb3coKSxsPXMuZ2V0Q3VzdG9tZXIoKSxjPXMuZ2V0QmlsbGluZ0FkZHJlc3MoKSx7aXNGYXN0bGFuZVNoaXBwaW5nT3B0aW9uQXV0b1NlbGVjdEVuYWJsZWQ6dX09cy5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhuKS5pbml0aWFsaXphdGlvbkRhdGF8fHt9LGg9ZXx8KG51bGw9PWw/dm9pZCAwOmwuZW1haWwpfHwobnVsbD09Yz92b2lkIDA6Yy5lbWFpbCl8fFwiXCIse2N1c3RvbWVyQ29udGV4dElkOnl9PXlpZWxkIG8oaCk7aWYoIXkpcmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVQYXltZW50UHJvdmlkZXJDdXN0b21lcih7YXV0aGVudGljYXRpb25TdGF0ZTpPLlVOUkVDT0dOSVpFRCxhZGRyZXNzZXM6W10saW5zdHJ1bWVudHM6W119KSx2b2lkIHRoaXMuc2F2ZVNlc3Npb25JZFRvQ29va2llcyhkLmlkKTtjb25zdHthdXRoZW50aWNhdGlvblN0YXRlOm0scHJvZmlsZURhdGE6cH09eWllbGQgYSh5KSxnPShudWxsPT09KGk9bnVsbD09cD92b2lkIDA6cC5zaGlwcGluZ0FkZHJlc3MpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLnBob25lTnVtYmVyKXx8XCJcIjtpZihtPT09Ty5DQU5DRUxFRClyZXR1cm4geWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVBheW1lbnRQcm92aWRlckN1c3RvbWVyKHthdXRoZW50aWNhdGlvblN0YXRlOm0sYWRkcmVzc2VzOltdLGluc3RydW1lbnRzOltdfSksdm9pZCB0aGlzLnJlbW92ZVNlc3Npb25JZEZyb21Db29raWVzKCk7Y29uc3Qgdj10aGlzLm1hcFBheVBhbFRvQmNBZGRyZXNzKFtwLnNoaXBwaW5nQWRkcmVzc10sW2ddKXx8W10sZj10aGlzLmdldFBheVBhbEJpbGxpbmdBZGRyZXNzZXMocCksYj1mP3RoaXMubWFwUGF5UGFsVG9CY0FkZHJlc3MoW2ZdLFtnXSk6W10sdz1wLmNhcmQ/dGhpcy5tYXBQYXlQYWxUb0JjSW5zdHJ1bWVudChuLFtwLmNhcmRdKTpbXSxDPXRoaXMubWVyZ2VTaGlwcGluZ0FuZEJpbGxpbmdBZGRyZXNzZXModixiKTtpZih0aGlzLnNhdmVTZXNzaW9uSWRUb0Nvb2tpZXMoZC5pZCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVBheW1lbnRQcm92aWRlckN1c3RvbWVyKHthdXRoZW50aWNhdGlvblN0YXRlOm0sYWRkcmVzc2VzOkMsaW5zdHJ1bWVudHM6d30pLGIubGVuZ3RoPjAmJmQubGluZUl0ZW1zLnBoeXNpY2FsSXRlbXMubGVuZ3RoPjAmJih5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3MoYlswXSkpLGIubGVuZ3RoPjAmJmQubGluZUl0ZW1zLmRpZ2l0YWxJdGVtcy5sZW5ndGg+MCYmMD09PWQubGluZUl0ZW1zLnBoeXNpY2FsSXRlbXMubGVuZ3RoKXtjb25zdHtmaXJzdE5hbWU6ZSxsYXN0TmFtZTp0fT1DWzBdLGk9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGJbMF0pLHtmaXJzdE5hbWU6ZSxsYXN0TmFtZTp0fSk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZUJpbGxpbmdBZGRyZXNzKGkpfXYubGVuZ3RoPjAmJmQubGluZUl0ZW1zLnBoeXNpY2FsSXRlbXMubGVuZ3RoPjAmJih5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlU2hpcHBpbmdBZGRyZXNzKHZbMF0pLHQmJnUmJih5aWVsZCB0aGlzLnNldFNoaXBwaW5nT3B0aW9uKCkpKX1jYXRjaChlKXt9fSl9Z2V0U2Vzc2lvbklkRnJvbUNvb2tpZXMoKXtyZXR1cm4gRmUuZ2V0KFwiYmMtZmFzdGxhbmUtc2Vzc2lvbklkXCIpfHxcIlwifXNhdmVTZXNzaW9uSWRUb0Nvb2tpZXMoZSl7Y29uc3QgdD1uZXcgRGF0ZTt0LnNldERhdGUodC5nZXREYXRlKCkrMTQpLEZlLnNldChcImJjLWZhc3RsYW5lLXNlc3Npb25JZFwiLGUse2V4cGlyZXM6dCxzZWN1cmU6ITB9KX1yZW1vdmVTZXNzaW9uSWRGcm9tQ29va2llcygpe0ZlLnJlbW92ZShcImJjLWZhc3RsYW5lLXNlc3Npb25JZFwiKX1tYXBQYXlQYWxUb0JjSW5zdHJ1bWVudChlLHQpe2lmKHQpcmV0dXJuIHQubWFwKHQ9Pntjb25zdHtpZDppLHBheW1lbnRTb3VyY2U6bn09dCx7YnJhbmQ6cixleHBpcnk6byxsYXN0RGlnaXRzOmEsYmluRGV0YWlsczpzfT1uLmNhcmQsW2QsbF09by5zcGxpdChcIi1cIik7cmV0dXJue2JpZ3BheVRva2VuOmksYnJhbmQ6cixkZWZhdWx0SW5zdHJ1bWVudDohMSxleHBpcnlNb250aDpsLGV4cGlyeVllYXI6ZCxpaW46KG51bGw9PXM/dm9pZCAwOnMuYmluKXx8XCJcIixsYXN0NDphLG1ldGhvZDplLHByb3ZpZGVyOmUsdHJ1c3RlZFNoaXBwaW5nQWRkcmVzczohMSx0eXBlOlwiY2FyZFwiLHVudHJ1c3RlZFNoaXBwaW5nQ2FyZFZlcmlmaWNhdGlvbk1vZGU6X2UuUEFOfX0pfW1hcFBheVBhbFRvQmNBZGRyZXNzKGUsdCl7aWYoIWUpcmV0dXJuW107Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDb3VudHJpZXMoKXx8W10sbj1lPT57Y29uc3QgdD1pLmZpbmQodD0+dC5jb2RlPT09ZSk7cmV0dXJuKG51bGw9PXQ/dm9pZCAwOnQubmFtZSl8fFwiXCJ9O3JldHVybiBlLm1hcChlPT4oe2lkOkRhdGUubm93KCksdHlwZTpcInBheXBhbC1hZGRyZXNzXCIsZmlyc3ROYW1lOmUuZmlyc3ROYW1lfHxcIlwiLGxhc3ROYW1lOmUubGFzdE5hbWV8fFwiXCIsY29tcGFueTplLmNvbXBhbnl8fFwiXCIsYWRkcmVzczE6ZS5zdHJlZXRBZGRyZXNzLGFkZHJlc3MyOmUuZXh0ZW5kZWRBZGRyZXNzfHxcIlwiLGNpdHk6ZS5sb2NhbGl0eSxzdGF0ZU9yUHJvdmluY2U6ZS5yZWdpb24sc3RhdGVPclByb3ZpbmNlQ29kZTplLnJlZ2lvbixjb3VudHJ5Om4oZS5jb3VudHJ5Q29kZUFscGhhMiksY291bnRyeUNvZGU6ZS5jb3VudHJ5Q29kZUFscGhhMixwb3N0YWxDb2RlOmUucG9zdGFsQ29kZSxwaG9uZTp0JiZ0WzBdfHxcIlwiLGN1c3RvbUZpZWxkczpbXX0pKX1nZXRQYXlQYWxCaWxsaW5nQWRkcmVzc2VzKGUpe2NvbnN0e2NhcmQ6dCxuYW1lOml9PWV8fHt9O2lmKCF0KXJldHVybjtjb25zdHtmaXJzdE5hbWU6cixsYXN0TmFtZTpvfT10LnBheW1lbnRTb3VyY2UuY2FyZC5iaWxsaW5nQWRkcmVzcyx7Zmlyc3ROYW1lOmEsbGFzdE5hbWU6c309aXx8e30se3NoaXBwaW5nQWRkcmVzczpkfT1lfHx7fSxsPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0LnBheW1lbnRTb3VyY2UuY2FyZC5iaWxsaW5nQWRkcmVzcykse2ZpcnN0TmFtZTpyfHxhLGxhc3ROYW1lOm98fHN9KTtyZXR1cm4gZCYmbih0aGlzLm5vcm1hbGl6ZUFkZHJlc3MobCksdGhpcy5ub3JtYWxpemVBZGRyZXNzKGQpKT9kOmx9bm9ybWFsaXplQWRkcmVzcyhlKXtyZXR1cm4gYShlLFtcImlkXCJdKX1tZXJnZVNoaXBwaW5nQW5kQmlsbGluZ0FkZHJlc3NlcyhlLHQpe2NvbnN0IGk9dC5maWx0ZXIodD0+IWUuc29tZShlPT5uKHRoaXMubm9ybWFsaXplQWRkcmVzcyhlKSx0aGlzLm5vcm1hbGl6ZUFkZHJlc3ModCkpKSk7cmV0dXJuWy4uLmUsLi4uaV19Z2V0TWV0aG9kSWRPclRocm93KCl7aWYoIXRoaXMubWV0aG9kSWQpdGhyb3cgbmV3IFYoJ1VuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgXCJtZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtyZXR1cm4gdGhpcy5tZXRob2RJZH1zZXRTaGlwcGluZ09wdGlvbigpe3ZhciBlO3JldHVybiBMZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDb25zaWdubWVudHMoKXx8W10saT0obnVsbD09PShlPXRbMF0pfHx2b2lkIDA9PT1lP3ZvaWQgMDplLmF2YWlsYWJsZVNoaXBwaW5nT3B0aW9ucyl8fFtdLG49aS5maW5kKGU9PmUuaXNSZWNvbW1lbmRlZCk7aWYobnx8aS5sZW5ndGgpe2NvbnN0IGU9bnx8aVswXTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2VsZWN0U2hpcHBpbmdPcHRpb24oZS5pZCl9fSl9fWNvbnN0IGplPUwodD0+e2NvbnN0IGk9d2luZG93LG49bmV3IEYodCkscj1uZXcgZGUobmV3IHooZSgpLGksbiksaSksbz1uZXcgVmUodCxyKSxhPW5ldyB6KGUoKSxpLG4pLHM9bmV3IEIoYSk7cmV0dXJuIG5ldyB4ZSh0LG8scyl9LFt7aWQ6XCJicmFpbnRyZWVhY2NlbGVyYXRlZGNoZWNrb3V0XCJ9XSk7dmFyIFVlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIFJle2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmZvcm1Qb3N0ZXI9dCx0aGlzLmJyYWludHJlZVNkaz1pfWluaXRpYWxpemUoZSl7cmV0dXJuIFVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWV2aXNhY2hlY2tvdXQ6dCxtZXRob2RJZDppfT1lO2lmKCF0KXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXZpc2FjaGVja291dFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSk7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTt0aGlzLnBheW1lbnRNZXRob2Q9bi5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKTtjb25zdCByPW4uZ2V0Q2hlY2tvdXRPclRocm93KCksYT1uLmdldFN0b3JlQ29uZmlnT3JUaHJvdygpLHtjbGllbnRUb2tlbjpzLGNvbmZpZzpkfT10aGlzLnBheW1lbnRNZXRob2R8fHt9O2lmKCFzKXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0e29uRXJyb3I6bD1vLG9uUGF5bWVudFNlbGVjdDpjPW99PXQ7dGhpcy5icmFpbnRyZWVTZGsuaW5pdGlhbGl6ZShzKTtjb25zdCB1PXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldEJyYWludHJlZVZpc2FDaGVja291dCgpLGg9eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0VmlzYUNoZWNrb3V0U2RrKG51bGw9PWQ/dm9pZCAwOmQudGVzdE1vZGUpLHk9dS5jcmVhdGVJbml0T3B0aW9ucyh7c2V0dGluZ3M6e2xvY2FsZTphLnN0b3JlUHJvZmlsZS5zdG9yZUxhbmd1YWdlLHNoaXBwaW5nOntjb2xsZWN0U2hpcHBpbmc6ITF9fSxwYXltZW50UmVxdWVzdDp7Y3VycmVuY3lDb2RlOmEuY3VycmVuY3kuY29kZSxzdWJ0b3RhbDpTdHJpbmcoci5zdWJ0b3RhbCl9fSk7eWllbGQgaC5pbml0KHkpLGgub24oXCJwYXltZW50LnN1Y2Nlc3NcIixlPT50aGlzLnRva2VuaXplUGF5bWVudCh1LGUpLnRoZW4oKCk9PlByb21pc2UuYWxsKFt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZENoZWNrb3V0KCksdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKGkpXSkpLnRoZW4oKCk9PmMoKSkuY2F0Y2goZT0+bChlKSkpLGgub24oXCJwYXltZW50LmVycm9yXCIsKGUsdCk9PmwodCkpfSl9ZXhlY3V0ZShlLHQpe3ZhciBpLG47cmV0dXJuIFVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50OnJ9PWUsbz1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSk7aWYoIXIpdGhyb3cgbmV3IFYoJ1VuYWJsZSB0byBzdWJtaXQgcGF5bWVudCBiZWNhdXNlIFwicGF5bG9hZC5wYXltZW50XCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCEobnVsbD09PShuPW51bGw9PT0oaT10aGlzLnBheW1lbnRNZXRob2QpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PW4/dm9pZCAwOm4ubm9uY2UpKXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0e25vbmNlOmF9PXRoaXMucGF5bWVudE1ldGhvZC5pbml0aWFsaXphdGlvbkRhdGE7dHJ5e3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihvLHQpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7cGF5bWVudERhdGE6e25vbmNlOmF9fSkpfWNhdGNoKGUpe3RoaXMuaGFuZGxlRXJyb3IoZSl9fSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFcpfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBVZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZGVpbml0aWFsaXplKCl9KX10b2tlbml6ZVBheW1lbnQoZSx0KXtyZXR1cm4gVWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiBQcm9taXNlLmFsbChbZS50b2tlbml6ZSh0KSx0aGlzLmJyYWludHJlZVNkay5nZXREYXRhQ29sbGVjdG9yT3JUaHJvdygpXSkudGhlbigoW2UsdF0pPT57Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxuPWkuZ2V0U2hpcHBpbmdBZGRyZXNzKCkscj1pLmdldEJpbGxpbmdBZGRyZXNzKCkse3NoaXBwaW5nQWRkcmVzczpvPXRoaXMubWFwVG9WaXNhQ2hlY2tvdXRBZGRyZXNzKG4pLGJpbGxpbmdBZGRyZXNzOmE9dGhpcy5tYXBUb1Zpc2FDaGVja291dEFkZHJlc3Mocil9PWU7cmV0dXJuIHRoaXMucG9zdEZvcm0oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHtzaGlwcGluZ0FkZHJlc3M6byxiaWxsaW5nQWRkcmVzczphfSksdCl9KX0pfW1hcFRvVmlzYUNoZWNrb3V0QWRkcmVzcyhlKXtyZXR1cm4gZT97Zmlyc3ROYW1lOmUuZmlyc3ROYW1lLGxhc3ROYW1lOmUubGFzdE5hbWUscGhvbmVOdW1iZXI6ZS5waG9uZSxzdHJlZXRBZGRyZXNzOmUuYWRkcmVzczEsZXh0ZW5kZWRBZGRyZXNzOmUuYWRkcmVzczIsbG9jYWxpdHk6ZS5jaXR5LHJlZ2lvbjplLnN0YXRlT3JQcm92aW5jZUNvZGUsY291bnRyeUNvZGU6ZS5jb3VudHJ5Q29kZSxwb3N0YWxDb2RlOmUucG9zdGFsQ29kZX06e319cG9zdEZvcm0oZSx0KXtjb25zdHt1c2VyRGF0YTppLGJpbGxpbmdBZGRyZXNzOm4sc2hpcHBpbmdBZGRyZXNzOnIsZGV0YWlsczpvfT1lLHt1c2VyRW1haWw6YX09aSx7ZGV2aWNlRGF0YTpzfT10O3JldHVybiB0aGlzLmZvcm1Qb3N0ZXIucG9zdEZvcm0oXCIvY2hlY2tvdXQucGhwXCIse3BheW1lbnRfdHlwZTplLnR5cGUsbm9uY2U6ZS5ub25jZSxwcm92aWRlcjpcImJyYWludHJlZXZpc2FjaGVja291dFwiLGFjdGlvbjpcInNldF9leHRlcm5hbF9jaGVja291dFwiLGRldmljZV9kYXRhOnMsY2FyZF9pbmZvcm1hdGlvbjpKU09OLnN0cmluZ2lmeSh7dHlwZTpvLmNhcmRUeXBlLG51bWJlcjpvLmxhc3RUd299KSxiaWxsaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkodGhpcy5nZXRBZGRyZXNzKGEsbikpLHNoaXBwaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkodGhpcy5nZXRBZGRyZXNzKGEscikpfSl9Z2V0QWRkcmVzcyhlLHQ9e30pe3JldHVybntlbWFpbDplLGZpcnN0X25hbWU6dC5maXJzdE5hbWUsbGFzdF9uYW1lOnQubGFzdE5hbWUscGhvbmVfbnVtYmVyOnQucGhvbmVOdW1iZXIsYWRkcmVzc19saW5lXzE6dC5zdHJlZXRBZGRyZXNzLGFkZHJlc3NfbGluZV8yOnQuZXh0ZW5kZWRBZGRyZXNzLGNpdHk6dC5sb2NhbGl0eSxzdGF0ZTp0LnJlZ2lvbixjb3VudHJ5X2NvZGU6dC5jb3VudHJ5Q29kZSxwb3N0YWxfY29kZTp0LnBvc3RhbENvZGV9fWhhbmRsZUVycm9yKGUpe2lmKGUgaW5zdGFuY2VvZiBFcnJvciYmXCJCcmFpbnRyZWVFcnJvclwiPT09ZS5uYW1lKXRocm93IG5ldyAkKGUubWVzc2FnZSk7dGhyb3cgZX19Y29uc3QgSGU9TCh0PT57Y29uc3QgaT13aW5kb3csbj1uZXcgRih0KSxyPW5ldyBCKG5ldyB6KGUoKSxpLG4pKTtyZXR1cm4gbmV3IFJlKHQsdSgpLHIpfSxbe2lkOlwiYnJhaW50cmVldmlzYWNoZWNrb3V0XCJ9XSk7dmFyIFdlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIHFle2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2U9dH1pbml0aWFsaXplKGUpe3JldHVybiBXZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6dH09ZTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QodCk7Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTt0aGlzLnZlbm1vT3B0aW9ucz1lLmJyYWludHJlZXZlbm1vO2NvbnN0IG49aS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyh0KTt5aWVsZCB0aGlzLmluaXRpYWxpemVCcmFpbnRyZWVWZW5tbyhuKX0pfWV4ZWN1dGUoZSl7cmV0dXJuIFdlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50OnR9PWUsaT1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSk7aWYoIXQpdGhyb3cgbmV3IFIoW1wicGF5bWVudFwiXSk7dHJ5e2NvbnN0IGU9eWllbGQgdGhpcy5wcmVwYXJlUGF5bWVudERhdGEodCk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKGkpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGUpfWNhdGNoKGUpe3RoaXMuaGFuZGxlRXJyb3IoZSl9fSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFcpfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBXZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRlYXJkb3duKCksUHJvbWlzZS5yZXNvbHZlKCl9KX1oYW5kbGVFcnJvcihlKXtpZighRChlKSl0aHJvdyBlO2lmKFwiUEFZUEFMX1BPUFVQX0NMT1NFRFwiPT09ZS5jb2RlKXRocm93IG5ldyBRKGUubWVzc2FnZSk7dGhyb3cgbmV3ICQoZS5tZXNzYWdlKX1pbml0aWFsaXplQnJhaW50cmVlVmVubW8oZSl7dmFyIHQ7cmV0dXJuIFdlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtjbGllbnRUb2tlbjppfT1lO2lmKCFpKXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0IG49eCh0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRTdG9yZUNvbmZpZ09yVGhyb3coKS5jaGVja291dFNldHRpbmdzLmZlYXR1cmVzLFwiUEFZUEFMLTU0MDYuYnJhaW50cmVlX3Zlbm1vX3dlYl9mYWxsYmFja19zdXBwb3J0XCIpO3RyeXt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKGkpLHRoaXMuYnJhaW50cmVlVmVubW9DaGVja291dD15aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRWZW5tb0NoZWNrb3V0KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx2b2lkIDAhPT0obnVsbD09PSh0PXRoaXMudmVubW9PcHRpb25zKXx8dm9pZCAwPT09dD92b2lkIDA6dC5hbGxvd0Rlc2t0b3ApP3thbGxvd0Rlc2t0b3A6dGhpcy52ZW5tb09wdGlvbnMuYWxsb3dEZXNrdG9wfTp7fSksbj97bW9iaWxlV2ViRmFsbEJhY2s6bn06e30pKX1jYXRjaChlKXt0aGlzLmhhbmRsZUVycm9yKGUpfX0pfXByZXBhcmVQYXltZW50RGF0YShlKXtyZXR1cm4gV2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkse25vbmNlOml9PXQuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZS5tZXRob2RJZCk7aWYoaSlyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHtwYXltZW50RGF0YTp0aGlzLmZvcm1hdHRlZFBheWxvYWQoaSl9KTtjb25zdCBuPXlpZWxkIHRoaXMuYnJhaW50cmVlVmVubW9Ub2tlbml6ZSgpLHI9eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U2Vzc2lvbklkKCk7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7cGF5bWVudERhdGE6dGhpcy5mb3JtYXR0ZWRQYXlsb2FkKG4ubm9uY2Usbi5kZXRhaWxzLmVtYWlsLHIpfSl9KX1mb3JtYXR0ZWRQYXlsb2FkKGUsdCxpKXtyZXR1cm57Zm9ybWF0dGVkUGF5bG9hZDp7dmF1bHRfcGF5bWVudF9pbnN0cnVtZW50Om51bGwsc2V0X2FzX2RlZmF1bHRfc3RvcmVkX2luc3RydW1lbnQ6bnVsbCxkZXZpY2VfaW5mbzppfHxudWxsLHBheXBhbF9hY2NvdW50Ont0b2tlbjplLGVtYWlsOnR8fG51bGx9fX19YnJhaW50cmVlVmVubW9Ub2tlbml6ZSgpe3JldHVybiBuZXcgUHJvbWlzZSgoZSx0KT0+e3ZhciBpO251bGw9PT0oaT10aGlzLmJyYWludHJlZVZlbm1vQ2hlY2tvdXQpfHx2b2lkIDA9PT1pfHxpLnRva2VuaXplKChpLG4pPT57aWYoaSlyZXR1cm4gdChpKTtlKG4pfSl9KX19Y29uc3QgJGU9TCh0PT57Y29uc3QgaT13aW5kb3csbj1lKCkscj1uZXcgRih0KSxvPW5ldyB6KG4saSxyKSxhPW5ldyBkZShvLGkpO3JldHVybiBuZXcgcWUodCxhKX0sW3tpZDpcImJyYWludHJlZXZlbm1vXCJ9XSk7dmFyIEdlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIFlle2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT10LHRoaXMuYnJhaW50cmVlSG9zdGVkRm9ybT1pfWluaXRpYWxpemUoZSl7cmV0dXJuIEdlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHttZXRob2RJZDp0LGdhdGV3YXlJZDppLGJyYWludHJlZTpufT1lO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZCh0KTtjb25zdCByPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO3RoaXMucGF5bWVudE1ldGhvZD1yLmdldFBheW1lbnRNZXRob2RPclRocm93KHQpO2NvbnN0e2NsaWVudFRva2VuOm99PXRoaXMucGF5bWVudE1ldGhvZDtpZighbyl0aHJvdyBuZXcgVShqLk1pc3NpbmdQYXltZW50TWV0aG9kKTt0aGlzLnRocmVlRFNlY3VyZT1udWxsPT1uP3ZvaWQgMDpuLnRocmVlRFNlY3VyZTt0cnl7dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuaW5pdGlhbGl6ZShvLHRoaXMudGhyZWVEU2VjdXJlKSx0aGlzLmlzSG9zdGVkUGF5bWVudEZvcm1FbmFibGVkKHQsaSkmJihudWxsPT1uP3ZvaWQgMDpuLmZvcm0pJiYoeWllbGQgdGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtLmluaXRpYWxpemUobi5mb3JtLG4udW5zdXBwb3J0ZWRDYXJkQnJhbmRzLG8pLHRoaXMuaXNIb3N0ZWRGb3JtSW5pdGlhbGl6ZWQ9dGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtLmlzSW5pdGlhbGl6ZWQoKSksdGhpcy5pczNkc0VuYWJsZWQ9dGhpcy5wYXltZW50TWV0aG9kLmNvbmZpZy5pczNkc0VuYWJsZWQsdGhpcy5kZXZpY2VTZXNzaW9uSWQ9eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U2Vzc2lvbklkKCksdGhpcy5zaG91bGRJbml0aWFsaXplQnJhaW50cmVlRmFzdGxhbmUoKSYmKHlpZWxkIHRoaXMuaW5pdGlhbGl6ZUJyYWludHJlZUZhc3RsYW5lT3JUaHJvdyh0KSl9Y2F0Y2goZSl7cmV0dXJuIHRoaXMuaGFuZGxlRXJyb3IoZSx0KX19KX1leGVjdXRlKGUpe3JldHVybiBHZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cGF5bWVudDp0fT1lLGk9ZnVuY3Rpb24oZSx0KXt2YXIgaT17fTtmb3IodmFyIG4gaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxuKSYmdC5pbmRleE9mKG4pPDAmJihpW25dPWVbbl0pO2lmKG51bGwhPWUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPTA7Zm9yKG49T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtyPG4ubGVuZ3RoO3IrKyl0LmluZGV4T2YobltyXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsbltyXSkmJihpW25bcl1dPWVbbltyXV0pfXJldHVybiBpfShlLFtcInBheW1lbnRcIl0pO2lmKCF0KXRocm93IG5ldyBSKFtcInBheW1lbnRcIl0pO3RoaXMuaXNIb3N0ZWRGb3JtSW5pdGlhbGl6ZWQmJnRoaXMuYnJhaW50cmVlSG9zdGVkRm9ybS52YWxpZGF0ZSgpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihpKTtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHI9bi5nZXRCaWxsaW5nQWRkcmVzc09yVGhyb3coKSxvPW4uZ2V0T3JkZXJPclRocm93KCkub3JkZXJBbW91bnQ7dHJ5e2NvbnN0IGU9dGhpcy5pc0hvc3RlZEZvcm1Jbml0aWFsaXplZD95aWVsZCB0aGlzLnByZXBhcmVIb3N0ZWRQYXltZW50RGF0YSh0LHIsbyk6eWllbGQgdGhpcy5wcmVwYXJlUGF5bWVudERhdGEodCxyLG8pO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7cGF5bWVudERhdGE6ZX0pKX1jYXRjaChlKXtyZXR1cm4gdGhpcy5wcm9jZXNzQWRkaXRpb25hbEFjdGlvbihlLHQsbyl9fSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFcpfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBHZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMuaXNIb3N0ZWRGb3JtSW5pdGlhbGl6ZWQ9ITEseWllbGQgUHJvbWlzZS5hbGwoW3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRlYXJkb3duKCksdGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtLmRlaW5pdGlhbGl6ZSgpXSksUHJvbWlzZS5yZXNvbHZlKCl9KX1oYW5kbGVFcnJvcihlLHQpe2lmKHBlKGUpKXtpZighKHQmJnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmlzUGF5bWVudE1ldGhvZEluaXRpYWxpemVkKHttZXRob2RJZDp0fSl8fFwiSE9TVEVEX0ZJRUxEU19JTlZBTElEX0ZJRUxEX1NFTEVDVE9SXCIhPT1lLmNvZGUpKXJldHVybjt0aHJvdyBuZXcgJChlLm1lc3NhZ2UpfXRocm93IGV9cHJlcGFyZVBheW1lbnREYXRhKGUsdCxpKXtyZXR1cm4gR2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnREYXRhOm59PWUscj17ZGV2aWNlU2Vzc2lvbklkOnRoaXMuZGV2aWNlU2Vzc2lvbklkfTtpZih0aGlzLmlzU3VibWl0dGluZ1dpdGhTdG9yZWRDYXJkKGUpKXJldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sciksbik7Y29uc3R7c2hvdWxkU2F2ZUluc3RydW1lbnQ6bz0hMSxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OmE9ITF9PXEobik/bjp7fSx7bm9uY2U6c309dGhpcy5zaG91bGRQZXJmb3JtM0RTVmVyaWZpY2F0aW9uKGUpP3lpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnZlcmlmeUNhcmQoZSx0LGkpOnlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRva2VuaXplQ2FyZChlLHQpO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse25vbmNlOnMsc2hvdWxkU2F2ZUluc3RydW1lbnQ6byxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OmF9KX0pfXByZXBhcmVIb3N0ZWRQYXltZW50RGF0YShlLHQsaSl7cmV0dXJuIEdlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50RGF0YTpufT1lLHI9e2RldmljZVNlc3Npb25JZDp0aGlzLmRldmljZVNlc3Npb25JZH07aWYodGhpcy5pc1N1Ym1pdHRpbmdXaXRoU3RvcmVkQ2FyZChlKSl7Y29uc3R7bm9uY2U6ZX09eWllbGQgdGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtLnRva2VuaXplRm9yU3RvcmVkQ2FyZFZlcmlmaWNhdGlvbigpO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSxuKSx7bm9uY2U6ZX0pfWNvbnN0e3Nob3VsZFNhdmVJbnN0cnVtZW50Om89ITEsc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDphPSExfT1xKG4pP246e30se25vbmNlOnN9PXRoaXMuc2hvdWxkUGVyZm9ybTNEU1ZlcmlmaWNhdGlvbihlKT95aWVsZCB0aGlzLnZlcmlmeUNhcmRXaXRoSG9zdGVkRm9ybSh0LGkpOnlpZWxkIHRoaXMuYnJhaW50cmVlSG9zdGVkRm9ybS50b2tlbml6ZSh0KTtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHIpLHtzaG91bGRTYXZlSW5zdHJ1bWVudDpvLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6YSxub25jZTpzfSl9KX12ZXJpZnlDYXJkV2l0aEhvc3RlZEZvcm0oZSx0KXtyZXR1cm4gR2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9eWllbGQgdGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtLnRva2VuaXplKGUpO3JldHVybiB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5jaGFsbGVuZ2UzRFNWZXJpZmljYXRpb24oaSx0KX0pfXByb2Nlc3NBZGRpdGlvbmFsQWN0aW9uKGUsdCxpKXtyZXR1cm4gR2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCEoZT0+XCJvYmplY3RcIj09dHlwZW9mIGUmJm51bGwhPT1lJiZcImJvZHlcImluIGUpKGUpfHwhZChlLmJvZHkuZXJyb3JzLHtjb2RlOlwidGhyZWVfZF9zZWN1cmVfcmVxdWlyZWRcIn0pKXJldHVybiB0aGlzLmhhbmRsZUVycm9yKGUpO3RyeXtjb25zdHtwYXllcl9hdXRoX3JlcXVlc3Q6bn09ZnVuY3Rpb24oZSl7cmV0dXJuXCJvYmplY3RcIj09dHlwZW9mIGUmJm51bGwhPT1lJiZcIm5hbWVcImluIGUmJlwiYm9keVwiaW4gZSYmXCJzdGF0dXNcImluIGUuYm9keSYmXCJ0aHJlZV9kc19yZXN1bHRcImluIGUuYm9keSYmXCJwYXllcl9hdXRoX3JlcXVlc3RcImluIGUuYm9keS50aHJlZV9kc19yZXN1bHQmJlwiZXJyb3JzXCJpbiBlLmJvZHl9KGUpJiZlLmJvZHkudGhyZWVfZHNfcmVzdWx0fHx7fSx7cGF5bWVudERhdGE6cn09dCxvPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO2lmKCFyfHwhSChyKSl0aHJvdyBuZXcgUihbXCJpbnN0cnVtZW50SWRcIl0pO2NvbnN0IGE9by5nZXRDYXJkSW5zdHJ1bWVudE9yVGhyb3coci5pbnN0cnVtZW50SWQpLHtub25jZTpzfT15aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5jaGFsbGVuZ2UzRFNWZXJpZmljYXRpb24oe25vbmNlOm58fFwiXCIsYmluOmEuaWlufSxpKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse3BheW1lbnREYXRhOntkZXZpY2VTZXNzaW9uSWQ6dGhpcy5kZXZpY2VTZXNzaW9uSWQsbm9uY2U6c319KSl9Y2F0Y2goZSl7cmV0dXJuIHRoaXMuaGFuZGxlRXJyb3IoZSl9fSl9aXNIb3N0ZWRQYXltZW50Rm9ybUVuYWJsZWQoZSx0KXtyZXR1cm4hIWUmJiEwPT09dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSx0KS5jb25maWcuaXNIb3N0ZWRGb3JtRW5hYmxlZH1pc1N1Ym1pdHRpbmdXaXRoU3RvcmVkQ2FyZChlKXtyZXR1cm4hKCFlLnBheW1lbnREYXRhfHwhSChlLnBheW1lbnREYXRhKSl9c2hvdWxkUGVyZm9ybTNEU1ZlcmlmaWNhdGlvbihlKXtyZXR1cm4hKCF0aGlzLmlzM2RzRW5hYmxlZHx8dGhpcy5pc1N1Ym1pdHRpbmdXaXRoU3RvcmVkQ2FyZChlKSl9c2hvdWxkSW5pdGlhbGl6ZUJyYWludHJlZUZhc3RsYW5lKCl7dmFyIGU7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50UHJvdmlkZXJDdXN0b21lck9yVGhyb3coKSxpPURlKHQpP3Q6e307cmV0dXJuKG51bGw9PT0oZT10aGlzLnBheW1lbnRNZXRob2QpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLmluaXRpYWxpemF0aW9uRGF0YS5pc0FjY2VsZXJhdGVkQ2hlY2tvdXRFbmFibGVkKSYmIShudWxsPT1pP3ZvaWQgMDppLmF1dGhlbnRpY2F0aW9uU3RhdGUpfWluaXRpYWxpemVCcmFpbnRyZWVGYXN0bGFuZU9yVGhyb3coZSl7cmV0dXJuIEdlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLGk9dC5nZXRDYXJ0T3JUaHJvdygpLG49dC5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKSx7Y2xpZW50VG9rZW46cixjb25maWc6b309bjtpZighcil0aHJvdyBuZXcgVShqLk1pc3NpbmdQYXltZW50TWV0aG9kKTt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKHIsdGhpcy50aHJlZURTZWN1cmUpLHlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldEJyYWludHJlZUZhc3RsYW5lKGkuaWQsby50ZXN0TW9kZSl9KX19ZnVuY3Rpb24gSmUoZSl7cmV0dXJuXCJjYXJkTnVtYmVyXCJpbiBlfWZ1bmN0aW9uIEtlKGUpe2lmKCFEKGUpKXJldHVybiExO2NvbnN0e2RldGFpbHM6dH09ZTtyZXR1cm4gdm9pZCAwPT09dHx8XCJvYmplY3RcIj09dHlwZW9mIHQmJm51bGwhPT10JiZ2b2lkIDA9PT10LmludmFsaWRGaWVsZEtleXN8fChpPXQsQXJyYXkuaXNBcnJheShpKSYmaS5ldmVyeShlPT5cInN0cmluZ1wiPT10eXBlb2YgZSkpO3ZhciBpfXZhciBYZSxRZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTshZnVuY3Rpb24oZSl7ZVtlLkNyZWRpdENhcmQ9MF09XCJDcmVkaXRDYXJkXCIsZVtlLlN0b3JlZENhcmRWZXJpZmljYXRpb249MV09XCJTdG9yZWRDYXJkVmVyaWZpY2F0aW9uXCJ9KFhlfHwoWGU9e30pKTtjbGFzcyBaZXtjb25zdHJ1Y3RvcihlLHQpe3RoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyPWUsdGhpcy5icmFpbnRyZWVTREtWZXJzaW9uTWFuYWdlcj10LHRoaXMuaXNJbml0aWFsaXplZEhvc3RlZEZvcm09ITEsdGhpcy5oYW5kbGVCbHVyPWU9Pnt2YXIgdCxpO251bGw9PT0oaT1udWxsPT09KHQ9dGhpcy5mb3JtT3B0aW9ucyl8fHZvaWQgMD09PXQ/dm9pZCAwOnQub25CbHVyKXx8dm9pZCAwPT09aXx8aS5jYWxsKHQse2ZpZWxkVHlwZTp0aGlzLm1hcEZpZWxkVHlwZShlLmVtaXR0ZWRCeSksZXJyb3JzOnRoaXMubWFwRXJyb3JzKGUuZmllbGRzKX0pfSx0aGlzLmhhbmRsZUZvY3VzPWU9Pnt2YXIgdCxpO251bGw9PT0oaT1udWxsPT09KHQ9dGhpcy5mb3JtT3B0aW9ucyl8fHZvaWQgMD09PXQ/dm9pZCAwOnQub25Gb2N1cyl8fHZvaWQgMD09PWl8fGkuY2FsbCh0LHtmaWVsZFR5cGU6dGhpcy5tYXBGaWVsZFR5cGUoZS5lbWl0dGVkQnkpfSl9LHRoaXMuaGFuZGxlQ2FyZFR5cGVDaGFuZ2U9ZT0+e3ZhciB0LGk7Y29uc3Qgbj0xPT09ZS5jYXJkcy5sZW5ndGg/ZS5jYXJkc1swXS50eXBlLnJlcGxhY2UoL15tYXN0ZXItY2FyZCQvLFwibWFzdGVyY2FyZFwiKTp2b2lkIDA7bnVsbD09PShpPW51bGw9PT0odD10aGlzLmZvcm1PcHRpb25zKXx8dm9pZCAwPT09dD92b2lkIDA6dC5vbkNhcmRUeXBlQ2hhbmdlKXx8dm9pZCAwPT09aXx8aS5jYWxsKHQse2NhcmRUeXBlOm59KX0sdGhpcy5oYW5kbGVJbnB1dFN1Ym1pdFJlcXVlc3Q9ZT0+e3ZhciB0LGk7bnVsbD09PShpPW51bGw9PT0odD10aGlzLmZvcm1PcHRpb25zKXx8dm9pZCAwPT09dD92b2lkIDA6dC5vbkVudGVyKXx8dm9pZCAwPT09aXx8aS5jYWxsKHQse2ZpZWxkVHlwZTp0aGlzLm1hcEZpZWxkVHlwZShlLmVtaXR0ZWRCeSl9KX0sdGhpcy5oYW5kbGVWYWxpZGl0eUNoYW5nZT1lPT57dmFyIHQsaTtudWxsPT09KGk9bnVsbD09PSh0PXRoaXMuZm9ybU9wdGlvbnMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0Lm9uVmFsaWRhdGUpfHx2b2lkIDA9PT1pfHxpLmNhbGwodCx7aXNWYWxpZDp0aGlzLmlzVmFsaWRGb3JtKGUpLGVycm9yczp0aGlzLm1hcFZhbGlkYXRpb25FcnJvcnMoZS5maWVsZHMpfSl9fWluaXRpYWxpemUoZSx0LG4pe3ZhciByLG8sYSxzLGQ7cmV0dXJuIFFlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0aGlzLmNsaWVudFRva2VuPW4sdGhpcy5mb3JtT3B0aW9ucz1lLHRoaXMudHlwZT1KZShlLmZpZWxkcyk/WGUuQ3JlZGl0Q2FyZDpYZS5TdG9yZWRDYXJkVmVyaWZpY2F0aW9uO2NvbnN0IGw9dGhpcy5tYXBGaWVsZE9wdGlvbnMoZS5maWVsZHMsdCk7aShsKT90aGlzLmlzSW5pdGlhbGl6ZWRIb3N0ZWRGb3JtPSExOih0aGlzLmNhcmRGaWVsZHM9eWllbGQgdGhpcy5jcmVhdGVIb3N0ZWRGaWVsZHMoe2ZpZWxkczpsLHN0eWxlczplLnN0eWxlcyYmdGhpcy5tYXBTdHlsZU9wdGlvbnMoZS5zdHlsZXMpfSksbnVsbD09PShyPXRoaXMuY2FyZEZpZWxkcyl8fHZvaWQgMD09PXJ8fHIub24oXCJibHVyXCIsdGhpcy5oYW5kbGVCbHVyKSxudWxsPT09KG89dGhpcy5jYXJkRmllbGRzKXx8dm9pZCAwPT09b3x8by5vbihcImZvY3VzXCIsdGhpcy5oYW5kbGVGb2N1cyksbnVsbD09PShhPXRoaXMuY2FyZEZpZWxkcyl8fHZvaWQgMD09PWF8fGEub24oXCJjYXJkVHlwZUNoYW5nZVwiLHRoaXMuaGFuZGxlQ2FyZFR5cGVDaGFuZ2UpLG51bGw9PT0ocz10aGlzLmNhcmRGaWVsZHMpfHx2b2lkIDA9PT1zfHxzLm9uKFwidmFsaWRpdHlDaGFuZ2VcIix0aGlzLmhhbmRsZVZhbGlkaXR5Q2hhbmdlKSxudWxsPT09KGQ9dGhpcy5jYXJkRmllbGRzKXx8dm9pZCAwPT09ZHx8ZC5vbihcImlucHV0U3VibWl0UmVxdWVzdFwiLHRoaXMuaGFuZGxlSW5wdXRTdWJtaXRSZXF1ZXN0KSx0aGlzLmlzSW5pdGlhbGl6ZWRIb3N0ZWRGb3JtPSEwKX0pfWlzSW5pdGlhbGl6ZWQoKXtyZXR1cm4hIXRoaXMuaXNJbml0aWFsaXplZEhvc3RlZEZvcm19ZGVpbml0aWFsaXplKCl7dmFyIGU7cmV0dXJuIFFlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0aGlzLmlzSW5pdGlhbGl6ZWRIb3N0ZWRGb3JtJiYodGhpcy5pc0luaXRpYWxpemVkSG9zdGVkRm9ybT0hMSx5aWVsZCBudWxsPT09KGU9dGhpcy5jYXJkRmllbGRzKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS50ZWFyZG93bigpKX0pfXZhbGlkYXRlKCl7aWYoIXRoaXMuY2FyZEZpZWxkcyl0aHJvdyBuZXcgTShDLlBheW1lbnROb3RJbml0aWFsaXplZCk7Y29uc3QgZT10aGlzLmNhcmRGaWVsZHMuZ2V0U3RhdGUoKTtpZighdGhpcy5pc1ZhbGlkRm9ybShlKSl7dGhpcy5oYW5kbGVWYWxpZGl0eUNoYW5nZShlKTtjb25zdCB0PXRoaXMubWFwVmFsaWRhdGlvbkVycm9ycyhlLmZpZWxkcyk7dGhyb3cgbmV3IFgodCl9fXRva2VuaXplKGUpe3ZhciB0LGksbixvLGE7cmV0dXJuIFFlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5jYXJkRmllbGRzKXRocm93IG5ldyBNKEMuUGF5bWVudE5vdEluaXRpYWxpemVkKTt0cnl7Y29uc3Qgbz15aWVsZCB0aGlzLmNhcmRGaWVsZHMudG9rZW5pemUocyh7YmlsbGluZ0FkZHJlc3M6ZSYmdGhpcy5tYXBCaWxsaW5nQWRkcmVzcyhlKX0scikpO3JldHVybiBudWxsPT09KGk9bnVsbD09PSh0PXRoaXMuZm9ybU9wdGlvbnMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0Lm9uVmFsaWRhdGUpfHx2b2lkIDA9PT1pfHxpLmNhbGwodCx7aXNWYWxpZDohMCxlcnJvcnM6e319KSx7bm9uY2U6by5ub25jZSxiaW46bnVsbD09PShuPW8uZGV0YWlscyl8fHZvaWQgMD09PW4/dm9pZCAwOm4uYmlufX1jYXRjaChlKXtpZihLZShlKSl7Y29uc3QgdD10aGlzLm1hcFRva2VuaXplRXJyb3IoZSk7aWYodCl0aHJvdyBudWxsPT09KGE9bnVsbD09PShvPXRoaXMuZm9ybU9wdGlvbnMpfHx2b2lkIDA9PT1vP3ZvaWQgMDpvLm9uVmFsaWRhdGUpfHx2b2lkIDA9PT1hfHxhLmNhbGwobyx7aXNWYWxpZDohMSxlcnJvcnM6dH0pLG5ldyBYKHQpfXRocm93IGV9fSl9dG9rZW5pemVGb3JTdG9yZWRDYXJkVmVyaWZpY2F0aW9uKCl7dmFyIGUsdCxpLG4scjtyZXR1cm4gUWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLmNhcmRGaWVsZHMpdGhyb3cgbmV3IE0oQy5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO3RyeXtjb25zdCBuPXlpZWxkIHRoaXMuY2FyZEZpZWxkcy50b2tlbml6ZSgpO3JldHVybiBudWxsPT09KHQ9bnVsbD09PShlPXRoaXMuZm9ybU9wdGlvbnMpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLm9uVmFsaWRhdGUpfHx2b2lkIDA9PT10fHx0LmNhbGwoZSx7aXNWYWxpZDohMCxlcnJvcnM6e319KSx7bm9uY2U6bi5ub25jZSxiaW46bnVsbD09PShpPW4uZGV0YWlscyl8fHZvaWQgMD09PWk/dm9pZCAwOmkuYmlufX1jYXRjaChlKXtpZihLZShlKSl7Y29uc3QgdD10aGlzLm1hcFRva2VuaXplRXJyb3IoZSwhMCk7aWYodCl0aHJvdyBudWxsPT09KHI9bnVsbD09PShuPXRoaXMuZm9ybU9wdGlvbnMpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLm9uVmFsaWRhdGUpfHx2b2lkIDA9PT1yfHxyLmNhbGwobix7aXNWYWxpZDohMSxlcnJvcnM6dH0pLG5ldyBYKHQpfXRocm93IGV9fSl9Y3JlYXRlSG9zdGVkRmllbGRzKGUpe3JldHVybiBRZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD15aWVsZCB0aGlzLmdldENsaWVudCgpLGk9eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZEhvc3RlZEZpZWxkcygpLG49dGhpcy5icmFpbnRyZWVTREtWZXJzaW9uTWFuYWdlci5nZXRTREtWZXJzaW9uKCk9PT12P09iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7cHJldmVudEN1cnNvckp1bXBzOiEwfSk6ZTtyZXR1cm4gaS5jcmVhdGUoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LG4pLHtjbGllbnQ6dH0pKX0pfWdldENsaWVudCgpe3JldHVybiBRZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuY2xpZW50VG9rZW4pdGhyb3cgbmV3IE0oQy5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO2lmKCF0aGlzLmNsaWVudCl7Y29uc3QgZT15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkQ2xpZW50KCk7dGhpcy5jbGllbnQ9ZS5jcmVhdGUoe2F1dGhvcml6YXRpb246dGhpcy5jbGllbnRUb2tlbn0pfXJldHVybiB0aGlzLmNsaWVudH0pfW1hcEJpbGxpbmdBZGRyZXNzKGUpe3JldHVybntjb3VudHJ5TmFtZTplLmNvdW50cnkscG9zdGFsQ29kZTplLnBvc3RhbENvZGUsc3RyZWV0QWRkcmVzczplLmFkZHJlc3MyP2Ake2UuYWRkcmVzczF9ICR7ZS5hZGRyZXNzMn1gOmUuYWRkcmVzczF9fW1hcEZpZWxkT3B0aW9ucyhlLHQpe2lmKEplKGUpKXtjb25zdCBpPXt9O3JldHVybiBudWxsPT10fHx0LmZvckVhY2goZT0+eyhlPT5PYmplY3QudmFsdWVzKFQpLmluY2x1ZGVzKGUpKShlKSYmKGlbZV09ITEpfSkscyh7bnVtYmVyOk9iamVjdC5hc3NpZ24oe2NvbnRhaW5lcjpgIyR7ZS5jYXJkTnVtYmVyLmNvbnRhaW5lcklkfWAscGxhY2Vob2xkZXI6ZS5jYXJkTnVtYmVyLnBsYWNlaG9sZGVyLGludGVybmFsTGFiZWw6ZS5jYXJkTnVtYmVyLmFjY2Vzc2liaWxpdHlMYWJlbH0sT2JqZWN0LmtleXMoaSkubGVuZ3RoPjA/e3N1cHBvcnRlZENhcmRCcmFuZHM6aX06e30pLGV4cGlyYXRpb25EYXRlOntjb250YWluZXI6YCMke2UuY2FyZEV4cGlyeS5jb250YWluZXJJZH1gLHBsYWNlaG9sZGVyOmUuY2FyZEV4cGlyeS5wbGFjZWhvbGRlcixpbnRlcm5hbExhYmVsOmUuY2FyZEV4cGlyeS5hY2Nlc3NpYmlsaXR5TGFiZWx9LGN2djplLmNhcmRDb2RlJiZ7Y29udGFpbmVyOmAjJHtlLmNhcmRDb2RlLmNvbnRhaW5lcklkfWAscGxhY2Vob2xkZXI6ZS5jYXJkQ29kZS5wbGFjZWhvbGRlcixpbnRlcm5hbExhYmVsOmUuY2FyZENvZGUuYWNjZXNzaWJpbGl0eUxhYmVsfSxjYXJkaG9sZGVyTmFtZTp7Y29udGFpbmVyOmAjJHtlLmNhcmROYW1lLmNvbnRhaW5lcklkfWAscGxhY2Vob2xkZXI6ZS5jYXJkTmFtZS5wbGFjZWhvbGRlcixpbnRlcm5hbExhYmVsOmUuY2FyZE5hbWUuYWNjZXNzaWJpbGl0eUxhYmVsfX0scil9cmV0dXJuIHMoe251bWJlcjplLmNhcmROdW1iZXJWZXJpZmljYXRpb24mJntjb250YWluZXI6YCMke2UuY2FyZE51bWJlclZlcmlmaWNhdGlvbi5jb250YWluZXJJZH1gLHBsYWNlaG9sZGVyOmUuY2FyZE51bWJlclZlcmlmaWNhdGlvbi5wbGFjZWhvbGRlcn0sY3Z2OmUuY2FyZENvZGVWZXJpZmljYXRpb24mJntjb250YWluZXI6YCMke2UuY2FyZENvZGVWZXJpZmljYXRpb24uY29udGFpbmVySWR9YCxwbGFjZWhvbGRlcjplLmNhcmRDb2RlVmVyaWZpY2F0aW9uLnBsYWNlaG9sZGVyfX0scil9bWFwU3R5bGVPcHRpb25zKGUpe2NvbnN0IHQ9KGU9e30pPT5zKHtjb2xvcjplLmNvbG9yLFwiZm9udC1mYW1pbHlcIjplLmZvbnRGYW1pbHksXCJmb250LXNpemVcIjplLmZvbnRTaXplLFwiZm9udC13ZWlnaHRcIjplLmZvbnRXZWlnaHR9LHIpO3JldHVybntpbnB1dDp0KGUuZGVmYXVsdCksXCIuaW52YWxpZFwiOnQoZS5lcnJvciksXCI6Zm9jdXNcIjp0KGUuZm9jdXMpfX1tYXBGaWVsZFR5cGUoZSl7c3dpdGNoKGUpe2Nhc2VcIm51bWJlclwiOnJldHVybiB0aGlzLnR5cGU9PT1YZS5TdG9yZWRDYXJkVmVyaWZpY2F0aW9uP20uQ2FyZE51bWJlclZlcmlmaWNhdGlvbjptLkNhcmROdW1iZXI7Y2FzZVwiZXhwaXJhdGlvbkRhdGVcIjpyZXR1cm4gbS5DYXJkRXhwaXJ5O2Nhc2VcImN2dlwiOnJldHVybiB0aGlzLnR5cGU9PT1YZS5TdG9yZWRDYXJkVmVyaWZpY2F0aW9uP20uQ2FyZENvZGVWZXJpZmljYXRpb246bS5DYXJkQ29kZTtjYXNlXCJjYXJkaG9sZGVyTmFtZVwiOnJldHVybiBtLkNhcmROYW1lO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCBmaWVsZCB0eXBlXCIpfX1tYXBFcnJvcnMoZSl7Y29uc3QgdD17fTtpZihlKWZvcihjb25zdFtpLG5db2YgT2JqZWN0LmVudHJpZXMoZSkpaWYobiYmdGhpcy5pc1ZhbGlkUGFyYW0oaSkpe2NvbnN0e2lzVmFsaWQ6ZSxpc0VtcHR5OnIsaXNQb3RlbnRpYWxseVZhbGlkOm99PW47dFtpXT17aXNWYWxpZDplLGlzRW1wdHk6cixpc1BvdGVudGlhbGx5VmFsaWQ6b319cmV0dXJuIHR9bWFwVmFsaWRhdGlvbkVycm9ycyhlKXtyZXR1cm4gT2JqZWN0LmtleXMoZSkucmVkdWNlKCh0LGkpPT57dmFyIG47cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7W3RoaXMubWFwRmllbGRUeXBlKGkpXToobnVsbD09PShuPWVbaV0pfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmlzVmFsaWQpP3ZvaWQgMDpbdGhpcy5jcmVhdGVJbnZhbGlkRXJyb3IodGhpcy5tYXBGaWVsZFR5cGUoaSkpXX0pfSx7fSl9bWFwVG9rZW5pemVFcnJvcihlLHQ9ITEpe3ZhciBpLG47aWYoXCJIT1NURURfRklFTERTX0ZJRUxEU19FTVBUWVwiPT09ZS5jb2RlKXtjb25zdCBlPVt0aGlzLmNyZWF0ZVJlcXVpcmVkRXJyb3IodGhpcy5tYXBGaWVsZFR5cGUoXCJjdnZcIikpXTtyZXR1cm4gdD97W3RoaXMubWFwRmllbGRUeXBlKFwiY3Z2XCIpXTplfTp7W3RoaXMubWFwRmllbGRUeXBlKFwiY3Z2XCIpXTplLFt0aGlzLm1hcEZpZWxkVHlwZShcImV4cGlyYXRpb25EYXRlXCIpXTpbdGhpcy5jcmVhdGVSZXF1aXJlZEVycm9yKHRoaXMubWFwRmllbGRUeXBlKFwiZXhwaXJhdGlvbkRhdGVcIikpXSxbdGhpcy5tYXBGaWVsZFR5cGUoXCJudW1iZXJcIildOlt0aGlzLmNyZWF0ZVJlcXVpcmVkRXJyb3IodGhpcy5tYXBGaWVsZFR5cGUoXCJudW1iZXJcIikpXSxbdGhpcy5tYXBGaWVsZFR5cGUoXCJjYXJkaG9sZGVyTmFtZVwiKV06W3RoaXMuY3JlYXRlUmVxdWlyZWRFcnJvcih0aGlzLm1hcEZpZWxkVHlwZShcImNhcmRob2xkZXJOYW1lXCIpKV19fXJldHVybiBudWxsPT09KG49bnVsbD09PShpPWUuZGV0YWlscyl8fHZvaWQgMD09PWk/dm9pZCAwOmkuaW52YWxpZEZpZWxkS2V5cyl8fHZvaWQgMD09PW4/dm9pZCAwOm4ucmVkdWNlKChlLHQpPT57Y29uc3QgaT10aGlzLm1hcEZpZWxkVHlwZSh0KTtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHtbaV06W3RoaXMuY3JlYXRlSW52YWxpZEVycm9yKGkpXX0pfSx7fSl9Y3JlYXRlUmVxdWlyZWRFcnJvcihlKXt2YXIgdDtyZXR1cm57ZmllbGRUeXBlOmUsbWVzc2FnZTpudWxsIT09KHQ9e1ttLkNhcmRDb2RlXTpcIkNWViBpcyByZXF1aXJlZFwiLFttLkNhcmRDb2RlVmVyaWZpY2F0aW9uXTpcIkNWViBpcyByZXF1aXJlZFwiLFttLkNhcmROdW1iZXJdOlwiQ3JlZGl0IGNhcmQgbnVtYmVyIGlzIHJlcXVpcmVkXCIsW20uQ2FyZE51bWJlclZlcmlmaWNhdGlvbl06XCJDcmVkaXQgY2FyZCBudW1iZXIgaXMgcmVxdWlyZWRcIixbbS5DYXJkRXhwaXJ5XTpcIkV4cGlyYXRpb24gZGF0ZSBpcyByZXF1aXJlZFwiLFttLkNhcmROYW1lXTpcIkZ1bGwgbmFtZSBpcyByZXF1aXJlZFwifVtlXSkmJnZvaWQgMCE9PXQ/dDpcIkZpZWxkIGlzIHJlcXVpcmVkXCIsdHlwZTpcInJlcXVpcmVkXCJ9fWNyZWF0ZUludmFsaWRFcnJvcihlKXt2YXIgdCxpLG4scjtjb25zdCBvPXtbbS5DYXJkQ29kZV06e21lc3NhZ2U6XCJJbnZhbGlkIGNhcmQgY29kZVwiLHR5cGU6XCJpbnZhbGlkX2NhcmRfY29kZVwifSxbbS5DYXJkQ29kZVZlcmlmaWNhdGlvbl06e21lc3NhZ2U6XCJJbnZhbGlkIGNhcmQgY29kZVwiLHR5cGU6XCJpbnZhbGlkX2NhcmRfY29kZVwifSxbbS5DYXJkTnVtYmVyXTp7bWVzc2FnZTpcIkludmFsaWQgY2FyZCBudW1iZXJcIix0eXBlOlwiaW52YWxpZF9jYXJkX251bWJlclwifSxbbS5DYXJkTnVtYmVyVmVyaWZpY2F0aW9uXTp7bWVzc2FnZTpcIkludmFsaWQgY2FyZCBudW1iZXJcIix0eXBlOlwiaW52YWxpZF9jYXJkX251bWJlclwifSxbbS5DYXJkRXhwaXJ5XTp7bWVzc2FnZTpcIkludmFsaWQgY2FyZCBleHBpcnlcIix0eXBlOlwiaW52YWxpZF9jYXJkX2V4cGlyeVwifSxbbS5DYXJkTmFtZV06e21lc3NhZ2U6XCJJbnZhbGlkIGNhcmQgbmFtZVwiLHR5cGU6XCJpbnZhbGlkX2NhcmRfbmFtZVwifX07cmV0dXJue2ZpZWxkVHlwZTplLG1lc3NhZ2U6bnVsbCE9PShpPW51bGw9PT0odD1vW2VdKXx8dm9pZCAwPT09dD92b2lkIDA6dC5tZXNzYWdlKSYmdm9pZCAwIT09aT9pOlwiSW52YWxpZCBmaWVsZFwiLHR5cGU6bnVsbCE9PShyPW51bGw9PT0obj1vW2VdKXx8dm9pZCAwPT09bj92b2lkIDA6bi50eXBlKSYmdm9pZCAwIT09cj9yOlwiaW52YWxpZFwifX1pc1ZhbGlkRm9ybShlKXtyZXR1cm4gT2JqZWN0LmtleXMoZS5maWVsZHMpLmV2ZXJ5KHQ9Pnt2YXIgaTtyZXR1cm4gbnVsbD09PShpPWUuZmllbGRzW3RdKXx8dm9pZCAwPT09aT92b2lkIDA6aS5pc1ZhbGlkfSl9aXNWYWxpZFBhcmFtKGUpe3JldHVybltcIm51bWJlclwiLFwiY3Z2XCIsXCJleHBpcmF0aW9uRGF0ZVwiLFwicG9zdGFsQ29kZVwiLFwiY2FyZGhvbGRlck5hbWVcIixcImNhcmRUeXBlXCJdLmluY2x1ZGVzKGUpfX1jb25zdCBldD1MKHQ9Pntjb25zdCBpPXdpbmRvdyxuPW5ldyBGKHQpLHI9bmV3IHooZSgpLGksbiksbz1uZXcgZGUocixpKSxhPW5ldyBaZShyLG4pO3JldHVybiBuZXcgWWUodCxvLGEpfSxbe2lkOlwiYnJhaW50cmVlXCJ9XSk7dmFyIHR0PWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIGl0e2NvbnN0cnVjdG9yKGUsdCxpLG4pe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuZm9ybVBvc3Rlcj10LHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlPWksdGhpcy5icmFpbnRyZWVIb3N0V2luZG93PW59aW5pdGlhbGl6ZShlKXtyZXR1cm4gdHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2JyYWludHJlZXBheXBhbDp0LG1ldGhvZElkOml9PWUse2NvbnRhaW5lcjpuLG9uRXJyb3I6cn09dHx8e307aWYoIWkpdGhyb3cgbmV3IFYoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQpdGhyb3cgbmV3IFYoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVlcGF5cGFsXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXBheXBhbC5jb250YWluZXJcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7bGV0IG8sYT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTt0cnl7aWYobz1hLmdldFBheW1lbnRNZXRob2RPclRocm93KGkpLCFvLmNsaWVudFRva2VuKXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRUb2tlbil9Y2F0Y2goZSl7YT15aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSksbz1hLmdldFBheW1lbnRNZXRob2RPclRocm93KGkpfWNvbnN0e2NsaWVudFRva2VuOnMsY29uZmlnOmQsaW5pdGlhbGl6YXRpb25EYXRhOmx9PW8se3BheW1lbnRCdXR0b25TdHlsZXM6Y309bHx8e30se2NoZWNrb3V0VG9wQnV0dG9uU3R5bGVzOnV9PWN8fHt9O2lmKCFzfHwhbCl0aHJvdyBuZXcgVShqLk1pc3NpbmdQYXltZW50TWV0aG9kKTtjb25zdCBoPXtjdXJyZW5jeTphLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZSxpbnRlbnQ6bC5pbnRlbnQsaXNDcmVkaXRFbmFibGVkOmwuaXNDcmVkaXRFbmFibGVkLGNvbW1pdDohMX07dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuaW5pdGlhbGl6ZShzKSx5aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRQYXlwYWxDaGVja291dChoLGU9Pnt0aGlzLnJlbmRlclBheVBhbEJ1dHRvbihlLHQsaSxCb29sZWFuKGQudGVzdE1vZGUpLHUpfSxlPT50aGlzLmhhbmRsZUVycm9yKGUsbixyKSl9KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gdHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRlYXJkb3duKCl9KX1zaWduSW4oZSx0KXtyZXR1cm4gdHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zaWduSW5DdXN0b21lcihlLHQpfSl9c2lnbk91dChlKXtyZXR1cm4gdHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zaWduT3V0Q3VzdG9tZXIoZSl9KX1leGVjdXRlUGF5bWVudE1ldGhvZENoZWNrb3V0KGUpe3ZhciB0O3JldHVybiBudWxsPT09KHQ9bnVsbD09ZT92b2lkIDA6ZS5jb250aW51ZVdpdGhDaGVja291dENhbGxiYWNrKXx8dm9pZCAwPT09dHx8dC5jYWxsKGUpLFByb21pc2UucmVzb2x2ZSgpfXJlbmRlclBheVBhbEJ1dHRvbihlLHQsaSxuLHIpe2NvbnN0e2NvbnRhaW5lcjphLG9uQ2xpY2s6cz1vfT10LHtwYXlwYWw6ZH09dGhpcy5icmFpbnRyZWVIb3N0V2luZG93LGw9bnVsbD09ZD92b2lkIDA6ZC5GVU5ESU5HLlBBWVBBTDtpZihkJiZsKXtjb25zdCBvPWQuQnV0dG9ucyh7ZW52OnRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldEJyYWludHJlZUVudihuKSxmdW5kaW5nU291cmNlOmwsc3R5bGU6T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHIpLHtoZWlnaHQ6NDB9KSxjcmVhdGVPcmRlcjooKT0+dGhpcy5zZXR1cFBheW1lbnQoZSx0LGkpLG9uQXBwcm92ZTpuPT50aGlzLnRva2VuaXplUGF5bWVudChuLGUsaSx0KSxvbkNsaWNrOnN9KTtvLmlzRWxpZ2libGUoKSYmby5yZW5kZXIoYCMke2F9YCl9ZWxzZSB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KGEpfXNldHVwUGF5bWVudChlLHQsaSl7dmFyIG47cmV0dXJuIHR0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWREZWZhdWx0Q2hlY2tvdXQoKTtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHI9dC5nZXRDaGVja291dE9yVGhyb3coKS5vdXRzdGFuZGluZ0JhbGFuY2Usbz10LmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZSxhPXQuZ2V0Q3VzdG9tZXIoKSxzPXQuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSksZD1udWxsPT1hP3ZvaWQgMDphLmFkZHJlc3Nlc1swXSxsPWQ/dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UubWFwVG9CcmFpbnRyZWVTaGlwcGluZ0FkZHJlc3NPdmVycmlkZShkKTp2b2lkIDA7cmV0dXJuIHlpZWxkIGUuY3JlYXRlUGF5bWVudCh7ZmxvdzpcImNoZWNrb3V0XCIsZW5hYmxlU2hpcHBpbmdBZGRyZXNzOiEwLHNoaXBwaW5nQWRkcmVzc0VkaXRhYmxlOiExLHNoaXBwaW5nQWRkcmVzc092ZXJyaWRlOmwsYW1vdW50OnIsY3VycmVuY3k6byxvZmZlckNyZWRpdDohMSxpbnRlbnQ6bnVsbD09PShuPXMuaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09bj92b2lkIDA6bi5pbnRlbnR9KX1jYXRjaChlKXtjb25zdHtjb250YWluZXI6aSxvbkVycm9yOm59PXQ7dGhpcy5oYW5kbGVFcnJvcihlLGksbil9fSl9dG9rZW5pemVQYXltZW50KGUsdCxpLG4pe3JldHVybiB0dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e2NvbnN0e2RldmljZURhdGE6bn09eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0RGF0YUNvbGxlY3Rvcih7cGF5cGFsOiEwfSkscj15aWVsZCB0LnRva2VuaXplUGF5bWVudChlKSx7ZGV0YWlsczpvLG5vbmNlOmF9PXIscz10aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5tYXBUb0xlZ2FjeUJpbGxpbmdBZGRyZXNzKG8pLGQ9dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UubWFwVG9MZWdhY3lTaGlwcGluZ0FkZHJlc3Mobyk7cmV0dXJuIHRoaXMuZm9ybVBvc3Rlci5wb3N0Rm9ybShcIi9jaGVja291dC5waHBcIix7cGF5bWVudF90eXBlOlwicGF5cGFsXCIscHJvdmlkZXI6aSxhY3Rpb246XCJzZXRfZXh0ZXJuYWxfY2hlY2tvdXRcIixub25jZTphLGRldmljZV9kYXRhOm4sYmlsbGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KHMpLHNoaXBwaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkoZCl9KSxyfWNhdGNoKGUpe2NvbnN0e2NvbnRhaW5lcjp0LG9uRXJyb3I6aX09bjt0aGlzLmhhbmRsZUVycm9yKGUsdCxpKX19KX1oYW5kbGVFcnJvcihlLHQsaSl7aWYodGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UucmVtb3ZlRWxlbWVudCh0KSwhaXx8IUQoZSkpdGhyb3cgZTtpKGUpfX1jb25zdCBudD1MKHQ9Pntjb25zdCBpPXdpbmRvdyxuPW5ldyBGKHQpLHI9bmV3IGRlKG5ldyB6KGUoKSxpLG4pLGkpO3JldHVybiBuZXcgaXQodCx1KCkscixpKX0sW3tpZDpcImJyYWludHJlZXBheXBhbFwifV0pO3ZhciBydD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBvdHtjb25zdHJ1Y3RvcihlLHQsaSxuKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmZvcm1Qb3N0ZXI9dCx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT1pLHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdz1ufWluaXRpYWxpemUoZSl7cmV0dXJuIHJ0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWVwYXlwYWxjcmVkaXQ6dCxtZXRob2RJZDppfT1lLHtjb250YWluZXI6bixvbkVycm9yOnJ9PXR8fHt9O2lmKCFpKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCF0KXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXBheXBhbGNyZWRpdFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighbil0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVwYXlwYWxjcmVkaXQuY29udGFpbmVyXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2xldCBvLGE9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCk7dHJ5e2lmKG89YS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSwhby5jbGllbnRUb2tlbil0aHJvdyBuZXcgVShqLk1pc3NpbmdQYXltZW50VG9rZW4pfWNhdGNoKGUpe2E9eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKGkpLG89YS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKX1jb25zdHtjbGllbnRUb2tlbjpzLGNvbmZpZzpkLGluaXRpYWxpemF0aW9uRGF0YTpsfT1vLHtwYXltZW50QnV0dG9uU3R5bGVzOmN9PWx8fHt9LHtjaGVja291dFRvcEJ1dHRvblN0eWxlczp1fT1jfHx7fTtpZighc3x8IWwpdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3QgaD17Y3VycmVuY3k6YS5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGUsaW50ZW50OmwuaW50ZW50LGlzQ3JlZGl0RW5hYmxlZDpsLmlzQ3JlZGl0RW5hYmxlZCxjb21taXQ6ITF9O3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmluaXRpYWxpemUocykseWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5cGFsQ2hlY2tvdXQoaCxlPT57dGhpcy5yZW5kZXJQYXlQYWxCdXR0b24oZSx0LGksQm9vbGVhbihkLnRlc3RNb2RlKSxPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdSkse2hlaWdodDo0MH0pKX0sZT0+dGhpcy5oYW5kbGVFcnJvcihlLG4scikpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIHJ0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS50ZWFyZG93bigpfSl9c2lnbkluKGUsdCl7cmV0dXJuIHJ0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbkluQ3VzdG9tZXIoZSx0KX0pfXNpZ25PdXQoZSl7cmV0dXJuIHJ0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbk91dEN1c3RvbWVyKGUpfSl9ZXhlY3V0ZVBheW1lbnRNZXRob2RDaGVja291dChlKXt2YXIgdDtyZXR1cm4gbnVsbD09PSh0PW51bGw9PWU/dm9pZCAwOmUuY29udGludWVXaXRoQ2hlY2tvdXRDYWxsYmFjayl8fHZvaWQgMD09PXR8fHQuY2FsbChlKSxQcm9taXNlLnJlc29sdmUoKX1yZW5kZXJQYXlQYWxCdXR0b24oZSx0LGksbixyKXtjb25zdHtjb250YWluZXI6YSxvbkNsaWNrOnM9b309dCx7cGF5cGFsOmR9PXRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdztsZXQgbD0hMTtkJiZbZC5GVU5ESU5HLlBBWUxBVEVSLGQuRlVORElORy5DUkVESVRdLmZvckVhY2gobz0+e2lmKCFsKXtjb25zdCBjPWQuQnV0dG9ucyh7ZW52Om4/XCJzYW5kYm94XCI6XCJwcm9kdWN0aW9uXCIsZnVuZGluZ1NvdXJjZTpvLHN0eWxlOnIsY3JlYXRlT3JkZXI6KCk9PnRoaXMuc2V0dXBQYXltZW50KGUsdCxpKSxvbkFwcHJvdmU6bj0+dGhpcy50b2tlbml6ZVBheW1lbnQobixlLGksdCksb25DbGljazpzfSk7Yy5pc0VsaWdpYmxlKCkmJihjLnJlbmRlcihgIyR7YX1gKSxsPSEwKX19KSxkJiZsfHx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KGEpfXNldHVwUGF5bWVudChlLHQsaSl7dmFyIG47cmV0dXJuIHJ0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWREZWZhdWx0Q2hlY2tvdXQoKTtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHI9dC5nZXRDaGVja291dE9yVGhyb3coKS5vdXRzdGFuZGluZ0JhbGFuY2Usbz10LmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZSxhPXQuZ2V0Q3VzdG9tZXIoKSxzPXQuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSksZD1udWxsPT1hP3ZvaWQgMDphLmFkZHJlc3Nlc1swXSxsPWQ/dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UubWFwVG9CcmFpbnRyZWVTaGlwcGluZ0FkZHJlc3NPdmVycmlkZShkKTp2b2lkIDA7cmV0dXJuIHlpZWxkIGUuY3JlYXRlUGF5bWVudCh7ZmxvdzpcImNoZWNrb3V0XCIsZW5hYmxlU2hpcHBpbmdBZGRyZXNzOiEwLHNoaXBwaW5nQWRkcmVzc0VkaXRhYmxlOiExLHNoaXBwaW5nQWRkcmVzc092ZXJyaWRlOmwsYW1vdW50OnIsY3VycmVuY3k6byxvZmZlckNyZWRpdDohMCxpbnRlbnQ6bnVsbD09PShuPXMuaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09bj92b2lkIDA6bi5pbnRlbnR9KX1jYXRjaChlKXtjb25zdHtjb250YWluZXI6aSxvbkVycm9yOm59PXQ7dGhpcy5oYW5kbGVFcnJvcihlLGksbil9fSl9dG9rZW5pemVQYXltZW50KGUsdCxpLG4pe3JldHVybiBydCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e2NvbnN0e2RldmljZURhdGE6bn09eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0RGF0YUNvbGxlY3Rvcih7cGF5cGFsOiEwfSkscj15aWVsZCB0LnRva2VuaXplUGF5bWVudChlKSx7ZGV0YWlsczpvLG5vbmNlOmF9PXIscz10aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5tYXBUb0xlZ2FjeUJpbGxpbmdBZGRyZXNzKG8pLGQ9dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UubWFwVG9MZWdhY3lTaGlwcGluZ0FkZHJlc3Mobyk7cmV0dXJuIHRoaXMuZm9ybVBvc3Rlci5wb3N0Rm9ybShcIi9jaGVja291dC5waHBcIix7cGF5bWVudF90eXBlOlwicGF5cGFsXCIscHJvdmlkZXI6aSxhY3Rpb246XCJzZXRfZXh0ZXJuYWxfY2hlY2tvdXRcIixub25jZTphLGRldmljZV9kYXRhOm4sYmlsbGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KHMpLHNoaXBwaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkoZCl9KSxyfWNhdGNoKGUpe2NvbnN0e2NvbnRhaW5lcjp0LG9uRXJyb3I6aX09bjt0aGlzLmhhbmRsZUVycm9yKGUsdCxpKX19KX1oYW5kbGVFcnJvcihlLHQsaSl7aWYodGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UucmVtb3ZlRWxlbWVudCh0KSwhaXx8IUQoZSkpdGhyb3cgZTtpKGUpfX1jb25zdCBhdD1MKHQ9Pntjb25zdCBpPXdpbmRvdyxuPW5ldyBGKHQpLHI9bmV3IGRlKG5ldyB6KGUoKSxpLG4pLGkpO3JldHVybiBuZXcgb3QodCx1KCkscixpKX0sW3tpZDpcImJyYWludHJlZXBheXBhbGNyZWRpdFwifV0pO3ZhciBzdD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBkdHtjb25zdHJ1Y3RvcihlLHQpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscz10LHRoaXMuaXNBY2NlbGVyYXRlZENoZWNrb3V0RW5hYmxlZD0hMX1pbml0aWFsaXplKHttZXRob2RJZDplLGJyYWludHJlZWZhc3RsYW5lOnR9KXt2YXIgaTtyZXR1cm4gc3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCFlKXRocm93IG5ldyBWKCdVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIFwibWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7Y29uc3Qgbj15aWVsZCB0aGlzLmdldFZhbGlkUGF5bWVudE1ldGhvZE9yVGhyb3coZSkse2lzQWNjZWxlcmF0ZWRDaGVja291dEVuYWJsZWQ6cixpc0Zhc3RsYW5lU3R5bGluZ0VuYWJsZWQ6b309bi5pbml0aWFsaXphdGlvbkRhdGF8fHt9LGE9bz9udWxsPT09KGk9bi5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmZhc3RsYW5lU3R5bGVzOnZvaWQgMDt0aGlzLmlzQWNjZWxlcmF0ZWRDaGVja291dEVuYWJsZWQ9ISFyO3RyeXtpZih0aGlzLmlzQWNjZWxlcmF0ZWRDaGVja291dEVuYWJsZWQpe2NvbnN0IGU9TWUoYSxudWxsPT10P3ZvaWQgMDp0LnN0eWxlcyk7eWllbGQgdGhpcy5icmFpbnRyZWVGYXN0bGFuZVV0aWxzLmluaXRpYWxpemVCcmFpbnRyZWVGYXN0bGFuZU9yVGhyb3cobi5pZCxlKX19Y2F0Y2goZSl7fXJldHVybiBQcm9taXNlLnJlc29sdmUoKX0pfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBzdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfSl9c2lnbkluKGUsdCl7cmV0dXJuIHN0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbkluQ3VzdG9tZXIoZSx0KX0pfXNpZ25PdXQoZSl7cmV0dXJuIHN0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbk91dEN1c3RvbWVyKGUpfSl9ZXhlY3V0ZVBheW1lbnRNZXRob2RDaGVja291dChlKXtyZXR1cm4gc3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2NoZWNrb3V0UGF5bWVudE1ldGhvZEV4ZWN1dGVkOnQsY29udGludWVXaXRoQ2hlY2tvdXRDYWxsYmFjazppfT1lfHx7fTtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiBpKXRocm93IG5ldyBWKCdVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIFwiY29udGludWVXaXRoQ2hlY2tvdXRDYWxsYmFja1wiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZCBhbmQgaXQgbXVzdCBiZSBhIGZ1bmN0aW9uLicpO2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q3VzdG9tZXJPclRocm93KCk7aWYodGhpcy5pc0FjY2VsZXJhdGVkQ2hlY2tvdXRFbmFibGVkJiZuLmlzR3Vlc3Qpe2NvbnN0IGU9eWllbGQgdGhpcy5zaG91bGRSdW5BdXRoZW50aWNhdGlvbkZsb3coKTt0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0JiZ0KCksZSYmKHlpZWxkIHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5ydW5QYXlQYWxBdXRoZW50aWNhdGlvbkZsb3dPclRocm93KHZvaWQgMCwhMCkpfWkoKX0pfXNob3VsZFJ1bkF1dGhlbnRpY2F0aW9uRmxvdygpe3ZhciBlO3JldHVybiBzdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD1cImJyYWludHJlZWFjY2VsZXJhdGVkY2hlY2tvdXRcIjt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKHQpO2NvbnN0IGk9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCk7cmV0dXJuKG51bGw9PT0oZT1pLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PWU/dm9pZCAwOmUuc2hvdWxkUnVuQWNjZWxlcmF0ZWRDaGVja291dCl8fCExfWNhdGNoKGUpe3JldHVybiExfX0pfWdldFZhbGlkUGF5bWVudE1ldGhvZE9yVGhyb3coZSl7cmV0dXJuIHN0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtsZXQgdD1lO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QodCl9Y2F0Y2goaSl7dD1cImJyYWludHJlZVwiPT09ZT9cImJyYWludHJlZWFjY2VsZXJhdGVkY2hlY2tvdXRcIjpcImJyYWludHJlZVwiLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZCh0KX1yZXR1cm4gdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCl9KX19Y29uc3QgbHQ9TCh0PT57Y29uc3QgaT13aW5kb3csbj1uZXcgRih0KSxyPW5ldyBkZShuZXcgeihlKCksaSxuKSxpKSxvPW5ldyBWZSh0LHIpO3JldHVybiBuZXcgZHQodCxvKX0sW3tpZDpcImJyYWludHJlZWFjY2VsZXJhdGVkY2hlY2tvdXRcIn0se2lkOlwiYnJhaW50cmVlXCJ9XSk7Y2xhc3MgY3QgZXh0ZW5kcyBwe2NvbnN0cnVjdG9yKGUpe3N1cGVyKGV8fFwiTm90IGltcGxlbWVudGVkLlwiKSx0aGlzLm5hbWU9XCJOb3RJbXBsZW1lbnRlZEVycm9yXCIsdGhpcy50eXBlPVwibm90X2ltcGxlbWVudGVkXCJ9fXZhciB1dD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBodHtjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5mb3JtUG9zdGVyPXQsdGhpcy5icmFpbnRyZWVTZGs9aSx0aGlzLmJ1dHRvbkNsYXNzTmFtZT1cInZpc2EtY2hlY2tvdXQtd3JhcHBlclwiLHRoaXMub25FcnJvcj1vfWluaXRpYWxpemUoZSl7cmV0dXJuIHV0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWV2aXNhY2hlY2tvdXQ6dCxtZXRob2RJZDppfT1lO2lmKCFpKXRocm93IG5ldyBWKCdVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIFwibWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQpdGhyb3cgbmV3IFYoJ1VuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXZpc2FjaGVja291dFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSk7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPW4uZ2V0Q2hlY2tvdXRPclRocm93KCkse2NsaWVudFRva2VuOmEsY29uZmlnOnN9PW4uZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSksZD1uLmdldFN0b3JlQ29uZmlnT3JUaHJvdygpO2lmKCFhKXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRNZXRob2QpO3RoaXMuYnJhaW50cmVlU2RrLmluaXRpYWxpemUoYSk7Y29uc3QgbD15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXRCcmFpbnRyZWVWaXNhQ2hlY2tvdXQoKSxjPXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldFZpc2FDaGVja291dFNkayhzLnRlc3RNb2RlKSx7Y29udGFpbmVyOnUsb25FcnJvcjpofT10O3RoaXMub25FcnJvcj1ofHxvO2NvbnN0IHk9bC5jcmVhdGVJbml0T3B0aW9ucyh7cGF5bWVudFJlcXVlc3Q6e2N1cnJlbmN5Q29kZTpkLmN1cnJlbmN5LmNvZGUsc3VidG90YWw6U3RyaW5nKHIuc3VidG90YWwpfSxzZXR0aW5nczp7bG9jYWxlOmQuc3RvcmVQcm9maWxlLnN0b3JlTGFuZ3VhZ2Usc2hpcHBpbmc6e2NvbGxlY3RTaGlwcGluZzohMH19fSksbT10aGlzLmNyZWF0ZVNpZ25JbkJ1dHRvbih1LHRoaXMuYnV0dG9uQ2xhc3NOYW1lKTt5aWVsZCBjLmluaXQoeSksYy5vbihcInBheW1lbnQuc3VjY2Vzc1wiLGU9PnRoaXMudG9rZW5pemVQYXltZW50KGwsZSkudGhlbigoKT0+dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRDaGVja291dCgpKS5jYXRjaChlPT50aGlzLmhhbmRsZUVycm9yKGUpKSksYy5vbihcInBheW1lbnQuZXJyb3JcIiwoZSx0KT0+dGhpcy5oYW5kbGVFcnJvcih0KSksbS5zdHlsZS52aXNpYmlsaXR5PVwidmlzaWJsZVwifSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIHV0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLmJyYWludHJlZVNkay5kZWluaXRpYWxpemUoKX0pfXNpZ25Jbigpe3Rocm93IG5ldyBjdCgnSW4gb3JkZXIgdG8gc2lnbiBpbiB2aWEgVmlzYUNoZWNrb3V0LCB0aGUgc2hvcHBlciBtdXN0IGNsaWNrIG9uIFwiVmlzYSBDaGVja291dFwiIGJ1dHRvbi4nKX1zaWduT3V0KGUpe3JldHVybiB1dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zaWduT3V0Q3VzdG9tZXIoZSksUHJvbWlzZS5yZXNvbHZlKCl9KX1leGVjdXRlUGF5bWVudE1ldGhvZENoZWNrb3V0KGUpe3ZhciB0O3JldHVybiBudWxsPT09KHQ9bnVsbD09ZT92b2lkIDA6ZS5jb250aW51ZVdpdGhDaGVja291dENhbGxiYWNrKXx8dm9pZCAwPT09dHx8dC5jYWxsKGUpLFByb21pc2UucmVzb2x2ZSgpfXRva2VuaXplUGF5bWVudChlLHQpe3JldHVybiB1dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIFByb21pc2UuYWxsKFtlLnRva2VuaXplKHQpLHRoaXMuYnJhaW50cmVlU2RrLmdldERhdGFDb2xsZWN0b3JPclRocm93KCldKS50aGVuKChbZSx0XSk9Pntjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG49aS5nZXRTaGlwcGluZ0FkZHJlc3MoKSxyPWkuZ2V0QmlsbGluZ0FkZHJlc3MoKSx7c2hpcHBpbmdBZGRyZXNzOm89dGhpcy5tYXBUb1Zpc2FDaGVja291dEFkZHJlc3MobiksYmlsbGluZ0FkZHJlc3M6YT10aGlzLm1hcFRvVmlzYUNoZWNrb3V0QWRkcmVzcyhyKX09ZTtyZXR1cm4gdGhpcy5wb3N0Rm9ybShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3NoaXBwaW5nQWRkcmVzczpvLGJpbGxpbmdBZGRyZXNzOmF9KSx0KX0pfSl9cG9zdEZvcm0oZSx0KXtjb25zdHt1c2VyRGF0YTppLGJpbGxpbmdBZGRyZXNzOm4sc2hpcHBpbmdBZGRyZXNzOnIsZGV0YWlsczpvfT1lLHt1c2VyRW1haWw6YX09aSx7ZGV2aWNlRGF0YTpzfT10O3JldHVybiB0aGlzLmZvcm1Qb3N0ZXIucG9zdEZvcm0oXCIvY2hlY2tvdXQucGhwXCIse3BheW1lbnRfdHlwZTplLnR5cGUsbm9uY2U6ZS5ub25jZSxwcm92aWRlcjpcImJyYWludHJlZXZpc2FjaGVja291dFwiLGFjdGlvbjpcInNldF9leHRlcm5hbF9jaGVja291dFwiLGRldmljZV9kYXRhOnMsY2FyZF9pbmZvcm1hdGlvbjpKU09OLnN0cmluZ2lmeSh7dHlwZTpvLmNhcmRUeXBlLG51bWJlcjpvLmxhc3RUd299KSxiaWxsaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkodGhpcy5nZXRBZGRyZXNzKGEsbikpLHNoaXBwaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkodGhpcy5nZXRBZGRyZXNzKGEscikpfSl9bWFwVG9WaXNhQ2hlY2tvdXRBZGRyZXNzKGUpe3JldHVybiBlP3tmaXJzdE5hbWU6ZS5maXJzdE5hbWUsbGFzdE5hbWU6ZS5sYXN0TmFtZSxwaG9uZU51bWJlcjplLnBob25lLHN0cmVldEFkZHJlc3M6ZS5hZGRyZXNzMSxleHRlbmRlZEFkZHJlc3M6ZS5hZGRyZXNzMixsb2NhbGl0eTplLmNpdHkscmVnaW9uOmUuc3RhdGVPclByb3ZpbmNlQ29kZSxjb3VudHJ5Q29kZTplLmNvdW50cnlDb2RlLHBvc3RhbENvZGU6ZS5wb3N0YWxDb2RlfTp7fX1nZXRBZGRyZXNzKGUsdD17fSl7cmV0dXJue2VtYWlsOmUsZmlyc3RfbmFtZTp0LmZpcnN0TmFtZSxsYXN0X25hbWU6dC5sYXN0TmFtZSxwaG9uZV9udW1iZXI6dC5waG9uZU51bWJlcixhZGRyZXNzX2xpbmVfMTp0LnN0cmVldEFkZHJlc3MsYWRkcmVzc19saW5lXzI6dC5leHRlbmRlZEFkZHJlc3MsY2l0eTp0LmxvY2FsaXR5LHN0YXRlOnQucmVnaW9uLGNvdW50cnlfY29kZTp0LmNvdW50cnlDb2RlLHBvc3RhbF9jb2RlOnQucG9zdGFsQ29kZX19Y3JlYXRlU2lnbkluQnV0dG9uKGUsdCl7Y29uc3QgaT1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtlfWApO2lmKCFpKXRocm93IG5ldyBFcnJvcihcIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHByb3ZpZGVkIGNvbnRhaW5lciBJRCBpcyBub3QgdmFsaWQuXCIpO3JldHVybiB0aGlzLmluc2VydFZpc2FDaGVja291dEJ1dHRvbihpLHQpfWluc2VydFZpc2FDaGVja291dEJ1dHRvbihlLHQpe2NvbnN0IGk9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtyZXR1cm4gaS5zdHlsZS5kaXNwbGF5PVwiZmxleFwiLGkuc3R5bGUuZmxleERpcmVjdGlvbj1cImNvbHVtblwiLGkuc3R5bGUudmlzaWJpbGl0eT1cImhpZGRlblwiLGkuc3R5bGUud2lkdGg9XCJtYXgtY29udGVudFwiLGkuY2xhc3NOYW1lPXQsaS5pbm5lckhUTUw9J1xcbiAgICAgICAgICAgIDxpbWdcXG4gICAgICAgICAgICAgICAgYWx0PVwiVmlzYSBDaGVja291dFwiXFxuICAgICAgICAgICAgICAgIGNsYXNzPVwidi1idXR0b25cIlxcbiAgICAgICAgICAgICAgICByb2xlPVwiYnV0dG9uXCJcXG4gICAgICAgICAgICAgICAgc3JjPVwiaHR0cHM6Ly9zZWN1cmUuY2hlY2tvdXQudmlzYS5jb20vd2FsbGV0LXNlcnZpY2VzLXdlYi94by9idXR0b24ucG5nP2FjY2VwdENhbmFkaWFuVmlzYURlYml0PWZhbHNlJmNvYnJhbmQ9dHJ1ZSZoZWlnaHQ9MzQmd2lkdGg9MTc4XCJcXG4gICAgICAgICAgICAgICAgLz5cXG4gICAgICAgICAgICA8YSBjbGFzcz1cInYtbGVhcm4gdi1sZWFybi1kZWZhdWx0XCIgc3R5bGU9XCJ0ZXh0LWFsaWduOiByaWdodDsgZGlzcGxheTogYmxvY2s7IGZvbnQtc2l6ZTogMTBweDsgY29sb3I6ICMwMDMzNjY7XCIgaHJlZj1cIiNcIiBkYXRhLWxvY2FsZT1cImVuX1VTXCI+VGVsbCBNZSBNb3JlPC9hPicsZS5hcHBlbmRDaGlsZChpKSxpfWhhbmRsZUVycm9yKGUpe2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIHRoaXMub25FcnJvcil0aHJvdyBlO3RoaXMub25FcnJvcihlKX19Y29uc3QgeXQ9TCh0PT57Y29uc3QgaT13aW5kb3csbj1uZXcgRih0KSxyPW5ldyBCKG5ldyB6KGUoKSxpLG4pKTtyZXR1cm4gbmV3IGh0KHQsdSgpLHIpfSxbe2lkOlwiYnJhaW50cmVldmlzYWNoZWNrb3V0XCJ9XSk7Y2xhc3MgbXQgZXh0ZW5kcyBwe2NvbnN0cnVjdG9yKGUpe3N1cGVyKGV8fFwiQW4gdW5leHBlY3RlZCBlcnJvciBoYXMgb2NjdXJyZWQgZHVyaW5nIGJ1eSBub3cgY2FydCBjcmVhdGlvbiBwcm9jZXNzLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiKSx0aGlzLm5hbWU9XCJCdXlOb3dDYXJ0Q3JlYXRpb25FcnJvclwiLHRoaXMudHlwZT1cImJ1eV9ub3dfY2FydF9jcmVhdGlvbl9lcnJvclwifX1mdW5jdGlvbiBwdChlKXtjb25zdHtjb2xvcjp0LGZ1bmRpbmdpY29uczppLGhlaWdodDpuPTQwLGxheW91dDpvLHNoYXBlOmEsc2l6ZTpkLHRhZ2xpbmU6bH09ZXx8e30sYz17Y29sb3I6dCxmdW5kaW5naWNvbnM6aSxoZWlnaHQ6Z3QobiksbGF5b3V0Om8sc2hhcGU6YXx8XCJyZWN0XCIsc2l6ZTpkLHRhZ2xpbmU6bH07cmV0dXJuIHMoYyxyKX1mdW5jdGlvbiBndChlKXtjb25zdCB0PU51bWJlcihlKTtyZXR1cm4hdHx8TnVtYmVyLmlzTmFOKHQpPzQwOnQ+NTU/NTU6dDwyNT8yNTp0fXZhciB2dD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBmdHtjb25zdHJ1Y3RvcihlLHQsaSxuKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmZvcm1Qb3N0ZXI9dCx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT1pLHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdz1ufWluaXRpYWxpemUoZSl7cmV0dXJuIHZ0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWVwYXlwYWw6dCxjb250YWluZXJJZDppLG1ldGhvZElkOm59PWU7aWYoIW4pdGhyb3cgbmV3IFYoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIWkpdGhyb3cgbmV3IFYoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuY29udGFpbmVySWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQpdGhyb3cgbmV3IFYoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVlcGF5cGFsXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2xldCByLG89dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCk7aWYodC5idXlOb3dJbml0aWFsaXplT3B0aW9ucyl7aWYoIXQuY3VycmVuY3lDb2RlKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXBheXBhbGNyZWRpdC5jdXJyZW5jeUNvZGVcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7cj10LmN1cnJlbmN5Q29kZX1lbHNlIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCksbz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPW8uZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlO2NvbnN0IGE9by5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhuKSx7Y2xpZW50VG9rZW46cyxjb25maWc6ZCxpbml0aWFsaXphdGlvbkRhdGE6bH09YTtpZighc3x8IWwpdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3QgYz17Y3VycmVuY3k6cixpbnRlbnQ6bC5pbnRlbnQsaXNDcmVkaXRFbmFibGVkOmwuaXNDcmVkaXRFbmFibGVkfTt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKHMpLHlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheXBhbENoZWNrb3V0KGMsZT0+e3RoaXMucmVuZGVyUGF5UGFsQnV0dG9uKGUsdCxpLG4sISFkLnRlc3RNb2RlKX0sZT0+dGhpcy5oYW5kbGVFcnJvcihlLGksdC5vbkVycm9yKSl9KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gdnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRlYXJkb3duKCl9KX1yZW5kZXJQYXlQYWxCdXR0b24oZSx0LGksbixyKXtjb25zdHtzdHlsZTpvLHNob3VsZFByb2Nlc3NQYXltZW50OmEsb25BdXRob3JpemVFcnJvcjpzLG9uRWxpZ2liaWxpdHlGYWlsdXJlOmR9PXQse3BheXBhbDpsfT10aGlzLmJyYWludHJlZUhvc3RXaW5kb3c7aWYobCl7Y29uc3QgYz1sLkJ1dHRvbnMoe2VudjpyP1wic2FuZGJveFwiOlwicHJvZHVjdGlvblwiLGZ1bmRpbmdTb3VyY2U6bC5GVU5ESU5HLlBBWVBBTCxzdHlsZTpwdChvKSxjcmVhdGVPcmRlcjooKT0+dGhpcy5zZXR1cFBheW1lbnQoZSx0LG4pLG9uQXBwcm92ZTp0PT50aGlzLnRva2VuaXplUGF5bWVudCh0LGUsbixhLHMpfSk7Yy5pc0VsaWdpYmxlKCk/Yy5yZW5kZXIoYCMke2l9YCk6ZCYmXCJmdW5jdGlvblwiPT10eXBlb2YgZCYmZCgpfWVsc2UgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UucmVtb3ZlRWxlbWVudChpKX1zZXR1cFBheW1lbnQoZSx0LGkpe3ZhciBuO3JldHVybiB2dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7b25QYXltZW50RXJyb3I6cixzaGlwcGluZ0FkZHJlc3M6byxidXlOb3dJbml0aWFsaXplT3B0aW9uczphfT10O3RyeXtjb25zdCByPVwiZnVuY3Rpb25cIj09dHlwZW9mKG51bGw9PWE/dm9pZCAwOmEuZ2V0QnV5Tm93Q2FydFJlcXVlc3RCb2R5KT95aWVsZCB0aGlzLmNyZWF0ZUJ1eU5vd0NhcnQoYS5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkoKSk6dm9pZCAwO3RoaXMuYnV5Tm93Q2FydElkPW51bGw9PXI/dm9pZCAwOnIuaWQ7Y29uc3Qgcz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxkPXMuZ2V0Q3VzdG9tZXIoKSxsPXMuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSksYz1yP3IuY2FydEFtb3VudDpzLmdldENhcnRPclRocm93KCkuY2FydEFtb3VudCx1PXI/dC5jdXJyZW5jeUNvZGU6cy5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGUsaD1vfHwobnVsbD09ZD92b2lkIDA6ZC5hZGRyZXNzZXNbMF0pLHk9aD9nZShoKTp2b2lkIDA7cmV0dXJuIHlpZWxkIGUuY3JlYXRlUGF5bWVudCh7ZmxvdzpcImNoZWNrb3V0XCIsZW5hYmxlU2hpcHBpbmdBZGRyZXNzOiEwLHNoaXBwaW5nQWRkcmVzc0VkaXRhYmxlOiExLHNoaXBwaW5nQWRkcmVzc092ZXJyaWRlOnksYW1vdW50OmMsY3VycmVuY3k6dSxvZmZlckNyZWRpdDohMSxpbnRlbnQ6bnVsbD09PShuPWwuaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09bj92b2lkIDA6bi5pbnRlbnR9KX1jYXRjaChlKXt0aHJvdyByJiYoRChlKXx8ZSBpbnN0YW5jZW9mIHApJiZyKGUpLGV9fSl9dG9rZW5pemVQYXltZW50KGUsdCxpLG4scil7cmV0dXJuIHZ0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7Y29uc3R7ZGV2aWNlRGF0YTpyfT15aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXREYXRhQ29sbGVjdG9yKHtwYXlwYWw6ITB9KSxvPXlpZWxkIHQudG9rZW5pemVQYXltZW50KGUpLHtkZXRhaWxzOmEsbm9uY2U6c309byxkPXRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvTGVnYWN5QmlsbGluZ0FkZHJlc3MoYSksbD10aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5tYXBUb0xlZ2FjeVNoaXBwaW5nQWRkcmVzcyhhKTtyZXR1cm4gdGhpcy5mb3JtUG9zdGVyLnBvc3RGb3JtKFwiL2NoZWNrb3V0LnBocFwiLE9iamVjdC5hc3NpZ24oe3BheW1lbnRfdHlwZTpcInBheXBhbFwiLHByb3ZpZGVyOmksYWN0aW9uOm4/XCJwcm9jZXNzX3BheW1lbnRcIjpcInNldF9leHRlcm5hbF9jaGVja291dFwiLG5vbmNlOnMsZGV2aWNlX2RhdGE6cixiaWxsaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkoZCksc2hpcHBpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeShsKX0sdGhpcy5idXlOb3dDYXJ0SWQmJntjYXJ0X2lkOnRoaXMuYnV5Tm93Q2FydElkfSkpLG99Y2F0Y2goZSl7dGhyb3cgciYmKEQoZSl8fGUgaW5zdGFuY2VvZiBwKSYmcihlKSxlfX0pfWNyZWF0ZUJ1eU5vd0NhcnQoZSl7cmV0dXJuIHZ0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighZSl0aHJvdyBuZXcgVShqLk1pc3NpbmdDYXJ0KTt0cnl7cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5jcmVhdGVCdXlOb3dDYXJ0KGUpfWNhdGNoKGUpe3Rocm93IG5ldyBtdH19KX1oYW5kbGVFcnJvcihlLHQsaSl7aWYodGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UucmVtb3ZlRWxlbWVudCh0KSwhaXx8IUQoZSkpdGhyb3cgZTtpKGUpfX1jb25zdCBidD1MKHQ9Pntjb25zdCBpPXdpbmRvdyxuPW5ldyBGKHQpLHI9bmV3IGRlKG5ldyB6KGUoKSxpLG4pLGkpO3JldHVybiBuZXcgZnQodCx1KCkscixpKX0sW3tpZDpcImJyYWludHJlZXBheXBhbFwifV0pO3ZhciB3dD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBDdHtjb25zdHJ1Y3RvcihlLHQsaSxuLHIpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuZm9ybVBvc3Rlcj10LHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlPWksdGhpcy5icmFpbnRyZWVNZXNzYWdlcz1uLHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdz1yfWluaXRpYWxpemUoZSl7dmFyIHQsaTtyZXR1cm4gd3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2JyYWludHJlZXBheXBhbGNyZWRpdDpuLGNvbnRhaW5lcklkOnIsbWV0aG9kSWQ6b309ZTtpZighbyl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighcil0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5jb250YWluZXJJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighbil0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVwYXlwYWxjcmVkaXRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7bGV0IGEscz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTtpZihuLmJ1eU5vd0luaXRpYWxpemVPcHRpb25zKXtpZighbi5jdXJyZW5jeUNvZGUpdGhyb3cgbmV3IFYoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVlcGF5cGFsY3JlZGl0LmN1cnJlbmN5Q29kZVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTthPW4uY3VycmVuY3lDb2RlfWVsc2UgeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWREZWZhdWx0Q2hlY2tvdXQoKSxzPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLGE9cy5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGU7Y29uc3QgZD1zLmdldFBheW1lbnRNZXRob2RPclRocm93KG8pLHtjbGllbnRUb2tlbjpsLGNvbmZpZzpjLGluaXRpYWxpemF0aW9uRGF0YTp1fT1kO2lmKCFsfHwhdSl0aHJvdyBuZXcgVShqLk1pc3NpbmdQYXltZW50TWV0aG9kKTtjb25zdCBoPXtjdXJyZW5jeTphLGludGVudDp1LmludGVudCxpc0NyZWRpdEVuYWJsZWQ6dS5pc0NyZWRpdEVuYWJsZWR9LHk9eChudWxsIT09KGk9bnVsbD09PSh0PXMuZ2V0U3RvcmVDb25maWcoKSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlcykmJnZvaWQgMCE9PWk/aTp7fSxcIlBBWVBBTC01NjYzLmhpZGVfYnJhaW50cmVlX2NhcmRfYmFubmVyX2ltcGxlbWVudGF0aW9uX2luX2NoZWNrb3V0X3Nka1wiKTt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKGwpLHlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheXBhbENoZWNrb3V0KGgsZT0+eyF5JiZuLm1lc3NhZ2luZ0NvbnRhaW5lcklkJiZ0aGlzLnJlbmRlclBheVBhbE1lc3NhZ2VzKG8sbi5tZXNzYWdpbmdDb250YWluZXJJZCksdGhpcy5yZW5kZXJQYXlQYWxCdXR0b24oZSxuLHIsbywhIWMudGVzdE1vZGUpfSxlPT50aGlzLmhhbmRsZUVycm9yKGUscixuLm9uRXJyb3IpKX0pfWRlaW5pdGlhbGl6ZSgpe3JldHVybiB3dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudGVhcmRvd24oKX0pfXJlbmRlclBheVBhbE1lc3NhZ2VzKGUsdCl7dGhpcy5icmFpbnRyZWVNZXNzYWdlcy5yZW5kZXIoZSx0LGFlLkNBUlQpfXJlbmRlclBheVBhbEJ1dHRvbihlLHQsaSxuLHIpe2NvbnN0e3N0eWxlOm8sc2hvdWxkUHJvY2Vzc1BheW1lbnQ6YSxvbkF1dGhvcml6ZUVycm9yOnMsb25FbGlnaWJpbGl0eUZhaWx1cmU6ZH09dCx7cGF5cGFsOmx9PXRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdztsZXQgYz0hMTtsJiZbbC5GVU5ESU5HLlBBWUxBVEVSLGwuRlVORElORy5DUkVESVRdLmZvckVhY2godT0+e2NvbnN0IGg9dT09PWwuRlVORElORy5DUkVESVQ/T2JqZWN0LmFzc2lnbih7bGFiZWw6cmUuQ1JFRElUfSxwdChvKSk6cHQobyk7aWYoIWMpe2NvbnN0IG89bC5CdXR0b25zKHtlbnY6cj9cInNhbmRib3hcIjpcInByb2R1Y3Rpb25cIixmdW5kaW5nU291cmNlOnUsc3R5bGU6aCxjcmVhdGVPcmRlcjooKT0+dGhpcy5zZXR1cFBheW1lbnQoZSx0LG4pLG9uQXBwcm92ZTp0PT50aGlzLnRva2VuaXplUGF5bWVudCh0LGUsbixhLHMpfSk7by5pc0VsaWdpYmxlKCk/KG8ucmVuZGVyKGAjJHtpfWApLGM9ITApOmwuRlVORElORy5DUkVESVQmJmQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGQmJmQoKX19KSxsJiZjfHx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KGkpfXNldHVwUGF5bWVudChlLHQsaSl7dmFyIG47cmV0dXJuIHd0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtvblBheW1lbnRFcnJvcjpyLHNoaXBwaW5nQWRkcmVzczpvLGJ1eU5vd0luaXRpYWxpemVPcHRpb25zOmF9PXQ7dHJ5e2NvbnN0IHI9XCJmdW5jdGlvblwiPT10eXBlb2YobnVsbD09YT92b2lkIDA6YS5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkpP3lpZWxkIHRoaXMuY3JlYXRlQnV5Tm93Q2FydChhLmdldEJ1eU5vd0NhcnRSZXF1ZXN0Qm9keSgpKTp2b2lkIDA7dGhpcy5idXlOb3dDYXJ0SWQ9bnVsbD09cj92b2lkIDA6ci5pZDtjb25zdCBzPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLGQ9cy5nZXRDdXN0b21lcigpLGw9cy5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSxjPXI/ci5jYXJ0QW1vdW50OnMuZ2V0Q2FydE9yVGhyb3coKS5jYXJ0QW1vdW50LHU9cj90LmN1cnJlbmN5Q29kZTpzLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZSxoPW98fChudWxsPT1kP3ZvaWQgMDpkLmFkZHJlc3Nlc1swXSkseT1oP2dlKGgpOnZvaWQgMDtyZXR1cm4geWllbGQgZS5jcmVhdGVQYXltZW50KHtmbG93OlwiY2hlY2tvdXRcIixlbmFibGVTaGlwcGluZ0FkZHJlc3M6ITAsc2hpcHBpbmdBZGRyZXNzRWRpdGFibGU6ITEsc2hpcHBpbmdBZGRyZXNzT3ZlcnJpZGU6eSxhbW91bnQ6YyxjdXJyZW5jeTp1LG9mZmVyQ3JlZGl0OiEwLGludGVudDpudWxsPT09KG49bC5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmludGVudH0pfWNhdGNoKGUpe3Rocm93IHImJihEKGUpfHxlIGluc3RhbmNlb2YgcCkmJnIoZSksZX19KX10b2tlbml6ZVBheW1lbnQoZSx0LGksbixyKXtyZXR1cm4gd3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtjb25zdHtkZXZpY2VEYXRhOnJ9PXlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldERhdGFDb2xsZWN0b3Ioe3BheXBhbDohMH0pLG89eWllbGQgdC50b2tlbml6ZVBheW1lbnQoZSkse2RldGFpbHM6YSxub25jZTpzfT1vLGQ9dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UubWFwVG9MZWdhY3lCaWxsaW5nQWRkcmVzcyhhKSxsPXRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvTGVnYWN5U2hpcHBpbmdBZGRyZXNzKGEpO3JldHVybiB0aGlzLmZvcm1Qb3N0ZXIucG9zdEZvcm0oXCIvY2hlY2tvdXQucGhwXCIsT2JqZWN0LmFzc2lnbih7cGF5bWVudF90eXBlOlwicGF5cGFsXCIscHJvdmlkZXI6aSxhY3Rpb246bj9cInByb2Nlc3NfcGF5bWVudFwiOlwic2V0X2V4dGVybmFsX2NoZWNrb3V0XCIsbm9uY2U6cyxkZXZpY2VfZGF0YTpyLGJpbGxpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeShkKSxzaGlwcGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KGwpfSx0aGlzLmJ1eU5vd0NhcnRJZCYme2NhcnRfaWQ6dGhpcy5idXlOb3dDYXJ0SWR9KSksb31jYXRjaChlKXt0aHJvdyByJiYoRChlKXx8ZSBpbnN0YW5jZW9mIHApJiZyKGUpLGV9fSl9Y3JlYXRlQnV5Tm93Q2FydChlKXtyZXR1cm4gd3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCFlKXRocm93IG5ldyBVKGouTWlzc2luZ0NhcnQpO3RyeXtyZXR1cm4geWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZUJ1eU5vd0NhcnQoZSl9Y2F0Y2goZSl7dGhyb3cgbmV3IG10fX0pfWhhbmRsZUVycm9yKGUsdCxpKXtpZih0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KHQpLCFpfHwhRChlKSl0aHJvdyBlO2koZSl9fWNvbnN0IFN0PUwodD0+e2NvbnN0IGk9d2luZG93LG49bmV3IEYodCkscj1uZXcgZGUobmV3IHooZSgpLGksbiksaSksbz1uZXcgbGUodCk7cmV0dXJuIG5ldyBDdCh0LHUoKSxyLG8saSl9LFt7aWQ6XCJicmFpbnRyZWVwYXlwYWxjcmVkaXRcIn1dKTt2YXIgUHQ9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgSXR7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuZm9ybVBvc3Rlcj10LHRoaXMuYnJhaW50cmVlU2RrPWl9aW5pdGlhbGl6ZShlKXtyZXR1cm4gUHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2NvbnRhaW5lcklkOnQsbWV0aG9kSWQ6aX09ZTtpZighaSl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdCl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5jb250YWluZXJJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSk7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSx7Y2xpZW50VG9rZW46cixpbml0aWFsaXphdGlvbkRhdGE6byxjb25maWc6YX09bi5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKTtpZighcnx8IW8pdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudE1ldGhvZCk7dGhpcy5icmFpbnRyZWVTZGsuaW5pdGlhbGl6ZShyKTtjb25zdCBzPXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldEJyYWludHJlZVZpc2FDaGVja291dCgpLHtjdXJyZW5jeTp7Y29kZTpkfSxjYXJ0QW1vdW50Omx9PW4uZ2V0Q2FydE9yVGhyb3coKSxjPXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldFZpc2FDaGVja291dFNkayhhLnRlc3RNb2RlKSx1PXMuY3JlYXRlSW5pdE9wdGlvbnMoe3BheW1lbnRSZXF1ZXN0OntjdXJyZW5jeUNvZGU6ZCxzdWJ0b3RhbDpTdHJpbmcobCl9LHNldHRpbmdzOntzaGlwcGluZzp7Y29sbGVjdFNoaXBwaW5nOiEwfX19KTt0aGlzLmNyZWF0ZVNpZ25JbkJ1dHRvbih0KSx5aWVsZCBjLmluaXQodSksYy5vbihcInBheW1lbnQuc3VjY2Vzc1wiLGU9PlB0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRTdWNjZXNzKHMsZSl9KSl9KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9cGF5bWVudFN1Y2Nlc3MoZSx0KXtyZXR1cm4gUHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiBQcm9taXNlLmFsbChbZS50b2tlbml6ZSh0KSx0aGlzLmJyYWludHJlZVNkay5nZXREYXRhQ29sbGVjdG9yT3JUaHJvdygpXSkudGhlbigoW2UsdF0pPT57Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxuPWkuZ2V0U2hpcHBpbmdBZGRyZXNzKCkscj1pLmdldEJpbGxpbmdBZGRyZXNzKCkse3NoaXBwaW5nQWRkcmVzczpvPXRoaXMudG9WaXNhQ2hlY2tvdXRBZGRyZXNzKG4pLGJpbGxpbmdBZGRyZXNzOmE9dGhpcy50b1Zpc2FDaGVja291dEFkZHJlc3Mocil9PWU7cmV0dXJuIHRoaXMucG9zdEZvcm0oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHtzaGlwcGluZ0FkZHJlc3M6byxiaWxsaW5nQWRkcmVzczphfSksdCl9KX0pfXBvc3RGb3JtKGUsdCl7Y29uc3R7dXNlckRhdGE6aSxiaWxsaW5nQWRkcmVzczpuLHNoaXBwaW5nQWRkcmVzczpyLGRldGFpbHM6b309ZSx7dXNlckVtYWlsOmF9PWkse2RldmljZURhdGE6c309dDtyZXR1cm4gdGhpcy5mb3JtUG9zdGVyLnBvc3RGb3JtKFwiL2NoZWNrb3V0LnBocFwiLHtwYXltZW50X3R5cGU6ZS50eXBlLG5vbmNlOmUubm9uY2UscHJvdmlkZXI6XCJicmFpbnRyZWV2aXNhY2hlY2tvdXRcIixhY3Rpb246XCJzZXRfZXh0ZXJuYWxfY2hlY2tvdXRcIixkZXZpY2VfZGF0YTpzLGNhcmRfaW5mb3JtYXRpb246SlNPTi5zdHJpbmdpZnkoe3R5cGU6by5jYXJkVHlwZSxudW1iZXI6by5sYXN0VHdvfSksYmlsbGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0QWRkcmVzcyhhLG4pKSxzaGlwcGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0QWRkcmVzcyhhLHIpKX0pfXRvVmlzYUNoZWNrb3V0QWRkcmVzcyhlKXtyZXR1cm4gZT97Zmlyc3ROYW1lOmUuZmlyc3ROYW1lLGxhc3ROYW1lOmUubGFzdE5hbWUscGhvbmVOdW1iZXI6ZS5waG9uZSxzdHJlZXRBZGRyZXNzOmUuYWRkcmVzczEsZXh0ZW5kZWRBZGRyZXNzOmUuYWRkcmVzczIsbG9jYWxpdHk6ZS5jaXR5LHJlZ2lvbjplLnN0YXRlT3JQcm92aW5jZUNvZGUsY291bnRyeUNvZGU6ZS5jb3VudHJ5Q29kZSxwb3N0YWxDb2RlOmUucG9zdGFsQ29kZX06e319Z2V0QWRkcmVzcyhlLHQ9e30pe3JldHVybntlbWFpbDplLGZpcnN0X25hbWU6dC5maXJzdE5hbWUsbGFzdF9uYW1lOnQubGFzdE5hbWUscGhvbmVfbnVtYmVyOnQucGhvbmVOdW1iZXIsYWRkcmVzc19saW5lXzE6dC5zdHJlZXRBZGRyZXNzLGFkZHJlc3NfbGluZV8yOnQuZXh0ZW5kZWRBZGRyZXNzLGNpdHk6dC5sb2NhbGl0eSxzdGF0ZTp0LnJlZ2lvbixjb3VudHJ5X2NvZGU6dC5jb3VudHJ5Q29kZSxwb3N0YWxfY29kZTp0LnBvc3RhbENvZGV9fWNyZWF0ZVNpZ25JbkJ1dHRvbihlKXtjb25zdCB0PWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2V9YCk7aWYoIXQpdGhyb3cgbmV3IEVycm9yKFwiTmVlZCBhIGNvbnRhaW5lciB0byBwbGFjZSB0aGUgYnV0dG9uXCIpO3JldHVybiB0aGlzLmluc2VydFZpc2FDaGVja291dEJ1dHRvbih0KX1pbnNlcnRWaXNhQ2hlY2tvdXRCdXR0b24oZSl7Y29uc3QgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3JldHVybiB0LnN0eWxlLmRpc3BsYXk9XCJmbGV4XCIsdC5zdHlsZS5mbGV4RGlyZWN0aW9uPVwiY29sdW1uXCIsdC5zdHlsZS5hbGlnbkl0ZW1zPVwiZmxleC1lbmRcIix0LmlubmVySFRNTD0nXFxuICAgICAgICAgICAgPGltZ1xcbiAgICAgICAgICAgICAgICBhbHQ9XCJWaXNhIENoZWNrb3V0XCJcXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJ2LWJ1dHRvblwiXFxuICAgICAgICAgICAgICAgIHJvbGU9XCJidXR0b25cIlxcbiAgICAgICAgICAgICAgICBzcmM9XCJodHRwczovL3NlY3VyZS5jaGVja291dC52aXNhLmNvbS93YWxsZXQtc2VydmljZXMtd2ViL3hvL2J1dHRvbi5wbmc/YWNjZXB0Q2FuYWRpYW5WaXNhRGViaXQ9ZmFsc2UmY29icmFuZD10cnVlJmhlaWdodD0zNCZ3aWR0aD0xNzhcIlxcbiAgICAgICAgICAgICAgICAvPlxcbiAgICAgICAgICAgIDxhIGNsYXNzPVwidi1sZWFybiB2LWxlYXJuLWRlZmF1bHRcIiBzdHlsZT1cInRleHQtYWxpZ246IHJpZ2h0OyBkaXNwbGF5OiBibG9jazsgZm9udC1zaXplOiAxMHB4OyBjb2xvcjogIzAwMzM2NjtcIiBocmVmPVwiI1wiIGRhdGEtbG9jYWxlPVwiZW5fVVNcIj5UZWxsIE1lIE1vcmU8L2E+JyxlLmFwcGVuZENoaWxkKHQpLHR9fWNvbnN0IE90PUwodD0+e2NvbnN0IGk9d2luZG93LG49bmV3IEYodCkscj1uZXcgQihuZXcgeihlKCksaSxuKSk7cmV0dXJuIG5ldyBJdCh0LHUoKSxyKX0sW3tpZDpcImJyYWludHJlZXZpc2FjaGVja291dFwifV0pO2Z1bmN0aW9uIGt0KGUpe2NvbnN0e2JpbGxpbmdBZGRyZXNzOnQsZW1haWw6aSxmaXJzdE5hbWU6bixsYXN0TmFtZTpyLHBob25lOm8sc2hpcHBpbmdBZGRyZXNzOmF9PWUscz10fHxhO3JldHVybntlbWFpbDppLGZpcnN0X25hbWU6bixsYXN0X25hbWU6cixwaG9uZV9udW1iZXI6byxhZGRyZXNzX2xpbmVfMTpudWxsPT1zP3ZvaWQgMDpzLmxpbmUxLGFkZHJlc3NfbGluZV8yOm51bGw9PXM/dm9pZCAwOnMubGluZTIsY2l0eTpudWxsPT1zP3ZvaWQgMDpzLmNpdHksc3RhdGU6bnVsbD09cz92b2lkIDA6cy5zdGF0ZSxjb3VudHJ5X2NvZGU6bnVsbD09cz92b2lkIDA6cy5jb3VudHJ5Q29kZSxwb3N0YWxfY29kZTpudWxsPT1zP3ZvaWQgMDpzLnBvc3RhbENvZGV9fWZ1bmN0aW9uIEV0KGUpe2NvbnN0e2VtYWlsOnQscGhvbmU6aSxzaGlwcGluZ0FkZHJlc3M6bn09ZSxyPShudWxsPT1uP3ZvaWQgMDpuLnJlY2lwaWVudE5hbWUpfHxcIlwiLFtvLGFdPXIuc3BsaXQoXCIgXCIpO3JldHVybntlbWFpbDp0LGZpcnN0X25hbWU6b3x8XCJcIixsYXN0X25hbWU6YXx8XCJcIixwaG9uZV9udW1iZXI6aSxhZGRyZXNzX2xpbmVfMTpudWxsPT1uP3ZvaWQgMDpuLmxpbmUxLGFkZHJlc3NfbGluZV8yOm51bGw9PW4/dm9pZCAwOm4ubGluZTIsY2l0eTpudWxsPT1uP3ZvaWQgMDpuLmNpdHksc3RhdGU6bnVsbD09bj92b2lkIDA6bi5zdGF0ZSxjb3VudHJ5X2NvZGU6bnVsbD09bj92b2lkIDA6bi5jb3VudHJ5Q29kZSxwb3N0YWxfY29kZTpudWxsPT1uP3ZvaWQgMDpuLnBvc3RhbENvZGV9fXZhciBUdD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjb25zdCBBdD1lPT57Y29uc3R7Y29sb3I6dCxoZWlnaHQ6aX09ZTtyZXR1cm57YmFja2dyb3VuZENvbG9yOihuPXR8fFwiXCIsbj09PW5lLldISVRFP1wiI0ZGRkZGRlwiOlwiIzNEOTVDRVwiKSxiYWNrZ3JvdW5kUG9zaXRpb246XCI1MCUgNTAlXCIsYmFja2dyb3VuZFNpemU6XCI4MHB4IGF1dG9cIixiYWNrZ3JvdW5kSW1hZ2U6YHVybChcIi9hcHAvYXNzZXRzL2ltZy9wYXltZW50LXByb3ZpZGVycy92ZW5tby1sb2dvLSR7dD09PW5lLldISVRFP25lLkJMVUU6bmUuV0hJVEV9LnN2Z1wiKWAsYmFja2dyb3VuZFJlcGVhdDpcIm5vLXJlcGVhdFwiLGJvcmRlclJhZGl1czpcIjRweFwiLGN1cnNvcjpcInBvaW50ZXJcIix0cmFuc2l0aW9uOlwiMC4ycyBlYXNlXCIsbWluSGVpZ2h0OmAke2l8fDQwfXB4YCxtaW5XaWR0aDpcIjE1MHB4XCIsaGVpZ2h0OlwiMTAwJVwiLHdpZHRoOlwiMTAwJVwiLGJvcmRlcjp0PT09bmUuV0hJVEU/XCIxcHggc29saWQgYmxhY2tcIjpcIm5vbmVcIn07dmFyIG59O2NsYXNzIHp0e2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmZvcm1Qb3N0ZXI9dCx0aGlzLmJyYWludHJlZVNkaz1pLHRoaXMub25FcnJvcj1vfWluaXRpYWxpemUoZSl7cmV0dXJuIFR0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWV2ZW5tbzp0LGNvbnRhaW5lcklkOmksbWV0aG9kSWQ6bn09ZTtpZighbil0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtjb25zdCByPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KG4pLHtjbGllbnRUb2tlbjpvLGluaXRpYWxpemF0aW9uRGF0YTphfT1yLHtwYXltZW50QnV0dG9uU3R5bGVzOnN9PWEse2NhcnRCdXR0b25TdHlsZXM6ZH09c3x8e30sbD0obnVsbD09dD92b2lkIDA6dC5zdHlsZSl8fGQ7aWYoIW98fCFhKXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRNZXRob2QpO2lmKCFpKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmNvbnRhaW5lcklkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCksdGhpcy5vbkVycm9yPShudWxsPT10P3ZvaWQgMDp0Lm9uRXJyb3IpfHx0aGlzLmhhbmRsZUVycm9yLHRoaXMuYnJhaW50cmVlU2RrLmluaXRpYWxpemUobyk7dHJ5e2NvbnN0IGU9eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0VmVubW9DaGVja291dE9yVGhyb3coKTt0aGlzLnJlbmRlclZlbm1vQnV0dG9uKGUsaSxudWxsPT10P3ZvaWQgMDp0LmJ1eU5vd0luaXRpYWxpemVPcHRpb25zLGwpfWNhdGNoKGUpeyhwZShlKXx8ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBOfShlKSkmJnRoaXMuaGFuZGxlSW5pdGlhbGl6YXRpb25WZW5tb0Vycm9yKGUsaSl9fSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFR0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4geWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZGVpbml0aWFsaXplKCksUHJvbWlzZS5yZXNvbHZlKCl9KX1oYW5kbGVFcnJvcihlKXt0aHJvdyBuZXcgRXJyb3IoZS5tZXNzYWdlKX1jcmVhdGVCdXlOb3dDYXJ0KGUpe3JldHVybiBUdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YobnVsbD09ZT92b2lkIDA6ZS5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkpKXtjb25zdCB0PW51bGw9PWU/dm9pZCAwOmUuZ2V0QnV5Tm93Q2FydFJlcXVlc3RCb2R5KCk7aWYoIXQpdGhyb3cgbmV3IFUoai5NaXNzaW5nQ2FydCk7dHJ5e3JldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlQnV5Tm93Q2FydCh0KX1jYXRjaChlKXt0aHJvdyBuZXcgbXR9fX0pfWhhbmRsZUluaXRpYWxpemF0aW9uVmVubW9FcnJvcihlLHQpe3JldHVybiB0aGlzLnJlbW92ZVZlbm1vQ29udGFpbmVyKHQpLHRoaXMub25FcnJvcihlKX1yZW1vdmVWZW5tb0NvbnRhaW5lcihlKXtjb25zdCB0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGUpO3QmJnQucmVtb3ZlKCl9cmVuZGVyVmVubW9CdXR0b24oZSx0LGksbil7Y29uc3Qgcj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0KSx7Y29sb3I6b309bnx8e307aWYoIXIpdGhyb3cgbmV3IFYoXCJVbmFibGUgdG8gY3JlYXRlIHdhbGxldCBidXR0b24gd2l0aG91dCB2YWxpZCBjb250YWluZXIgSUQuXCIpO3Iuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLFwiVmVubW9cIiksT2JqZWN0LmFzc2lnbihyLnN0eWxlLEF0KG58fHt9KSksci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwoKT0+VHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3Iuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIixcInRydWVcIik7Y29uc3QgdD15aWVsZCB0aGlzLmNyZWF0ZUJ1eU5vd0NhcnQoaSk7ZS50b2tlbml6ZSYmZS50b2tlbml6ZSgoZSxpKT0+VHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3IucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIiksZSYmdGhpcy5vbkVycm9yKGUpLHlpZWxkIHRoaXMuaGFuZGxlUG9zdEZvcm0oaSxudWxsPT10P3ZvaWQgMDp0LmlkKX0pKX0pKSxvPT09bmUuQkxVRSYmKHIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwoKT0+e3Iuc3R5bGUuYmFja2dyb3VuZENvbG9yPVwiIzBhN2ZjMlwifSksci5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCgpPT57ci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9QXQobnx8e30pLmJhY2tncm91bmRDb2xvcn0pKX1oYW5kbGVQb3N0Rm9ybShlLHQpe3JldHVybiBUdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7ZGV2aWNlRGF0YTppfT15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXREYXRhQ29sbGVjdG9yT3JUaHJvdygpLHtub25jZTpuLGRldGFpbHM6cn09ZTt0aGlzLmZvcm1Qb3N0ZXIucG9zdEZvcm0oXCIvY2hlY2tvdXQucGhwXCIsT2JqZWN0LmFzc2lnbih7bm9uY2U6bixwcm92aWRlcjpcImJyYWludHJlZXZlbm1vXCIscGF5bWVudF90eXBlOlwicGF5cGFsXCIsZGV2aWNlX2RhdGE6aSxhY3Rpb246XCJzZXRfZXh0ZXJuYWxfY2hlY2tvdXRcIixiaWxsaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkoa3QocikpLHNoaXBwaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkoRXQocikpfSx0JiZ7Y2FydF9pZDp0fSkpfSl9fWNvbnN0IE50PUwodD0+e2NvbnN0IGk9d2luZG93LG49ZSgpLHI9bmV3IEYodCksbz1uZXcgeihuLGksciksYT1uZXcgQihvKTtyZXR1cm4gbmV3IHp0KHQsdSgpLGEpfSxbe2lkOlwiYnJhaW50cmVldmVubW9cIn1dKTtleHBvcnR7SyBhcyBjcmVhdGVCcmFpbnRyZWVBY2hQYXltZW50U3RyYXRlZ3ksZXQgYXMgY3JlYXRlQnJhaW50cmVlQ3JlZGl0Q2FyZFBheW1lbnRTdHJhdGVneSxsdCBhcyBjcmVhdGVCcmFpbnRyZWVGYXN0bGFuZUN1c3RvbWVyU3RyYXRlZ3ksamUgYXMgY3JlYXRlQnJhaW50cmVlRmFzdGxhbmVQYXltZW50U3RyYXRlZ3ksemUgYXMgY3JlYXRlQnJhaW50cmVlTG9jYWxNZXRob2RzUGF5bWVudFN0cmF0ZWd5LGJ0IGFzIGNyZWF0ZUJyYWludHJlZVBheXBhbEJ1dHRvblN0cmF0ZWd5LFN0IGFzIGNyZWF0ZUJyYWludHJlZVBheXBhbENyZWRpdEJ1dHRvblN0cmF0ZWd5LGF0IGFzIGNyZWF0ZUJyYWludHJlZVBheXBhbENyZWRpdEN1c3RvbWVyU3RyYXRlZ3ksbnQgYXMgY3JlYXRlQnJhaW50cmVlUGF5cGFsQ3VzdG9tZXJTdHJhdGVneSxiZSBhcyBjcmVhdGVCcmFpbnRyZWVQYXlwYWxQYXltZW50U3RyYXRlZ3ksTnQgYXMgY3JlYXRlQnJhaW50cmVlVmVubW9CdXR0b25TdHJhdGVneSwkZSBhcyBjcmVhdGVCcmFpbnRyZWVWZW5tb1BheW1lbnRTdHJhdGVneSxPdCBhcyBjcmVhdGVCcmFpbnRyZWVWaXNhQ2hlY2tvdXRCdXR0b25TdHJhdGVneSx5dCBhcyBjcmVhdGVCcmFpbnRyZWVWaXNhQ2hlY2tvdXRDdXN0b21lclN0cmF0ZWd5LEhlIGFzIGNyZWF0ZUJyYWludHJlZVZpc2FDaGVja291dFBheW1lbnRTdHJhdGVneX07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1icmFpbnRyZWUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///../checkout-sdk-js/dist/esm/integrations/braintree.js\n\n}");

/***/ })

}]);