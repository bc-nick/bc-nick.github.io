"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonpCheckout"] = self["webpackJsonpCheckout"] || []).push([["checkout-sdk-js_dist_esm_integrations_braintree_js"],{

/***/ "../checkout-sdk-js/dist/esm/integrations/braintree.js":
/*!*************************************************************!*\
  !*** ../checkout-sdk-js/dist/esm/integrations/braintree.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createBraintreeAchPaymentStrategy: () => (/* binding */ Je),\n/* harmony export */   createBraintreeCreditCardPaymentStrategy: () => (/* binding */ Mt),\n/* harmony export */   createBraintreeFastlaneCustomerStrategy: () => (/* binding */ me),\n/* harmony export */   createBraintreeFastlanePaymentStrategy: () => (/* binding */ ft),\n/* harmony export */   createBraintreeLocalMethodsPaymentStrategy: () => (/* binding */ mt),\n/* harmony export */   createBraintreePaypalButtonStrategy: () => (/* binding */ Ee),\n/* harmony export */   createBraintreePaypalCreditButtonStrategy: () => (/* binding */ Ne),\n/* harmony export */   createBraintreePaypalCreditCustomerStrategy: () => (/* binding */ Q),\n/* harmony export */   createBraintreePaypalCustomerStrategy: () => (/* binding */ J),\n/* harmony export */   createBraintreePaypalPaymentStrategy: () => (/* binding */ nt),\n/* harmony export */   createBraintreeVenmoButtonStrategy: () => (/* binding */ Ue),\n/* harmony export */   createBraintreeVenmoPaymentStrategy: () => (/* binding */ It),\n/* harmony export */   createBraintreeVisaCheckoutButtonStrategy: () => (/* binding */ _e),\n/* harmony export */   createBraintreeVisaCheckoutCustomerStrategy: () => (/* binding */ we),\n/* harmony export */   createBraintreeVisaCheckoutPaymentStrategy: () => (/* binding */ Ct)\n/* harmony export */ });\n/* harmony import */ var _bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @bigcommerce/form-poster */ \"../checkout-sdk-js/node_modules/@bigcommerce/form-poster/lib/index.js\");\n/* harmony import */ var _bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @bigcommerce/script-loader */ \"../checkout-sdk-js/node_modules/@bigcommerce/script-loader/lib/index.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash */ \"../checkout-sdk-js/node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _braintree_browser_detection__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @braintree/browser-detection */ \"../checkout-sdk-js/node_modules/@braintree/browser-detection/dist/browser-detection.js\");\n/* harmony import */ var _bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @bigcommerce/request-sender */ \"../checkout-sdk-js/node_modules/@bigcommerce/request-sender/esm/index.js\");\nvar h={};function y(e,t,i=!0){var n;return null!==(n=e[t])&&void 0!==n?n:i}h.d=(e,t)=>{for(var i in t)h.o(t,i)&&!h.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},h.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const m=\"3.128.0\",p=\"3.123.2\",g=\"3.106.0\";class v{constructor(e){this.paymentIntegrationService=e,this.braintreeWindow=window}getSDKVersion(){const e=this.paymentIntegrationService.getState().getStoreConfig(),t=(null==e?void 0:e.checkoutSettings.features)||{};return this.getPreloadedSDKVersion()||(y(t,\"PAYPAL-5809.braintree_hosted_fields_fix_version\")?m:y(t,\"PAYPAL-5636.update_braintree_sdk_version\")?p:g)}getPreloadedSDKVersion(){const e=this.braintreeWindow.braintree;if(e){const t=(0,lodash__WEBPACK_IMPORTED_MODULE_2__.find)(Object.values(e),e=>!!e.VERSION);return null==t?void 0:t.VERSION}}}class f extends Error{constructor(e){var t;super(e||\"An unexpected error has occurred.\"),this.name=\"StandardError\",this.type=\"standard\",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,\"function\"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class b extends f{constructor(e){super(e||\"Unsupported browser error\"),this.name=\"UnsupportedBrowserError\",this.type=\"unsupported_browser\"}}class w extends f{constructor(e){super(e||\"Invalid arguments have been provided.\"),this.name=\"InvalidArgumentError\",this.type=\"invalid_argument\"}}class C extends w{constructor(e){let t=\"Unable to submit payment for the order because the payload is invalid.\";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(\", \")}.`),super(t),this.name=\"PaymentArgumentInvalidError\"}}class S extends f{constructor(e,t){super(t||\"Unable to proceed because the payment form contains invalid data.\"),this.details=e,this.name=\"PaymentInvalidFormError\",this.type=\"payment_invalid_form\"}}var P;!function(e){e[e.CheckoutButtonNotInitialized=0]=\"CheckoutButtonNotInitialized\",e[e.CustomerNotInitialized=1]=\"CustomerNotInitialized\",e[e.PaymentNotInitialized=2]=\"PaymentNotInitialized\",e[e.ShippingNotInitialized=3]=\"ShippingNotInitialized\",e[e.SpamProtectionNotInitialized=4]=\"SpamProtectionNotInitialized\"}(P||(P={}));class I extends f{constructor(e){super(function(e){switch(e){case P.CustomerNotInitialized:return\"Unable to proceed because the customer step of checkout has not been initialized.\";case P.PaymentNotInitialized:return\"Unable to proceed because the payment step of checkout has not been initialized.\";case P.ShippingNotInitialized:return\"Unable to proceed because the shipping step of checkout has not been initialized.\";case P.SpamProtectionNotInitialized:return\"Unable to proceed because the checkout spam protection has not been initialized.\";default:return\"Unable to proceed because the required component has not been initialized.\"}}(e)),this.subtype=e,this.name=\"NotInitializedError\",this.type=\"not_initialized\"}}class O extends f{constructor(e){super(e||\"Payment process was cancelled.\"),this.name=\"PaymentMethodCancelledError\",this.type=\"payment_cancelled\"}}class k{constructor(e){const t=new Promise((e,t)=>{this.cancel=t});this.promise=Promise.race([e,t])}}const E=[\"buttons\",\"messages\"];var T,A,z,N,M,D,_,B,x;function F(e){return Boolean(\"object\"==typeof e&&null!==e&&(\"type\"in e||\"message\"in e||\"code\"in e))}!function(e){e.HORIZONTAL=\"horizontal\",e.VERTICAL=\"vertical\"}(T||(T={})),function(e){e.SMALL=\"small\",e.MEDIUM=\"medium\",e.LARGE=\"large\",e.RESPONSIVE=\"responsive\"}(A||(A={})),function(e){e.GOLD=\"gold\",e.BLUE=\"blue\",e.SIlVER=\"silver\",e.BLACK=\"black\",e.WHITE=\"white\"}(z||(z={})),function(e){e.CHECKOUT=\"checkout\",e.PAY=\"pay\",e.BUYNOW=\"buynow\",e.PAYPAL=\"paypal\",e.CREDIT=\"credit\"}(N||(N={})),function(e){e.PILL=\"pill\",e.RECT=\"rect\"}(M||(M={})),function(e){e.CART=\"cart\",e.HOME=\"homepage\",e.PAYMENT=\"payment\",e.PRODUCT=\"product\"}(D||(D={})),function(e){e.Sandbox=\"sandbox\",e.Production=\"production\"}(_||(_={})),function(e){e.Client=\"client\",e.DataCollector=\"dataCollector\",e.Fastlane=\"fastlane\",e.GooglePayment=\"googlePayment\",e.HostedFields=\"hostedFields\",e.LocalPayment=\"localPayment\",e.Paypal=\"paypal\",e.PaypalCheckout=\"paypalCheckout\",e.ThreeDSecure=\"threeDSecure\",e.UsBankAccount=\"usBankAccount\",e.Venmo=\"venmo\",e.VisaCheckout=\"visaCheckout\"}(B||(B={})),function(e){e.CardCode=\"cardCode\",e.CardCodeVerification=\"cardCodeVerification\",e.CardExpiry=\"cardExpiry\",e.CardName=\"cardName\",e.CardNumber=\"cardNumber\",e.CardNumberVerification=\"cardNumberVerification\"}(x||(x={}));var L=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class V{constructor(e,t,i){this.braintreeScriptLoader=e,this.braintreeHostWindow=t,this.overlay=i,this.dataCollectors={}}initialize(e,t){this.clientToken=e,this.threeDSecureOptions=t}getBraintreeFastlane(e,t,i){return L(this,void 0,void 0,function*(){if(t&&(window.localStorage.setItem(\"axoEnv\",\"sandbox\"),window.localStorage.setItem(\"fastlaneEnv\",\"sandbox\")),!this.braintreeHostWindow.braintreeFastlane){const t=this.getClientTokenOrThrow(),n=yield this.getClient(),r=yield this.getSessionId(e),o=yield this.braintreeScriptLoader.loadFastlane(),a={root:{backgroundColorPrimary:\"transparent\"}};this.braintreeHostWindow.braintreeFastlane=yield o.create({authorization:t,client:n,deviceData:r,styles:i||a})}return this.braintreeHostWindow.braintreeFastlane})}getClient(){return L(this,void 0,void 0,function*(){if(!this.client){const e=this.getClientTokenOrThrow(),t=yield this.braintreeScriptLoader.loadClient();this.client=t.create({authorization:e})}return this.client})}getPaypal(){return this.braintreePaypal||(this.braintreePaypal=Promise.all([this.getClient(),this.braintreeScriptLoader.loadPaypal()]).then(([e,t])=>t.create({client:e}))),this.braintreePaypal}paypal(e){var{shouldSaveInstrument:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"shouldSaveInstrument\"]);const n=(0,_braintree_browser_detection__WEBPACK_IMPORTED_MODULE_3__.supportsPopups)();return this.getPaypal().then(e=>{var r;return n&&(null===(r=this.overlay)||void 0===r||r.show({onClick:()=>e.focusWindow()})),e.tokenize(Object.assign({enableShippingAddress:!0,flow:t?\"vault\":\"checkout\",useraction:\"commit\"},i))}).then(e=>{var t;return null===(t=this.overlay)||void 0===t||t.remove(),e}).catch(e=>{var t;throw null===(t=this.overlay)||void 0===t||t.remove(),e})}getPaypalCheckout(e,t,i){return L(this,void 0,void 0,function*(){const n=yield this.getClient(),r=yield this.braintreeScriptLoader.loadPaypalCheckout(),o={client:n};return this.paypalCheckout=yield r.create(o,(n,r)=>{var o;if(n)return i(n);const a=Object.assign(Object.assign({currency:e.currency},e.isCreditEnabled&&{\"enable-funding\":\"paylater\"}),{components:E.toString(),intent:e.intent,commit:null===(o=e.commit)||void 0===o||o});this.braintreeHostWindow.paypal?t(r):r.loadPayPalSDK(a,()=>t(r))}),this.paypalCheckout})}getDataCollector(e){return L(this,void 0,void 0,function*(){const t=(null==e?void 0:e.paypal)?\"paypal\":\"default\";let i=this.dataCollectors[t];if(!i){try{const t=yield this.getClient(),n=yield this.braintreeScriptLoader.loadDataCollector(),r=Object.assign({client:t,kount:!0},e);i=yield n.create(r)}catch(e){if(!F(e)||\"DATA_COLLECTOR_KOUNT_NOT_ENABLED\"!==e.code)throw e;i={deviceData:void 0,teardown:()=>Promise.resolve()}}this.dataCollectors[t]=i}return i})}getBraintreeEnv(e=!1){return e?_.Sandbox:_.Production}mapToBraintreeShippingAddressOverride(e){return{recipientName:`${e.firstName} ${e.lastName}`,line1:e.address1,line2:e.address2,city:e.city,state:e.stateOrProvinceCode,postalCode:e.postalCode,countryCode:e.countryCode,phone:e.phone}}mapToLegacyShippingAddress(e){const{email:t,phone:i,shippingAddress:n}=e,r=(null==n?void 0:n.recipientName)||\"\",[o,a]=r.split(\" \");return{email:t,first_name:o||\"\",last_name:a||\"\",phone_number:i,address_line_1:null==n?void 0:n.line1,address_line_2:null==n?void 0:n.line2,city:null==n?void 0:n.city,state:null==n?void 0:n.state,country_code:null==n?void 0:n.countryCode,postal_code:null==n?void 0:n.postalCode}}mapToLegacyBillingAddress(e){const{billingAddress:t,email:i,firstName:n,lastName:r,phone:o,shippingAddress:a}=e,s=t||a;return{email:i,first_name:n,last_name:r,phone_number:o,address_line_1:null==s?void 0:s.line1,address_line_2:null==s?void 0:s.line2,city:null==s?void 0:s.city,state:null==s?void 0:s.state,country_code:null==s?void 0:s.countryCode,postal_code:null==s?void 0:s.postalCode}}removeElement(e){const t=e&&document.getElementById(e);t&&t.remove()}getSessionId(e){return L(this,void 0,void 0,function*(){const{deviceData:t}=yield this.getDataCollector({riskCorrelationId:e});return t})}teardown(){return L(this,void 0,void 0,function*(){yield this.teardownModule(this.dataCollectors.default),yield this.teardownModule(this.dataCollectors.paypal),this.dataCollectors={},yield this.teardownModule(this.paypalCheckout),this.paypalCheckout=void 0})}get3DS(){return L(this,void 0,void 0,function*(){return this.threeDS||(this.threeDS=Promise.all([this.getClient(),this.braintreeScriptLoader.load3DS()]).then(([e,t])=>t.create({client:e,version:2}))),this.threeDS})}getVenmoCheckout(e){return L(this,void 0,void 0,function*(){if(!this.venmoCheckout){const t=yield this.getClient(),i=yield this.braintreeScriptLoader.loadVenmoCheckout(),n=Object.assign({client:t,allowDesktop:!0,paymentMethodUsage:\"multi_use\"},e||{});this.venmoCheckout=yield new Promise((e,t)=>{i.create(n,(i,n)=>i?t(i):n.isBrowserSupported()?void e(n):t(new b))})}return this.venmoCheckout})}verifyCard(e,t,i){return L(this,void 0,void 0,function*(){const n=yield this.tokenizeCard(e,t);return this.challenge3DSVerification(n,i)})}tokenizeCard(e,t){return L(this,void 0,void 0,function*(){const{paymentData:i}=e;if(!function(e){if(\"object\"!=typeof e||null===e)return!1;const t=e;return\"object\"==typeof t.ccExpiry&&null!==t.ccExpiry&&\"string\"==typeof t.ccNumber&&\"string\"==typeof t.ccName}(i))throw new C([\"payment.paymentData\"]);const r=this.getErrorsRequiredFields(i);if(!(0,lodash__WEBPACK_IMPORTED_MODULE_2__.isEmpty)(r))throw new S(r);const o=this.mapToCreditCard(i,t),a=yield this.getClient(),{creditCards:s}=yield a.request(o);return{nonce:s[0].nonce,bin:s[0].details.bin}})}challenge3DSVerification(e,t){return L(this,void 0,void 0,function*(){const i=yield this.get3DS();return this.present3DSChallenge(i,t,e)})}teardownModule(e){return e?e.teardown():Promise.resolve()}getClientTokenOrThrow(){if(!this.clientToken)throw new I(P.PaymentNotInitialized);return this.clientToken}getErrorsRequiredFields(e){const{ccNumber:t,ccExpiry:i}=e,n={};return t||(n.ccNumber=[{message:\"Credit card number is required\",type:\"required\"}]),i||(n.ccExpiry=[{message:\"Expiration date is required\",type:\"required\"}]),n}mapToCreditCard(e,t){return{data:{creditCard:{cardholderName:e.ccName,number:e.ccNumber,cvv:e.ccCvv,expirationDate:`${e.ccExpiry.month}/${e.ccExpiry.year}`,options:{validate:!1},billingAddress:t&&{countryCodeAlpha2:t.countryCode,locality:t.city,countryName:t.country,postalCode:t.postalCode,streetAddress:t.address2?`${t.address1} ${t.address2}`:t.address1}}},endpoint:\"payment_methods/credit_cards\",method:\"post\"}}present3DSChallenge(e,t,i){const{nonce:n,bin:r}=i;if(!this.threeDSecureOptions||!n)throw new I(P.PaymentNotInitialized);const{addFrame:o,removeFrame:a,challengeRequested:s=!0,additionalInformation:d}=this.threeDSecureOptions,l=()=>L(this,void 0,void 0,function*(){const t=yield e.cancelVerifyCard();return u.cancel(new O),t}),c=t.toFixed(2),u=new k(e.verifyCard({addFrame:(e,t)=>{o&&o(e,t,l)},amount:Number(c),bin:r,challengeRequested:s,nonce:n,removeFrame:a,onLookupComplete:(e,t)=>{t()},collectDeviceData:!0,additionalInformation:d}));return u.promise}}class j extends f{constructor(e){super(e||\"Unable to proceed because the client library of a payment method is not loaded or ready to be used.\"),this.name=\"PaymentMethodClientUnavailableError\",this.type=\"payment_method_client_unavailable\"}}const U={[g]:{[B.Client]:\"sha384-26BXDNnJI23JYRyFBj4xe4sVNrUSSiSSu11kxVXNM/vEPONm4LuL00w6ZaTgQewt\",[B.PaypalCheckout]:\"sha384-B+vzbZwnQtzWBthpkT4TXKUibO65tyeK7eCxSvpblgprTep2+IAXB2Cxxjrn710O\",[B.Paypal]:\"sha384-uyAGL1/3+XJAHnGoNy4eCoXdzJ4f7Ilzp+6w9PNnEjs6DCCz9WMyJjMN1gzc78U+\",[B.LocalPayment]:\"sha384-LIvOEMkIVEwVuYBdVOQc1AC5YbGGlwyfUheS0ACK218D2STuVYQlZ4FyEPowAEfT\",[B.DataCollector]:\"sha384-1bo9JDz+Kscthc085cCKWur8CLwUoBpoNyxsDi7932mCl0zFq3A5mv+FQLw9GHpV\",[B.UsBankAccount]:\"sha384-xmHBVaU+w74V+OebD3AaPONFxHUGMf+QRs8G/JxVPXNNP7MDa2jL0ICWHIe2tTfJ\",[B.GooglePayment]:\"sha384-WKDJl8mqoP82qZpMGH6AbZxnvXnSW8ILV4M64CyMLiugGMwu7LyP89wjCkHqsiBe\",[B.ThreeDSecure]:\"sha384-VQUlpGHzsGvs5XeiGFip7EXRsvoHWEXDVmgCacfbyieZI9mdBOqq3NSoyo28OCOB\",[B.VisaCheckout]:\"sha384-yx7mADfzTN0T43Q6rlH49LIg1EJ0iUZgBp/EczX9LXsUGkySgxrD+nWHQRBkyfoT\",[B.Venmo]:\"sha384-QX4rPjoj1ZDhuG0aSyKs56lEKDqTMTcjYxUHY1SzO5VZDsqIE2NTkqot7KNSCyov\",[B.HostedFields]:\"sha384-VvYBACfSu0Cr/J32uKmxG7AXcNOJE1AzIIL3kbikyS7YKp5fz5Is+NzNP/lyauNy\",[B.Fastlane]:\"sha384-9oGsZMRZwpGtDEDYa/dFt76dECqj1xAni9gIKgc3KfMIiRnR73nEeeUDLiBzxhFa\"},[p]:{[B.Client]:\"sha384-o+nbQGcwNNxIBeXeu3+XmbSq+Cg8R3EN3N0l5hXCgMMU2RGY0t1z0LroSEIAbfAO\",[B.PaypalCheckout]:\"sha384-WrfbWPBS4mH86GAoycPSgiH8hQ8KH7A67C93Hjhunv/xhNk2YpBn3wbFA4Fhg9U/\",[B.Paypal]:\"sha384-VF389nvvrRUgDsTXMxTYORDtVegB9IQa3Cxr//DyJnLYnz8/X8VCzEvck2c+Megt\",[B.LocalPayment]:\"sha384-tZKx2rEQbfmZpoPSY5VPmJEhaq4X75dLvwHMs3VE9U+C8lPyw+hWTIL1+GPvWCIH\",[B.DataCollector]:\"sha384-E6k3wOpP7syCDDwaRDLF06942Y00NkbwJvWi2OQXwwKzGwG5fd3E7RFUvCCecfvO\",[B.UsBankAccount]:\"sha384-258FON8LZGG0W9Qaz4Jij83pZHu30YnKjJA7gNulLBh6CclkucgF+tHDQuYFRYfW\",[B.GooglePayment]:\"sha384-taJ2p/0+n0VH328POAoBiuEbL3tnHUTE9S42hK1V+Txs3X+QYjZOyKW35JgHRFfO\",[B.ThreeDSecure]:\"sha384-+NSZH4Zj3sO5bdWvPKhU5N16QDxeueTVTnUVeleeESkhLSaz4Ob1hh/5myecc9Ym\",[B.VisaCheckout]:\"sha384-66DiBjghxk1OmBj8aksN8gbQ+CwoQcx1vPfiXUN08g1iQVM+BwewF0p7toM3i7SS\",[B.Venmo]:\"sha384-B5UwY42kE4RoLoWbQ7YpqosUlUad2/DlGWiw0HhoZbSPk30CQAaSA10ohyLDTkDU\",[B.HostedFields]:\"sha384-Aw9EesSaUeWxe36PqEHiOyOyOq8M6CIb1gw7/yHNVPRzGtFXXcd2OQ8qXrIlOj2P\",[B.Fastlane]:\"sha384-rhBL1hpZ71JqG+2TsT0Dih47mbjx8cjJCpeZjk9tw3df1gFMKfCTmMyZunhr7H4Y\"},[m]:{[B.Client]:\"sha384-0WNxksIpRP+fYZiIdr12g6DBUQfLDzYCQJZtR/C8KkcwSGhPHfcFp3tTaGcMyFTq\",[B.PaypalCheckout]:\"sha384-lWM1jk4BOxoDNV6Kop7tVNvQgINlmEVz0c/OwM+HNHK3QC8xqwd54Ovrt2QRDTjh\",[B.Paypal]:\"sha384-fXUmVxC2EMZBDXZ7eTHSTL/LFBrHej/MSXT/vTBXvra4lzgLNGvREAp+x0GYObuH\",[B.LocalPayment]:\"sha384-pha1xGuGSkmZH5x9aqHvRaO4xLea7rmQ/79PFj9zxNzxuFcOWZg7gOP7FibygOEC\",[B.DataCollector]:\"sha384-Q6PI2F9eekWbAxhroybl+aEcvqhdowN/EQlGwBUyJOzPFn9982u9xl6SU6XfGKzc\",[B.UsBankAccount]:\"sha384-W3RLQSKJL1tQ3+Y7mP6tmkamtZ8bV4Yw/XxL9Jj5JtXHraD8loMF8hAIG5m2zK7F\",[B.GooglePayment]:\"sha384-TITQMsFWA3elDNGP2mWz2oKBo4qjt+TlqzovcaPoeBiAh/wPBi6nae50ADdgU1/i\",[B.ThreeDSecure]:\"sha384-YiycYN89ZlL/Evcaq4y1ajW1mhd7JYfZBDuOwHtIn4/Jnm20GL+/XCM+zYAwWD8D\",[B.VisaCheckout]:\"sha384-/OdaTv9qrkKzjObtUe6yzfDhHozFW/+uXlrSl736sOZRJpjGQETvpYXqMFFg69xv\",[B.Venmo]:\"sha384-dA+ojdW9vbJS4JavcXyOs9d5uZHJg5dNtYupoPSH2zsXIiYDVS5amLb/u8qmQ6oz\",[B.HostedFields]:\"sha384-31ZkS58+iaWsW06ftW52zzVZFp43WPd7pNYRiddYynSNg6Oh7WGbSFGorAUH6T1z\",[B.Fastlane]:\"sha384-jlbrwNvL3HvLAUCtLSmrnQ2GH1udCUrRS/bVmReAS5fuIVvcW8Pko/Gkg82tlgtr\"}};var R,H=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class W{constructor(e,t,i){this.scriptLoader=e,this.braintreeHostWindow=t,this.braintreeSDKVersionManager=i}loadClient(){return H(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(B.Client,\"client.min.js\")})}loadFastlane(){return H(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(B.Fastlane,\"fastlane.min.js\")})}loadPaypalCheckout(){return H(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(B.PaypalCheckout,\"paypal-checkout.min.js\")})}loadPaypal(){return H(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(B.Paypal,\"paypal.min.js\")})}loadLocalPayment(){return H(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(B.LocalPayment,\"local-payment.min.js\")})}loadDataCollector(){return H(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(B.DataCollector,\"data-collector.min.js\")})}loadUsBankAccount(){return H(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(B.UsBankAccount,\"us-bank-account.min.js\")})}loadGooglePayment(){return H(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(B.GooglePayment,\"google-payment.min.js\")})}load3DS(){return H(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(B.ThreeDSecure,\"three-d-secure.min.js\")})}loadVisaCheckout(){return this.loadBraintreeModuleOrThrow(B.VisaCheckout,\"visa-checkout.min.js\")}loadVenmoCheckout(){return this.loadBraintreeModuleOrThrow(B.Venmo,\"venmo.min.js\")}loadHostedFields(){return H(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(B.HostedFields,\"hosted-fields.min.js\")})}loadVisaCheckoutSdk(e){return H(this,void 0,void 0,function*(){if(this.braintreeHostWindow.V)return this.braintreeHostWindow.V;const t=e?\"sha384-0eu1s1GtqzXlL9DtLgmwzC5WWlEH/ADRM0n38cVQkvtT+W/gey96rcb1LwuUOPDm\":\"sha384-1f1csvP3ZFxg4dILH1GaY4LHlZ0oX7Rk83rxmLlwbnIi4TM0NYzXoev1VoEiVDS6\";return this.scriptLoader.loadScript(`//${e?\"sandbox-\":\"\"}assets.secure.checkout.visa.com/checkout-widget/resources/js/integration/v1/sdk.js`,{async:!0,attributes:{integrity:t,crossorigin:\"anonymous\"}}).then(()=>{if(!this.braintreeHostWindow.V)throw new j;return this.braintreeHostWindow.V})})}loadBraintreeModuleOrThrow(e,t){return H(this,void 0,void 0,function*(){let i=this.getBraintreeModule(e);if(i)return i;const n=this.braintreeSDKVersionManager.getSDKVersion(),r=`//js.braintreegateway.com/web/${n}/js/${t}`,o=n in U?this.getIntegrityValuesByModuleName(e,n):void 0;if(yield this.scriptLoader.loadScript(r,o?{async:!0,attributes:{integrity:o,crossorigin:\"anonymous\"}}:void 0),i=this.getBraintreeModule(e),!i)throw new j;return i})}getBraintreeModule(e){var t;return null===(t=this.braintreeHostWindow.braintree)||void 0===t?void 0:t[e]}getIntegrityValuesByModuleName(e,t){const i=U[t][e];if(!i)throw new Error(\"Unexpected fileName value\");return i}}function q(e,t){return Object.assign(e,{resolveIds:t})}!function(e){e[e.MissingBillingAddress=0]=\"MissingBillingAddress\",e[e.MissingCart=1]=\"MissingCart\",e[e.MissingCheckout=2]=\"MissingCheckout\",e[e.MissingConsignments=3]=\"MissingConsignments\",e[e.MissingCustomer=4]=\"MissingCustomer\",e[e.MissingCheckoutConfig=5]=\"MissingCheckoutConfig\",e[e.MissingOrder=6]=\"MissingOrder\",e[e.MissingOrderConfig=7]=\"MissingOrderConfig\",e[e.MissingOrderId=8]=\"MissingOrderId\",e[e.MissingPayment=9]=\"MissingPayment\",e[e.MissingPaymentId=10]=\"MissingPaymentId\",e[e.MissingPaymentInstrument=11]=\"MissingPaymentInstrument\",e[e.MissingPaymentMethod=12]=\"MissingPaymentMethod\",e[e.MissingPaymentRedirectUrl=13]=\"MissingPaymentRedirectUrl\",e[e.MissingPaymentStatus=14]=\"MissingPaymentStatus\",e[e.MissingPaymentToken=15]=\"MissingPaymentToken\",e[e.MissingShippingAddress=16]=\"MissingShippingAddress\"}(R||(R={}));class $ extends f{constructor(e){super(function(e){switch(e){case R.MissingBillingAddress:return\"Unable to proceed because billing address data is unavailable.\";case R.MissingCart:return\"Unable to proceed because cart data is unavailable.\";case R.MissingConsignments:return\"Unable to proceed because consignments data is unavailable.\";case R.MissingCheckout:return\"Unable to proceed because checkout data is unavailable.\";case R.MissingCustomer:return\"Unable to proceed because customer data is unavailable.\";case R.MissingCheckoutConfig:case R.MissingOrderConfig:return\"Unable to proceed because configuration data is unavailable.\";case R.MissingOrder:return\"Unable to proceed because order data is unavailable.\";case R.MissingOrderId:return\"Unable to proceed because order ID is unavailable or not generated yet.\";case R.MissingPayment:return\"Unable to proceed because payment data is unavailable.\";case R.MissingPaymentToken:return\"Unable to proceed because the token required to submit a payment is missing.\";case R.MissingPaymentMethod:return\"Unable to proceed because payment method data is unavailable or not properly configured.\";case R.MissingShippingAddress:return\"Unable to proceed because shipping address data is unavailable.\";default:return\"Unable to proceed because the required data is unavailable.\"}}(e)),this.subtype=e,this.name=\"MissingDataError\",this.type=\"missing_data\"}}var G=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Y{constructor(e,t,i,n){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeHostWindow=n}initialize(e){return G(this,void 0,void 0,function*(){const{braintreepaypal:t,methodId:i}=e,{container:n,onError:r}=t||{};if(!i)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new w('Unable to initialize payment because \"options.braintreepaypal\" argument is not provided.');if(!n)throw new w('Unable to initialize payment because \"options.braintreepaypal.container\" argument is not provided.');let o,a=this.paymentIntegrationService.getState();try{if(o=a.getPaymentMethodOrThrow(i),!o.clientToken)throw new $(R.MissingPaymentToken)}catch(e){a=yield this.paymentIntegrationService.loadPaymentMethod(i),o=a.getPaymentMethodOrThrow(i)}const{clientToken:s,config:d,initializationData:l}=o,{paymentButtonStyles:c}=l||{},{checkoutTopButtonStyles:u}=c||{};if(!s||!l)throw new $(R.MissingPaymentMethod);const h={currency:a.getCartOrThrow().currency.code,intent:l.intent,isCreditEnabled:l.isCreditEnabled,commit:!1};this.braintreeIntegrationService.initialize(s),yield this.braintreeIntegrationService.getPaypalCheckout(h,e=>{this.renderPayPalButton(e,t,i,Boolean(d.testMode),u)},e=>this.handleError(e,n,r))})}deinitialize(){return G(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}signIn(e,t){return G(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return G(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}renderPayPalButton(e,t,i,n,r){const{container:o,onClick:s=lodash__WEBPACK_IMPORTED_MODULE_2__.noop}=t,{paypal:d}=this.braintreeHostWindow,l=null==d?void 0:d.FUNDING.PAYPAL;if(d&&l){const a=d.Buttons({env:this.braintreeIntegrationService.getBraintreeEnv(n),fundingSource:l,style:Object.assign(Object.assign({},r),{height:40}),createOrder:()=>this.setupPayment(e,t,i),onApprove:n=>this.tokenizePayment(n,e,i,t),onClick:s});a.isEligible()&&a.render(`#${o}`)}else this.braintreeIntegrationService.removeElement(o)}setupPayment(e,t,i){var n;return G(this,void 0,void 0,function*(){try{yield this.paymentIntegrationService.loadDefaultCheckout();const t=this.paymentIntegrationService.getState(),r=t.getCheckoutOrThrow().outstandingBalance,o=t.getCartOrThrow().currency.code,a=t.getCustomer(),s=t.getPaymentMethodOrThrow(i),d=null==a?void 0:a.addresses[0],l=d?this.braintreeIntegrationService.mapToBraintreeShippingAddressOverride(d):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:l,amount:r,currency:o,offerCredit:!1,intent:null===(n=s.initializationData)||void 0===n?void 0:n.intent})}catch(e){const{container:i,onError:n}=t;this.handleError(e,i,n)}})}tokenizePayment(e,t,i,n){return G(this,void 0,void 0,function*(){try{const{deviceData:n}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),r=yield t.tokenizePayment(e),{details:o,nonce:a}=r,s=this.braintreeIntegrationService.mapToLegacyBillingAddress(o),d=this.braintreeIntegrationService.mapToLegacyShippingAddress(o);return this.formPoster.postForm(\"/checkout.php\",{payment_type:\"paypal\",provider:i,action:\"set_external_checkout\",nonce:a,device_data:n,billing_address:JSON.stringify(s),shipping_address:JSON.stringify(d)}),r}catch(e){const{container:t,onError:i}=n;this.handleError(e,t,i)}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!F(e))throw e;i(e)}}const J=q(i=>{const n=window,r=new v(i),o=new V(new W((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),n,r),n);return new Y(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),o,n)},[{id:\"braintreepaypal\"}]);var K=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class X{constructor(e,t,i,n){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeHostWindow=n}initialize(e){return K(this,void 0,void 0,function*(){const{braintreepaypalcredit:t,methodId:i}=e,{container:n,onError:r}=t||{};if(!i)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new w('Unable to initialize payment because \"options.braintreepaypalcredit\" argument is not provided.');if(!n)throw new w('Unable to initialize payment because \"options.braintreepaypalcredit.container\" argument is not provided.');let o,a=this.paymentIntegrationService.getState();try{if(o=a.getPaymentMethodOrThrow(i),!o.clientToken)throw new $(R.MissingPaymentToken)}catch(e){a=yield this.paymentIntegrationService.loadPaymentMethod(i),o=a.getPaymentMethodOrThrow(i)}const{clientToken:s,config:d,initializationData:l}=o,{paymentButtonStyles:c}=l||{},{checkoutTopButtonStyles:u}=c||{};if(!s||!l)throw new $(R.MissingPaymentMethod);const h={currency:a.getCartOrThrow().currency.code,intent:l.intent,isCreditEnabled:l.isCreditEnabled,commit:!1};this.braintreeIntegrationService.initialize(s),yield this.braintreeIntegrationService.getPaypalCheckout(h,e=>{this.renderPayPalButton(e,t,i,Boolean(d.testMode),Object.assign(Object.assign({},u),{height:40}))},e=>this.handleError(e,n,r))})}deinitialize(){return K(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}signIn(e,t){return K(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return K(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}renderPayPalButton(e,t,i,n,r){const{container:o,onClick:s=lodash__WEBPACK_IMPORTED_MODULE_2__.noop}=t,{paypal:d}=this.braintreeHostWindow;let l=!1;d&&[d.FUNDING.PAYLATER,d.FUNDING.CREDIT].forEach(a=>{if(!l){const c=d.Buttons({env:n?\"sandbox\":\"production\",fundingSource:a,style:r,createOrder:()=>this.setupPayment(e,t,i),onApprove:n=>this.tokenizePayment(n,e,i,t),onClick:s});c.isEligible()&&(c.render(`#${o}`),l=!0)}}),d&&l||this.braintreeIntegrationService.removeElement(o)}setupPayment(e,t,i){var n;return K(this,void 0,void 0,function*(){try{yield this.paymentIntegrationService.loadDefaultCheckout();const t=this.paymentIntegrationService.getState(),r=t.getCheckoutOrThrow().outstandingBalance,o=t.getCartOrThrow().currency.code,a=t.getCustomer(),s=t.getPaymentMethodOrThrow(i),d=null==a?void 0:a.addresses[0],l=d?this.braintreeIntegrationService.mapToBraintreeShippingAddressOverride(d):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:l,amount:r,currency:o,offerCredit:!0,intent:null===(n=s.initializationData)||void 0===n?void 0:n.intent})}catch(e){const{container:i,onError:n}=t;this.handleError(e,i,n)}})}tokenizePayment(e,t,i,n){return K(this,void 0,void 0,function*(){try{const{deviceData:n}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),r=yield t.tokenizePayment(e),{details:o,nonce:a}=r,s=this.braintreeIntegrationService.mapToLegacyBillingAddress(o),d=this.braintreeIntegrationService.mapToLegacyShippingAddress(o);return this.formPoster.postForm(\"/checkout.php\",{payment_type:\"paypal\",provider:i,action:\"set_external_checkout\",nonce:a,device_data:n,billing_address:JSON.stringify(s),shipping_address:JSON.stringify(d)}),r}catch(e){const{container:t,onError:i}=n;this.handleError(e,t,i)}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!F(e))throw e;i(e)}}const Q=q(i=>{const n=window,r=new v(i),o=new V(new W((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),n,r),n);return new X(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),o,n)},[{id:\"braintreepaypalcredit\"}]);function Z(e){return\"string\"!=typeof e}function ee(e,t){if(t||e)return function(e){var t,i;const n={},r=(0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)(e.root,Z),o=(0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)(e.input,Z),a=(0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)(e.toggle,Z),s=(0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)(null===(t=e.text)||void 0===t?void 0:t.body,Z),l=(0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)(null===(i=e.text)||void 0===i?void 0:i.caption,Z),c=e.branding;return Object.keys(r).length&&(n.root=r),Object.keys(o).length&&(n.input=o),Object.keys(a).length&&(n.toggle=a),Object.keys(s).length&&(n.text={},n.text.body=s),Object.keys(l).length&&(n.text=Object.assign({},n.text),n.text.caption=l),c&&(n.branding=c),n}(function(e,t){var i,n,r,o,a,s,d,l,c,u,h,y,m,p,g,v,f,b,w,C,S,P;return{root:{backgroundColorPrimary:(null==e?void 0:e.fastlaneRootSettingsBackgroundColor)||(null===(i=null==t?void 0:t.root)||void 0===i?void 0:i.backgroundColorPrimary),errorColor:(null==e?void 0:e.fastlaneRootSettingsErrorColor)||(null===(n=null==t?void 0:t.root)||void 0===n?void 0:n.errorColor),fontFamily:(null==e?void 0:e.fastlaneRootSettingsFontFamily)||(null===(r=null==t?void 0:t.root)||void 0===r?void 0:r.fontFamily),fontSizeBase:(null==e?void 0:e.fastlaneRootSettingsFontSize)||(null===(o=null==t?void 0:t.root)||void 0===o?void 0:o.fontSizeBase),padding:(null==e?void 0:e.fastlaneRootSettingsPadding)||(null===(a=null==t?void 0:t.root)||void 0===a?void 0:a.padding),primaryColor:(null==e?void 0:e.fastlaneRootSettingsPrimaryColor)||(null===(s=null==t?void 0:t.root)||void 0===s?void 0:s.primaryColor)},input:{borderRadius:(null==e?void 0:e.fastlaneInputSettingsBorderRadius)||(null===(d=null==t?void 0:t.input)||void 0===d?void 0:d.borderRadius),borderColor:(null==e?void 0:e.fastlaneInputSettingsBorderColor)||(null===(l=null==t?void 0:t.input)||void 0===l?void 0:l.borderColor),focusBorderColor:(null==e?void 0:e.fastlaneInputSettingsFocusBorderBase)||(null===(c=null==t?void 0:t.input)||void 0===c?void 0:c.focusBorderColor),backgroundColor:(null==e?void 0:e.fastlaneInputSettingsBackgroundColor)||(null===(u=null==t?void 0:t.input)||void 0===u?void 0:u.backgroundColor),borderWidth:(null==e?void 0:e.fastlaneInputSettingsBorderWidth)||(null===(h=null==t?void 0:t.input)||void 0===h?void 0:h.borderWidth),textColorBase:(null==e?void 0:e.fastlaneInputSettingsTextColorBase)||(null===(y=null==t?void 0:t.input)||void 0===y?void 0:y.textColorBase)},toggle:{colorPrimary:(null==e?void 0:e.fastlaneToggleSettingsColorPrimary)||(null===(m=null==t?void 0:t.toggle)||void 0===m?void 0:m.colorPrimary),colorSecondary:(null==e?void 0:e.fastlaneToggleSettingsColorSecondary)||(null===(p=null==t?void 0:t.toggle)||void 0===p?void 0:p.colorSecondary)},text:{body:{color:(null==e?void 0:e.fastlaneTextBodySettingsColor)||(null===(v=null===(g=null==t?void 0:t.text)||void 0===g?void 0:g.body)||void 0===v?void 0:v.color),fontSize:(null==e?void 0:e.fastlaneTextBodySettingsFontSize)||(null===(b=null===(f=null==t?void 0:t.text)||void 0===f?void 0:f.body)||void 0===b?void 0:b.fontSize)},caption:{color:(null==e?void 0:e.fastlaneTextCaptionSettingsColor)||(null===(C=null===(w=null==t?void 0:t.text)||void 0===w?void 0:w.caption)||void 0===C?void 0:C.color),fontSize:(null==e?void 0:e.fastlaneTextCaptionSettingsFontSize)||(null===(P=null===(S=null==t?void 0:t.text)||void 0===S?void 0:S.caption)||void 0===P?void 0:P.fontSize)}},branding:(null==e?void 0:e.fastlaneBrandingSettings)||(null==t?void 0:t.branding)}}(e,t))}var te,ie,ne,re,oe,ae,se,de,le=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ce{constructor(e,t){this.paymentIntegrationService=e,this.braintreeFastlaneUtils=t,this.isAcceleratedCheckoutEnabled=!1}initialize({methodId:e,braintreefastlane:t}){var i;return le(this,void 0,void 0,function*(){if(!e)throw new w('Unable to proceed because \"methodId\" argument is not provided.');const n=yield this.getValidPaymentMethodOrThrow(e),{isAcceleratedCheckoutEnabled:r,isFastlaneStylingEnabled:o}=n.initializationData||{},a=o?null===(i=n.initializationData)||void 0===i?void 0:i.fastlaneStyles:void 0;this.isAcceleratedCheckoutEnabled=!!r;try{if(this.isAcceleratedCheckoutEnabled){const e=ee(a,null==t?void 0:t.styles);yield this.braintreeFastlaneUtils.initializeBraintreeFastlaneOrThrow(n.id,e)}}catch(e){}return Promise.resolve()})}deinitialize(){return le(this,void 0,void 0,function*(){return Promise.resolve()})}signIn(e,t){return le(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return le(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){return le(this,void 0,void 0,function*(){const{checkoutPaymentMethodExecuted:t,continueWithCheckoutCallback:i}=e||{};if(\"function\"!=typeof i)throw new w('Unable to proceed because \"continueWithCheckoutCallback\" argument is not provided and it must be a function.');const n=this.paymentIntegrationService.getState().getCustomerOrThrow();if(this.isAcceleratedCheckoutEnabled&&n.isGuest){const e=yield this.shouldRunAuthenticationFlow();t&&\"function\"==typeof t&&t(),e&&(yield this.braintreeFastlaneUtils.runPayPalAuthenticationFlowOrThrow(void 0,!0))}i()})}shouldRunAuthenticationFlow(){var e;return le(this,void 0,void 0,function*(){const t=\"braintreeacceleratedcheckout\";try{yield this.paymentIntegrationService.loadPaymentMethod(t);const i=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t);return(null===(e=i.initializationData)||void 0===e?void 0:e.shouldRunAcceleratedCheckout)||!1}catch(e){return!1}})}getValidPaymentMethodOrThrow(e){return le(this,void 0,void 0,function*(){let t=e;try{yield this.paymentIntegrationService.loadPaymentMethod(t)}catch(i){t=\"braintree\"===e?\"braintreeacceleratedcheckout\":\"braintree\",yield this.paymentIntegrationService.loadPaymentMethod(t)}return this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t)})}}!function(e){e.ESTIMATED=\"ESTIMATED\",e.FINAL=\"FINAL\",e.NOT_CURRENTLY_KNOWN=\"NOT_CURRENTLY_KNOWN\"}(te||(te={})),function(e){e.Completed=\"COMPLETED\",e.Pending=\"PENDING\",e.Failed=\"FAILED\"}(ie||(ie={})),function(e){e.TRUSTLY=\"trustly\"}(ne||(ne={})),function(e){e.SUCCEEDED=\"succeeded\",e.FAILED=\"failed\",e.CANCELED=\"cancelled\",e.UNRECOGNIZED=\"unrecognized\"}(re||(re={})),function(e){e.Customer=\"CUSTOMER\",e.Merchant=\"MERCHANT\",e.Network=\"NETWORK\",e.Internal=\"INTERNAL\",e.Unknown=\"UNKNOWN\"}(oe||(oe={})),function(e){e.KountNotEnabled=\"DATA_COLLECTOR_KOUNT_NOT_ENABLED\"}(ae||(ae={})),function(e){e.Visa=\"visa\",e.Mastercard=\"mastercard\",e.AmericanExpress=\"american-express\",e.DinersClub=\"diners-club\",e.Discover=\"discover\",e.Jcb=\"jcb\",e.UnionPay=\"union-pay\",e.Maestro=\"maestro\",e.Elo=\"elo\",e.Mir=\"mir\",e.Hiper=\"hiper\",e.Hipercard=\"hipercard\"}(se||(se={})),function(e){e.CVV=\"cvv\",e.PAN=\"pan\"}(de||(de={}));class ue{static get(e){const t=`${encodeURIComponent(`${e}`)}=`,i=document.cookie;let n=null;const r=i.indexOf(t);if(r>-1){let e=i.indexOf(\";\",r);-1===e&&(e=i.length),n=decodeURIComponent(i.substring(r+t.length,e))}return n}static set(e,t,i={secure:!0}){let n=`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;const{expires:r,path:o,domain:a,secure:s}=i;if(r)n+=`; expires=${r.toUTCString()}`;else{const e=new Date,t=60;e.setTime(e.getTime()+60*t*1e3),n+=`; expires=${e.toUTCString()}`}o&&(n+=`; path=${o}`),a&&(n+=`; domain=${a}`),s&&(n+=\"; secure\"),document.cookie=n}static remove(e,t){ue.set(e,\"\",Object.assign({expires:new Date(0)},t))}}var he=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ye{constructor(e,t){this.paymentIntegrationService=e,this.braintreeIntegrationService=t}getDeviceSessionId(){return he(this,void 0,void 0,function*(){const e=this.paymentIntegrationService.getState().getCart();return this.braintreeIntegrationService.getSessionId(null==e?void 0:e.id)})}initializeBraintreeFastlaneOrThrow(e,t){return he(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState(),n=i.getCart(),{clientToken:r,config:o}=i.getPaymentMethodOrThrow(e);if(!r)throw new $(R.MissingPaymentMethod);this.methodId=e,this.braintreeIntegrationService.initialize(r),this.braintreeFastlane=yield this.braintreeIntegrationService.getBraintreeFastlane(null==n?void 0:n.id,o.testMode,t)})}getBraintreeFastlaneOrThrow(){if(!this.braintreeFastlane)throw new j;return this.braintreeFastlane}getBraintreeFastlaneComponentOrThrow(){return this.getBraintreeFastlaneOrThrow().FastlaneCardComponent}runPayPalAuthenticationFlowOrThrow(e,t){var i;return he(this,void 0,void 0,function*(){try{const n=this.getMethodIdOrThrow(),r=this.getBraintreeFastlaneOrThrow(),{lookupCustomerByEmail:o,triggerAuthenticationFlow:a}=r.identity,s=this.paymentIntegrationService.getState(),d=s.getCartOrThrow(),l=s.getCustomer(),c=s.getBillingAddress(),{isFastlaneShippingOptionAutoSelectEnabled:u}=s.getPaymentMethodOrThrow(n).initializationData||{},h=e||(null==l?void 0:l.email)||(null==c?void 0:c.email)||\"\",{customerContextId:y}=yield o(h);if(!y)return yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:re.UNRECOGNIZED,addresses:[],instruments:[]}),void this.saveSessionIdToCookies(d.id);const{authenticationState:m,profileData:p}=yield a(y),g=(null===(i=null==p?void 0:p.shippingAddress)||void 0===i?void 0:i.phoneNumber)||\"\";if(m===re.CANCELED)return yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:m,addresses:[],instruments:[]}),void this.removeSessionIdFromCookies();const v=this.mapPayPalToBcAddress([p.shippingAddress],[g])||[],f=this.getPayPalBillingAddresses(p),b=f?this.mapPayPalToBcAddress([f],[g]):[],w=p.card?this.mapPayPalToBcInstrument(n,[p.card]):[],C=this.mergeShippingAndBillingAddresses(v,b);if(this.saveSessionIdToCookies(d.id),yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:m,addresses:C,instruments:w}),b.length>0&&d.lineItems.physicalItems.length>0&&(yield this.paymentIntegrationService.updateBillingAddress(b[0])),b.length>0&&d.lineItems.digitalItems.length>0&&0===d.lineItems.physicalItems.length){const{firstName:e,lastName:t}=C[0],i=Object.assign(Object.assign({},b[0]),{firstName:e,lastName:t});yield this.paymentIntegrationService.updateBillingAddress(i)}v.length>0&&d.lineItems.physicalItems.length>0&&(yield this.paymentIntegrationService.updateShippingAddress(v[0]),t&&u&&(yield this.setShippingOption()))}catch(e){}})}getSessionIdFromCookies(){return ue.get(\"bc-fastlane-sessionId\")||\"\"}saveSessionIdToCookies(e){const t=new Date;t.setDate(t.getDate()+14),ue.set(\"bc-fastlane-sessionId\",e,{expires:t,secure:!0})}removeSessionIdFromCookies(){ue.remove(\"bc-fastlane-sessionId\")}mapPayPalToBcInstrument(e,t){if(t)return t.map(t=>{const{id:i,paymentSource:n}=t,{brand:r,expiry:o,lastDigits:a,binDetails:s}=n.card,[d,l]=o.split(\"-\");return{bigpayToken:i,brand:r,defaultInstrument:!1,expiryMonth:l,expiryYear:d,iin:(null==s?void 0:s.bin)||\"\",last4:a,method:e,provider:e,trustedShippingAddress:!1,type:\"card\",untrustedShippingCardVerificationMode:de.PAN}})}mapPayPalToBcAddress(e,t){if(!e)return[];const i=this.paymentIntegrationService.getState().getCountries()||[],n=e=>{const t=i.find(t=>t.code===e);return(null==t?void 0:t.name)||\"\"};return e.map(e=>({id:Date.now(),type:\"paypal-address\",firstName:e.firstName||\"\",lastName:e.lastName||\"\",company:e.company||\"\",address1:e.streetAddress,address2:e.extendedAddress||\"\",city:e.locality,stateOrProvince:e.region,stateOrProvinceCode:e.region,country:n(e.countryCodeAlpha2),countryCode:e.countryCodeAlpha2,postalCode:e.postalCode,phone:t&&t[0]||\"\",customFields:[]}))}getPayPalBillingAddresses(e){const{card:t,name:i}=e||{};if(!t)return;const{firstName:n,lastName:o}=t.paymentSource.card.billingAddress,{firstName:a,lastName:s}=i||{},{shippingAddress:d}=e||{},l=Object.assign(Object.assign({},t.paymentSource.card.billingAddress),{firstName:n||a,lastName:o||s});return d&&(0,lodash__WEBPACK_IMPORTED_MODULE_2__.isEqual)(this.normalizeAddress(l),this.normalizeAddress(d))?d:l}normalizeAddress(e){return (0,lodash__WEBPACK_IMPORTED_MODULE_2__.omit)(e,[\"id\"])}mergeShippingAndBillingAddresses(e,t){const i=t.filter(t=>!e.some(e=>(0,lodash__WEBPACK_IMPORTED_MODULE_2__.isEqual)(this.normalizeAddress(e),this.normalizeAddress(t))));return[...e,...i]}getMethodIdOrThrow(){if(!this.methodId)throw new w('Unable to proceed because \"methodId\" argument is not provided.');return this.methodId}setShippingOption(){var e;return he(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState().getConsignments()||[],i=(null===(e=t[0])||void 0===e?void 0:e.availableShippingOptions)||[],n=i.find(e=>e.isRecommended);if(n||i.length){const e=n||i[0];yield this.paymentIntegrationService.selectShippingOption(e.id)}})}}const me=q(e=>{const i=window,n=new v(e),r=new V(new W((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),i,n),i),o=new ye(e,r);return new ce(e,o)},[{id:\"braintreeacceleratedcheckout\"},{id:\"braintree\"}]);var pe=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ge{constructor(e){this.braintreeScriptLoader=e}initialize(e){this.setClientToken(e)}deinitialize(){return pe(this,void 0,void 0,function*(){yield this.teardownModule(this.dataCollector),this.dataCollector=void 0})}getClient(){return pe(this,void 0,void 0,function*(){if(!this.client){const e=this.getClientTokenOrThrow(),t=yield this.braintreeScriptLoader.loadClient();this.client=yield t.create({authorization:e})}return this.client})}getDataCollectorOrThrow(e){return pe(this,void 0,void 0,function*(){const t={deviceData:void 0,teardown:()=>Promise.resolve()};if(!this.dataCollector)try{const t=yield this.getClient(),i=yield this.braintreeScriptLoader.loadDataCollector(),n=Object.assign({client:t,kount:!0},e);this.dataCollector=yield i.create(n)}catch(e){if(F(e)&&e.code===ae.KountNotEnabled)return t;throw e}return this.dataCollector})}getBraintreeGooglePayment(){return pe(this,void 0,void 0,function*(){if(!this.googlePayment){const[e,t]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.loadGooglePayment()]);this.googlePayment=yield t.create({client:e})}return this.googlePayment})}getBraintreeThreeDS(){return pe(this,void 0,void 0,function*(){if(!this.threeDS){const[e,t]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.load3DS()]);this.threeDS=yield t.create({client:e,version:2})}return this.threeDS})}getBraintreeLocalPayment(e){return pe(this,void 0,void 0,function*(){if(!this.braintreeLocalPayment){const[t,i]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.loadLocalPayment()]);this.braintreeLocalPayment=yield new Promise((n,r)=>{i.create({client:t,merchantAccountId:e},(e,t)=>{e&&r(e),n(t)})})}return this.braintreeLocalPayment})}getUsBankAccount(){return pe(this,void 0,void 0,function*(){if(!this.usBankAccount){const e=yield this.getClient(),t=yield this.braintreeScriptLoader.loadUsBankAccount();this.usBankAccount=yield t.create({client:e})}return this.usBankAccount})}getBraintreeVisaCheckout(){return this.visaCheckout||(this.visaCheckout=Promise.all([this.getClient(),this.braintreeScriptLoader.loadVisaCheckout()]).then(([e,t])=>t.create({client:e}))),this.visaCheckout}getVisaCheckoutSdk(e){return pe(this,void 0,void 0,function*(){return this.visaCheckoutSDK||(this.visaCheckoutSDK=yield this.braintreeScriptLoader.loadVisaCheckoutSdk(e)),this.visaCheckoutSDK})}getVenmoCheckoutOrThrow(){return pe(this,void 0,void 0,function*(){if(!this.braintreeVenmo){const e=yield this.getClient(),t=yield this.braintreeScriptLoader.loadVenmoCheckout(),i={client:e,allowDesktop:!0,paymentMethodUsage:\"multi_use\"},n=yield t.create(i);if(!n.isBrowserSupported())throw new b;this.braintreeVenmo=n}return this.braintreeVenmo})}setClientToken(e){this.clientToken=e}getClientTokenOrThrow(){if(!this.clientToken)throw new I(P.PaymentNotInitialized);return this.clientToken}teardownModule(e){return e?e.teardown():Promise.resolve()}}class ve extends f{constructor(e){super(e||\"Not implemented.\"),this.name=\"NotImplementedError\",this.type=\"not_implemented\"}}var fe=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class be{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i,this.buttonClassName=\"visa-checkout-wrapper\",this.onError=lodash__WEBPACK_IMPORTED_MODULE_2__.noop}initialize(e){return fe(this,void 0,void 0,function*(){const{braintreevisacheckout:t,methodId:i}=e;if(!i)throw new w('Unable to proceed because \"methodId\" argument is not provided.');if(!t)throw new w('Unable to proceed because \"options.braintreevisacheckout\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(i);const n=this.paymentIntegrationService.getState(),r=n.getCheckoutOrThrow(),{clientToken:o,config:s}=n.getPaymentMethodOrThrow(i),d=n.getStoreConfigOrThrow();if(!o)throw new $(R.MissingPaymentMethod);this.braintreeSdk.initialize(o);const l=yield this.braintreeSdk.getBraintreeVisaCheckout(),c=yield this.braintreeSdk.getVisaCheckoutSdk(s.testMode),{container:u,onError:h}=t;this.onError=h||lodash__WEBPACK_IMPORTED_MODULE_2__.noop;const y=l.createInitOptions({paymentRequest:{currencyCode:d.currency.code,subtotal:String(r.subtotal)},settings:{locale:d.storeProfile.storeLanguage,shipping:{collectShipping:!0}}}),m=this.createSignInButton(u,this.buttonClassName);yield c.init(y),c.on(\"payment.success\",e=>this.tokenizePayment(l,e).then(()=>this.paymentIntegrationService.loadCheckout()).catch(e=>this.handleError(e))),c.on(\"payment.error\",(e,t)=>this.handleError(t)),m.style.visibility=\"visible\"})}deinitialize(){return fe(this,void 0,void 0,function*(){yield this.braintreeSdk.deinitialize()})}signIn(){throw new ve('In order to sign in via VisaCheckout, the shopper must click on \"Visa Checkout\" button.')}signOut(e){return fe(this,void 0,void 0,function*(){return yield this.paymentIntegrationService.signOutCustomer(e),Promise.resolve()})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}tokenizePayment(e,t){return fe(this,void 0,void 0,function*(){return Promise.all([e.tokenize(t),this.braintreeSdk.getDataCollectorOrThrow()]).then(([e,t])=>{const i=this.paymentIntegrationService.getState(),n=i.getShippingAddress(),r=i.getBillingAddress(),{shippingAddress:o=this.mapToVisaCheckoutAddress(n),billingAddress:a=this.mapToVisaCheckoutAddress(r)}=e;return this.postForm(Object.assign(Object.assign({},e),{shippingAddress:o,billingAddress:a}),t)})})}postForm(e,t){const{userData:i,billingAddress:n,shippingAddress:r,details:o}=e,{userEmail:a}=i,{deviceData:s}=t;return this.formPoster.postForm(\"/checkout.php\",{payment_type:e.type,nonce:e.nonce,provider:\"braintreevisacheckout\",action:\"set_external_checkout\",device_data:s,card_information:JSON.stringify({type:o.cardType,number:o.lastTwo}),billing_address:JSON.stringify(this.getAddress(a,n)),shipping_address:JSON.stringify(this.getAddress(a,r))})}mapToVisaCheckoutAddress(e){return e?{firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phone,streetAddress:e.address1,extendedAddress:e.address2,locality:e.city,region:e.stateOrProvinceCode,countryCode:e.countryCode,postalCode:e.postalCode}:{}}getAddress(e,t={}){return{email:e,first_name:t.firstName,last_name:t.lastName,phone_number:t.phoneNumber,address_line_1:t.streetAddress,address_line_2:t.extendedAddress,city:t.locality,state:t.region,country_code:t.countryCode,postal_code:t.postalCode}}createSignInButton(e,t){const i=document.querySelector(`#${e}`);if(!i)throw new Error(\"Unable to proceed because the provided container ID is not valid.\");return this.insertVisaCheckoutButton(i,t)}insertVisaCheckoutButton(e,t){const i=document.createElement(\"div\");return i.style.display=\"flex\",i.style.flexDirection=\"column\",i.style.visibility=\"hidden\",i.style.width=\"max-content\",i.className=t,i.innerHTML='\\n            <img\\n                alt=\"Visa Checkout\"\\n                class=\"v-button\"\\n                role=\"button\"\\n                src=\"https://secure.checkout.visa.com/wallet-services-web/xo/button.png?acceptCanadianVisaDebit=false&cobrand=true&height=34&width=178\"\\n                />\\n            <a class=\"v-learn v-learn-default\" style=\"text-align: right; display: block; font-size: 10px; color: #003366;\" href=\"#\" data-locale=\"en_US\">Tell Me More</a>',e.appendChild(i),i}handleError(e){if(\"function\"!=typeof this.onError)throw e;this.onError(e)}}const we=q(i=>{const n=window,r=new v(i),o=new ge(new W((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),n,r));return new be(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),o)},[{id:\"braintreevisacheckout\"}]);class Ce extends f{constructor(e){super(e||\"An unexpected error has occurred during buy now cart creation process. Please try again later.\"),this.name=\"BuyNowCartCreationError\",this.type=\"buy_now_cart_creation_error\"}}function Se(e){const{color:t,fundingicons:i,height:n=40,layout:r,shape:a,size:s,tagline:l}=e||{},c={color:t,fundingicons:i,height:Pe(n),layout:r,shape:a||\"rect\",size:s,tagline:l};return (0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)(c,lodash__WEBPACK_IMPORTED_MODULE_2__.isNil)}function Pe(e){const t=Number(e);return!t||Number.isNaN(t)?40:t>55?55:t<25?25:t}function Ie(e){return{recipientName:`${e.firstName} ${e.lastName}`,line1:e.address1,line2:e.address2,city:e.city,state:e.stateOrProvinceCode,postalCode:e.postalCode,countryCode:e.countryCode,phone:e.phone}}var Oe=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ke{constructor(e,t,i,n){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeHostWindow=n}initialize(e){return Oe(this,void 0,void 0,function*(){const{braintreepaypal:t,containerId:i,methodId:n}=e;if(!n)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!i)throw new w('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!t)throw new w('Unable to initialize payment because \"options.braintreepaypal\" argument is not provided.');let r,o=this.paymentIntegrationService.getState();if(t.buyNowInitializeOptions){if(!t.currencyCode)throw new w('Unable to initialize payment because \"options.braintreepaypalcredit.currencyCode\" argument is not provided.');r=t.currencyCode}else yield this.paymentIntegrationService.loadDefaultCheckout(),o=this.paymentIntegrationService.getState(),r=o.getCartOrThrow().currency.code;const a=o.getPaymentMethodOrThrow(n),{clientToken:s,config:d,initializationData:l}=a;if(!s||!l)throw new $(R.MissingPaymentMethod);const c={currency:r,intent:l.intent,isCreditEnabled:l.isCreditEnabled};this.braintreeIntegrationService.initialize(s),yield this.braintreeIntegrationService.getPaypalCheckout(c,e=>{this.renderPayPalButton(e,t,i,n,!!d.testMode)},e=>this.handleError(e,i,t.onError))})}deinitialize(){return Oe(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}renderPayPalButton(e,t,i,n,r){const{style:o,shouldProcessPayment:a,onAuthorizeError:s,onEligibilityFailure:d}=t,{paypal:l}=this.braintreeHostWindow;if(l){const c=l.Buttons({env:r?\"sandbox\":\"production\",fundingSource:l.FUNDING.PAYPAL,style:Se(o),createOrder:()=>this.setupPayment(e,t,n),onApprove:t=>this.tokenizePayment(t,e,n,a,s)});c.isEligible()?c.render(`#${i}`):d&&\"function\"==typeof d&&d()}else this.braintreeIntegrationService.removeElement(i)}setupPayment(e,t,i){var n;return Oe(this,void 0,void 0,function*(){const{onPaymentError:r,shippingAddress:o,buyNowInitializeOptions:a}=t;try{const r=\"function\"==typeof(null==a?void 0:a.getBuyNowCartRequestBody)?yield this.createBuyNowCart(a.getBuyNowCartRequestBody()):void 0;this.buyNowCartId=null==r?void 0:r.id;const s=this.paymentIntegrationService.getState(),d=s.getCustomer(),l=s.getPaymentMethodOrThrow(i),c=r?r.cartAmount:s.getCartOrThrow().cartAmount,u=r?t.currencyCode:s.getCartOrThrow().currency.code,h=o||(null==d?void 0:d.addresses[0]),y=h?Ie(h):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:y,amount:c,currency:u,offerCredit:!1,intent:null===(n=l.initializationData)||void 0===n?void 0:n.intent})}catch(e){throw r&&(F(e)||e instanceof f)&&r(e),e}})}tokenizePayment(e,t,i,n,r){return Oe(this,void 0,void 0,function*(){try{const{deviceData:r}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),o=yield t.tokenizePayment(e),{details:a,nonce:s}=o,d=this.braintreeIntegrationService.mapToLegacyBillingAddress(a),l=this.braintreeIntegrationService.mapToLegacyShippingAddress(a);return this.formPoster.postForm(\"/checkout.php\",Object.assign({payment_type:\"paypal\",provider:i,action:n?\"process_payment\":\"set_external_checkout\",nonce:s,device_data:r,billing_address:JSON.stringify(d),shipping_address:JSON.stringify(l)},this.buyNowCartId&&{cart_id:this.buyNowCartId})),o}catch(e){throw r&&(F(e)||e instanceof f)&&r(e),e}})}createBuyNowCart(e){return Oe(this,void 0,void 0,function*(){if(!e)throw new $(R.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(e)}catch(e){throw new Ce}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!F(e))throw e;i(e)}}const Ee=q(i=>{const n=window,r=new v(i),o=new V(new W((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),n,r),n);return new ke(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),o,n)},[{id:\"braintreepaypal\"}]);class Te{constructor(e){this.paymentIntegrationService=e,this.braintreeHostWindow=window}render(e,t,i){const n=t&&document.getElementById(t);if(this.braintreeHostWindow.paypal&&n){const r=this.paymentIntegrationService.getState(),o=r.getCartOrThrow(),a=r.getBillingAddressOrThrow(),s=r.getPaymentMethodOrThrow(e);if(!s.initializationData)return;const{paypalBNPLConfiguration:d=[]}=s.initializationData,l=i===D.PAYMENT?\"checkout\":i,c=d&&d.find(({id:e})=>e===l);if(!c||!c.status)return;i===D.CART&&(n.removeAttribute(\"data-pp-style-logo-type\"),n.removeAttribute(\"data-pp-style-logo-position\"),n.removeAttribute(\"data-pp-style-text-color\"),n.removeAttribute(\"data-pp-style-text-size\")),this.braintreeHostWindow.paypal.Messages({amount:o.cartAmount,buyerCountry:a.countryCode,placement:i,style:this.getPaypalMessagesStylesFromBNPLConfig(c)}).render(`#${t}`)}}getPaypalMessagesStylesFromBNPLConfig({styles:e}){const t={};return e.color&&(t.color=e.color),e.layout&&(t.layout=e.layout),(e[\"logo-type\"]||e[\"logo-position\"])&&(t.logo={},e[\"logo-type\"]&&(t.logo.type=e[\"logo-type\"]),e[\"logo-position\"]&&(t.logo.position=e[\"logo-position\"])),e.ratio&&(t.ratio=e.ratio),(e[\"text-color\"]||e[\"text-size\"])&&(t.text={},e[\"text-color\"]&&(t.text.color=e[\"text-color\"]),e[\"text-size\"]&&(t.text.size=+e[\"text-size\"])),t}}var Ae=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ze{constructor(e,t,i,n,r){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeMessages=n,this.braintreeHostWindow=r}initialize(e){var t,i;return Ae(this,void 0,void 0,function*(){const{braintreepaypalcredit:n,containerId:r,methodId:o}=e;if(!o)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!r)throw new w('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!n)throw new w('Unable to initialize payment because \"options.braintreepaypalcredit\" argument is not provided.');let a,s=this.paymentIntegrationService.getState();if(n.buyNowInitializeOptions){if(!n.currencyCode)throw new w('Unable to initialize payment because \"options.braintreepaypalcredit.currencyCode\" argument is not provided.');a=n.currencyCode}else yield this.paymentIntegrationService.loadDefaultCheckout(),s=this.paymentIntegrationService.getState(),a=s.getCartOrThrow().currency.code;const d=s.getPaymentMethodOrThrow(o),{clientToken:l,config:c,initializationData:u}=d;if(!l||!u)throw new $(R.MissingPaymentMethod);const h={currency:a,intent:u.intent,isCreditEnabled:u.isCreditEnabled},m=y(null!==(i=null===(t=s.getStoreConfig())||void 0===t?void 0:t.checkoutSettings.features)&&void 0!==i?i:{},\"PAYPAL-5663.hide_braintree_card_banner_implementation_in_checkout_sdk\");this.braintreeIntegrationService.initialize(l),yield this.braintreeIntegrationService.getPaypalCheckout(h,e=>{!m&&n.messagingContainerId&&this.renderPayPalMessages(o,n.messagingContainerId),this.renderPayPalButton(e,n,r,o,!!c.testMode)},e=>this.handleError(e,r,n.onError))})}deinitialize(){return Ae(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}renderPayPalMessages(e,t){this.braintreeMessages.render(e,t,D.CART)}renderPayPalButton(e,t,i,n,r){const{style:o,shouldProcessPayment:a,onAuthorizeError:s,onEligibilityFailure:d}=t,{paypal:l}=this.braintreeHostWindow;let c=!1;l&&[l.FUNDING.PAYLATER,l.FUNDING.CREDIT].forEach(u=>{const h=u===l.FUNDING.CREDIT?Object.assign({label:N.CREDIT},Se(o)):Se(o);if(!c){const o=l.Buttons({env:r?\"sandbox\":\"production\",fundingSource:u,style:h,createOrder:()=>this.setupPayment(e,t,n),onApprove:t=>this.tokenizePayment(t,e,n,a,s)});o.isEligible()?(o.render(`#${i}`),c=!0):l.FUNDING.CREDIT&&d&&\"function\"==typeof d&&d()}}),l&&c||this.braintreeIntegrationService.removeElement(i)}setupPayment(e,t,i){var n;return Ae(this,void 0,void 0,function*(){const{onPaymentError:r,shippingAddress:o,buyNowInitializeOptions:a}=t;try{const r=\"function\"==typeof(null==a?void 0:a.getBuyNowCartRequestBody)?yield this.createBuyNowCart(a.getBuyNowCartRequestBody()):void 0;this.buyNowCartId=null==r?void 0:r.id;const s=this.paymentIntegrationService.getState(),d=s.getCustomer(),l=s.getPaymentMethodOrThrow(i),c=r?r.cartAmount:s.getCartOrThrow().cartAmount,u=r?t.currencyCode:s.getCartOrThrow().currency.code,h=o||(null==d?void 0:d.addresses[0]),y=h?Ie(h):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:y,amount:c,currency:u,offerCredit:!0,intent:null===(n=l.initializationData)||void 0===n?void 0:n.intent})}catch(e){throw r&&(F(e)||e instanceof f)&&r(e),e}})}tokenizePayment(e,t,i,n,r){return Ae(this,void 0,void 0,function*(){try{const{deviceData:r}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),o=yield t.tokenizePayment(e),{details:a,nonce:s}=o,d=this.braintreeIntegrationService.mapToLegacyBillingAddress(a),l=this.braintreeIntegrationService.mapToLegacyShippingAddress(a);return this.formPoster.postForm(\"/checkout.php\",Object.assign({payment_type:\"paypal\",provider:i,action:n?\"process_payment\":\"set_external_checkout\",nonce:s,device_data:r,billing_address:JSON.stringify(d),shipping_address:JSON.stringify(l)},this.buyNowCartId&&{cart_id:this.buyNowCartId})),o}catch(e){throw r&&(F(e)||e instanceof f)&&r(e),e}})}createBuyNowCart(e){return Ae(this,void 0,void 0,function*(){if(!e)throw new $(R.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(e)}catch(e){throw new Ce}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!F(e))throw e;i(e)}}const Ne=q(i=>{const n=window,r=new v(i),o=new V(new W((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),n,r),n),a=new Te(i);return new ze(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),o,a,n)},[{id:\"braintreepaypalcredit\"}]);var Me=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class De{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i}initialize(e){return Me(this,void 0,void 0,function*(){const{containerId:t,methodId:i}=e;if(!i)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new w('Unable to initialize payment because \"options.containerId\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(i);const n=this.paymentIntegrationService.getState(),{clientToken:r,initializationData:o,config:a}=n.getPaymentMethodOrThrow(i);if(!r||!o)throw new $(R.MissingPaymentMethod);this.braintreeSdk.initialize(r);const s=yield this.braintreeSdk.getBraintreeVisaCheckout(),{currency:{code:d},cartAmount:l}=n.getCartOrThrow(),c=yield this.braintreeSdk.getVisaCheckoutSdk(a.testMode),u=s.createInitOptions({paymentRequest:{currencyCode:d,subtotal:String(l)},settings:{shipping:{collectShipping:!0}}});this.createSignInButton(t),yield c.init(u),c.on(\"payment.success\",e=>Me(this,void 0,void 0,function*(){yield this.paymentSuccess(s,e)}))})}deinitialize(){return Promise.resolve()}paymentSuccess(e,t){return Me(this,void 0,void 0,function*(){return Promise.all([e.tokenize(t),this.braintreeSdk.getDataCollectorOrThrow()]).then(([e,t])=>{const i=this.paymentIntegrationService.getState(),n=i.getShippingAddress(),r=i.getBillingAddress(),{shippingAddress:o=this.toVisaCheckoutAddress(n),billingAddress:a=this.toVisaCheckoutAddress(r)}=e;return this.postForm(Object.assign(Object.assign({},e),{shippingAddress:o,billingAddress:a}),t)})})}postForm(e,t){const{userData:i,billingAddress:n,shippingAddress:r,details:o}=e,{userEmail:a}=i,{deviceData:s}=t;return this.formPoster.postForm(\"/checkout.php\",{payment_type:e.type,nonce:e.nonce,provider:\"braintreevisacheckout\",action:\"set_external_checkout\",device_data:s,card_information:JSON.stringify({type:o.cardType,number:o.lastTwo}),billing_address:JSON.stringify(this.getAddress(a,n)),shipping_address:JSON.stringify(this.getAddress(a,r))})}toVisaCheckoutAddress(e){return e?{firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phone,streetAddress:e.address1,extendedAddress:e.address2,locality:e.city,region:e.stateOrProvinceCode,countryCode:e.countryCode,postalCode:e.postalCode}:{}}getAddress(e,t={}){return{email:e,first_name:t.firstName,last_name:t.lastName,phone_number:t.phoneNumber,address_line_1:t.streetAddress,address_line_2:t.extendedAddress,city:t.locality,state:t.region,country_code:t.countryCode,postal_code:t.postalCode}}createSignInButton(e){const t=document.querySelector(`#${e}`);if(!t)throw new Error(\"Need a container to place the button\");return this.insertVisaCheckoutButton(t)}insertVisaCheckoutButton(e){const t=document.createElement(\"div\");return t.style.display=\"flex\",t.style.flexDirection=\"column\",t.style.alignItems=\"flex-end\",t.innerHTML='\\n            <img\\n                alt=\"Visa Checkout\"\\n                class=\"v-button\"\\n                role=\"button\"\\n                src=\"https://secure.checkout.visa.com/wallet-services-web/xo/button.png?acceptCanadianVisaDebit=false&cobrand=true&height=34&width=178\"\\n                />\\n            <a class=\"v-learn v-learn-default\" style=\"text-align: right; display: block; font-size: 10px; color: #003366;\" href=\"#\" data-locale=\"en_US\">Tell Me More</a>',e.appendChild(t),t}}const _e=q(i=>{const n=window,r=new v(i),o=new ge(new W((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),n,r));return new De(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),o)},[{id:\"braintreevisacheckout\"}]);function Be(e){const{billingAddress:t,email:i,firstName:n,lastName:r,phone:o,shippingAddress:a}=e,s=t||a;return{email:i,first_name:n,last_name:r,phone_number:o,address_line_1:null==s?void 0:s.line1,address_line_2:null==s?void 0:s.line2,city:null==s?void 0:s.city,state:null==s?void 0:s.state,country_code:null==s?void 0:s.countryCode,postal_code:null==s?void 0:s.postalCode}}function xe(e){const{email:t,phone:i,shippingAddress:n}=e,r=(null==n?void 0:n.recipientName)||\"\",[o,a]=r.split(\" \");return{email:t,first_name:o||\"\",last_name:a||\"\",phone_number:i,address_line_1:null==n?void 0:n.line1,address_line_2:null==n?void 0:n.line2,city:null==n?void 0:n.city,state:null==n?void 0:n.state,country_code:null==n?void 0:n.countryCode,postal_code:null==n?void 0:n.postalCode}}function Fe(e){return\"object\"==typeof e&&null!==e&&\"name\"in e&&\"BraintreeError\"===e.name}var Le=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};const Ve=e=>{const{color:t,height:i}=e;return{backgroundColor:(n=t||\"\",n===z.WHITE?\"#FFFFFF\":\"#3D95CE\"),backgroundPosition:\"50% 50%\",backgroundSize:\"80px auto\",backgroundImage:`url(\"/app/assets/img/payment-providers/venmo-logo-${t===z.WHITE?z.BLUE:z.WHITE}.svg\")`,backgroundRepeat:\"no-repeat\",borderRadius:\"4px\",cursor:\"pointer\",transition:\"0.2s ease\",minHeight:`${i||40}px`,minWidth:\"150px\",height:\"100%\",width:\"100%\",border:t===z.WHITE?\"1px solid black\":\"none\"};// removed by dead control flow\n var n; };class je{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i,this.onError=lodash__WEBPACK_IMPORTED_MODULE_2__.noop}initialize(e){return Le(this,void 0,void 0,function*(){const{braintreevenmo:t,containerId:i,methodId:n}=e;if(!n)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');const r=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(n),{clientToken:o,initializationData:a}=r,{paymentButtonStyles:s}=a,{cartButtonStyles:d}=s||{},l=(null==t?void 0:t.style)||d;if(!o||!a)throw new $(R.MissingPaymentMethod);if(!i)throw new w('Unable to initialize payment because \"options.containerId\" argument is not provided.');yield this.paymentIntegrationService.loadDefaultCheckout(),this.onError=(null==t?void 0:t.onError)||this.handleError,this.braintreeSdk.initialize(o);try{const e=yield this.braintreeSdk.getVenmoCheckoutOrThrow();this.renderVenmoButton(e,i,null==t?void 0:t.buyNowInitializeOptions,l)}catch(e){(Fe(e)||function(e){return e instanceof b}(e))&&this.handleInitializationVenmoError(e,i)}})}deinitialize(){return Le(this,void 0,void 0,function*(){return yield this.braintreeSdk.deinitialize(),Promise.resolve()})}handleError(e){throw new Error(e.message)}createBuyNowCart(e){return Le(this,void 0,void 0,function*(){if(\"function\"==typeof(null==e?void 0:e.getBuyNowCartRequestBody)){const t=null==e?void 0:e.getBuyNowCartRequestBody();if(!t)throw new $(R.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(t)}catch(e){throw new Ce}}})}handleInitializationVenmoError(e,t){return this.removeVenmoContainer(t),this.onError(e)}removeVenmoContainer(e){const t=document.getElementById(e);t&&t.remove()}renderVenmoButton(e,t,i,n){const r=document.getElementById(t),{color:o}=n||{};if(!r)throw new w(\"Unable to create wallet button without valid container ID.\");r.setAttribute(\"aria-label\",\"Venmo\"),Object.assign(r.style,Ve(n||{})),r.addEventListener(\"click\",()=>Le(this,void 0,void 0,function*(){r.setAttribute(\"disabled\",\"true\");const t=yield this.createBuyNowCart(i);e.tokenize&&e.tokenize((e,i)=>Le(this,void 0,void 0,function*(){r.removeAttribute(\"disabled\"),e&&this.onError(e),yield this.handlePostForm(i,null==t?void 0:t.id)}))})),o===z.BLUE&&(r.addEventListener(\"mouseenter\",()=>{r.style.backgroundColor=\"#0a7fc2\"}),r.addEventListener(\"mouseleave\",()=>{r.style.backgroundColor=Ve(n||{}).backgroundColor}))}handlePostForm(e,t){return Le(this,void 0,void 0,function*(){const{deviceData:i}=yield this.braintreeSdk.getDataCollectorOrThrow(),{nonce:n,details:r}=e;this.formPoster.postForm(\"/checkout.php\",Object.assign({nonce:n,provider:\"braintreevenmo\",payment_type:\"paypal\",device_data:i,action:\"set_external_checkout\",billing_address:JSON.stringify(Be(r)),shipping_address:JSON.stringify(xe(r))},t&&{cart_id:t}))})}}const Ue=q(i=>{const n=window,r=(0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),o=new v(i),a=new W(r,n,o),s=new ge(a);return new je(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),s)},[{id:\"braintreevenmo\"}]);function Re(e){return Boolean(e.instrumentId)}class He extends f{constructor(){super(\"The current order does not need to be finalized at this stage.\"),this.name=\"OrderFinalizationNotRequiredError\",this.type=\"order_finalization_not_required\"}}function We(e){return!(\"object\"!=typeof e||null===e||void 0!==e.shouldSaveInstrument&&\"boolean\"!=typeof e.shouldSaveInstrument||void 0!==e.shouldSetAsDefaultInstrument&&\"boolean\"!=typeof e.shouldSetAsDefaultInstrument)}class qe extends f{constructor(e){super(e||\"Unable to proceed because the client library of a payment method has thrown an unexpected error.\"),this.name=\"PaymentMethodFailedError\",this.type=\"payment_method_client_invalid\"}}function $e(e){return!!e&&\"accountNumber\"in e&&\"routingNumber\"in e&&\"ownershipType\"in e&&\"accountType\"in e}var Ge=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Ye{constructor(e,t){this.paymentIntegrationService=e,this.braintreeSdk=t}initialize(e){return Ge(this,void 0,void 0,function*(){const{methodId:t,braintreeach:i}=e||{};if(!t)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');this.getMandateText=null==i?void 0:i.getMandateText,yield this.paymentIntegrationService.loadPaymentMethod(t);const n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t),{clientToken:r,initializationData:o}=n;if(!r||!o)throw new $(R.MissingPaymentMethod);this.braintreeSdk.initialize(r);try{this.usBankAccount=yield this.braintreeSdk.getUsBankAccount()}catch(e){this.handleBraintreeError(e)}})}execute(e,t){return Ge(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!i)throw new C([\"payment\"]);const r=Re(i.paymentData||{}),o=r?yield this.tokenizePaymentForVaultedInstrument(i):yield this.tokenizePayment(i),a=r?yield this.preparePaymentDataForVaultedInstrument(o,i):yield this.preparePaymentData(o,i);yield this.paymentIntegrationService.submitOrder(n,t),yield this.paymentIntegrationService.submitPayment(a)})}finalize(){return Promise.reject(new He)}deinitialize(){return Ge(this,void 0,void 0,function*(){return yield this.braintreeSdk.deinitialize(),Promise.resolve()})}tokenizePayment({paymentData:e}){return Ge(this,void 0,void 0,function*(){const t=this.getUsBankAccountOrThrow();if(!$e(e))throw new C([\"payment.paymentData\"]);const i=Re(e)?\"The data are used for stored instrument verification\":\"function\"==typeof this.getMandateText&&this.getMandateText();if(!i)throw new w(\"Unable to proceed because getMandateText is not provided or returned undefined value.\");try{const{nonce:n}=yield t.tokenize({bankDetails:this.getBankDetails(e),mandateText:i});return n}catch(e){this.handleBraintreeError(e)}})}tokenizePaymentForVaultedInstrument(e){return Ge(this,void 0,void 0,function*(){const{methodId:t,paymentData:i={}}=e,n=this.paymentIntegrationService.getState(),{config:r}=n.getPaymentMethodOrThrow(t);if(!r.isVaultingEnabled)throw new w(\"Vaulting is disabled but a vaulted instrument was being used for this transaction\");return $e(i)?this.tokenizePayment(e):null})}preparePaymentData(e,t){return Ge(this,void 0,void 0,function*(){const{methodId:i,paymentData:n={}}=t;if(!$e(n))throw new C([\"payment.paymentData\"]);const{deviceData:r}=yield this.braintreeSdk.getDataCollectorOrThrow(),{shouldSaveInstrument:o,shouldSetAsDefaultInstrument:a,routingNumber:s,accountNumber:d}=n;return{methodId:i,paymentData:{deviceSessionId:r,shouldSetAsDefaultInstrument:a,shouldSaveInstrument:o,formattedPayload:{tokenized_bank_account:{issuer:s,masked_account_number:d.substr(-4),token:e}}}}})}preparePaymentDataForVaultedInstrument(e,t){return Ge(this,void 0,void 0,function*(){const{methodId:i,paymentData:n={}}=t;if(!Re(n)||!We(n))throw new C([\"payment.paymentData\"]);const{deviceData:r}=yield this.braintreeSdk.getDataCollectorOrThrow(),{instrumentId:o,shouldSetAsDefaultInstrument:a}=n;return{methodId:i,paymentData:Object.assign({deviceSessionId:r,instrumentId:o,shouldSetAsDefaultInstrument:a},e&&{nonce:e})}})}getBankDetails(e){const t=this.paymentIntegrationService.getState().getBillingAddressOrThrow(),i=e.ownershipType.toLowerCase(),n=e.accountType.toLowerCase();return Object.assign(Object.assign({accountNumber:e.accountNumber,routingNumber:e.routingNumber,ownershipType:i},\"personal\"===i?{firstName:e.firstName,lastName:e.lastName}:{businessName:e.businessName}),{accountType:n,billingAddress:{streetAddress:t.address1,extendedAddress:t.address2,locality:t.city,region:t.stateOrProvinceCode,postalCode:t.postalCode}})}getUsBankAccountOrThrow(){if(!this.usBankAccount)throw new I(P.PaymentNotInitialized);return this.usBankAccount}handleBraintreeError(e){if(!F(e))throw e;throw new qe(e.message)}}const Je=q(e=>new Ye(e,(e=>{const i=new v(e),n=new W((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),window,i);return new ge(n)})(e)),[{id:\"braintreeach\"}]);class Ke{constructor(e){const{element:t,closeElement:i,mainElement:n}=this._createElements(e);this._element=t,this._closeElement=i,this._mainElement=n}show(e){this._mainElement.parentElement||(this._registerClick(e),document.body.appendChild(this._mainElement),setTimeout(()=>this._element.style.opacity=\"1\"))}remove(){this._mainElement.parentElement&&(this._unregisterClick&&this._unregisterClick(),this._removeAfterTransition(),setTimeout(()=>this._element.style.opacity=\"0\"))}_createElements(e){const t=document.createElement(\"div\"),{background:i=\"rgba(0, 0, 0, 0.8)\",id:n=\"checkoutOverlay\",transitionDuration:r=400,hasCloseButton:o=!1,innerHtml:a=null}=e||{};let s,d,l,c,u=t;if(n&&(t.id=n),a){const e=document.createElement(\"div\");c=`${n}--overlayText`,e.className=c,e.appendChild(a),t.appendChild(e)}return o&&(l=`${n}--close`,s=document.createElement(\"div\"),s.className=l,d=`${n}--layout`,u=document.createElement(\"div\"),u.className=d,u.appendChild(t),u.appendChild(s)),u.appendChild(function(e){const{id:t,background:i,transitionDuration:n,classLayout:r,classOverlayText:o,classClose:a}=e,s=document.createElement(\"style\"),d=r?`, .${r}`:\"\";return s.id=`${t}--styles`,s.type=\"text/css\",s.innerText=`\\n        #${t}${d} {\\n            display: block;\\n            height: 100%;\\n            width: 100%;\\n            left: 0;\\n            top: 0;\\n            position: fixed;\\n            z-index: 2147483647;\\n        }\\n        #${t} {\\n            transition: opacity ${n}ms ease-out;\\n            background: ${i};\\n            opacity: 0;\\n        }\\n    `,o&&(s.innerText+=`\\n             #${t} {\\n                display: flex;\\n                align-items: center;\\n                justify-content: center;\\n             }\\n             #${t} .${o} {\\n                color: white;\\n                max-width: 330px;\\n                font-size: 1.2em;\\n                text-align: center;\\n             }\\n        `),a&&(s.innerText+=`\\n            #${t} {\\n                opacity: 1;\\n            }\\n            .${r} .${a} {\\n                position: fixed;\\n                right: 16px;\\n                top: 16px;\\n                width: 16px;\\n                height: 16px;\\n                opacity: 0.6;\\n                cursor: pointer;\\n                z-index: 3147483647;\\n            }\\n            .${r} .${a}::after, .${r} .${a}::before {\\n                position: absolute;\\n                left: 8px;\\n                content: '';\\n                height: 16px;\\n                width: 2px;\\n                background-color: #fff;\\n            }\\n            .${r} .${a}::after {\\n                transform: rotate(-45deg);\\n            }\\n            .${r} .${a}::before {\\n                transform: rotate(45deg);\\n            }\\n        `),s}({id:n,background:i,transitionDuration:r,classLayout:d,classOverlayText:c,classClose:l})),{element:t,closeElement:s,mainElement:u}}_addEventListener(e,t){e&&t&&e.addEventListener(\"click\",t)}_removeEventListener(e,t){e&&t&&e.removeEventListener(\"click\",t)}_registerClick(e){if(this._unregisterClick&&this._unregisterClick(),e){const{onClick:t,onClickClose:i}=e;this._addEventListener(this._element,t),this._addEventListener(this._closeElement,i),this._unregisterClick=()=>{this._removeEventListener(this._element,t),this._removeEventListener(this._closeElement,i),this._unregisterClick=void 0}}}_removeAfterTransition(){const e=t=>{\"opacity\"===t.propertyName&&(this._mainElement.parentElement&&this._mainElement.remove(),this._element.removeEventListener(\"transitionend\",e))};this._element.addEventListener(\"transitionend\",e)}}const Xe={size:70,color:\"#d9d9d9\",backgroundColor:\"#ffffff\"},Qe=\"embedded-checkout-loading-indicator-rotation\";class Ze{constructor(e){this.styles=Object.assign(Object.assign({},Xe),e&&e.styles),this.containerStyles=Object.assign({},e&&e.containerStyles),this.defineAnimation(),this.container=this.buildContainer(),this.indicator=this.buildIndicator(),this.container.appendChild(this.indicator)}show(e){if(e){const t=document.getElementById(e);if(!t)throw new Error(\"Unable to attach the loading indicator because the parent ID is not valid.\");t.appendChild(this.container)}this.container.style.visibility=\"visible\",this.container.style.opacity=\"1\"}hide(){const e=()=>{this.container.style.visibility=\"hidden\",this.container.removeEventListener(\"transitionend\",e)};this.container.addEventListener(\"transitionend\",e),this.container.style.opacity=\"0\"}buildContainer(){const e=document.createElement(\"div\");return e.style.display=\"block\",e.style.bottom=\"0\",e.style.left=\"0\",e.style.height=\"100%\",e.style.width=\"100%\",e.style.position=\"absolute\",e.style.right=\"0\",e.style.top=\"0\",e.style.transition=\"all 250ms ease-out\",e.style.opacity=\"0\",this.setStyleAttribute(e,this.containerStyles),e}buildIndicator(){const e=document.createElement(\"div\");return e.style.display=\"block\",e.style.width=`${this.styles.size}px`,e.style.height=`${this.styles.size}px`,e.style.borderRadius=`${this.styles.size}px`,e.style.border=\"solid 1px\",e.style.borderColor=`${this.styles.backgroundColor} ${this.styles.backgroundColor} ${this.styles.color} ${this.styles.color}`,e.style.margin=\"0 auto\",e.style.position=\"absolute\",e.style.left=\"0\",e.style.right=\"0\",e.style.top=\"50%\",e.style.transform=\"translateY(-50%) rotate(0deg)\",e.style.transformStyle=\"preserve-3d\",e.style.animation=`${Qe} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`,e}setStyleAttribute(e,t){Object.keys(t).forEach(i=>{e.style.setProperty(i,t[i])})}defineAnimation(){var e;if(document.getElementById(Qe))return;const t=document.createElement(\"style\");t.id=Qe,null===(e=document.head)||void 0===e||e.appendChild(t),t.sheet instanceof CSSStyleSheet&&t.sheet.insertRule(`\\n                @keyframes ${Qe} {\\n                    0% { transform: translateY(-50%) rotate(0deg); }\\n                    100% { transform: translateY(-50%) rotate(360deg); }\\n                }\\n            `,0)}}const et={\"background-color\":\"rgba(0, 0, 0, 0.4)\",\"z-index\":\"1000\"};var tt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class it{constructor(e,t,i,n){this.paymentIntegrationService=e,this.braintreeIntegrationService=t,this.braintreeMessages=i,this.loadingIndicator=n,this.braintreeHostWindow=window}initialize(e){return tt(this,void 0,void 0,function*(){const{braintree:t,methodId:i}=e;if(this.braintree=t,this.paymentMethod&&this.paymentMethod.nonce||(this.paymentMethod=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(i)),this.paymentMethod.clientToken&&(null==t?void 0:t.bannerContainerId))return yield this.loadPaypal(),this.loadPaypalCheckoutInstance();if(this.paymentMethod.clientToken)return this.loadPaypal();const n=yield this.paymentIntegrationService.loadPaymentMethod(i);if(this.paymentMethod=n.getPaymentMethodOrThrow(i),null==t?void 0:t.bannerContainerId)return this.loadPaypalCheckoutInstance();if(!this.paymentMethod.clientToken)throw new $(R.MissingPaymentMethod);return this.loadPaypal()})}execute(e,t){var i;return tt(this,void 0,void 0,function*(){const{payment:n}=e,r=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]),{onError:o}=this.braintree||{};if(!n)throw new C([\"payment\"]);try{const e=yield this.preparePaymentData(n,r.useStoreCredit);yield this.paymentIntegrationService.submitOrder(r,t),yield this.paymentIntegrationService.submitPayment(e)}catch(e){this.isProviderError(e)&&(yield this.loadPaypal(),null===(i=this.paypalButtonRender)||void 0===i||i.close(),yield this.loadPaypalCheckoutInstance(),yield new Promise((e,t)=>{o&&\"function\"==typeof o&&o(new Error(\"INSTRUMENT_DECLINED\")),t()})),this.handleError(e)}})}finalize(){return Promise.reject(new He)}deinitialize(){var e;return this.braintreeTokenizePayload=void 0,null===(e=this.paypalButtonRender)||void 0===e||e.close(),this.braintreeIntegrationService.teardown()}preparePaymentData(e,t){var i;return tt(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState(),r=n.getOutstandingBalance(t),o=n.getStoreConfig();if(!r)throw new $(R.MissingCheckout);if(!o)throw new $(R.MissingCheckoutConfig);if(!this.paymentMethod)throw new I(P.PaymentNotInitialized);const{currency:a,storeProfile:{storeLanguage:s}}=o,{nonce:d,config:{isVaultingEnabled:l}}=this.paymentMethod,{methodId:c,paymentData:u={}}=e,h=(null===(i=this.braintreeTokenizePayload)||void 0===i?void 0:i.nonce)||d;if(h){const t=yield this.paymentIntegrationService.loadPaymentMethod(c);return this.paymentMethod=t.getPaymentMethod(c),Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(h)})}if(Re(u)||(y=u,Boolean(y.instrumentId)&&!Object.prototype.hasOwnProperty.call(y,\"ccNumber\")&&!Object.prototype.hasOwnProperty.call(y,\"ccCvv\"))){if(!l)throw new w(\"Vaulting is disabled but a vaulted instrument was being used for this transaction\");return Promise.resolve(e)}var y;if(!We(u))throw new $(R.MissingPayment);const{shouldSaveInstrument:m,shouldSetAsDefaultInstrument:p}=u;if(m&&!l)throw new w(\"Vaulting is disabled but shouldSaveInstrument is set to true\");const g=n.getShippingAddress(),v=g?Ie(g):void 0;return Promise.all([this.braintreeIntegrationService.paypal({amount:r,locale:s,currency:a.code,offerCredit:\"braintreepaypalcredit\"===this.paymentMethod.id,shippingAddressOverride:v,shouldSaveInstrument:m||!1,shippingAddressEditable:!1}),this.braintreeIntegrationService.getSessionId()]).then(([{nonce:t,details:i}={},n])=>Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(t,i&&i.email,n,m,p)}))})}formattedPayload(e,t,i,n,r){return{formattedPayload:{vault_payment_instrument:n||null,set_as_default_stored_instrument:r||null,device_info:i||null,paypal_account:{token:e,email:t||null}}}}loadPaypalCheckoutInstance(){return tt(this,void 0,void 0,function*(){const{clientToken:e,initializationData:t,id:i}=this.paymentMethod||{};if(!e)throw new $(R.MissingPaymentMethod);try{this.braintreeIntegrationService.initialize(e);const n={currency:this.paymentIntegrationService.getState().getCartOrThrow().currency.code,intent:null==t?void 0:t.intent,isCreditEnabled:null==t?void 0:t.isCreditEnabled},r=\"braintreepaypalcredit\"===i||!(null==t?void 0:t.isCreditEnabled);yield this.braintreeIntegrationService.getPaypalCheckout(n,e=>{var t;r&&i&&(null===(t=this.braintree)||void 0===t?void 0:t.bannerContainerId)&&this.renderPayPalMessages(i,this.braintree.bannerContainerId),this.renderPayPalButton(e)},this.handleError)}catch(e){this.handleError(e)}})}renderPayPalMessages(e,t){this.braintreeMessages.render(e,t,D.PAYMENT)}renderPayPalButton(e){const{onPaymentError:t,submitForm:i,onRenderButton:n,containerId:r,onError:o}=this.braintree||{};if(!r)return;if(!this.paymentMethod)throw new I(P.PaymentNotInitialized);this.loadingIndicatorContainer=r.split(\"#\")[1];const{id:a,config:{testMode:s}}=this.paymentMethod,{paypal:d}=this.braintreeHostWindow,l=null==d?void 0:d.FUNDING.PAYPAL;d&&l?(this.paypalButtonRender=d.Buttons({env:s?\"sandbox\":\"production\",commit:!1,fundingSource:l,onClick:()=>{this.toggleLoadingIndicator(!0)},createOrder:()=>this.setupPayment(e,a,t),onApprove:t=>tt(this,void 0,void 0,function*(){this.braintreeTokenizePayload=yield this.tokenizePaymentOrThrow(t,e),i&&\"function\"==typeof i&&i()}),onCancel:()=>{this.toggleLoadingIndicator(!1)},onError:e=>{this.toggleLoadingIndicator(!1),null==o||o(e)}}),n&&\"function\"==typeof n&&n(),this.paypalButtonRender.isEligible()&&this.paypalButtonRender.render(`${r}`)):this.removeElement(r.split(\"#\")[1])}setupPayment(e,t,i){return tt(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState();try{const i=n.getCustomer(),r=n.getPaymentMethodOrThrow(t),o=n.getCheckoutOrThrow().outstandingBalance,a=n.getStoreConfigOrThrow().currency.code,s=n.getShippingAddress()||(null==i?void 0:i.addresses[0]),d=s?Ie(s):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:d,amount:o,currency:a,offerCredit:!1,intent:r.initializationData.intent})}catch(e){throw i&&(Fe(e)||e instanceof f)&&i(e),e}})}tokenizePaymentOrThrow(e,t,i){return tt(this,void 0,void 0,function*(){try{return yield t.tokenizePayment(e)}catch(e){throw i&&(Fe(e)||e instanceof f)&&i(e),e}})}loadPaypal(){return tt(this,void 0,void 0,function*(){const{clientToken:e,initializationData:t}=this.paymentMethod||{};if(!e||!t)throw new $(R.MissingPaymentMethod);try{this.braintreeIntegrationService.initialize(e),yield this.braintreeIntegrationService.getPaypal()}catch(e){this.handleError(e)}return Promise.resolve()})}handleError(e){if(!Fe(e))throw e;if(\"PAYPAL_POPUP_CLOSED\"===e.code)throw new O(e.message);throw new qe(e.message)}isProviderError(e){var t,i,n;return!!function(e){return\"object\"==typeof e&&null!==e&&\"errors\"in e}(e)&&\"2046\"===(null===(n=null===(i=((null===(t=null==e?void 0:e.errors)||void 0===t?void 0:t.filter(e=>e.provider_error))||[])[0])||void 0===i?void 0:i.provider_error)||void 0===n?void 0:n.code)}removeElement(e){const t=e&&document.getElementById(e);t&&t.remove()}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}}const nt=q(e=>{const i=window,n=new Ke,r=new v(e),o=new V(new W((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),i,r),i,n),a=new Te(e);return new it(e,o,a,new Ze({containerStyles:et}))},[{id:\"braintreepaypal\"},{id:\"braintreepaypalcredit\"}]);var rt;!function(e){e.Json=\"application/json\",e.JsonV1=\"application/vnd.bc.v1+json\"}(rt||(rt={}));const ot=rt,at={\"X-Checkout-SDK-Version\":\"1.837.2\"};class st{constructor(e){this.requestSender=e}getOrderStatus(e=\"braintreelocalmethods\",t){return i=this,n=void 0,o=function*(){const i=`/api/storefront/initialization/${e}`,n=Object.assign({\"X-API-INTERNAL\":\"This API endpoint is for internal use only and may change in the future\",\"Content-Type\":ot.Json},at);return(yield this.requestSender.get(i,Object.assign({headers:n},t))).body},new((r=void 0)||(r=Promise))(function(e,t){function a(e){try{d(o.next(e))}catch(e){t(e)}}function s(e){try{d(o.throw(e))}catch(e){t(e)}}function d(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r(function(e){e(i)})).then(a,s)}d((o=o.apply(i,n||[])).next())});// removed by dead control flow\n var i, n, r, o; }}const dt={body:{},headers:{},status:0};class lt extends f{constructor(e,{message:t,errors:i}={}){const{body:n,headers:r,status:o}=e||dt;super(t||\"An unexpected error has occurred.\"),this.name=\"RequestError\",this.type=\"request\",this.body=n,this.headers=r,this.status=o,this.errors=i||[]}}class ct extends lt{constructor(e){super(e,{message:\"There is a problem processing your payment. Please try again later.\"}),this.name=\"PaymentMethodInvalidError\",this.type=\"payment_method_invalid\"}}class ut extends lt{constructor(e){super(e,{message:\"The request has timed out or aborted.\"}),this.name=\"TimeoutError\",this.type=\"timeout\"}}var ht=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class yt{constructor(e,t,i,n,r=3e3,o=3e5){this.paymentIntegrationService=e,this.braintreeSdk=t,this.braintreeRequestSender=i,this.loadingIndicator=n,this.pollingInterval=r,this.maxPollingIntervalTime=o,this.isLPMsUpdateExperimentEnabled=!1,this.pollingTimer=0,this.stopPolling=lodash__WEBPACK_IMPORTED_MODULE_2__.noop,this.isPollingEnabled=!1}initialize(e){return ht(this,void 0,void 0,function*(){const{gatewayId:t,methodId:i,braintreelocalmethods:n}=e;if(this.gatewayId=t,!i)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new w('Unable to initialize payment because \"options.gatewayId\" argument is not provided.');if(!n)throw new w('Unable to initialize payment because \"options.braintreelocalmethods\" argument is not provided.');this.braintreelocalmethods=n,this.loadingIndicatorContainer=n.container.split(\"#\")[1],yield this.paymentIntegrationService.loadPaymentMethod(t);const r=this.paymentIntegrationService.getState(),o=r.getPaymentMethodOrThrow(t),{clientToken:a,config:s,initializationData:d}=o,l=r.getStoreConfigOrThrow().checkoutSettings.features;if(this.isPollingEnabled=y(l,\"PAYPAL-5258.braintree_local_methods_polling\"),this.isLPMsUpdateExperimentEnabled=y(l,\"PAYPAL-4853.add_new_payment_flow_for_braintree_lpms\"),!a||!d||!s.merchantId)throw new $(R.MissingPaymentMethod);try{this.braintreeSdk.initialize(a),this.isNonInstantPaymentMethod(i)||(this.braintreeLocalPayment=yield this.braintreeSdk.getBraintreeLocalPayment(s.merchantId))}catch(e){this.handleError(e)}})}finalize(){return Promise.reject(new He)}deinitialize(){return ht(this,void 0,void 0,function*(){return this.toggleLoadingIndicator(!1),Promise.resolve()})}execute(e,t){return ht(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!i)throw new C([\"payment\"]);const{methodId:r}=i;this.toggleLoadingIndicator(!0),this.isNonInstantPaymentMethod(r)?yield this.executeWithNotInstantLPM(r):yield this.executeWithInstantLPM(r,n,t)})}executeWithNotInstantLPM(e){return ht(this,void 0,void 0,function*(){try{const t=yield this.getLPMsBasicPaymentData();yield this.paymentIntegrationService.submitOrder(),yield this.paymentIntegrationService.submitPayment({methodId:e,paymentData:Object.assign(Object.assign({},t),{formattedPayload:{method:e}})})}catch(e){if(this.isBraintreeRedirectError(e)){const t=e.body.additional_action_required.data.redirect_url;return new Promise((e,i)=>{window.location.replace(t),this.toggleLoadingIndicator(!1),i()})}return this.handleError(e),Promise.reject(e)}})}executeWithInstantLPM(e,t,i){return ht(this,void 0,void 0,function*(){if(!this.braintreeLocalPayment)throw new ct;yield new Promise((n,r)=>{var o;null===(o=this.braintreeLocalPayment)||void 0===o||o.startPayment(this.getInstantLPMConfig(e,t,i),this.getInstantLPMCallback(n,r,e,t,i))})})}getLPMsBasicPaymentData(){return ht(this,void 0,void 0,function*(){const{deviceData:e}=yield this.braintreeSdk.getDataCollectorOrThrow();return{deviceSessionId:e}})}getInstantLPMConfig(e,t,i){const n=this.paymentIntegrationService.getState(),r=n.getCartOrThrow(),o=n.getBillingAddressOrThrow(),{firstName:a,lastName:s,countryCode:d}=o,{currency:l,email:c,lineItems:u}=r,h=u.physicalItems.length>0,y=n.getCheckoutOrThrow().outstandingBalance,m=n.getStoreConfigOrThrow().links.checkoutLink;return{paymentType:e,amount:y,fallback:{url:m,buttonText:\"Complete Payment\"},currencyCode:l.code,shippingAddressRequired:h,email:c,givenName:a,surname:s,address:{countryCode:d},onPaymentStart:(n,r)=>ht(this,void 0,void 0,function*(){if(!this.isLPMsUpdateExperimentEnabled)return this.orderId=n.paymentId,void r();const o=yield this.getLPMsBasicPaymentData(),a=Object.assign(Object.assign({},o),{formattedPayload:{method:e,[`${e}_account`]:{order_id:n.paymentId}}});try{yield this.paymentIntegrationService.submitOrder(t,i),yield this.paymentIntegrationService.submitPayment({methodId:e,paymentData:a})}catch(t){if(this.isBraintreeOrderSavedResponse(t)&&t.body.additional_action_required.data.order_id_saved_successfully)return r(),this.isPollingEnabled?new Promise((t,i)=>{this.initializePollingMechanism(e,t,i,this.gatewayId)}):void 0;throw t}})}}getInstantLPMCallback(e,t,i,n,r){const o=this.paymentIntegrationService.getState().getCartOrThrow();return(a,s)=>ht(this,void 0,void 0,function*(){if(a)return\"LOCAL_PAYMENT_WINDOW_CLOSED\"===a.code?(this.toggleLoadingIndicator(!1),this.resetPollingMechanism(),t()):(this.isPollingEnabled&&this.resetPollingMechanism(),this.toggleLoadingIndicator(!1),t(new ct));const d=yield this.getLPMsBasicPaymentData(),l=Object.assign(Object.assign({},d),{formattedPayload:{method:i,[`${i}_account`]:Object.assign({email:o.email,token:s.nonce},this.isLPMsUpdateExperimentEnabled?{}:{order_id:this.orderId})}});try{return this.isLPMsUpdateExperimentEnabled||(yield this.paymentIntegrationService.submitOrder(n,r)),yield this.paymentIntegrationService.submitPayment({methodId:i,paymentData:l}),e(void 0)}catch(e){return this.handleError(e),t(e)}})}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}handleError(e){const{onError:t}=this.braintreelocalmethods||{};this.isPollingEnabled&&this.resetPollingMechanism(),this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}isNonInstantPaymentMethod(e){return e.toUpperCase()in ne}isBraintreeRedirectError(e){var t;if(\"object\"!=typeof e||null===e)return!1;const{body:i}=e;return!!i&&!!(null===(t=i.additional_action_required)||void 0===t?void 0:t.data.redirect_url)}isBraintreeOrderSavedResponse(e){var t;if(\"object\"!=typeof e||null===e)return!1;const{body:i}=e;return!!i&&(null===(t=i.additional_action_required)||void 0===t?void 0:t.data.hasOwnProperty(\"order_id_saved_successfully\"))}initializePollingMechanism(e,t,i,n){return ht(this,void 0,void 0,function*(){yield new Promise((e,t)=>{const i=setTimeout(e,this.pollingInterval);this.stopPolling=()=>(clearTimeout(i),this.toggleLoadingIndicator(!1),t())});try{this.pollingTimer+=this.pollingInterval;const r=yield this.braintreeRequestSender.getOrderStatus(n,{params:{useMetadata:!1}}),o=r.status===ie.Pending,a=r.status===ie.Completed,s=r.status===ie.Failed;if(a)return this.deinitializePollingMechanism(),t();if(s)return i();if(!a&&o&&this.pollingTimer<this.maxPollingIntervalTime)return yield this.initializePollingMechanism(e,t,i,n);yield this.reinitializeStrategy({methodId:e,gatewayId:n,braintreelocalmethods:this.braintreelocalmethods}),this.handleError(new ut)}catch(e){i()}})}deinitializePollingMechanism(){this.stopPolling(),this.pollingTimer=0}resetPollingMechanism(){this.deinitializePollingMechanism()}reinitializeStrategy(e){return ht(this,void 0,void 0,function*(){yield this.deinitialize(),yield this.initialize(e)})}}const mt=q(e=>{const i=window,n=new v(e),r=new ge(new W((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),i,n)),o=(0,_bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_4__.createRequestSender)(),a=new st(o);return new yt(e,r,a,new Ze({styles:{backgroundColor:\"black\"}}))},[{gateway:\"braintreelocalmethods\"}]);function pt(e){return!!e&&(\"authenticationState\"in e||\"addresses\"in e||\"instruments\"in e)}var gt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class vt{constructor(e,t,i){this.paymentIntegrationService=e,this.braintreeFastlaneUtils=t,this.braintreeSdk=i}initialize(e){var t;return gt(this,void 0,void 0,function*(){const{methodId:i,braintreefastlane:n}=e;if(!i)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!n)throw new w('Unable to initialize payment because \"options.braintreefastlane\" argument is not provided.');if(!n.onInit||\"function\"!=typeof n.onInit)throw new w('Unable to initialize payment because \"options.braintreefastlane.onInit\" argument is not provided or it is not a function.');if(!n.onChange||\"function\"!=typeof n.onChange)throw new w('Unable to initialize payment because \"options.braintreefastlane.onChange\" argument is not provided or it is not a function.');yield this.paymentIntegrationService.loadPaymentMethod(i);const r=this.paymentIntegrationService.getState(),o=r.getPaymentMethodOrThrow(i),{initializationData:a,clientToken:s}=o||{},{isFastlaneStylingEnabled:d}=a||{},l=y(r.getStoreConfigOrThrow().checkoutSettings.features,\"PROJECT-7080.braintree_fastlane_three_ds\");this.is3DSEnabled=o.config.is3dsEnabled,s&&l&&this.braintreeSdk.initialize(s);const c=ee(d?null===(t=o.initializationData)||void 0===t?void 0:t.fastlaneStyles:void 0,n.styles);yield this.braintreeFastlaneUtils.initializeBraintreeFastlaneOrThrow(i,c),this.shouldRunAuthenticationFlow()&&(yield this.braintreeFastlaneUtils.runPayPalAuthenticationFlowOrThrow()),yield this.initializeCardComponent(),this.onError=n.onError,n.onInit(e=>this.renderBraintreeCardComponent(e)),n.onChange(()=>this.handleBraintreeStoredInstrumentChange(i))})}execute(e,t){return gt(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!i)throw new C([\"payment\"]);yield this.paymentIntegrationService.submitOrder(n,t);const r=yield this.preparePaymentPayload(i.methodId);yield this.paymentIntegrationService.submitPayment(r),this.braintreeFastlaneUtils.removeSessionIdFromCookies()})}finalize(){return Promise.reject(new He)}deinitialize(){return gt(this,void 0,void 0,function*(){return this.braintreeCardComponent=void 0,Promise.resolve()})}initializeCardComponent(){return gt(this,void 0,void 0,function*(){const e=this.paymentIntegrationService.getState(),{phone:t,firstName:i,lastName:n}=e.getBillingAddressOrThrow(),r=`${i} ${n}`,o={styles:{},fields:Object.assign({cardholderName:{prefill:r,enabled:!0}},t&&{phoneNumber:{prefill:t}})},a=this.braintreeFastlaneUtils.getBraintreeFastlaneComponentOrThrow();this.braintreeCardComponent=yield a(o)})}renderBraintreeCardComponent(e){const t=this.getBraintreeCardComponentOrThrow();if(!e)throw new w('Unable to initialize payment because \"container\" argument is not provided.');t.render(e)}preparePaymentPayload(e){var t,i;return gt(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState(),r=n.getBillingAddressOrThrow(),o=`${r.firstName} ${r.lastName}`,a=this.getPayPalInstruments()[0],s=yield this.braintreeFastlaneUtils.getDeviceSessionId(),d=y(n.getStoreConfigOrThrow().checkoutSettings.features,\"PROJECT-7080.braintree_fastlane_three_ds\");if(a){const t=this.is3DSEnabled&&d?yield this.get3DS(a.bigpayToken,(null==a?void 0:a.iin)||\"\"):void 0;return{methodId:e,paymentData:{deviceSessionId:s,formattedPayload:{paypal_fastlane_token:{token:t||a.bigpayToken}}}}}const{getPaymentToken:l}=this.getBraintreeCardComponentOrThrow(),c=yield l({name:{fullName:o},billingAddress:this.mapToPayPalAddress(r)}),u=(null===(i=null===(t=c.paymentSource.card)||void 0===t?void 0:t.binDetails)||void 0===i?void 0:i.bin)||\"\",h=this.is3DSEnabled&&d?yield this.get3DS(c.id,u):void 0;return{methodId:e,paymentData:{deviceSessionId:s,nonce:h||c.id}}})}get3DS(e,t){return gt(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState(),n=yield this.braintreeSdk.getBraintreeThreeDS(),r=i.getOrderOrThrow();return new Promise((i,o)=>{n.verifyCard({amount:null==r?void 0:r.orderAmount,nonce:e,bin:t,onLookupComplete:(e,t)=>{n.on(\"customer-canceled\",()=>{\"function\"==typeof this.onError&&this.onError(new O),o(new O)}),t()}},(e,t)=>(e&&\"THREEDS_VERIFY_CARD_CANCELED_BY_MERCHANT\"===e.code&&(\"function\"==typeof this.onError&&this.onError(new O),o(new O)),i(t.nonce)))})})}mapToPayPalAddress(e){return{streetAddress:(null==e?void 0:e.address1)||\"\",locality:(null==e?void 0:e.city)||\"\",region:(null==e?void 0:e.stateOrProvinceCode)||(null==e?void 0:e.stateOrProvince)||\"\",postalCode:(null==e?void 0:e.postalCode)||\"\",countryCodeAlpha2:(null==e?void 0:e.countryCode)||\"\"}}shouldRunAuthenticationFlow(){const e=this.paymentIntegrationService.getState(),t=e.getCartOrThrow(),i=e.getCustomerOrThrow(),n=e.getPaymentProviderCustomer(),r=pt(n)?n:{},o=this.braintreeFastlaneUtils.getSessionIdFromCookies();return!(!i.isGuest||(null==r?void 0:r.authenticationState)===re.CANCELED||(null==r?void 0:r.authenticationState)||o!==t.id)}getBraintreeCardComponentOrThrow(){if(!this.braintreeCardComponent)throw new j;return this.braintreeCardComponent}getPayPalInstruments(){const e=this.paymentIntegrationService.getState().getPaymentProviderCustomerOrThrow();return(pt(e)?e:{}).instruments||[]}handleBraintreeStoredInstrumentChange(e){return gt(this,void 0,void 0,function*(){const t=this.braintreeFastlaneUtils.getBraintreeFastlaneOrThrow(),{selectionChanged:i,selectedCard:n}=yield t.profile.showCardSelector();if(i){const t=this.paymentIntegrationService.getState().getPaymentProviderCustomer(),i=pt(t)?t:{},r=this.braintreeFastlaneUtils.mapPayPalToBcInstrument(e,[n]);if(r&&r.length>0)return yield this.paymentIntegrationService.updatePaymentProviderCustomer(Object.assign(Object.assign({},i),{instruments:[...r]})),r[0]}})}}const ft=q(e=>{const i=window,n=new v(e),r=new V(new W((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),i,n),i),o=new ye(e,r),a=new W((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),i,n),s=new ge(a);return new vt(e,o,s)},[{id:\"braintreeacceleratedcheckout\"}]);var bt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class wt{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i}initialize(e){return bt(this,void 0,void 0,function*(){const{braintreevisacheckout:t,methodId:i}=e;if(!t)throw new w('Unable to initialize payment because \"options.braintreevisacheckout\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(i);const n=this.paymentIntegrationService.getState();this.paymentMethod=n.getPaymentMethodOrThrow(i);const r=n.getCheckoutOrThrow(),o=n.getStoreConfigOrThrow(),{clientToken:s,config:d}=this.paymentMethod||{};if(!s)throw new $(R.MissingPaymentMethod);const{onError:l=lodash__WEBPACK_IMPORTED_MODULE_2__.noop,onPaymentSelect:c=lodash__WEBPACK_IMPORTED_MODULE_2__.noop}=t;this.braintreeSdk.initialize(s);const u=yield this.braintreeSdk.getBraintreeVisaCheckout(),h=yield this.braintreeSdk.getVisaCheckoutSdk(null==d?void 0:d.testMode),y=u.createInitOptions({settings:{locale:o.storeProfile.storeLanguage,shipping:{collectShipping:!1}},paymentRequest:{currencyCode:o.currency.code,subtotal:String(r.subtotal)}});yield h.init(y),h.on(\"payment.success\",e=>this.tokenizePayment(u,e).then(()=>Promise.all([this.paymentIntegrationService.loadCheckout(),this.paymentIntegrationService.loadPaymentMethod(i)])).then(()=>c()).catch(e=>l(e))),h.on(\"payment.error\",(e,t)=>l(t))})}execute(e,t){var i,n;return bt(this,void 0,void 0,function*(){const{payment:r}=e,o=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!r)throw new w('Unable to submit payment because \"payload.payment\" argument is not provided.');if(!(null===(n=null===(i=this.paymentMethod)||void 0===i?void 0:i.initializationData)||void 0===n?void 0:n.nonce))throw new $(R.MissingPaymentMethod);const{nonce:a}=this.paymentMethod.initializationData;try{yield this.paymentIntegrationService.submitOrder(o,t),yield this.paymentIntegrationService.submitPayment(Object.assign(Object.assign({},r),{paymentData:{nonce:a}}))}catch(e){this.handleError(e)}})}finalize(){return Promise.reject(new He)}deinitialize(){return bt(this,void 0,void 0,function*(){yield this.braintreeSdk.deinitialize()})}tokenizePayment(e,t){return bt(this,void 0,void 0,function*(){return Promise.all([e.tokenize(t),this.braintreeSdk.getDataCollectorOrThrow()]).then(([e,t])=>{const i=this.paymentIntegrationService.getState(),n=i.getShippingAddress(),r=i.getBillingAddress(),{shippingAddress:o=this.mapToVisaCheckoutAddress(n),billingAddress:a=this.mapToVisaCheckoutAddress(r)}=e;return this.postForm(Object.assign(Object.assign({},e),{shippingAddress:o,billingAddress:a}),t)})})}mapToVisaCheckoutAddress(e){return e?{firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phone,streetAddress:e.address1,extendedAddress:e.address2,locality:e.city,region:e.stateOrProvinceCode,countryCode:e.countryCode,postalCode:e.postalCode}:{}}postForm(e,t){const{userData:i,billingAddress:n,shippingAddress:r,details:o}=e,{userEmail:a}=i,{deviceData:s}=t;return this.formPoster.postForm(\"/checkout.php\",{payment_type:e.type,nonce:e.nonce,provider:\"braintreevisacheckout\",action:\"set_external_checkout\",device_data:s,card_information:JSON.stringify({type:o.cardType,number:o.lastTwo}),billing_address:JSON.stringify(this.getAddress(a,n)),shipping_address:JSON.stringify(this.getAddress(a,r))})}getAddress(e,t={}){return{email:e,first_name:t.firstName,last_name:t.lastName,phone_number:t.phoneNumber,address_line_1:t.streetAddress,address_line_2:t.extendedAddress,city:t.locality,state:t.region,country_code:t.countryCode,postal_code:t.postalCode}}handleError(e){if(e instanceof Error&&\"BraintreeError\"===e.name)throw new qe(e.message);throw e}}const Ct=q(i=>{const n=window,r=new v(i),o=new ge(new W((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),n,r));return new wt(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),o)},[{id:\"braintreevisacheckout\"}]);var St=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Pt{constructor(e,t){this.paymentIntegrationService=e,this.braintreeIntegrationService=t}initialize(e){return St(this,void 0,void 0,function*(){const{methodId:t}=e;yield this.paymentIntegrationService.loadPaymentMethod(t);const i=this.paymentIntegrationService.getState();this.venmoOptions=e.braintreevenmo;const n=i.getPaymentMethodOrThrow(t);yield this.initializeBraintreeVenmo(n)})}execute(e){return St(this,void 0,void 0,function*(){const{payment:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!t)throw new C([\"payment\"]);try{const e=yield this.preparePaymentData(t);yield this.paymentIntegrationService.submitOrder(i),yield this.paymentIntegrationService.submitPayment(e)}catch(e){this.handleError(e)}})}finalize(){return Promise.reject(new He)}deinitialize(){return St(this,void 0,void 0,function*(){return yield this.braintreeIntegrationService.teardown(),Promise.resolve()})}handleError(e){if(!F(e))throw e;if(\"PAYPAL_POPUP_CLOSED\"===e.code)throw new O(e.message);throw new qe(e.message)}initializeBraintreeVenmo(e){var t;return St(this,void 0,void 0,function*(){const{clientToken:i}=e;if(!i)throw new $(R.MissingPaymentMethod);const n=y(this.paymentIntegrationService.getState().getStoreConfigOrThrow().checkoutSettings.features,\"PAYPAL-5406.braintree_venmo_web_fallback_support\");try{this.braintreeIntegrationService.initialize(i),this.braintreeVenmoCheckout=yield this.braintreeIntegrationService.getVenmoCheckout(Object.assign(Object.assign({},void 0!==(null===(t=this.venmoOptions)||void 0===t?void 0:t.allowDesktop)?{allowDesktop:this.venmoOptions.allowDesktop}:{}),n?{mobileWebFallBack:n}:{}))}catch(e){this.handleError(e)}})}preparePaymentData(e){return St(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState(),{nonce:i}=t.getPaymentMethodOrThrow(e.methodId);if(i)return Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(i)});const n=yield this.braintreeVenmoTokenize(),r=yield this.braintreeIntegrationService.getSessionId();return Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(n.nonce,n.details.email,r)})})}formattedPayload(e,t,i){return{formattedPayload:{vault_payment_instrument:null,set_as_default_stored_instrument:null,device_info:i||null,paypal_account:{token:e,email:t||null}}}}braintreeVenmoTokenize(){return new Promise((e,t)=>{var i;null===(i=this.braintreeVenmoCheckout)||void 0===i||i.tokenize((i,n)=>{if(i)return t(i);e(n)})})}}const It=q(e=>{const i=window,n=(0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),r=new v(e),o=new W(n,i,r),a=new V(o,i);return new Pt(e,a)},[{id:\"braintreevenmo\"}]);var Ot=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class kt{constructor(e,t,i){this.paymentIntegrationService=e,this.braintreeIntegrationService=t,this.braintreeHostedForm=i}initialize(e){return Ot(this,void 0,void 0,function*(){const{methodId:t,gatewayId:i,braintree:n}=e;yield this.paymentIntegrationService.loadPaymentMethod(t);const r=this.paymentIntegrationService.getState();this.paymentMethod=r.getPaymentMethodOrThrow(t);const{clientToken:o}=this.paymentMethod;if(!o)throw new $(R.MissingPaymentMethod);this.threeDSecure=null==n?void 0:n.threeDSecure;try{this.braintreeIntegrationService.initialize(o,this.threeDSecure),this.isHostedPaymentFormEnabled(t,i)&&(null==n?void 0:n.form)&&(yield this.braintreeHostedForm.initialize(n.form,n.unsupportedCardBrands,o),this.isHostedFormInitialized=this.braintreeHostedForm.isInitialized()),this.is3dsEnabled=this.paymentMethod.config.is3dsEnabled,this.deviceSessionId=yield this.braintreeIntegrationService.getSessionId(),this.shouldInitializeBraintreeFastlane()&&(yield this.initializeBraintreeFastlaneOrThrow(t))}catch(e){return this.handleError(e,t)}})}execute(e){return Ot(this,void 0,void 0,function*(){const{payment:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!t)throw new C([\"payment\"]);this.isHostedFormInitialized&&this.braintreeHostedForm.validate(),yield this.paymentIntegrationService.submitOrder(i);const n=this.paymentIntegrationService.getState(),r=n.getBillingAddressOrThrow(),o=n.getOrderOrThrow().orderAmount;try{const e=this.isHostedFormInitialized?yield this.prepareHostedPaymentData(t,r,o):yield this.preparePaymentData(t,r,o);yield this.paymentIntegrationService.submitPayment(Object.assign(Object.assign({},t),{paymentData:e}))}catch(e){return this.processAdditionalAction(e,t,o)}})}finalize(){return Promise.reject(new He)}deinitialize(){return Ot(this,void 0,void 0,function*(){return this.isHostedFormInitialized=!1,yield Promise.all([this.braintreeIntegrationService.teardown(),this.braintreeHostedForm.deinitialize()]),Promise.resolve()})}handleError(e,t){if(Fe(e)){if(!(t&&this.paymentIntegrationService.getState().isPaymentMethodInitialized({methodId:t})||\"HOSTED_FIELDS_INVALID_FIELD_SELECTOR\"!==e.code))return;throw new qe(e.message)}throw e}preparePaymentData(e,t,i){return Ot(this,void 0,void 0,function*(){const{paymentData:n}=e,r={deviceSessionId:this.deviceSessionId};if(this.isSubmittingWithStoredCard(e))return Object.assign(Object.assign({},r),n);const{shouldSaveInstrument:o=!1,shouldSetAsDefaultInstrument:a=!1}=We(n)?n:{},{nonce:s}=this.shouldPerform3DSVerification(e)?yield this.braintreeIntegrationService.verifyCard(e,t,i):yield this.braintreeIntegrationService.tokenizeCard(e,t);return Object.assign(Object.assign({},r),{nonce:s,shouldSaveInstrument:o,shouldSetAsDefaultInstrument:a})})}prepareHostedPaymentData(e,t,i){return Ot(this,void 0,void 0,function*(){const{paymentData:n}=e,r={deviceSessionId:this.deviceSessionId};if(this.isSubmittingWithStoredCard(e)){const{nonce:e}=yield this.braintreeHostedForm.tokenizeForStoredCardVerification();return Object.assign(Object.assign(Object.assign({},r),n),{nonce:e})}const{shouldSaveInstrument:o=!1,shouldSetAsDefaultInstrument:a=!1}=We(n)?n:{},{nonce:s}=this.shouldPerform3DSVerification(e)?yield this.verifyCardWithHostedForm(t,i):yield this.braintreeHostedForm.tokenize(t);return Object.assign(Object.assign({},r),{shouldSaveInstrument:o,shouldSetAsDefaultInstrument:a,nonce:s})})}verifyCardWithHostedForm(e,t){return Ot(this,void 0,void 0,function*(){const i=yield this.braintreeHostedForm.tokenize(e);return this.braintreeIntegrationService.challenge3DSVerification(i,t)})}processAdditionalAction(e,t,i){return Ot(this,void 0,void 0,function*(){if(!(e=>\"object\"==typeof e&&null!==e&&\"body\"in e)(e)||!(0,lodash__WEBPACK_IMPORTED_MODULE_2__.some)(e.body.errors,{code:\"three_d_secure_required\"}))return this.handleError(e);try{const{payer_auth_request:n}=function(e){return\"object\"==typeof e&&null!==e&&\"name\"in e&&\"body\"in e&&\"status\"in e.body&&\"three_ds_result\"in e.body&&\"payer_auth_request\"in e.body.three_ds_result&&\"errors\"in e.body}(e)&&e.body.three_ds_result||{},{paymentData:r}=t,o=this.paymentIntegrationService.getState();if(!r||!Re(r))throw new C([\"instrumentId\"]);const a=o.getCardInstrumentOrThrow(r.instrumentId),{nonce:s}=yield this.braintreeIntegrationService.challenge3DSVerification({nonce:n||\"\",bin:a.iin},i);yield this.paymentIntegrationService.submitPayment(Object.assign(Object.assign({},t),{paymentData:{deviceSessionId:this.deviceSessionId,nonce:s}}))}catch(e){return this.handleError(e)}})}isHostedPaymentFormEnabled(e,t){return!!e&&!0===this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e,t).config.isHostedFormEnabled}isSubmittingWithStoredCard(e){return!(!e.paymentData||!Re(e.paymentData))}shouldPerform3DSVerification(e){return!(!this.is3dsEnabled||this.isSubmittingWithStoredCard(e))}shouldInitializeBraintreeFastlane(){var e;const t=this.paymentIntegrationService.getState().getPaymentProviderCustomerOrThrow(),i=pt(t)?t:{};return(null===(e=this.paymentMethod)||void 0===e?void 0:e.initializationData.isAcceleratedCheckoutEnabled)&&!(null==i?void 0:i.authenticationState)}initializeBraintreeFastlaneOrThrow(e){return Ot(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState(),i=t.getCartOrThrow(),n=t.getPaymentMethodOrThrow(e),{clientToken:r,config:o}=n;if(!r)throw new $(R.MissingPaymentMethod);this.braintreeIntegrationService.initialize(r,this.threeDSecure),yield this.braintreeIntegrationService.getBraintreeFastlane(i.id,o.testMode)})}}function Et(e){return\"cardNumber\"in e}function Tt(e){if(!F(e))return!1;const{details:t}=e;return void 0===t||\"object\"==typeof t&&null!==t&&void 0===t.invalidFieldKeys||(i=t,Array.isArray(i)&&i.every(e=>\"string\"==typeof e));// removed by dead control flow\n var i; }var At,zt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};!function(e){e[e.CreditCard=0]=\"CreditCard\",e[e.StoredCardVerification=1]=\"StoredCardVerification\"}(At||(At={}));class Nt{constructor(e,t){this.braintreeScriptLoader=e,this.braintreeSDKVersionManager=t,this.isInitializedHostedForm=!1,this.handleBlur=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onBlur)||void 0===i||i.call(t,{fieldType:this.mapFieldType(e.emittedBy),errors:this.mapErrors(e.fields)})},this.handleFocus=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onFocus)||void 0===i||i.call(t,{fieldType:this.mapFieldType(e.emittedBy)})},this.handleCardTypeChange=e=>{var t,i;const n=1===e.cards.length?e.cards[0].type.replace(/^master-card$/,\"mastercard\"):void 0;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onCardTypeChange)||void 0===i||i.call(t,{cardType:n})},this.handleInputSubmitRequest=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onEnter)||void 0===i||i.call(t,{fieldType:this.mapFieldType(e.emittedBy)})},this.handleValidityChange=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onValidate)||void 0===i||i.call(t,{isValid:this.isValidForm(e),errors:this.mapValidationErrors(e.fields)})}}initialize(e,t,i){var r,o,a,s,d;return zt(this,void 0,void 0,function*(){this.clientToken=i,this.formOptions=e,this.type=Et(e.fields)?At.CreditCard:At.StoredCardVerification;const l=this.mapFieldOptions(e.fields,t);(0,lodash__WEBPACK_IMPORTED_MODULE_2__.isEmpty)(l)?this.isInitializedHostedForm=!1:(this.cardFields=yield this.createHostedFields({fields:l,styles:e.styles&&this.mapStyleOptions(e.styles)}),null===(r=this.cardFields)||void 0===r||r.on(\"blur\",this.handleBlur),null===(o=this.cardFields)||void 0===o||o.on(\"focus\",this.handleFocus),null===(a=this.cardFields)||void 0===a||a.on(\"cardTypeChange\",this.handleCardTypeChange),null===(s=this.cardFields)||void 0===s||s.on(\"validityChange\",this.handleValidityChange),null===(d=this.cardFields)||void 0===d||d.on(\"inputSubmitRequest\",this.handleInputSubmitRequest),this.isInitializedHostedForm=!0)})}isInitialized(){return!!this.isInitializedHostedForm}deinitialize(){var e;return zt(this,void 0,void 0,function*(){this.isInitializedHostedForm&&(this.isInitializedHostedForm=!1,yield null===(e=this.cardFields)||void 0===e?void 0:e.teardown())})}validate(){if(!this.cardFields)throw new I(P.PaymentNotInitialized);const e=this.cardFields.getState();if(!this.isValidForm(e)){this.handleValidityChange(e);const t=this.mapValidationErrors(e.fields);throw new S(t)}}tokenize(e){var t,i,n,r,a;return zt(this,void 0,void 0,function*(){if(!this.cardFields)throw new I(P.PaymentNotInitialized);try{const r=yield this.cardFields.tokenize((0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)({billingAddress:e&&this.mapBillingAddress(e)},lodash__WEBPACK_IMPORTED_MODULE_2__.isNil));return null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onValidate)||void 0===i||i.call(t,{isValid:!0,errors:{}}),{nonce:r.nonce,bin:null===(n=r.details)||void 0===n?void 0:n.bin}}catch(e){if(Tt(e)){const t=this.mapTokenizeError(e);if(t)throw null===(a=null===(r=this.formOptions)||void 0===r?void 0:r.onValidate)||void 0===a||a.call(r,{isValid:!1,errors:t}),new S(t)}throw e}})}tokenizeForStoredCardVerification(){var e,t,i,n,r;return zt(this,void 0,void 0,function*(){if(!this.cardFields)throw new I(P.PaymentNotInitialized);try{const n=yield this.cardFields.tokenize();return null===(t=null===(e=this.formOptions)||void 0===e?void 0:e.onValidate)||void 0===t||t.call(e,{isValid:!0,errors:{}}),{nonce:n.nonce,bin:null===(i=n.details)||void 0===i?void 0:i.bin}}catch(e){if(Tt(e)){const t=this.mapTokenizeError(e,!0);if(t)throw null===(r=null===(n=this.formOptions)||void 0===n?void 0:n.onValidate)||void 0===r||r.call(n,{isValid:!1,errors:t}),new S(t)}throw e}})}createHostedFields(e){return zt(this,void 0,void 0,function*(){const t=yield this.getClient(),i=yield this.braintreeScriptLoader.loadHostedFields(),n=this.braintreeSDKVersionManager.getSDKVersion()===m?Object.assign(Object.assign({},e),{preventCursorJumps:!0}):e;return i.create(Object.assign(Object.assign({},n),{client:t}))})}getClient(){return zt(this,void 0,void 0,function*(){if(!this.clientToken)throw new I(P.PaymentNotInitialized);if(!this.client){const e=yield this.braintreeScriptLoader.loadClient();this.client=e.create({authorization:this.clientToken})}return this.client})}mapBillingAddress(e){return{countryName:e.country,postalCode:e.postalCode,streetAddress:e.address2?`${e.address1} ${e.address2}`:e.address1}}mapFieldOptions(e,t){if(Et(e)){const i={};return null==t||t.forEach(e=>{(e=>Object.values(se).includes(e))(e)&&(i[e]=!1)}),(0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)({number:Object.assign({container:`#${e.cardNumber.containerId}`,placeholder:e.cardNumber.placeholder,internalLabel:e.cardNumber.accessibilityLabel},Object.keys(i).length>0?{supportedCardBrands:i}:{}),expirationDate:{container:`#${e.cardExpiry.containerId}`,placeholder:e.cardExpiry.placeholder,internalLabel:e.cardExpiry.accessibilityLabel},cvv:e.cardCode&&{container:`#${e.cardCode.containerId}`,placeholder:e.cardCode.placeholder,internalLabel:e.cardCode.accessibilityLabel},cardholderName:{container:`#${e.cardName.containerId}`,placeholder:e.cardName.placeholder,internalLabel:e.cardName.accessibilityLabel}},lodash__WEBPACK_IMPORTED_MODULE_2__.isNil)}return (0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)({number:e.cardNumberVerification&&{container:`#${e.cardNumberVerification.containerId}`,placeholder:e.cardNumberVerification.placeholder},cvv:e.cardCodeVerification&&{container:`#${e.cardCodeVerification.containerId}`,placeholder:e.cardCodeVerification.placeholder}},lodash__WEBPACK_IMPORTED_MODULE_2__.isNil)}mapStyleOptions(e){const t=(e={})=>(0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)({color:e.color,\"font-family\":e.fontFamily,\"font-size\":e.fontSize,\"font-weight\":e.fontWeight},lodash__WEBPACK_IMPORTED_MODULE_2__.isNil);return{input:t(e.default),\".invalid\":t(e.error),\":focus\":t(e.focus)}}mapFieldType(e){switch(e){case\"number\":return this.type===At.StoredCardVerification?x.CardNumberVerification:x.CardNumber;case\"expirationDate\":return x.CardExpiry;case\"cvv\":return this.type===At.StoredCardVerification?x.CardCodeVerification:x.CardCode;case\"cardholderName\":return x.CardName;default:throw new Error(\"Unexpected field type\")}}mapErrors(e){const t={};if(e)for(const[i,n]of Object.entries(e))if(n&&this.isValidParam(i)){const{isValid:e,isEmpty:r,isPotentiallyValid:o}=n;t[i]={isValid:e,isEmpty:r,isPotentiallyValid:o}}return t}mapValidationErrors(e){return Object.keys(e).reduce((t,i)=>{var n;return Object.assign(Object.assign({},t),{[this.mapFieldType(i)]:(null===(n=e[i])||void 0===n?void 0:n.isValid)?void 0:[this.createInvalidError(this.mapFieldType(i))]})},{})}mapTokenizeError(e,t=!1){var i,n;if(\"HOSTED_FIELDS_FIELDS_EMPTY\"===e.code){const e=[this.createRequiredError(this.mapFieldType(\"cvv\"))];return t?{[this.mapFieldType(\"cvv\")]:e}:{[this.mapFieldType(\"cvv\")]:e,[this.mapFieldType(\"expirationDate\")]:[this.createRequiredError(this.mapFieldType(\"expirationDate\"))],[this.mapFieldType(\"number\")]:[this.createRequiredError(this.mapFieldType(\"number\"))],[this.mapFieldType(\"cardholderName\")]:[this.createRequiredError(this.mapFieldType(\"cardholderName\"))]}}return null===(n=null===(i=e.details)||void 0===i?void 0:i.invalidFieldKeys)||void 0===n?void 0:n.reduce((e,t)=>{const i=this.mapFieldType(t);return Object.assign(Object.assign({},e),{[i]:[this.createInvalidError(i)]})},{})}createRequiredError(e){var t;return{fieldType:e,message:null!==(t={[x.CardCode]:\"CVV is required\",[x.CardCodeVerification]:\"CVV is required\",[x.CardNumber]:\"Credit card number is required\",[x.CardNumberVerification]:\"Credit card number is required\",[x.CardExpiry]:\"Expiration date is required\",[x.CardName]:\"Full name is required\"}[e])&&void 0!==t?t:\"Field is required\",type:\"required\"}}createInvalidError(e){var t,i,n,r;const o={[x.CardCode]:{message:\"Invalid card code\",type:\"invalid_card_code\"},[x.CardCodeVerification]:{message:\"Invalid card code\",type:\"invalid_card_code\"},[x.CardNumber]:{message:\"Invalid card number\",type:\"invalid_card_number\"},[x.CardNumberVerification]:{message:\"Invalid card number\",type:\"invalid_card_number\"},[x.CardExpiry]:{message:\"Invalid card expiry\",type:\"invalid_card_expiry\"},[x.CardName]:{message:\"Invalid card name\",type:\"invalid_card_name\"}};return{fieldType:e,message:null!==(i=null===(t=o[e])||void 0===t?void 0:t.message)&&void 0!==i?i:\"Invalid field\",type:null!==(r=null===(n=o[e])||void 0===n?void 0:n.type)&&void 0!==r?r:\"invalid\"}}isValidForm(e){return Object.keys(e.fields).every(t=>{var i;return null===(i=e.fields[t])||void 0===i?void 0:i.isValid})}isValidParam(e){return[\"number\",\"cvv\",\"expirationDate\",\"postalCode\",\"cardholderName\",\"cardType\"].includes(e)}}const Mt=q(e=>{const i=window,n=new v(e),r=new W((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),i,n),o=new V(r,i),a=new Nt(r,n);return new kt(e,o,a)},[{id:\"braintree\"}]);\n//# sourceMappingURL=braintree.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vY2hlY2tvdXQtc2RrLWpzL2Rpc3QvZXNtL2ludGVncmF0aW9ucy9icmFpbnRyZWUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNXLFNBQVMscUJBQXFCLE1BQU0sdUNBQXVDLFlBQVksK0RBQStELHVCQUF1QixFQUFFLHNEQUFzRCwwQ0FBMEMsUUFBUSxlQUFlLDZEQUE2RCxnQkFBZ0Isc0hBQXNILHFKQUFxSix5QkFBeUIsdUNBQXVDLE1BQU0sUUFBUSw0Q0FBQyxrQ0FBa0Msa0NBQWtDLHNCQUFzQixlQUFlLE1BQU0sdVRBQXVULGtCQUFrQixlQUFlLDJHQUEyRyxrQkFBa0IsZUFBZSxpSEFBaUgsa0JBQWtCLGVBQWUsK0VBQStFLFNBQVMsR0FBRyx5REFBeUQsYUFBYSxzREFBc0Qsa0JBQWtCLGlCQUFpQixtS0FBbUssTUFBTSxhQUFhLHlTQUF5UyxTQUFTLEdBQUcsa0JBQWtCLGVBQWUsa0JBQWtCLFVBQVUsd0hBQXdILHNIQUFzSCx3SEFBd0gsNkhBQTZILDRGQUE0RixpRkFBaUYsa0JBQWtCLGVBQWUsa0hBQWtILFFBQVEsZUFBZSw0QkFBNEIsY0FBYyxFQUFFLGtDQUFrQywrQkFBK0Isc0JBQXNCLGNBQWMsc0ZBQXNGLGFBQWEsZ0RBQWdELFNBQVMsZUFBZSw0RUFBNEUsU0FBUyxlQUFlLDhFQUE4RSxTQUFTLGVBQWUsd0ZBQXdGLFNBQVMsZUFBZSw0QkFBNEIsU0FBUyxlQUFlLHdFQUF3RSxTQUFTLGVBQWUsOENBQThDLFNBQVMsZUFBZSxvVUFBb1UsU0FBUyxlQUFlLGdNQUFnTSxTQUFTLEdBQUcsd0JBQXdCLHlDQUF5QyxjQUFjLElBQUksYUFBYSxTQUFTLE1BQU0sY0FBYyxJQUFJLGNBQWMsU0FBUyxNQUFNLGNBQWMsTUFBTSxnRUFBZ0UsS0FBSyxhQUFhLCtCQUErQixHQUFHLFFBQVEsbUJBQW1CLDhGQUE4RixnQkFBZ0IsOENBQThDLDRCQUE0Qix3Q0FBd0MsMEpBQTBKLGdKQUFnSixNQUFNLHVDQUF1Qywy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REFBa0QsQ0FBQyx5Q0FBQyxFQUFFLG1CQUFtQixhQUFhLEdBQUcsOENBQUMsRUFBRSwyRkFBMkYsQ0FBQyx5Q0FBQyxFQUFFLE9BQU8sOERBQThELGdCQUFnQixVQUFVLGdHQUFnRyx5Q0FBeUMseUZBQXlGLHVDQUF1QyxrREFBa0QsYUFBYSxXQUFXLG9FQUFvRSxNQUFNLHlDQUF5QyxHQUFHLE1BQU0sMENBQTBDLFNBQVMsdUJBQXVCLHFDQUFxQyxNQUFNLHFDQUFxQyxLQUFLLDZIQUE2SCxFQUFFLEdBQUcsRUFBRSx5QkFBeUIsUUFBUSwwQ0FBMEMsNkRBQTZELFVBQVUsNkJBQTZCLEVBQUUsZ1VBQWdVLGlIQUFpSCw2QkFBNkIscUNBQXFDLEtBQUssaUNBQWlDLEVBQUUsR0FBRyxFQUFFLHVCQUF1QixNQUFNLE9BQU8sK0JBQStCLHdRQUF3USx3REFBd0Qsc0JBQXNCLFlBQVksU0FBUyxjQUFjLHFEQUFxRCwyQkFBMkIscURBQXFELGlCQUFpQix5REFBeUQsNkJBQTZCLHlEQUF5RCxpQkFBaUIseURBQXlELGVBQWUsdURBQXVELE9BQU8sNkxBQTZMLGVBQWUsdUNBQXVDLE1BQU0sMkRBQTJELEVBQUUsZ0JBQWdCLDhGQUE4RixlQUFlLGtDQUFrQywyRUFBQyxtQ0FBbUMscUJBQXFCLEdBQUcsZUFBZSxHQUFxckI7QUFDOXI1SCIsInNvdXJjZXMiOlsid2VicGFjazovL2NoZWNrb3V0Ly4uL2NoZWNrb3V0LXNkay1qcy9kaXN0L2VzbS9pbnRlZ3JhdGlvbnMvYnJhaW50cmVlLmpzP2I5MzUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0e2NyZWF0ZUZvcm1Qb3N0ZXIgYXMgZX1mcm9tXCJAYmlnY29tbWVyY2UvZm9ybS1wb3N0ZXJcIjtpbXBvcnR7Z2V0U2NyaXB0TG9hZGVyIGFzIHR9ZnJvbVwiQGJpZ2NvbW1lcmNlL3NjcmlwdC1sb2FkZXJcIjtpbXBvcnR7ZmluZCBhcyBpLGlzRW1wdHkgYXMgbixpc0VxdWFsIGFzIHIsaXNOaWwgYXMgbyxub29wIGFzIGEsb21pdCBhcyBzLG9taXRCeSBhcyBkLHNvbWUgYXMgbH1mcm9tXCJsb2Rhc2hcIjtpbXBvcnR7c3VwcG9ydHNQb3B1cHMgYXMgY31mcm9tXCJAYnJhaW50cmVlL2Jyb3dzZXItZGV0ZWN0aW9uXCI7aW1wb3J0e2NyZWF0ZVJlcXVlc3RTZW5kZXIgYXMgdX1mcm9tXCJAYmlnY29tbWVyY2UvcmVxdWVzdC1zZW5kZXJcIjt2YXIgaD17fTtmdW5jdGlvbiB5KGUsdCxpPSEwKXt2YXIgbjtyZXR1cm4gbnVsbCE9PShuPWVbdF0pJiZ2b2lkIDAhPT1uP246aX1oLmQ9KGUsdCk9Pntmb3IodmFyIGkgaW4gdCloLm8odCxpKSYmIWgubyhlLGkpJiZPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxpLHtlbnVtZXJhYmxlOiEwLGdldDp0W2ldfSl9LGgubz0oZSx0KT0+T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsdCk7Y29uc3QgbT1cIjMuMTI4LjBcIixwPVwiMy4xMjMuMlwiLGc9XCIzLjEwNi4wXCI7Y2xhc3Mgdntjb25zdHJ1Y3RvcihlKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJyYWludHJlZVdpbmRvdz13aW5kb3d9Z2V0U0RLVmVyc2lvbigpe2NvbnN0IGU9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0U3RvcmVDb25maWcoKSx0PShudWxsPT1lP3ZvaWQgMDplLmNoZWNrb3V0U2V0dGluZ3MuZmVhdHVyZXMpfHx7fTtyZXR1cm4gdGhpcy5nZXRQcmVsb2FkZWRTREtWZXJzaW9uKCl8fCh5KHQsXCJQQVlQQUwtNTgwOS5icmFpbnRyZWVfaG9zdGVkX2ZpZWxkc19maXhfdmVyc2lvblwiKT9tOnkodCxcIlBBWVBBTC01NjM2LnVwZGF0ZV9icmFpbnRyZWVfc2RrX3ZlcnNpb25cIik/cDpnKX1nZXRQcmVsb2FkZWRTREtWZXJzaW9uKCl7Y29uc3QgZT10aGlzLmJyYWludHJlZVdpbmRvdy5icmFpbnRyZWU7aWYoZSl7Y29uc3QgdD1pKE9iamVjdC52YWx1ZXMoZSksZT0+ISFlLlZFUlNJT04pO3JldHVybiBudWxsPT10P3ZvaWQgMDp0LlZFUlNJT059fX1jbGFzcyBmIGV4dGVuZHMgRXJyb3J7Y29uc3RydWN0b3IoZSl7dmFyIHQ7c3VwZXIoZXx8XCJBbiB1bmV4cGVjdGVkIGVycm9yIGhhcyBvY2N1cnJlZC5cIiksdGhpcy5uYW1lPVwiU3RhbmRhcmRFcnJvclwiLHRoaXMudHlwZT1cInN0YW5kYXJkXCIsdD1uZXcudGFyZ2V0LnByb3RvdHlwZSxPYmplY3Quc2V0UHJvdG90eXBlT2Y/T2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsdCk6dGhpcy5fX3Byb3RvX189dCxcImZ1bmN0aW9uXCI9PXR5cGVvZiBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZT9FcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLG5ldy50YXJnZXQpOnRoaXMuc3RhY2s9bmV3IEVycm9yKHRoaXMubWVzc2FnZSkuc3RhY2t9fWNsYXNzIGIgZXh0ZW5kcyBme2NvbnN0cnVjdG9yKGUpe3N1cGVyKGV8fFwiVW5zdXBwb3J0ZWQgYnJvd3NlciBlcnJvclwiKSx0aGlzLm5hbWU9XCJVbnN1cHBvcnRlZEJyb3dzZXJFcnJvclwiLHRoaXMudHlwZT1cInVuc3VwcG9ydGVkX2Jyb3dzZXJcIn19Y2xhc3MgdyBleHRlbmRzIGZ7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJJbnZhbGlkIGFyZ3VtZW50cyBoYXZlIGJlZW4gcHJvdmlkZWQuXCIpLHRoaXMubmFtZT1cIkludmFsaWRBcmd1bWVudEVycm9yXCIsdGhpcy50eXBlPVwiaW52YWxpZF9hcmd1bWVudFwifX1jbGFzcyBDIGV4dGVuZHMgd3tjb25zdHJ1Y3RvcihlKXtsZXQgdD1cIlVuYWJsZSB0byBzdWJtaXQgcGF5bWVudCBmb3IgdGhlIG9yZGVyIGJlY2F1c2UgdGhlIHBheWxvYWQgaXMgaW52YWxpZC5cIjtlJiYodD1gJHt0fSBNYWtlIHN1cmUgdGhlIGZvbGxvd2luZyBmaWVsZHMgYXJlIHByb3ZpZGVkIGNvcnJlY3RseTogJHtlLmpvaW4oXCIsIFwiKX0uYCksc3VwZXIodCksdGhpcy5uYW1lPVwiUGF5bWVudEFyZ3VtZW50SW52YWxpZEVycm9yXCJ9fWNsYXNzIFMgZXh0ZW5kcyBme2NvbnN0cnVjdG9yKGUsdCl7c3VwZXIodHx8XCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBwYXltZW50IGZvcm0gY29udGFpbnMgaW52YWxpZCBkYXRhLlwiKSx0aGlzLmRldGFpbHM9ZSx0aGlzLm5hbWU9XCJQYXltZW50SW52YWxpZEZvcm1FcnJvclwiLHRoaXMudHlwZT1cInBheW1lbnRfaW52YWxpZF9mb3JtXCJ9fXZhciBQOyFmdW5jdGlvbihlKXtlW2UuQ2hlY2tvdXRCdXR0b25Ob3RJbml0aWFsaXplZD0wXT1cIkNoZWNrb3V0QnV0dG9uTm90SW5pdGlhbGl6ZWRcIixlW2UuQ3VzdG9tZXJOb3RJbml0aWFsaXplZD0xXT1cIkN1c3RvbWVyTm90SW5pdGlhbGl6ZWRcIixlW2UuUGF5bWVudE5vdEluaXRpYWxpemVkPTJdPVwiUGF5bWVudE5vdEluaXRpYWxpemVkXCIsZVtlLlNoaXBwaW5nTm90SW5pdGlhbGl6ZWQ9M109XCJTaGlwcGluZ05vdEluaXRpYWxpemVkXCIsZVtlLlNwYW1Qcm90ZWN0aW9uTm90SW5pdGlhbGl6ZWQ9NF09XCJTcGFtUHJvdGVjdGlvbk5vdEluaXRpYWxpemVkXCJ9KFB8fChQPXt9KSk7Y2xhc3MgSSBleHRlbmRzIGZ7Y29uc3RydWN0b3IoZSl7c3VwZXIoZnVuY3Rpb24oZSl7c3dpdGNoKGUpe2Nhc2UgUC5DdXN0b21lck5vdEluaXRpYWxpemVkOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgY3VzdG9tZXIgc3RlcCBvZiBjaGVja291dCBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCI7Y2FzZSBQLlBheW1lbnROb3RJbml0aWFsaXplZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHBheW1lbnQgc3RlcCBvZiBjaGVja291dCBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCI7Y2FzZSBQLlNoaXBwaW5nTm90SW5pdGlhbGl6ZWQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBzaGlwcGluZyBzdGVwIG9mIGNoZWNrb3V0IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIjtjYXNlIFAuU3BhbVByb3RlY3Rpb25Ob3RJbml0aWFsaXplZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIGNoZWNrb3V0IHNwYW0gcHJvdGVjdGlvbiBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCI7ZGVmYXVsdDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHJlcXVpcmVkIGNvbXBvbmVudCBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCJ9fShlKSksdGhpcy5zdWJ0eXBlPWUsdGhpcy5uYW1lPVwiTm90SW5pdGlhbGl6ZWRFcnJvclwiLHRoaXMudHlwZT1cIm5vdF9pbml0aWFsaXplZFwifX1jbGFzcyBPIGV4dGVuZHMgZntjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIlBheW1lbnQgcHJvY2VzcyB3YXMgY2FuY2VsbGVkLlwiKSx0aGlzLm5hbWU9XCJQYXltZW50TWV0aG9kQ2FuY2VsbGVkRXJyb3JcIix0aGlzLnR5cGU9XCJwYXltZW50X2NhbmNlbGxlZFwifX1jbGFzcyBre2NvbnN0cnVjdG9yKGUpe2NvbnN0IHQ9bmV3IFByb21pc2UoKGUsdCk9Pnt0aGlzLmNhbmNlbD10fSk7dGhpcy5wcm9taXNlPVByb21pc2UucmFjZShbZSx0XSl9fWNvbnN0IEU9W1wiYnV0dG9uc1wiLFwibWVzc2FnZXNcIl07dmFyIFQsQSx6LE4sTSxELF8sQix4O2Z1bmN0aW9uIEYoZSl7cmV0dXJuIEJvb2xlYW4oXCJvYmplY3RcIj09dHlwZW9mIGUmJm51bGwhPT1lJiYoXCJ0eXBlXCJpbiBlfHxcIm1lc3NhZ2VcImluIGV8fFwiY29kZVwiaW4gZSkpfSFmdW5jdGlvbihlKXtlLkhPUklaT05UQUw9XCJob3Jpem9udGFsXCIsZS5WRVJUSUNBTD1cInZlcnRpY2FsXCJ9KFR8fChUPXt9KSksZnVuY3Rpb24oZSl7ZS5TTUFMTD1cInNtYWxsXCIsZS5NRURJVU09XCJtZWRpdW1cIixlLkxBUkdFPVwibGFyZ2VcIixlLlJFU1BPTlNJVkU9XCJyZXNwb25zaXZlXCJ9KEF8fChBPXt9KSksZnVuY3Rpb24oZSl7ZS5HT0xEPVwiZ29sZFwiLGUuQkxVRT1cImJsdWVcIixlLlNJbFZFUj1cInNpbHZlclwiLGUuQkxBQ0s9XCJibGFja1wiLGUuV0hJVEU9XCJ3aGl0ZVwifSh6fHwoej17fSkpLGZ1bmN0aW9uKGUpe2UuQ0hFQ0tPVVQ9XCJjaGVja291dFwiLGUuUEFZPVwicGF5XCIsZS5CVVlOT1c9XCJidXlub3dcIixlLlBBWVBBTD1cInBheXBhbFwiLGUuQ1JFRElUPVwiY3JlZGl0XCJ9KE58fChOPXt9KSksZnVuY3Rpb24oZSl7ZS5QSUxMPVwicGlsbFwiLGUuUkVDVD1cInJlY3RcIn0oTXx8KE09e30pKSxmdW5jdGlvbihlKXtlLkNBUlQ9XCJjYXJ0XCIsZS5IT01FPVwiaG9tZXBhZ2VcIixlLlBBWU1FTlQ9XCJwYXltZW50XCIsZS5QUk9EVUNUPVwicHJvZHVjdFwifShEfHwoRD17fSkpLGZ1bmN0aW9uKGUpe2UuU2FuZGJveD1cInNhbmRib3hcIixlLlByb2R1Y3Rpb249XCJwcm9kdWN0aW9uXCJ9KF98fChfPXt9KSksZnVuY3Rpb24oZSl7ZS5DbGllbnQ9XCJjbGllbnRcIixlLkRhdGFDb2xsZWN0b3I9XCJkYXRhQ29sbGVjdG9yXCIsZS5GYXN0bGFuZT1cImZhc3RsYW5lXCIsZS5Hb29nbGVQYXltZW50PVwiZ29vZ2xlUGF5bWVudFwiLGUuSG9zdGVkRmllbGRzPVwiaG9zdGVkRmllbGRzXCIsZS5Mb2NhbFBheW1lbnQ9XCJsb2NhbFBheW1lbnRcIixlLlBheXBhbD1cInBheXBhbFwiLGUuUGF5cGFsQ2hlY2tvdXQ9XCJwYXlwYWxDaGVja291dFwiLGUuVGhyZWVEU2VjdXJlPVwidGhyZWVEU2VjdXJlXCIsZS5Vc0JhbmtBY2NvdW50PVwidXNCYW5rQWNjb3VudFwiLGUuVmVubW89XCJ2ZW5tb1wiLGUuVmlzYUNoZWNrb3V0PVwidmlzYUNoZWNrb3V0XCJ9KEJ8fChCPXt9KSksZnVuY3Rpb24oZSl7ZS5DYXJkQ29kZT1cImNhcmRDb2RlXCIsZS5DYXJkQ29kZVZlcmlmaWNhdGlvbj1cImNhcmRDb2RlVmVyaWZpY2F0aW9uXCIsZS5DYXJkRXhwaXJ5PVwiY2FyZEV4cGlyeVwiLGUuQ2FyZE5hbWU9XCJjYXJkTmFtZVwiLGUuQ2FyZE51bWJlcj1cImNhcmROdW1iZXJcIixlLkNhcmROdW1iZXJWZXJpZmljYXRpb249XCJjYXJkTnVtYmVyVmVyaWZpY2F0aW9uXCJ9KHh8fCh4PXt9KSk7dmFyIEw9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgVntjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXI9ZSx0aGlzLmJyYWludHJlZUhvc3RXaW5kb3c9dCx0aGlzLm92ZXJsYXk9aSx0aGlzLmRhdGFDb2xsZWN0b3JzPXt9fWluaXRpYWxpemUoZSx0KXt0aGlzLmNsaWVudFRva2VuPWUsdGhpcy50aHJlZURTZWN1cmVPcHRpb25zPXR9Z2V0QnJhaW50cmVlRmFzdGxhbmUoZSx0LGkpe3JldHVybiBMKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZih0JiYod2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYXhvRW52XCIsXCJzYW5kYm94XCIpLHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImZhc3RsYW5lRW52XCIsXCJzYW5kYm94XCIpKSwhdGhpcy5icmFpbnRyZWVIb3N0V2luZG93LmJyYWludHJlZUZhc3RsYW5lKXtjb25zdCB0PXRoaXMuZ2V0Q2xpZW50VG9rZW5PclRocm93KCksbj15aWVsZCB0aGlzLmdldENsaWVudCgpLHI9eWllbGQgdGhpcy5nZXRTZXNzaW9uSWQoZSksbz15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkRmFzdGxhbmUoKSxhPXtyb290OntiYWNrZ3JvdW5kQ29sb3JQcmltYXJ5OlwidHJhbnNwYXJlbnRcIn19O3RoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5icmFpbnRyZWVGYXN0bGFuZT15aWVsZCBvLmNyZWF0ZSh7YXV0aG9yaXphdGlvbjp0LGNsaWVudDpuLGRldmljZURhdGE6cixzdHlsZXM6aXx8YX0pfXJldHVybiB0aGlzLmJyYWludHJlZUhvc3RXaW5kb3cuYnJhaW50cmVlRmFzdGxhbmV9KX1nZXRDbGllbnQoKXtyZXR1cm4gTCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuY2xpZW50KXtjb25zdCBlPXRoaXMuZ2V0Q2xpZW50VG9rZW5PclRocm93KCksdD15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkQ2xpZW50KCk7dGhpcy5jbGllbnQ9dC5jcmVhdGUoe2F1dGhvcml6YXRpb246ZX0pfXJldHVybiB0aGlzLmNsaWVudH0pfWdldFBheXBhbCgpe3JldHVybiB0aGlzLmJyYWludHJlZVBheXBhbHx8KHRoaXMuYnJhaW50cmVlUGF5cGFsPVByb21pc2UuYWxsKFt0aGlzLmdldENsaWVudCgpLHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRQYXlwYWwoKV0pLnRoZW4oKFtlLHRdKT0+dC5jcmVhdGUoe2NsaWVudDplfSkpKSx0aGlzLmJyYWludHJlZVBheXBhbH1wYXlwYWwoZSl7dmFye3Nob3VsZFNhdmVJbnN0cnVtZW50OnR9PWUsaT1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wic2hvdWxkU2F2ZUluc3RydW1lbnRcIl0pO2NvbnN0IG49YygpO3JldHVybiB0aGlzLmdldFBheXBhbCgpLnRoZW4oZT0+e3ZhciByO3JldHVybiBuJiYobnVsbD09PShyPXRoaXMub3ZlcmxheSl8fHZvaWQgMD09PXJ8fHIuc2hvdyh7b25DbGljazooKT0+ZS5mb2N1c1dpbmRvdygpfSkpLGUudG9rZW5pemUoT2JqZWN0LmFzc2lnbih7ZW5hYmxlU2hpcHBpbmdBZGRyZXNzOiEwLGZsb3c6dD9cInZhdWx0XCI6XCJjaGVja291dFwiLHVzZXJhY3Rpb246XCJjb21taXRcIn0saSkpfSkudGhlbihlPT57dmFyIHQ7cmV0dXJuIG51bGw9PT0odD10aGlzLm92ZXJsYXkpfHx2b2lkIDA9PT10fHx0LnJlbW92ZSgpLGV9KS5jYXRjaChlPT57dmFyIHQ7dGhyb3cgbnVsbD09PSh0PXRoaXMub3ZlcmxheSl8fHZvaWQgMD09PXR8fHQucmVtb3ZlKCksZX0pfWdldFBheXBhbENoZWNrb3V0KGUsdCxpKXtyZXR1cm4gTCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgbj15aWVsZCB0aGlzLmdldENsaWVudCgpLHI9eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZFBheXBhbENoZWNrb3V0KCksbz17Y2xpZW50Om59O3JldHVybiB0aGlzLnBheXBhbENoZWNrb3V0PXlpZWxkIHIuY3JlYXRlKG8sKG4scik9Pnt2YXIgbztpZihuKXJldHVybiBpKG4pO2NvbnN0IGE9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHtjdXJyZW5jeTplLmN1cnJlbmN5fSxlLmlzQ3JlZGl0RW5hYmxlZCYme1wiZW5hYmxlLWZ1bmRpbmdcIjpcInBheWxhdGVyXCJ9KSx7Y29tcG9uZW50czpFLnRvU3RyaW5nKCksaW50ZW50OmUuaW50ZW50LGNvbW1pdDpudWxsPT09KG89ZS5jb21taXQpfHx2b2lkIDA9PT1vfHxvfSk7dGhpcy5icmFpbnRyZWVIb3N0V2luZG93LnBheXBhbD90KHIpOnIubG9hZFBheVBhbFNESyhhLCgpPT50KHIpKX0pLHRoaXMucGF5cGFsQ2hlY2tvdXR9KX1nZXREYXRhQ29sbGVjdG9yKGUpe3JldHVybiBMKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PShudWxsPT1lP3ZvaWQgMDplLnBheXBhbCk/XCJwYXlwYWxcIjpcImRlZmF1bHRcIjtsZXQgaT10aGlzLmRhdGFDb2xsZWN0b3JzW3RdO2lmKCFpKXt0cnl7Y29uc3QgdD15aWVsZCB0aGlzLmdldENsaWVudCgpLG49eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZERhdGFDb2xsZWN0b3IoKSxyPU9iamVjdC5hc3NpZ24oe2NsaWVudDp0LGtvdW50OiEwfSxlKTtpPXlpZWxkIG4uY3JlYXRlKHIpfWNhdGNoKGUpe2lmKCFGKGUpfHxcIkRBVEFfQ09MTEVDVE9SX0tPVU5UX05PVF9FTkFCTEVEXCIhPT1lLmNvZGUpdGhyb3cgZTtpPXtkZXZpY2VEYXRhOnZvaWQgMCx0ZWFyZG93bjooKT0+UHJvbWlzZS5yZXNvbHZlKCl9fXRoaXMuZGF0YUNvbGxlY3RvcnNbdF09aX1yZXR1cm4gaX0pfWdldEJyYWludHJlZUVudihlPSExKXtyZXR1cm4gZT9fLlNhbmRib3g6Xy5Qcm9kdWN0aW9ufW1hcFRvQnJhaW50cmVlU2hpcHBpbmdBZGRyZXNzT3ZlcnJpZGUoZSl7cmV0dXJue3JlY2lwaWVudE5hbWU6YCR7ZS5maXJzdE5hbWV9ICR7ZS5sYXN0TmFtZX1gLGxpbmUxOmUuYWRkcmVzczEsbGluZTI6ZS5hZGRyZXNzMixjaXR5OmUuY2l0eSxzdGF0ZTplLnN0YXRlT3JQcm92aW5jZUNvZGUscG9zdGFsQ29kZTplLnBvc3RhbENvZGUsY291bnRyeUNvZGU6ZS5jb3VudHJ5Q29kZSxwaG9uZTplLnBob25lfX1tYXBUb0xlZ2FjeVNoaXBwaW5nQWRkcmVzcyhlKXtjb25zdHtlbWFpbDp0LHBob25lOmksc2hpcHBpbmdBZGRyZXNzOm59PWUscj0obnVsbD09bj92b2lkIDA6bi5yZWNpcGllbnROYW1lKXx8XCJcIixbbyxhXT1yLnNwbGl0KFwiIFwiKTtyZXR1cm57ZW1haWw6dCxmaXJzdF9uYW1lOm98fFwiXCIsbGFzdF9uYW1lOmF8fFwiXCIscGhvbmVfbnVtYmVyOmksYWRkcmVzc19saW5lXzE6bnVsbD09bj92b2lkIDA6bi5saW5lMSxhZGRyZXNzX2xpbmVfMjpudWxsPT1uP3ZvaWQgMDpuLmxpbmUyLGNpdHk6bnVsbD09bj92b2lkIDA6bi5jaXR5LHN0YXRlOm51bGw9PW4/dm9pZCAwOm4uc3RhdGUsY291bnRyeV9jb2RlOm51bGw9PW4/dm9pZCAwOm4uY291bnRyeUNvZGUscG9zdGFsX2NvZGU6bnVsbD09bj92b2lkIDA6bi5wb3N0YWxDb2RlfX1tYXBUb0xlZ2FjeUJpbGxpbmdBZGRyZXNzKGUpe2NvbnN0e2JpbGxpbmdBZGRyZXNzOnQsZW1haWw6aSxmaXJzdE5hbWU6bixsYXN0TmFtZTpyLHBob25lOm8sc2hpcHBpbmdBZGRyZXNzOmF9PWUscz10fHxhO3JldHVybntlbWFpbDppLGZpcnN0X25hbWU6bixsYXN0X25hbWU6cixwaG9uZV9udW1iZXI6byxhZGRyZXNzX2xpbmVfMTpudWxsPT1zP3ZvaWQgMDpzLmxpbmUxLGFkZHJlc3NfbGluZV8yOm51bGw9PXM/dm9pZCAwOnMubGluZTIsY2l0eTpudWxsPT1zP3ZvaWQgMDpzLmNpdHksc3RhdGU6bnVsbD09cz92b2lkIDA6cy5zdGF0ZSxjb3VudHJ5X2NvZGU6bnVsbD09cz92b2lkIDA6cy5jb3VudHJ5Q29kZSxwb3N0YWxfY29kZTpudWxsPT1zP3ZvaWQgMDpzLnBvc3RhbENvZGV9fXJlbW92ZUVsZW1lbnQoZSl7Y29uc3QgdD1lJiZkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlKTt0JiZ0LnJlbW92ZSgpfWdldFNlc3Npb25JZChlKXtyZXR1cm4gTCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7ZGV2aWNlRGF0YTp0fT15aWVsZCB0aGlzLmdldERhdGFDb2xsZWN0b3Ioe3Jpc2tDb3JyZWxhdGlvbklkOmV9KTtyZXR1cm4gdH0pfXRlYXJkb3duKCl7cmV0dXJuIEwodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMudGVhcmRvd25Nb2R1bGUodGhpcy5kYXRhQ29sbGVjdG9ycy5kZWZhdWx0KSx5aWVsZCB0aGlzLnRlYXJkb3duTW9kdWxlKHRoaXMuZGF0YUNvbGxlY3RvcnMucGF5cGFsKSx0aGlzLmRhdGFDb2xsZWN0b3JzPXt9LHlpZWxkIHRoaXMudGVhcmRvd25Nb2R1bGUodGhpcy5wYXlwYWxDaGVja291dCksdGhpcy5wYXlwYWxDaGVja291dD12b2lkIDB9KX1nZXQzRFMoKXtyZXR1cm4gTCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMudGhyZWVEU3x8KHRoaXMudGhyZWVEUz1Qcm9taXNlLmFsbChbdGhpcy5nZXRDbGllbnQoKSx0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkM0RTKCldKS50aGVuKChbZSx0XSk9PnQuY3JlYXRlKHtjbGllbnQ6ZSx2ZXJzaW9uOjJ9KSkpLHRoaXMudGhyZWVEU30pfWdldFZlbm1vQ2hlY2tvdXQoZSl7cmV0dXJuIEwodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLnZlbm1vQ2hlY2tvdXQpe2NvbnN0IHQ9eWllbGQgdGhpcy5nZXRDbGllbnQoKSxpPXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRWZW5tb0NoZWNrb3V0KCksbj1PYmplY3QuYXNzaWduKHtjbGllbnQ6dCxhbGxvd0Rlc2t0b3A6ITAscGF5bWVudE1ldGhvZFVzYWdlOlwibXVsdGlfdXNlXCJ9LGV8fHt9KTt0aGlzLnZlbm1vQ2hlY2tvdXQ9eWllbGQgbmV3IFByb21pc2UoKGUsdCk9PntpLmNyZWF0ZShuLChpLG4pPT5pP3QoaSk6bi5pc0Jyb3dzZXJTdXBwb3J0ZWQoKT92b2lkIGUobik6dChuZXcgYikpfSl9cmV0dXJuIHRoaXMudmVubW9DaGVja291dH0pfXZlcmlmeUNhcmQoZSx0LGkpe3JldHVybiBMKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBuPXlpZWxkIHRoaXMudG9rZW5pemVDYXJkKGUsdCk7cmV0dXJuIHRoaXMuY2hhbGxlbmdlM0RTVmVyaWZpY2F0aW9uKG4saSl9KX10b2tlbml6ZUNhcmQoZSx0KXtyZXR1cm4gTCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cGF5bWVudERhdGE6aX09ZTtpZighZnVuY3Rpb24oZSl7aWYoXCJvYmplY3RcIiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiExO2NvbnN0IHQ9ZTtyZXR1cm5cIm9iamVjdFwiPT10eXBlb2YgdC5jY0V4cGlyeSYmbnVsbCE9PXQuY2NFeHBpcnkmJlwic3RyaW5nXCI9PXR5cGVvZiB0LmNjTnVtYmVyJiZcInN0cmluZ1wiPT10eXBlb2YgdC5jY05hbWV9KGkpKXRocm93IG5ldyBDKFtcInBheW1lbnQucGF5bWVudERhdGFcIl0pO2NvbnN0IHI9dGhpcy5nZXRFcnJvcnNSZXF1aXJlZEZpZWxkcyhpKTtpZighbihyKSl0aHJvdyBuZXcgUyhyKTtjb25zdCBvPXRoaXMubWFwVG9DcmVkaXRDYXJkKGksdCksYT15aWVsZCB0aGlzLmdldENsaWVudCgpLHtjcmVkaXRDYXJkczpzfT15aWVsZCBhLnJlcXVlc3Qobyk7cmV0dXJue25vbmNlOnNbMF0ubm9uY2UsYmluOnNbMF0uZGV0YWlscy5iaW59fSl9Y2hhbGxlbmdlM0RTVmVyaWZpY2F0aW9uKGUsdCl7cmV0dXJuIEwodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9eWllbGQgdGhpcy5nZXQzRFMoKTtyZXR1cm4gdGhpcy5wcmVzZW50M0RTQ2hhbGxlbmdlKGksdCxlKX0pfXRlYXJkb3duTW9kdWxlKGUpe3JldHVybiBlP2UudGVhcmRvd24oKTpQcm9taXNlLnJlc29sdmUoKX1nZXRDbGllbnRUb2tlbk9yVGhyb3coKXtpZighdGhpcy5jbGllbnRUb2tlbil0aHJvdyBuZXcgSShQLlBheW1lbnROb3RJbml0aWFsaXplZCk7cmV0dXJuIHRoaXMuY2xpZW50VG9rZW59Z2V0RXJyb3JzUmVxdWlyZWRGaWVsZHMoZSl7Y29uc3R7Y2NOdW1iZXI6dCxjY0V4cGlyeTppfT1lLG49e307cmV0dXJuIHR8fChuLmNjTnVtYmVyPVt7bWVzc2FnZTpcIkNyZWRpdCBjYXJkIG51bWJlciBpcyByZXF1aXJlZFwiLHR5cGU6XCJyZXF1aXJlZFwifV0pLGl8fChuLmNjRXhwaXJ5PVt7bWVzc2FnZTpcIkV4cGlyYXRpb24gZGF0ZSBpcyByZXF1aXJlZFwiLHR5cGU6XCJyZXF1aXJlZFwifV0pLG59bWFwVG9DcmVkaXRDYXJkKGUsdCl7cmV0dXJue2RhdGE6e2NyZWRpdENhcmQ6e2NhcmRob2xkZXJOYW1lOmUuY2NOYW1lLG51bWJlcjplLmNjTnVtYmVyLGN2djplLmNjQ3Z2LGV4cGlyYXRpb25EYXRlOmAke2UuY2NFeHBpcnkubW9udGh9LyR7ZS5jY0V4cGlyeS55ZWFyfWAsb3B0aW9uczp7dmFsaWRhdGU6ITF9LGJpbGxpbmdBZGRyZXNzOnQmJntjb3VudHJ5Q29kZUFscGhhMjp0LmNvdW50cnlDb2RlLGxvY2FsaXR5OnQuY2l0eSxjb3VudHJ5TmFtZTp0LmNvdW50cnkscG9zdGFsQ29kZTp0LnBvc3RhbENvZGUsc3RyZWV0QWRkcmVzczp0LmFkZHJlc3MyP2Ake3QuYWRkcmVzczF9ICR7dC5hZGRyZXNzMn1gOnQuYWRkcmVzczF9fX0sZW5kcG9pbnQ6XCJwYXltZW50X21ldGhvZHMvY3JlZGl0X2NhcmRzXCIsbWV0aG9kOlwicG9zdFwifX1wcmVzZW50M0RTQ2hhbGxlbmdlKGUsdCxpKXtjb25zdHtub25jZTpuLGJpbjpyfT1pO2lmKCF0aGlzLnRocmVlRFNlY3VyZU9wdGlvbnN8fCFuKXRocm93IG5ldyBJKFAuUGF5bWVudE5vdEluaXRpYWxpemVkKTtjb25zdHthZGRGcmFtZTpvLHJlbW92ZUZyYW1lOmEsY2hhbGxlbmdlUmVxdWVzdGVkOnM9ITAsYWRkaXRpb25hbEluZm9ybWF0aW9uOmR9PXRoaXMudGhyZWVEU2VjdXJlT3B0aW9ucyxsPSgpPT5MKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXlpZWxkIGUuY2FuY2VsVmVyaWZ5Q2FyZCgpO3JldHVybiB1LmNhbmNlbChuZXcgTyksdH0pLGM9dC50b0ZpeGVkKDIpLHU9bmV3IGsoZS52ZXJpZnlDYXJkKHthZGRGcmFtZTooZSx0KT0+e28mJm8oZSx0LGwpfSxhbW91bnQ6TnVtYmVyKGMpLGJpbjpyLGNoYWxsZW5nZVJlcXVlc3RlZDpzLG5vbmNlOm4scmVtb3ZlRnJhbWU6YSxvbkxvb2t1cENvbXBsZXRlOihlLHQpPT57dCgpfSxjb2xsZWN0RGV2aWNlRGF0YTohMCxhZGRpdGlvbmFsSW5mb3JtYXRpb246ZH0pKTtyZXR1cm4gdS5wcm9taXNlfX1jbGFzcyBqIGV4dGVuZHMgZntjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIGNsaWVudCBsaWJyYXJ5IG9mIGEgcGF5bWVudCBtZXRob2QgaXMgbm90IGxvYWRlZCBvciByZWFkeSB0byBiZSB1c2VkLlwiKSx0aGlzLm5hbWU9XCJQYXltZW50TWV0aG9kQ2xpZW50VW5hdmFpbGFibGVFcnJvclwiLHRoaXMudHlwZT1cInBheW1lbnRfbWV0aG9kX2NsaWVudF91bmF2YWlsYWJsZVwifX1jb25zdCBVPXtbZ106e1tCLkNsaWVudF06XCJzaGEzODQtMjZCWERObkpJMjNKWVJ5RkJqNHhlNHNWTnJVU1NpU1N1MTFreFZYTk0vdkVQT05tNEx1TDAwdzZaYVRnUWV3dFwiLFtCLlBheXBhbENoZWNrb3V0XTpcInNoYTM4NC1CK3Z6Ylp3blF0eldCdGhwa1Q0VFhLVWliTzY1dHllSzdlQ3hTdnBibGdwclRlcDIrSUFYQjJDeHhqcm43MTBPXCIsW0IuUGF5cGFsXTpcInNoYTM4NC11eUFHTDEvMytYSkFIbkdvTnk0ZUNvWGR6SjRmN0lsenArNnc5UE5uRWpzNkRDQ3o5V015SmpNTjFnemM3OFUrXCIsW0IuTG9jYWxQYXltZW50XTpcInNoYTM4NC1MSXZPRU1rSVZFd1Z1WUJkVk9RYzFBQzVZYkdHbHd5ZlVoZVMwQUNLMjE4RDJTVHVWWVFsWjRGeUVQb3dBRWZUXCIsW0IuRGF0YUNvbGxlY3Rvcl06XCJzaGEzODQtMWJvOUpEeitLc2N0aGMwODVjQ0tXdXI4Q0x3VW9CcG9OeXhzRGk3OTMybUNsMHpGcTNBNW12K0ZRTHc5R0hwVlwiLFtCLlVzQmFua0FjY291bnRdOlwic2hhMzg0LXhtSEJWYVUrdzc0VitPZWJEM0FhUE9ORnhIVUdNZitRUnM4Ry9KeFZQWE5OUDdNRGEyakwwSUNXSEllMnRUZkpcIixbQi5Hb29nbGVQYXltZW50XTpcInNoYTM4NC1XS0RKbDhtcW9QODJxWnBNR0g2QWJaeG52WG5TVzhJTFY0TTY0Q3lNTGl1Z0dNd3U3THlQODl3akNrSHFzaUJlXCIsW0IuVGhyZWVEU2VjdXJlXTpcInNoYTM4NC1WUVVscEdIenNHdnM1WGVpR0ZpcDdFWFJzdm9IV0VYRFZtZ0NhY2ZieWllWkk5bWRCT3FxM05Tb3lvMjhPQ09CXCIsW0IuVmlzYUNoZWNrb3V0XTpcInNoYTM4NC15eDdtQURmelROMFQ0M1E2cmxINDlMSWcxRUowaVVaZ0JwL0Vjelg5TFhzVUdreVNneHJEK25XSFFSQmt5Zm9UXCIsW0IuVmVubW9dOlwic2hhMzg0LVFYNHJQam9qMVpEaHVHMGFTeUtzNTZsRUtEcVRNVGNqWXhVSFkxU3pPNVZaRHNxSUUyTlRrcW90N0tOU0N5b3ZcIixbQi5Ib3N0ZWRGaWVsZHNdOlwic2hhMzg0LVZ2WUJBQ2ZTdTBDci9KMzJ1S214RzdBWGNOT0pFMUF6SUlMM2tiaWt5UzdZS3A1Zno1SXMrTnpOUC9seWF1TnlcIixbQi5GYXN0bGFuZV06XCJzaGEzODQtOW9Hc1pNUlp3cEd0REVEWWEvZEZ0NzZkRUNxajF4QW5pOWdJS2djM0tmTUlpUm5SNzNuRWVlVURMaUJ6eGhGYVwifSxbcF06e1tCLkNsaWVudF06XCJzaGEzODQtbytuYlFHY3dOTnhJQmVYZXUzK1htYlNxK0NnOFIzRU4zTjBsNWhYQ2dNTVUyUkdZMHQxejBMcm9TRUlBYmZBT1wiLFtCLlBheXBhbENoZWNrb3V0XTpcInNoYTM4NC1XcmZiV1BCUzRtSDg2R0FveWNQU2dpSDhoUThLSDdBNjdDOTNIamh1bnYveGhOazJZcEJuM3diRkE0RmhnOVUvXCIsW0IuUGF5cGFsXTpcInNoYTM4NC1WRjM4OW52dnJSVWdEc1RYTXhUWU9SRHRWZWdCOUlRYTNDeHIvL0R5Sm5MWW56OC9YOFZDekV2Y2syYytNZWd0XCIsW0IuTG9jYWxQYXltZW50XTpcInNoYTM4NC10Wkt4MnJFUWJmbVpwb1BTWTVWUG1KRWhhcTRYNzVkTHZ3SE1zM1ZFOVUrQzhsUHl3K2hXVElMMStHUHZXQ0lIXCIsW0IuRGF0YUNvbGxlY3Rvcl06XCJzaGEzODQtRTZrM3dPcFA3c3lDRER3YVJETEYwNjk0MlkwME5rYndKdldpMk9RWHd3S3pHd0c1ZmQzRTdSRlV2Q0NlY2Z2T1wiLFtCLlVzQmFua0FjY291bnRdOlwic2hhMzg0LTI1OEZPTjhMWkdHMFc5UWF6NEppajgzcFpIdTMwWW5LakpBN2dOdWxMQmg2Q2Nsa3VjZ0YrdEhEUXVZRlJZZldcIixbQi5Hb29nbGVQYXltZW50XTpcInNoYTM4NC10YUoycC8wK24wVkgzMjhQT0FvQml1RWJMM3RuSFVURTlTNDJoSzFWK1R4czNYK1FZalpPeUtXMzVKZ0hSRmZPXCIsW0IuVGhyZWVEU2VjdXJlXTpcInNoYTM4NC0rTlNaSDRaajNzTzViZFd2UEtoVTVOMTZRRHhldWVUVlRuVVZlbGVlRVNraExTYXo0T2IxaGgvNW15ZWNjOVltXCIsW0IuVmlzYUNoZWNrb3V0XTpcInNoYTM4NC02NkRpQmpnaHhrMU9tQmo4YWtzTjhnYlErQ3dvUWN4MXZQZmlYVU4wOGcxaVFWTStCd2V3RjBwN3RvTTNpN1NTXCIsW0IuVmVubW9dOlwic2hhMzg0LUI1VXdZNDJrRTRSb0xvV2JRN1lwcW9zVWxVYWQyL0RsR1dpdzBIaG9aYlNQazMwQ1FBYVNBMTBvaHlMRFRrRFVcIixbQi5Ib3N0ZWRGaWVsZHNdOlwic2hhMzg0LUF3OUVlc1NhVWVXeGUzNlBxRUhpT3lPeU9xOE02Q0liMWd3Ny95SE5WUFJ6R3RGWFhjZDJPUThxWHJJbE9qMlBcIixbQi5GYXN0bGFuZV06XCJzaGEzODQtcmhCTDFocFo3MUpxRysyVHNUMERpaDQ3bWJqeDhjakpDcGVaams5dHczZGYxZ0ZNS2ZDVG1NeVp1bmhyN0g0WVwifSxbbV06e1tCLkNsaWVudF06XCJzaGEzODQtMFdOeGtzSXBSUCtmWVppSWRyMTJnNkRCVVFmTER6WUNRSlp0Ui9DOEtrY3dTR2hQSGZjRnAzdFRhR2NNeUZUcVwiLFtCLlBheXBhbENoZWNrb3V0XTpcInNoYTM4NC1sV00xams0Qk94b0ROVjZLb3A3dFZOdlFnSU5sbUVWejBjL093TStITkhLM1FDOHhxd2Q1NE92cnQyUVJEVGpoXCIsW0IuUGF5cGFsXTpcInNoYTM4NC1mWFVtVnhDMkVNWkJEWFo3ZVRIU1RML0xGQnJIZWovTVNYVC92VEJYdnJhNGx6Z0xOR3ZSRUFwK3gwR1lPYnVIXCIsW0IuTG9jYWxQYXltZW50XTpcInNoYTM4NC1waGExeEd1R1NrbVpINXg5YXFIdlJhTzR4TGVhN3JtUS83OVBGajl6eE56eHVGY09XWmc3Z09QN0ZpYnlnT0VDXCIsW0IuRGF0YUNvbGxlY3Rvcl06XCJzaGEzODQtUTZQSTJGOWVla1diQXhocm95YmwrYUVjdnFoZG93Ti9FUWxHd0JVeUpPelBGbjk5ODJ1OXhsNlNVNlhmR0t6Y1wiLFtCLlVzQmFua0FjY291bnRdOlwic2hhMzg0LVczUkxRU0tKTDF0UTMrWTdtUDZ0bWthbXRaOGJWNFl3L1h4TDlKajVKdFhIcmFEOGxvTUY4aEFJRzVtMnpLN0ZcIixbQi5Hb29nbGVQYXltZW50XTpcInNoYTM4NC1USVRRTXNGV0EzZWxETkdQMm1XejJvS0JvNHFqdCtUbHF6b3ZjYVBvZUJpQWgvd1BCaTZuYWU1MEFEZGdVMS9pXCIsW0IuVGhyZWVEU2VjdXJlXTpcInNoYTM4NC1ZaXljWU44OVpsTC9FdmNhcTR5MWFqVzFtaGQ3SllmWkJEdU93SHRJbjQvSm5tMjBHTCsvWENNK3pZQXdXRDhEXCIsW0IuVmlzYUNoZWNrb3V0XTpcInNoYTM4NC0vT2RhVHY5cXJrS3pqT2J0VWU2eXpmRGhIb3pGVy8rdVhsclNsNzM2c09aUkpwakdRRVR2cFlYcU1GRmc2OXh2XCIsW0IuVmVubW9dOlwic2hhMzg0LWRBK29qZFc5dmJKUzRKYXZjWHlPczlkNXVaSEpnNWROdFl1cG9QU0gyenNYSWlZRFZTNWFtTGIvdThxbVE2b3pcIixbQi5Ib3N0ZWRGaWVsZHNdOlwic2hhMzg0LTMxWmtTNTgraWFXc1cwNmZ0VzUyenpWWkZwNDNXUGQ3cE5ZUmlkZFl5blNOZzZPaDdXR2JTRkdvckFVSDZUMXpcIixbQi5GYXN0bGFuZV06XCJzaGEzODQtamxicndOdkwzSHZMQVVDdExTbXJuUTJHSDF1ZENVclJTL2JWbVJlQVM1ZnVJVnZjVzhQa28vR2tnODJ0bGd0clwifX07dmFyIFIsSD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBXe2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnNjcmlwdExvYWRlcj1lLHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdz10LHRoaXMuYnJhaW50cmVlU0RLVmVyc2lvbk1hbmFnZXI9aX1sb2FkQ2xpZW50KCl7cmV0dXJuIEgodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KEIuQ2xpZW50LFwiY2xpZW50Lm1pbi5qc1wiKX0pfWxvYWRGYXN0bGFuZSgpe3JldHVybiBIKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyhCLkZhc3RsYW5lLFwiZmFzdGxhbmUubWluLmpzXCIpfSl9bG9hZFBheXBhbENoZWNrb3V0KCl7cmV0dXJuIEgodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KEIuUGF5cGFsQ2hlY2tvdXQsXCJwYXlwYWwtY2hlY2tvdXQubWluLmpzXCIpfSl9bG9hZFBheXBhbCgpe3JldHVybiBIKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyhCLlBheXBhbCxcInBheXBhbC5taW4uanNcIil9KX1sb2FkTG9jYWxQYXltZW50KCl7cmV0dXJuIEgodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KEIuTG9jYWxQYXltZW50LFwibG9jYWwtcGF5bWVudC5taW4uanNcIil9KX1sb2FkRGF0YUNvbGxlY3Rvcigpe3JldHVybiBIKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyhCLkRhdGFDb2xsZWN0b3IsXCJkYXRhLWNvbGxlY3Rvci5taW4uanNcIil9KX1sb2FkVXNCYW5rQWNjb3VudCgpe3JldHVybiBIKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyhCLlVzQmFua0FjY291bnQsXCJ1cy1iYW5rLWFjY291bnQubWluLmpzXCIpfSl9bG9hZEdvb2dsZVBheW1lbnQoKXtyZXR1cm4gSCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coQi5Hb29nbGVQYXltZW50LFwiZ29vZ2xlLXBheW1lbnQubWluLmpzXCIpfSl9bG9hZDNEUygpe3JldHVybiBIKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyhCLlRocmVlRFNlY3VyZSxcInRocmVlLWQtc2VjdXJlLm1pbi5qc1wiKX0pfWxvYWRWaXNhQ2hlY2tvdXQoKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyhCLlZpc2FDaGVja291dCxcInZpc2EtY2hlY2tvdXQubWluLmpzXCIpfWxvYWRWZW5tb0NoZWNrb3V0KCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coQi5WZW5tbyxcInZlbm1vLm1pbi5qc1wiKX1sb2FkSG9zdGVkRmllbGRzKCl7cmV0dXJuIEgodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KEIuSG9zdGVkRmllbGRzLFwiaG9zdGVkLWZpZWxkcy5taW4uanNcIil9KX1sb2FkVmlzYUNoZWNrb3V0U2RrKGUpe3JldHVybiBIKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZih0aGlzLmJyYWludHJlZUhvc3RXaW5kb3cuVilyZXR1cm4gdGhpcy5icmFpbnRyZWVIb3N0V2luZG93LlY7Y29uc3QgdD1lP1wic2hhMzg0LTBldTFzMUd0cXpYbEw5RHRMZ213ekM1V1dsRUgvQURSTTBuMzhjVlFrdnRUK1cvZ2V5OTZyY2IxTHd1VU9QRG1cIjpcInNoYTM4NC0xZjFjc3ZQM1pGeGc0ZElMSDFHYVk0TEhsWjBvWDdSazgzcnhtTGx3Ym5JaTRUTTBOWXpYb2V2MVZvRWlWRFM2XCI7cmV0dXJuIHRoaXMuc2NyaXB0TG9hZGVyLmxvYWRTY3JpcHQoYC8vJHtlP1wic2FuZGJveC1cIjpcIlwifWFzc2V0cy5zZWN1cmUuY2hlY2tvdXQudmlzYS5jb20vY2hlY2tvdXQtd2lkZ2V0L3Jlc291cmNlcy9qcy9pbnRlZ3JhdGlvbi92MS9zZGsuanNgLHthc3luYzohMCxhdHRyaWJ1dGVzOntpbnRlZ3JpdHk6dCxjcm9zc29yaWdpbjpcImFub255bW91c1wifX0pLnRoZW4oKCk9PntpZighdGhpcy5icmFpbnRyZWVIb3N0V2luZG93LlYpdGhyb3cgbmV3IGo7cmV0dXJuIHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5WfSl9KX1sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyhlLHQpe3JldHVybiBIKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtsZXQgaT10aGlzLmdldEJyYWludHJlZU1vZHVsZShlKTtpZihpKXJldHVybiBpO2NvbnN0IG49dGhpcy5icmFpbnRyZWVTREtWZXJzaW9uTWFuYWdlci5nZXRTREtWZXJzaW9uKCkscj1gLy9qcy5icmFpbnRyZWVnYXRld2F5LmNvbS93ZWIvJHtufS9qcy8ke3R9YCxvPW4gaW4gVT90aGlzLmdldEludGVncml0eVZhbHVlc0J5TW9kdWxlTmFtZShlLG4pOnZvaWQgMDtpZih5aWVsZCB0aGlzLnNjcmlwdExvYWRlci5sb2FkU2NyaXB0KHIsbz97YXN5bmM6ITAsYXR0cmlidXRlczp7aW50ZWdyaXR5Om8sY3Jvc3NvcmlnaW46XCJhbm9ueW1vdXNcIn19OnZvaWQgMCksaT10aGlzLmdldEJyYWludHJlZU1vZHVsZShlKSwhaSl0aHJvdyBuZXcgajtyZXR1cm4gaX0pfWdldEJyYWludHJlZU1vZHVsZShlKXt2YXIgdDtyZXR1cm4gbnVsbD09PSh0PXRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5icmFpbnRyZWUpfHx2b2lkIDA9PT10P3ZvaWQgMDp0W2VdfWdldEludGVncml0eVZhbHVlc0J5TW9kdWxlTmFtZShlLHQpe2NvbnN0IGk9VVt0XVtlXTtpZighaSl0aHJvdyBuZXcgRXJyb3IoXCJVbmV4cGVjdGVkIGZpbGVOYW1lIHZhbHVlXCIpO3JldHVybiBpfX1mdW5jdGlvbiBxKGUsdCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oZSx7cmVzb2x2ZUlkczp0fSl9IWZ1bmN0aW9uKGUpe2VbZS5NaXNzaW5nQmlsbGluZ0FkZHJlc3M9MF09XCJNaXNzaW5nQmlsbGluZ0FkZHJlc3NcIixlW2UuTWlzc2luZ0NhcnQ9MV09XCJNaXNzaW5nQ2FydFwiLGVbZS5NaXNzaW5nQ2hlY2tvdXQ9Ml09XCJNaXNzaW5nQ2hlY2tvdXRcIixlW2UuTWlzc2luZ0NvbnNpZ25tZW50cz0zXT1cIk1pc3NpbmdDb25zaWdubWVudHNcIixlW2UuTWlzc2luZ0N1c3RvbWVyPTRdPVwiTWlzc2luZ0N1c3RvbWVyXCIsZVtlLk1pc3NpbmdDaGVja291dENvbmZpZz01XT1cIk1pc3NpbmdDaGVja291dENvbmZpZ1wiLGVbZS5NaXNzaW5nT3JkZXI9Nl09XCJNaXNzaW5nT3JkZXJcIixlW2UuTWlzc2luZ09yZGVyQ29uZmlnPTddPVwiTWlzc2luZ09yZGVyQ29uZmlnXCIsZVtlLk1pc3NpbmdPcmRlcklkPThdPVwiTWlzc2luZ09yZGVySWRcIixlW2UuTWlzc2luZ1BheW1lbnQ9OV09XCJNaXNzaW5nUGF5bWVudFwiLGVbZS5NaXNzaW5nUGF5bWVudElkPTEwXT1cIk1pc3NpbmdQYXltZW50SWRcIixlW2UuTWlzc2luZ1BheW1lbnRJbnN0cnVtZW50PTExXT1cIk1pc3NpbmdQYXltZW50SW5zdHJ1bWVudFwiLGVbZS5NaXNzaW5nUGF5bWVudE1ldGhvZD0xMl09XCJNaXNzaW5nUGF5bWVudE1ldGhvZFwiLGVbZS5NaXNzaW5nUGF5bWVudFJlZGlyZWN0VXJsPTEzXT1cIk1pc3NpbmdQYXltZW50UmVkaXJlY3RVcmxcIixlW2UuTWlzc2luZ1BheW1lbnRTdGF0dXM9MTRdPVwiTWlzc2luZ1BheW1lbnRTdGF0dXNcIixlW2UuTWlzc2luZ1BheW1lbnRUb2tlbj0xNV09XCJNaXNzaW5nUGF5bWVudFRva2VuXCIsZVtlLk1pc3NpbmdTaGlwcGluZ0FkZHJlc3M9MTZdPVwiTWlzc2luZ1NoaXBwaW5nQWRkcmVzc1wifShSfHwoUj17fSkpO2NsYXNzICQgZXh0ZW5kcyBme2NvbnN0cnVjdG9yKGUpe3N1cGVyKGZ1bmN0aW9uKGUpe3N3aXRjaChlKXtjYXNlIFIuTWlzc2luZ0JpbGxpbmdBZGRyZXNzOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBiaWxsaW5nIGFkZHJlc3MgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIFIuTWlzc2luZ0NhcnQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGNhcnQgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIFIuTWlzc2luZ0NvbnNpZ25tZW50czpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgY29uc2lnbm1lbnRzIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBSLk1pc3NpbmdDaGVja291dDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgY2hlY2tvdXQgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIFIuTWlzc2luZ0N1c3RvbWVyOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBjdXN0b21lciBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgUi5NaXNzaW5nQ2hlY2tvdXRDb25maWc6Y2FzZSBSLk1pc3NpbmdPcmRlckNvbmZpZzpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgY29uZmlndXJhdGlvbiBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgUi5NaXNzaW5nT3JkZXI6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIG9yZGVyIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBSLk1pc3NpbmdPcmRlcklkOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBvcmRlciBJRCBpcyB1bmF2YWlsYWJsZSBvciBub3QgZ2VuZXJhdGVkIHlldC5cIjtjYXNlIFIuTWlzc2luZ1BheW1lbnQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHBheW1lbnQgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIFIuTWlzc2luZ1BheW1lbnRUb2tlbjpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHRva2VuIHJlcXVpcmVkIHRvIHN1Ym1pdCBhIHBheW1lbnQgaXMgbWlzc2luZy5cIjtjYXNlIFIuTWlzc2luZ1BheW1lbnRNZXRob2Q6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHBheW1lbnQgbWV0aG9kIGRhdGEgaXMgdW5hdmFpbGFibGUgb3Igbm90IHByb3Blcmx5IGNvbmZpZ3VyZWQuXCI7Y2FzZSBSLk1pc3NpbmdTaGlwcGluZ0FkZHJlc3M6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHNoaXBwaW5nIGFkZHJlc3MgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtkZWZhdWx0OnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgcmVxdWlyZWQgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIn19KGUpKSx0aGlzLnN1YnR5cGU9ZSx0aGlzLm5hbWU9XCJNaXNzaW5nRGF0YUVycm9yXCIsdGhpcy50eXBlPVwibWlzc2luZ19kYXRhXCJ9fXZhciBHPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIFl7Y29uc3RydWN0b3IoZSx0LGksbil7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5mb3JtUG9zdGVyPXQsdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2U9aSx0aGlzLmJyYWludHJlZUhvc3RXaW5kb3c9bn1pbml0aWFsaXplKGUpe3JldHVybiBHKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWVwYXlwYWw6dCxtZXRob2RJZDppfT1lLHtjb250YWluZXI6bixvbkVycm9yOnJ9PXR8fHt9O2lmKCFpKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCF0KXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXBheXBhbFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighbil0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVwYXlwYWwuY29udGFpbmVyXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2xldCBvLGE9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCk7dHJ5e2lmKG89YS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSwhby5jbGllbnRUb2tlbil0aHJvdyBuZXcgJChSLk1pc3NpbmdQYXltZW50VG9rZW4pfWNhdGNoKGUpe2E9eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKGkpLG89YS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKX1jb25zdHtjbGllbnRUb2tlbjpzLGNvbmZpZzpkLGluaXRpYWxpemF0aW9uRGF0YTpsfT1vLHtwYXltZW50QnV0dG9uU3R5bGVzOmN9PWx8fHt9LHtjaGVja291dFRvcEJ1dHRvblN0eWxlczp1fT1jfHx7fTtpZighc3x8IWwpdGhyb3cgbmV3ICQoUi5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3QgaD17Y3VycmVuY3k6YS5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGUsaW50ZW50OmwuaW50ZW50LGlzQ3JlZGl0RW5hYmxlZDpsLmlzQ3JlZGl0RW5hYmxlZCxjb21taXQ6ITF9O3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmluaXRpYWxpemUocykseWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5cGFsQ2hlY2tvdXQoaCxlPT57dGhpcy5yZW5kZXJQYXlQYWxCdXR0b24oZSx0LGksQm9vbGVhbihkLnRlc3RNb2RlKSx1KX0sZT0+dGhpcy5oYW5kbGVFcnJvcihlLG4scikpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIEcodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRlYXJkb3duKCl9KX1zaWduSW4oZSx0KXtyZXR1cm4gRyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25JbkN1c3RvbWVyKGUsdCl9KX1zaWduT3V0KGUpe3JldHVybiBHKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbk91dEN1c3RvbWVyKGUpfSl9ZXhlY3V0ZVBheW1lbnRNZXRob2RDaGVja291dChlKXt2YXIgdDtyZXR1cm4gbnVsbD09PSh0PW51bGw9PWU/dm9pZCAwOmUuY29udGludWVXaXRoQ2hlY2tvdXRDYWxsYmFjayl8fHZvaWQgMD09PXR8fHQuY2FsbChlKSxQcm9taXNlLnJlc29sdmUoKX1yZW5kZXJQYXlQYWxCdXR0b24oZSx0LGksbixyKXtjb25zdHtjb250YWluZXI6byxvbkNsaWNrOnM9YX09dCx7cGF5cGFsOmR9PXRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdyxsPW51bGw9PWQ/dm9pZCAwOmQuRlVORElORy5QQVlQQUw7aWYoZCYmbCl7Y29uc3QgYT1kLkJ1dHRvbnMoe2Vudjp0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRCcmFpbnRyZWVFbnYobiksZnVuZGluZ1NvdXJjZTpsLHN0eWxlOk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7aGVpZ2h0OjQwfSksY3JlYXRlT3JkZXI6KCk9PnRoaXMuc2V0dXBQYXltZW50KGUsdCxpKSxvbkFwcHJvdmU6bj0+dGhpcy50b2tlbml6ZVBheW1lbnQobixlLGksdCksb25DbGljazpzfSk7YS5pc0VsaWdpYmxlKCkmJmEucmVuZGVyKGAjJHtvfWApfWVsc2UgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UucmVtb3ZlRWxlbWVudChvKX1zZXR1cFBheW1lbnQoZSx0LGkpe3ZhciBuO3JldHVybiBHKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWREZWZhdWx0Q2hlY2tvdXQoKTtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHI9dC5nZXRDaGVja291dE9yVGhyb3coKS5vdXRzdGFuZGluZ0JhbGFuY2Usbz10LmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZSxhPXQuZ2V0Q3VzdG9tZXIoKSxzPXQuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSksZD1udWxsPT1hP3ZvaWQgMDphLmFkZHJlc3Nlc1swXSxsPWQ/dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UubWFwVG9CcmFpbnRyZWVTaGlwcGluZ0FkZHJlc3NPdmVycmlkZShkKTp2b2lkIDA7cmV0dXJuIHlpZWxkIGUuY3JlYXRlUGF5bWVudCh7ZmxvdzpcImNoZWNrb3V0XCIsZW5hYmxlU2hpcHBpbmdBZGRyZXNzOiEwLHNoaXBwaW5nQWRkcmVzc0VkaXRhYmxlOiExLHNoaXBwaW5nQWRkcmVzc092ZXJyaWRlOmwsYW1vdW50OnIsY3VycmVuY3k6byxvZmZlckNyZWRpdDohMSxpbnRlbnQ6bnVsbD09PShuPXMuaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09bj92b2lkIDA6bi5pbnRlbnR9KX1jYXRjaChlKXtjb25zdHtjb250YWluZXI6aSxvbkVycm9yOm59PXQ7dGhpcy5oYW5kbGVFcnJvcihlLGksbil9fSl9dG9rZW5pemVQYXltZW50KGUsdCxpLG4pe3JldHVybiBHKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7Y29uc3R7ZGV2aWNlRGF0YTpufT15aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXREYXRhQ29sbGVjdG9yKHtwYXlwYWw6ITB9KSxyPXlpZWxkIHQudG9rZW5pemVQYXltZW50KGUpLHtkZXRhaWxzOm8sbm9uY2U6YX09cixzPXRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvTGVnYWN5QmlsbGluZ0FkZHJlc3MobyksZD10aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5tYXBUb0xlZ2FjeVNoaXBwaW5nQWRkcmVzcyhvKTtyZXR1cm4gdGhpcy5mb3JtUG9zdGVyLnBvc3RGb3JtKFwiL2NoZWNrb3V0LnBocFwiLHtwYXltZW50X3R5cGU6XCJwYXlwYWxcIixwcm92aWRlcjppLGFjdGlvbjpcInNldF9leHRlcm5hbF9jaGVja291dFwiLG5vbmNlOmEsZGV2aWNlX2RhdGE6bixiaWxsaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkocyksc2hpcHBpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeShkKX0pLHJ9Y2F0Y2goZSl7Y29uc3R7Y29udGFpbmVyOnQsb25FcnJvcjppfT1uO3RoaXMuaGFuZGxlRXJyb3IoZSx0LGkpfX0pfWhhbmRsZUVycm9yKGUsdCxpKXtpZih0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KHQpLCFpfHwhRihlKSl0aHJvdyBlO2koZSl9fWNvbnN0IEo9cShpPT57Y29uc3Qgbj13aW5kb3cscj1uZXcgdihpKSxvPW5ldyBWKG5ldyBXKHQoKSxuLHIpLG4pO3JldHVybiBuZXcgWShpLGUoKSxvLG4pfSxbe2lkOlwiYnJhaW50cmVlcGF5cGFsXCJ9XSk7dmFyIEs9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgWHtjb25zdHJ1Y3RvcihlLHQsaSxuKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmZvcm1Qb3N0ZXI9dCx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT1pLHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdz1ufWluaXRpYWxpemUoZSl7cmV0dXJuIEsodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2JyYWludHJlZXBheXBhbGNyZWRpdDp0LG1ldGhvZElkOml9PWUse2NvbnRhaW5lcjpuLG9uRXJyb3I6cn09dHx8e307aWYoIWkpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVlcGF5cGFsY3JlZGl0XCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXBheXBhbGNyZWRpdC5jb250YWluZXJcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7bGV0IG8sYT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTt0cnl7aWYobz1hLmdldFBheW1lbnRNZXRob2RPclRocm93KGkpLCFvLmNsaWVudFRva2VuKXRocm93IG5ldyAkKFIuTWlzc2luZ1BheW1lbnRUb2tlbil9Y2F0Y2goZSl7YT15aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSksbz1hLmdldFBheW1lbnRNZXRob2RPclRocm93KGkpfWNvbnN0e2NsaWVudFRva2VuOnMsY29uZmlnOmQsaW5pdGlhbGl6YXRpb25EYXRhOmx9PW8se3BheW1lbnRCdXR0b25TdHlsZXM6Y309bHx8e30se2NoZWNrb3V0VG9wQnV0dG9uU3R5bGVzOnV9PWN8fHt9O2lmKCFzfHwhbCl0aHJvdyBuZXcgJChSLk1pc3NpbmdQYXltZW50TWV0aG9kKTtjb25zdCBoPXtjdXJyZW5jeTphLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZSxpbnRlbnQ6bC5pbnRlbnQsaXNDcmVkaXRFbmFibGVkOmwuaXNDcmVkaXRFbmFibGVkLGNvbW1pdDohMX07dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuaW5pdGlhbGl6ZShzKSx5aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRQYXlwYWxDaGVja291dChoLGU9Pnt0aGlzLnJlbmRlclBheVBhbEJ1dHRvbihlLHQsaSxCb29sZWFuKGQudGVzdE1vZGUpLE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx1KSx7aGVpZ2h0OjQwfSkpfSxlPT50aGlzLmhhbmRsZUVycm9yKGUsbixyKSl9KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gSyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudGVhcmRvd24oKX0pfXNpZ25JbihlLHQpe3JldHVybiBLKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbkluQ3VzdG9tZXIoZSx0KX0pfXNpZ25PdXQoZSl7cmV0dXJuIEsodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zaWduT3V0Q3VzdG9tZXIoZSl9KX1leGVjdXRlUGF5bWVudE1ldGhvZENoZWNrb3V0KGUpe3ZhciB0O3JldHVybiBudWxsPT09KHQ9bnVsbD09ZT92b2lkIDA6ZS5jb250aW51ZVdpdGhDaGVja291dENhbGxiYWNrKXx8dm9pZCAwPT09dHx8dC5jYWxsKGUpLFByb21pc2UucmVzb2x2ZSgpfXJlbmRlclBheVBhbEJ1dHRvbihlLHQsaSxuLHIpe2NvbnN0e2NvbnRhaW5lcjpvLG9uQ2xpY2s6cz1hfT10LHtwYXlwYWw6ZH09dGhpcy5icmFpbnRyZWVIb3N0V2luZG93O2xldCBsPSExO2QmJltkLkZVTkRJTkcuUEFZTEFURVIsZC5GVU5ESU5HLkNSRURJVF0uZm9yRWFjaChhPT57aWYoIWwpe2NvbnN0IGM9ZC5CdXR0b25zKHtlbnY6bj9cInNhbmRib3hcIjpcInByb2R1Y3Rpb25cIixmdW5kaW5nU291cmNlOmEsc3R5bGU6cixjcmVhdGVPcmRlcjooKT0+dGhpcy5zZXR1cFBheW1lbnQoZSx0LGkpLG9uQXBwcm92ZTpuPT50aGlzLnRva2VuaXplUGF5bWVudChuLGUsaSx0KSxvbkNsaWNrOnN9KTtjLmlzRWxpZ2libGUoKSYmKGMucmVuZGVyKGAjJHtvfWApLGw9ITApfX0pLGQmJmx8fHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQobyl9c2V0dXBQYXltZW50KGUsdCxpKXt2YXIgbjtyZXR1cm4gSyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCk7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPXQuZ2V0Q2hlY2tvdXRPclRocm93KCkub3V0c3RhbmRpbmdCYWxhbmNlLG89dC5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGUsYT10LmdldEN1c3RvbWVyKCkscz10LmdldFBheW1lbnRNZXRob2RPclRocm93KGkpLGQ9bnVsbD09YT92b2lkIDA6YS5hZGRyZXNzZXNbMF0sbD1kP3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvQnJhaW50cmVlU2hpcHBpbmdBZGRyZXNzT3ZlcnJpZGUoZCk6dm9pZCAwO3JldHVybiB5aWVsZCBlLmNyZWF0ZVBheW1lbnQoe2Zsb3c6XCJjaGVja291dFwiLGVuYWJsZVNoaXBwaW5nQWRkcmVzczohMCxzaGlwcGluZ0FkZHJlc3NFZGl0YWJsZTohMSxzaGlwcGluZ0FkZHJlc3NPdmVycmlkZTpsLGFtb3VudDpyLGN1cnJlbmN5Om8sb2ZmZXJDcmVkaXQ6ITAsaW50ZW50Om51bGw9PT0obj1zLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PW4/dm9pZCAwOm4uaW50ZW50fSl9Y2F0Y2goZSl7Y29uc3R7Y29udGFpbmVyOmksb25FcnJvcjpufT10O3RoaXMuaGFuZGxlRXJyb3IoZSxpLG4pfX0pfXRva2VuaXplUGF5bWVudChlLHQsaSxuKXtyZXR1cm4gSyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e2NvbnN0e2RldmljZURhdGE6bn09eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0RGF0YUNvbGxlY3Rvcih7cGF5cGFsOiEwfSkscj15aWVsZCB0LnRva2VuaXplUGF5bWVudChlKSx7ZGV0YWlsczpvLG5vbmNlOmF9PXIscz10aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5tYXBUb0xlZ2FjeUJpbGxpbmdBZGRyZXNzKG8pLGQ9dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UubWFwVG9MZWdhY3lTaGlwcGluZ0FkZHJlc3Mobyk7cmV0dXJuIHRoaXMuZm9ybVBvc3Rlci5wb3N0Rm9ybShcIi9jaGVja291dC5waHBcIix7cGF5bWVudF90eXBlOlwicGF5cGFsXCIscHJvdmlkZXI6aSxhY3Rpb246XCJzZXRfZXh0ZXJuYWxfY2hlY2tvdXRcIixub25jZTphLGRldmljZV9kYXRhOm4sYmlsbGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KHMpLHNoaXBwaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkoZCl9KSxyfWNhdGNoKGUpe2NvbnN0e2NvbnRhaW5lcjp0LG9uRXJyb3I6aX09bjt0aGlzLmhhbmRsZUVycm9yKGUsdCxpKX19KX1oYW5kbGVFcnJvcihlLHQsaSl7aWYodGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UucmVtb3ZlRWxlbWVudCh0KSwhaXx8IUYoZSkpdGhyb3cgZTtpKGUpfX1jb25zdCBRPXEoaT0+e2NvbnN0IG49d2luZG93LHI9bmV3IHYoaSksbz1uZXcgVihuZXcgVyh0KCksbixyKSxuKTtyZXR1cm4gbmV3IFgoaSxlKCksbyxuKX0sW3tpZDpcImJyYWludHJlZXBheXBhbGNyZWRpdFwifV0pO2Z1bmN0aW9uIFooZSl7cmV0dXJuXCJzdHJpbmdcIiE9dHlwZW9mIGV9ZnVuY3Rpb24gZWUoZSx0KXtpZih0fHxlKXJldHVybiBmdW5jdGlvbihlKXt2YXIgdCxpO2NvbnN0IG49e30scj1kKGUucm9vdCxaKSxvPWQoZS5pbnB1dCxaKSxhPWQoZS50b2dnbGUsWikscz1kKG51bGw9PT0odD1lLnRleHQpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmJvZHksWiksbD1kKG51bGw9PT0oaT1lLnRleHQpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmNhcHRpb24sWiksYz1lLmJyYW5kaW5nO3JldHVybiBPYmplY3Qua2V5cyhyKS5sZW5ndGgmJihuLnJvb3Q9ciksT2JqZWN0LmtleXMobykubGVuZ3RoJiYobi5pbnB1dD1vKSxPYmplY3Qua2V5cyhhKS5sZW5ndGgmJihuLnRvZ2dsZT1hKSxPYmplY3Qua2V5cyhzKS5sZW5ndGgmJihuLnRleHQ9e30sbi50ZXh0LmJvZHk9cyksT2JqZWN0LmtleXMobCkubGVuZ3RoJiYobi50ZXh0PU9iamVjdC5hc3NpZ24oe30sbi50ZXh0KSxuLnRleHQuY2FwdGlvbj1sKSxjJiYobi5icmFuZGluZz1jKSxufShmdW5jdGlvbihlLHQpe3ZhciBpLG4scixvLGEscyxkLGwsYyx1LGgseSxtLHAsZyx2LGYsYix3LEMsUyxQO3JldHVybntyb290OntiYWNrZ3JvdW5kQ29sb3JQcmltYXJ5OihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lUm9vdFNldHRpbmdzQmFja2dyb3VuZENvbG9yKXx8KG51bGw9PT0oaT1udWxsPT10P3ZvaWQgMDp0LnJvb3QpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmJhY2tncm91bmRDb2xvclByaW1hcnkpLGVycm9yQ29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVSb290U2V0dGluZ3NFcnJvckNvbG9yKXx8KG51bGw9PT0obj1udWxsPT10P3ZvaWQgMDp0LnJvb3QpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmVycm9yQ29sb3IpLGZvbnRGYW1pbHk6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVSb290U2V0dGluZ3NGb250RmFtaWx5KXx8KG51bGw9PT0ocj1udWxsPT10P3ZvaWQgMDp0LnJvb3QpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLmZvbnRGYW1pbHkpLGZvbnRTaXplQmFzZToobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVJvb3RTZXR0aW5nc0ZvbnRTaXplKXx8KG51bGw9PT0obz1udWxsPT10P3ZvaWQgMDp0LnJvb3QpfHx2b2lkIDA9PT1vP3ZvaWQgMDpvLmZvbnRTaXplQmFzZSkscGFkZGluZzoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVJvb3RTZXR0aW5nc1BhZGRpbmcpfHwobnVsbD09PShhPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PWE/dm9pZCAwOmEucGFkZGluZykscHJpbWFyeUNvbG9yOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lUm9vdFNldHRpbmdzUHJpbWFyeUNvbG9yKXx8KG51bGw9PT0ocz1udWxsPT10P3ZvaWQgMDp0LnJvb3QpfHx2b2lkIDA9PT1zP3ZvaWQgMDpzLnByaW1hcnlDb2xvcil9LGlucHV0Ontib3JkZXJSYWRpdXM6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVJbnB1dFNldHRpbmdzQm9yZGVyUmFkaXVzKXx8KG51bGw9PT0oZD1udWxsPT10P3ZvaWQgMDp0LmlucHV0KXx8dm9pZCAwPT09ZD92b2lkIDA6ZC5ib3JkZXJSYWRpdXMpLGJvcmRlckNvbG9yOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lSW5wdXRTZXR0aW5nc0JvcmRlckNvbG9yKXx8KG51bGw9PT0obD1udWxsPT10P3ZvaWQgMDp0LmlucHV0KXx8dm9pZCAwPT09bD92b2lkIDA6bC5ib3JkZXJDb2xvciksZm9jdXNCb3JkZXJDb2xvcjoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUlucHV0U2V0dGluZ3NGb2N1c0JvcmRlckJhc2UpfHwobnVsbD09PShjPW51bGw9PXQ/dm9pZCAwOnQuaW5wdXQpfHx2b2lkIDA9PT1jP3ZvaWQgMDpjLmZvY3VzQm9yZGVyQ29sb3IpLGJhY2tncm91bmRDb2xvcjoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUlucHV0U2V0dGluZ3NCYWNrZ3JvdW5kQ29sb3IpfHwobnVsbD09PSh1PW51bGw9PXQ/dm9pZCAwOnQuaW5wdXQpfHx2b2lkIDA9PT11P3ZvaWQgMDp1LmJhY2tncm91bmRDb2xvciksYm9yZGVyV2lkdGg6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVJbnB1dFNldHRpbmdzQm9yZGVyV2lkdGgpfHwobnVsbD09PShoPW51bGw9PXQ/dm9pZCAwOnQuaW5wdXQpfHx2b2lkIDA9PT1oP3ZvaWQgMDpoLmJvcmRlcldpZHRoKSx0ZXh0Q29sb3JCYXNlOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lSW5wdXRTZXR0aW5nc1RleHRDb2xvckJhc2UpfHwobnVsbD09PSh5PW51bGw9PXQ/dm9pZCAwOnQuaW5wdXQpfHx2b2lkIDA9PT15P3ZvaWQgMDp5LnRleHRDb2xvckJhc2UpfSx0b2dnbGU6e2NvbG9yUHJpbWFyeToobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVRvZ2dsZVNldHRpbmdzQ29sb3JQcmltYXJ5KXx8KG51bGw9PT0obT1udWxsPT10P3ZvaWQgMDp0LnRvZ2dsZSl8fHZvaWQgMD09PW0/dm9pZCAwOm0uY29sb3JQcmltYXJ5KSxjb2xvclNlY29uZGFyeToobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVRvZ2dsZVNldHRpbmdzQ29sb3JTZWNvbmRhcnkpfHwobnVsbD09PShwPW51bGw9PXQ/dm9pZCAwOnQudG9nZ2xlKXx8dm9pZCAwPT09cD92b2lkIDA6cC5jb2xvclNlY29uZGFyeSl9LHRleHQ6e2JvZHk6e2NvbG9yOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lVGV4dEJvZHlTZXR0aW5nc0NvbG9yKXx8KG51bGw9PT0odj1udWxsPT09KGc9bnVsbD09dD92b2lkIDA6dC50ZXh0KXx8dm9pZCAwPT09Zz92b2lkIDA6Zy5ib2R5KXx8dm9pZCAwPT09dj92b2lkIDA6di5jb2xvciksZm9udFNpemU6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVUZXh0Qm9keVNldHRpbmdzRm9udFNpemUpfHwobnVsbD09PShiPW51bGw9PT0oZj1udWxsPT10P3ZvaWQgMDp0LnRleHQpfHx2b2lkIDA9PT1mP3ZvaWQgMDpmLmJvZHkpfHx2b2lkIDA9PT1iP3ZvaWQgMDpiLmZvbnRTaXplKX0sY2FwdGlvbjp7Y29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVUZXh0Q2FwdGlvblNldHRpbmdzQ29sb3IpfHwobnVsbD09PShDPW51bGw9PT0odz1udWxsPT10P3ZvaWQgMDp0LnRleHQpfHx2b2lkIDA9PT13P3ZvaWQgMDp3LmNhcHRpb24pfHx2b2lkIDA9PT1DP3ZvaWQgMDpDLmNvbG9yKSxmb250U2l6ZToobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVRleHRDYXB0aW9uU2V0dGluZ3NGb250U2l6ZSl8fChudWxsPT09KFA9bnVsbD09PShTPW51bGw9PXQ/dm9pZCAwOnQudGV4dCl8fHZvaWQgMD09PVM/dm9pZCAwOlMuY2FwdGlvbil8fHZvaWQgMD09PVA/dm9pZCAwOlAuZm9udFNpemUpfX0sYnJhbmRpbmc6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVCcmFuZGluZ1NldHRpbmdzKXx8KG51bGw9PXQ/dm9pZCAwOnQuYnJhbmRpbmcpfX0oZSx0KSl9dmFyIHRlLGllLG5lLHJlLG9lLGFlLHNlLGRlLGxlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIGNle2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVGYXN0bGFuZVV0aWxzPXQsdGhpcy5pc0FjY2VsZXJhdGVkQ2hlY2tvdXRFbmFibGVkPSExfWluaXRpYWxpemUoe21ldGhvZElkOmUsYnJhaW50cmVlZmFzdGxhbmU6dH0pe3ZhciBpO3JldHVybiBsZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIWUpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgXCJtZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtjb25zdCBuPXlpZWxkIHRoaXMuZ2V0VmFsaWRQYXltZW50TWV0aG9kT3JUaHJvdyhlKSx7aXNBY2NlbGVyYXRlZENoZWNrb3V0RW5hYmxlZDpyLGlzRmFzdGxhbmVTdHlsaW5nRW5hYmxlZDpvfT1uLmluaXRpYWxpemF0aW9uRGF0YXx8e30sYT1vP251bGw9PT0oaT1uLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PWk/dm9pZCAwOmkuZmFzdGxhbmVTdHlsZXM6dm9pZCAwO3RoaXMuaXNBY2NlbGVyYXRlZENoZWNrb3V0RW5hYmxlZD0hIXI7dHJ5e2lmKHRoaXMuaXNBY2NlbGVyYXRlZENoZWNrb3V0RW5hYmxlZCl7Y29uc3QgZT1lZShhLG51bGw9PXQ/dm9pZCAwOnQuc3R5bGVzKTt5aWVsZCB0aGlzLmJyYWludHJlZUZhc3RsYW5lVXRpbHMuaW5pdGlhbGl6ZUJyYWludHJlZUZhc3RsYW5lT3JUaHJvdyhuLmlkLGUpfX1jYXRjaChlKXt9cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIGxlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9KX1zaWduSW4oZSx0KXtyZXR1cm4gbGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zaWduSW5DdXN0b21lcihlLHQpfSl9c2lnbk91dChlKXtyZXR1cm4gbGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zaWduT3V0Q3VzdG9tZXIoZSl9KX1leGVjdXRlUGF5bWVudE1ldGhvZENoZWNrb3V0KGUpe3JldHVybiBsZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7Y2hlY2tvdXRQYXltZW50TWV0aG9kRXhlY3V0ZWQ6dCxjb250aW51ZVdpdGhDaGVja291dENhbGxiYWNrOml9PWV8fHt9O2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIGkpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgXCJjb250aW51ZVdpdGhDaGVja291dENhbGxiYWNrXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkIGFuZCBpdCBtdXN0IGJlIGEgZnVuY3Rpb24uJyk7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDdXN0b21lck9yVGhyb3coKTtpZih0aGlzLmlzQWNjZWxlcmF0ZWRDaGVja291dEVuYWJsZWQmJm4uaXNHdWVzdCl7Y29uc3QgZT15aWVsZCB0aGlzLnNob3VsZFJ1bkF1dGhlbnRpY2F0aW9uRmxvdygpO3QmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQmJnQoKSxlJiYoeWllbGQgdGhpcy5icmFpbnRyZWVGYXN0bGFuZVV0aWxzLnJ1blBheVBhbEF1dGhlbnRpY2F0aW9uRmxvd09yVGhyb3codm9pZCAwLCEwKSl9aSgpfSl9c2hvdWxkUnVuQXV0aGVudGljYXRpb25GbG93KCl7dmFyIGU7cmV0dXJuIGxlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PVwiYnJhaW50cmVlYWNjZWxlcmF0ZWRjaGVja291dFwiO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QodCk7Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyh0KTtyZXR1cm4obnVsbD09PShlPWkuaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5zaG91bGRSdW5BY2NlbGVyYXRlZENoZWNrb3V0KXx8ITF9Y2F0Y2goZSl7cmV0dXJuITF9fSl9Z2V0VmFsaWRQYXltZW50TWV0aG9kT3JUaHJvdyhlKXtyZXR1cm4gbGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2xldCB0PWU7dHJ5e3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZCh0KX1jYXRjaChpKXt0PVwiYnJhaW50cmVlXCI9PT1lP1wiYnJhaW50cmVlYWNjZWxlcmF0ZWRjaGVja291dFwiOlwiYnJhaW50cmVlXCIseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKHQpfXJldHVybiB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyh0KX0pfX0hZnVuY3Rpb24oZSl7ZS5FU1RJTUFURUQ9XCJFU1RJTUFURURcIixlLkZJTkFMPVwiRklOQUxcIixlLk5PVF9DVVJSRU5UTFlfS05PV049XCJOT1RfQ1VSUkVOVExZX0tOT1dOXCJ9KHRlfHwodGU9e30pKSxmdW5jdGlvbihlKXtlLkNvbXBsZXRlZD1cIkNPTVBMRVRFRFwiLGUuUGVuZGluZz1cIlBFTkRJTkdcIixlLkZhaWxlZD1cIkZBSUxFRFwifShpZXx8KGllPXt9KSksZnVuY3Rpb24oZSl7ZS5UUlVTVExZPVwidHJ1c3RseVwifShuZXx8KG5lPXt9KSksZnVuY3Rpb24oZSl7ZS5TVUNDRUVERUQ9XCJzdWNjZWVkZWRcIixlLkZBSUxFRD1cImZhaWxlZFwiLGUuQ0FOQ0VMRUQ9XCJjYW5jZWxsZWRcIixlLlVOUkVDT0dOSVpFRD1cInVucmVjb2duaXplZFwifShyZXx8KHJlPXt9KSksZnVuY3Rpb24oZSl7ZS5DdXN0b21lcj1cIkNVU1RPTUVSXCIsZS5NZXJjaGFudD1cIk1FUkNIQU5UXCIsZS5OZXR3b3JrPVwiTkVUV09SS1wiLGUuSW50ZXJuYWw9XCJJTlRFUk5BTFwiLGUuVW5rbm93bj1cIlVOS05PV05cIn0ob2V8fChvZT17fSkpLGZ1bmN0aW9uKGUpe2UuS291bnROb3RFbmFibGVkPVwiREFUQV9DT0xMRUNUT1JfS09VTlRfTk9UX0VOQUJMRURcIn0oYWV8fChhZT17fSkpLGZ1bmN0aW9uKGUpe2UuVmlzYT1cInZpc2FcIixlLk1hc3RlcmNhcmQ9XCJtYXN0ZXJjYXJkXCIsZS5BbWVyaWNhbkV4cHJlc3M9XCJhbWVyaWNhbi1leHByZXNzXCIsZS5EaW5lcnNDbHViPVwiZGluZXJzLWNsdWJcIixlLkRpc2NvdmVyPVwiZGlzY292ZXJcIixlLkpjYj1cImpjYlwiLGUuVW5pb25QYXk9XCJ1bmlvbi1wYXlcIixlLk1hZXN0cm89XCJtYWVzdHJvXCIsZS5FbG89XCJlbG9cIixlLk1pcj1cIm1pclwiLGUuSGlwZXI9XCJoaXBlclwiLGUuSGlwZXJjYXJkPVwiaGlwZXJjYXJkXCJ9KHNlfHwoc2U9e30pKSxmdW5jdGlvbihlKXtlLkNWVj1cImN2dlwiLGUuUEFOPVwicGFuXCJ9KGRlfHwoZGU9e30pKTtjbGFzcyB1ZXtzdGF0aWMgZ2V0KGUpe2NvbnN0IHQ9YCR7ZW5jb2RlVVJJQ29tcG9uZW50KGAke2V9YCl9PWAsaT1kb2N1bWVudC5jb29raWU7bGV0IG49bnVsbDtjb25zdCByPWkuaW5kZXhPZih0KTtpZihyPi0xKXtsZXQgZT1pLmluZGV4T2YoXCI7XCIscik7LTE9PT1lJiYoZT1pLmxlbmd0aCksbj1kZWNvZGVVUklDb21wb25lbnQoaS5zdWJzdHJpbmcocit0Lmxlbmd0aCxlKSl9cmV0dXJuIG59c3RhdGljIHNldChlLHQsaT17c2VjdXJlOiEwfSl7bGV0IG49YCR7ZW5jb2RlVVJJQ29tcG9uZW50KGUpfT0ke2VuY29kZVVSSUNvbXBvbmVudCh0KX1gO2NvbnN0e2V4cGlyZXM6cixwYXRoOm8sZG9tYWluOmEsc2VjdXJlOnN9PWk7aWYociluKz1gOyBleHBpcmVzPSR7ci50b1VUQ1N0cmluZygpfWA7ZWxzZXtjb25zdCBlPW5ldyBEYXRlLHQ9NjA7ZS5zZXRUaW1lKGUuZ2V0VGltZSgpKzYwKnQqMWUzKSxuKz1gOyBleHBpcmVzPSR7ZS50b1VUQ1N0cmluZygpfWB9byYmKG4rPWA7IHBhdGg9JHtvfWApLGEmJihuKz1gOyBkb21haW49JHthfWApLHMmJihuKz1cIjsgc2VjdXJlXCIpLGRvY3VtZW50LmNvb2tpZT1ufXN0YXRpYyByZW1vdmUoZSx0KXt1ZS5zZXQoZSxcIlwiLE9iamVjdC5hc3NpZ24oe2V4cGlyZXM6bmV3IERhdGUoMCl9LHQpKX19dmFyIGhlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIHlle2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2U9dH1nZXREZXZpY2VTZXNzaW9uSWQoKXtyZXR1cm4gaGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGU9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydCgpO3JldHVybiB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRTZXNzaW9uSWQobnVsbD09ZT92b2lkIDA6ZS5pZCl9KX1pbml0aWFsaXplQnJhaW50cmVlRmFzdGxhbmVPclRocm93KGUsdCl7cmV0dXJuIGhlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG49aS5nZXRDYXJ0KCkse2NsaWVudFRva2VuOnIsY29uZmlnOm99PWkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSk7aWYoIXIpdGhyb3cgbmV3ICQoUi5NaXNzaW5nUGF5bWVudE1ldGhvZCk7dGhpcy5tZXRob2RJZD1lLHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmluaXRpYWxpemUociksdGhpcy5icmFpbnRyZWVGYXN0bGFuZT15aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRCcmFpbnRyZWVGYXN0bGFuZShudWxsPT1uP3ZvaWQgMDpuLmlkLG8udGVzdE1vZGUsdCl9KX1nZXRCcmFpbnRyZWVGYXN0bGFuZU9yVGhyb3coKXtpZighdGhpcy5icmFpbnRyZWVGYXN0bGFuZSl0aHJvdyBuZXcgajtyZXR1cm4gdGhpcy5icmFpbnRyZWVGYXN0bGFuZX1nZXRCcmFpbnRyZWVGYXN0bGFuZUNvbXBvbmVudE9yVGhyb3coKXtyZXR1cm4gdGhpcy5nZXRCcmFpbnRyZWVGYXN0bGFuZU9yVGhyb3coKS5GYXN0bGFuZUNhcmRDb21wb25lbnR9cnVuUGF5UGFsQXV0aGVudGljYXRpb25GbG93T3JUaHJvdyhlLHQpe3ZhciBpO3JldHVybiBoZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e2NvbnN0IG49dGhpcy5nZXRNZXRob2RJZE9yVGhyb3coKSxyPXRoaXMuZ2V0QnJhaW50cmVlRmFzdGxhbmVPclRocm93KCkse2xvb2t1cEN1c3RvbWVyQnlFbWFpbDpvLHRyaWdnZXJBdXRoZW50aWNhdGlvbkZsb3c6YX09ci5pZGVudGl0eSxzPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLGQ9cy5nZXRDYXJ0T3JUaHJvdygpLGw9cy5nZXRDdXN0b21lcigpLGM9cy5nZXRCaWxsaW5nQWRkcmVzcygpLHtpc0Zhc3RsYW5lU2hpcHBpbmdPcHRpb25BdXRvU2VsZWN0RW5hYmxlZDp1fT1zLmdldFBheW1lbnRNZXRob2RPclRocm93KG4pLmluaXRpYWxpemF0aW9uRGF0YXx8e30saD1lfHwobnVsbD09bD92b2lkIDA6bC5lbWFpbCl8fChudWxsPT1jP3ZvaWQgMDpjLmVtYWlsKXx8XCJcIix7Y3VzdG9tZXJDb250ZXh0SWQ6eX09eWllbGQgbyhoKTtpZigheSlyZXR1cm4geWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVBheW1lbnRQcm92aWRlckN1c3RvbWVyKHthdXRoZW50aWNhdGlvblN0YXRlOnJlLlVOUkVDT0dOSVpFRCxhZGRyZXNzZXM6W10saW5zdHJ1bWVudHM6W119KSx2b2lkIHRoaXMuc2F2ZVNlc3Npb25JZFRvQ29va2llcyhkLmlkKTtjb25zdHthdXRoZW50aWNhdGlvblN0YXRlOm0scHJvZmlsZURhdGE6cH09eWllbGQgYSh5KSxnPShudWxsPT09KGk9bnVsbD09cD92b2lkIDA6cC5zaGlwcGluZ0FkZHJlc3MpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLnBob25lTnVtYmVyKXx8XCJcIjtpZihtPT09cmUuQ0FOQ0VMRUQpcmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVQYXltZW50UHJvdmlkZXJDdXN0b21lcih7YXV0aGVudGljYXRpb25TdGF0ZTptLGFkZHJlc3NlczpbXSxpbnN0cnVtZW50czpbXX0pLHZvaWQgdGhpcy5yZW1vdmVTZXNzaW9uSWRGcm9tQ29va2llcygpO2NvbnN0IHY9dGhpcy5tYXBQYXlQYWxUb0JjQWRkcmVzcyhbcC5zaGlwcGluZ0FkZHJlc3NdLFtnXSl8fFtdLGY9dGhpcy5nZXRQYXlQYWxCaWxsaW5nQWRkcmVzc2VzKHApLGI9Zj90aGlzLm1hcFBheVBhbFRvQmNBZGRyZXNzKFtmXSxbZ10pOltdLHc9cC5jYXJkP3RoaXMubWFwUGF5UGFsVG9CY0luc3RydW1lbnQobixbcC5jYXJkXSk6W10sQz10aGlzLm1lcmdlU2hpcHBpbmdBbmRCaWxsaW5nQWRkcmVzc2VzKHYsYik7aWYodGhpcy5zYXZlU2Vzc2lvbklkVG9Db29raWVzKGQuaWQpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVQYXltZW50UHJvdmlkZXJDdXN0b21lcih7YXV0aGVudGljYXRpb25TdGF0ZTptLGFkZHJlc3NlczpDLGluc3RydW1lbnRzOnd9KSxiLmxlbmd0aD4wJiZkLmxpbmVJdGVtcy5waHlzaWNhbEl0ZW1zLmxlbmd0aD4wJiYoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZUJpbGxpbmdBZGRyZXNzKGJbMF0pKSxiLmxlbmd0aD4wJiZkLmxpbmVJdGVtcy5kaWdpdGFsSXRlbXMubGVuZ3RoPjAmJjA9PT1kLmxpbmVJdGVtcy5waHlzaWNhbEl0ZW1zLmxlbmd0aCl7Y29uc3R7Zmlyc3ROYW1lOmUsbGFzdE5hbWU6dH09Q1swXSxpPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxiWzBdKSx7Zmlyc3ROYW1lOmUsbGFzdE5hbWU6dH0pO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVCaWxsaW5nQWRkcmVzcyhpKX12Lmxlbmd0aD4wJiZkLmxpbmVJdGVtcy5waHlzaWNhbEl0ZW1zLmxlbmd0aD4wJiYoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVNoaXBwaW5nQWRkcmVzcyh2WzBdKSx0JiZ1JiYoeWllbGQgdGhpcy5zZXRTaGlwcGluZ09wdGlvbigpKSl9Y2F0Y2goZSl7fX0pfWdldFNlc3Npb25JZEZyb21Db29raWVzKCl7cmV0dXJuIHVlLmdldChcImJjLWZhc3RsYW5lLXNlc3Npb25JZFwiKXx8XCJcIn1zYXZlU2Vzc2lvbklkVG9Db29raWVzKGUpe2NvbnN0IHQ9bmV3IERhdGU7dC5zZXREYXRlKHQuZ2V0RGF0ZSgpKzE0KSx1ZS5zZXQoXCJiYy1mYXN0bGFuZS1zZXNzaW9uSWRcIixlLHtleHBpcmVzOnQsc2VjdXJlOiEwfSl9cmVtb3ZlU2Vzc2lvbklkRnJvbUNvb2tpZXMoKXt1ZS5yZW1vdmUoXCJiYy1mYXN0bGFuZS1zZXNzaW9uSWRcIil9bWFwUGF5UGFsVG9CY0luc3RydW1lbnQoZSx0KXtpZih0KXJldHVybiB0Lm1hcCh0PT57Y29uc3R7aWQ6aSxwYXltZW50U291cmNlOm59PXQse2JyYW5kOnIsZXhwaXJ5Om8sbGFzdERpZ2l0czphLGJpbkRldGFpbHM6c309bi5jYXJkLFtkLGxdPW8uc3BsaXQoXCItXCIpO3JldHVybntiaWdwYXlUb2tlbjppLGJyYW5kOnIsZGVmYXVsdEluc3RydW1lbnQ6ITEsZXhwaXJ5TW9udGg6bCxleHBpcnlZZWFyOmQsaWluOihudWxsPT1zP3ZvaWQgMDpzLmJpbil8fFwiXCIsbGFzdDQ6YSxtZXRob2Q6ZSxwcm92aWRlcjplLHRydXN0ZWRTaGlwcGluZ0FkZHJlc3M6ITEsdHlwZTpcImNhcmRcIix1bnRydXN0ZWRTaGlwcGluZ0NhcmRWZXJpZmljYXRpb25Nb2RlOmRlLlBBTn19KX1tYXBQYXlQYWxUb0JjQWRkcmVzcyhlLHQpe2lmKCFlKXJldHVybltdO2NvbnN0IGk9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q291bnRyaWVzKCl8fFtdLG49ZT0+e2NvbnN0IHQ9aS5maW5kKHQ9PnQuY29kZT09PWUpO3JldHVybihudWxsPT10P3ZvaWQgMDp0Lm5hbWUpfHxcIlwifTtyZXR1cm4gZS5tYXAoZT0+KHtpZDpEYXRlLm5vdygpLHR5cGU6XCJwYXlwYWwtYWRkcmVzc1wiLGZpcnN0TmFtZTplLmZpcnN0TmFtZXx8XCJcIixsYXN0TmFtZTplLmxhc3ROYW1lfHxcIlwiLGNvbXBhbnk6ZS5jb21wYW55fHxcIlwiLGFkZHJlc3MxOmUuc3RyZWV0QWRkcmVzcyxhZGRyZXNzMjplLmV4dGVuZGVkQWRkcmVzc3x8XCJcIixjaXR5OmUubG9jYWxpdHksc3RhdGVPclByb3ZpbmNlOmUucmVnaW9uLHN0YXRlT3JQcm92aW5jZUNvZGU6ZS5yZWdpb24sY291bnRyeTpuKGUuY291bnRyeUNvZGVBbHBoYTIpLGNvdW50cnlDb2RlOmUuY291bnRyeUNvZGVBbHBoYTIscG9zdGFsQ29kZTplLnBvc3RhbENvZGUscGhvbmU6dCYmdFswXXx8XCJcIixjdXN0b21GaWVsZHM6W119KSl9Z2V0UGF5UGFsQmlsbGluZ0FkZHJlc3NlcyhlKXtjb25zdHtjYXJkOnQsbmFtZTppfT1lfHx7fTtpZighdClyZXR1cm47Y29uc3R7Zmlyc3ROYW1lOm4sbGFzdE5hbWU6b309dC5wYXltZW50U291cmNlLmNhcmQuYmlsbGluZ0FkZHJlc3Mse2ZpcnN0TmFtZTphLGxhc3ROYW1lOnN9PWl8fHt9LHtzaGlwcGluZ0FkZHJlc3M6ZH09ZXx8e30sbD1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdC5wYXltZW50U291cmNlLmNhcmQuYmlsbGluZ0FkZHJlc3MpLHtmaXJzdE5hbWU6bnx8YSxsYXN0TmFtZTpvfHxzfSk7cmV0dXJuIGQmJnIodGhpcy5ub3JtYWxpemVBZGRyZXNzKGwpLHRoaXMubm9ybWFsaXplQWRkcmVzcyhkKSk/ZDpsfW5vcm1hbGl6ZUFkZHJlc3MoZSl7cmV0dXJuIHMoZSxbXCJpZFwiXSl9bWVyZ2VTaGlwcGluZ0FuZEJpbGxpbmdBZGRyZXNzZXMoZSx0KXtjb25zdCBpPXQuZmlsdGVyKHQ9PiFlLnNvbWUoZT0+cih0aGlzLm5vcm1hbGl6ZUFkZHJlc3MoZSksdGhpcy5ub3JtYWxpemVBZGRyZXNzKHQpKSkpO3JldHVyblsuLi5lLC4uLmldfWdldE1ldGhvZElkT3JUaHJvdygpe2lmKCF0aGlzLm1ldGhvZElkKXRocm93IG5ldyB3KCdVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIFwibWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7cmV0dXJuIHRoaXMubWV0aG9kSWR9c2V0U2hpcHBpbmdPcHRpb24oKXt2YXIgZTtyZXR1cm4gaGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q29uc2lnbm1lbnRzKCl8fFtdLGk9KG51bGw9PT0oZT10WzBdKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5hdmFpbGFibGVTaGlwcGluZ09wdGlvbnMpfHxbXSxuPWkuZmluZChlPT5lLmlzUmVjb21tZW5kZWQpO2lmKG58fGkubGVuZ3RoKXtjb25zdCBlPW58fGlbMF07eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNlbGVjdFNoaXBwaW5nT3B0aW9uKGUuaWQpfX0pfX1jb25zdCBtZT1xKGU9Pntjb25zdCBpPXdpbmRvdyxuPW5ldyB2KGUpLHI9bmV3IFYobmV3IFcodCgpLGksbiksaSksbz1uZXcgeWUoZSxyKTtyZXR1cm4gbmV3IGNlKGUsbyl9LFt7aWQ6XCJicmFpbnRyZWVhY2NlbGVyYXRlZGNoZWNrb3V0XCJ9LHtpZDpcImJyYWludHJlZVwifV0pO3ZhciBwZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBnZXtjb25zdHJ1Y3RvcihlKXt0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlcj1lfWluaXRpYWxpemUoZSl7dGhpcy5zZXRDbGllbnRUb2tlbihlKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gcGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMudGVhcmRvd25Nb2R1bGUodGhpcy5kYXRhQ29sbGVjdG9yKSx0aGlzLmRhdGFDb2xsZWN0b3I9dm9pZCAwfSl9Z2V0Q2xpZW50KCl7cmV0dXJuIHBlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5jbGllbnQpe2NvbnN0IGU9dGhpcy5nZXRDbGllbnRUb2tlbk9yVGhyb3coKSx0PXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRDbGllbnQoKTt0aGlzLmNsaWVudD15aWVsZCB0LmNyZWF0ZSh7YXV0aG9yaXphdGlvbjplfSl9cmV0dXJuIHRoaXMuY2xpZW50fSl9Z2V0RGF0YUNvbGxlY3Rvck9yVGhyb3coZSl7cmV0dXJuIHBlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXtkZXZpY2VEYXRhOnZvaWQgMCx0ZWFyZG93bjooKT0+UHJvbWlzZS5yZXNvbHZlKCl9O2lmKCF0aGlzLmRhdGFDb2xsZWN0b3IpdHJ5e2NvbnN0IHQ9eWllbGQgdGhpcy5nZXRDbGllbnQoKSxpPXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWREYXRhQ29sbGVjdG9yKCksbj1PYmplY3QuYXNzaWduKHtjbGllbnQ6dCxrb3VudDohMH0sZSk7dGhpcy5kYXRhQ29sbGVjdG9yPXlpZWxkIGkuY3JlYXRlKG4pfWNhdGNoKGUpe2lmKEYoZSkmJmUuY29kZT09PWFlLktvdW50Tm90RW5hYmxlZClyZXR1cm4gdDt0aHJvdyBlfXJldHVybiB0aGlzLmRhdGFDb2xsZWN0b3J9KX1nZXRCcmFpbnRyZWVHb29nbGVQYXltZW50KCl7cmV0dXJuIHBlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5nb29nbGVQYXltZW50KXtjb25zdFtlLHRdPXlpZWxkIFByb21pc2UuYWxsKFt0aGlzLmdldENsaWVudCgpLHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRHb29nbGVQYXltZW50KCldKTt0aGlzLmdvb2dsZVBheW1lbnQ9eWllbGQgdC5jcmVhdGUoe2NsaWVudDplfSl9cmV0dXJuIHRoaXMuZ29vZ2xlUGF5bWVudH0pfWdldEJyYWludHJlZVRocmVlRFMoKXtyZXR1cm4gcGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLnRocmVlRFMpe2NvbnN0W2UsdF09eWllbGQgUHJvbWlzZS5hbGwoW3RoaXMuZ2V0Q2xpZW50KCksdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZDNEUygpXSk7dGhpcy50aHJlZURTPXlpZWxkIHQuY3JlYXRlKHtjbGllbnQ6ZSx2ZXJzaW9uOjJ9KX1yZXR1cm4gdGhpcy50aHJlZURTfSl9Z2V0QnJhaW50cmVlTG9jYWxQYXltZW50KGUpe3JldHVybiBwZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuYnJhaW50cmVlTG9jYWxQYXltZW50KXtjb25zdFt0LGldPXlpZWxkIFByb21pc2UuYWxsKFt0aGlzLmdldENsaWVudCgpLHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRMb2NhbFBheW1lbnQoKV0pO3RoaXMuYnJhaW50cmVlTG9jYWxQYXltZW50PXlpZWxkIG5ldyBQcm9taXNlKChuLHIpPT57aS5jcmVhdGUoe2NsaWVudDp0LG1lcmNoYW50QWNjb3VudElkOmV9LChlLHQpPT57ZSYmcihlKSxuKHQpfSl9KX1yZXR1cm4gdGhpcy5icmFpbnRyZWVMb2NhbFBheW1lbnR9KX1nZXRVc0JhbmtBY2NvdW50KCl7cmV0dXJuIHBlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy51c0JhbmtBY2NvdW50KXtjb25zdCBlPXlpZWxkIHRoaXMuZ2V0Q2xpZW50KCksdD15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkVXNCYW5rQWNjb3VudCgpO3RoaXMudXNCYW5rQWNjb3VudD15aWVsZCB0LmNyZWF0ZSh7Y2xpZW50OmV9KX1yZXR1cm4gdGhpcy51c0JhbmtBY2NvdW50fSl9Z2V0QnJhaW50cmVlVmlzYUNoZWNrb3V0KCl7cmV0dXJuIHRoaXMudmlzYUNoZWNrb3V0fHwodGhpcy52aXNhQ2hlY2tvdXQ9UHJvbWlzZS5hbGwoW3RoaXMuZ2V0Q2xpZW50KCksdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZFZpc2FDaGVja291dCgpXSkudGhlbigoW2UsdF0pPT50LmNyZWF0ZSh7Y2xpZW50OmV9KSkpLHRoaXMudmlzYUNoZWNrb3V0fWdldFZpc2FDaGVja291dFNkayhlKXtyZXR1cm4gcGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLnZpc2FDaGVja291dFNES3x8KHRoaXMudmlzYUNoZWNrb3V0U0RLPXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRWaXNhQ2hlY2tvdXRTZGsoZSkpLHRoaXMudmlzYUNoZWNrb3V0U0RLfSl9Z2V0VmVubW9DaGVja291dE9yVGhyb3coKXtyZXR1cm4gcGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLmJyYWludHJlZVZlbm1vKXtjb25zdCBlPXlpZWxkIHRoaXMuZ2V0Q2xpZW50KCksdD15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkVmVubW9DaGVja291dCgpLGk9e2NsaWVudDplLGFsbG93RGVza3RvcDohMCxwYXltZW50TWV0aG9kVXNhZ2U6XCJtdWx0aV91c2VcIn0sbj15aWVsZCB0LmNyZWF0ZShpKTtpZighbi5pc0Jyb3dzZXJTdXBwb3J0ZWQoKSl0aHJvdyBuZXcgYjt0aGlzLmJyYWludHJlZVZlbm1vPW59cmV0dXJuIHRoaXMuYnJhaW50cmVlVmVubW99KX1zZXRDbGllbnRUb2tlbihlKXt0aGlzLmNsaWVudFRva2VuPWV9Z2V0Q2xpZW50VG9rZW5PclRocm93KCl7aWYoIXRoaXMuY2xpZW50VG9rZW4pdGhyb3cgbmV3IEkoUC5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO3JldHVybiB0aGlzLmNsaWVudFRva2VufXRlYXJkb3duTW9kdWxlKGUpe3JldHVybiBlP2UudGVhcmRvd24oKTpQcm9taXNlLnJlc29sdmUoKX19Y2xhc3MgdmUgZXh0ZW5kcyBme2NvbnN0cnVjdG9yKGUpe3N1cGVyKGV8fFwiTm90IGltcGxlbWVudGVkLlwiKSx0aGlzLm5hbWU9XCJOb3RJbXBsZW1lbnRlZEVycm9yXCIsdGhpcy50eXBlPVwibm90X2ltcGxlbWVudGVkXCJ9fXZhciBmZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBiZXtjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5mb3JtUG9zdGVyPXQsdGhpcy5icmFpbnRyZWVTZGs9aSx0aGlzLmJ1dHRvbkNsYXNzTmFtZT1cInZpc2EtY2hlY2tvdXQtd3JhcHBlclwiLHRoaXMub25FcnJvcj1hfWluaXRpYWxpemUoZSl7cmV0dXJuIGZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWV2aXNhY2hlY2tvdXQ6dCxtZXRob2RJZDppfT1lO2lmKCFpKXRocm93IG5ldyB3KCdVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIFwibWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXZpc2FjaGVja291dFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSk7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPW4uZ2V0Q2hlY2tvdXRPclRocm93KCkse2NsaWVudFRva2VuOm8sY29uZmlnOnN9PW4uZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSksZD1uLmdldFN0b3JlQ29uZmlnT3JUaHJvdygpO2lmKCFvKXRocm93IG5ldyAkKFIuTWlzc2luZ1BheW1lbnRNZXRob2QpO3RoaXMuYnJhaW50cmVlU2RrLmluaXRpYWxpemUobyk7Y29uc3QgbD15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXRCcmFpbnRyZWVWaXNhQ2hlY2tvdXQoKSxjPXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldFZpc2FDaGVja291dFNkayhzLnRlc3RNb2RlKSx7Y29udGFpbmVyOnUsb25FcnJvcjpofT10O3RoaXMub25FcnJvcj1ofHxhO2NvbnN0IHk9bC5jcmVhdGVJbml0T3B0aW9ucyh7cGF5bWVudFJlcXVlc3Q6e2N1cnJlbmN5Q29kZTpkLmN1cnJlbmN5LmNvZGUsc3VidG90YWw6U3RyaW5nKHIuc3VidG90YWwpfSxzZXR0aW5nczp7bG9jYWxlOmQuc3RvcmVQcm9maWxlLnN0b3JlTGFuZ3VhZ2Usc2hpcHBpbmc6e2NvbGxlY3RTaGlwcGluZzohMH19fSksbT10aGlzLmNyZWF0ZVNpZ25JbkJ1dHRvbih1LHRoaXMuYnV0dG9uQ2xhc3NOYW1lKTt5aWVsZCBjLmluaXQoeSksYy5vbihcInBheW1lbnQuc3VjY2Vzc1wiLGU9PnRoaXMudG9rZW5pemVQYXltZW50KGwsZSkudGhlbigoKT0+dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRDaGVja291dCgpKS5jYXRjaChlPT50aGlzLmhhbmRsZUVycm9yKGUpKSksYy5vbihcInBheW1lbnQuZXJyb3JcIiwoZSx0KT0+dGhpcy5oYW5kbGVFcnJvcih0KSksbS5zdHlsZS52aXNpYmlsaXR5PVwidmlzaWJsZVwifSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIGZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLmJyYWludHJlZVNkay5kZWluaXRpYWxpemUoKX0pfXNpZ25Jbigpe3Rocm93IG5ldyB2ZSgnSW4gb3JkZXIgdG8gc2lnbiBpbiB2aWEgVmlzYUNoZWNrb3V0LCB0aGUgc2hvcHBlciBtdXN0IGNsaWNrIG9uIFwiVmlzYSBDaGVja291dFwiIGJ1dHRvbi4nKX1zaWduT3V0KGUpe3JldHVybiBmZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zaWduT3V0Q3VzdG9tZXIoZSksUHJvbWlzZS5yZXNvbHZlKCl9KX1leGVjdXRlUGF5bWVudE1ldGhvZENoZWNrb3V0KGUpe3ZhciB0O3JldHVybiBudWxsPT09KHQ9bnVsbD09ZT92b2lkIDA6ZS5jb250aW51ZVdpdGhDaGVja291dENhbGxiYWNrKXx8dm9pZCAwPT09dHx8dC5jYWxsKGUpLFByb21pc2UucmVzb2x2ZSgpfXRva2VuaXplUGF5bWVudChlLHQpe3JldHVybiBmZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIFByb21pc2UuYWxsKFtlLnRva2VuaXplKHQpLHRoaXMuYnJhaW50cmVlU2RrLmdldERhdGFDb2xsZWN0b3JPclRocm93KCldKS50aGVuKChbZSx0XSk9Pntjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG49aS5nZXRTaGlwcGluZ0FkZHJlc3MoKSxyPWkuZ2V0QmlsbGluZ0FkZHJlc3MoKSx7c2hpcHBpbmdBZGRyZXNzOm89dGhpcy5tYXBUb1Zpc2FDaGVja291dEFkZHJlc3MobiksYmlsbGluZ0FkZHJlc3M6YT10aGlzLm1hcFRvVmlzYUNoZWNrb3V0QWRkcmVzcyhyKX09ZTtyZXR1cm4gdGhpcy5wb3N0Rm9ybShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3NoaXBwaW5nQWRkcmVzczpvLGJpbGxpbmdBZGRyZXNzOmF9KSx0KX0pfSl9cG9zdEZvcm0oZSx0KXtjb25zdHt1c2VyRGF0YTppLGJpbGxpbmdBZGRyZXNzOm4sc2hpcHBpbmdBZGRyZXNzOnIsZGV0YWlsczpvfT1lLHt1c2VyRW1haWw6YX09aSx7ZGV2aWNlRGF0YTpzfT10O3JldHVybiB0aGlzLmZvcm1Qb3N0ZXIucG9zdEZvcm0oXCIvY2hlY2tvdXQucGhwXCIse3BheW1lbnRfdHlwZTplLnR5cGUsbm9uY2U6ZS5ub25jZSxwcm92aWRlcjpcImJyYWludHJlZXZpc2FjaGVja291dFwiLGFjdGlvbjpcInNldF9leHRlcm5hbF9jaGVja291dFwiLGRldmljZV9kYXRhOnMsY2FyZF9pbmZvcm1hdGlvbjpKU09OLnN0cmluZ2lmeSh7dHlwZTpvLmNhcmRUeXBlLG51bWJlcjpvLmxhc3RUd299KSxiaWxsaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkodGhpcy5nZXRBZGRyZXNzKGEsbikpLHNoaXBwaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkodGhpcy5nZXRBZGRyZXNzKGEscikpfSl9bWFwVG9WaXNhQ2hlY2tvdXRBZGRyZXNzKGUpe3JldHVybiBlP3tmaXJzdE5hbWU6ZS5maXJzdE5hbWUsbGFzdE5hbWU6ZS5sYXN0TmFtZSxwaG9uZU51bWJlcjplLnBob25lLHN0cmVldEFkZHJlc3M6ZS5hZGRyZXNzMSxleHRlbmRlZEFkZHJlc3M6ZS5hZGRyZXNzMixsb2NhbGl0eTplLmNpdHkscmVnaW9uOmUuc3RhdGVPclByb3ZpbmNlQ29kZSxjb3VudHJ5Q29kZTplLmNvdW50cnlDb2RlLHBvc3RhbENvZGU6ZS5wb3N0YWxDb2RlfTp7fX1nZXRBZGRyZXNzKGUsdD17fSl7cmV0dXJue2VtYWlsOmUsZmlyc3RfbmFtZTp0LmZpcnN0TmFtZSxsYXN0X25hbWU6dC5sYXN0TmFtZSxwaG9uZV9udW1iZXI6dC5waG9uZU51bWJlcixhZGRyZXNzX2xpbmVfMTp0LnN0cmVldEFkZHJlc3MsYWRkcmVzc19saW5lXzI6dC5leHRlbmRlZEFkZHJlc3MsY2l0eTp0LmxvY2FsaXR5LHN0YXRlOnQucmVnaW9uLGNvdW50cnlfY29kZTp0LmNvdW50cnlDb2RlLHBvc3RhbF9jb2RlOnQucG9zdGFsQ29kZX19Y3JlYXRlU2lnbkluQnV0dG9uKGUsdCl7Y29uc3QgaT1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtlfWApO2lmKCFpKXRocm93IG5ldyBFcnJvcihcIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHByb3ZpZGVkIGNvbnRhaW5lciBJRCBpcyBub3QgdmFsaWQuXCIpO3JldHVybiB0aGlzLmluc2VydFZpc2FDaGVja291dEJ1dHRvbihpLHQpfWluc2VydFZpc2FDaGVja291dEJ1dHRvbihlLHQpe2NvbnN0IGk9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtyZXR1cm4gaS5zdHlsZS5kaXNwbGF5PVwiZmxleFwiLGkuc3R5bGUuZmxleERpcmVjdGlvbj1cImNvbHVtblwiLGkuc3R5bGUudmlzaWJpbGl0eT1cImhpZGRlblwiLGkuc3R5bGUud2lkdGg9XCJtYXgtY29udGVudFwiLGkuY2xhc3NOYW1lPXQsaS5pbm5lckhUTUw9J1xcbiAgICAgICAgICAgIDxpbWdcXG4gICAgICAgICAgICAgICAgYWx0PVwiVmlzYSBDaGVja291dFwiXFxuICAgICAgICAgICAgICAgIGNsYXNzPVwidi1idXR0b25cIlxcbiAgICAgICAgICAgICAgICByb2xlPVwiYnV0dG9uXCJcXG4gICAgICAgICAgICAgICAgc3JjPVwiaHR0cHM6Ly9zZWN1cmUuY2hlY2tvdXQudmlzYS5jb20vd2FsbGV0LXNlcnZpY2VzLXdlYi94by9idXR0b24ucG5nP2FjY2VwdENhbmFkaWFuVmlzYURlYml0PWZhbHNlJmNvYnJhbmQ9dHJ1ZSZoZWlnaHQ9MzQmd2lkdGg9MTc4XCJcXG4gICAgICAgICAgICAgICAgLz5cXG4gICAgICAgICAgICA8YSBjbGFzcz1cInYtbGVhcm4gdi1sZWFybi1kZWZhdWx0XCIgc3R5bGU9XCJ0ZXh0LWFsaWduOiByaWdodDsgZGlzcGxheTogYmxvY2s7IGZvbnQtc2l6ZTogMTBweDsgY29sb3I6ICMwMDMzNjY7XCIgaHJlZj1cIiNcIiBkYXRhLWxvY2FsZT1cImVuX1VTXCI+VGVsbCBNZSBNb3JlPC9hPicsZS5hcHBlbmRDaGlsZChpKSxpfWhhbmRsZUVycm9yKGUpe2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIHRoaXMub25FcnJvcil0aHJvdyBlO3RoaXMub25FcnJvcihlKX19Y29uc3Qgd2U9cShpPT57Y29uc3Qgbj13aW5kb3cscj1uZXcgdihpKSxvPW5ldyBnZShuZXcgVyh0KCksbixyKSk7cmV0dXJuIG5ldyBiZShpLGUoKSxvKX0sW3tpZDpcImJyYWludHJlZXZpc2FjaGVja291dFwifV0pO2NsYXNzIENlIGV4dGVuZHMgZntjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIkFuIHVuZXhwZWN0ZWQgZXJyb3IgaGFzIG9jY3VycmVkIGR1cmluZyBidXkgbm93IGNhcnQgY3JlYXRpb24gcHJvY2Vzcy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiksdGhpcy5uYW1lPVwiQnV5Tm93Q2FydENyZWF0aW9uRXJyb3JcIix0aGlzLnR5cGU9XCJidXlfbm93X2NhcnRfY3JlYXRpb25fZXJyb3JcIn19ZnVuY3Rpb24gU2UoZSl7Y29uc3R7Y29sb3I6dCxmdW5kaW5naWNvbnM6aSxoZWlnaHQ6bj00MCxsYXlvdXQ6cixzaGFwZTphLHNpemU6cyx0YWdsaW5lOmx9PWV8fHt9LGM9e2NvbG9yOnQsZnVuZGluZ2ljb25zOmksaGVpZ2h0OlBlKG4pLGxheW91dDpyLHNoYXBlOmF8fFwicmVjdFwiLHNpemU6cyx0YWdsaW5lOmx9O3JldHVybiBkKGMsbyl9ZnVuY3Rpb24gUGUoZSl7Y29uc3QgdD1OdW1iZXIoZSk7cmV0dXJuIXR8fE51bWJlci5pc05hTih0KT80MDp0PjU1PzU1OnQ8MjU/MjU6dH1mdW5jdGlvbiBJZShlKXtyZXR1cm57cmVjaXBpZW50TmFtZTpgJHtlLmZpcnN0TmFtZX0gJHtlLmxhc3ROYW1lfWAsbGluZTE6ZS5hZGRyZXNzMSxsaW5lMjplLmFkZHJlc3MyLGNpdHk6ZS5jaXR5LHN0YXRlOmUuc3RhdGVPclByb3ZpbmNlQ29kZSxwb3N0YWxDb2RlOmUucG9zdGFsQ29kZSxjb3VudHJ5Q29kZTplLmNvdW50cnlDb2RlLHBob25lOmUucGhvbmV9fXZhciBPZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBrZXtjb25zdHJ1Y3RvcihlLHQsaSxuKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmZvcm1Qb3N0ZXI9dCx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT1pLHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdz1ufWluaXRpYWxpemUoZSl7cmV0dXJuIE9lKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWVwYXlwYWw6dCxjb250YWluZXJJZDppLG1ldGhvZElkOm59PWU7aWYoIW4pdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIWkpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuY29udGFpbmVySWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVlcGF5cGFsXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2xldCByLG89dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCk7aWYodC5idXlOb3dJbml0aWFsaXplT3B0aW9ucyl7aWYoIXQuY3VycmVuY3lDb2RlKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXBheXBhbGNyZWRpdC5jdXJyZW5jeUNvZGVcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7cj10LmN1cnJlbmN5Q29kZX1lbHNlIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCksbz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPW8uZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlO2NvbnN0IGE9by5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhuKSx7Y2xpZW50VG9rZW46cyxjb25maWc6ZCxpbml0aWFsaXphdGlvbkRhdGE6bH09YTtpZighc3x8IWwpdGhyb3cgbmV3ICQoUi5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3QgYz17Y3VycmVuY3k6cixpbnRlbnQ6bC5pbnRlbnQsaXNDcmVkaXRFbmFibGVkOmwuaXNDcmVkaXRFbmFibGVkfTt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKHMpLHlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheXBhbENoZWNrb3V0KGMsZT0+e3RoaXMucmVuZGVyUGF5UGFsQnV0dG9uKGUsdCxpLG4sISFkLnRlc3RNb2RlKX0sZT0+dGhpcy5oYW5kbGVFcnJvcihlLGksdC5vbkVycm9yKSl9KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gT2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRlYXJkb3duKCl9KX1yZW5kZXJQYXlQYWxCdXR0b24oZSx0LGksbixyKXtjb25zdHtzdHlsZTpvLHNob3VsZFByb2Nlc3NQYXltZW50OmEsb25BdXRob3JpemVFcnJvcjpzLG9uRWxpZ2liaWxpdHlGYWlsdXJlOmR9PXQse3BheXBhbDpsfT10aGlzLmJyYWludHJlZUhvc3RXaW5kb3c7aWYobCl7Y29uc3QgYz1sLkJ1dHRvbnMoe2VudjpyP1wic2FuZGJveFwiOlwicHJvZHVjdGlvblwiLGZ1bmRpbmdTb3VyY2U6bC5GVU5ESU5HLlBBWVBBTCxzdHlsZTpTZShvKSxjcmVhdGVPcmRlcjooKT0+dGhpcy5zZXR1cFBheW1lbnQoZSx0LG4pLG9uQXBwcm92ZTp0PT50aGlzLnRva2VuaXplUGF5bWVudCh0LGUsbixhLHMpfSk7Yy5pc0VsaWdpYmxlKCk/Yy5yZW5kZXIoYCMke2l9YCk6ZCYmXCJmdW5jdGlvblwiPT10eXBlb2YgZCYmZCgpfWVsc2UgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UucmVtb3ZlRWxlbWVudChpKX1zZXR1cFBheW1lbnQoZSx0LGkpe3ZhciBuO3JldHVybiBPZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7b25QYXltZW50RXJyb3I6cixzaGlwcGluZ0FkZHJlc3M6byxidXlOb3dJbml0aWFsaXplT3B0aW9uczphfT10O3RyeXtjb25zdCByPVwiZnVuY3Rpb25cIj09dHlwZW9mKG51bGw9PWE/dm9pZCAwOmEuZ2V0QnV5Tm93Q2FydFJlcXVlc3RCb2R5KT95aWVsZCB0aGlzLmNyZWF0ZUJ1eU5vd0NhcnQoYS5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkoKSk6dm9pZCAwO3RoaXMuYnV5Tm93Q2FydElkPW51bGw9PXI/dm9pZCAwOnIuaWQ7Y29uc3Qgcz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxkPXMuZ2V0Q3VzdG9tZXIoKSxsPXMuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSksYz1yP3IuY2FydEFtb3VudDpzLmdldENhcnRPclRocm93KCkuY2FydEFtb3VudCx1PXI/dC5jdXJyZW5jeUNvZGU6cy5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGUsaD1vfHwobnVsbD09ZD92b2lkIDA6ZC5hZGRyZXNzZXNbMF0pLHk9aD9JZShoKTp2b2lkIDA7cmV0dXJuIHlpZWxkIGUuY3JlYXRlUGF5bWVudCh7ZmxvdzpcImNoZWNrb3V0XCIsZW5hYmxlU2hpcHBpbmdBZGRyZXNzOiEwLHNoaXBwaW5nQWRkcmVzc0VkaXRhYmxlOiExLHNoaXBwaW5nQWRkcmVzc092ZXJyaWRlOnksYW1vdW50OmMsY3VycmVuY3k6dSxvZmZlckNyZWRpdDohMSxpbnRlbnQ6bnVsbD09PShuPWwuaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09bj92b2lkIDA6bi5pbnRlbnR9KX1jYXRjaChlKXt0aHJvdyByJiYoRihlKXx8ZSBpbnN0YW5jZW9mIGYpJiZyKGUpLGV9fSl9dG9rZW5pemVQYXltZW50KGUsdCxpLG4scil7cmV0dXJuIE9lKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7Y29uc3R7ZGV2aWNlRGF0YTpyfT15aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXREYXRhQ29sbGVjdG9yKHtwYXlwYWw6ITB9KSxvPXlpZWxkIHQudG9rZW5pemVQYXltZW50KGUpLHtkZXRhaWxzOmEsbm9uY2U6c309byxkPXRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvTGVnYWN5QmlsbGluZ0FkZHJlc3MoYSksbD10aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5tYXBUb0xlZ2FjeVNoaXBwaW5nQWRkcmVzcyhhKTtyZXR1cm4gdGhpcy5mb3JtUG9zdGVyLnBvc3RGb3JtKFwiL2NoZWNrb3V0LnBocFwiLE9iamVjdC5hc3NpZ24oe3BheW1lbnRfdHlwZTpcInBheXBhbFwiLHByb3ZpZGVyOmksYWN0aW9uOm4/XCJwcm9jZXNzX3BheW1lbnRcIjpcInNldF9leHRlcm5hbF9jaGVja291dFwiLG5vbmNlOnMsZGV2aWNlX2RhdGE6cixiaWxsaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkoZCksc2hpcHBpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeShsKX0sdGhpcy5idXlOb3dDYXJ0SWQmJntjYXJ0X2lkOnRoaXMuYnV5Tm93Q2FydElkfSkpLG99Y2F0Y2goZSl7dGhyb3cgciYmKEYoZSl8fGUgaW5zdGFuY2VvZiBmKSYmcihlKSxlfX0pfWNyZWF0ZUJ1eU5vd0NhcnQoZSl7cmV0dXJuIE9lKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighZSl0aHJvdyBuZXcgJChSLk1pc3NpbmdDYXJ0KTt0cnl7cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5jcmVhdGVCdXlOb3dDYXJ0KGUpfWNhdGNoKGUpe3Rocm93IG5ldyBDZX19KX1oYW5kbGVFcnJvcihlLHQsaSl7aWYodGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UucmVtb3ZlRWxlbWVudCh0KSwhaXx8IUYoZSkpdGhyb3cgZTtpKGUpfX1jb25zdCBFZT1xKGk9Pntjb25zdCBuPXdpbmRvdyxyPW5ldyB2KGkpLG89bmV3IFYobmV3IFcodCgpLG4sciksbik7cmV0dXJuIG5ldyBrZShpLGUoKSxvLG4pfSxbe2lkOlwiYnJhaW50cmVlcGF5cGFsXCJ9XSk7Y2xhc3MgVGV7Y29uc3RydWN0b3IoZSl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVIb3N0V2luZG93PXdpbmRvd31yZW5kZXIoZSx0LGkpe2NvbnN0IG49dCYmZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodCk7aWYodGhpcy5icmFpbnRyZWVIb3N0V2luZG93LnBheXBhbCYmbil7Y29uc3Qgcj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxvPXIuZ2V0Q2FydE9yVGhyb3coKSxhPXIuZ2V0QmlsbGluZ0FkZHJlc3NPclRocm93KCkscz1yLmdldFBheW1lbnRNZXRob2RPclRocm93KGUpO2lmKCFzLmluaXRpYWxpemF0aW9uRGF0YSlyZXR1cm47Y29uc3R7cGF5cGFsQk5QTENvbmZpZ3VyYXRpb246ZD1bXX09cy5pbml0aWFsaXphdGlvbkRhdGEsbD1pPT09RC5QQVlNRU5UP1wiY2hlY2tvdXRcIjppLGM9ZCYmZC5maW5kKCh7aWQ6ZX0pPT5lPT09bCk7aWYoIWN8fCFjLnN0YXR1cylyZXR1cm47aT09PUQuQ0FSVCYmKG4ucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcC1zdHlsZS1sb2dvLXR5cGVcIiksbi5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXBwLXN0eWxlLWxvZ28tcG9zaXRpb25cIiksbi5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXBwLXN0eWxlLXRleHQtY29sb3JcIiksbi5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXBwLXN0eWxlLXRleHQtc2l6ZVwiKSksdGhpcy5icmFpbnRyZWVIb3N0V2luZG93LnBheXBhbC5NZXNzYWdlcyh7YW1vdW50Om8uY2FydEFtb3VudCxidXllckNvdW50cnk6YS5jb3VudHJ5Q29kZSxwbGFjZW1lbnQ6aSxzdHlsZTp0aGlzLmdldFBheXBhbE1lc3NhZ2VzU3R5bGVzRnJvbUJOUExDb25maWcoYyl9KS5yZW5kZXIoYCMke3R9YCl9fWdldFBheXBhbE1lc3NhZ2VzU3R5bGVzRnJvbUJOUExDb25maWcoe3N0eWxlczplfSl7Y29uc3QgdD17fTtyZXR1cm4gZS5jb2xvciYmKHQuY29sb3I9ZS5jb2xvciksZS5sYXlvdXQmJih0LmxheW91dD1lLmxheW91dCksKGVbXCJsb2dvLXR5cGVcIl18fGVbXCJsb2dvLXBvc2l0aW9uXCJdKSYmKHQubG9nbz17fSxlW1wibG9nby10eXBlXCJdJiYodC5sb2dvLnR5cGU9ZVtcImxvZ28tdHlwZVwiXSksZVtcImxvZ28tcG9zaXRpb25cIl0mJih0LmxvZ28ucG9zaXRpb249ZVtcImxvZ28tcG9zaXRpb25cIl0pKSxlLnJhdGlvJiYodC5yYXRpbz1lLnJhdGlvKSwoZVtcInRleHQtY29sb3JcIl18fGVbXCJ0ZXh0LXNpemVcIl0pJiYodC50ZXh0PXt9LGVbXCJ0ZXh0LWNvbG9yXCJdJiYodC50ZXh0LmNvbG9yPWVbXCJ0ZXh0LWNvbG9yXCJdKSxlW1widGV4dC1zaXplXCJdJiYodC50ZXh0LnNpemU9K2VbXCJ0ZXh0LXNpemVcIl0pKSx0fX12YXIgQWU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgemV7Y29uc3RydWN0b3IoZSx0LGksbixyKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmZvcm1Qb3N0ZXI9dCx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT1pLHRoaXMuYnJhaW50cmVlTWVzc2FnZXM9bix0aGlzLmJyYWludHJlZUhvc3RXaW5kb3c9cn1pbml0aWFsaXplKGUpe3ZhciB0LGk7cmV0dXJuIEFlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWVwYXlwYWxjcmVkaXQ6bixjb250YWluZXJJZDpyLG1ldGhvZElkOm99PWU7aWYoIW8pdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXIpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuY29udGFpbmVySWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIW4pdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVlcGF5cGFsY3JlZGl0XCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2xldCBhLHM9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCk7aWYobi5idXlOb3dJbml0aWFsaXplT3B0aW9ucyl7aWYoIW4uY3VycmVuY3lDb2RlKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXBheXBhbGNyZWRpdC5jdXJyZW5jeUNvZGVcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7YT1uLmN1cnJlbmN5Q29kZX1lbHNlIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCkscz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxhPXMuZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlO2NvbnN0IGQ9cy5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhvKSx7Y2xpZW50VG9rZW46bCxjb25maWc6Yyxpbml0aWFsaXphdGlvbkRhdGE6dX09ZDtpZighbHx8IXUpdGhyb3cgbmV3ICQoUi5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3QgaD17Y3VycmVuY3k6YSxpbnRlbnQ6dS5pbnRlbnQsaXNDcmVkaXRFbmFibGVkOnUuaXNDcmVkaXRFbmFibGVkfSxtPXkobnVsbCE9PShpPW51bGw9PT0odD1zLmdldFN0b3JlQ29uZmlnKCkpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmNoZWNrb3V0U2V0dGluZ3MuZmVhdHVyZXMpJiZ2b2lkIDAhPT1pP2k6e30sXCJQQVlQQUwtNTY2My5oaWRlX2JyYWludHJlZV9jYXJkX2Jhbm5lcl9pbXBsZW1lbnRhdGlvbl9pbl9jaGVja291dF9zZGtcIik7dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuaW5pdGlhbGl6ZShsKSx5aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRQYXlwYWxDaGVja291dChoLGU9PnshbSYmbi5tZXNzYWdpbmdDb250YWluZXJJZCYmdGhpcy5yZW5kZXJQYXlQYWxNZXNzYWdlcyhvLG4ubWVzc2FnaW5nQ29udGFpbmVySWQpLHRoaXMucmVuZGVyUGF5UGFsQnV0dG9uKGUsbixyLG8sISFjLnRlc3RNb2RlKX0sZT0+dGhpcy5oYW5kbGVFcnJvcihlLHIsbi5vbkVycm9yKSl9KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gQWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRlYXJkb3duKCl9KX1yZW5kZXJQYXlQYWxNZXNzYWdlcyhlLHQpe3RoaXMuYnJhaW50cmVlTWVzc2FnZXMucmVuZGVyKGUsdCxELkNBUlQpfXJlbmRlclBheVBhbEJ1dHRvbihlLHQsaSxuLHIpe2NvbnN0e3N0eWxlOm8sc2hvdWxkUHJvY2Vzc1BheW1lbnQ6YSxvbkF1dGhvcml6ZUVycm9yOnMsb25FbGlnaWJpbGl0eUZhaWx1cmU6ZH09dCx7cGF5cGFsOmx9PXRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdztsZXQgYz0hMTtsJiZbbC5GVU5ESU5HLlBBWUxBVEVSLGwuRlVORElORy5DUkVESVRdLmZvckVhY2godT0+e2NvbnN0IGg9dT09PWwuRlVORElORy5DUkVESVQ/T2JqZWN0LmFzc2lnbih7bGFiZWw6Ti5DUkVESVR9LFNlKG8pKTpTZShvKTtpZighYyl7Y29uc3Qgbz1sLkJ1dHRvbnMoe2VudjpyP1wic2FuZGJveFwiOlwicHJvZHVjdGlvblwiLGZ1bmRpbmdTb3VyY2U6dSxzdHlsZTpoLGNyZWF0ZU9yZGVyOigpPT50aGlzLnNldHVwUGF5bWVudChlLHQsbiksb25BcHByb3ZlOnQ9PnRoaXMudG9rZW5pemVQYXltZW50KHQsZSxuLGEscyl9KTtvLmlzRWxpZ2libGUoKT8oby5yZW5kZXIoYCMke2l9YCksYz0hMCk6bC5GVU5ESU5HLkNSRURJVCYmZCYmXCJmdW5jdGlvblwiPT10eXBlb2YgZCYmZCgpfX0pLGwmJmN8fHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQoaSl9c2V0dXBQYXltZW50KGUsdCxpKXt2YXIgbjtyZXR1cm4gQWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e29uUGF5bWVudEVycm9yOnIsc2hpcHBpbmdBZGRyZXNzOm8sYnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnM6YX09dDt0cnl7Y29uc3Qgcj1cImZ1bmN0aW9uXCI9PXR5cGVvZihudWxsPT1hP3ZvaWQgMDphLmdldEJ1eU5vd0NhcnRSZXF1ZXN0Qm9keSk/eWllbGQgdGhpcy5jcmVhdGVCdXlOb3dDYXJ0KGEuZ2V0QnV5Tm93Q2FydFJlcXVlc3RCb2R5KCkpOnZvaWQgMDt0aGlzLmJ1eU5vd0NhcnRJZD1udWxsPT1yP3ZvaWQgMDpyLmlkO2NvbnN0IHM9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksZD1zLmdldEN1c3RvbWVyKCksbD1zLmdldFBheW1lbnRNZXRob2RPclRocm93KGkpLGM9cj9yLmNhcnRBbW91bnQ6cy5nZXRDYXJ0T3JUaHJvdygpLmNhcnRBbW91bnQsdT1yP3QuY3VycmVuY3lDb2RlOnMuZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlLGg9b3x8KG51bGw9PWQ/dm9pZCAwOmQuYWRkcmVzc2VzWzBdKSx5PWg/SWUoaCk6dm9pZCAwO3JldHVybiB5aWVsZCBlLmNyZWF0ZVBheW1lbnQoe2Zsb3c6XCJjaGVja291dFwiLGVuYWJsZVNoaXBwaW5nQWRkcmVzczohMCxzaGlwcGluZ0FkZHJlc3NFZGl0YWJsZTohMSxzaGlwcGluZ0FkZHJlc3NPdmVycmlkZTp5LGFtb3VudDpjLGN1cnJlbmN5OnUsb2ZmZXJDcmVkaXQ6ITAsaW50ZW50Om51bGw9PT0obj1sLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PW4/dm9pZCAwOm4uaW50ZW50fSl9Y2F0Y2goZSl7dGhyb3cgciYmKEYoZSl8fGUgaW5zdGFuY2VvZiBmKSYmcihlKSxlfX0pfXRva2VuaXplUGF5bWVudChlLHQsaSxuLHIpe3JldHVybiBBZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e2NvbnN0e2RldmljZURhdGE6cn09eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0RGF0YUNvbGxlY3Rvcih7cGF5cGFsOiEwfSksbz15aWVsZCB0LnRva2VuaXplUGF5bWVudChlKSx7ZGV0YWlsczphLG5vbmNlOnN9PW8sZD10aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5tYXBUb0xlZ2FjeUJpbGxpbmdBZGRyZXNzKGEpLGw9dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UubWFwVG9MZWdhY3lTaGlwcGluZ0FkZHJlc3MoYSk7cmV0dXJuIHRoaXMuZm9ybVBvc3Rlci5wb3N0Rm9ybShcIi9jaGVja291dC5waHBcIixPYmplY3QuYXNzaWduKHtwYXltZW50X3R5cGU6XCJwYXlwYWxcIixwcm92aWRlcjppLGFjdGlvbjpuP1wicHJvY2Vzc19wYXltZW50XCI6XCJzZXRfZXh0ZXJuYWxfY2hlY2tvdXRcIixub25jZTpzLGRldmljZV9kYXRhOnIsYmlsbGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KGQpLHNoaXBwaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkobCl9LHRoaXMuYnV5Tm93Q2FydElkJiZ7Y2FydF9pZDp0aGlzLmJ1eU5vd0NhcnRJZH0pKSxvfWNhdGNoKGUpe3Rocm93IHImJihGKGUpfHxlIGluc3RhbmNlb2YgZikmJnIoZSksZX19KX1jcmVhdGVCdXlOb3dDYXJ0KGUpe3JldHVybiBBZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIWUpdGhyb3cgbmV3ICQoUi5NaXNzaW5nQ2FydCk7dHJ5e3JldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlQnV5Tm93Q2FydChlKX1jYXRjaChlKXt0aHJvdyBuZXcgQ2V9fSl9aGFuZGxlRXJyb3IoZSx0LGkpe2lmKHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQodCksIWl8fCFGKGUpKXRocm93IGU7aShlKX19Y29uc3QgTmU9cShpPT57Y29uc3Qgbj13aW5kb3cscj1uZXcgdihpKSxvPW5ldyBWKG5ldyBXKHQoKSxuLHIpLG4pLGE9bmV3IFRlKGkpO3JldHVybiBuZXcgemUoaSxlKCksbyxhLG4pfSxbe2lkOlwiYnJhaW50cmVlcGF5cGFsY3JlZGl0XCJ9XSk7dmFyIE1lPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIERle2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmZvcm1Qb3N0ZXI9dCx0aGlzLmJyYWludHJlZVNkaz1pfWluaXRpYWxpemUoZSl7cmV0dXJuIE1lKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtjb250YWluZXJJZDp0LG1ldGhvZElkOml9PWU7aWYoIWkpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuY29udGFpbmVySWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKGkpO2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkse2NsaWVudFRva2VuOnIsaW5pdGlhbGl6YXRpb25EYXRhOm8sY29uZmlnOmF9PW4uZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSk7aWYoIXJ8fCFvKXRocm93IG5ldyAkKFIuTWlzc2luZ1BheW1lbnRNZXRob2QpO3RoaXMuYnJhaW50cmVlU2RrLmluaXRpYWxpemUocik7Y29uc3Qgcz15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXRCcmFpbnRyZWVWaXNhQ2hlY2tvdXQoKSx7Y3VycmVuY3k6e2NvZGU6ZH0sY2FydEFtb3VudDpsfT1uLmdldENhcnRPclRocm93KCksYz15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXRWaXNhQ2hlY2tvdXRTZGsoYS50ZXN0TW9kZSksdT1zLmNyZWF0ZUluaXRPcHRpb25zKHtwYXltZW50UmVxdWVzdDp7Y3VycmVuY3lDb2RlOmQsc3VidG90YWw6U3RyaW5nKGwpfSxzZXR0aW5nczp7c2hpcHBpbmc6e2NvbGxlY3RTaGlwcGluZzohMH19fSk7dGhpcy5jcmVhdGVTaWduSW5CdXR0b24odCkseWllbGQgYy5pbml0KHUpLGMub24oXCJwYXltZW50LnN1Y2Nlc3NcIixlPT5NZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50U3VjY2VzcyhzLGUpfSkpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfXBheW1lbnRTdWNjZXNzKGUsdCl7cmV0dXJuIE1lKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gUHJvbWlzZS5hbGwoW2UudG9rZW5pemUodCksdGhpcy5icmFpbnRyZWVTZGsuZ2V0RGF0YUNvbGxlY3Rvck9yVGhyb3coKV0pLnRoZW4oKFtlLHRdKT0+e2NvbnN0IGk9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksbj1pLmdldFNoaXBwaW5nQWRkcmVzcygpLHI9aS5nZXRCaWxsaW5nQWRkcmVzcygpLHtzaGlwcGluZ0FkZHJlc3M6bz10aGlzLnRvVmlzYUNoZWNrb3V0QWRkcmVzcyhuKSxiaWxsaW5nQWRkcmVzczphPXRoaXMudG9WaXNhQ2hlY2tvdXRBZGRyZXNzKHIpfT1lO3JldHVybiB0aGlzLnBvc3RGb3JtKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7c2hpcHBpbmdBZGRyZXNzOm8sYmlsbGluZ0FkZHJlc3M6YX0pLHQpfSl9KX1wb3N0Rm9ybShlLHQpe2NvbnN0e3VzZXJEYXRhOmksYmlsbGluZ0FkZHJlc3M6bixzaGlwcGluZ0FkZHJlc3M6cixkZXRhaWxzOm99PWUse3VzZXJFbWFpbDphfT1pLHtkZXZpY2VEYXRhOnN9PXQ7cmV0dXJuIHRoaXMuZm9ybVBvc3Rlci5wb3N0Rm9ybShcIi9jaGVja291dC5waHBcIix7cGF5bWVudF90eXBlOmUudHlwZSxub25jZTplLm5vbmNlLHByb3ZpZGVyOlwiYnJhaW50cmVldmlzYWNoZWNrb3V0XCIsYWN0aW9uOlwic2V0X2V4dGVybmFsX2NoZWNrb3V0XCIsZGV2aWNlX2RhdGE6cyxjYXJkX2luZm9ybWF0aW9uOkpTT04uc3RyaW5naWZ5KHt0eXBlOm8uY2FyZFR5cGUsbnVtYmVyOm8ubGFzdFR3b30pLGJpbGxpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeSh0aGlzLmdldEFkZHJlc3MoYSxuKSksc2hpcHBpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeSh0aGlzLmdldEFkZHJlc3MoYSxyKSl9KX10b1Zpc2FDaGVja291dEFkZHJlc3MoZSl7cmV0dXJuIGU/e2ZpcnN0TmFtZTplLmZpcnN0TmFtZSxsYXN0TmFtZTplLmxhc3ROYW1lLHBob25lTnVtYmVyOmUucGhvbmUsc3RyZWV0QWRkcmVzczplLmFkZHJlc3MxLGV4dGVuZGVkQWRkcmVzczplLmFkZHJlc3MyLGxvY2FsaXR5OmUuY2l0eSxyZWdpb246ZS5zdGF0ZU9yUHJvdmluY2VDb2RlLGNvdW50cnlDb2RlOmUuY291bnRyeUNvZGUscG9zdGFsQ29kZTplLnBvc3RhbENvZGV9Ont9fWdldEFkZHJlc3MoZSx0PXt9KXtyZXR1cm57ZW1haWw6ZSxmaXJzdF9uYW1lOnQuZmlyc3ROYW1lLGxhc3RfbmFtZTp0Lmxhc3ROYW1lLHBob25lX251bWJlcjp0LnBob25lTnVtYmVyLGFkZHJlc3NfbGluZV8xOnQuc3RyZWV0QWRkcmVzcyxhZGRyZXNzX2xpbmVfMjp0LmV4dGVuZGVkQWRkcmVzcyxjaXR5OnQubG9jYWxpdHksc3RhdGU6dC5yZWdpb24sY291bnRyeV9jb2RlOnQuY291bnRyeUNvZGUscG9zdGFsX2NvZGU6dC5wb3N0YWxDb2RlfX1jcmVhdGVTaWduSW5CdXR0b24oZSl7Y29uc3QgdD1kb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtlfWApO2lmKCF0KXRocm93IG5ldyBFcnJvcihcIk5lZWQgYSBjb250YWluZXIgdG8gcGxhY2UgdGhlIGJ1dHRvblwiKTtyZXR1cm4gdGhpcy5pbnNlcnRWaXNhQ2hlY2tvdXRCdXR0b24odCl9aW5zZXJ0VmlzYUNoZWNrb3V0QnV0dG9uKGUpe2NvbnN0IHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtyZXR1cm4gdC5zdHlsZS5kaXNwbGF5PVwiZmxleFwiLHQuc3R5bGUuZmxleERpcmVjdGlvbj1cImNvbHVtblwiLHQuc3R5bGUuYWxpZ25JdGVtcz1cImZsZXgtZW5kXCIsdC5pbm5lckhUTUw9J1xcbiAgICAgICAgICAgIDxpbWdcXG4gICAgICAgICAgICAgICAgYWx0PVwiVmlzYSBDaGVja291dFwiXFxuICAgICAgICAgICAgICAgIGNsYXNzPVwidi1idXR0b25cIlxcbiAgICAgICAgICAgICAgICByb2xlPVwiYnV0dG9uXCJcXG4gICAgICAgICAgICAgICAgc3JjPVwiaHR0cHM6Ly9zZWN1cmUuY2hlY2tvdXQudmlzYS5jb20vd2FsbGV0LXNlcnZpY2VzLXdlYi94by9idXR0b24ucG5nP2FjY2VwdENhbmFkaWFuVmlzYURlYml0PWZhbHNlJmNvYnJhbmQ9dHJ1ZSZoZWlnaHQ9MzQmd2lkdGg9MTc4XCJcXG4gICAgICAgICAgICAgICAgLz5cXG4gICAgICAgICAgICA8YSBjbGFzcz1cInYtbGVhcm4gdi1sZWFybi1kZWZhdWx0XCIgc3R5bGU9XCJ0ZXh0LWFsaWduOiByaWdodDsgZGlzcGxheTogYmxvY2s7IGZvbnQtc2l6ZTogMTBweDsgY29sb3I6ICMwMDMzNjY7XCIgaHJlZj1cIiNcIiBkYXRhLWxvY2FsZT1cImVuX1VTXCI+VGVsbCBNZSBNb3JlPC9hPicsZS5hcHBlbmRDaGlsZCh0KSx0fX1jb25zdCBfZT1xKGk9Pntjb25zdCBuPXdpbmRvdyxyPW5ldyB2KGkpLG89bmV3IGdlKG5ldyBXKHQoKSxuLHIpKTtyZXR1cm4gbmV3IERlKGksZSgpLG8pfSxbe2lkOlwiYnJhaW50cmVldmlzYWNoZWNrb3V0XCJ9XSk7ZnVuY3Rpb24gQmUoZSl7Y29uc3R7YmlsbGluZ0FkZHJlc3M6dCxlbWFpbDppLGZpcnN0TmFtZTpuLGxhc3ROYW1lOnIscGhvbmU6byxzaGlwcGluZ0FkZHJlc3M6YX09ZSxzPXR8fGE7cmV0dXJue2VtYWlsOmksZmlyc3RfbmFtZTpuLGxhc3RfbmFtZTpyLHBob25lX251bWJlcjpvLGFkZHJlc3NfbGluZV8xOm51bGw9PXM/dm9pZCAwOnMubGluZTEsYWRkcmVzc19saW5lXzI6bnVsbD09cz92b2lkIDA6cy5saW5lMixjaXR5Om51bGw9PXM/dm9pZCAwOnMuY2l0eSxzdGF0ZTpudWxsPT1zP3ZvaWQgMDpzLnN0YXRlLGNvdW50cnlfY29kZTpudWxsPT1zP3ZvaWQgMDpzLmNvdW50cnlDb2RlLHBvc3RhbF9jb2RlOm51bGw9PXM/dm9pZCAwOnMucG9zdGFsQ29kZX19ZnVuY3Rpb24geGUoZSl7Y29uc3R7ZW1haWw6dCxwaG9uZTppLHNoaXBwaW5nQWRkcmVzczpufT1lLHI9KG51bGw9PW4/dm9pZCAwOm4ucmVjaXBpZW50TmFtZSl8fFwiXCIsW28sYV09ci5zcGxpdChcIiBcIik7cmV0dXJue2VtYWlsOnQsZmlyc3RfbmFtZTpvfHxcIlwiLGxhc3RfbmFtZTphfHxcIlwiLHBob25lX251bWJlcjppLGFkZHJlc3NfbGluZV8xOm51bGw9PW4/dm9pZCAwOm4ubGluZTEsYWRkcmVzc19saW5lXzI6bnVsbD09bj92b2lkIDA6bi5saW5lMixjaXR5Om51bGw9PW4/dm9pZCAwOm4uY2l0eSxzdGF0ZTpudWxsPT1uP3ZvaWQgMDpuLnN0YXRlLGNvdW50cnlfY29kZTpudWxsPT1uP3ZvaWQgMDpuLmNvdW50cnlDb2RlLHBvc3RhbF9jb2RlOm51bGw9PW4/dm9pZCAwOm4ucG9zdGFsQ29kZX19ZnVuY3Rpb24gRmUoZSl7cmV0dXJuXCJvYmplY3RcIj09dHlwZW9mIGUmJm51bGwhPT1lJiZcIm5hbWVcImluIGUmJlwiQnJhaW50cmVlRXJyb3JcIj09PWUubmFtZX12YXIgTGU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y29uc3QgVmU9ZT0+e2NvbnN0e2NvbG9yOnQsaGVpZ2h0Oml9PWU7cmV0dXJue2JhY2tncm91bmRDb2xvcjoobj10fHxcIlwiLG49PT16LldISVRFP1wiI0ZGRkZGRlwiOlwiIzNEOTVDRVwiKSxiYWNrZ3JvdW5kUG9zaXRpb246XCI1MCUgNTAlXCIsYmFja2dyb3VuZFNpemU6XCI4MHB4IGF1dG9cIixiYWNrZ3JvdW5kSW1hZ2U6YHVybChcIi9hcHAvYXNzZXRzL2ltZy9wYXltZW50LXByb3ZpZGVycy92ZW5tby1sb2dvLSR7dD09PXouV0hJVEU/ei5CTFVFOnouV0hJVEV9LnN2Z1wiKWAsYmFja2dyb3VuZFJlcGVhdDpcIm5vLXJlcGVhdFwiLGJvcmRlclJhZGl1czpcIjRweFwiLGN1cnNvcjpcInBvaW50ZXJcIix0cmFuc2l0aW9uOlwiMC4ycyBlYXNlXCIsbWluSGVpZ2h0OmAke2l8fDQwfXB4YCxtaW5XaWR0aDpcIjE1MHB4XCIsaGVpZ2h0OlwiMTAwJVwiLHdpZHRoOlwiMTAwJVwiLGJvcmRlcjp0PT09ei5XSElURT9cIjFweCBzb2xpZCBibGFja1wiOlwibm9uZVwifTt2YXIgbn07Y2xhc3MgamV7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuZm9ybVBvc3Rlcj10LHRoaXMuYnJhaW50cmVlU2RrPWksdGhpcy5vbkVycm9yPWF9aW5pdGlhbGl6ZShlKXtyZXR1cm4gTGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2JyYWludHJlZXZlbm1vOnQsY29udGFpbmVySWQ6aSxtZXRob2RJZDpufT1lO2lmKCFuKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2NvbnN0IHI9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3cobikse2NsaWVudFRva2VuOm8saW5pdGlhbGl6YXRpb25EYXRhOmF9PXIse3BheW1lbnRCdXR0b25TdHlsZXM6c309YSx7Y2FydEJ1dHRvblN0eWxlczpkfT1zfHx7fSxsPShudWxsPT10P3ZvaWQgMDp0LnN0eWxlKXx8ZDtpZighb3x8IWEpdGhyb3cgbmV3ICQoUi5NaXNzaW5nUGF5bWVudE1ldGhvZCk7aWYoIWkpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuY29udGFpbmVySWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWREZWZhdWx0Q2hlY2tvdXQoKSx0aGlzLm9uRXJyb3I9KG51bGw9PXQ/dm9pZCAwOnQub25FcnJvcil8fHRoaXMuaGFuZGxlRXJyb3IsdGhpcy5icmFpbnRyZWVTZGsuaW5pdGlhbGl6ZShvKTt0cnl7Y29uc3QgZT15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXRWZW5tb0NoZWNrb3V0T3JUaHJvdygpO3RoaXMucmVuZGVyVmVubW9CdXR0b24oZSxpLG51bGw9PXQ/dm9pZCAwOnQuYnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnMsbCl9Y2F0Y2goZSl7KEZlKGUpfHxmdW5jdGlvbihlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIGJ9KGUpKSYmdGhpcy5oYW5kbGVJbml0aWFsaXphdGlvblZlbm1vRXJyb3IoZSxpKX19KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gTGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB5aWVsZCB0aGlzLmJyYWludHJlZVNkay5kZWluaXRpYWxpemUoKSxQcm9taXNlLnJlc29sdmUoKX0pfWhhbmRsZUVycm9yKGUpe3Rocm93IG5ldyBFcnJvcihlLm1lc3NhZ2UpfWNyZWF0ZUJ1eU5vd0NhcnQoZSl7cmV0dXJuIExlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZihudWxsPT1lP3ZvaWQgMDplLmdldEJ1eU5vd0NhcnRSZXF1ZXN0Qm9keSkpe2NvbnN0IHQ9bnVsbD09ZT92b2lkIDA6ZS5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkoKTtpZighdCl0aHJvdyBuZXcgJChSLk1pc3NpbmdDYXJ0KTt0cnl7cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5jcmVhdGVCdXlOb3dDYXJ0KHQpfWNhdGNoKGUpe3Rocm93IG5ldyBDZX19fSl9aGFuZGxlSW5pdGlhbGl6YXRpb25WZW5tb0Vycm9yKGUsdCl7cmV0dXJuIHRoaXMucmVtb3ZlVmVubW9Db250YWluZXIodCksdGhpcy5vbkVycm9yKGUpfXJlbW92ZVZlbm1vQ29udGFpbmVyKGUpe2NvbnN0IHQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSk7dCYmdC5yZW1vdmUoKX1yZW5kZXJWZW5tb0J1dHRvbihlLHQsaSxuKXtjb25zdCByPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHQpLHtjb2xvcjpvfT1ufHx7fTtpZighcil0aHJvdyBuZXcgdyhcIlVuYWJsZSB0byBjcmVhdGUgd2FsbGV0IGJ1dHRvbiB3aXRob3V0IHZhbGlkIGNvbnRhaW5lciBJRC5cIik7ci5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsXCJWZW5tb1wiKSxPYmplY3QuYXNzaWduKHIuc3R5bGUsVmUobnx8e30pKSxyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCgpPT5MZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7ci5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLFwidHJ1ZVwiKTtjb25zdCB0PXlpZWxkIHRoaXMuY3JlYXRlQnV5Tm93Q2FydChpKTtlLnRva2VuaXplJiZlLnRva2VuaXplKChlLGkpPT5MZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7ci5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKSxlJiZ0aGlzLm9uRXJyb3IoZSkseWllbGQgdGhpcy5oYW5kbGVQb3N0Rm9ybShpLG51bGw9PXQ/dm9pZCAwOnQuaWQpfSkpfSkpLG89PT16LkJMVUUmJihyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsKCk9PntyLnN0eWxlLmJhY2tncm91bmRDb2xvcj1cIiMwYTdmYzJcIn0pLHIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwoKT0+e3Iuc3R5bGUuYmFja2dyb3VuZENvbG9yPVZlKG58fHt9KS5iYWNrZ3JvdW5kQ29sb3J9KSl9aGFuZGxlUG9zdEZvcm0oZSx0KXtyZXR1cm4gTGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2RldmljZURhdGE6aX09eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0RGF0YUNvbGxlY3Rvck9yVGhyb3coKSx7bm9uY2U6bixkZXRhaWxzOnJ9PWU7dGhpcy5mb3JtUG9zdGVyLnBvc3RGb3JtKFwiL2NoZWNrb3V0LnBocFwiLE9iamVjdC5hc3NpZ24oe25vbmNlOm4scHJvdmlkZXI6XCJicmFpbnRyZWV2ZW5tb1wiLHBheW1lbnRfdHlwZTpcInBheXBhbFwiLGRldmljZV9kYXRhOmksYWN0aW9uOlwic2V0X2V4dGVybmFsX2NoZWNrb3V0XCIsYmlsbGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KEJlKHIpKSxzaGlwcGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KHhlKHIpKX0sdCYme2NhcnRfaWQ6dH0pKX0pfX1jb25zdCBVZT1xKGk9Pntjb25zdCBuPXdpbmRvdyxyPXQoKSxvPW5ldyB2KGkpLGE9bmV3IFcocixuLG8pLHM9bmV3IGdlKGEpO3JldHVybiBuZXcgamUoaSxlKCkscyl9LFt7aWQ6XCJicmFpbnRyZWV2ZW5tb1wifV0pO2Z1bmN0aW9uIFJlKGUpe3JldHVybiBCb29sZWFuKGUuaW5zdHJ1bWVudElkKX1jbGFzcyBIZSBleHRlbmRzIGZ7Y29uc3RydWN0b3IoKXtzdXBlcihcIlRoZSBjdXJyZW50IG9yZGVyIGRvZXMgbm90IG5lZWQgdG8gYmUgZmluYWxpemVkIGF0IHRoaXMgc3RhZ2UuXCIpLHRoaXMubmFtZT1cIk9yZGVyRmluYWxpemF0aW9uTm90UmVxdWlyZWRFcnJvclwiLHRoaXMudHlwZT1cIm9yZGVyX2ZpbmFsaXphdGlvbl9ub3RfcmVxdWlyZWRcIn19ZnVuY3Rpb24gV2UoZSl7cmV0dXJuIShcIm9iamVjdFwiIT10eXBlb2YgZXx8bnVsbD09PWV8fHZvaWQgMCE9PWUuc2hvdWxkU2F2ZUluc3RydW1lbnQmJlwiYm9vbGVhblwiIT10eXBlb2YgZS5zaG91bGRTYXZlSW5zdHJ1bWVudHx8dm9pZCAwIT09ZS5zaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50JiZcImJvb2xlYW5cIiE9dHlwZW9mIGUuc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudCl9Y2xhc3MgcWUgZXh0ZW5kcyBme2NvbnN0cnVjdG9yKGUpe3N1cGVyKGV8fFwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgY2xpZW50IGxpYnJhcnkgb2YgYSBwYXltZW50IG1ldGhvZCBoYXMgdGhyb3duIGFuIHVuZXhwZWN0ZWQgZXJyb3IuXCIpLHRoaXMubmFtZT1cIlBheW1lbnRNZXRob2RGYWlsZWRFcnJvclwiLHRoaXMudHlwZT1cInBheW1lbnRfbWV0aG9kX2NsaWVudF9pbnZhbGlkXCJ9fWZ1bmN0aW9uICRlKGUpe3JldHVybiEhZSYmXCJhY2NvdW50TnVtYmVyXCJpbiBlJiZcInJvdXRpbmdOdW1iZXJcImluIGUmJlwib3duZXJzaGlwVHlwZVwiaW4gZSYmXCJhY2NvdW50VHlwZVwiaW4gZX12YXIgR2U9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgWWV7Y29uc3RydWN0b3IoZSx0KXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJyYWludHJlZVNkaz10fWluaXRpYWxpemUoZSl7cmV0dXJuIEdlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHttZXRob2RJZDp0LGJyYWludHJlZWFjaDppfT1lfHx7fTtpZighdCl0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt0aGlzLmdldE1hbmRhdGVUZXh0PW51bGw9PWk/dm9pZCAwOmkuZ2V0TWFuZGF0ZVRleHQseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKHQpO2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCkse2NsaWVudFRva2VuOnIsaW5pdGlhbGl6YXRpb25EYXRhOm99PW47aWYoIXJ8fCFvKXRocm93IG5ldyAkKFIuTWlzc2luZ1BheW1lbnRNZXRob2QpO3RoaXMuYnJhaW50cmVlU2RrLmluaXRpYWxpemUocik7dHJ5e3RoaXMudXNCYW5rQWNjb3VudD15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXRVc0JhbmtBY2NvdW50KCl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVCcmFpbnRyZWVFcnJvcihlKX19KX1leGVjdXRlKGUsdCl7cmV0dXJuIEdlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Oml9PWUsbj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSk7aWYoIWkpdGhyb3cgbmV3IEMoW1wicGF5bWVudFwiXSk7Y29uc3Qgcj1SZShpLnBheW1lbnREYXRhfHx7fSksbz1yP3lpZWxkIHRoaXMudG9rZW5pemVQYXltZW50Rm9yVmF1bHRlZEluc3RydW1lbnQoaSk6eWllbGQgdGhpcy50b2tlbml6ZVBheW1lbnQoaSksYT1yP3lpZWxkIHRoaXMucHJlcGFyZVBheW1lbnREYXRhRm9yVmF1bHRlZEluc3RydW1lbnQobyxpKTp5aWVsZCB0aGlzLnByZXBhcmVQYXltZW50RGF0YShvLGkpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihuLHQpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGEpfSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEhlKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gR2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB5aWVsZCB0aGlzLmJyYWludHJlZVNkay5kZWluaXRpYWxpemUoKSxQcm9taXNlLnJlc29sdmUoKX0pfXRva2VuaXplUGF5bWVudCh7cGF5bWVudERhdGE6ZX0pe3JldHVybiBHZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLmdldFVzQmFua0FjY291bnRPclRocm93KCk7aWYoISRlKGUpKXRocm93IG5ldyBDKFtcInBheW1lbnQucGF5bWVudERhdGFcIl0pO2NvbnN0IGk9UmUoZSk/XCJUaGUgZGF0YSBhcmUgdXNlZCBmb3Igc3RvcmVkIGluc3RydW1lbnQgdmVyaWZpY2F0aW9uXCI6XCJmdW5jdGlvblwiPT10eXBlb2YgdGhpcy5nZXRNYW5kYXRlVGV4dCYmdGhpcy5nZXRNYW5kYXRlVGV4dCgpO2lmKCFpKXRocm93IG5ldyB3KFwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBnZXRNYW5kYXRlVGV4dCBpcyBub3QgcHJvdmlkZWQgb3IgcmV0dXJuZWQgdW5kZWZpbmVkIHZhbHVlLlwiKTt0cnl7Y29uc3R7bm9uY2U6bn09eWllbGQgdC50b2tlbml6ZSh7YmFua0RldGFpbHM6dGhpcy5nZXRCYW5rRGV0YWlscyhlKSxtYW5kYXRlVGV4dDppfSk7cmV0dXJuIG59Y2F0Y2goZSl7dGhpcy5oYW5kbGVCcmFpbnRyZWVFcnJvcihlKX19KX10b2tlbml6ZVBheW1lbnRGb3JWYXVsdGVkSW5zdHJ1bWVudChlKXtyZXR1cm4gR2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e21ldGhvZElkOnQscGF5bWVudERhdGE6aT17fX09ZSxuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHtjb25maWc6cn09bi5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyh0KTtpZighci5pc1ZhdWx0aW5nRW5hYmxlZCl0aHJvdyBuZXcgdyhcIlZhdWx0aW5nIGlzIGRpc2FibGVkIGJ1dCBhIHZhdWx0ZWQgaW5zdHJ1bWVudCB3YXMgYmVpbmcgdXNlZCBmb3IgdGhpcyB0cmFuc2FjdGlvblwiKTtyZXR1cm4gJGUoaSk/dGhpcy50b2tlbml6ZVBheW1lbnQoZSk6bnVsbH0pfXByZXBhcmVQYXltZW50RGF0YShlLHQpe3JldHVybiBHZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6aSxwYXltZW50RGF0YTpuPXt9fT10O2lmKCEkZShuKSl0aHJvdyBuZXcgQyhbXCJwYXltZW50LnBheW1lbnREYXRhXCJdKTtjb25zdHtkZXZpY2VEYXRhOnJ9PXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldERhdGFDb2xsZWN0b3JPclRocm93KCkse3Nob3VsZFNhdmVJbnN0cnVtZW50Om8sc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDphLHJvdXRpbmdOdW1iZXI6cyxhY2NvdW50TnVtYmVyOmR9PW47cmV0dXJue21ldGhvZElkOmkscGF5bWVudERhdGE6e2RldmljZVNlc3Npb25JZDpyLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6YSxzaG91bGRTYXZlSW5zdHJ1bWVudDpvLGZvcm1hdHRlZFBheWxvYWQ6e3Rva2VuaXplZF9iYW5rX2FjY291bnQ6e2lzc3VlcjpzLG1hc2tlZF9hY2NvdW50X251bWJlcjpkLnN1YnN0cigtNCksdG9rZW46ZX19fX19KX1wcmVwYXJlUGF5bWVudERhdGFGb3JWYXVsdGVkSW5zdHJ1bWVudChlLHQpe3JldHVybiBHZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6aSxwYXltZW50RGF0YTpuPXt9fT10O2lmKCFSZShuKXx8IVdlKG4pKXRocm93IG5ldyBDKFtcInBheW1lbnQucGF5bWVudERhdGFcIl0pO2NvbnN0e2RldmljZURhdGE6cn09eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0RGF0YUNvbGxlY3Rvck9yVGhyb3coKSx7aW5zdHJ1bWVudElkOm8sc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDphfT1uO3JldHVybnttZXRob2RJZDppLHBheW1lbnREYXRhOk9iamVjdC5hc3NpZ24oe2RldmljZVNlc3Npb25JZDpyLGluc3RydW1lbnRJZDpvLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6YX0sZSYme25vbmNlOmV9KX19KX1nZXRCYW5rRGV0YWlscyhlKXtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldEJpbGxpbmdBZGRyZXNzT3JUaHJvdygpLGk9ZS5vd25lcnNoaXBUeXBlLnRvTG93ZXJDYXNlKCksbj1lLmFjY291bnRUeXBlLnRvTG93ZXJDYXNlKCk7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7YWNjb3VudE51bWJlcjplLmFjY291bnROdW1iZXIscm91dGluZ051bWJlcjplLnJvdXRpbmdOdW1iZXIsb3duZXJzaGlwVHlwZTppfSxcInBlcnNvbmFsXCI9PT1pP3tmaXJzdE5hbWU6ZS5maXJzdE5hbWUsbGFzdE5hbWU6ZS5sYXN0TmFtZX06e2J1c2luZXNzTmFtZTplLmJ1c2luZXNzTmFtZX0pLHthY2NvdW50VHlwZTpuLGJpbGxpbmdBZGRyZXNzOntzdHJlZXRBZGRyZXNzOnQuYWRkcmVzczEsZXh0ZW5kZWRBZGRyZXNzOnQuYWRkcmVzczIsbG9jYWxpdHk6dC5jaXR5LHJlZ2lvbjp0LnN0YXRlT3JQcm92aW5jZUNvZGUscG9zdGFsQ29kZTp0LnBvc3RhbENvZGV9fSl9Z2V0VXNCYW5rQWNjb3VudE9yVGhyb3coKXtpZighdGhpcy51c0JhbmtBY2NvdW50KXRocm93IG5ldyBJKFAuUGF5bWVudE5vdEluaXRpYWxpemVkKTtyZXR1cm4gdGhpcy51c0JhbmtBY2NvdW50fWhhbmRsZUJyYWludHJlZUVycm9yKGUpe2lmKCFGKGUpKXRocm93IGU7dGhyb3cgbmV3IHFlKGUubWVzc2FnZSl9fWNvbnN0IEplPXEoZT0+bmV3IFllKGUsKGU9Pntjb25zdCBpPW5ldyB2KGUpLG49bmV3IFcodCgpLHdpbmRvdyxpKTtyZXR1cm4gbmV3IGdlKG4pfSkoZSkpLFt7aWQ6XCJicmFpbnRyZWVhY2hcIn1dKTtjbGFzcyBLZXtjb25zdHJ1Y3RvcihlKXtjb25zdHtlbGVtZW50OnQsY2xvc2VFbGVtZW50OmksbWFpbkVsZW1lbnQ6bn09dGhpcy5fY3JlYXRlRWxlbWVudHMoZSk7dGhpcy5fZWxlbWVudD10LHRoaXMuX2Nsb3NlRWxlbWVudD1pLHRoaXMuX21haW5FbGVtZW50PW59c2hvdyhlKXt0aGlzLl9tYWluRWxlbWVudC5wYXJlbnRFbGVtZW50fHwodGhpcy5fcmVnaXN0ZXJDbGljayhlKSxkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuX21haW5FbGVtZW50KSxzZXRUaW1lb3V0KCgpPT50aGlzLl9lbGVtZW50LnN0eWxlLm9wYWNpdHk9XCIxXCIpKX1yZW1vdmUoKXt0aGlzLl9tYWluRWxlbWVudC5wYXJlbnRFbGVtZW50JiYodGhpcy5fdW5yZWdpc3RlckNsaWNrJiZ0aGlzLl91bnJlZ2lzdGVyQ2xpY2soKSx0aGlzLl9yZW1vdmVBZnRlclRyYW5zaXRpb24oKSxzZXRUaW1lb3V0KCgpPT50aGlzLl9lbGVtZW50LnN0eWxlLm9wYWNpdHk9XCIwXCIpKX1fY3JlYXRlRWxlbWVudHMoZSl7Y29uc3QgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHtiYWNrZ3JvdW5kOmk9XCJyZ2JhKDAsIDAsIDAsIDAuOClcIixpZDpuPVwiY2hlY2tvdXRPdmVybGF5XCIsdHJhbnNpdGlvbkR1cmF0aW9uOnI9NDAwLGhhc0Nsb3NlQnV0dG9uOm89ITEsaW5uZXJIdG1sOmE9bnVsbH09ZXx8e307bGV0IHMsZCxsLGMsdT10O2lmKG4mJih0LmlkPW4pLGEpe2NvbnN0IGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtjPWAke259LS1vdmVybGF5VGV4dGAsZS5jbGFzc05hbWU9YyxlLmFwcGVuZENoaWxkKGEpLHQuYXBwZW5kQ2hpbGQoZSl9cmV0dXJuIG8mJihsPWAke259LS1jbG9zZWAscz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHMuY2xhc3NOYW1lPWwsZD1gJHtufS0tbGF5b3V0YCx1PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksdS5jbGFzc05hbWU9ZCx1LmFwcGVuZENoaWxkKHQpLHUuYXBwZW5kQ2hpbGQocykpLHUuYXBwZW5kQ2hpbGQoZnVuY3Rpb24oZSl7Y29uc3R7aWQ6dCxiYWNrZ3JvdW5kOmksdHJhbnNpdGlvbkR1cmF0aW9uOm4sY2xhc3NMYXlvdXQ6cixjbGFzc092ZXJsYXlUZXh0Om8sY2xhc3NDbG9zZTphfT1lLHM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpLGQ9cj9gLCAuJHtyfWA6XCJcIjtyZXR1cm4gcy5pZD1gJHt0fS0tc3R5bGVzYCxzLnR5cGU9XCJ0ZXh0L2Nzc1wiLHMuaW5uZXJUZXh0PWBcXG4gICAgICAgICMke3R9JHtkfSB7XFxuICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XFxuICAgICAgICAgICAgaGVpZ2h0OiAxMDAlO1xcbiAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xcbiAgICAgICAgICAgIGxlZnQ6IDA7XFxuICAgICAgICAgICAgdG9wOiAwO1xcbiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcXG4gICAgICAgICAgICB6LWluZGV4OiAyMTQ3NDgzNjQ3O1xcbiAgICAgICAgfVxcbiAgICAgICAgIyR7dH0ge1xcbiAgICAgICAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgJHtufW1zIGVhc2Utb3V0O1xcbiAgICAgICAgICAgIGJhY2tncm91bmQ6ICR7aX07XFxuICAgICAgICAgICAgb3BhY2l0eTogMDtcXG4gICAgICAgIH1cXG4gICAgYCxvJiYocy5pbm5lclRleHQrPWBcXG4gICAgICAgICAgICAgIyR7dH0ge1xcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xcbiAgICAgICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xcbiAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcXG4gICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAjJHt0fSAuJHtvfSB7XFxuICAgICAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTtcXG4gICAgICAgICAgICAgICAgbWF4LXdpZHRoOiAzMzBweDtcXG4gICAgICAgICAgICAgICAgZm9udC1zaXplOiAxLjJlbTtcXG4gICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xcbiAgICAgICAgICAgICB9XFxuICAgICAgICBgKSxhJiYocy5pbm5lclRleHQrPWBcXG4gICAgICAgICAgICAjJHt0fSB7XFxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIC4ke3J9IC4ke2F9IHtcXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkO1xcbiAgICAgICAgICAgICAgICByaWdodDogMTZweDtcXG4gICAgICAgICAgICAgICAgdG9wOiAxNnB4O1xcbiAgICAgICAgICAgICAgICB3aWR0aDogMTZweDtcXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAxNnB4O1xcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwLjY7XFxuICAgICAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcXG4gICAgICAgICAgICAgICAgei1pbmRleDogMzE0NzQ4MzY0NztcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgLiR7cn0gLiR7YX06OmFmdGVyLCAuJHtyfSAuJHthfTo6YmVmb3JlIHtcXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgICAgICAgICAgICAgICBsZWZ0OiA4cHg7XFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnO1xcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDE2cHg7XFxuICAgICAgICAgICAgICAgIHdpZHRoOiAycHg7XFxuICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIC4ke3J9IC4ke2F9OjphZnRlciB7XFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKC00NWRlZyk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIC4ke3J9IC4ke2F9OjpiZWZvcmUge1xcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZSg0NWRlZyk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgYCksc30oe2lkOm4sYmFja2dyb3VuZDppLHRyYW5zaXRpb25EdXJhdGlvbjpyLGNsYXNzTGF5b3V0OmQsY2xhc3NPdmVybGF5VGV4dDpjLGNsYXNzQ2xvc2U6bH0pKSx7ZWxlbWVudDp0LGNsb3NlRWxlbWVudDpzLG1haW5FbGVtZW50OnV9fV9hZGRFdmVudExpc3RlbmVyKGUsdCl7ZSYmdCYmZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIix0KX1fcmVtb3ZlRXZlbnRMaXN0ZW5lcihlLHQpe2UmJnQmJmUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsdCl9X3JlZ2lzdGVyQ2xpY2soZSl7aWYodGhpcy5fdW5yZWdpc3RlckNsaWNrJiZ0aGlzLl91bnJlZ2lzdGVyQ2xpY2soKSxlKXtjb25zdHtvbkNsaWNrOnQsb25DbGlja0Nsb3NlOml9PWU7dGhpcy5fYWRkRXZlbnRMaXN0ZW5lcih0aGlzLl9lbGVtZW50LHQpLHRoaXMuX2FkZEV2ZW50TGlzdGVuZXIodGhpcy5fY2xvc2VFbGVtZW50LGkpLHRoaXMuX3VucmVnaXN0ZXJDbGljaz0oKT0+e3RoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5fZWxlbWVudCx0KSx0aGlzLl9yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuX2Nsb3NlRWxlbWVudCxpKSx0aGlzLl91bnJlZ2lzdGVyQ2xpY2s9dm9pZCAwfX19X3JlbW92ZUFmdGVyVHJhbnNpdGlvbigpe2NvbnN0IGU9dD0+e1wib3BhY2l0eVwiPT09dC5wcm9wZXJ0eU5hbWUmJih0aGlzLl9tYWluRWxlbWVudC5wYXJlbnRFbGVtZW50JiZ0aGlzLl9tYWluRWxlbWVudC5yZW1vdmUoKSx0aGlzLl9lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsZSkpfTt0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsZSl9fWNvbnN0IFhlPXtzaXplOjcwLGNvbG9yOlwiI2Q5ZDlkOVwiLGJhY2tncm91bmRDb2xvcjpcIiNmZmZmZmZcIn0sUWU9XCJlbWJlZGRlZC1jaGVja291dC1sb2FkaW5nLWluZGljYXRvci1yb3RhdGlvblwiO2NsYXNzIFple2NvbnN0cnVjdG9yKGUpe3RoaXMuc3R5bGVzPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxYZSksZSYmZS5zdHlsZXMpLHRoaXMuY29udGFpbmVyU3R5bGVzPU9iamVjdC5hc3NpZ24oe30sZSYmZS5jb250YWluZXJTdHlsZXMpLHRoaXMuZGVmaW5lQW5pbWF0aW9uKCksdGhpcy5jb250YWluZXI9dGhpcy5idWlsZENvbnRhaW5lcigpLHRoaXMuaW5kaWNhdG9yPXRoaXMuYnVpbGRJbmRpY2F0b3IoKSx0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmluZGljYXRvcil9c2hvdyhlKXtpZihlKXtjb25zdCB0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGUpO2lmKCF0KXRocm93IG5ldyBFcnJvcihcIlVuYWJsZSB0byBhdHRhY2ggdGhlIGxvYWRpbmcgaW5kaWNhdG9yIGJlY2F1c2UgdGhlIHBhcmVudCBJRCBpcyBub3QgdmFsaWQuXCIpO3QuYXBwZW5kQ2hpbGQodGhpcy5jb250YWluZXIpfXRoaXMuY29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHk9XCJ2aXNpYmxlXCIsdGhpcy5jb250YWluZXIuc3R5bGUub3BhY2l0eT1cIjFcIn1oaWRlKCl7Y29uc3QgZT0oKT0+e3RoaXMuY29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHk9XCJoaWRkZW5cIix0aGlzLmNvbnRhaW5lci5yZW1vdmVFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLGUpfTt0aGlzLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLGUpLHRoaXMuY29udGFpbmVyLnN0eWxlLm9wYWNpdHk9XCIwXCJ9YnVpbGRDb250YWluZXIoKXtjb25zdCBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7cmV0dXJuIGUuc3R5bGUuZGlzcGxheT1cImJsb2NrXCIsZS5zdHlsZS5ib3R0b209XCIwXCIsZS5zdHlsZS5sZWZ0PVwiMFwiLGUuc3R5bGUuaGVpZ2h0PVwiMTAwJVwiLGUuc3R5bGUud2lkdGg9XCIxMDAlXCIsZS5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCIsZS5zdHlsZS5yaWdodD1cIjBcIixlLnN0eWxlLnRvcD1cIjBcIixlLnN0eWxlLnRyYW5zaXRpb249XCJhbGwgMjUwbXMgZWFzZS1vdXRcIixlLnN0eWxlLm9wYWNpdHk9XCIwXCIsdGhpcy5zZXRTdHlsZUF0dHJpYnV0ZShlLHRoaXMuY29udGFpbmVyU3R5bGVzKSxlfWJ1aWxkSW5kaWNhdG9yKCl7Y29uc3QgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3JldHVybiBlLnN0eWxlLmRpc3BsYXk9XCJibG9ja1wiLGUuc3R5bGUud2lkdGg9YCR7dGhpcy5zdHlsZXMuc2l6ZX1weGAsZS5zdHlsZS5oZWlnaHQ9YCR7dGhpcy5zdHlsZXMuc2l6ZX1weGAsZS5zdHlsZS5ib3JkZXJSYWRpdXM9YCR7dGhpcy5zdHlsZXMuc2l6ZX1weGAsZS5zdHlsZS5ib3JkZXI9XCJzb2xpZCAxcHhcIixlLnN0eWxlLmJvcmRlckNvbG9yPWAke3RoaXMuc3R5bGVzLmJhY2tncm91bmRDb2xvcn0gJHt0aGlzLnN0eWxlcy5iYWNrZ3JvdW5kQ29sb3J9ICR7dGhpcy5zdHlsZXMuY29sb3J9ICR7dGhpcy5zdHlsZXMuY29sb3J9YCxlLnN0eWxlLm1hcmdpbj1cIjAgYXV0b1wiLGUuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiLGUuc3R5bGUubGVmdD1cIjBcIixlLnN0eWxlLnJpZ2h0PVwiMFwiLGUuc3R5bGUudG9wPVwiNTAlXCIsZS5zdHlsZS50cmFuc2Zvcm09XCJ0cmFuc2xhdGVZKC01MCUpIHJvdGF0ZSgwZGVnKVwiLGUuc3R5bGUudHJhbnNmb3JtU3R5bGU9XCJwcmVzZXJ2ZS0zZFwiLGUuc3R5bGUuYW5pbWF0aW9uPWAke1FlfSA1MDBtcyBpbmZpbml0ZSBjdWJpYy1iZXppZXIoMC42OSwgMC4zMSwgMC41NiwgMC44MylgLGV9c2V0U3R5bGVBdHRyaWJ1dGUoZSx0KXtPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGk9PntlLnN0eWxlLnNldFByb3BlcnR5KGksdFtpXSl9KX1kZWZpbmVBbmltYXRpb24oKXt2YXIgZTtpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChRZSkpcmV0dXJuO2NvbnN0IHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO3QuaWQ9UWUsbnVsbD09PShlPWRvY3VtZW50LmhlYWQpfHx2b2lkIDA9PT1lfHxlLmFwcGVuZENoaWxkKHQpLHQuc2hlZXQgaW5zdGFuY2VvZiBDU1NTdHlsZVNoZWV0JiZ0LnNoZWV0Lmluc2VydFJ1bGUoYFxcbiAgICAgICAgICAgICAgICBAa2V5ZnJhbWVzICR7UWV9IHtcXG4gICAgICAgICAgICAgICAgICAgIDAlIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpIHJvdGF0ZSgwZGVnKTsgfVxcbiAgICAgICAgICAgICAgICAgICAgMTAwJSB7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKSByb3RhdGUoMzYwZGVnKTsgfVxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgYCwwKX19Y29uc3QgZXQ9e1wiYmFja2dyb3VuZC1jb2xvclwiOlwicmdiYSgwLCAwLCAwLCAwLjQpXCIsXCJ6LWluZGV4XCI6XCIxMDAwXCJ9O3ZhciB0dD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBpdHtjb25zdHJ1Y3RvcihlLHQsaSxuKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT10LHRoaXMuYnJhaW50cmVlTWVzc2FnZXM9aSx0aGlzLmxvYWRpbmdJbmRpY2F0b3I9bix0aGlzLmJyYWludHJlZUhvc3RXaW5kb3c9d2luZG93fWluaXRpYWxpemUoZSl7cmV0dXJuIHR0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWU6dCxtZXRob2RJZDppfT1lO2lmKHRoaXMuYnJhaW50cmVlPXQsdGhpcy5wYXltZW50TWV0aG9kJiZ0aGlzLnBheW1lbnRNZXRob2Qubm9uY2V8fCh0aGlzLnBheW1lbnRNZXRob2Q9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSkpLHRoaXMucGF5bWVudE1ldGhvZC5jbGllbnRUb2tlbiYmKG51bGw9PXQ/dm9pZCAwOnQuYmFubmVyQ29udGFpbmVySWQpKXJldHVybiB5aWVsZCB0aGlzLmxvYWRQYXlwYWwoKSx0aGlzLmxvYWRQYXlwYWxDaGVja291dEluc3RhbmNlKCk7aWYodGhpcy5wYXltZW50TWV0aG9kLmNsaWVudFRva2VuKXJldHVybiB0aGlzLmxvYWRQYXlwYWwoKTtjb25zdCBuPXlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKTtpZih0aGlzLnBheW1lbnRNZXRob2Q9bi5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSxudWxsPT10P3ZvaWQgMDp0LmJhbm5lckNvbnRhaW5lcklkKXJldHVybiB0aGlzLmxvYWRQYXlwYWxDaGVja291dEluc3RhbmNlKCk7aWYoIXRoaXMucGF5bWVudE1ldGhvZC5jbGllbnRUb2tlbil0aHJvdyBuZXcgJChSLk1pc3NpbmdQYXltZW50TWV0aG9kKTtyZXR1cm4gdGhpcy5sb2FkUGF5cGFsKCl9KX1leGVjdXRlKGUsdCl7dmFyIGk7cmV0dXJuIHR0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Om59PWUscj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSkse29uRXJyb3I6b309dGhpcy5icmFpbnRyZWV8fHt9O2lmKCFuKXRocm93IG5ldyBDKFtcInBheW1lbnRcIl0pO3RyeXtjb25zdCBlPXlpZWxkIHRoaXMucHJlcGFyZVBheW1lbnREYXRhKG4sci51c2VTdG9yZUNyZWRpdCk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKHIsdCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoZSl9Y2F0Y2goZSl7dGhpcy5pc1Byb3ZpZGVyRXJyb3IoZSkmJih5aWVsZCB0aGlzLmxvYWRQYXlwYWwoKSxudWxsPT09KGk9dGhpcy5wYXlwYWxCdXR0b25SZW5kZXIpfHx2b2lkIDA9PT1pfHxpLmNsb3NlKCkseWllbGQgdGhpcy5sb2FkUGF5cGFsQ2hlY2tvdXRJbnN0YW5jZSgpLHlpZWxkIG5ldyBQcm9taXNlKChlLHQpPT57byYmXCJmdW5jdGlvblwiPT10eXBlb2YgbyYmbyhuZXcgRXJyb3IoXCJJTlNUUlVNRU5UX0RFQ0xJTkVEXCIpKSx0KCl9KSksdGhpcy5oYW5kbGVFcnJvcihlKX19KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgSGUpfWRlaW5pdGlhbGl6ZSgpe3ZhciBlO3JldHVybiB0aGlzLmJyYWludHJlZVRva2VuaXplUGF5bG9hZD12b2lkIDAsbnVsbD09PShlPXRoaXMucGF5cGFsQnV0dG9uUmVuZGVyKXx8dm9pZCAwPT09ZXx8ZS5jbG9zZSgpLHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRlYXJkb3duKCl9cHJlcGFyZVBheW1lbnREYXRhKGUsdCl7dmFyIGk7cmV0dXJuIHR0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHI9bi5nZXRPdXRzdGFuZGluZ0JhbGFuY2UodCksbz1uLmdldFN0b3JlQ29uZmlnKCk7aWYoIXIpdGhyb3cgbmV3ICQoUi5NaXNzaW5nQ2hlY2tvdXQpO2lmKCFvKXRocm93IG5ldyAkKFIuTWlzc2luZ0NoZWNrb3V0Q29uZmlnKTtpZighdGhpcy5wYXltZW50TWV0aG9kKXRocm93IG5ldyBJKFAuUGF5bWVudE5vdEluaXRpYWxpemVkKTtjb25zdHtjdXJyZW5jeTphLHN0b3JlUHJvZmlsZTp7c3RvcmVMYW5ndWFnZTpzfX09byx7bm9uY2U6ZCxjb25maWc6e2lzVmF1bHRpbmdFbmFibGVkOmx9fT10aGlzLnBheW1lbnRNZXRob2Qse21ldGhvZElkOmMscGF5bWVudERhdGE6dT17fX09ZSxoPShudWxsPT09KGk9dGhpcy5icmFpbnRyZWVUb2tlbml6ZVBheWxvYWQpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLm5vbmNlKXx8ZDtpZihoKXtjb25zdCB0PXlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChjKTtyZXR1cm4gdGhpcy5wYXltZW50TWV0aG9kPXQuZ2V0UGF5bWVudE1ldGhvZChjKSxPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3BheW1lbnREYXRhOnRoaXMuZm9ybWF0dGVkUGF5bG9hZChoKX0pfWlmKFJlKHUpfHwoeT11LEJvb2xlYW4oeS5pbnN0cnVtZW50SWQpJiYhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHksXCJjY051bWJlclwiKSYmIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh5LFwiY2NDdnZcIikpKXtpZighbCl0aHJvdyBuZXcgdyhcIlZhdWx0aW5nIGlzIGRpc2FibGVkIGJ1dCBhIHZhdWx0ZWQgaW5zdHJ1bWVudCB3YXMgYmVpbmcgdXNlZCBmb3IgdGhpcyB0cmFuc2FjdGlvblwiKTtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGUpfXZhciB5O2lmKCFXZSh1KSl0aHJvdyBuZXcgJChSLk1pc3NpbmdQYXltZW50KTtjb25zdHtzaG91bGRTYXZlSW5zdHJ1bWVudDptLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6cH09dTtpZihtJiYhbCl0aHJvdyBuZXcgdyhcIlZhdWx0aW5nIGlzIGRpc2FibGVkIGJ1dCBzaG91bGRTYXZlSW5zdHJ1bWVudCBpcyBzZXQgdG8gdHJ1ZVwiKTtjb25zdCBnPW4uZ2V0U2hpcHBpbmdBZGRyZXNzKCksdj1nP0llKGcpOnZvaWQgMDtyZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnBheXBhbCh7YW1vdW50OnIsbG9jYWxlOnMsY3VycmVuY3k6YS5jb2RlLG9mZmVyQ3JlZGl0OlwiYnJhaW50cmVlcGF5cGFsY3JlZGl0XCI9PT10aGlzLnBheW1lbnRNZXRob2QuaWQsc2hpcHBpbmdBZGRyZXNzT3ZlcnJpZGU6dixzaG91bGRTYXZlSW5zdHJ1bWVudDptfHwhMSxzaGlwcGluZ0FkZHJlc3NFZGl0YWJsZTohMX0pLHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFNlc3Npb25JZCgpXSkudGhlbigoW3tub25jZTp0LGRldGFpbHM6aX09e30sbl0pPT5PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3BheW1lbnREYXRhOnRoaXMuZm9ybWF0dGVkUGF5bG9hZCh0LGkmJmkuZW1haWwsbixtLHApfSkpfSl9Zm9ybWF0dGVkUGF5bG9hZChlLHQsaSxuLHIpe3JldHVybntmb3JtYXR0ZWRQYXlsb2FkOnt2YXVsdF9wYXltZW50X2luc3RydW1lbnQ6bnx8bnVsbCxzZXRfYXNfZGVmYXVsdF9zdG9yZWRfaW5zdHJ1bWVudDpyfHxudWxsLGRldmljZV9pbmZvOml8fG51bGwscGF5cGFsX2FjY291bnQ6e3Rva2VuOmUsZW1haWw6dHx8bnVsbH19fX1sb2FkUGF5cGFsQ2hlY2tvdXRJbnN0YW5jZSgpe3JldHVybiB0dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7Y2xpZW50VG9rZW46ZSxpbml0aWFsaXphdGlvbkRhdGE6dCxpZDppfT10aGlzLnBheW1lbnRNZXRob2R8fHt9O2lmKCFlKXRocm93IG5ldyAkKFIuTWlzc2luZ1BheW1lbnRNZXRob2QpO3RyeXt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKGUpO2NvbnN0IG49e2N1cnJlbmN5OnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZSxpbnRlbnQ6bnVsbD09dD92b2lkIDA6dC5pbnRlbnQsaXNDcmVkaXRFbmFibGVkOm51bGw9PXQ/dm9pZCAwOnQuaXNDcmVkaXRFbmFibGVkfSxyPVwiYnJhaW50cmVlcGF5cGFsY3JlZGl0XCI9PT1pfHwhKG51bGw9PXQ/dm9pZCAwOnQuaXNDcmVkaXRFbmFibGVkKTt5aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRQYXlwYWxDaGVja291dChuLGU9Pnt2YXIgdDtyJiZpJiYobnVsbD09PSh0PXRoaXMuYnJhaW50cmVlKXx8dm9pZCAwPT09dD92b2lkIDA6dC5iYW5uZXJDb250YWluZXJJZCkmJnRoaXMucmVuZGVyUGF5UGFsTWVzc2FnZXMoaSx0aGlzLmJyYWludHJlZS5iYW5uZXJDb250YWluZXJJZCksdGhpcy5yZW5kZXJQYXlQYWxCdXR0b24oZSl9LHRoaXMuaGFuZGxlRXJyb3IpfWNhdGNoKGUpe3RoaXMuaGFuZGxlRXJyb3IoZSl9fSl9cmVuZGVyUGF5UGFsTWVzc2FnZXMoZSx0KXt0aGlzLmJyYWludHJlZU1lc3NhZ2VzLnJlbmRlcihlLHQsRC5QQVlNRU5UKX1yZW5kZXJQYXlQYWxCdXR0b24oZSl7Y29uc3R7b25QYXltZW50RXJyb3I6dCxzdWJtaXRGb3JtOmksb25SZW5kZXJCdXR0b246bixjb250YWluZXJJZDpyLG9uRXJyb3I6b309dGhpcy5icmFpbnRyZWV8fHt9O2lmKCFyKXJldHVybjtpZighdGhpcy5wYXltZW50TWV0aG9kKXRocm93IG5ldyBJKFAuUGF5bWVudE5vdEluaXRpYWxpemVkKTt0aGlzLmxvYWRpbmdJbmRpY2F0b3JDb250YWluZXI9ci5zcGxpdChcIiNcIilbMV07Y29uc3R7aWQ6YSxjb25maWc6e3Rlc3RNb2RlOnN9fT10aGlzLnBheW1lbnRNZXRob2Qse3BheXBhbDpkfT10aGlzLmJyYWludHJlZUhvc3RXaW5kb3csbD1udWxsPT1kP3ZvaWQgMDpkLkZVTkRJTkcuUEFZUEFMO2QmJmw/KHRoaXMucGF5cGFsQnV0dG9uUmVuZGVyPWQuQnV0dG9ucyh7ZW52OnM/XCJzYW5kYm94XCI6XCJwcm9kdWN0aW9uXCIsY29tbWl0OiExLGZ1bmRpbmdTb3VyY2U6bCxvbkNsaWNrOigpPT57dGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCEwKX0sY3JlYXRlT3JkZXI6KCk9PnRoaXMuc2V0dXBQYXltZW50KGUsYSx0KSxvbkFwcHJvdmU6dD0+dHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RoaXMuYnJhaW50cmVlVG9rZW5pemVQYXlsb2FkPXlpZWxkIHRoaXMudG9rZW5pemVQYXltZW50T3JUaHJvdyh0LGUpLGkmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGkmJmkoKX0pLG9uQ2FuY2VsOigpPT57dGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKX0sb25FcnJvcjplPT57dGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKSxudWxsPT1vfHxvKGUpfX0pLG4mJlwiZnVuY3Rpb25cIj09dHlwZW9mIG4mJm4oKSx0aGlzLnBheXBhbEJ1dHRvblJlbmRlci5pc0VsaWdpYmxlKCkmJnRoaXMucGF5cGFsQnV0dG9uUmVuZGVyLnJlbmRlcihgJHtyfWApKTp0aGlzLnJlbW92ZUVsZW1lbnQoci5zcGxpdChcIiNcIilbMV0pfXNldHVwUGF5bWVudChlLHQsaSl7cmV0dXJuIHR0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO3RyeXtjb25zdCBpPW4uZ2V0Q3VzdG9tZXIoKSxyPW4uZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCksbz1uLmdldENoZWNrb3V0T3JUaHJvdygpLm91dHN0YW5kaW5nQmFsYW5jZSxhPW4uZ2V0U3RvcmVDb25maWdPclRocm93KCkuY3VycmVuY3kuY29kZSxzPW4uZ2V0U2hpcHBpbmdBZGRyZXNzKCl8fChudWxsPT1pP3ZvaWQgMDppLmFkZHJlc3Nlc1swXSksZD1zP0llKHMpOnZvaWQgMDtyZXR1cm4geWllbGQgZS5jcmVhdGVQYXltZW50KHtmbG93OlwiY2hlY2tvdXRcIixlbmFibGVTaGlwcGluZ0FkZHJlc3M6ITAsc2hpcHBpbmdBZGRyZXNzRWRpdGFibGU6ITEsc2hpcHBpbmdBZGRyZXNzT3ZlcnJpZGU6ZCxhbW91bnQ6byxjdXJyZW5jeTphLG9mZmVyQ3JlZGl0OiExLGludGVudDpyLmluaXRpYWxpemF0aW9uRGF0YS5pbnRlbnR9KX1jYXRjaChlKXt0aHJvdyBpJiYoRmUoZSl8fGUgaW5zdGFuY2VvZiBmKSYmaShlKSxlfX0pfXRva2VuaXplUGF5bWVudE9yVGhyb3coZSx0LGkpe3JldHVybiB0dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e3JldHVybiB5aWVsZCB0LnRva2VuaXplUGF5bWVudChlKX1jYXRjaChlKXt0aHJvdyBpJiYoRmUoZSl8fGUgaW5zdGFuY2VvZiBmKSYmaShlKSxlfX0pfWxvYWRQYXlwYWwoKXtyZXR1cm4gdHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2NsaWVudFRva2VuOmUsaW5pdGlhbGl6YXRpb25EYXRhOnR9PXRoaXMucGF5bWVudE1ldGhvZHx8e307aWYoIWV8fCF0KXRocm93IG5ldyAkKFIuTWlzc2luZ1BheW1lbnRNZXRob2QpO3RyeXt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKGUpLHlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheXBhbCgpfWNhdGNoKGUpe3RoaXMuaGFuZGxlRXJyb3IoZSl9cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfSl9aGFuZGxlRXJyb3IoZSl7aWYoIUZlKGUpKXRocm93IGU7aWYoXCJQQVlQQUxfUE9QVVBfQ0xPU0VEXCI9PT1lLmNvZGUpdGhyb3cgbmV3IE8oZS5tZXNzYWdlKTt0aHJvdyBuZXcgcWUoZS5tZXNzYWdlKX1pc1Byb3ZpZGVyRXJyb3IoZSl7dmFyIHQsaSxuO3JldHVybiEhZnVuY3Rpb24oZSl7cmV0dXJuXCJvYmplY3RcIj09dHlwZW9mIGUmJm51bGwhPT1lJiZcImVycm9yc1wiaW4gZX0oZSkmJlwiMjA0NlwiPT09KG51bGw9PT0obj1udWxsPT09KGk9KChudWxsPT09KHQ9bnVsbD09ZT92b2lkIDA6ZS5lcnJvcnMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmZpbHRlcihlPT5lLnByb3ZpZGVyX2Vycm9yKSl8fFtdKVswXSl8fHZvaWQgMD09PWk/dm9pZCAwOmkucHJvdmlkZXJfZXJyb3IpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmNvZGUpfXJlbW92ZUVsZW1lbnQoZSl7Y29uc3QgdD1lJiZkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlKTt0JiZ0LnJlbW92ZSgpfXRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoZSl7ZSYmdGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyP3RoaXMubG9hZGluZ0luZGljYXRvci5zaG93KHRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcik6dGhpcy5sb2FkaW5nSW5kaWNhdG9yLmhpZGUoKX19Y29uc3QgbnQ9cShlPT57Y29uc3QgaT13aW5kb3csbj1uZXcgS2Uscj1uZXcgdihlKSxvPW5ldyBWKG5ldyBXKHQoKSxpLHIpLGksbiksYT1uZXcgVGUoZSk7cmV0dXJuIG5ldyBpdChlLG8sYSxuZXcgWmUoe2NvbnRhaW5lclN0eWxlczpldH0pKX0sW3tpZDpcImJyYWludHJlZXBheXBhbFwifSx7aWQ6XCJicmFpbnRyZWVwYXlwYWxjcmVkaXRcIn1dKTt2YXIgcnQ7IWZ1bmN0aW9uKGUpe2UuSnNvbj1cImFwcGxpY2F0aW9uL2pzb25cIixlLkpzb25WMT1cImFwcGxpY2F0aW9uL3ZuZC5iYy52MStqc29uXCJ9KHJ0fHwocnQ9e30pKTtjb25zdCBvdD1ydCxhdD17XCJYLUNoZWNrb3V0LVNESy1WZXJzaW9uXCI6XCIxLjgzNy4yXCJ9O2NsYXNzIHN0e2NvbnN0cnVjdG9yKGUpe3RoaXMucmVxdWVzdFNlbmRlcj1lfWdldE9yZGVyU3RhdHVzKGU9XCJicmFpbnRyZWVsb2NhbG1ldGhvZHNcIix0KXtyZXR1cm4gaT10aGlzLG49dm9pZCAwLG89ZnVuY3Rpb24qKCl7Y29uc3QgaT1gL2FwaS9zdG9yZWZyb250L2luaXRpYWxpemF0aW9uLyR7ZX1gLG49T2JqZWN0LmFzc2lnbih7XCJYLUFQSS1JTlRFUk5BTFwiOlwiVGhpcyBBUEkgZW5kcG9pbnQgaXMgZm9yIGludGVybmFsIHVzZSBvbmx5IGFuZCBtYXkgY2hhbmdlIGluIHRoZSBmdXR1cmVcIixcIkNvbnRlbnQtVHlwZVwiOm90Lkpzb259LGF0KTtyZXR1cm4oeWllbGQgdGhpcy5yZXF1ZXN0U2VuZGVyLmdldChpLE9iamVjdC5hc3NpZ24oe2hlYWRlcnM6bn0sdCkpKS5ib2R5fSxuZXcoKHI9dm9pZCAwKXx8KHI9UHJvbWlzZSkpKGZ1bmN0aW9uKGUsdCl7ZnVuY3Rpb24gYShlKXt0cnl7ZChvLm5leHQoZSkpfWNhdGNoKGUpe3QoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qoby50aHJvdyhlKSl9Y2F0Y2goZSl7dChlKX19ZnVuY3Rpb24gZCh0KXt2YXIgaTt0LmRvbmU/ZSh0LnZhbHVlKTooaT10LnZhbHVlLGkgaW5zdGFuY2VvZiByP2k6bmV3IHIoZnVuY3Rpb24oZSl7ZShpKX0pKS50aGVuKGEscyl9ZCgobz1vLmFwcGx5KGksbnx8W10pKS5uZXh0KCkpfSk7dmFyIGksbixyLG99fWNvbnN0IGR0PXtib2R5Ont9LGhlYWRlcnM6e30sc3RhdHVzOjB9O2NsYXNzIGx0IGV4dGVuZHMgZntjb25zdHJ1Y3RvcihlLHttZXNzYWdlOnQsZXJyb3JzOml9PXt9KXtjb25zdHtib2R5Om4saGVhZGVyczpyLHN0YXR1czpvfT1lfHxkdDtzdXBlcih0fHxcIkFuIHVuZXhwZWN0ZWQgZXJyb3IgaGFzIG9jY3VycmVkLlwiKSx0aGlzLm5hbWU9XCJSZXF1ZXN0RXJyb3JcIix0aGlzLnR5cGU9XCJyZXF1ZXN0XCIsdGhpcy5ib2R5PW4sdGhpcy5oZWFkZXJzPXIsdGhpcy5zdGF0dXM9byx0aGlzLmVycm9ycz1pfHxbXX19Y2xhc3MgY3QgZXh0ZW5kcyBsdHtjb25zdHJ1Y3RvcihlKXtzdXBlcihlLHttZXNzYWdlOlwiVGhlcmUgaXMgYSBwcm9ibGVtIHByb2Nlc3NpbmcgeW91ciBwYXltZW50LiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwifSksdGhpcy5uYW1lPVwiUGF5bWVudE1ldGhvZEludmFsaWRFcnJvclwiLHRoaXMudHlwZT1cInBheW1lbnRfbWV0aG9kX2ludmFsaWRcIn19Y2xhc3MgdXQgZXh0ZW5kcyBsdHtjb25zdHJ1Y3RvcihlKXtzdXBlcihlLHttZXNzYWdlOlwiVGhlIHJlcXVlc3QgaGFzIHRpbWVkIG91dCBvciBhYm9ydGVkLlwifSksdGhpcy5uYW1lPVwiVGltZW91dEVycm9yXCIsdGhpcy50eXBlPVwidGltZW91dFwifX12YXIgaHQ9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgeXR7Y29uc3RydWN0b3IoZSx0LGksbixyPTNlMyxvPTNlNSl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVTZGs9dCx0aGlzLmJyYWludHJlZVJlcXVlc3RTZW5kZXI9aSx0aGlzLmxvYWRpbmdJbmRpY2F0b3I9bix0aGlzLnBvbGxpbmdJbnRlcnZhbD1yLHRoaXMubWF4UG9sbGluZ0ludGVydmFsVGltZT1vLHRoaXMuaXNMUE1zVXBkYXRlRXhwZXJpbWVudEVuYWJsZWQ9ITEsdGhpcy5wb2xsaW5nVGltZXI9MCx0aGlzLnN0b3BQb2xsaW5nPWEsdGhpcy5pc1BvbGxpbmdFbmFibGVkPSExfWluaXRpYWxpemUoZSl7cmV0dXJuIGh0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtnYXRld2F5SWQ6dCxtZXRob2RJZDppLGJyYWludHJlZWxvY2FsbWV0aG9kczpufT1lO2lmKHRoaXMuZ2F0ZXdheUlkPXQsIWkpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuZ2F0ZXdheUlkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZWxvY2FsbWV0aG9kc1wiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt0aGlzLmJyYWludHJlZWxvY2FsbWV0aG9kcz1uLHRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj1uLmNvbnRhaW5lci5zcGxpdChcIiNcIilbMV0seWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKHQpO2NvbnN0IHI9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksbz1yLmdldFBheW1lbnRNZXRob2RPclRocm93KHQpLHtjbGllbnRUb2tlbjphLGNvbmZpZzpzLGluaXRpYWxpemF0aW9uRGF0YTpkfT1vLGw9ci5nZXRTdG9yZUNvbmZpZ09yVGhyb3coKS5jaGVja291dFNldHRpbmdzLmZlYXR1cmVzO2lmKHRoaXMuaXNQb2xsaW5nRW5hYmxlZD15KGwsXCJQQVlQQUwtNTI1OC5icmFpbnRyZWVfbG9jYWxfbWV0aG9kc19wb2xsaW5nXCIpLHRoaXMuaXNMUE1zVXBkYXRlRXhwZXJpbWVudEVuYWJsZWQ9eShsLFwiUEFZUEFMLTQ4NTMuYWRkX25ld19wYXltZW50X2Zsb3dfZm9yX2JyYWludHJlZV9scG1zXCIpLCFhfHwhZHx8IXMubWVyY2hhbnRJZCl0aHJvdyBuZXcgJChSLk1pc3NpbmdQYXltZW50TWV0aG9kKTt0cnl7dGhpcy5icmFpbnRyZWVTZGsuaW5pdGlhbGl6ZShhKSx0aGlzLmlzTm9uSW5zdGFudFBheW1lbnRNZXRob2QoaSl8fCh0aGlzLmJyYWludHJlZUxvY2FsUGF5bWVudD15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXRCcmFpbnRyZWVMb2NhbFBheW1lbnQocy5tZXJjaGFudElkKSl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX19KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgSGUpfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBodCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksUHJvbWlzZS5yZXNvbHZlKCl9KX1leGVjdXRlKGUsdCl7cmV0dXJuIGh0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Oml9PWUsbj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSk7aWYoIWkpdGhyb3cgbmV3IEMoW1wicGF5bWVudFwiXSk7Y29uc3R7bWV0aG9kSWQ6cn09aTt0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITApLHRoaXMuaXNOb25JbnN0YW50UGF5bWVudE1ldGhvZChyKT95aWVsZCB0aGlzLmV4ZWN1dGVXaXRoTm90SW5zdGFudExQTShyKTp5aWVsZCB0aGlzLmV4ZWN1dGVXaXRoSW5zdGFudExQTShyLG4sdCl9KX1leGVjdXRlV2l0aE5vdEluc3RhbnRMUE0oZSl7cmV0dXJuIGh0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7Y29uc3QgdD15aWVsZCB0aGlzLmdldExQTXNCYXNpY1BheW1lbnREYXRhKCk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoe21ldGhvZElkOmUscGF5bWVudERhdGE6T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHQpLHtmb3JtYXR0ZWRQYXlsb2FkOnttZXRob2Q6ZX19KX0pfWNhdGNoKGUpe2lmKHRoaXMuaXNCcmFpbnRyZWVSZWRpcmVjdEVycm9yKGUpKXtjb25zdCB0PWUuYm9keS5hZGRpdGlvbmFsX2FjdGlvbl9yZXF1aXJlZC5kYXRhLnJlZGlyZWN0X3VybDtyZXR1cm4gbmV3IFByb21pc2UoKGUsaSk9Pnt3aW5kb3cubG9jYXRpb24ucmVwbGFjZSh0KSx0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLGkoKX0pfXJldHVybiB0aGlzLmhhbmRsZUVycm9yKGUpLFByb21pc2UucmVqZWN0KGUpfX0pfWV4ZWN1dGVXaXRoSW5zdGFudExQTShlLHQsaSl7cmV0dXJuIGh0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5icmFpbnRyZWVMb2NhbFBheW1lbnQpdGhyb3cgbmV3IGN0O3lpZWxkIG5ldyBQcm9taXNlKChuLHIpPT57dmFyIG87bnVsbD09PShvPXRoaXMuYnJhaW50cmVlTG9jYWxQYXltZW50KXx8dm9pZCAwPT09b3x8by5zdGFydFBheW1lbnQodGhpcy5nZXRJbnN0YW50TFBNQ29uZmlnKGUsdCxpKSx0aGlzLmdldEluc3RhbnRMUE1DYWxsYmFjayhuLHIsZSx0LGkpKX0pfSl9Z2V0TFBNc0Jhc2ljUGF5bWVudERhdGEoKXtyZXR1cm4gaHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2RldmljZURhdGE6ZX09eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0RGF0YUNvbGxlY3Rvck9yVGhyb3coKTtyZXR1cm57ZGV2aWNlU2Vzc2lvbklkOmV9fSl9Z2V0SW5zdGFudExQTUNvbmZpZyhlLHQsaSl7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPW4uZ2V0Q2FydE9yVGhyb3coKSxvPW4uZ2V0QmlsbGluZ0FkZHJlc3NPclRocm93KCkse2ZpcnN0TmFtZTphLGxhc3ROYW1lOnMsY291bnRyeUNvZGU6ZH09byx7Y3VycmVuY3k6bCxlbWFpbDpjLGxpbmVJdGVtczp1fT1yLGg9dS5waHlzaWNhbEl0ZW1zLmxlbmd0aD4wLHk9bi5nZXRDaGVja291dE9yVGhyb3coKS5vdXRzdGFuZGluZ0JhbGFuY2UsbT1uLmdldFN0b3JlQ29uZmlnT3JUaHJvdygpLmxpbmtzLmNoZWNrb3V0TGluaztyZXR1cm57cGF5bWVudFR5cGU6ZSxhbW91bnQ6eSxmYWxsYmFjazp7dXJsOm0sYnV0dG9uVGV4dDpcIkNvbXBsZXRlIFBheW1lbnRcIn0sY3VycmVuY3lDb2RlOmwuY29kZSxzaGlwcGluZ0FkZHJlc3NSZXF1aXJlZDpoLGVtYWlsOmMsZ2l2ZW5OYW1lOmEsc3VybmFtZTpzLGFkZHJlc3M6e2NvdW50cnlDb2RlOmR9LG9uUGF5bWVudFN0YXJ0OihuLHIpPT5odCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuaXNMUE1zVXBkYXRlRXhwZXJpbWVudEVuYWJsZWQpcmV0dXJuIHRoaXMub3JkZXJJZD1uLnBheW1lbnRJZCx2b2lkIHIoKTtjb25zdCBvPXlpZWxkIHRoaXMuZ2V0TFBNc0Jhc2ljUGF5bWVudERhdGEoKSxhPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxvKSx7Zm9ybWF0dGVkUGF5bG9hZDp7bWV0aG9kOmUsW2Ake2V9X2FjY291bnRgXTp7b3JkZXJfaWQ6bi5wYXltZW50SWR9fX0pO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIodCxpKSx5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudCh7bWV0aG9kSWQ6ZSxwYXltZW50RGF0YTphfSl9Y2F0Y2godCl7aWYodGhpcy5pc0JyYWludHJlZU9yZGVyU2F2ZWRSZXNwb25zZSh0KSYmdC5ib2R5LmFkZGl0aW9uYWxfYWN0aW9uX3JlcXVpcmVkLmRhdGEub3JkZXJfaWRfc2F2ZWRfc3VjY2Vzc2Z1bGx5KXJldHVybiByKCksdGhpcy5pc1BvbGxpbmdFbmFibGVkP25ldyBQcm9taXNlKCh0LGkpPT57dGhpcy5pbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbShlLHQsaSx0aGlzLmdhdGV3YXlJZCl9KTp2b2lkIDA7dGhyb3cgdH19KX19Z2V0SW5zdGFudExQTUNhbGxiYWNrKGUsdCxpLG4scil7Y29uc3Qgbz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDYXJ0T3JUaHJvdygpO3JldHVybihhLHMpPT5odCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoYSlyZXR1cm5cIkxPQ0FMX1BBWU1FTlRfV0lORE9XX0NMT1NFRFwiPT09YS5jb2RlPyh0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLHRoaXMucmVzZXRQb2xsaW5nTWVjaGFuaXNtKCksdCgpKToodGhpcy5pc1BvbGxpbmdFbmFibGVkJiZ0aGlzLnJlc2V0UG9sbGluZ01lY2hhbmlzbSgpLHRoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksdChuZXcgY3QpKTtjb25zdCBkPXlpZWxkIHRoaXMuZ2V0TFBNc0Jhc2ljUGF5bWVudERhdGEoKSxsPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxkKSx7Zm9ybWF0dGVkUGF5bG9hZDp7bWV0aG9kOmksW2Ake2l9X2FjY291bnRgXTpPYmplY3QuYXNzaWduKHtlbWFpbDpvLmVtYWlsLHRva2VuOnMubm9uY2V9LHRoaXMuaXNMUE1zVXBkYXRlRXhwZXJpbWVudEVuYWJsZWQ/e306e29yZGVyX2lkOnRoaXMub3JkZXJJZH0pfX0pO3RyeXtyZXR1cm4gdGhpcy5pc0xQTXNVcGRhdGVFeHBlcmltZW50RW5hYmxlZHx8KHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihuLHIpKSx5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudCh7bWV0aG9kSWQ6aSxwYXltZW50RGF0YTpsfSksZSh2b2lkIDApfWNhdGNoKGUpe3JldHVybiB0aGlzLmhhbmRsZUVycm9yKGUpLHQoZSl9fSl9dG9nZ2xlTG9hZGluZ0luZGljYXRvcihlKXtlJiZ0aGlzLmxvYWRpbmdJbmRpY2F0b3JDb250YWluZXI/dGhpcy5sb2FkaW5nSW5kaWNhdG9yLnNob3codGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyKTp0aGlzLmxvYWRpbmdJbmRpY2F0b3IuaGlkZSgpfWhhbmRsZUVycm9yKGUpe2NvbnN0e29uRXJyb3I6dH09dGhpcy5icmFpbnRyZWVsb2NhbG1ldGhvZHN8fHt9O3RoaXMuaXNQb2xsaW5nRW5hYmxlZCYmdGhpcy5yZXNldFBvbGxpbmdNZWNoYW5pc20oKSx0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLHQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQmJnQoZSl9aXNOb25JbnN0YW50UGF5bWVudE1ldGhvZChlKXtyZXR1cm4gZS50b1VwcGVyQ2FzZSgpaW4gbmV9aXNCcmFpbnRyZWVSZWRpcmVjdEVycm9yKGUpe3ZhciB0O2lmKFwib2JqZWN0XCIhPXR5cGVvZiBlfHxudWxsPT09ZSlyZXR1cm4hMTtjb25zdHtib2R5Oml9PWU7cmV0dXJuISFpJiYhIShudWxsPT09KHQ9aS5hZGRpdGlvbmFsX2FjdGlvbl9yZXF1aXJlZCl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuZGF0YS5yZWRpcmVjdF91cmwpfWlzQnJhaW50cmVlT3JkZXJTYXZlZFJlc3BvbnNlKGUpe3ZhciB0O2lmKFwib2JqZWN0XCIhPXR5cGVvZiBlfHxudWxsPT09ZSlyZXR1cm4hMTtjb25zdHtib2R5Oml9PWU7cmV0dXJuISFpJiYobnVsbD09PSh0PWkuYWRkaXRpb25hbF9hY3Rpb25fcmVxdWlyZWQpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmRhdGEuaGFzT3duUHJvcGVydHkoXCJvcmRlcl9pZF9zYXZlZF9zdWNjZXNzZnVsbHlcIikpfWluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKGUsdCxpLG4pe3JldHVybiBodCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgbmV3IFByb21pc2UoKGUsdCk9Pntjb25zdCBpPXNldFRpbWVvdXQoZSx0aGlzLnBvbGxpbmdJbnRlcnZhbCk7dGhpcy5zdG9wUG9sbGluZz0oKT0+KGNsZWFyVGltZW91dChpKSx0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLHQoKSl9KTt0cnl7dGhpcy5wb2xsaW5nVGltZXIrPXRoaXMucG9sbGluZ0ludGVydmFsO2NvbnN0IHI9eWllbGQgdGhpcy5icmFpbnRyZWVSZXF1ZXN0U2VuZGVyLmdldE9yZGVyU3RhdHVzKG4se3BhcmFtczp7dXNlTWV0YWRhdGE6ITF9fSksbz1yLnN0YXR1cz09PWllLlBlbmRpbmcsYT1yLnN0YXR1cz09PWllLkNvbXBsZXRlZCxzPXIuc3RhdHVzPT09aWUuRmFpbGVkO2lmKGEpcmV0dXJuIHRoaXMuZGVpbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbSgpLHQoKTtpZihzKXJldHVybiBpKCk7aWYoIWEmJm8mJnRoaXMucG9sbGluZ1RpbWVyPHRoaXMubWF4UG9sbGluZ0ludGVydmFsVGltZSlyZXR1cm4geWllbGQgdGhpcy5pbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbShlLHQsaSxuKTt5aWVsZCB0aGlzLnJlaW5pdGlhbGl6ZVN0cmF0ZWd5KHttZXRob2RJZDplLGdhdGV3YXlJZDpuLGJyYWludHJlZWxvY2FsbWV0aG9kczp0aGlzLmJyYWludHJlZWxvY2FsbWV0aG9kc30pLHRoaXMuaGFuZGxlRXJyb3IobmV3IHV0KX1jYXRjaChlKXtpKCl9fSl9ZGVpbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbSgpe3RoaXMuc3RvcFBvbGxpbmcoKSx0aGlzLnBvbGxpbmdUaW1lcj0wfXJlc2V0UG9sbGluZ01lY2hhbmlzbSgpe3RoaXMuZGVpbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbSgpfXJlaW5pdGlhbGl6ZVN0cmF0ZWd5KGUpe3JldHVybiBodCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5kZWluaXRpYWxpemUoKSx5aWVsZCB0aGlzLmluaXRpYWxpemUoZSl9KX19Y29uc3QgbXQ9cShlPT57Y29uc3QgaT13aW5kb3csbj1uZXcgdihlKSxyPW5ldyBnZShuZXcgVyh0KCksaSxuKSksbz11KCksYT1uZXcgc3Qobyk7cmV0dXJuIG5ldyB5dChlLHIsYSxuZXcgWmUoe3N0eWxlczp7YmFja2dyb3VuZENvbG9yOlwiYmxhY2tcIn19KSl9LFt7Z2F0ZXdheTpcImJyYWludHJlZWxvY2FsbWV0aG9kc1wifV0pO2Z1bmN0aW9uIHB0KGUpe3JldHVybiEhZSYmKFwiYXV0aGVudGljYXRpb25TdGF0ZVwiaW4gZXx8XCJhZGRyZXNzZXNcImluIGV8fFwiaW5zdHJ1bWVudHNcImluIGUpfXZhciBndD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyB2dHtjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVGYXN0bGFuZVV0aWxzPXQsdGhpcy5icmFpbnRyZWVTZGs9aX1pbml0aWFsaXplKGUpe3ZhciB0O3JldHVybiBndCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6aSxicmFpbnRyZWVmYXN0bGFuZTpufT1lO2lmKCFpKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZWZhc3RsYW5lXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuLm9uSW5pdHx8XCJmdW5jdGlvblwiIT10eXBlb2Ygbi5vbkluaXQpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVlZmFzdGxhbmUub25Jbml0XCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkIG9yIGl0IGlzIG5vdCBhIGZ1bmN0aW9uLicpO2lmKCFuLm9uQ2hhbmdlfHxcImZ1bmN0aW9uXCIhPXR5cGVvZiBuLm9uQ2hhbmdlKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZWZhc3RsYW5lLm9uQ2hhbmdlXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkIG9yIGl0IGlzIG5vdCBhIGZ1bmN0aW9uLicpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKTtjb25zdCByPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG89ci5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSx7aW5pdGlhbGl6YXRpb25EYXRhOmEsY2xpZW50VG9rZW46c309b3x8e30se2lzRmFzdGxhbmVTdHlsaW5nRW5hYmxlZDpkfT1hfHx7fSxsPXkoci5nZXRTdG9yZUNvbmZpZ09yVGhyb3coKS5jaGVja291dFNldHRpbmdzLmZlYXR1cmVzLFwiUFJPSkVDVC03MDgwLmJyYWludHJlZV9mYXN0bGFuZV90aHJlZV9kc1wiKTt0aGlzLmlzM0RTRW5hYmxlZD1vLmNvbmZpZy5pczNkc0VuYWJsZWQscyYmbCYmdGhpcy5icmFpbnRyZWVTZGsuaW5pdGlhbGl6ZShzKTtjb25zdCBjPWVlKGQ/bnVsbD09PSh0PW8uaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09dD92b2lkIDA6dC5mYXN0bGFuZVN0eWxlczp2b2lkIDAsbi5zdHlsZXMpO3lpZWxkIHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5pbml0aWFsaXplQnJhaW50cmVlRmFzdGxhbmVPclRocm93KGksYyksdGhpcy5zaG91bGRSdW5BdXRoZW50aWNhdGlvbkZsb3coKSYmKHlpZWxkIHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5ydW5QYXlQYWxBdXRoZW50aWNhdGlvbkZsb3dPclRocm93KCkpLHlpZWxkIHRoaXMuaW5pdGlhbGl6ZUNhcmRDb21wb25lbnQoKSx0aGlzLm9uRXJyb3I9bi5vbkVycm9yLG4ub25Jbml0KGU9PnRoaXMucmVuZGVyQnJhaW50cmVlQ2FyZENvbXBvbmVudChlKSksbi5vbkNoYW5nZSgoKT0+dGhpcy5oYW5kbGVCcmFpbnRyZWVTdG9yZWRJbnN0cnVtZW50Q2hhbmdlKGkpKX0pfWV4ZWN1dGUoZSx0KXtyZXR1cm4gZ3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6aX09ZSxuPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7cjxuLmxlbmd0aDtyKyspdC5pbmRleE9mKG5bcl0pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bcl0pJiYoaVtuW3JdXT1lW25bcl1dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKTtpZighaSl0aHJvdyBuZXcgQyhbXCJwYXltZW50XCJdKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIobix0KTtjb25zdCByPXlpZWxkIHRoaXMucHJlcGFyZVBheW1lbnRQYXlsb2FkKGkubWV0aG9kSWQpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KHIpLHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5yZW1vdmVTZXNzaW9uSWRGcm9tQ29va2llcygpfSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEhlKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gZ3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmJyYWludHJlZUNhcmRDb21wb25lbnQ9dm9pZCAwLFByb21pc2UucmVzb2x2ZSgpfSl9aW5pdGlhbGl6ZUNhcmRDb21wb25lbnQoKXtyZXR1cm4gZ3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGU9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkse3Bob25lOnQsZmlyc3ROYW1lOmksbGFzdE5hbWU6bn09ZS5nZXRCaWxsaW5nQWRkcmVzc09yVGhyb3coKSxyPWAke2l9ICR7bn1gLG89e3N0eWxlczp7fSxmaWVsZHM6T2JqZWN0LmFzc2lnbih7Y2FyZGhvbGRlck5hbWU6e3ByZWZpbGw6cixlbmFibGVkOiEwfX0sdCYme3Bob25lTnVtYmVyOntwcmVmaWxsOnR9fSl9LGE9dGhpcy5icmFpbnRyZWVGYXN0bGFuZVV0aWxzLmdldEJyYWludHJlZUZhc3RsYW5lQ29tcG9uZW50T3JUaHJvdygpO3RoaXMuYnJhaW50cmVlQ2FyZENvbXBvbmVudD15aWVsZCBhKG8pfSl9cmVuZGVyQnJhaW50cmVlQ2FyZENvbXBvbmVudChlKXtjb25zdCB0PXRoaXMuZ2V0QnJhaW50cmVlQ2FyZENvbXBvbmVudE9yVGhyb3coKTtpZighZSl0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwiY29udGFpbmVyXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3QucmVuZGVyKGUpfXByZXBhcmVQYXltZW50UGF5bG9hZChlKXt2YXIgdCxpO3JldHVybiBndCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPW4uZ2V0QmlsbGluZ0FkZHJlc3NPclRocm93KCksbz1gJHtyLmZpcnN0TmFtZX0gJHtyLmxhc3ROYW1lfWAsYT10aGlzLmdldFBheVBhbEluc3RydW1lbnRzKClbMF0scz15aWVsZCB0aGlzLmJyYWludHJlZUZhc3RsYW5lVXRpbHMuZ2V0RGV2aWNlU2Vzc2lvbklkKCksZD15KG4uZ2V0U3RvcmVDb25maWdPclRocm93KCkuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlcyxcIlBST0pFQ1QtNzA4MC5icmFpbnRyZWVfZmFzdGxhbmVfdGhyZWVfZHNcIik7aWYoYSl7Y29uc3QgdD10aGlzLmlzM0RTRW5hYmxlZCYmZD95aWVsZCB0aGlzLmdldDNEUyhhLmJpZ3BheVRva2VuLChudWxsPT1hP3ZvaWQgMDphLmlpbil8fFwiXCIpOnZvaWQgMDtyZXR1cm57bWV0aG9kSWQ6ZSxwYXltZW50RGF0YTp7ZGV2aWNlU2Vzc2lvbklkOnMsZm9ybWF0dGVkUGF5bG9hZDp7cGF5cGFsX2Zhc3RsYW5lX3Rva2VuOnt0b2tlbjp0fHxhLmJpZ3BheVRva2VufX19fX1jb25zdHtnZXRQYXltZW50VG9rZW46bH09dGhpcy5nZXRCcmFpbnRyZWVDYXJkQ29tcG9uZW50T3JUaHJvdygpLGM9eWllbGQgbCh7bmFtZTp7ZnVsbE5hbWU6b30sYmlsbGluZ0FkZHJlc3M6dGhpcy5tYXBUb1BheVBhbEFkZHJlc3Mocil9KSx1PShudWxsPT09KGk9bnVsbD09PSh0PWMucGF5bWVudFNvdXJjZS5jYXJkKXx8dm9pZCAwPT09dD92b2lkIDA6dC5iaW5EZXRhaWxzKXx8dm9pZCAwPT09aT92b2lkIDA6aS5iaW4pfHxcIlwiLGg9dGhpcy5pczNEU0VuYWJsZWQmJmQ/eWllbGQgdGhpcy5nZXQzRFMoYy5pZCx1KTp2b2lkIDA7cmV0dXJue21ldGhvZElkOmUscGF5bWVudERhdGE6e2RldmljZVNlc3Npb25JZDpzLG5vbmNlOmh8fGMuaWR9fX0pfWdldDNEUyhlLHQpe3JldHVybiBndCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxuPXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldEJyYWludHJlZVRocmVlRFMoKSxyPWkuZ2V0T3JkZXJPclRocm93KCk7cmV0dXJuIG5ldyBQcm9taXNlKChpLG8pPT57bi52ZXJpZnlDYXJkKHthbW91bnQ6bnVsbD09cj92b2lkIDA6ci5vcmRlckFtb3VudCxub25jZTplLGJpbjp0LG9uTG9va3VwQ29tcGxldGU6KGUsdCk9PntuLm9uKFwiY3VzdG9tZXItY2FuY2VsZWRcIiwoKT0+e1wiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXMub25FcnJvciYmdGhpcy5vbkVycm9yKG5ldyBPKSxvKG5ldyBPKX0pLHQoKX19LChlLHQpPT4oZSYmXCJUSFJFRURTX1ZFUklGWV9DQVJEX0NBTkNFTEVEX0JZX01FUkNIQU5UXCI9PT1lLmNvZGUmJihcImZ1bmN0aW9uXCI9PXR5cGVvZiB0aGlzLm9uRXJyb3ImJnRoaXMub25FcnJvcihuZXcgTyksbyhuZXcgTykpLGkodC5ub25jZSkpKX0pfSl9bWFwVG9QYXlQYWxBZGRyZXNzKGUpe3JldHVybntzdHJlZXRBZGRyZXNzOihudWxsPT1lP3ZvaWQgMDplLmFkZHJlc3MxKXx8XCJcIixsb2NhbGl0eToobnVsbD09ZT92b2lkIDA6ZS5jaXR5KXx8XCJcIixyZWdpb246KG51bGw9PWU/dm9pZCAwOmUuc3RhdGVPclByb3ZpbmNlQ29kZSl8fChudWxsPT1lP3ZvaWQgMDplLnN0YXRlT3JQcm92aW5jZSl8fFwiXCIscG9zdGFsQ29kZToobnVsbD09ZT92b2lkIDA6ZS5wb3N0YWxDb2RlKXx8XCJcIixjb3VudHJ5Q29kZUFscGhhMjoobnVsbD09ZT92b2lkIDA6ZS5jb3VudHJ5Q29kZSl8fFwiXCJ9fXNob3VsZFJ1bkF1dGhlbnRpY2F0aW9uRmxvdygpe2NvbnN0IGU9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksdD1lLmdldENhcnRPclRocm93KCksaT1lLmdldEN1c3RvbWVyT3JUaHJvdygpLG49ZS5nZXRQYXltZW50UHJvdmlkZXJDdXN0b21lcigpLHI9cHQobik/bjp7fSxvPXRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5nZXRTZXNzaW9uSWRGcm9tQ29va2llcygpO3JldHVybiEoIWkuaXNHdWVzdHx8KG51bGw9PXI/dm9pZCAwOnIuYXV0aGVudGljYXRpb25TdGF0ZSk9PT1yZS5DQU5DRUxFRHx8KG51bGw9PXI/dm9pZCAwOnIuYXV0aGVudGljYXRpb25TdGF0ZSl8fG8hPT10LmlkKX1nZXRCcmFpbnRyZWVDYXJkQ29tcG9uZW50T3JUaHJvdygpe2lmKCF0aGlzLmJyYWludHJlZUNhcmRDb21wb25lbnQpdGhyb3cgbmV3IGo7cmV0dXJuIHRoaXMuYnJhaW50cmVlQ2FyZENvbXBvbmVudH1nZXRQYXlQYWxJbnN0cnVtZW50cygpe2NvbnN0IGU9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudFByb3ZpZGVyQ3VzdG9tZXJPclRocm93KCk7cmV0dXJuKHB0KGUpP2U6e30pLmluc3RydW1lbnRzfHxbXX1oYW5kbGVCcmFpbnRyZWVTdG9yZWRJbnN0cnVtZW50Q2hhbmdlKGUpe3JldHVybiBndCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLmJyYWludHJlZUZhc3RsYW5lVXRpbHMuZ2V0QnJhaW50cmVlRmFzdGxhbmVPclRocm93KCkse3NlbGVjdGlvbkNoYW5nZWQ6aSxzZWxlY3RlZENhcmQ6bn09eWllbGQgdC5wcm9maWxlLnNob3dDYXJkU2VsZWN0b3IoKTtpZihpKXtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRQcm92aWRlckN1c3RvbWVyKCksaT1wdCh0KT90Ont9LHI9dGhpcy5icmFpbnRyZWVGYXN0bGFuZVV0aWxzLm1hcFBheVBhbFRvQmNJbnN0cnVtZW50KGUsW25dKTtpZihyJiZyLmxlbmd0aD4wKXJldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlUGF5bWVudFByb3ZpZGVyQ3VzdG9tZXIoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGkpLHtpbnN0cnVtZW50czpbLi4ucl19KSksclswXX19KX19Y29uc3QgZnQ9cShlPT57Y29uc3QgaT13aW5kb3csbj1uZXcgdihlKSxyPW5ldyBWKG5ldyBXKHQoKSxpLG4pLGkpLG89bmV3IHllKGUsciksYT1uZXcgVyh0KCksaSxuKSxzPW5ldyBnZShhKTtyZXR1cm4gbmV3IHZ0KGUsbyxzKX0sW3tpZDpcImJyYWludHJlZWFjY2VsZXJhdGVkY2hlY2tvdXRcIn1dKTt2YXIgYnQ9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3Mgd3R7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuZm9ybVBvc3Rlcj10LHRoaXMuYnJhaW50cmVlU2RrPWl9aW5pdGlhbGl6ZShlKXtyZXR1cm4gYnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2JyYWludHJlZXZpc2FjaGVja291dDp0LG1ldGhvZElkOml9PWU7aWYoIXQpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVldmlzYWNoZWNrb3V0XCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKTtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO3RoaXMucGF5bWVudE1ldGhvZD1uLmdldFBheW1lbnRNZXRob2RPclRocm93KGkpO2NvbnN0IHI9bi5nZXRDaGVja291dE9yVGhyb3coKSxvPW4uZ2V0U3RvcmVDb25maWdPclRocm93KCkse2NsaWVudFRva2VuOnMsY29uZmlnOmR9PXRoaXMucGF5bWVudE1ldGhvZHx8e307aWYoIXMpdGhyb3cgbmV3ICQoUi5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3R7b25FcnJvcjpsPWEsb25QYXltZW50U2VsZWN0OmM9YX09dDt0aGlzLmJyYWludHJlZVNkay5pbml0aWFsaXplKHMpO2NvbnN0IHU9eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0QnJhaW50cmVlVmlzYUNoZWNrb3V0KCksaD15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXRWaXNhQ2hlY2tvdXRTZGsobnVsbD09ZD92b2lkIDA6ZC50ZXN0TW9kZSkseT11LmNyZWF0ZUluaXRPcHRpb25zKHtzZXR0aW5nczp7bG9jYWxlOm8uc3RvcmVQcm9maWxlLnN0b3JlTGFuZ3VhZ2Usc2hpcHBpbmc6e2NvbGxlY3RTaGlwcGluZzohMX19LHBheW1lbnRSZXF1ZXN0OntjdXJyZW5jeUNvZGU6by5jdXJyZW5jeS5jb2RlLHN1YnRvdGFsOlN0cmluZyhyLnN1YnRvdGFsKX19KTt5aWVsZCBoLmluaXQoeSksaC5vbihcInBheW1lbnQuc3VjY2Vzc1wiLGU9PnRoaXMudG9rZW5pemVQYXltZW50KHUsZSkudGhlbigoKT0+UHJvbWlzZS5hbGwoW3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkQ2hlY2tvdXQoKSx0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSldKSkudGhlbigoKT0+YygpKS5jYXRjaChlPT5sKGUpKSksaC5vbihcInBheW1lbnQuZXJyb3JcIiwoZSx0KT0+bCh0KSl9KX1leGVjdXRlKGUsdCl7dmFyIGksbjtyZXR1cm4gYnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6cn09ZSxvPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7cjxuLmxlbmd0aDtyKyspdC5pbmRleE9mKG5bcl0pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bcl0pJiYoaVtuW3JdXT1lW25bcl1dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKTtpZighcil0aHJvdyBuZXcgdygnVW5hYmxlIHRvIHN1Ym1pdCBwYXltZW50IGJlY2F1c2UgXCJwYXlsb2FkLnBheW1lbnRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIShudWxsPT09KG49bnVsbD09PShpPXRoaXMucGF5bWVudE1ldGhvZCl8fHZvaWQgMD09PWk/dm9pZCAwOmkuaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09bj92b2lkIDA6bi5ub25jZSkpdGhyb3cgbmV3ICQoUi5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3R7bm9uY2U6YX09dGhpcy5wYXltZW50TWV0aG9kLmluaXRpYWxpemF0aW9uRGF0YTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKG8sdCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHIpLHtwYXltZW50RGF0YTp7bm9uY2U6YX19KSl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX19KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgSGUpfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBidCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZGVpbml0aWFsaXplKCl9KX10b2tlbml6ZVBheW1lbnQoZSx0KXtyZXR1cm4gYnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiBQcm9taXNlLmFsbChbZS50b2tlbml6ZSh0KSx0aGlzLmJyYWludHJlZVNkay5nZXREYXRhQ29sbGVjdG9yT3JUaHJvdygpXSkudGhlbigoW2UsdF0pPT57Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxuPWkuZ2V0U2hpcHBpbmdBZGRyZXNzKCkscj1pLmdldEJpbGxpbmdBZGRyZXNzKCkse3NoaXBwaW5nQWRkcmVzczpvPXRoaXMubWFwVG9WaXNhQ2hlY2tvdXRBZGRyZXNzKG4pLGJpbGxpbmdBZGRyZXNzOmE9dGhpcy5tYXBUb1Zpc2FDaGVja291dEFkZHJlc3Mocil9PWU7cmV0dXJuIHRoaXMucG9zdEZvcm0oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHtzaGlwcGluZ0FkZHJlc3M6byxiaWxsaW5nQWRkcmVzczphfSksdCl9KX0pfW1hcFRvVmlzYUNoZWNrb3V0QWRkcmVzcyhlKXtyZXR1cm4gZT97Zmlyc3ROYW1lOmUuZmlyc3ROYW1lLGxhc3ROYW1lOmUubGFzdE5hbWUscGhvbmVOdW1iZXI6ZS5waG9uZSxzdHJlZXRBZGRyZXNzOmUuYWRkcmVzczEsZXh0ZW5kZWRBZGRyZXNzOmUuYWRkcmVzczIsbG9jYWxpdHk6ZS5jaXR5LHJlZ2lvbjplLnN0YXRlT3JQcm92aW5jZUNvZGUsY291bnRyeUNvZGU6ZS5jb3VudHJ5Q29kZSxwb3N0YWxDb2RlOmUucG9zdGFsQ29kZX06e319cG9zdEZvcm0oZSx0KXtjb25zdHt1c2VyRGF0YTppLGJpbGxpbmdBZGRyZXNzOm4sc2hpcHBpbmdBZGRyZXNzOnIsZGV0YWlsczpvfT1lLHt1c2VyRW1haWw6YX09aSx7ZGV2aWNlRGF0YTpzfT10O3JldHVybiB0aGlzLmZvcm1Qb3N0ZXIucG9zdEZvcm0oXCIvY2hlY2tvdXQucGhwXCIse3BheW1lbnRfdHlwZTplLnR5cGUsbm9uY2U6ZS5ub25jZSxwcm92aWRlcjpcImJyYWludHJlZXZpc2FjaGVja291dFwiLGFjdGlvbjpcInNldF9leHRlcm5hbF9jaGVja291dFwiLGRldmljZV9kYXRhOnMsY2FyZF9pbmZvcm1hdGlvbjpKU09OLnN0cmluZ2lmeSh7dHlwZTpvLmNhcmRUeXBlLG51bWJlcjpvLmxhc3RUd299KSxiaWxsaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkodGhpcy5nZXRBZGRyZXNzKGEsbikpLHNoaXBwaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkodGhpcy5nZXRBZGRyZXNzKGEscikpfSl9Z2V0QWRkcmVzcyhlLHQ9e30pe3JldHVybntlbWFpbDplLGZpcnN0X25hbWU6dC5maXJzdE5hbWUsbGFzdF9uYW1lOnQubGFzdE5hbWUscGhvbmVfbnVtYmVyOnQucGhvbmVOdW1iZXIsYWRkcmVzc19saW5lXzE6dC5zdHJlZXRBZGRyZXNzLGFkZHJlc3NfbGluZV8yOnQuZXh0ZW5kZWRBZGRyZXNzLGNpdHk6dC5sb2NhbGl0eSxzdGF0ZTp0LnJlZ2lvbixjb3VudHJ5X2NvZGU6dC5jb3VudHJ5Q29kZSxwb3N0YWxfY29kZTp0LnBvc3RhbENvZGV9fWhhbmRsZUVycm9yKGUpe2lmKGUgaW5zdGFuY2VvZiBFcnJvciYmXCJCcmFpbnRyZWVFcnJvclwiPT09ZS5uYW1lKXRocm93IG5ldyBxZShlLm1lc3NhZ2UpO3Rocm93IGV9fWNvbnN0IEN0PXEoaT0+e2NvbnN0IG49d2luZG93LHI9bmV3IHYoaSksbz1uZXcgZ2UobmV3IFcodCgpLG4scikpO3JldHVybiBuZXcgd3QoaSxlKCksbyl9LFt7aWQ6XCJicmFpbnRyZWV2aXNhY2hlY2tvdXRcIn1dKTt2YXIgU3Q9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgUHR7Y29uc3RydWN0b3IoZSx0KXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT10fWluaXRpYWxpemUoZSl7cmV0dXJuIFN0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHttZXRob2RJZDp0fT1lO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZCh0KTtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO3RoaXMudmVubW9PcHRpb25zPWUuYnJhaW50cmVldmVubW87Y29uc3Qgbj1pLmdldFBheW1lbnRNZXRob2RPclRocm93KHQpO3lpZWxkIHRoaXMuaW5pdGlhbGl6ZUJyYWludHJlZVZlbm1vKG4pfSl9ZXhlY3V0ZShlKXtyZXR1cm4gU3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6dH09ZSxpPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7cjxuLmxlbmd0aDtyKyspdC5pbmRleE9mKG5bcl0pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bcl0pJiYoaVtuW3JdXT1lW25bcl1dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKTtpZighdCl0aHJvdyBuZXcgQyhbXCJwYXltZW50XCJdKTt0cnl7Y29uc3QgZT15aWVsZCB0aGlzLnByZXBhcmVQYXltZW50RGF0YSh0KTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIoaSkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoZSl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX19KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgSGUpfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBTdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRlYXJkb3duKCksUHJvbWlzZS5yZXNvbHZlKCl9KX1oYW5kbGVFcnJvcihlKXtpZighRihlKSl0aHJvdyBlO2lmKFwiUEFZUEFMX1BPUFVQX0NMT1NFRFwiPT09ZS5jb2RlKXRocm93IG5ldyBPKGUubWVzc2FnZSk7dGhyb3cgbmV3IHFlKGUubWVzc2FnZSl9aW5pdGlhbGl6ZUJyYWludHJlZVZlbm1vKGUpe3ZhciB0O3JldHVybiBTdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7Y2xpZW50VG9rZW46aX09ZTtpZighaSl0aHJvdyBuZXcgJChSLk1pc3NpbmdQYXltZW50TWV0aG9kKTtjb25zdCBuPXkodGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0U3RvcmVDb25maWdPclRocm93KCkuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlcyxcIlBBWVBBTC01NDA2LmJyYWludHJlZV92ZW5tb193ZWJfZmFsbGJhY2tfc3VwcG9ydFwiKTt0cnl7dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuaW5pdGlhbGl6ZShpKSx0aGlzLmJyYWludHJlZVZlbm1vQ2hlY2tvdXQ9eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0VmVubW9DaGVja291dChPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdm9pZCAwIT09KG51bGw9PT0odD10aGlzLnZlbm1vT3B0aW9ucyl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuYWxsb3dEZXNrdG9wKT97YWxsb3dEZXNrdG9wOnRoaXMudmVubW9PcHRpb25zLmFsbG93RGVza3RvcH06e30pLG4/e21vYmlsZVdlYkZhbGxCYWNrOm59Ont9KSl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX19KX1wcmVwYXJlUGF5bWVudERhdGEoZSl7cmV0dXJuIFN0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHtub25jZTppfT10LmdldFBheW1lbnRNZXRob2RPclRocm93KGUubWV0aG9kSWQpO2lmKGkpcmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7cGF5bWVudERhdGE6dGhpcy5mb3JtYXR0ZWRQYXlsb2FkKGkpfSk7Y29uc3Qgbj15aWVsZCB0aGlzLmJyYWludHJlZVZlbm1vVG9rZW5pemUoKSxyPXlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFNlc3Npb25JZCgpO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3BheW1lbnREYXRhOnRoaXMuZm9ybWF0dGVkUGF5bG9hZChuLm5vbmNlLG4uZGV0YWlscy5lbWFpbCxyKX0pfSl9Zm9ybWF0dGVkUGF5bG9hZChlLHQsaSl7cmV0dXJue2Zvcm1hdHRlZFBheWxvYWQ6e3ZhdWx0X3BheW1lbnRfaW5zdHJ1bWVudDpudWxsLHNldF9hc19kZWZhdWx0X3N0b3JlZF9pbnN0cnVtZW50Om51bGwsZGV2aWNlX2luZm86aXx8bnVsbCxwYXlwYWxfYWNjb3VudDp7dG9rZW46ZSxlbWFpbDp0fHxudWxsfX19fWJyYWludHJlZVZlbm1vVG9rZW5pemUoKXtyZXR1cm4gbmV3IFByb21pc2UoKGUsdCk9Pnt2YXIgaTtudWxsPT09KGk9dGhpcy5icmFpbnRyZWVWZW5tb0NoZWNrb3V0KXx8dm9pZCAwPT09aXx8aS50b2tlbml6ZSgoaSxuKT0+e2lmKGkpcmV0dXJuIHQoaSk7ZShuKX0pfSl9fWNvbnN0IEl0PXEoZT0+e2NvbnN0IGk9d2luZG93LG49dCgpLHI9bmV3IHYoZSksbz1uZXcgVyhuLGksciksYT1uZXcgVihvLGkpO3JldHVybiBuZXcgUHQoZSxhKX0sW3tpZDpcImJyYWludHJlZXZlbm1vXCJ9XSk7dmFyIE90PWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIGt0e2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT10LHRoaXMuYnJhaW50cmVlSG9zdGVkRm9ybT1pfWluaXRpYWxpemUoZSl7cmV0dXJuIE90KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHttZXRob2RJZDp0LGdhdGV3YXlJZDppLGJyYWludHJlZTpufT1lO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZCh0KTtjb25zdCByPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO3RoaXMucGF5bWVudE1ldGhvZD1yLmdldFBheW1lbnRNZXRob2RPclRocm93KHQpO2NvbnN0e2NsaWVudFRva2VuOm99PXRoaXMucGF5bWVudE1ldGhvZDtpZighbyl0aHJvdyBuZXcgJChSLk1pc3NpbmdQYXltZW50TWV0aG9kKTt0aGlzLnRocmVlRFNlY3VyZT1udWxsPT1uP3ZvaWQgMDpuLnRocmVlRFNlY3VyZTt0cnl7dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuaW5pdGlhbGl6ZShvLHRoaXMudGhyZWVEU2VjdXJlKSx0aGlzLmlzSG9zdGVkUGF5bWVudEZvcm1FbmFibGVkKHQsaSkmJihudWxsPT1uP3ZvaWQgMDpuLmZvcm0pJiYoeWllbGQgdGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtLmluaXRpYWxpemUobi5mb3JtLG4udW5zdXBwb3J0ZWRDYXJkQnJhbmRzLG8pLHRoaXMuaXNIb3N0ZWRGb3JtSW5pdGlhbGl6ZWQ9dGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtLmlzSW5pdGlhbGl6ZWQoKSksdGhpcy5pczNkc0VuYWJsZWQ9dGhpcy5wYXltZW50TWV0aG9kLmNvbmZpZy5pczNkc0VuYWJsZWQsdGhpcy5kZXZpY2VTZXNzaW9uSWQ9eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U2Vzc2lvbklkKCksdGhpcy5zaG91bGRJbml0aWFsaXplQnJhaW50cmVlRmFzdGxhbmUoKSYmKHlpZWxkIHRoaXMuaW5pdGlhbGl6ZUJyYWludHJlZUZhc3RsYW5lT3JUaHJvdyh0KSl9Y2F0Y2goZSl7cmV0dXJuIHRoaXMuaGFuZGxlRXJyb3IoZSx0KX19KX1leGVjdXRlKGUpe3JldHVybiBPdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cGF5bWVudDp0fT1lLGk9ZnVuY3Rpb24oZSx0KXt2YXIgaT17fTtmb3IodmFyIG4gaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxuKSYmdC5pbmRleE9mKG4pPDAmJihpW25dPWVbbl0pO2lmKG51bGwhPWUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPTA7Zm9yKG49T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtyPG4ubGVuZ3RoO3IrKyl0LmluZGV4T2YobltyXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsbltyXSkmJihpW25bcl1dPWVbbltyXV0pfXJldHVybiBpfShlLFtcInBheW1lbnRcIl0pO2lmKCF0KXRocm93IG5ldyBDKFtcInBheW1lbnRcIl0pO3RoaXMuaXNIb3N0ZWRGb3JtSW5pdGlhbGl6ZWQmJnRoaXMuYnJhaW50cmVlSG9zdGVkRm9ybS52YWxpZGF0ZSgpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihpKTtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHI9bi5nZXRCaWxsaW5nQWRkcmVzc09yVGhyb3coKSxvPW4uZ2V0T3JkZXJPclRocm93KCkub3JkZXJBbW91bnQ7dHJ5e2NvbnN0IGU9dGhpcy5pc0hvc3RlZEZvcm1Jbml0aWFsaXplZD95aWVsZCB0aGlzLnByZXBhcmVIb3N0ZWRQYXltZW50RGF0YSh0LHIsbyk6eWllbGQgdGhpcy5wcmVwYXJlUGF5bWVudERhdGEodCxyLG8pO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7cGF5bWVudERhdGE6ZX0pKX1jYXRjaChlKXtyZXR1cm4gdGhpcy5wcm9jZXNzQWRkaXRpb25hbEFjdGlvbihlLHQsbyl9fSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEhlKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gT3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmlzSG9zdGVkRm9ybUluaXRpYWxpemVkPSExLHlpZWxkIFByb21pc2UuYWxsKFt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS50ZWFyZG93bigpLHRoaXMuYnJhaW50cmVlSG9zdGVkRm9ybS5kZWluaXRpYWxpemUoKV0pLFByb21pc2UucmVzb2x2ZSgpfSl9aGFuZGxlRXJyb3IoZSx0KXtpZihGZShlKSl7aWYoISh0JiZ0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5pc1BheW1lbnRNZXRob2RJbml0aWFsaXplZCh7bWV0aG9kSWQ6dH0pfHxcIkhPU1RFRF9GSUVMRFNfSU5WQUxJRF9GSUVMRF9TRUxFQ1RPUlwiIT09ZS5jb2RlKSlyZXR1cm47dGhyb3cgbmV3IHFlKGUubWVzc2FnZSl9dGhyb3cgZX1wcmVwYXJlUGF5bWVudERhdGEoZSx0LGkpe3JldHVybiBPdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cGF5bWVudERhdGE6bn09ZSxyPXtkZXZpY2VTZXNzaW9uSWQ6dGhpcy5kZXZpY2VTZXNzaW9uSWR9O2lmKHRoaXMuaXNTdWJtaXR0aW5nV2l0aFN0b3JlZENhcmQoZSkpcmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSxuKTtjb25zdHtzaG91bGRTYXZlSW5zdHJ1bWVudDpvPSExLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6YT0hMX09V2Uobik/bjp7fSx7bm9uY2U6c309dGhpcy5zaG91bGRQZXJmb3JtM0RTVmVyaWZpY2F0aW9uKGUpP3lpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnZlcmlmeUNhcmQoZSx0LGkpOnlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRva2VuaXplQ2FyZChlLHQpO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse25vbmNlOnMsc2hvdWxkU2F2ZUluc3RydW1lbnQ6byxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OmF9KX0pfXByZXBhcmVIb3N0ZWRQYXltZW50RGF0YShlLHQsaSl7cmV0dXJuIE90KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50RGF0YTpufT1lLHI9e2RldmljZVNlc3Npb25JZDp0aGlzLmRldmljZVNlc3Npb25JZH07aWYodGhpcy5pc1N1Ym1pdHRpbmdXaXRoU3RvcmVkQ2FyZChlKSl7Y29uc3R7bm9uY2U6ZX09eWllbGQgdGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtLnRva2VuaXplRm9yU3RvcmVkQ2FyZFZlcmlmaWNhdGlvbigpO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSxuKSx7bm9uY2U6ZX0pfWNvbnN0e3Nob3VsZFNhdmVJbnN0cnVtZW50Om89ITEsc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDphPSExfT1XZShuKT9uOnt9LHtub25jZTpzfT10aGlzLnNob3VsZFBlcmZvcm0zRFNWZXJpZmljYXRpb24oZSk/eWllbGQgdGhpcy52ZXJpZnlDYXJkV2l0aEhvc3RlZEZvcm0odCxpKTp5aWVsZCB0aGlzLmJyYWludHJlZUhvc3RlZEZvcm0udG9rZW5pemUodCk7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7c2hvdWxkU2F2ZUluc3RydW1lbnQ6byxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OmEsbm9uY2U6c30pfSl9dmVyaWZ5Q2FyZFdpdGhIb3N0ZWRGb3JtKGUsdCl7cmV0dXJuIE90KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPXlpZWxkIHRoaXMuYnJhaW50cmVlSG9zdGVkRm9ybS50b2tlbml6ZShlKTtyZXR1cm4gdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuY2hhbGxlbmdlM0RTVmVyaWZpY2F0aW9uKGksdCl9KX1wcm9jZXNzQWRkaXRpb25hbEFjdGlvbihlLHQsaSl7cmV0dXJuIE90KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighKGU9Plwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmXCJib2R5XCJpbiBlKShlKXx8IWwoZS5ib2R5LmVycm9ycyx7Y29kZTpcInRocmVlX2Rfc2VjdXJlX3JlcXVpcmVkXCJ9KSlyZXR1cm4gdGhpcy5oYW5kbGVFcnJvcihlKTt0cnl7Y29uc3R7cGF5ZXJfYXV0aF9yZXF1ZXN0Om59PWZ1bmN0aW9uKGUpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmXCJuYW1lXCJpbiBlJiZcImJvZHlcImluIGUmJlwic3RhdHVzXCJpbiBlLmJvZHkmJlwidGhyZWVfZHNfcmVzdWx0XCJpbiBlLmJvZHkmJlwicGF5ZXJfYXV0aF9yZXF1ZXN0XCJpbiBlLmJvZHkudGhyZWVfZHNfcmVzdWx0JiZcImVycm9yc1wiaW4gZS5ib2R5fShlKSYmZS5ib2R5LnRocmVlX2RzX3Jlc3VsdHx8e30se3BheW1lbnREYXRhOnJ9PXQsbz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTtpZighcnx8IVJlKHIpKXRocm93IG5ldyBDKFtcImluc3RydW1lbnRJZFwiXSk7Y29uc3QgYT1vLmdldENhcmRJbnN0cnVtZW50T3JUaHJvdyhyLmluc3RydW1lbnRJZCkse25vbmNlOnN9PXlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmNoYWxsZW5nZTNEU1ZlcmlmaWNhdGlvbih7bm9uY2U6bnx8XCJcIixiaW46YS5paW59LGkpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7cGF5bWVudERhdGE6e2RldmljZVNlc3Npb25JZDp0aGlzLmRldmljZVNlc3Npb25JZCxub25jZTpzfX0pKX1jYXRjaChlKXtyZXR1cm4gdGhpcy5oYW5kbGVFcnJvcihlKX19KX1pc0hvc3RlZFBheW1lbnRGb3JtRW5hYmxlZChlLHQpe3JldHVybiEhZSYmITA9PT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlLHQpLmNvbmZpZy5pc0hvc3RlZEZvcm1FbmFibGVkfWlzU3VibWl0dGluZ1dpdGhTdG9yZWRDYXJkKGUpe3JldHVybiEoIWUucGF5bWVudERhdGF8fCFSZShlLnBheW1lbnREYXRhKSl9c2hvdWxkUGVyZm9ybTNEU1ZlcmlmaWNhdGlvbihlKXtyZXR1cm4hKCF0aGlzLmlzM2RzRW5hYmxlZHx8dGhpcy5pc1N1Ym1pdHRpbmdXaXRoU3RvcmVkQ2FyZChlKSl9c2hvdWxkSW5pdGlhbGl6ZUJyYWludHJlZUZhc3RsYW5lKCl7dmFyIGU7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50UHJvdmlkZXJDdXN0b21lck9yVGhyb3coKSxpPXB0KHQpP3Q6e307cmV0dXJuKG51bGw9PT0oZT10aGlzLnBheW1lbnRNZXRob2QpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLmluaXRpYWxpemF0aW9uRGF0YS5pc0FjY2VsZXJhdGVkQ2hlY2tvdXRFbmFibGVkKSYmIShudWxsPT1pP3ZvaWQgMDppLmF1dGhlbnRpY2F0aW9uU3RhdGUpfWluaXRpYWxpemVCcmFpbnRyZWVGYXN0bGFuZU9yVGhyb3coZSl7cmV0dXJuIE90KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLGk9dC5nZXRDYXJ0T3JUaHJvdygpLG49dC5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKSx7Y2xpZW50VG9rZW46cixjb25maWc6b309bjtpZighcil0aHJvdyBuZXcgJChSLk1pc3NpbmdQYXltZW50TWV0aG9kKTt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKHIsdGhpcy50aHJlZURTZWN1cmUpLHlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldEJyYWludHJlZUZhc3RsYW5lKGkuaWQsby50ZXN0TW9kZSl9KX19ZnVuY3Rpb24gRXQoZSl7cmV0dXJuXCJjYXJkTnVtYmVyXCJpbiBlfWZ1bmN0aW9uIFR0KGUpe2lmKCFGKGUpKXJldHVybiExO2NvbnN0e2RldGFpbHM6dH09ZTtyZXR1cm4gdm9pZCAwPT09dHx8XCJvYmplY3RcIj09dHlwZW9mIHQmJm51bGwhPT10JiZ2b2lkIDA9PT10LmludmFsaWRGaWVsZEtleXN8fChpPXQsQXJyYXkuaXNBcnJheShpKSYmaS5ldmVyeShlPT5cInN0cmluZ1wiPT10eXBlb2YgZSkpO3ZhciBpfXZhciBBdCx6dD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTshZnVuY3Rpb24oZSl7ZVtlLkNyZWRpdENhcmQ9MF09XCJDcmVkaXRDYXJkXCIsZVtlLlN0b3JlZENhcmRWZXJpZmljYXRpb249MV09XCJTdG9yZWRDYXJkVmVyaWZpY2F0aW9uXCJ9KEF0fHwoQXQ9e30pKTtjbGFzcyBOdHtjb25zdHJ1Y3RvcihlLHQpe3RoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyPWUsdGhpcy5icmFpbnRyZWVTREtWZXJzaW9uTWFuYWdlcj10LHRoaXMuaXNJbml0aWFsaXplZEhvc3RlZEZvcm09ITEsdGhpcy5oYW5kbGVCbHVyPWU9Pnt2YXIgdCxpO251bGw9PT0oaT1udWxsPT09KHQ9dGhpcy5mb3JtT3B0aW9ucyl8fHZvaWQgMD09PXQ/dm9pZCAwOnQub25CbHVyKXx8dm9pZCAwPT09aXx8aS5jYWxsKHQse2ZpZWxkVHlwZTp0aGlzLm1hcEZpZWxkVHlwZShlLmVtaXR0ZWRCeSksZXJyb3JzOnRoaXMubWFwRXJyb3JzKGUuZmllbGRzKX0pfSx0aGlzLmhhbmRsZUZvY3VzPWU9Pnt2YXIgdCxpO251bGw9PT0oaT1udWxsPT09KHQ9dGhpcy5mb3JtT3B0aW9ucyl8fHZvaWQgMD09PXQ/dm9pZCAwOnQub25Gb2N1cyl8fHZvaWQgMD09PWl8fGkuY2FsbCh0LHtmaWVsZFR5cGU6dGhpcy5tYXBGaWVsZFR5cGUoZS5lbWl0dGVkQnkpfSl9LHRoaXMuaGFuZGxlQ2FyZFR5cGVDaGFuZ2U9ZT0+e3ZhciB0LGk7Y29uc3Qgbj0xPT09ZS5jYXJkcy5sZW5ndGg/ZS5jYXJkc1swXS50eXBlLnJlcGxhY2UoL15tYXN0ZXItY2FyZCQvLFwibWFzdGVyY2FyZFwiKTp2b2lkIDA7bnVsbD09PShpPW51bGw9PT0odD10aGlzLmZvcm1PcHRpb25zKXx8dm9pZCAwPT09dD92b2lkIDA6dC5vbkNhcmRUeXBlQ2hhbmdlKXx8dm9pZCAwPT09aXx8aS5jYWxsKHQse2NhcmRUeXBlOm59KX0sdGhpcy5oYW5kbGVJbnB1dFN1Ym1pdFJlcXVlc3Q9ZT0+e3ZhciB0LGk7bnVsbD09PShpPW51bGw9PT0odD10aGlzLmZvcm1PcHRpb25zKXx8dm9pZCAwPT09dD92b2lkIDA6dC5vbkVudGVyKXx8dm9pZCAwPT09aXx8aS5jYWxsKHQse2ZpZWxkVHlwZTp0aGlzLm1hcEZpZWxkVHlwZShlLmVtaXR0ZWRCeSl9KX0sdGhpcy5oYW5kbGVWYWxpZGl0eUNoYW5nZT1lPT57dmFyIHQsaTtudWxsPT09KGk9bnVsbD09PSh0PXRoaXMuZm9ybU9wdGlvbnMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0Lm9uVmFsaWRhdGUpfHx2b2lkIDA9PT1pfHxpLmNhbGwodCx7aXNWYWxpZDp0aGlzLmlzVmFsaWRGb3JtKGUpLGVycm9yczp0aGlzLm1hcFZhbGlkYXRpb25FcnJvcnMoZS5maWVsZHMpfSl9fWluaXRpYWxpemUoZSx0LGkpe3ZhciByLG8sYSxzLGQ7cmV0dXJuIHp0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0aGlzLmNsaWVudFRva2VuPWksdGhpcy5mb3JtT3B0aW9ucz1lLHRoaXMudHlwZT1FdChlLmZpZWxkcyk/QXQuQ3JlZGl0Q2FyZDpBdC5TdG9yZWRDYXJkVmVyaWZpY2F0aW9uO2NvbnN0IGw9dGhpcy5tYXBGaWVsZE9wdGlvbnMoZS5maWVsZHMsdCk7bihsKT90aGlzLmlzSW5pdGlhbGl6ZWRIb3N0ZWRGb3JtPSExOih0aGlzLmNhcmRGaWVsZHM9eWllbGQgdGhpcy5jcmVhdGVIb3N0ZWRGaWVsZHMoe2ZpZWxkczpsLHN0eWxlczplLnN0eWxlcyYmdGhpcy5tYXBTdHlsZU9wdGlvbnMoZS5zdHlsZXMpfSksbnVsbD09PShyPXRoaXMuY2FyZEZpZWxkcyl8fHZvaWQgMD09PXJ8fHIub24oXCJibHVyXCIsdGhpcy5oYW5kbGVCbHVyKSxudWxsPT09KG89dGhpcy5jYXJkRmllbGRzKXx8dm9pZCAwPT09b3x8by5vbihcImZvY3VzXCIsdGhpcy5oYW5kbGVGb2N1cyksbnVsbD09PShhPXRoaXMuY2FyZEZpZWxkcyl8fHZvaWQgMD09PWF8fGEub24oXCJjYXJkVHlwZUNoYW5nZVwiLHRoaXMuaGFuZGxlQ2FyZFR5cGVDaGFuZ2UpLG51bGw9PT0ocz10aGlzLmNhcmRGaWVsZHMpfHx2b2lkIDA9PT1zfHxzLm9uKFwidmFsaWRpdHlDaGFuZ2VcIix0aGlzLmhhbmRsZVZhbGlkaXR5Q2hhbmdlKSxudWxsPT09KGQ9dGhpcy5jYXJkRmllbGRzKXx8dm9pZCAwPT09ZHx8ZC5vbihcImlucHV0U3VibWl0UmVxdWVzdFwiLHRoaXMuaGFuZGxlSW5wdXRTdWJtaXRSZXF1ZXN0KSx0aGlzLmlzSW5pdGlhbGl6ZWRIb3N0ZWRGb3JtPSEwKX0pfWlzSW5pdGlhbGl6ZWQoKXtyZXR1cm4hIXRoaXMuaXNJbml0aWFsaXplZEhvc3RlZEZvcm19ZGVpbml0aWFsaXplKCl7dmFyIGU7cmV0dXJuIHp0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0aGlzLmlzSW5pdGlhbGl6ZWRIb3N0ZWRGb3JtJiYodGhpcy5pc0luaXRpYWxpemVkSG9zdGVkRm9ybT0hMSx5aWVsZCBudWxsPT09KGU9dGhpcy5jYXJkRmllbGRzKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS50ZWFyZG93bigpKX0pfXZhbGlkYXRlKCl7aWYoIXRoaXMuY2FyZEZpZWxkcyl0aHJvdyBuZXcgSShQLlBheW1lbnROb3RJbml0aWFsaXplZCk7Y29uc3QgZT10aGlzLmNhcmRGaWVsZHMuZ2V0U3RhdGUoKTtpZighdGhpcy5pc1ZhbGlkRm9ybShlKSl7dGhpcy5oYW5kbGVWYWxpZGl0eUNoYW5nZShlKTtjb25zdCB0PXRoaXMubWFwVmFsaWRhdGlvbkVycm9ycyhlLmZpZWxkcyk7dGhyb3cgbmV3IFModCl9fXRva2VuaXplKGUpe3ZhciB0LGksbixyLGE7cmV0dXJuIHp0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5jYXJkRmllbGRzKXRocm93IG5ldyBJKFAuUGF5bWVudE5vdEluaXRpYWxpemVkKTt0cnl7Y29uc3Qgcj15aWVsZCB0aGlzLmNhcmRGaWVsZHMudG9rZW5pemUoZCh7YmlsbGluZ0FkZHJlc3M6ZSYmdGhpcy5tYXBCaWxsaW5nQWRkcmVzcyhlKX0sbykpO3JldHVybiBudWxsPT09KGk9bnVsbD09PSh0PXRoaXMuZm9ybU9wdGlvbnMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0Lm9uVmFsaWRhdGUpfHx2b2lkIDA9PT1pfHxpLmNhbGwodCx7aXNWYWxpZDohMCxlcnJvcnM6e319KSx7bm9uY2U6ci5ub25jZSxiaW46bnVsbD09PShuPXIuZGV0YWlscyl8fHZvaWQgMD09PW4/dm9pZCAwOm4uYmlufX1jYXRjaChlKXtpZihUdChlKSl7Y29uc3QgdD10aGlzLm1hcFRva2VuaXplRXJyb3IoZSk7aWYodCl0aHJvdyBudWxsPT09KGE9bnVsbD09PShyPXRoaXMuZm9ybU9wdGlvbnMpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLm9uVmFsaWRhdGUpfHx2b2lkIDA9PT1hfHxhLmNhbGwocix7aXNWYWxpZDohMSxlcnJvcnM6dH0pLG5ldyBTKHQpfXRocm93IGV9fSl9dG9rZW5pemVGb3JTdG9yZWRDYXJkVmVyaWZpY2F0aW9uKCl7dmFyIGUsdCxpLG4scjtyZXR1cm4genQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLmNhcmRGaWVsZHMpdGhyb3cgbmV3IEkoUC5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO3RyeXtjb25zdCBuPXlpZWxkIHRoaXMuY2FyZEZpZWxkcy50b2tlbml6ZSgpO3JldHVybiBudWxsPT09KHQ9bnVsbD09PShlPXRoaXMuZm9ybU9wdGlvbnMpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLm9uVmFsaWRhdGUpfHx2b2lkIDA9PT10fHx0LmNhbGwoZSx7aXNWYWxpZDohMCxlcnJvcnM6e319KSx7bm9uY2U6bi5ub25jZSxiaW46bnVsbD09PShpPW4uZGV0YWlscyl8fHZvaWQgMD09PWk/dm9pZCAwOmkuYmlufX1jYXRjaChlKXtpZihUdChlKSl7Y29uc3QgdD10aGlzLm1hcFRva2VuaXplRXJyb3IoZSwhMCk7aWYodCl0aHJvdyBudWxsPT09KHI9bnVsbD09PShuPXRoaXMuZm9ybU9wdGlvbnMpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLm9uVmFsaWRhdGUpfHx2b2lkIDA9PT1yfHxyLmNhbGwobix7aXNWYWxpZDohMSxlcnJvcnM6dH0pLG5ldyBTKHQpfXRocm93IGV9fSl9Y3JlYXRlSG9zdGVkRmllbGRzKGUpe3JldHVybiB6dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD15aWVsZCB0aGlzLmdldENsaWVudCgpLGk9eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZEhvc3RlZEZpZWxkcygpLG49dGhpcy5icmFpbnRyZWVTREtWZXJzaW9uTWFuYWdlci5nZXRTREtWZXJzaW9uKCk9PT1tP09iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7cHJldmVudEN1cnNvckp1bXBzOiEwfSk6ZTtyZXR1cm4gaS5jcmVhdGUoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LG4pLHtjbGllbnQ6dH0pKX0pfWdldENsaWVudCgpe3JldHVybiB6dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuY2xpZW50VG9rZW4pdGhyb3cgbmV3IEkoUC5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO2lmKCF0aGlzLmNsaWVudCl7Y29uc3QgZT15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkQ2xpZW50KCk7dGhpcy5jbGllbnQ9ZS5jcmVhdGUoe2F1dGhvcml6YXRpb246dGhpcy5jbGllbnRUb2tlbn0pfXJldHVybiB0aGlzLmNsaWVudH0pfW1hcEJpbGxpbmdBZGRyZXNzKGUpe3JldHVybntjb3VudHJ5TmFtZTplLmNvdW50cnkscG9zdGFsQ29kZTplLnBvc3RhbENvZGUsc3RyZWV0QWRkcmVzczplLmFkZHJlc3MyP2Ake2UuYWRkcmVzczF9ICR7ZS5hZGRyZXNzMn1gOmUuYWRkcmVzczF9fW1hcEZpZWxkT3B0aW9ucyhlLHQpe2lmKEV0KGUpKXtjb25zdCBpPXt9O3JldHVybiBudWxsPT10fHx0LmZvckVhY2goZT0+eyhlPT5PYmplY3QudmFsdWVzKHNlKS5pbmNsdWRlcyhlKSkoZSkmJihpW2VdPSExKX0pLGQoe251bWJlcjpPYmplY3QuYXNzaWduKHtjb250YWluZXI6YCMke2UuY2FyZE51bWJlci5jb250YWluZXJJZH1gLHBsYWNlaG9sZGVyOmUuY2FyZE51bWJlci5wbGFjZWhvbGRlcixpbnRlcm5hbExhYmVsOmUuY2FyZE51bWJlci5hY2Nlc3NpYmlsaXR5TGFiZWx9LE9iamVjdC5rZXlzKGkpLmxlbmd0aD4wP3tzdXBwb3J0ZWRDYXJkQnJhbmRzOml9Ont9KSxleHBpcmF0aW9uRGF0ZTp7Y29udGFpbmVyOmAjJHtlLmNhcmRFeHBpcnkuY29udGFpbmVySWR9YCxwbGFjZWhvbGRlcjplLmNhcmRFeHBpcnkucGxhY2Vob2xkZXIsaW50ZXJuYWxMYWJlbDplLmNhcmRFeHBpcnkuYWNjZXNzaWJpbGl0eUxhYmVsfSxjdnY6ZS5jYXJkQ29kZSYme2NvbnRhaW5lcjpgIyR7ZS5jYXJkQ29kZS5jb250YWluZXJJZH1gLHBsYWNlaG9sZGVyOmUuY2FyZENvZGUucGxhY2Vob2xkZXIsaW50ZXJuYWxMYWJlbDplLmNhcmRDb2RlLmFjY2Vzc2liaWxpdHlMYWJlbH0sY2FyZGhvbGRlck5hbWU6e2NvbnRhaW5lcjpgIyR7ZS5jYXJkTmFtZS5jb250YWluZXJJZH1gLHBsYWNlaG9sZGVyOmUuY2FyZE5hbWUucGxhY2Vob2xkZXIsaW50ZXJuYWxMYWJlbDplLmNhcmROYW1lLmFjY2Vzc2liaWxpdHlMYWJlbH19LG8pfXJldHVybiBkKHtudW1iZXI6ZS5jYXJkTnVtYmVyVmVyaWZpY2F0aW9uJiZ7Y29udGFpbmVyOmAjJHtlLmNhcmROdW1iZXJWZXJpZmljYXRpb24uY29udGFpbmVySWR9YCxwbGFjZWhvbGRlcjplLmNhcmROdW1iZXJWZXJpZmljYXRpb24ucGxhY2Vob2xkZXJ9LGN2djplLmNhcmRDb2RlVmVyaWZpY2F0aW9uJiZ7Y29udGFpbmVyOmAjJHtlLmNhcmRDb2RlVmVyaWZpY2F0aW9uLmNvbnRhaW5lcklkfWAscGxhY2Vob2xkZXI6ZS5jYXJkQ29kZVZlcmlmaWNhdGlvbi5wbGFjZWhvbGRlcn19LG8pfW1hcFN0eWxlT3B0aW9ucyhlKXtjb25zdCB0PShlPXt9KT0+ZCh7Y29sb3I6ZS5jb2xvcixcImZvbnQtZmFtaWx5XCI6ZS5mb250RmFtaWx5LFwiZm9udC1zaXplXCI6ZS5mb250U2l6ZSxcImZvbnQtd2VpZ2h0XCI6ZS5mb250V2VpZ2h0fSxvKTtyZXR1cm57aW5wdXQ6dChlLmRlZmF1bHQpLFwiLmludmFsaWRcIjp0KGUuZXJyb3IpLFwiOmZvY3VzXCI6dChlLmZvY3VzKX19bWFwRmllbGRUeXBlKGUpe3N3aXRjaChlKXtjYXNlXCJudW1iZXJcIjpyZXR1cm4gdGhpcy50eXBlPT09QXQuU3RvcmVkQ2FyZFZlcmlmaWNhdGlvbj94LkNhcmROdW1iZXJWZXJpZmljYXRpb246eC5DYXJkTnVtYmVyO2Nhc2VcImV4cGlyYXRpb25EYXRlXCI6cmV0dXJuIHguQ2FyZEV4cGlyeTtjYXNlXCJjdnZcIjpyZXR1cm4gdGhpcy50eXBlPT09QXQuU3RvcmVkQ2FyZFZlcmlmaWNhdGlvbj94LkNhcmRDb2RlVmVyaWZpY2F0aW9uOnguQ2FyZENvZGU7Y2FzZVwiY2FyZGhvbGRlck5hbWVcIjpyZXR1cm4geC5DYXJkTmFtZTtkZWZhdWx0OnRocm93IG5ldyBFcnJvcihcIlVuZXhwZWN0ZWQgZmllbGQgdHlwZVwiKX19bWFwRXJyb3JzKGUpe2NvbnN0IHQ9e307aWYoZSlmb3IoY29uc3RbaSxuXW9mIE9iamVjdC5lbnRyaWVzKGUpKWlmKG4mJnRoaXMuaXNWYWxpZFBhcmFtKGkpKXtjb25zdHtpc1ZhbGlkOmUsaXNFbXB0eTpyLGlzUG90ZW50aWFsbHlWYWxpZDpvfT1uO3RbaV09e2lzVmFsaWQ6ZSxpc0VtcHR5OnIsaXNQb3RlbnRpYWxseVZhbGlkOm99fXJldHVybiB0fW1hcFZhbGlkYXRpb25FcnJvcnMoZSl7cmV0dXJuIE9iamVjdC5rZXlzKGUpLnJlZHVjZSgodCxpKT0+e3ZhciBuO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse1t0aGlzLm1hcEZpZWxkVHlwZShpKV06KG51bGw9PT0obj1lW2ldKXx8dm9pZCAwPT09bj92b2lkIDA6bi5pc1ZhbGlkKT92b2lkIDA6W3RoaXMuY3JlYXRlSW52YWxpZEVycm9yKHRoaXMubWFwRmllbGRUeXBlKGkpKV19KX0se30pfW1hcFRva2VuaXplRXJyb3IoZSx0PSExKXt2YXIgaSxuO2lmKFwiSE9TVEVEX0ZJRUxEU19GSUVMRFNfRU1QVFlcIj09PWUuY29kZSl7Y29uc3QgZT1bdGhpcy5jcmVhdGVSZXF1aXJlZEVycm9yKHRoaXMubWFwRmllbGRUeXBlKFwiY3Z2XCIpKV07cmV0dXJuIHQ/e1t0aGlzLm1hcEZpZWxkVHlwZShcImN2dlwiKV06ZX06e1t0aGlzLm1hcEZpZWxkVHlwZShcImN2dlwiKV06ZSxbdGhpcy5tYXBGaWVsZFR5cGUoXCJleHBpcmF0aW9uRGF0ZVwiKV06W3RoaXMuY3JlYXRlUmVxdWlyZWRFcnJvcih0aGlzLm1hcEZpZWxkVHlwZShcImV4cGlyYXRpb25EYXRlXCIpKV0sW3RoaXMubWFwRmllbGRUeXBlKFwibnVtYmVyXCIpXTpbdGhpcy5jcmVhdGVSZXF1aXJlZEVycm9yKHRoaXMubWFwRmllbGRUeXBlKFwibnVtYmVyXCIpKV0sW3RoaXMubWFwRmllbGRUeXBlKFwiY2FyZGhvbGRlck5hbWVcIildOlt0aGlzLmNyZWF0ZVJlcXVpcmVkRXJyb3IodGhpcy5tYXBGaWVsZFR5cGUoXCJjYXJkaG9sZGVyTmFtZVwiKSldfX1yZXR1cm4gbnVsbD09PShuPW51bGw9PT0oaT1lLmRldGFpbHMpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmludmFsaWRGaWVsZEtleXMpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLnJlZHVjZSgoZSx0KT0+e2NvbnN0IGk9dGhpcy5tYXBGaWVsZFR5cGUodCk7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7W2ldOlt0aGlzLmNyZWF0ZUludmFsaWRFcnJvcihpKV19KX0se30pfWNyZWF0ZVJlcXVpcmVkRXJyb3IoZSl7dmFyIHQ7cmV0dXJue2ZpZWxkVHlwZTplLG1lc3NhZ2U6bnVsbCE9PSh0PXtbeC5DYXJkQ29kZV06XCJDVlYgaXMgcmVxdWlyZWRcIixbeC5DYXJkQ29kZVZlcmlmaWNhdGlvbl06XCJDVlYgaXMgcmVxdWlyZWRcIixbeC5DYXJkTnVtYmVyXTpcIkNyZWRpdCBjYXJkIG51bWJlciBpcyByZXF1aXJlZFwiLFt4LkNhcmROdW1iZXJWZXJpZmljYXRpb25dOlwiQ3JlZGl0IGNhcmQgbnVtYmVyIGlzIHJlcXVpcmVkXCIsW3guQ2FyZEV4cGlyeV06XCJFeHBpcmF0aW9uIGRhdGUgaXMgcmVxdWlyZWRcIixbeC5DYXJkTmFtZV06XCJGdWxsIG5hbWUgaXMgcmVxdWlyZWRcIn1bZV0pJiZ2b2lkIDAhPT10P3Q6XCJGaWVsZCBpcyByZXF1aXJlZFwiLHR5cGU6XCJyZXF1aXJlZFwifX1jcmVhdGVJbnZhbGlkRXJyb3IoZSl7dmFyIHQsaSxuLHI7Y29uc3Qgbz17W3guQ2FyZENvZGVdOnttZXNzYWdlOlwiSW52YWxpZCBjYXJkIGNvZGVcIix0eXBlOlwiaW52YWxpZF9jYXJkX2NvZGVcIn0sW3guQ2FyZENvZGVWZXJpZmljYXRpb25dOnttZXNzYWdlOlwiSW52YWxpZCBjYXJkIGNvZGVcIix0eXBlOlwiaW52YWxpZF9jYXJkX2NvZGVcIn0sW3guQ2FyZE51bWJlcl06e21lc3NhZ2U6XCJJbnZhbGlkIGNhcmQgbnVtYmVyXCIsdHlwZTpcImludmFsaWRfY2FyZF9udW1iZXJcIn0sW3guQ2FyZE51bWJlclZlcmlmaWNhdGlvbl06e21lc3NhZ2U6XCJJbnZhbGlkIGNhcmQgbnVtYmVyXCIsdHlwZTpcImludmFsaWRfY2FyZF9udW1iZXJcIn0sW3guQ2FyZEV4cGlyeV06e21lc3NhZ2U6XCJJbnZhbGlkIGNhcmQgZXhwaXJ5XCIsdHlwZTpcImludmFsaWRfY2FyZF9leHBpcnlcIn0sW3guQ2FyZE5hbWVdOnttZXNzYWdlOlwiSW52YWxpZCBjYXJkIG5hbWVcIix0eXBlOlwiaW52YWxpZF9jYXJkX25hbWVcIn19O3JldHVybntmaWVsZFR5cGU6ZSxtZXNzYWdlOm51bGwhPT0oaT1udWxsPT09KHQ9b1tlXSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQubWVzc2FnZSkmJnZvaWQgMCE9PWk/aTpcIkludmFsaWQgZmllbGRcIix0eXBlOm51bGwhPT0ocj1udWxsPT09KG49b1tlXSl8fHZvaWQgMD09PW4/dm9pZCAwOm4udHlwZSkmJnZvaWQgMCE9PXI/cjpcImludmFsaWRcIn19aXNWYWxpZEZvcm0oZSl7cmV0dXJuIE9iamVjdC5rZXlzKGUuZmllbGRzKS5ldmVyeSh0PT57dmFyIGk7cmV0dXJuIG51bGw9PT0oaT1lLmZpZWxkc1t0XSl8fHZvaWQgMD09PWk/dm9pZCAwOmkuaXNWYWxpZH0pfWlzVmFsaWRQYXJhbShlKXtyZXR1cm5bXCJudW1iZXJcIixcImN2dlwiLFwiZXhwaXJhdGlvbkRhdGVcIixcInBvc3RhbENvZGVcIixcImNhcmRob2xkZXJOYW1lXCIsXCJjYXJkVHlwZVwiXS5pbmNsdWRlcyhlKX19Y29uc3QgTXQ9cShlPT57Y29uc3QgaT13aW5kb3csbj1uZXcgdihlKSxyPW5ldyBXKHQoKSxpLG4pLG89bmV3IFYocixpKSxhPW5ldyBOdChyLG4pO3JldHVybiBuZXcga3QoZSxvLGEpfSxbe2lkOlwiYnJhaW50cmVlXCJ9XSk7ZXhwb3J0e0plIGFzIGNyZWF0ZUJyYWludHJlZUFjaFBheW1lbnRTdHJhdGVneSxNdCBhcyBjcmVhdGVCcmFpbnRyZWVDcmVkaXRDYXJkUGF5bWVudFN0cmF0ZWd5LG1lIGFzIGNyZWF0ZUJyYWludHJlZUZhc3RsYW5lQ3VzdG9tZXJTdHJhdGVneSxmdCBhcyBjcmVhdGVCcmFpbnRyZWVGYXN0bGFuZVBheW1lbnRTdHJhdGVneSxtdCBhcyBjcmVhdGVCcmFpbnRyZWVMb2NhbE1ldGhvZHNQYXltZW50U3RyYXRlZ3ksRWUgYXMgY3JlYXRlQnJhaW50cmVlUGF5cGFsQnV0dG9uU3RyYXRlZ3ksTmUgYXMgY3JlYXRlQnJhaW50cmVlUGF5cGFsQ3JlZGl0QnV0dG9uU3RyYXRlZ3ksUSBhcyBjcmVhdGVCcmFpbnRyZWVQYXlwYWxDcmVkaXRDdXN0b21lclN0cmF0ZWd5LEogYXMgY3JlYXRlQnJhaW50cmVlUGF5cGFsQ3VzdG9tZXJTdHJhdGVneSxudCBhcyBjcmVhdGVCcmFpbnRyZWVQYXlwYWxQYXltZW50U3RyYXRlZ3ksVWUgYXMgY3JlYXRlQnJhaW50cmVlVmVubW9CdXR0b25TdHJhdGVneSxJdCBhcyBjcmVhdGVCcmFpbnRyZWVWZW5tb1BheW1lbnRTdHJhdGVneSxfZSBhcyBjcmVhdGVCcmFpbnRyZWVWaXNhQ2hlY2tvdXRCdXR0b25TdHJhdGVneSx3ZSBhcyBjcmVhdGVCcmFpbnRyZWVWaXNhQ2hlY2tvdXRDdXN0b21lclN0cmF0ZWd5LEN0IGFzIGNyZWF0ZUJyYWludHJlZVZpc2FDaGVja291dFBheW1lbnRTdHJhdGVneX07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1icmFpbnRyZWUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///../checkout-sdk-js/dist/esm/integrations/braintree.js\n\n}");

/***/ })

}]);