"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonpCheckout"] = self["webpackJsonpCheckout"] || []).push([["billing"],{

/***/ "./packages/core/src/app/address/mapAddressFromFormValues.ts":
/*!*******************************************************************!*\
  !*** ./packages/core/src/app/address/mapAddressFromFormValues.ts ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ mapAddressFromFormValues)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.mjs\");\n/* harmony import */ var _formFields__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../formFields */ \"./packages/core/src/app/formFields/mapCustomFormFieldsFromFormValues.ts\");\n\n\nfunction mapAddressFromFormValues(formValues) {\n    var customFields = formValues.customFields, address = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__rest)(formValues, [\"customFields\"]);\n    var shouldSaveAddress = formValues.shouldSaveAddress;\n    return (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__assign)({}, address), { shouldSaveAddress: shouldSaveAddress, customFields: (0,_formFields__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(customFields) });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWNrYWdlcy9jb3JlL3NyYy9hcHAvYWRkcmVzcy9tYXBBZGRyZXNzRnJvbUZvcm1WYWx1ZXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUVrRTtBQUluRCxTQUFTLHdCQUF3QixDQUFDLFVBQTZCO0lBQ2xFLGdCQUFZLEdBQWlCLFVBQVUsYUFBM0IsRUFBSyxPQUFPLGlEQUFLLFVBQVUsRUFBekMsZ0JBQTRCLENBQUYsQ0FBZ0I7SUFDaEQsSUFBTSxpQkFBaUIsR0FBRyxVQUFVLENBQUMsaUJBQWlCLENBQUM7SUFFdkQsT0FBTyxvR0FDQSxPQUFPLEtBQ1YsaUJBQWlCLHFCQUNqQixZQUFZLEVBQUUsdURBQWlDLENBQUMsWUFBWSxDQUFDLElBQy9EO0FBQ04sQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2NoZWNrb3V0Ly4vcGFja2FnZXMvY29yZS9zcmMvYXBwL2FkZHJlc3MvbWFwQWRkcmVzc0Zyb21Gb3JtVmFsdWVzLnRzPzdiMDAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWRkcmVzcyB9IGZyb20gJ0BiaWdjb21tZXJjZS9jaGVja291dC1zZGsnO1xuXG5pbXBvcnQgeyBtYXBDdXN0b21Gb3JtRmllbGRzRnJvbUZvcm1WYWx1ZXMgfSBmcm9tICcuLi9mb3JtRmllbGRzJztcblxuaW1wb3J0IHsgQWRkcmVzc0Zvcm1WYWx1ZXMgfSBmcm9tICcuL21hcEFkZHJlc3NUb0Zvcm1WYWx1ZXMnO1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtYXBBZGRyZXNzRnJvbUZvcm1WYWx1ZXMoZm9ybVZhbHVlczogQWRkcmVzc0Zvcm1WYWx1ZXMpOiBBZGRyZXNzIHtcbiAgICBjb25zdCB7IGN1c3RvbUZpZWxkcywgLi4uYWRkcmVzcyB9ID0gZm9ybVZhbHVlcztcbiAgICBjb25zdCBzaG91bGRTYXZlQWRkcmVzcyA9IGZvcm1WYWx1ZXMuc2hvdWxkU2F2ZUFkZHJlc3M7XG5cbiAgICByZXR1cm4ge1xuICAgICAgICAuLi5hZGRyZXNzLFxuICAgICAgICBzaG91bGRTYXZlQWRkcmVzcyxcbiAgICAgICAgY3VzdG9tRmllbGRzOiBtYXBDdXN0b21Gb3JtRmllbGRzRnJvbUZvcm1WYWx1ZXMoY3VzdG9tRmllbGRzKSxcbiAgICB9O1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./packages/core/src/app/address/mapAddressFromFormValues.ts\n");

/***/ }),

/***/ "./packages/core/src/app/billing/Billing.tsx":
/*!***************************************************!*\
  !*** ./packages/core/src/app/billing/Billing.tsx ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.mjs\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! lodash */ \"./node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-redux */ \"./node_modules/react-redux/lib/index.js\");\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_redux__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _b3checkout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../b3checkout */ \"./packages/core/src/app/b3checkout/index.ts\");\n/* harmony import */ var _bigcommerce_checkout_locale__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @bigcommerce/checkout/locale */ \"./packages/locale/src/TranslatedString.tsx\");\n/* harmony import */ var _bigcommerce_checkout_ui__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @bigcommerce/checkout/ui */ \"./packages/ui/src/form/LoadingSkeleton/AddressFormSkeleton.tsx\");\n/* harmony import */ var _address__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../address */ \"./packages/core/src/app/address/mapAddressFromFormValues.ts\");\n/* harmony import */ var _address__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../address */ \"./packages/core/src/app/address/isEqualAddress.ts\");\n/* harmony import */ var _checkout__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../checkout */ \"./packages/core/src/app/checkout/withCheckout.tsx\");\n/* harmony import */ var _common_utility__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../common/utility */ \"./packages/core/src/app/common/utility/emptyData.ts\");\n/* harmony import */ var _common_utility__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../common/utility */ \"./packages/core/src/app/common/utility/isFloatingLabelEnabled.ts\");\n/* harmony import */ var _shipping__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../shipping */ \"./packages/core/src/app/shipping/getShippableItemsCount.ts\");\n/* harmony import */ var _ui_form__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui/form */ \"./packages/core/src/app/ui/form/Legend.tsx\");\n/* harmony import */ var _BillingForm__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./BillingForm */ \"./packages/core/src/app/billing/BillingForm.tsx\");\n/* harmony import */ var _b3checkout__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../b3checkout */ \"./packages/core/src/app/b3checkout/components/NoAddressTip.tsx\");\n/* harmony import */ var _getBillingMethodId__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./getBillingMethodId */ \"./packages/core/src/app/billing/getBillingMethodId.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar Billing = /** @class */ (function (_super) {\n    (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__extends)(Billing, _super);\n    function Billing() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.handleSubmit = function (_a) { return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__awaiter)(_this, void 0, void 0, function () {\n            var _b, updateAddress, updateCheckout, customerMessage, billingAddress, navigateNextStep, onUnhandledError, isB3User, b3Company, getFields, checkoutSettings, promises, address, isMasquerading, addressWithId_1, hasAddressId, isCompanyAddress, companyAddress, formFields, isValid, error_1;\n            var _c, _d, _e, _f, _g, _h, _j, _k, _l, _m, _o, _p;\n            var orderComment = _a.orderComment, addressValues = (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__rest)(_a, [\"orderComment\"]);\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__generator)(this, function (_q) {\n                switch (_q.label) {\n                    case 0:\n                        _b = this.props, updateAddress = _b.updateAddress, updateCheckout = _b.updateCheckout, customerMessage = _b.customerMessage, billingAddress = _b.billingAddress, navigateNextStep = _b.navigateNextStep, onUnhandledError = _b.onUnhandledError, isB3User = _b.isB3User, b3Company = _b.b3Company, getFields = _b.getFields, checkoutSettings = _b.checkoutSettings;\n                        promises = [];\n                        address = (0,_address__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(addressValues);\n                        isMasquerading = isB3User && ((_c = _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"] === null || _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"] === void 0 ? void 0 : _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].store) === null || _c === void 0 ? void 0 : _c.getState) &&\n                            (((_e = (_d = _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].store.getState()) === null || _d === void 0 ? void 0 : _d.global) === null || _e === void 0 ? void 0 : _e.selectCompanyHierarchyId) > 0 ||\n                                (typeof sessionStorage !== 'undefined' && sessionStorage.getItem('sf-isAgenting') === 'true') ||\n                                (((_h = (_g = (_f = _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].utils) === null || _f === void 0 ? void 0 : _f.storage) === null || _g === void 0 ? void 0 : _g.B3RoleId) === null || _h === void 0 ? void 0 : _h.getValue) &&\n                                    ((_l = (_k = (_j = _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].utils) === null || _j === void 0 ? void 0 : _j.constants) === null || _k === void 0 ? void 0 : _k.B3Role) === null || _l === void 0 ? void 0 : _l.SALESREP) &&\n                                    _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].utils.storage.B3RoleId.getValue() === _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].utils.constants.B3Role.SALESREP));\n                        if (isMasquerading && isB3User && b3Company) {\n                            addressWithId_1 = address;\n                            hasAddressId = (addressWithId_1 === null || addressWithId_1 === void 0 ? void 0 : addressWithId_1.addressId) && String(addressWithId_1.addressId).trim() !== '';\n                            isCompanyAddress = hasAddressId && ((_m = b3Company.addresses) === null || _m === void 0 ? void 0 : _m.some(function (addr) { return addr.isBilling === 1 &&\n                                String(addr.addressId) === String(addressWithId_1.addressId); }));\n                            // Only override if address has an ID that's NOT in company addresses (i.e., super admin's personal address)\n                            // Don't override if: (1) it's a company address, or (2) it's a new address (no ID)\n                            if (hasAddressId && !isCompanyAddress) {\n                                companyAddress = ((_o = b3Company.defaultBillingAddress) === null || _o === void 0 ? void 0 : _o.address1)\n                                    ? b3Company.defaultBillingAddress\n                                    : (_p = b3Company.addresses) === null || _p === void 0 ? void 0 : _p.find(function (addr) { return addr.isBilling === 1; });\n                                if (companyAddress && companyAddress.address1) {\n                                    address = companyAddress;\n                                }\n                            }\n                        }\n                        if (isB3User && (addressValues === null || addressValues === void 0 ? void 0 : addressValues.b2bCustomFields)) {\n                            _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].extrasFiles.saveExtrasAddress(addressValues === null || addressValues === void 0 ? void 0 : addressValues.b2bCustomFields, 'billing');\n                        }\n                        if (isB3User && checkoutSettings['billing.address.save'] && (address === null || address === void 0 ? void 0 : address.shouldSaveAddress)) {\n                            try {\n                                formFields = getFields(address === null || address === void 0 ? void 0 : address.countryCode);\n                                isValid = _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].utils.util.validateAddress(address, b3Company.addresses, formFields);\n                                sessionStorage.setItem('b3_pending_billing_address', JSON.stringify({\n                                    newAddress: (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_3__.__assign)({}, address), { addressId: isValid ? undefined : '' }),\n                                    isBillingMode: true,\n                                    checkoutSettings: checkoutSettings,\n                                    b2bCustomFields: _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].extrasFiles.decodeAddressExtraFieldsKeys(addressValues === null || addressValues === void 0 ? void 0 : addressValues.b2bCustomFields)\n                                }));\n                            }\n                            catch (error) {\n                                console.warn('Billing address will not be saved to address book');\n                            }\n                        }\n                        if (address && !(0,_address__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(address, billingAddress)) {\n                            promises.push(updateAddress(_b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].utils.address.addressFieldOptimize(address)));\n                        }\n                        if (customerMessage !== orderComment) {\n                            promises.push(updateCheckout({ customerMessage: orderComment }));\n                        }\n                        _q.label = 1;\n                    case 1:\n                        _q.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, Promise.all(promises)];\n                    case 2:\n                        _q.sent();\n                        navigateNextStep();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        error_1 = _q.sent();\n                        if (error_1 instanceof Error) {\n                            onUnhandledError(error_1);\n                        }\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        }); };\n        return _this;\n    }\n    Billing.prototype.componentDidMount = function () {\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__awaiter)(this, void 0, void 0, function () {\n            var _a, initialize, _b, onReady, onUnhandledError, error_2;\n            return (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__generator)(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        _a = this.props, initialize = _a.initialize, _b = _a.onReady, onReady = _b === void 0 ? lodash__WEBPACK_IMPORTED_MODULE_0__.noop : _b, onUnhandledError = _a.onUnhandledError;\n                        _c.label = 1;\n                    case 1:\n                        _c.trys.push([1, 3, , 4]);\n                        return [4 /*yield*/, initialize()];\n                    case 2:\n                        _c.sent();\n                        onReady();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        error_2 = _c.sent();\n                        if (error_2 instanceof Error) {\n                            onUnhandledError(error_2);\n                        }\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Object.defineProperty(Billing.prototype, \"shouldAllowNewAddress\", {\n        get: function () {\n            var checkoutSettings = this.props.checkoutSettings;\n            return checkoutSettings['billing.address.add'];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Billing.prototype, \"addresses\", {\n        get: function () {\n            var _a = this.props, customer = _a.customer, isB3User = _a.isB3User, b3Company = _a.b3Company;\n            return isB3User\n                ? b3Company.addresses.filter(function (address) { return address.isBilling === 1; })\n                : customer.addresses;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Billing.prototype.render = function () {\n        var _a = this.props, updateAddress = _a.updateAddress, isInitializing = _a.isInitializing, type = _a.type, isB3User = _a.isB3User, props = (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__rest)(_a, [\"updateAddress\", \"isInitializing\", \"type\", \"isB3User\"]);\n        var isShouldShowNewAddressForm = !(isB3User ? !this.addresses.length && !this.shouldAllowNewAddress : false);\n        return (react__WEBPACK_IMPORTED_MODULE_1__.createElement(_bigcommerce_checkout_ui__WEBPACK_IMPORTED_MODULE_7__[\"default\"], { isLoading: isInitializing },\n            react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"div\", { className: \"checkout-form\" }, isShouldShowNewAddressForm ? (react__WEBPACK_IMPORTED_MODULE_1__.createElement(react__WEBPACK_IMPORTED_MODULE_1__.Fragment, null,\n                react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"div\", { className: \"form-legend-container\" },\n                    react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ui_form__WEBPACK_IMPORTED_MODULE_8__[\"default\"], { testId: \"billing-address-heading\" },\n                        react__WEBPACK_IMPORTED_MODULE_1__.createElement(_bigcommerce_checkout_locale__WEBPACK_IMPORTED_MODULE_9__[\"default\"], { id: \"billing.billing_address_heading\" }))),\n                react__WEBPACK_IMPORTED_MODULE_1__.createElement(_BillingForm__WEBPACK_IMPORTED_MODULE_10__[\"default\"], (0,tslib__WEBPACK_IMPORTED_MODULE_3__.__assign)({}, props, { onSubmit: this.handleSubmit, type: type, updateAddress: updateAddress })))) : (react__WEBPACK_IMPORTED_MODULE_1__.createElement(_b3checkout__WEBPACK_IMPORTED_MODULE_11__[\"default\"], { type: \"billing\" })))));\n    };\n    return Billing;\n}(react__WEBPACK_IMPORTED_MODULE_1__.Component));\nfunction mapToBillingProps(_a) {\n    var checkoutService = _a.checkoutService, checkoutState = _a.checkoutState;\n    var _b = checkoutState.data, getCheckout = _b.getCheckout, getConfig = _b.getConfig, getCart = _b.getCart, getCustomer = _b.getCustomer, getBillingAddress = _b.getBillingAddress, getBillingAddressFields = _b.getBillingAddressFields, getBillingCountries = _b.getBillingCountries, _c = checkoutState.statuses, isLoadingBillingCountries = _c.isLoadingBillingCountries, isUpdatingBillingAddress = _c.isUpdatingBillingAddress, isUpdatingCheckout = _c.isUpdatingCheckout;\n    var config = getConfig();\n    var customer = getCustomer();\n    var checkout = getCheckout();\n    var cart = getCart();\n    if (!config || !customer || !checkout || !cart) {\n        return null;\n    }\n    var _d = config.checkoutSettings, enableOrderComments = _d.enableOrderComments, googleMapsApiKey = _d.googleMapsApiKey;\n    var countriesWithAutocomplete = ['US', 'CA', 'AU', 'NZ', 'GB'];\n    return {\n        billingAddress: getBillingAddress(),\n        countries: getBillingCountries() || _common_utility__WEBPACK_IMPORTED_MODULE_12__.EMPTY_ARRAY,\n        countriesWithAutocomplete: countriesWithAutocomplete,\n        customer: customer,\n        customerMessage: checkout.customerMessage,\n        getFields: getBillingAddressFields,\n        googleMapsApiKey: googleMapsApiKey,\n        initialize: checkoutService.loadBillingAddressFields,\n        isInitializing: isLoadingBillingCountries(),\n        isUpdating: isUpdatingBillingAddress() || isUpdatingCheckout(),\n        methodId: (0,_getBillingMethodId__WEBPACK_IMPORTED_MODULE_13__[\"default\"])(checkout),\n        shouldShowOrderComments: enableOrderComments && (0,_shipping__WEBPACK_IMPORTED_MODULE_14__[\"default\"])(cart) < 1,\n        updateAddress: checkoutService.updateBillingAddress,\n        updateCheckout: checkoutService.updateCheckout,\n        isFloatingLabelEnabled: (0,_common_utility__WEBPACK_IMPORTED_MODULE_15__[\"default\"])(config.checkoutSettings),\n    };\n}\nvar mapStateToProps = function (state) {\n    var _a = state.global, isB3User = _a.isB3User, checkoutSettings = _a.checkoutSettings, b3Company = state.company;\n    return {\n        isB3User: isB3User,\n        b3Company: b3Company,\n        checkoutSettings: checkoutSettings,\n    };\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,react_redux__WEBPACK_IMPORTED_MODULE_2__.connect)(mapStateToProps)((0,_checkout__WEBPACK_IMPORTED_MODULE_16__[\"default\"])(mapToBillingProps)(Billing)));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWNrYWdlcy9jb3JlL3NyYy9hcHAvYmlsbGluZy9CaWxsaW5nLnRzeCIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFROEI7QUFDc0I7QUFDZjtBQUVDO0FBQzBCO0FBRUQ7QUFFTztBQUMzQjtBQUM2QjtBQUNuQjtBQUNqQjtBQUUyQjtBQUVsQjtBQUNTO0FBaUN0RDtJQUFzQixrRUFBNEQ7SUFBbEY7O1FBcUVZLGtCQUFZLEdBQXdDLFVBQU8sRUFHbEU7OztZQUZHLGdCQUFZLG9CQUNULGFBQWEscURBRitDLGdCQUdsRSxDQURtQjs7Ozt3QkFFVixLQVdGLElBQUksQ0FBQyxLQUFLLEVBVlYsYUFBYSxxQkFDYixjQUFjLHNCQUNkLGVBQWUsdUJBQ2YsY0FBYyxzQkFDZCxnQkFBZ0Isd0JBQ2hCLGdCQUFnQix3QkFDaEIsUUFBUSxnQkFDUixTQUFTLGlCQUNULFNBQVMsaUJBQ1QsZ0JBQWdCLHVCQUNMO3dCQUVULFFBQVEsR0FBc0MsRUFBRSxDQUFDO3dCQUNuRCxPQUFPLEdBQUcsb0RBQXdCLENBQUMsYUFBYSxDQUFDLENBQUM7d0JBSWhELGNBQWMsR0FBRyxRQUFRLEtBQUkseURBQVUsYUFBVixtREFBVSx1QkFBVixtREFBVSxDQUFFLEtBQUssMENBQUUsUUFBUTs0QkFDMUQsQ0FBQyxnRUFBVSxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsMENBQUUsTUFBTSwwQ0FBRSx3QkFBd0IsSUFBRyxDQUFDO2dDQUNqRSxDQUFDLE9BQU8sY0FBYyxLQUFLLFdBQVcsSUFBSSxjQUFjLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxLQUFLLE1BQU0sQ0FBQztnQ0FDN0YsQ0FBQyxzRUFBVSxDQUFDLEtBQUssMENBQUUsT0FBTywwQ0FBRSxRQUFRLDBDQUFFLFFBQVE7cUNBQzdDLHFFQUFVLENBQUMsS0FBSywwQ0FBRSxTQUFTLDBDQUFFLE1BQU0sMENBQUUsUUFBUTtvQ0FDN0MsbURBQVUsQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFFBQVEs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LENBQUM7UUFDdEMsdUJBQXVCLEVBQUUsbUJBQW1CLElBQUksc0RBQXNCLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQztRQUNoRixhQUFhLEVBQUUsZUFBZSxDQUFDLG9CQUFvQjtRQUNuRCxjQUFjLEVBQUUsZUFBZSxDQUFDLGNBQWM7UUFDOUMsc0JBQXNCLEVBQUUsNERBQXNCLENBQUMsTUFBTSxDQUFDLGdCQUFnQixDQUFDO0tBQzFFLENBQUM7QUFDTixDQUFDO0FBRUQsSUFBTSxlQUFlLEdBQUcsVUFBQyxLQUE2RTtJQUU5RixTQU1BLEtBQUssT0FISixFQUZHLFFBQVEsZ0JBQ1IsZ0JBQWdCLHdCQUVYLFNBQVMsR0FFbEIsS0FBSyxRQUZhLENBRWI7SUFFVCxPQUFPO1FBQ0gsUUFBUTtRQUNSLFNBQVM7UUFDVCxnQkFBZ0I7S0FDbkI7QUFDTCxDQUFDO0FBRUQsaUVBQWUsb0RBQU8sQ0FBQyxlQUFlLENBQUMsQ0FBQyxzREFBWSxDQUFDLGlCQUFpQixDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2NoZWNrb3V0Ly4vcGFja2FnZXMvY29yZS9zcmMvYXBwL2JpbGxpbmcvQmlsbGluZy50c3g/MjExYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICAgIEFkZHJlc3MsXG4gICAgQ2hlY2tvdXRSZXF1ZXN0Qm9keSxcbiAgICBDaGVja291dFNlbGVjdG9ycyxcbiAgICBDb3VudHJ5LFxuICAgIEN1c3RvbWVyLFxuICAgIEZvcm1GaWVsZCxcbn0gZnJvbSAnQGJpZ2NvbW1lcmNlL2NoZWNrb3V0LXNkayc7XG5pbXBvcnQgeyBub29wIH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQsIFJlYWN0Tm9kZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tICdyZWFjdC1yZWR1eCdcblxuaW1wb3J0IEIzQ2hlY2tvdXQgZnJvbSAnLi4vYjNjaGVja291dCdcbmltcG9ydCB7IFRyYW5zbGF0ZWRTdHJpbmcgfSBmcm9tICdAYmlnY29tbWVyY2UvY2hlY2tvdXQvbG9jYWxlJztcbmltcG9ydCB7IENoZWNrb3V0Q29udGV4dFByb3BzIH0gZnJvbSAnQGJpZ2NvbW1lcmNlL2NoZWNrb3V0L3BheW1lbnQtaW50ZWdyYXRpb24tYXBpJztcbmltcG9ydCB7IEFkZHJlc3NGb3JtU2tlbGV0b24gfSBmcm9tICdAYmlnY29tbWVyY2UvY2hlY2tvdXQvdWknO1xuXG5pbXBvcnQgeyBpc0VxdWFsQWRkcmVzcywgbWFwQWRkcmVzc0Zyb21Gb3JtVmFsdWVzIH0gZnJvbSAnLi4vYWRkcmVzcyc7XG5pbXBvcnQgeyB3aXRoQ2hlY2tvdXQgfSBmcm9tICcuLi9jaGVja291dCc7XG5pbXBvcnQgeyBFTVBUWV9BUlJBWSwgaXNGbG9hdGluZ0xhYmVsRW5hYmxlZCB9IGZyb20gJy4uL2NvbW1vbi91dGlsaXR5JztcbmltcG9ydCB7IGdldFNoaXBwYWJsZUl0ZW1zQ291bnQgfSBmcm9tICcuLi9zaGlwcGluZyc7XG5pbXBvcnQgeyBMZWdlbmQgfSBmcm9tICcuLi91aS9mb3JtJztcblxuaW1wb3J0IEJpbGxpbmdGb3JtLCB7IEJpbGxpbmdGb3JtVmFsdWVzIH0gZnJvbSAnLi9CaWxsaW5nRm9ybSc7XG5pbXBvcnQgQ2hlY2tvdXRTdGVwVHlwZSBmcm9tICcuLi9jaGVja291dC9DaGVja291dFN0ZXBUeXBlJztcbmltcG9ydCB7ICBOb0FkZHJlc3NUaXAgfSBmcm9tICcuLi9iM2NoZWNrb3V0J1xuaW1wb3J0IGdldEJpbGxpbmdNZXRob2RJZCBmcm9tICcuL2dldEJpbGxpbmdNZXRob2RJZCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmlsbGluZ1Byb3BzIHtcbiAgICBuYXZpZ2F0ZU5leHRTdGVwKCk6IHZvaWQ7XG4gICAgb25SZWFkeT8oKTogdm9pZDtcbiAgICBvblVuaGFuZGxlZEVycm9yKGVycm9yOiBFcnJvcik6IHZvaWQ7XG4gICAgdHlwZTogQ2hlY2tvdXRTdGVwVHlwZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFdpdGhDaGVja291dEJpbGxpbmdQcm9wcyB7XG4gICAgY291bnRyaWVzOiBDb3VudHJ5W107XG4gICAgY291bnRyaWVzV2l0aEF1dG9jb21wbGV0ZTogc3RyaW5nW107XG4gICAgY3VzdG9tZXI6IEN1c3RvbWVyO1xuICAgIGN1c3RvbWVyTWVzc2FnZTogc3RyaW5nO1xuICAgIGdvb2dsZU1hcHNBcGlLZXk6IHN0cmluZztcbiAgICBpc0luaXRpYWxpemluZzogYm9vbGVhbjtcbiAgICBpc1VwZGF0aW5nOiBib29sZWFuO1xuICAgIHNob3VsZFNob3dPcmRlckNvbW1lbnRzOiBib29sZWFuO1xuICAgIGJpbGxpbmdBZGRyZXNzPzogQWRkcmVzcztcbiAgICBtZXRob2RJZD86IHN0cmluZztcbiAgICBpc0Zsb2F0aW5nTGFiZWxFbmFibGVkPzogYm9vbGVhbjtcbiAgICBnZXRGaWVsZHMoY291bnRyeUNvZGU/OiBzdHJpbmcpOiBGb3JtRmllbGRbXTtcbiAgICBpbml0aWFsaXplKCk6IFByb21pc2U8Q2hlY2tvdXRTZWxlY3RvcnM+O1xuICAgIHVwZGF0ZUFkZHJlc3MoYWRkcmVzczogUGFydGlhbDxBZGRyZXNzPik6IFByb21pc2U8Q2hlY2tvdXRTZWxlY3RvcnM+O1xuICAgIHVwZGF0ZUNoZWNrb3V0KHBheWxvYWQ6IENoZWNrb3V0UmVxdWVzdEJvZHkpOiBQcm9taXNlPENoZWNrb3V0U2VsZWN0b3JzPjtcbn1cblxuaW50ZXJmYWNlIEIzUHJvcHMge1xuICAgIGlzQjNVc2VyOiBib29sZWFuXG4gICAgYjNDb21wYW55OiBhbnlcbiAgICBjaGVja291dFNldHRpbmdzOiBhbnlcbn1cblxuY2xhc3MgQmlsbGluZyBleHRlbmRzIENvbXBvbmVudDxCM1Byb3BzICYgQmlsbGluZ1Byb3BzICYgV2l0aENoZWNrb3V0QmlsbGluZ1Byb3BzPiB7XG4gICAgYXN5bmMgY29tcG9uZW50RGlkTW91bnQoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHsgaW5pdGlhbGl6ZSwgb25SZWFkeSA9IG5vb3AsIG9uVW5oYW5kbGVkRXJyb3IgfSA9IHRoaXMucHJvcHM7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IGluaXRpYWxpemUoKTtcbiAgICAgICAgICAgIG9uUmVhZHkoKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgICAgb25VbmhhbmRsZWRFcnJvcihlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgc2hvdWxkQWxsb3dOZXdBZGRyZXNzKCkge1xuICAgICAgICBjb25zdCB7IGNoZWNrb3V0U2V0dGluZ3MgfSA9IHRoaXMucHJvcHNcblxuICAgICAgICByZXR1cm4gY2hlY2tvdXRTZXR0aW5nc1snYmlsbGluZy5hZGRyZXNzLmFkZCddXG4gICAgfVxuXG4gICAgZ2V0IGFkZHJlc3NlcygpIHtcbiAgICAgICAgY29uc3Qge1xuICAgICAgICAgICAgY3VzdG9tZXIsXG4gICAgICAgICAgICBpc0IzVXNlcixcbiAgICAgICAgICAgIGIzQ29tcGFueSxcbiAgICAgICAgfSA9IHRoaXMucHJvcHNcblxuICAgICAgICByZXR1cm4gaXNCM1VzZXJcbiAgICAgICAgICAgID8gYjNDb21wYW55LmFkZHJlc3Nlcy5maWx0ZXIoKGFkZHJlc3M6IHsgaXNCaWxsaW5nOiBudW1iZXIgfSkgPT4gYWRkcmVzcy5pc0JpbGxpbmcgPT09IDEpXG4gICAgICAgICAgICA6IGN1c3RvbWVyLmFkZHJlc3Nlc1xuICAgIH1cblxuICAgIHJlbmRlcigpOiBSZWFjdE5vZGUge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICB1cGRhdGVBZGRyZXNzLFxuICAgICAgICAgICAgaXNJbml0aWFsaXppbmcsXG4gICAgICAgICAgICB0eXBlLFxuICAgICAgICAgICAgaXNCM1VzZXIsXG4gICAgICAgICAgICAuLi5wcm9wc1xuICAgICAgICB9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICBjb25zdCBpc1Nob3VsZFNob3dOZXdBZGRyZXNzRm9ybSA9ICEoaXNCM1VzZXIgPyAhdGhpcy5hZGRyZXNzZXMubGVuZ3RoICYmICF0aGlzLnNob3VsZEFsbG93TmV3QWRkcmVzcyA6IGZhbHNlKVxuXG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8QWRkcmVzc0Zvcm1Ta2VsZXRvbiBpc0xvYWRpbmc9e2lzSW5pdGlhbGl6aW5nfT5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNoZWNrb3V0LWZvcm1cIj5cbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNTaG91bGRTaG93TmV3QWRkcmVzc0Zvcm0gID8gKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZm9ybS1sZWdlbmQtY29udGFpbmVyXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8TGVnZW5kIHRlc3RJZD1cImJpbGxpbmctYWRkcmVzcy1oZWFkaW5nXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPFRyYW5zbGF0ZWRTdHJpbmcgaWQ9XCJiaWxsaW5nLmJpbGxpbmdfYWRkcmVzc19oZWFkaW5nXCIgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvTGVnZW5kPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPEJpbGxpbmdGb3JtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7Li4ucHJvcHN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblN1Ym1pdD17dGhpcy5oYW5kbGVTdWJtaXR9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPXsgdHlwZSB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVBZGRyZXNzPXt1cGRhdGVBZGRyZXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvPlxuICAgICAgICAgICAgICAgICAgICAgICAgKSA6ICg8Tm9BZGRyZXNzVGlwIHR5cGU9XCJiaWxsaW5nXCIgLz4pXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L0FkZHJlc3NGb3JtU2tlbGV0b24+XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBoYW5kbGVTdWJtaXQ6ICh2YWx1ZXM6IEJpbGxpbmdGb3JtVmFsdWVzKSA9PiB2b2lkID0gYXN5bmMgKHtcbiAgICAgICAgb3JkZXJDb21tZW50LFxuICAgICAgICAuLi5hZGRyZXNzVmFsdWVzXG4gICAgfSkgPT4ge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICB1cGRhdGVBZGRyZXNzLFxuICAgICAgICAgICAgdXBkYXRlQ2hlY2tvdXQsXG4gICAgICAgICAgICBjdXN0b21lck1lc3NhZ2UsXG4gICAgICAgICAgICBiaWxsaW5nQWRkcmVzcyxcbiAgICAgICAgICAgIG5hdmlnYXRlTmV4dFN0ZXAsXG4gICAgICAgICAgICBvblVuaGFuZGxlZEVycm9yLFxuICAgICAgICAgICAgaXNCM1VzZXIsXG4gICAgICAgICAgICBiM0NvbXBhbnksXG4gICAgICAgICAgICBnZXRGaWVsZHMsXG4gICAgICAgICAgICBjaGVja291dFNldHRpbmdzLFxuICAgICAgICB9ID0gdGhpcy5wcm9wcztcblxuICAgICAgICBjb25zdCBwcm9taXNlczogQXJyYXk8UHJvbWlzZTxDaGVja291dFNlbGVjdG9ycz4+ID0gW107XG4gICAgICAgIGxldCBhZGRyZXNzID0gbWFwQWRkcmVzc0Zyb21Gb3JtVmFsdWVzKGFkZHJlc3NWYWx1ZXMpO1xuXG4gICAgICAgIC8vIEZpeCBtYXNxdWVyYWRpbmcgaXNzdWU6IFdoZW4gc3VwZXIgYWRtaW4gaXMgbWFzcXVlcmFkaW5nLCBwcmV2ZW50IHVzaW5nIHN1cGVyIGFkbWluJ3MgcGVyc29uYWwgYWRkcmVzc1xuICAgICAgICAvLyBidXQgYWxsb3cgc2VsZWN0aW5nIGNvbXBhbnkgYWRkcmVzc2VzIG9yIGVudGVyaW5nIG5ldyBhZGRyZXNzZXNcbiAgICAgICAgY29uc3QgaXNNYXNxdWVyYWRpbmcgPSBpc0IzVXNlciAmJiBCM0NoZWNrb3V0Py5zdG9yZT8uZ2V0U3RhdGUgJiZcbiAgICAgICAgICAgIChCM0NoZWNrb3V0LnN0b3JlLmdldFN0YXRlKCk/Lmdsb2JhbD8uc2VsZWN0Q29tcGFueUhpZXJhcmNoeUlkID4gMCB8fCBcbiAgICAgICAgICAgICAodHlwZW9mIHNlc3Npb25TdG9yYWdlICE9PSAndW5kZWZpbmVkJyAmJiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdzZi1pc0FnZW50aW5nJykgPT09ICd0cnVlJykgfHxcbiAgICAgICAgICAgICAoQjNDaGVja291dC51dGlscz8uc3RvcmFnZT8uQjNSb2xlSWQ/LmdldFZhbHVlICYmIFxuICAgICAgICAgICAgICBCM0NoZWNrb3V0LnV0aWxzPy5jb25zdGFudHM/LkIzUm9sZT8uU0FMRVNSRVAgJiYgXG4gICAgICAgICAgICAgIEIzQ2hlY2tvdXQudXRpbHMuc3RvcmFnZS5CM1JvbGVJZC5nZXRWYWx1ZSgpID09PSBCM0NoZWNrb3V0LnV0aWxzLmNvbnN0YW50cy5CM1JvbGUuU0FMRVNSRVApKVxuICAgICAgICBcbiAgICAgICAgaWYgKGlzTWFzcXVlcmFkaW5nICYmIGlzQjNVc2VyICYmIGIzQ29tcGFueSkge1xuICAgICAgICAgICAgLy8gV2hlbiBtYXNxdWVyYWRpbmcsIGNoZWNrIGlmIHRoZSBhZGRyZXNzIGlzIGEgdmFsaWQgY29tcGFueSBiaWxsaW5nIGFkZHJlc3Mgb3IgbmV3IGFkZHJlc3NcbiAgICAgICAgICAgIC8vIE9ubHkgb3ZlcnJpZGUgaWYgaXQncyB0aGUgc3VwZXIgYWRtaW4ncyBwZXJzb25hbCBhZGRyZXNzXG4gICAgICAgICAgICBjb25zdCBhZGRyZXNzV2l0aElkID0gYWRkcmVzcyBhcyBhbnlcbiAgICAgICAgICAgIGNvbnN0IGhhc0FkZHJlc3NJZCA9IGFkZHJlc3NXaXRoSWQ/LmFkZHJlc3NJZCAmJiBTdHJpbmcoYWRkcmVzc1dpdGhJZC5hZGRyZXNzSWQpLnRyaW0oKSAhPT0gJydcbiAgICAgICAgICAgIGNvbnN0IGlzQ29tcGFueUFkZHJlc3MgPSBoYXNBZGRyZXNzSWQgJiYgYjNDb21wYW55LmFkZHJlc3Nlcz8uc29tZShcbiAgICAgICAgICAgICAgICAoYWRkcjogYW55KSA9PiBhZGRyLmlzQmlsbGluZyA9PT0gMSAmJiBcbiAgICAgICAgICAgICAgICBTdHJpbmcoYWRkci5hZGRyZXNzSWQpID09PSBTdHJpbmcoYWRkcmVzc1dpdGhJZC5hZGRyZXNzSWQpXG4gICAgICAgICAgICApXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIE9ubHkgb3ZlcnJpZGUgaWYgYWRkcmVzcyBoYXMgYW4gSUQgdGhhdCdzIE5PVCBpbiBjb21wYW55IGFkZHJlc3NlcyAoaS5lLiwgc3VwZXIgYWRtaW4ncyBwZXJzb25hbCBhZGRyZXNzKVxuICAgICAgICAgICAgLy8gRG9uJ3Qgb3ZlcnJpZGUgaWY6ICgxKSBpdCdzIGEgY29tcGFueSBhZGRyZXNzLCBvciAoMikgaXQncyBhIG5ldyBhZGRyZXNzIChubyBJRClcbiAgICAgICAgICAgIGlmIChoYXNBZGRyZXNzSWQgJiYgIWlzQ29tcGFueUFkZHJlc3MpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjb21wYW55QWRkcmVzcyA9IGIzQ29tcGFueS5kZWZhdWx0QmlsbGluZ0FkZHJlc3M/LmFkZHJlc3MxIFxuICAgICAgICAgICAgICAgICAgICA/IGIzQ29tcGFueS5kZWZhdWx0QmlsbGluZ0FkZHJlc3NcbiAgICAgICAgICAgICAgICAgICAgOiBiM0NvbXBhbnkuYWRkcmVzc2VzPy5maW5kKChhZGRyOiBhbnkpID0+IGFkZHIuaXNCaWxsaW5nID09PSAxKVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChjb21wYW55QWRkcmVzcyAmJiBjb21wYW55QWRkcmVzcy5hZGRyZXNzMSkge1xuICAgICAgICAgICAgICAgICAgICBhZGRyZXNzID0gY29tcGFueUFkZHJlc3NcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaXNCM1VzZXIgJiYgKGFkZHJlc3NWYWx1ZXMgYXMgYW55KT8uYjJiQ3VzdG9tRmllbGRzKSB7XG4gICAgICAgICAgICBCM0NoZWNrb3V0LmV4dHJhc0ZpbGVzLnNhdmVFeHRyYXNBZGRyZXNzKChhZGRyZXNzVmFsdWVzIGFzIGFueSk/LmIyYkN1c3RvbUZpZWxkcywgJ2JpbGxpbmcnKVxuICAgICAgICB9XG4gICAgICAgIGlmIChpc0IzVXNlciAmJiBjaGVja291dFNldHRpbmdzWydiaWxsaW5nLmFkZHJlc3Muc2F2ZSddICYmIGFkZHJlc3M/LnNob3VsZFNhdmVBZGRyZXNzKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1GaWVsZHMgPSBnZXRGaWVsZHMoYWRkcmVzcz8uY291bnRyeUNvZGUpXG4gICAgICAgICAgICAgICAgY29uc3QgaXNWYWxpZCA9IEIzQ2hlY2tvdXQudXRpbHMudXRpbC52YWxpZGF0ZUFkZHJlc3MoYWRkcmVzcyBhcyBBZGRyZXNzLCBiM0NvbXBhbnkuYWRkcmVzc2VzLCBmb3JtRmllbGRzKVxuICAgICAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ2IzX3BlbmRpbmdfYmlsbGluZ19hZGRyZXNzJywgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgICBuZXdBZGRyZXNzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAuLi5hZGRyZXNzLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkcmVzc0lkOiBpc1ZhbGlkID8gdW5kZWZpbmVkIDogJycsXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGlzQmlsbGluZ01vZGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGNoZWNrb3V0U2V0dGluZ3MsXG4gICAgICAgICAgICAgICAgICAgIGIyYkN1c3RvbUZpZWxkczogQjNDaGVja291dC5leHRyYXNGaWxlcy5kZWNvZGVBZGRyZXNzRXh0cmFGaWVsZHNLZXlzKChhZGRyZXNzVmFsdWVzIGFzIGFueSk/LmIyYkN1c3RvbUZpZWxkcylcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignQmlsbGluZyBhZGRyZXNzIHdpbGwgbm90IGJlIHNhdmVkIHRvIGFkZHJlc3MgYm9vaycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGFkZHJlc3MgJiYgIWlzRXF1YWxBZGRyZXNzKGFkZHJlc3MsIGJpbGxpbmdBZGRyZXNzKSkge1xuICAgICAgICAgICAgcHJvbWlzZXMucHVzaCh1cGRhdGVBZGRyZXNzKEIzQ2hlY2tvdXQudXRpbHMuYWRkcmVzcy5hZGRyZXNzRmllbGRPcHRpbWl6ZShhZGRyZXNzKSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGN1c3RvbWVyTWVzc2FnZSAhPT0gb3JkZXJDb21tZW50KSB7XG4gICAgICAgICAgICBwcm9taXNlcy5wdXNoKHVwZGF0ZUNoZWNrb3V0KHsgY3VzdG9tZXJNZXNzYWdlOiBvcmRlckNvbW1lbnQgfSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcblxuICAgICAgICAgICAgbmF2aWdhdGVOZXh0U3RlcCgpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvblVuaGFuZGxlZEVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIG1hcFRvQmlsbGluZ1Byb3BzKHtcbiAgICBjaGVja291dFNlcnZpY2UsXG4gICAgY2hlY2tvdXRTdGF0ZSxcbn06IENoZWNrb3V0Q29udGV4dFByb3BzKTogV2l0aENoZWNrb3V0QmlsbGluZ1Byb3BzIHwgbnVsbCB7XG4gICAgY29uc3Qge1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBnZXRDaGVja291dCxcbiAgICAgICAgICAgIGdldENvbmZpZyxcbiAgICAgICAgICAgIGdldENhcnQsXG4gICAgICAgICAgICBnZXRDdXN0b21lcixcbiAgICAgICAgICAgIGdldEJpbGxpbmdBZGRyZXNzLFxuICAgICAgICAgICAgZ2V0QmlsbGluZ0FkZHJlc3NGaWVsZHMsXG4gICAgICAgICAgICBnZXRCaWxsaW5nQ291bnRyaWVzLFxuICAgICAgICB9LFxuICAgICAgICBzdGF0dXNlczogeyBpc0xvYWRpbmdCaWxsaW5nQ291bnRyaWVzLCBpc1VwZGF0aW5nQmlsbGluZ0FkZHJlc3MsIGlzVXBkYXRpbmdDaGVja291dCB9LFxuICAgIH0gPSBjaGVja291dFN0YXRlO1xuXG4gICAgY29uc3QgY29uZmlnID0gZ2V0Q29uZmlnKCk7XG4gICAgY29uc3QgY3VzdG9tZXIgPSBnZXRDdXN0b21lcigpO1xuICAgIGNvbnN0IGNoZWNrb3V0ID0gZ2V0Q2hlY2tvdXQoKTtcbiAgICBjb25zdCBjYXJ0ID0gZ2V0Q2FydCgpO1xuXG4gICAgaWYgKCFjb25maWcgfHwgIWN1c3RvbWVyIHx8ICFjaGVja291dCB8fCAhY2FydCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCB7IGVuYWJsZU9yZGVyQ29tbWVudHMsIGdvb2dsZU1hcHNBcGlLZXkgfSA9IGNvbmZpZy5jaGVja291dFNldHRpbmdzO1xuXG4gICAgY29uc3QgY291bnRyaWVzV2l0aEF1dG9jb21wbGV0ZSA9IFsnVVMnLCAnQ0EnLCAnQVUnLCAnTlonLCAnR0InXTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIGJpbGxpbmdBZGRyZXNzOiBnZXRCaWxsaW5nQWRkcmVzcygpLFxuICAgICAgICBjb3VudHJpZXM6IGdldEJpbGxpbmdDb3VudHJpZXMoKSB8fCBFTVBUWV9BUlJBWSxcbiAgICAgICAgY291bnRyaWVzV2l0aEF1dG9jb21wbGV0ZSxcbiAgICAgICAgY3VzdG9tZXIsXG4gICAgICAgIGN1c3RvbWVyTWVzc2FnZTogY2hlY2tvdXQuY3VzdG9tZXJNZXNzYWdlLFxuICAgICAgICBnZXRGaWVsZHM6IGdldEJpbGxpbmdBZGRyZXNzRmllbGRzLFxuICAgICAgICBnb29nbGVNYXBzQXBpS2V5LFxuICAgICAgICBpbml0aWFsaXplOiBjaGVja291dFNlcnZpY2UubG9hZEJpbGxpbmdBZGRyZXNzRmllbGRzLFxuICAgICAgICBpc0luaXRpYWxpemluZzogaXNMb2FkaW5nQmlsbGluZ0NvdW50cmllcygpLFxuICAgICAgICBpc1VwZGF0aW5nOiBpc1VwZGF0aW5nQmlsbGluZ0FkZHJlc3MoKSB8fCBpc1VwZGF0aW5nQ2hlY2tvdXQoKSxcbiAgICAgICAgbWV0aG9kSWQ6IGdldEJpbGxpbmdNZXRob2RJZChjaGVja291dCksXG4gICAgICAgIHNob3VsZFNob3dPcmRlckNvbW1lbnRzOiBlbmFibGVPcmRlckNvbW1lbnRzICYmIGdldFNoaXBwYWJsZUl0ZW1zQ291bnQoY2FydCkgPCAxLFxuICAgICAgICB1cGRhdGVBZGRyZXNzOiBjaGVja291dFNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3MsXG4gICAgICAgIHVwZGF0ZUNoZWNrb3V0OiBjaGVja291dFNlcnZpY2UudXBkYXRlQ2hlY2tvdXQsXG4gICAgICAgIGlzRmxvYXRpbmdMYWJlbEVuYWJsZWQ6IGlzRmxvYXRpbmdMYWJlbEVuYWJsZWQoY29uZmlnLmNoZWNrb3V0U2V0dGluZ3MpLFxuICAgIH07XG59XG5cbmNvbnN0IG1hcFN0YXRlVG9Qcm9wcyA9IChzdGF0ZTogeyBnbG9iYWw6IHsgaXNCM1VzZXI6IGJvb2xlYW4sIGNoZWNrb3V0U2V0dGluZ3M6IGFueSB9LCBjb21wYW55OiBhbnkgfSkgPT4ge1xuICAgIGNvbnN0IHtcbiAgICAgICAgZ2xvYmFsOiB7XG4gICAgICAgICAgICBpc0IzVXNlcixcbiAgICAgICAgICAgIGNoZWNrb3V0U2V0dGluZ3MsXG4gICAgICAgIH0sXG4gICAgICAgIGNvbXBhbnk6IGIzQ29tcGFueSxcblxuICAgIH0gPSBzdGF0ZVxuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgaXNCM1VzZXIsXG4gICAgICAgIGIzQ29tcGFueSxcbiAgICAgICAgY2hlY2tvdXRTZXR0aW5ncyxcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzKSh3aXRoQ2hlY2tvdXQobWFwVG9CaWxsaW5nUHJvcHMpKEJpbGxpbmcpKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./packages/core/src/app/billing/Billing.tsx\n");

/***/ }),

/***/ "./packages/core/src/app/billing/BillingForm.tsx":
/*!*******************************************************!*\
  !*** ./packages/core/src/app/billing/BillingForm.tsx ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! tslib */ \"./node_modules/tslib/tslib.es6.mjs\");\n/* harmony import */ var formik__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! formik */ \"./node_modules/formik/dist/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-redux */ \"./node_modules/react-redux/lib/index.js\");\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_redux__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var yup__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! yup */ \"./node_modules/yup/lib/index.js\");\n/* harmony import */ var _bigcommerce_checkout_locale__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @bigcommerce/checkout/locale */ \"./packages/locale/src/TranslatedString.tsx\");\n/* harmony import */ var _bigcommerce_checkout_locale__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @bigcommerce/checkout/locale */ \"./packages/locale/src/withLanguage.tsx\");\n/* harmony import */ var _bigcommerce_checkout_paypal_fastlane_integration__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @bigcommerce/checkout/paypal-fastlane-integration */ \"./packages/paypal-fastlane-integration/src/usePayPalFastlaneAddress.ts\");\n/* harmony import */ var _bigcommerce_checkout_ui__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @bigcommerce/checkout/ui */ \"./packages/ui/src/form/LoadingSkeleton/AddressFormSkeleton.tsx\");\n/* harmony import */ var _address__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../address */ \"./packages/core/src/app/address/isValidCustomerAddress.ts\");\n/* harmony import */ var _address__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../address */ \"./packages/core/src/app/address/AddressSelect.tsx\");\n/* harmony import */ var _address__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../address */ \"./packages/core/src/app/address/AddressType.ts\");\n/* harmony import */ var _address__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../address */ \"./packages/core/src/app/address/AddressForm.tsx\");\n/* harmony import */ var _address__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../address */ \"./packages/core/src/app/address/mapAddressToFormValues.ts\");\n/* harmony import */ var _address__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../address */ \"./packages/core/src/app/address/getAddressFormFieldsValidationSchema.ts\");\n/* harmony import */ var _b3checkout__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../b3checkout */ \"./packages/core/src/app/b3checkout/index.ts\");\n/* harmony import */ var _formFields__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../formFields */ \"./packages/core/src/app/formFields/getCustomFormFieldsValidationSchema.ts\");\n/* harmony import */ var _orderComments__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../orderComments */ \"./packages/core/src/app/orderComments/OrderComments.tsx\");\n/* harmony import */ var _ui_button__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../ui/button */ \"./packages/core/src/app/ui/button/Button.tsx\");\n/* harmony import */ var _ui_form__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../ui/form */ \"./packages/core/src/app/ui/form/Form.tsx\");\n/* harmony import */ var _ui_form__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../ui/form */ \"./packages/core/src/app/ui/form/Fieldset.tsx\");\n/* harmony import */ var _ui_loading__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../ui/loading */ \"./packages/core/src/app/ui/loading/LoadingOverlay.tsx\");\n/* harmony import */ var _StaticBillingAddress__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./StaticBillingAddress */ \"./packages/core/src/app/billing/StaticBillingAddress.tsx\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar mapStateToProps = function (state) {\n    var _a = state.global, isB3User = _a.isB3User, checkoutSettings = _a.checkoutSettings, b3Company = state.company;\n    return {\n        b3Company: b3Company,\n        isB3User: isB3User,\n        checkoutSettings: checkoutSettings,\n    };\n};\nvar BillingForm = function (_a) {\n    var googleMapsApiKey = _a.googleMapsApiKey, billingAddress = _a.billingAddress, countriesWithAutocomplete = _a.countriesWithAutocomplete, _b = _a.customer, addresses = _b.addresses, isGuest = _b.isGuest, getFields = _a.getFields, countries = _a.countries, isUpdating = _a.isUpdating, setFieldValue = _a.setFieldValue, shouldShowOrderComments = _a.shouldShowOrderComments, values = _a.values, methodId = _a.methodId, isFloatingLabelEnabled = _a.isFloatingLabelEnabled, updateAddress = _a.updateAddress, onUnhandledError = _a.onUnhandledError, b3Company = _a.b3Company, isB3User = _a.isB3User, checkoutSettings = _a.checkoutSettings, type = _a.type, setValues = _a.setValues;\n    var _c = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false), isResettingAddress = _c[0], setIsResettingAddress = _c[1];\n    var addressFormRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    var _d = (0,_bigcommerce_checkout_paypal_fastlane_integration__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(), isPayPalFastlaneEnabled = _d.isPayPalFastlaneEnabled, paypalFastlaneAddresses = _d.paypalFastlaneAddresses;\n    var shouldShowSaveAddress = function () {\n        var _a = _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].utils, storage = _a.storage, constants = _a.constants;\n        var B3RoleId = storage.B3RoleId.getValue();\n        var _b = constants.B3Role, ADMIN = _b.ADMIN, SENIOR = _b.SENIOR;\n        return isB3User\n            ? [ADMIN, SENIOR].includes(B3RoleId)\n            : !isGuest;\n    };\n    var shouldShowSaveAddressInCheckoutSettings = function () {\n        return checkoutSettings['billing.address.save'];\n    };\n    var b2bAddresses = function () {\n        return isB3User\n            ? b3Company.addresses.filter(function (address) { return address.isBilling === 1; })\n            : addresses;\n    };\n    var validateAddress = function () {\n        var formFields = getFields(billingAddress === null || billingAddress === void 0 ? void 0 : billingAddress.countryCode);\n        var allAdresses = b2bAddresses();\n        var isValidateExtrasField = _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].extrasFiles.isValidExtrasFiles('billing');\n        return isValidateExtrasField && _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].utils.util.validateAddress(billingAddress, allAdresses, formFields);\n    };\n    var shouldShowEnterNewAddress = function () {\n        return checkoutSettings['billing.address.add'];\n    };\n    var shouldRenderStaticAddress = methodId === 'amazonpay';\n    var allFormFields = getFields(values.countryCode);\n    var customFormFields = allFormFields.filter(function (_a) {\n        var custom = _a.custom;\n        return custom;\n    });\n    var hasCustomFormFields = customFormFields.length > 0;\n    var editableFormFields = shouldRenderStaticAddress && hasCustomFormFields ? customFormFields : allFormFields;\n    var billingAddresses = isPayPalFastlaneEnabled ? paypalFastlaneAddresses : b2bAddresses();\n    var hasAddresses = (billingAddresses === null || billingAddresses === void 0 ? void 0 : billingAddresses.length) > 0;\n    var bcValidCustomerAddress = function () {\n        return billingAddress &&\n            (0,_address__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(billingAddress, billingAddresses, getFields(billingAddress.countryCode));\n    };\n    var hasValidCustomerAddress = isB3User ? validateAddress() : bcValidCustomerAddress();\n    var handleSelectAddress = function (address) { return (0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(void 0, void 0, void 0, function () {\n        var isEditAddress, getB2bCustomFields, addressBilling_1, isValidAddress, addressBilling_2, error_1;\n        var _a;\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_7__.__generator)(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    setIsResettingAddress(true);\n                    _b.label = 1;\n                case 1:\n                    _b.trys.push([1, 6, 7, 8]);\n                    if (isB3User)\n                        _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].utils.storage.selectBillAddressId.setValue(address === null || address === void 0 ? void 0 : address.addressId);\n                    if (!((_a = _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].extrasFiles.getB3BillingAddressExtras()) === null || _a === void 0 ? void 0 : _a.length)) return [3 /*break*/, 4];\n                    isEditAddress = _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].extrasFiles.setAddressExtrasFiles(isB3User, address, false);\n                    getB2bCustomFields = isB3User ? _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].extrasFiles.setAddressSelectExtrasFiles(address) : {};\n                    addressBilling_1 = (0,tslib__WEBPACK_IMPORTED_MODULE_7__.__assign)({}, values);\n                    Object.keys(addressBilling_1).map(function (item) {\n                        if (item !== 'orderComment') {\n                            addressBilling_1[item] = address[item] || '';\n                        }\n                    });\n                    if (!!isEditAddress) return [3 /*break*/, 3];\n                    return [4 /*yield*/, updateAddress(_b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].utils.address.addressFieldOptimize(address))];\n                case 2:\n                    _b.sent();\n                    _b.label = 3;\n                case 3:\n                    setValues((0,tslib__WEBPACK_IMPORTED_MODULE_7__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_7__.__assign)({}, addressBilling_1), { addressId: '', b2bCustomFields: getB2bCustomFields }));\n                    return [2 /*return*/];\n                case 4: return [4 /*yield*/, updateAddress(_b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].utils.address.addressFieldOptimize(address))];\n                case 5:\n                    _b.sent();\n                    isValidAddress = (0,_address__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(address, billingAddresses, getFields(address.countryCode));\n                    addressBilling_2 = (0,tslib__WEBPACK_IMPORTED_MODULE_7__.__assign)({}, values);\n                    Object.keys(addressBilling_2).map(function (item) {\n                        if (item !== 'orderComment') {\n                            addressBilling_2[item] = address[item] || '';\n                        }\n                    });\n                    if (isValidAddress)\n                        setValues((0,tslib__WEBPACK_IMPORTED_MODULE_7__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_7__.__assign)({}, addressBilling_2), { addressId: '' }));\n                    return [3 /*break*/, 8];\n                case 6:\n                    error_1 = _b.sent();\n                    if (error_1 instanceof Error) {\n                        onUnhandledError(error_1);\n                    }\n                    return [3 /*break*/, 8];\n                case 7:\n                    setIsResettingAddress(false);\n                    return [7 /*endfinally*/];\n                case 8: return [2 /*return*/];\n            }\n        });\n    }); };\n    var handleUseNewAddress = function () { return (0,tslib__WEBPACK_IMPORTED_MODULE_7__.__awaiter)(void 0, void 0, void 0, function () {\n        return (0,tslib__WEBPACK_IMPORTED_MODULE_7__.__generator)(this, function (_a) {\n            handleSelectAddress({});\n            return [2 /*return*/];\n        });\n    }); };\n    return (react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ui_form__WEBPACK_IMPORTED_MODULE_8__[\"default\"], { autoComplete: \"on\" },\n        shouldRenderStaticAddress && billingAddress && (react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"div\", { className: \"form-fieldset\" },\n            react__WEBPACK_IMPORTED_MODULE_1__.createElement(_StaticBillingAddress__WEBPACK_IMPORTED_MODULE_9__[\"default\"], { address: billingAddress }))),\n        react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ui_form__WEBPACK_IMPORTED_MODULE_10__[\"default\"], { id: \"checkoutBillingAddress\", ref: addressFormRef },\n            hasAddresses && !shouldRenderStaticAddress && (react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ui_form__WEBPACK_IMPORTED_MODULE_10__[\"default\"], { id: \"billingAddresses\" },\n                react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ui_loading__WEBPACK_IMPORTED_MODULE_11__[\"default\"], { isLoading: isResettingAddress },\n                    react__WEBPACK_IMPORTED_MODULE_1__.createElement(_address__WEBPACK_IMPORTED_MODULE_12__[\"default\"], { addresses: billingAddresses, onSelectAddress: handleSelectAddress, onUseNewAddress: handleUseNewAddress, selectedAddress: hasValidCustomerAddress ? billingAddress : undefined, type: _address__WEBPACK_IMPORTED_MODULE_13__[\"default\"].Billing })))),\n            shouldShowEnterNewAddress() && isB3User && (react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"p\", null,\n                react__WEBPACK_IMPORTED_MODULE_1__.createElement(_bigcommerce_checkout_locale__WEBPACK_IMPORTED_MODULE_14__[\"default\"], { id: 'remote.or_text' }),\n                \" \",\n                react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"a\", { onClick: function () { return handleUseNewAddress(); } }, _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].locales.tips['b3.addresses.enterNew']))),\n            !hasValidCustomerAddress && (!isB3User || shouldShowEnterNewAddress()) && (react__WEBPACK_IMPORTED_MODULE_1__.createElement(_bigcommerce_checkout_ui__WEBPACK_IMPORTED_MODULE_15__[\"default\"], { isLoading: isResettingAddress },\n                react__WEBPACK_IMPORTED_MODULE_1__.createElement(_address__WEBPACK_IMPORTED_MODULE_16__[\"default\"], { countries: countries, countriesWithAutocomplete: countriesWithAutocomplete, countryCode: values.countryCode, formFields: editableFormFields, googleMapsApiKey: googleMapsApiKey, isFloatingLabelEnabled: isFloatingLabelEnabled, isLoadingB2bAddress: true, setFieldValue: setFieldValue, shouldShowSaveAddress: shouldShowSaveAddress() && shouldShowSaveAddressInCheckoutSettings(), type: type })))),\n        shouldShowOrderComments && react__WEBPACK_IMPORTED_MODULE_1__.createElement(_orderComments__WEBPACK_IMPORTED_MODULE_17__[\"default\"], null),\n        react__WEBPACK_IMPORTED_MODULE_1__.createElement(\"div\", { className: \"form-actions\" },\n            react__WEBPACK_IMPORTED_MODULE_1__.createElement(_ui_button__WEBPACK_IMPORTED_MODULE_18__[\"default\"], { disabled: isUpdating || isResettingAddress, id: \"checkout-billing-continue\", isLoading: isUpdating || isResettingAddress, type: \"submit\", variant: _ui_button__WEBPACK_IMPORTED_MODULE_18__.ButtonVariant.Primary },\n                react__WEBPACK_IMPORTED_MODULE_1__.createElement(_bigcommerce_checkout_locale__WEBPACK_IMPORTED_MODULE_14__[\"default\"], { id: \"common.continue_action\" })))));\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,react_redux__WEBPACK_IMPORTED_MODULE_2__.connect)(mapStateToProps)((0,_bigcommerce_checkout_locale__WEBPACK_IMPORTED_MODULE_19__[\"default\"])((0,formik__WEBPACK_IMPORTED_MODULE_0__.withFormik)({\n    handleSubmit: function (values, _a) {\n        var onSubmit = _a.props.onSubmit;\n        onSubmit(values);\n    },\n    mapPropsToValues: function (_a) {\n        var getFields = _a.getFields, customerMessage = _a.customerMessage, billingAddress = _a.billingAddress;\n        return ((0,tslib__WEBPACK_IMPORTED_MODULE_7__.__assign)((0,tslib__WEBPACK_IMPORTED_MODULE_7__.__assign)({}, (0,_address__WEBPACK_IMPORTED_MODULE_20__[\"default\"])(getFields(billingAddress && billingAddress.countryCode), billingAddress)), { b2bCustomFields: _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].extrasFiles.setGoBackEcho('billing'), orderComment: customerMessage }));\n    },\n    isInitialValid: function (_a) {\n        var billingAddress = _a.billingAddress, getFields = _a.getFields, language = _a.language;\n        return (!!billingAddress && (0,_address__WEBPACK_IMPORTED_MODULE_21__[\"default\"])({\n            language: language,\n            formFields: getFields(billingAddress.countryCode),\n        }).isValidSync(billingAddress));\n    },\n    validationSchema: function (_a) {\n        var language = _a.language, getFields = _a.getFields, methodId = _a.methodId;\n        return methodId === 'amazonpay' ?\n            ((0,yup__WEBPACK_IMPORTED_MODULE_3__.lazy)(function (values) { return (0,_formFields__WEBPACK_IMPORTED_MODULE_22__[\"default\"])({\n                translate: (0,_address__WEBPACK_IMPORTED_MODULE_21__.getTranslateAddressError)(language),\n                formFields: getFields(values && values.countryCode),\n            }); })) :\n            ((0,yup__WEBPACK_IMPORTED_MODULE_3__.lazy)(function (values) {\n                return (0,_address__WEBPACK_IMPORTED_MODULE_21__[\"default\"])({\n                    language: language,\n                    formFields: getFields(values && values.countryCode),\n                }).concat((0,yup__WEBPACK_IMPORTED_MODULE_3__.object)({\n                    b2bCustomFields: _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].extrasFiles.getB3FormFieldsValidationSchema({\n                        translate: _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].extrasFiles.getTranslateAddressError(language),\n                        formFields: _b3checkout__WEBPACK_IMPORTED_MODULE_5__[\"default\"].extrasFiles.getB3ShippingAddressExtras(),\n                    })\n                }));\n            }));\n    },\n    enableReinitialize: true,\n})(BillingForm))));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWNrYWdlcy9jb3JlL3NyYy9hcHAvYmlsbGluZy9CaWxsaW5nRm9ybS50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFPaUQ7QUFDVTtBQUN0QjtBQUNGO0FBRThEO0FBQ0o7QUFDOUI7QUFXM0M7QUFDa0I7QUFFOEI7QUFDbkI7QUFDSTtBQUNUO0FBQ0c7QUFFVTtBQTRCekQsSUFBTSxlQUFlLEdBQUcsVUFBQyxLQUE2RTtJQUU5RixTQUtBLEtBQUssT0FGSixFQUZHLFFBQVEsZ0JBQ1IsZ0JBQWdCLHdCQUVYLFNBQVMsR0FDbEIsS0FBSyxRQURhLENBQ2I7SUFFVCxPQUFPO1FBQ0gsU0FBUztRQUNULFFBQVE7UUFDUixnQkFBZ0I7S0FDbkI7QUFDTCxDQUFDO0FBR0QsSUFBTSxXQUFXLEdBQUcsVUFBQyxFQW9CNkQ7UUFuQjlFLGdCQUFnQix3QkFDaEIsY0FBYyxzQkFDZCx5QkFBeUIsaUNBQ3pCLGdCQUFnQyxFQUFwQixTQUFTLGlCQUFFLE9BQU8sZUFDOUIsU0FBUyxpQkFDVCxTQUFTLGlCQUNULFVBQVUsa0JBQ1YsYUFBYSxxQkFDYix1QkFBdUIsK0JBQ3ZCLE1BQU0sY0FDTixRQUFRLGdCQUNSLHNCQUFzQiw4QkFDdEIsYUFBYSxxQkFDYixnQkFBZ0Isd0JBQ2hCLFNBQVMsaUJBQ1QsUUFBUSxnQkFDUixnQkFBZ0Isd0JBQ2hCLElBQUksWUFDSixTQUFTO0lBRUgsU0FBOEMsK0NBQVEsQ0FBQyxLQUFLLENBQUMsRUFBNUQsa0JBQWtCLFVBQUUscUJBQXFCLFFBQW1CLENBQUM7SUFDcEUsSUFBTSxjQUFjLEdBQW1DLDZDQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDOUQsU0FBdUQsNkZBQXdCLEVBQUUsRUFBL0UsdUJBQXVCLCtCQUFFLHVCQUF1Qiw2QkFBK0IsQ0FBQztJQUV4RixJQUFNLHFCQUFxQixHQUFHO1FBQ3BCLFNBR0YsbURBQVUsQ0FBQyxLQUFLLEVBRmhCLE9BQU8sZUFDUCxTQUFTLGVBQ087UUFF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O1lBQ04sQ0FBQyx5Q0FBSSxDQUE2QixnQkFBTTtnQkFDcEMsT0FBTyxxREFBb0MsQ0FBQztvQkFDeEMsUUFBUTtvQkFDUixVQUFVLEVBQUUsU0FBUyxDQUFDLE1BQU0sSUFBSSxNQUFNLENBQUMsV0FBVyxDQUFDO2lCQUN0RCxDQUFDLENBQUMsTUFBTSxDQUFDLDJDQUFNLENBQUM7b0JBQ2IsZUFBZSxFQUFFLG1EQUFVLENBQUMsV0FBVyxDQUFDLCtCQUErQixDQUFDO3dCQUNwRSxTQUFTLEVBQUUsbURBQVUsQ0FBQyxXQUFXLENBQUMsd0JBQXdCLENBQUMsUUFBUSxDQUFDO3dCQUNwRSxVQUFVLEVBQUUsbURBQVUsQ0FBQyxXQUFXLENBQUMsMEJBQTBCLEVBQUU7cUJBQ2xFLENBQUM7aUJBQ0wsQ0FBQyxDQUFDO1lBQ1AsQ0FBQyxDQUFDLENBQUM7SUFmaUMsQ0FlakM7SUFDWCxrQkFBa0IsRUFBRSxJQUFJO0NBQzNCLENBQUMsQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2hlY2tvdXQvLi9wYWNrYWdlcy9jb3JlL3NyYy9hcHAvYmlsbGluZy9CaWxsaW5nRm9ybS50c3g/YTIwNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICAgIEFkZHJlc3MsXG4gICAgQ2hlY2tvdXRTZWxlY3RvcnMsXG4gICAgQ291bnRyeSxcbiAgICBDdXN0b21lcixcbiAgICBGb3JtRmllbGQsXG59IGZyb20gJ0BiaWdjb21tZXJjZS9jaGVja291dC1zZGsnO1xuaW1wb3J0IHsgRm9ybWlrUHJvcHMsIHdpdGhGb3JtaWsgfSBmcm9tICdmb3JtaWsnO1xuaW1wb3J0IFJlYWN0LCB7IFJlZk9iamVjdCAsdXNlUmVmLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tICdyZWFjdC1yZWR1eCdcbmltcG9ydCB7IGxhenksIG9iamVjdCB9IGZyb20gJ3l1cCc7XG5cbmltcG9ydCB7IFRyYW5zbGF0ZWRTdHJpbmcsIHdpdGhMYW5ndWFnZSwgV2l0aExhbmd1YWdlUHJvcHMgfSBmcm9tICdAYmlnY29tbWVyY2UvY2hlY2tvdXQvbG9jYWxlJztcbmltcG9ydCB7IHVzZVBheVBhbEZhc3RsYW5lQWRkcmVzcyB9IGZyb20gJ0BiaWdjb21tZXJjZS9jaGVja291dC9wYXlwYWwtZmFzdGxhbmUtaW50ZWdyYXRpb24nO1xuaW1wb3J0IHsgQWRkcmVzc0Zvcm1Ta2VsZXRvbiB9IGZyb20gJ0BiaWdjb21tZXJjZS9jaGVja291dC91aSc7XG5cbmltcG9ydCB7XG4gICAgQWRkcmVzc0Zvcm0sXG4gICAgQWRkcmVzc0Zvcm1WYWx1ZXMsXG4gICAgQWRkcmVzc1NlbGVjdCxcbiAgICBBZGRyZXNzVHlwZSxcbiAgICBnZXRBZGRyZXNzRm9ybUZpZWxkc1ZhbGlkYXRpb25TY2hlbWEsXG4gICAgZ2V0VHJhbnNsYXRlQWRkcmVzc0Vycm9yLFxuICAgIGlzVmFsaWRDdXN0b21lckFkZHJlc3MsXG4gICAgbWFwQWRkcmVzc1RvRm9ybVZhbHVlcyxcbn0gZnJvbSAnLi4vYWRkcmVzcyc7XG5pbXBvcnQgQjNDaGVja291dCBmcm9tICcuLi9iM2NoZWNrb3V0J1xuaW1wb3J0IENoZWNrb3V0U3RlcFR5cGUgZnJvbSAnLi4vY2hlY2tvdXQvQ2hlY2tvdXRTdGVwVHlwZSc7XG5pbXBvcnQgeyBnZXRDdXN0b21Gb3JtRmllbGRzVmFsaWRhdGlvblNjaGVtYSB9IGZyb20gJy4uL2Zvcm1GaWVsZHMnO1xuaW1wb3J0IHsgT3JkZXJDb21tZW50cyB9IGZyb20gJy4uL29yZGVyQ29tbWVudHMnO1xuaW1wb3J0IHsgQnV0dG9uLCBCdXR0b25WYXJpYW50IH0gZnJvbSAnLi4vdWkvYnV0dG9uJztcbmltcG9ydCB7IEZpZWxkc2V0LCBGb3JtIH0gZnJvbSAnLi4vdWkvZm9ybSc7XG5pbXBvcnQgeyBMb2FkaW5nT3ZlcmxheSB9IGZyb20gJy4uL3VpL2xvYWRpbmcnO1xuXG5pbXBvcnQgU3RhdGljQmlsbGluZ0FkZHJlc3MgZnJvbSAnLi9TdGF0aWNCaWxsaW5nQWRkcmVzcydcblxuZXhwb3J0IHR5cGUgQmlsbGluZ0Zvcm1WYWx1ZXMgPSBBZGRyZXNzRm9ybVZhbHVlcyAmIHsgb3JkZXJDb21tZW50OiBzdHJpbmcgfSAmIHsgYjJiQ3VzdG9tRmllbGRzPzogYW55IH1cblxuZXhwb3J0IGludGVyZmFjZSBCaWxsaW5nRm9ybVByb3BzIHtcbiAgICBiaWxsaW5nQWRkcmVzcz86IEFkZHJlc3NcbiAgICBjb3VudHJpZXM6IENvdW50cnlbXVxuICAgIGNvdW50cmllc1dpdGhBdXRvY29tcGxldGU6IHN0cmluZ1tdXG4gICAgY3VzdG9tZXI6IEN1c3RvbWVyXG4gICAgY3VzdG9tZXJNZXNzYWdlOiBzdHJpbmdcbiAgICBnb29nbGVNYXBzQXBpS2V5OiBzdHJpbmdcbiAgICBpc1VwZGF0aW5nOiBib29sZWFuXG4gICAgbWV0aG9kSWQ/OiBzdHJpbmdcbiAgICBzaG91bGRTaG93T3JkZXJDb21tZW50czogYm9vbGVhblxuICAgIGlzRmxvYXRpbmdMYWJlbEVuYWJsZWQ/OiBib29sZWFuXG4gICAgZ2V0RmllbGRzKGNvdW50cnlDb2RlPzogc3RyaW5nKTogRm9ybUZpZWxkW11cbiAgICBvblN1Ym1pdCh2YWx1ZXM6IEJpbGxpbmdGb3JtVmFsdWVzKTogdm9pZFxuICAgIG9uVW5oYW5kbGVkRXJyb3IoZXJyb3I6IEVycm9yKTogdm9pZFxuICAgIHVwZGF0ZUFkZHJlc3MoYWRkcmVzczogUGFydGlhbDxBZGRyZXNzPik6IFByb21pc2U8Q2hlY2tvdXRTZWxlY3RvcnM+XG4gICAgdHlwZTogQ2hlY2tvdXRTdGVwVHlwZVxufVxuXG5pbnRlcmZhY2UgQjNQcm9wcyB7XG4gICAgYjNDb21wYW55OiBhbnlcbiAgICBpc0IzVXNlcjogYm9vbGVhblxuICAgIGNoZWNrb3V0U2V0dGluZ3M6IGFueVxufVxuXG5jb25zdCBtYXBTdGF0ZVRvUHJvcHMgPSAoc3RhdGU6IHsgZ2xvYmFsOiB7IGlzQjNVc2VyOiBib29sZWFuLCBjaGVja291dFNldHRpbmdzOiBhbnkgfSwgY29tcGFueTogYW55IH0pID0+IHtcbiAgICBjb25zdCB7XG4gICAgICAgIGdsb2JhbDoge1xuICAgICAgICAgICAgaXNCM1VzZXIsXG4gICAgICAgICAgICBjaGVja291dFNldHRpbmdzLFxuICAgICAgICB9LFxuICAgICAgICBjb21wYW55OiBiM0NvbXBhbnlcbiAgICB9ID0gc3RhdGVcblxuICAgIHJldHVybiB7XG4gICAgICAgIGIzQ29tcGFueSxcbiAgICAgICAgaXNCM1VzZXIsXG4gICAgICAgIGNoZWNrb3V0U2V0dGluZ3MsXG4gICAgfVxufVxuXG5cbmNvbnN0IEJpbGxpbmdGb3JtID0gKHtcbiAgICBnb29nbGVNYXBzQXBpS2V5LFxuICAgIGJpbGxpbmdBZGRyZXNzLFxuICAgIGNvdW50cmllc1dpdGhBdXRvY29tcGxldGUsXG4gICAgY3VzdG9tZXI6IHsgYWRkcmVzc2VzLCBpc0d1ZXN0IH0sXG4gICAgZ2V0RmllbGRzLFxuICAgIGNvdW50cmllcyxcbiAgICBpc1VwZGF0aW5nLFxuICAgIHNldEZpZWxkVmFsdWUsXG4gICAgc2hvdWxkU2hvd09yZGVyQ29tbWVudHMsXG4gICAgdmFsdWVzLFxuICAgIG1ldGhvZElkLFxuICAgIGlzRmxvYXRpbmdMYWJlbEVuYWJsZWQsXG4gICAgdXBkYXRlQWRkcmVzcyxcbiAgICBvblVuaGFuZGxlZEVycm9yLFxuICAgIGIzQ29tcGFueSxcbiAgICBpc0IzVXNlcixcbiAgICBjaGVja291dFNldHRpbmdzLFxuICAgIHR5cGUsXG4gICAgc2V0VmFsdWVzLFxufTogQjNQcm9wcyAmIEJpbGxpbmdGb3JtUHJvcHMgJiBXaXRoTGFuZ3VhZ2VQcm9wcyAmIEZvcm1pa1Byb3BzPEJpbGxpbmdGb3JtVmFsdWVzPikgPT4ge1xuICAgIGNvbnN0IFtpc1Jlc2V0dGluZ0FkZHJlc3MsIHNldElzUmVzZXR0aW5nQWRkcmVzc10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gICAgY29uc3QgYWRkcmVzc0Zvcm1SZWY6IFJlZk9iamVjdDxIVE1MRmllbGRTZXRFbGVtZW50PiA9IHVzZVJlZihudWxsKTtcbiAgICBjb25zdCB7IGlzUGF5UGFsRmFzdGxhbmVFbmFibGVkLCBwYXlwYWxGYXN0bGFuZUFkZHJlc3NlcyB9ID0gdXNlUGF5UGFsRmFzdGxhbmVBZGRyZXNzKCk7XG5cbiAgICBjb25zdCBzaG91bGRTaG93U2F2ZUFkZHJlc3MgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIHN0b3JhZ2UsXG4gICAgICAgICAgICBjb25zdGFudHMsXG4gICAgICAgIH0gPSBCM0NoZWNrb3V0LnV0aWxzXG5cbiAgICAgICAgY29uc3QgQjNSb2xlSWQgPSBzdG9yYWdlLkIzUm9sZUlkLmdldFZhbHVlKClcblxuICAgICAgICBjb25zdCB7IEFETUlOLCBTRU5JT1IgfSA9IGNvbnN0YW50cy5CM1JvbGVcbiAgICBcbiAgICAgICAgcmV0dXJuIGlzQjNVc2VyXG4gICAgICAgICAgICA/IFtBRE1JTiwgU0VOSU9SXS5pbmNsdWRlcyhCM1JvbGVJZClcbiAgICAgICAgICAgIDogIWlzR3Vlc3RcbiAgICB9XG5cbiAgICBjb25zdCBzaG91bGRTaG93U2F2ZUFkZHJlc3NJbkNoZWNrb3V0U2V0dGluZ3MgPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiBjaGVja291dFNldHRpbmdzWydiaWxsaW5nLmFkZHJlc3Muc2F2ZSddXG4gICAgfVxuXG4gICAgY29uc3QgYjJiQWRkcmVzc2VzID0gKCkgPT4ge1xuXG4gICAgICAgIHJldHVybiBpc0IzVXNlclxuICAgICAgICAgICAgPyBiM0NvbXBhbnkuYWRkcmVzc2VzLmZpbHRlcigoYWRkcmVzczogeyBpc0JpbGxpbmc6IG51bWJlciB9KSA9PiBhZGRyZXNzLmlzQmlsbGluZyA9PT0gMSlcbiAgICAgICAgICAgIDogYWRkcmVzc2VzXG4gICAgfVxuXG4gICAgY29uc3QgdmFsaWRhdGVBZGRyZXNzID0gKCkgPT4ge1xuXG4gICAgICAgIGNvbnN0IGZvcm1GaWVsZHMgPSBnZXRGaWVsZHMoYmlsbGluZ0FkZHJlc3M/LmNvdW50cnlDb2RlKVxuXG4gICAgICAgIGNvbnN0IGFsbEFkcmVzc2VzID0gYjJiQWRkcmVzc2VzKClcblxuICAgICAgICBjb25zdCBpc1ZhbGlkYXRlRXh0cmFzRmllbGQgPSBCM0NoZWNrb3V0LmV4dHJhc0ZpbGVzLmlzVmFsaWRFeHRyYXNGaWxlcygnYmlsbGluZycpXG5cbiAgICAgICAgcmV0dXJuIGlzVmFsaWRhdGVFeHRyYXNGaWVsZCAmJiBCM0NoZWNrb3V0LnV0aWxzLnV0aWwudmFsaWRhdGVBZGRyZXNzKGJpbGxpbmdBZGRyZXNzLCBhbGxBZHJlc3NlcywgZm9ybUZpZWxkcylcbiAgICB9XG5cbiAgICBjb25zdCBzaG91bGRTaG93RW50ZXJOZXdBZGRyZXNzID0gKCkgPT4ge1xuXG4gICAgICAgIHJldHVybiBjaGVja291dFNldHRpbmdzWydiaWxsaW5nLmFkZHJlc3MuYWRkJ11cbiAgICB9XG5cbiAgICBjb25zdCBzaG91bGRSZW5kZXJTdGF0aWNBZGRyZXNzID0gbWV0aG9kSWQgPT09ICdhbWF6b25wYXknO1xuICAgIGNvbnN0IGFsbEZvcm1GaWVsZHMgPSBnZXRGaWVsZHModmFsdWVzLmNvdW50cnlDb2RlKTtcbiAgICBjb25zdCBjdXN0b21Gb3JtRmllbGRzID0gYWxsRm9ybUZpZWxkcy5maWx0ZXIoKHsgY3VzdG9tIH0pID0+IGN1c3RvbSk7XG4gICAgY29uc3QgaGFzQ3VzdG9tRm9ybUZpZWxkcyA9IGN1c3RvbUZvcm1GaWVsZHMubGVuZ3RoID4gMDtcbiAgICBjb25zdCBlZGl0YWJsZUZvcm1GaWVsZHMgPVxuICAgICAgICBzaG91bGRSZW5kZXJTdGF0aWNBZGRyZXNzICYmIGhhc0N1c3RvbUZvcm1GaWVsZHMgPyBjdXN0b21Gb3JtRmllbGRzIDogYWxsRm9ybUZpZWxkcztcbiAgICBjb25zdCBiaWxsaW5nQWRkcmVzc2VzID0gaXNQYXlQYWxGYXN0bGFuZUVuYWJsZWQgPyBwYXlwYWxGYXN0bGFuZUFkZHJlc3NlcyA6IGIyYkFkZHJlc3NlcygpO1xuICAgIGNvbnN0IGhhc0FkZHJlc3NlcyA9IGJpbGxpbmdBZGRyZXNzZXM/Lmxlbmd0aCA+IDA7XG4gICAgY29uc3QgYmNWYWxpZEN1c3RvbWVyQWRkcmVzcyA9ICgpID0+IHtcbiAgICAgICAgcmV0dXJuIGJpbGxpbmdBZGRyZXNzICYmXG4gICAgICAgIGlzVmFsaWRDdXN0b21lckFkZHJlc3MoXG4gICAgICAgICAgICBiaWxsaW5nQWRkcmVzcyxcbiAgICAgICAgICAgIGJpbGxpbmdBZGRyZXNzZXMsXG4gICAgICAgICAgICBnZXRGaWVsZHMoYmlsbGluZ0FkZHJlc3MuY291bnRyeUNvZGUpLFxuICAgICAgICApXG4gICAgfVxuICAgIGNvbnN0IGhhc1ZhbGlkQ3VzdG9tZXJBZGRyZXNzID0gaXNCM1VzZXIgPyAgdmFsaWRhdGVBZGRyZXNzKCkgOiBiY1ZhbGlkQ3VzdG9tZXJBZGRyZXNzKClcbiAgICAgICAgXG5cbiAgICBjb25zdCBoYW5kbGVTZWxlY3RBZGRyZXNzID0gYXN5bmMgKGFkZHJlc3M6IFBhcnRpYWw8QWRkcmVzcz4pID0+IHtcbiAgICAgICAgc2V0SXNSZXNldHRpbmdBZGRyZXNzKHRydWUpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoaXNCM1VzZXIpIEIzQ2hlY2tvdXQudXRpbHMuc3RvcmFnZS5zZWxlY3RCaWxsQWRkcmVzc0lkLnNldFZhbHVlKChhZGRyZXNzIGFzIGFueSk/LmFkZHJlc3NJZClcblxuICAgICAgICAgICAgaWYgKEIzQ2hlY2tvdXQuZXh0cmFzRmlsZXMuZ2V0QjNCaWxsaW5nQWRkcmVzc0V4dHJhcygpPy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpc0VkaXRBZGRyZXNzID0gQjNDaGVja291dC5leHRyYXNGaWxlcy5zZXRBZGRyZXNzRXh0cmFzRmlsZXMoaXNCM1VzZXIsIGFkZHJlc3MsIGZhbHNlKVxuICAgICAgICAgICAgICAgIGNvbnN0IGdldEIyYkN1c3RvbUZpZWxkcyA9IGlzQjNVc2VyID8gQjNDaGVja291dC5leHRyYXNGaWxlcy5zZXRBZGRyZXNzU2VsZWN0RXh0cmFzRmlsZXMoYWRkcmVzcykgOiB7fVxuICAgICAgICAgICAgICAgIGNvbnN0IGFkZHJlc3NCaWxsaW5nOiBhbnkgPSB7IC4uLnZhbHVlcyB9XG5cbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhhZGRyZXNzQmlsbGluZykubWFwKChpdGVtOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gIT09ICdvcmRlckNvbW1lbnQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzQmlsbGluZ1tpdGVtXSA9IChhZGRyZXNzIGFzIGFueSlbaXRlbV0gfHwgJydcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgaWYgKCFpc0VkaXRBZGRyZXNzKSBhd2FpdCB1cGRhdGVBZGRyZXNzKEIzQ2hlY2tvdXQudXRpbHMuYWRkcmVzcy5hZGRyZXNzRmllbGRPcHRpbWl6ZShhZGRyZXNzKSlcbiAgICAgICAgICAgICAgICBzZXRWYWx1ZXMoe1xuICAgICAgICAgICAgICAgICAgICAuLi5hZGRyZXNzQmlsbGluZyxcbiAgICAgICAgICAgICAgICAgICAgYWRkcmVzc0lkOiAnJyxcbiAgICAgICAgICAgICAgICAgICAgYjJiQ3VzdG9tRmllbGRzOiBnZXRCMmJDdXN0b21GaWVsZHNcbiAgICAgICAgICAgICAgICB9IGFzIEJpbGxpbmdGb3JtVmFsdWVzKVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICB9XG4gXG4gICAgICAgICAgICAgICAgYXdhaXQgdXBkYXRlQWRkcmVzcyhCM0NoZWNrb3V0LnV0aWxzLmFkZHJlc3MuYWRkcmVzc0ZpZWxkT3B0aW1pemUoYWRkcmVzcykpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgaXNWYWxpZEFkZHJlc3MgPSBpc1ZhbGlkQ3VzdG9tZXJBZGRyZXNzKFxuICAgICAgICAgICAgICAgICAgICAoYWRkcmVzcyBhcyBhbnkpLFxuICAgICAgICAgICAgICAgICAgICBiaWxsaW5nQWRkcmVzc2VzLFxuICAgICAgICAgICAgICAgICAgICBnZXRGaWVsZHMoYWRkcmVzcy5jb3VudHJ5Q29kZSksXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIGNvbnN0IGFkZHJlc3NCaWxsaW5nOiBhbnkgPSB7IC4uLnZhbHVlcyB9XG5cbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhhZGRyZXNzQmlsbGluZykubWFwKChpdGVtOiBhbnkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0gIT09ICdvcmRlckNvbW1lbnQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzQmlsbGluZ1tpdGVtXSA9IChhZGRyZXNzIGFzIGFueSlbaXRlbV0gfHwgJydcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgaWYgKGlzVmFsaWRBZGRyZXNzKSBzZXRWYWx1ZXMoe1xuICAgICAgICAgICAgICAgICAgICAuLi5hZGRyZXNzQmlsbGluZyxcbiAgICAgICAgICAgICAgICAgICAgYWRkcmVzc0lkOiAnJyxcbiAgICAgICAgICAgICAgICB9IGFzIEJpbGxpbmdGb3JtVmFsdWVzKVxuICAgICAgICAgICAgXG5cbiAgIFxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgICAgICAgICBvblVuaGFuZGxlZEVycm9yKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIHNldElzUmVzZXR0aW5nQWRkcmVzcyhmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgaGFuZGxlVXNlTmV3QWRkcmVzcyA9IGFzeW5jICgpID0+IHtcbiAgICAgICAgaGFuZGxlU2VsZWN0QWRkcmVzcyh7fSk7XG4gICAgfTtcblxuICAgIHJldHVybiAoXG4gICAgICAgIDxGb3JtIGF1dG9Db21wbGV0ZT1cIm9uXCI+XG4gICAgICAgICAgICB7c2hvdWxkUmVuZGVyU3RhdGljQWRkcmVzcyAmJiBiaWxsaW5nQWRkcmVzcyAmJiAoXG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmb3JtLWZpZWxkc2V0XCI+XG4gICAgICAgICAgICAgICAgICAgIDxTdGF0aWNCaWxsaW5nQWRkcmVzcyBhZGRyZXNzPXtiaWxsaW5nQWRkcmVzc30gLz5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICl9XG5cbiAgICAgICAgICAgIDxGaWVsZHNldCBpZD1cImNoZWNrb3V0QmlsbGluZ0FkZHJlc3NcIiByZWY9e2FkZHJlc3NGb3JtUmVmfT5cbiAgICAgICAgICAgICAgICB7aGFzQWRkcmVzc2VzICYmICFzaG91bGRSZW5kZXJTdGF0aWNBZGRyZXNzICYmIChcbiAgICAgICAgICAgICAgICAgICAgPEZpZWxkc2V0IGlkPVwiYmlsbGluZ0FkZHJlc3Nlc1wiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPExvYWRpbmdPdmVybGF5IGlzTG9hZGluZz17aXNSZXNldHRpbmdBZGRyZXNzfT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8QWRkcmVzc1NlbGVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRyZXNzZXM9e2JpbGxpbmdBZGRyZXNzZXN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uU2VsZWN0QWRkcmVzcz17aGFuZGxlU2VsZWN0QWRkcmVzc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25Vc2VOZXdBZGRyZXNzPXtoYW5kbGVVc2VOZXdBZGRyZXNzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEFkZHJlc3M9e1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzVmFsaWRDdXN0b21lckFkZHJlc3MgPyBiaWxsaW5nQWRkcmVzcyA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU9e0FkZHJlc3NUeXBlLkJpbGxpbmd9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgIDwvTG9hZGluZ092ZXJsYXk+XG4gICAgICAgICAgICAgICAgICAgIDwvRmllbGRzZXQ+XG4gICAgICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgIHNob3VsZFNob3dFbnRlck5ld0FkZHJlc3MoKSAmJiBpc0IzVXNlciAmJiAoXG4gICAgICAgICAgICAgICAgICAgICAgICA8cD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlZFN0cmluZyBpZD0ncmVtb3RlLm9yX3RleHQnIC8+IDxhIG9uQ2xpY2s9eyAoKSA9PiBoYW5kbGVVc2VOZXdBZGRyZXNzKCkgfT57IEIzQ2hlY2tvdXQubG9jYWxlcy50aXBzWydiMy5hZGRyZXNzZXMuZW50ZXJOZXcnXSB9PC9hPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgICAgICB7IWhhc1ZhbGlkQ3VzdG9tZXJBZGRyZXNzICYmICghaXNCM1VzZXIgfHwgc2hvdWxkU2hvd0VudGVyTmV3QWRkcmVzcygpKSAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDxBZGRyZXNzRm9ybVNrZWxldG9uIGlzTG9hZGluZz17aXNSZXNldHRpbmdBZGRyZXNzfT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxBZGRyZXNzRm9ybVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllcz17Y291bnRyaWVzfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvdW50cmllc1dpdGhBdXRvY29tcGxldGU9e2NvdW50cmllc1dpdGhBdXRvY29tcGxldGV9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRyeUNvZGU9e3ZhbHVlcy5jb3VudHJ5Q29kZX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtRmllbGRzPXtlZGl0YWJsZUZvcm1GaWVsZHN9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ29vZ2xlTWFwc0FwaUtleT17Z29vZ2xlTWFwc0FwaUtleX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0Zsb2F0aW5nTGFiZWxFbmFibGVkPXtpc0Zsb2F0aW5nTGFiZWxFbmFibGVkfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzTG9hZGluZ0IyYkFkZHJlc3M9eyB0cnVlIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRGaWVsZFZhbHVlPXtzZXRGaWVsZFZhbHVlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3VsZFNob3dTYXZlQWRkcmVzcz17c2hvdWxkU2hvd1NhdmVBZGRyZXNzKCkgJiYgc2hvdWxkU2hvd1NhdmVBZGRyZXNzSW5DaGVja291dFNldHRpbmdzKCl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT17IHR5cGUgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgPC9BZGRyZXNzRm9ybVNrZWxldG9uPlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L0ZpZWxkc2V0PlxuXG4gICAgICAgICAgICB7c2hvdWxkU2hvd09yZGVyQ29tbWVudHMgJiYgPE9yZGVyQ29tbWVudHMgLz59XG5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZm9ybS1hY3Rpb25zXCI+XG4gICAgICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17aXNVcGRhdGluZyB8fCBpc1Jlc2V0dGluZ0FkZHJlc3N9XG4gICAgICAgICAgICAgICAgICAgIGlkPVwiY2hlY2tvdXQtYmlsbGluZy1jb250aW51ZVwiXG4gICAgICAgICAgICAgICAgICAgIGlzTG9hZGluZz17aXNVcGRhdGluZyB8fCBpc1Jlc2V0dGluZ0FkZHJlc3N9XG4gICAgICAgICAgICAgICAgICAgIHR5cGU9XCJzdWJtaXRcIlxuICAgICAgICAgICAgICAgICAgICB2YXJpYW50PXtCdXR0b25WYXJpYW50LlByaW1hcnl9XG4gICAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgICAgICA8VHJhbnNsYXRlZFN0cmluZyBpZD1cImNvbW1vbi5jb250aW51ZV9hY3Rpb25cIiAvPlxuICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvRm9ybT5cbiAgICApO1xufTtcblxuXG5cbmV4cG9ydCBkZWZhdWx0IGNvbm5lY3QobWFwU3RhdGVUb1Byb3BzKSh3aXRoTGFuZ3VhZ2Uod2l0aEZvcm1pazxCM1Byb3BzICYgQmlsbGluZ0Zvcm1Qcm9wcyAmIFdpdGhMYW5ndWFnZVByb3BzLCBCaWxsaW5nRm9ybVZhbHVlcz4oe1xuICAgIGhhbmRsZVN1Ym1pdDogKHZhbHVlcywgeyBwcm9wczogeyBvblN1Ym1pdCB9IH0pID0+IHtcbiAgICAgICAgb25TdWJtaXQodmFsdWVzKVxuICAgIH0sXG4gICAgbWFwUHJvcHNUb1ZhbHVlczogKHsgZ2V0RmllbGRzLCBjdXN0b21lck1lc3NhZ2UsIGJpbGxpbmdBZGRyZXNzIH0pID0+IChcbiAgICAgICAge1xuICAgICAgICAgICAgLi4ubWFwQWRkcmVzc1RvRm9ybVZhbHVlcyhcbiAgICAgICAgICAgICAgICBnZXRGaWVsZHMoYmlsbGluZ0FkZHJlc3MgJiYgYmlsbGluZ0FkZHJlc3MuY291bnRyeUNvZGUpLFxuICAgICAgICAgICAgICAgIGJpbGxpbmdBZGRyZXNzLFxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIGIyYkN1c3RvbUZpZWxkczogQjNDaGVja291dC5leHRyYXNGaWxlcy5zZXRHb0JhY2tFY2hvKCdiaWxsaW5nJyksXG4gICAgICAgICAgICBvcmRlckNvbW1lbnQ6IGN1c3RvbWVyTWVzc2FnZSxcbiAgICAgICAgfVxuICAgICksXG4gICAgaXNJbml0aWFsVmFsaWQ6ICh7XG4gICAgICAgIGJpbGxpbmdBZGRyZXNzLFxuICAgICAgICBnZXRGaWVsZHMsXG4gICAgICAgIGxhbmd1YWdlLFxuICAgIH0pID0+IChcbiAgICAgICAgISFiaWxsaW5nQWRkcmVzcyAmJiBnZXRBZGRyZXNzRm9ybUZpZWxkc1ZhbGlkYXRpb25TY2hlbWEoe1xuICAgICAgICAgICAgbGFuZ3VhZ2UsXG4gICAgICAgICAgICBmb3JtRmllbGRzOiBnZXRGaWVsZHMoYmlsbGluZ0FkZHJlc3MuY291bnRyeUNvZGUpLFxuICAgICAgICB9KS5pc1ZhbGlkU3luYyhiaWxsaW5nQWRkcmVzcylcbiAgICApLFxuICAgIHZhbGlkYXRpb25TY2hlbWE6ICh7XG4gICAgICAgIGxhbmd1YWdlLFxuICAgICAgICBnZXRGaWVsZHMsXG4gICAgICAgIG1ldGhvZElkLFxuICAgIH06IEJpbGxpbmdGb3JtUHJvcHMgJiBXaXRoTGFuZ3VhZ2VQcm9wcykgPT4gbWV0aG9kSWQgPT09ICdhbWF6b25wYXknID9cbiAgICAgICAgICAgIChsYXp5PFBhcnRpYWw8QWRkcmVzc0Zvcm1WYWx1ZXM+Pih2YWx1ZXMgPT4gZ2V0Q3VzdG9tRm9ybUZpZWxkc1ZhbGlkYXRpb25TY2hlbWEoe1xuICAgICAgICAgICAgICAgIHRyYW5zbGF0ZTogZ2V0VHJhbnNsYXRlQWRkcmVzc0Vycm9yKGxhbmd1YWdlKSxcbiAgICAgICAgICAgICAgICBmb3JtRmllbGRzOiBnZXRGaWVsZHModmFsdWVzICYmIHZhbHVlcy5jb3VudHJ5Q29kZSksXG4gICAgICAgICAgICB9KSkpIDpcbiAgICAgICAgICAgIChsYXp5PFBhcnRpYWw8QWRkcmVzc0Zvcm1WYWx1ZXM+Pih2YWx1ZXMgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBnZXRBZGRyZXNzRm9ybUZpZWxkc1ZhbGlkYXRpb25TY2hlbWEoe1xuICAgICAgICAgICAgICAgICAgICBsYW5ndWFnZSxcbiAgICAgICAgICAgICAgICAgICAgZm9ybUZpZWxkczogZ2V0RmllbGRzKHZhbHVlcyAmJiB2YWx1ZXMuY291bnRyeUNvZGUpLFxuICAgICAgICAgICAgICAgIH0pLmNvbmNhdChvYmplY3Qoe1xuICAgICAgICAgICAgICAgICAgICBiMmJDdXN0b21GaWVsZHM6IEIzQ2hlY2tvdXQuZXh0cmFzRmlsZXMuZ2V0QjNGb3JtRmllbGRzVmFsaWRhdGlvblNjaGVtYSh7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2xhdGU6IEIzQ2hlY2tvdXQuZXh0cmFzRmlsZXMuZ2V0VHJhbnNsYXRlQWRkcmVzc0Vycm9yKGxhbmd1YWdlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1GaWVsZHM6IEIzQ2hlY2tvdXQuZXh0cmFzRmlsZXMuZ2V0QjNTaGlwcGluZ0FkZHJlc3NFeHRyYXMoKSxcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgIH0pKSxcbiAgICBlbmFibGVSZWluaXRpYWxpemU6IHRydWUsXG59KShCaWxsaW5nRm9ybSkpKVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./packages/core/src/app/billing/BillingForm.tsx\n");

/***/ }),

/***/ "./packages/core/src/app/billing/getBillingMethodId.ts":
/*!*************************************************************!*\
  !*** ./packages/core/src/app/billing/getBillingMethodId.ts ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ getBillingMethodId)\n/* harmony export */ });\n/* harmony import */ var _payment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../payment */ \"./packages/core/src/app/payment/getPreselectedPayment.ts\");\n\nfunction getBillingMethodId(checkout) {\n    var BILLING_METHOD_IDS = ['amazonpay'];\n    var preselectedPayment = (0,_payment__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(checkout);\n    return preselectedPayment && BILLING_METHOD_IDS.indexOf(preselectedPayment.providerId) > -1\n        ? preselectedPayment.providerId\n        : undefined;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWNrYWdlcy9jb3JlL3NyYy9hcHAvYmlsbGluZy9nZXRCaWxsaW5nTWV0aG9kSWQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFFbUQ7QUFFcEMsU0FBUyxrQkFBa0IsQ0FBQyxRQUFrQjtJQUN6RCxJQUFNLGtCQUFrQixHQUFHLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDekMsSUFBTSxrQkFBa0IsR0FBRyxvREFBcUIsQ0FBQyxRQUFRLENBQUMsQ0FBQztJQUUzRCxPQUFPLGtCQUFrQixJQUFJLGtCQUFrQixDQUFDLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7UUFDdkYsQ0FBQyxDQUFDLGtCQUFrQixDQUFDLFVBQVU7UUFDL0IsQ0FBQyxDQUFDLFNBQVMsQ0FBQztBQUNwQixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2hlY2tvdXQvLi9wYWNrYWdlcy9jb3JlL3NyYy9hcHAvYmlsbGluZy9nZXRCaWxsaW5nTWV0aG9kSWQudHM/OWU2NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDaGVja291dCB9IGZyb20gJ0BiaWdjb21tZXJjZS9jaGVja291dC1zZGsnO1xuXG5pbXBvcnQgeyBnZXRQcmVzZWxlY3RlZFBheW1lbnQgfSBmcm9tICcuLi9wYXltZW50JztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0QmlsbGluZ01ldGhvZElkKGNoZWNrb3V0OiBDaGVja291dCk6IHN0cmluZyB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3QgQklMTElOR19NRVRIT0RfSURTID0gWydhbWF6b25wYXknXTtcbiAgICBjb25zdCBwcmVzZWxlY3RlZFBheW1lbnQgPSBnZXRQcmVzZWxlY3RlZFBheW1lbnQoY2hlY2tvdXQpO1xuXG4gICAgcmV0dXJuIHByZXNlbGVjdGVkUGF5bWVudCAmJiBCSUxMSU5HX01FVEhPRF9JRFMuaW5kZXhPZihwcmVzZWxlY3RlZFBheW1lbnQucHJvdmlkZXJJZCkgPiAtMVxuICAgICAgICA/IHByZXNlbGVjdGVkUGF5bWVudC5wcm92aWRlcklkXG4gICAgICAgIDogdW5kZWZpbmVkO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./packages/core/src/app/billing/getBillingMethodId.ts\n");

/***/ }),

/***/ "./packages/core/src/app/payment/getPreselectedPayment.ts":
/*!****************************************************************!*\
  !*** ./packages/core/src/app/payment/getPreselectedPayment.ts ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ getPreselectedPayment)\n/* harmony export */ });\n/* harmony import */ var _giftCertificate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../giftCertificate */ \"./packages/core/src/app/giftCertificate/isGiftCertificatePayment.ts\");\n/* harmony import */ var _storeCredit__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./storeCredit */ \"./packages/core/src/app/payment/storeCredit/isStoreCreditPayment.ts\");\n\n\nfunction getPreselectedPayment(checkout) {\n    var payments = checkout && checkout.payments ? checkout.payments : [];\n    return payments.find(function (payment) {\n        return !(0,_giftCertificate__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(payment) &&\n            !(0,_storeCredit__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(payment) &&\n            !!payment.providerId;\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWNrYWdlcy9jb3JlL3NyYy9hcHAvcGF5bWVudC9nZXRQcmVzZWxlY3RlZFBheW1lbnQudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBRThEO0FBRVQ7QUFFdEMsU0FBUyxxQkFBcUIsQ0FBQyxRQUFrQjtJQUM1RCxJQUFNLFFBQVEsR0FBRyxRQUFRLElBQUksUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDO0lBRXhFLE9BQU8sUUFBUSxDQUFDLElBQUksQ0FDaEIsVUFBQyxPQUFPO1FBQ0osUUFBQyw0REFBd0IsQ0FBQyxPQUFPLENBQUM7WUFDbEMsQ0FBQyx3REFBb0IsQ0FBQyxPQUFPLENBQUM7WUFDOUIsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFVO0lBRnBCLENBRW9CLENBQzNCLENBQUM7QUFDTixDQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2hlY2tvdXQvLi9wYWNrYWdlcy9jb3JlL3NyYy9hcHAvcGF5bWVudC9nZXRQcmVzZWxlY3RlZFBheW1lbnQudHM/OGRmOSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDaGVja291dCwgQ2hlY2tvdXRQYXltZW50IH0gZnJvbSAnQGJpZ2NvbW1lcmNlL2NoZWNrb3V0LXNkayc7XG5cbmltcG9ydCB7IGlzR2lmdENlcnRpZmljYXRlUGF5bWVudCB9IGZyb20gJy4uL2dpZnRDZXJ0aWZpY2F0ZSc7XG5cbmltcG9ydCB7IGlzU3RvcmVDcmVkaXRQYXltZW50IH0gZnJvbSAnLi9zdG9yZUNyZWRpdCc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFByZXNlbGVjdGVkUGF5bWVudChjaGVja291dDogQ2hlY2tvdXQpOiBDaGVja291dFBheW1lbnQgfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IHBheW1lbnRzID0gY2hlY2tvdXQgJiYgY2hlY2tvdXQucGF5bWVudHMgPyBjaGVja291dC5wYXltZW50cyA6IFtdO1xuXG4gICAgcmV0dXJuIHBheW1lbnRzLmZpbmQoXG4gICAgICAgIChwYXltZW50KSA9PlxuICAgICAgICAgICAgIWlzR2lmdENlcnRpZmljYXRlUGF5bWVudChwYXltZW50KSAmJlxuICAgICAgICAgICAgIWlzU3RvcmVDcmVkaXRQYXltZW50KHBheW1lbnQpICYmXG4gICAgICAgICAgICAhIXBheW1lbnQucHJvdmlkZXJJZCxcbiAgICApO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./packages/core/src/app/payment/getPreselectedPayment.ts\n");

/***/ }),

/***/ "./packages/core/src/app/shipping/getShippableItemsCount.ts":
/*!******************************************************************!*\
  !*** ./packages/core/src/app/shipping/getShippableItemsCount.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ getShippableItemsCount)\n/* harmony export */ });\n/* harmony import */ var _getLineItemsCount__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./getLineItemsCount */ \"./packages/core/src/app/shipping/getLineItemsCount.ts\");\n\nfunction getShippableItemsCount(cart) {\n    return (0,_getLineItemsCount__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(cart.lineItems.physicalItems.filter(function (item) { return !item.addedByPromotion; }));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9wYWNrYWdlcy9jb3JlL3NyYy9hcHAvc2hpcHBpbmcvZ2V0U2hpcHBhYmxlSXRlbXNDb3VudC50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUVvRDtBQUVyQyxTQUFTLHNCQUFzQixDQUFDLElBQVU7SUFDckQsT0FBTyw4REFBaUIsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsVUFBQyxJQUFJLElBQUssUUFBQyxJQUFJLENBQUMsZ0JBQWdCLEVBQXRCLENBQXNCLENBQUMsQ0FBQyxDQUFDO0FBQ3BHLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaGVja291dC8uL3BhY2thZ2VzL2NvcmUvc3JjL2FwcC9zaGlwcGluZy9nZXRTaGlwcGFibGVJdGVtc0NvdW50LnRzP2MwY2EiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2FydCB9IGZyb20gJ0BiaWdjb21tZXJjZS9jaGVja291dC1zZGsnO1xuXG5pbXBvcnQgZ2V0TGluZUl0ZW1zQ291bnQgZnJvbSAnLi9nZXRMaW5lSXRlbXNDb3VudCc7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFNoaXBwYWJsZUl0ZW1zQ291bnQoY2FydDogQ2FydCk6IG51bWJlciB7XG4gICAgcmV0dXJuIGdldExpbmVJdGVtc0NvdW50KGNhcnQubGluZUl0ZW1zLnBoeXNpY2FsSXRlbXMuZmlsdGVyKChpdGVtKSA9PiAhaXRlbS5hZGRlZEJ5UHJvbW90aW9uKSk7XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./packages/core/src/app/shipping/getShippableItemsCount.ts\n");

/***/ })

}]);