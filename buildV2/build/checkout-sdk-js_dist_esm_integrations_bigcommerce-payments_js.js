"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonpCheckout"] = self["webpackJsonpCheckout"] || []).push([["checkout-sdk-js_dist_esm_integrations_bigcommerce-payments_js"],{

/***/ "../checkout-sdk-js/dist/esm/integrations/bigcommerce-payments.js":
/*!************************************************************************!*\
  !*** ../checkout-sdk-js/dist/esm/integrations/bigcommerce-payments.js ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createBigCommercePaymentsAlternativeMethodsButtonStrategy: () => (/* binding */ J),\n/* harmony export */   createBigCommercePaymentsAlternativeMethodsPaymentStrategy: () => (/* binding */ et),\n/* harmony export */   createBigCommercePaymentsButtonStrategy: () => (/* binding */ V),\n/* harmony export */   createBigCommercePaymentsCreditCardsPaymentStrategy: () => (/* binding */ Xe),\n/* harmony export */   createBigCommercePaymentsCustomerStrategy: () => (/* binding */ dt),\n/* harmony export */   createBigCommercePaymentsFastlaneCustomerStrategy: () => (/* binding */ mt),\n/* harmony export */   createBigCommercePaymentsFastlanePaymentStrategy: () => (/* binding */ Fe),\n/* harmony export */   createBigCommercePaymentsPayLaterButtonStrategy: () => (/* binding */ Y),\n/* harmony export */   createBigCommercePaymentsPayLaterCustomerStrategy: () => (/* binding */ yt),\n/* harmony export */   createBigCommercePaymentsPayLaterPaymentStrategy: () => (/* binding */ De),\n/* harmony export */   createBigCommercePaymentsPaymentStrategy: () => (/* binding */ ue),\n/* harmony export */   createBigCommercePaymentsRatePayPayPaymentStrategy: () => (/* binding */ Ve),\n/* harmony export */   createBigCommercePaymentsRedirectAlternativeMethodsPaymentStrategy: () => (/* binding */ it),\n/* harmony export */   createBigCommercePaymentsVenmoButtonStrategy: () => (/* binding */ Q),\n/* harmony export */   createBigCommercePaymentsVenmoCustomerStrategy: () => (/* binding */ vt),\n/* harmony export */   createBigCommercePaymentsVenmoPaymentStrategy: () => (/* binding */ rt)\n/* harmony export */ });\n/* harmony import */ var _bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @bigcommerce/form-poster */ \"../checkout-sdk-js/node_modules/@bigcommerce/form-poster/lib/index.js\");\n/* harmony import */ var _bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @bigcommerce/request-sender */ \"../checkout-sdk-js/node_modules/@bigcommerce/request-sender/esm/index.js\");\n/* harmony import */ var _bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @bigcommerce/script-loader */ \"../checkout-sdk-js/node_modules/@bigcommerce/script-loader/lib/index.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash */ \"../checkout-sdk-js/node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_3__);\nvar l,c={};function m(e,t){return Object.assign(e,{resolveIds:t})}c.d=(e,t)=>{for(var i in t)c.o(t,i)&&!c.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);class u extends Error{constructor(e){var t;super(e||\"An unexpected error has occurred.\"),this.name=\"StandardError\",this.type=\"standard\",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,\"function\"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class h extends u{constructor(e){super(e||\"Unable to proceed because the client library of a payment method is not loaded or ready to be used.\"),this.name=\"PaymentMethodClientUnavailableError\",this.type=\"payment_method_client_unavailable\"}}!function(e){e[e.MissingBillingAddress=0]=\"MissingBillingAddress\",e[e.MissingCart=1]=\"MissingCart\",e[e.MissingCheckout=2]=\"MissingCheckout\",e[e.MissingConsignments=3]=\"MissingConsignments\",e[e.MissingCustomer=4]=\"MissingCustomer\",e[e.MissingCheckoutConfig=5]=\"MissingCheckoutConfig\",e[e.MissingOrder=6]=\"MissingOrder\",e[e.MissingOrderConfig=7]=\"MissingOrderConfig\",e[e.MissingOrderId=8]=\"MissingOrderId\",e[e.MissingPayment=9]=\"MissingPayment\",e[e.MissingPaymentId=10]=\"MissingPaymentId\",e[e.MissingPaymentInstrument=11]=\"MissingPaymentInstrument\",e[e.MissingPaymentMethod=12]=\"MissingPaymentMethod\",e[e.MissingPaymentRedirectUrl=13]=\"MissingPaymentRedirectUrl\",e[e.MissingPaymentStatus=14]=\"MissingPaymentStatus\",e[e.MissingPaymentToken=15]=\"MissingPaymentToken\",e[e.MissingShippingAddress=16]=\"MissingShippingAddress\"}(l||(l={}));class y extends u{constructor(e){super(function(e){switch(e){case l.MissingBillingAddress:return\"Unable to proceed because billing address data is unavailable.\";case l.MissingCart:return\"Unable to proceed because cart data is unavailable.\";case l.MissingConsignments:return\"Unable to proceed because consignments data is unavailable.\";case l.MissingCheckout:return\"Unable to proceed because checkout data is unavailable.\";case l.MissingCustomer:return\"Unable to proceed because customer data is unavailable.\";case l.MissingCheckoutConfig:case l.MissingOrderConfig:return\"Unable to proceed because configuration data is unavailable.\";case l.MissingOrder:return\"Unable to proceed because order data is unavailable.\";case l.MissingOrderId:return\"Unable to proceed because order ID is unavailable or not generated yet.\";case l.MissingPayment:return\"Unable to proceed because payment data is unavailable.\";case l.MissingPaymentToken:return\"Unable to proceed because the token required to submit a payment is missing.\";case l.MissingPaymentMethod:return\"Unable to proceed because payment method data is unavailable or not properly configured.\";case l.MissingShippingAddress:return\"Unable to proceed because shipping address data is unavailable.\";default:return\"Unable to proceed because the required data is unavailable.\"}}(e)),this.subtype=e,this.name=\"MissingDataError\",this.type=\"missing_data\"}}class p extends u{constructor(e){super(e||\"An unexpected error has occurred during buy now cart creation process. Please try again later.\"),this.name=\"BuyNowCartCreationError\",this.type=\"buy_now_cart_creation_error\"}}const g={body:{},headers:{},status:0};class v extends u{constructor(e,{message:t,errors:i}={}){const{body:n,headers:o,status:r}=e||g;super(t||\"An unexpected error has occurred.\"),this.name=\"RequestError\",this.type=\"request\",this.body=n,this.headers=o,this.status=r,this.errors=i||[]}}var f,b,P,S,I,C,w,O;!function(e){e.BuyNow=\"BUY_NOW\"}(f||(f={})),function(e){e.Possible=\"POSSIBLE\",e.No=\"NO\",e.Unknown=\"UNKNOWN\",e.Yes=\"YES\"}(b||(b={})),function(e){e.AUTHORIZE=\"authorize\",e.CAPTURE=\"capture\"}(P||(P={})),function(e){e.paypal=\"paypal\",e.checkout=\"checkout\",e.buynow=\"buynow\",e.pay=\"pay\",e.installment=\"installment\"}(S||(S={})),function(e){e.gold=\"gold\",e.blue=\"blue\",e.silver=\"silver\",e.black=\"black\",e.white=\"white\"}(I||(I={})),function(e){e.pill=\"pill\",e.rect=\"rect\"}(C||(C={})),function(e){e.OXXO=\"oxxo\"}(w||(w={})),function(e){e.Approved=\"APPROVED\",e.Created=\"CREATED\",e.PayerActionRequired=\"PAYER_ACTION_REQUIRED\",e.PollingStop=\"POLLING_STOP\",e.PollingError=\"POLLING_ERROR\"}(O||(O={}));var _=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class k{constructor(e,t,i,n){this.formPoster=e,this.paymentIntegrationService=t,this.bigCommercePaymentsRequestSender=i,this.bigCommercePaymentsScriptLoader=n}loadPayPalSdk(e,t,i,n){return _(this,void 0,void 0,function*(){const o=this.paymentIntegrationService.getState(),r=t||o.getCartOrThrow().currency.code,a=o.getPaymentMethodOrThrow(e);return this.paypalSdk=yield this.bigCommercePaymentsScriptLoader.getPayPalSDK(a,r,i,n),this.paypalSdk})}getPayPalSdkOrThrow(){if(!this.paypalSdk)throw new h;return this.paypalSdk}createBuyNowCartOrThrow(e){return _(this,void 0,void 0,function*(){const t=e.getBuyNowCartRequestBody();if(!t)throw new y(l.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(t)}catch(e){throw new p}})}createOrder(e,t){return _(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState().getCartOrThrow().id,{orderId:n}=yield this.bigCommercePaymentsRequestSender.createOrder(e,Object.assign({cartId:i},t));return n})}createOrderCardFields(e,t){return _(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState().getCartOrThrow().id,{orderId:n,setupToken:o}=yield this.bigCommercePaymentsRequestSender.createOrder(e,Object.assign({cartId:i},t));return Object.assign({orderId:n},o?{setupToken:o}:{})})}updateOrder(){return _(this,void 0,void 0,function*(){const e=this.paymentIntegrationService.getState(),t=e.getCartOrThrow(),i=e.getConsignmentsOrThrow()[0];try{yield this.bigCommercePaymentsRequestSender.updateOrder({availableShippingOptions:i.availableShippingOptions,cartId:t.id,selectedShippingOption:i.selectedShippingOption})}catch(e){throw new v}})}getOrderStatus(e,t){return _(this,void 0,void 0,function*(){try{const{status:i}=yield this.bigCommercePaymentsRequestSender.getOrderStatus(e,t);return i}catch(e){throw new v}})}tokenizePayment(e,t){const i=this.paymentIntegrationService.getState().getCartOrThrow();if(!t)throw new y(l.MissingOrderId);return this.formPoster.postForm(\"/checkout.php\",Object.assign({payment_type:\"paypal\",action:\"set_external_checkout\",provider:e,order_id:t},i.source===f.BuyNow&&{cart_id:i.id}))}submitPayment(e,t,i){return _(this,void 0,void 0,function*(){const n={formattedPayload:{vault_payment_instrument:null,set_as_default_stored_instrument:null,device_info:null,method_id:e,paypal_account:{order_id:t}}};yield this.paymentIntegrationService.submitPayment(Object.assign({methodId:e,paymentData:n},i?{gatewayId:i}:{}))})}getShippingOptionOrThrow(e){const t=this.paymentIntegrationService.getState().getConsignmentsOrThrow()[0],i=t.availableShippingOptions||[],n=i.find(e=>e.isRecommended),o=(e?i.find(t=>t.id===e):i.find(e=>{var i;return e.id===(null===(i=t.selectedShippingOption)||void 0===i?void 0:i.id)}))||n||i[0];if(!o)throw new Error(\"Your order can't be shipped to this address\");return o}getAddress(e){return{firstName:(null==e?void 0:e.firstName)||\"\",lastName:(null==e?void 0:e.lastName)||\"\",email:(null==e?void 0:e.email)||\"\",phone:(null==e?void 0:e.phone)||\"\",company:\"\",address1:(null==e?void 0:e.address1)||\"\",address2:(null==e?void 0:e.address2)||\"\",city:(null==e?void 0:e.city)||\"\",countryCode:(null==e?void 0:e.countryCode)||\"\",postalCode:(null==e?void 0:e.postalCode)||\"\",stateOrProvince:\"\",stateOrProvinceCode:(null==e?void 0:e.stateOrProvinceCode)||\"\",customFields:[]}}getBillingAddressFromOrderDetails({payer:e}){var t,i;return this.getAddress({firstName:e.name.given_name,lastName:e.name.surname,email:e.email_address,address1:e.address.address_line_1,address2:e.address.address_line_2,city:e.address.admin_area_2,countryCode:e.address.country_code,postalCode:e.address.postal_code,stateOrProvinceCode:e.address.admin_area_1,phone:null===(i=null===(t=e.phone)||void 0===t?void 0:t.phone_number)||void 0===i?void 0:i.national_number})}getShippingAddressFromOrderDetails(e){const{payer:t,purchase_units:i}=e,{address:n,name:{full_name:o}}=i[0].shipping,[r,...a]=o.split(\" \");return this.getAddress({firstName:r,lastName:a.join(\" \"),email:t.email_address,address1:n.address_line_1,address2:n.address_line_2,city:n.admin_area_2,countryCode:n.country_code,postalCode:n.postal_code,stateOrProvinceCode:n.admin_area_1})}getValidButtonStyle(e){const{color:t,height:i,label:n,shape:o}=e||{},a={color:t&&I[t]?t:void 0,height:this.getValidHeight(i),label:n&&S[n]?n:void 0,shape:o&&C[o]?o:void 0};return (0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)(a,lodash__WEBPACK_IMPORTED_MODULE_3__.isNil)}getValidHeight(e){return e&&\"number\"==typeof e?e>55?55:e<25?25:e:40}removeElement(e){const t=e&&document.getElementById(e);t&&(t.style.display=\"none\")}}const A=\"This API endpoint is for internal use only and may change in the future\";var E;!function(e){e.Json=\"application/json\",e.JsonV1=\"application/vnd.bc.v1+json\"}(E||(E={}));const T=E,z={\"X-Checkout-SDK-Version\":\"1.867.0\"};var F=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class B{constructor(e){this.requestSender=e}createOrder(e,t){return F(this,void 0,void 0,function*(){const i=`/api/storefront/payment/${e}`,n=t,o=Object.assign({\"X-API-INTERNAL\":A,\"Content-Type\":T.Json},z);return(yield this.requestSender.post(i,{headers:o,body:n})).body})}updateOrder(e){return F(this,void 0,void 0,function*(){const t=e,i=Object.assign({\"X-API-INTERNAL\":A,\"Content-Type\":T.Json},z);return(yield this.requestSender.put(\"/api/storefront/initialization/bigcommerce_payments\",{headers:i,body:t})).body})}getOrderStatus(e=\"bigcommerce_payments\",t){return F(this,void 0,void 0,function*(){const i=`/api/storefront/initialization/${e}`,n=Object.assign({\"X-API-INTERNAL\":A,\"Content-Type\":T.Json},z);return(yield this.requestSender.get(i,Object.assign({headers:n},t))).body})}}var M=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class x{constructor(e){this.scriptLoader=e,this.window=window}getPayPalSDK(e,t,i,n){return M(this,void 0,void 0,function*(){const o=this.getPayPalSdkScriptConfigOrThrow(e,t,i);return this.loadPayPalSDK(o,n)})}loadPayPalSDK(e,t=!1){return M(this,void 0,void 0,function*(){if(!this.window.paypal||t){const t=this.transformConfig(e.options),i=this.transformConfig(e.attributes),n=`https://www.paypal.com/sdk/js?${new URLSearchParams(t).toString()}`;yield this.scriptLoader.loadScript(n,{async:!0,attributes:i})}if(!this.window.paypal)throw new h;return this.window.paypal})}getPayPalSdkScriptConfigOrThrow(e,t,i=!0){const{id:n,clientToken:o,initializationData:r}=e;if(!(null==r?void 0:r.clientId))throw new y(l.MissingPaymentMethod);const{intent:a,clientId:s,merchantId:d,buyerCountry:c,attributionId:m,isVenmoEnabled:u,isHostedCheckoutEnabled:h,isPayPalCreditAvailable:p,isDeveloperModeApplicable:g,availableAlternativePaymentMethods:v=[],enabledAlternativePaymentMethods:f=[],isGooglePayEnabled:b}=r,P=h||i,S=\"bigcommerce_payments_creditcards\"===n,I=S?[\"card\"]:[],C=S?[]:[\"card\"],w=p?[\"credit\",\"paylater\"]:[],O=p?[]:[\"credit\",\"paylater\"],_=u?[\"venmo\"]:[],k=u?[]:[\"venmo\"],A=v.filter(e=>!f.includes(e)),E=b?[\"googlepay\"]:[],T=i?[\"card-fields\"]:[],z=this.filterFundingOptions([...C,...O,...k,...A]),F=this.filterFundingOptions([...I,...w,..._,...f]);return{options:Object.assign({\"client-id\":s,\"merchant-id\":d,\"enable-funding\":F.length>0?F:void 0,\"disable-funding\":z.length>0?z:void 0,commit:P,components:[\"buttons\",\"hosted-fields\",\"payment-fields\",\"legal\",...E,...T],currency:t,intent:a},g&&{\"buyer-country\":c}),attributes:{\"data-partner-attribution-id\":m,\"data-client-token\":o}}}filterFundingOptions(e){const t=[\"klarna\",\"afterpay\"];return e?e.filter(e=>!t.includes(e)):[]}transformConfig(e){let t={};return Object.keys(e).forEach(i=>{const n=e[i];null==n||\"\"===n||Array.isArray(n)&&0===n.length||(t=Object.assign(Object.assign({},t),{[i]:Array.isArray(n)?n.join(\",\"):n}))}),t}}const D=i=>{const{getHost:o}=i.getState();return new k((0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),i,new B((0,_bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_1__.createRequestSender)({host:o()})),new x((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_2__.getScriptLoader)()))};class N extends u{constructor(e){super(e||\"Invalid arguments have been provided.\"),this.name=\"InvalidArgumentError\",this.type=\"invalid_argument\"}}var U=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class j{constructor(e,t){this.paymentIntegrationService=e,this.bigCommercePaymentsIntegrationService=t}initialize(e){var t;return U(this,void 0,void 0,function*(){const{bigcommerce_payments:i,containerId:n,methodId:o}=e,r=Boolean(null==i?void 0:i.buyNowInitializeOptions);if(!o)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!n)throw new N('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!i)throw new N('Unable to initialize payment because \"options.bigcommerce_payments\" argument is not provided.');if(r&&!i.currencyCode)throw new N('Unable to initialize payment because \"options.bigcommerce_payments.currencyCode\" argument is not provided.');if(r&&\"function\"!=typeof(null===(t=i.buyNowInitializeOptions)||void 0===t?void 0:t.getBuyNowCartRequestBody))throw new N('Unable to initialize payment because \"options.bigcommerce_payments.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.');r||(yield this.paymentIntegrationService.loadDefaultCheckout());const a=r?i.currencyCode:this.paymentIntegrationService.getState().getCartOrThrow().currency.code;yield this.bigCommercePaymentsIntegrationService.loadPayPalSdk(o,a,!1),this.renderButton(n,o,i,r)})}deinitialize(){return Promise.resolve()}renderButton(e,t,i,n){var o,r;const{buyNowInitializeOptions:a,style:s,onComplete:d,onEligibilityFailure:l}=i,c=this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow(),m=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t),{isHostedCheckoutEnabled:u,isAppSwitchEnabled:h}=m.initializationData||{},y=Object.assign(Object.assign({},!n&&this.isPaypalCommerceAppSwitchEnabled(t)&&{appSwitchWhenAvailable:!0}),{createOrder:()=>this.bigCommercePaymentsIntegrationService.createOrder(\"bigcommerce_payments\"),onApprove:({orderID:e})=>this.bigCommercePaymentsIntegrationService.tokenizePayment(t,e)}),p={onClick:()=>this.handleClick(a),onCancel:()=>this.paymentIntegrationService.loadDefaultCheckout()},g=Object.assign(Object.assign({},!h&&{onShippingAddressChange:e=>this.onShippingAddressChange(e),onShippingOptionsChange:e=>this.onShippingOptionsChange(e)}),{onApprove:(e,i)=>this.onHostedCheckoutApprove(e,i,t,d)}),v=Object.assign(Object.assign(Object.assign({fundingSource:c.FUNDING.PAYPAL,style:this.bigCommercePaymentsIntegrationService.getValidButtonStyle(s)},y),a&&p),u&&g),f=c.Buttons(v);f.isEligible()?(null===(o=f.hasReturned)||void 0===o?void 0:o.call(f))&&this.isPaypalCommerceAppSwitchEnabled(t)?null===(r=f.resume)||void 0===r||r.call(f):f.render(`#${e}`):l&&\"function\"==typeof l?l():this.bigCommercePaymentsIntegrationService.removeElement(e)}handleClick(e){return U(this,void 0,void 0,function*(){if(e){const t=yield this.bigCommercePaymentsIntegrationService.createBuyNowCartOrThrow(e);yield this.paymentIntegrationService.loadCheckout(t.id)}})}onHostedCheckoutApprove(e,t,i,n){return U(this,void 0,void 0,function*(){if(!e.orderID)throw new y(l.MissingOrderId);const o=this.paymentIntegrationService.getState().getCartOrThrow(),r=yield t.order.get();try{const t=this.bigCommercePaymentsIntegrationService.getBillingAddressFromOrderDetails(r);if(yield this.paymentIntegrationService.updateBillingAddress(t),o.lineItems.physicalItems.length>0){const e=this.bigCommercePaymentsIntegrationService.getShippingAddressFromOrderDetails(r);yield this.paymentIntegrationService.updateShippingAddress(e),yield this.bigCommercePaymentsIntegrationService.updateOrder()}return yield this.paymentIntegrationService.submitOrder({},{params:{methodId:i}}),yield this.bigCommercePaymentsIntegrationService.submitPayment(i,e.orderID),n&&\"function\"==typeof n&&n(),!0}catch(e){if(\"string\"==typeof e)throw new Error(e);throw e}})}onShippingAddressChange(e){return U(this,void 0,void 0,function*(){const t=this.bigCommercePaymentsIntegrationService.getAddress({city:e.shippingAddress.city,countryCode:e.shippingAddress.countryCode,postalCode:e.shippingAddress.postalCode,stateOrProvinceCode:e.shippingAddress.state});try{yield this.paymentIntegrationService.updateBillingAddress(t),yield this.paymentIntegrationService.updateShippingAddress(t);const e=this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow();yield this.paymentIntegrationService.selectShippingOption(e.id),yield this.bigCommercePaymentsIntegrationService.updateOrder()}catch(e){if(\"string\"==typeof e)throw new Error(e);throw e}})}onShippingOptionsChange(e){return U(this,void 0,void 0,function*(){const t=this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow(e.selectedShippingOption.id);try{yield this.paymentIntegrationService.selectShippingOption(t.id),yield this.bigCommercePaymentsIntegrationService.updateOrder()}catch(e){if(\"string\"==typeof e)throw new Error(e);throw e}})}isPaypalCommerceAppSwitchEnabled(e){var t,i;return null!==(i=null===(t=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e).initializationData)||void 0===t?void 0:t.isAppSwitchEnabled)&&void 0!==i&&i}}const V=m(e=>new j(e,D(e)),[{id:\"bigcommerce_payments\"}]);var R=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class L{constructor(e){this.scriptLoader=e,this.window=window}getPayPalFastlaneSdk(e,t,i){return R(this,void 0,void 0,function*(){if(!this.window.paypalFastlaneSdk){const n=this.getPayPalFastlaneSdkConfiguration(e,t,i);if(yield this.loadPayPalSdk(n),!this.window.paypalFastlaneSdk)throw new h}return this.window.paypalFastlaneSdk})}getPayPalGooglePaySdk(e,t,i,n){return R(this,void 0,void 0,function*(){if(!this.window.paypalGooglePay||n){const n=this.getPayPalGooglePaySdkScriptConfigOrThrow(e,t,i);yield this.loadPayPalSdk(n)}if(!this.window.paypalGooglePay)throw new h;return this.window.paypalGooglePay})}getPayPalApmsSdk(e,t){return R(this,void 0,void 0,function*(){if(!this.window.paypalApms){const i=this.getPayPalApmSdkConfiguration(e,t);if(yield this.loadPayPalSdk(i),!this.window.paypalApms)throw new h}return this.window.paypalApms})}getPayPalMessages(e,t){return R(this,void 0,void 0,function*(){if(!this.window.paypalMessages){const i=this.getPayPalSdkMessagesConfiguration(e,t);yield this.loadPayPalSdk(i)}if(!this.window.paypalMessages)throw new h;return this.window.paypalMessages})}loadPayPalSdk({options:e,attributes:t}){return R(this,void 0,void 0,function*(){const i=this.transformConfig(e),n=this.transformConfig(t),o=`https://www.paypal.com/sdk/js?${new URLSearchParams(i).toString()}`;yield this.scriptLoader.loadScript(o,{async:!0,attributes:n})})}getPayPalFastlaneSdkConfiguration(e,t,i){const{clientToken:n,initializationData:o}=e;if(!o||!o.clientId)throw new y(l.MissingPaymentMethod);const{intent:r,clientId:a,merchantId:s,attributionId:d}=o;return{options:{\"client-id\":a,\"merchant-id\":s,commit:!0,components:[\"fastlane\",\"three-domain-secure\"],currency:t,intent:r},attributes:{\"data-client-metadata-id\":i.replace(/-/g,\"\"),\"data-namespace\":\"paypalFastlaneSdk\",\"data-partner-attribution-id\":d,\"data-sdk-client-token\":n}}}getPayPalGooglePaySdkScriptConfigOrThrow(e,t,i=!0){const{clientToken:n,initializationData:o}=e;if(!o||!o.clientId)throw new y(l.MissingPaymentMethod);const{intent:r,clientId:a,merchantId:s,buyerCountry:d,attributionId:c,isHostedCheckoutEnabled:m,isDeveloperModeApplicable:u}=o,h=m||i;return{options:Object.assign({\"client-id\":a,\"merchant-id\":s,commit:h,components:[\"googlepay\"],currency:t,intent:r},u&&{\"buyer-country\":d}),attributes:{\"data-partner-attribution-id\":c,\"data-client-token\":n,\"data-namespace\":\"paypalGooglePay\"}}}getPayPalApmSdkConfiguration(e,t){const{initializationData:i}=e;if(!i||!i.clientId)throw new y(l.MissingPaymentMethod);const{intent:n,clientId:o,merchantId:r,buyerCountry:a,attributionId:s,isDeveloperModeApplicable:d,availableAlternativePaymentMethods:c=[],enabledAlternativePaymentMethods:m=[]}=i,u=this.filterFundingOptions(m),h=this.filterFundingOptions(c.filter(e=>!m.includes(e)));return{options:Object.assign({\"client-id\":o,\"merchant-id\":r,\"enable-funding\":u.length>0?u:void 0,\"disable-funding\":h.length>0?h:void 0,commit:!0,components:[\"buttons\",\"payment-fields\"],currency:t,intent:n},d&&{\"buyer-country\":a}),attributes:{\"data-partner-attribution-id\":s,\"data-namespace\":\"paypalApms\"}}}getPayPalSdkMessagesConfiguration(e,t){const{initializationData:i}=e;if(!i||!i.clientId)throw new y(l.MissingPaymentMethod);const{clientId:n,merchantId:o,attributionId:r,isDeveloperModeApplicable:a,buyerCountry:s}=i;return{options:Object.assign({\"client-id\":n,\"merchant-id\":o,components:[\"messages\"],currency:t},a&&{\"buyer-country\":s}),attributes:{\"data-namespace\":\"paypalMessages\",\"data-partner-attribution-id\":r}}}filterFundingOptions(e){const t=[\"klarna\",\"afterpay\"];return e?e.filter(e=>!t.includes(e)):[]}transformConfig(e){let t={};return Object.keys(e).forEach(i=>{const n=e[i];null==n||\"\"===n||Array.isArray(n)&&0===n.length||(t=Object.assign(Object.assign({},t),{[i]:Array.isArray(n)?n.join(\",\"):n}))}),t}}function $(){return new L((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_2__.createScriptLoader)())}const q=function({styles:e}){const t={};return e.color&&(t.color=e.color),e.layout&&(t.layout=e.layout),(e[\"logo-type\"]||e[\"logo-position\"])&&(t.logo={},e[\"logo-type\"]&&(t.logo.type=e[\"logo-type\"]),e[\"logo-position\"]&&(t.logo.position=e[\"logo-position\"])),e.ratio&&(t.ratio=e.ratio),(e[\"text-color\"]||e[\"text-size\"])&&(t.text={},e[\"text-color\"]&&(t.text.color=e[\"text-color\"]),e[\"text-size\"]&&(t.text.size=+e[\"text-size\"])),t};var H=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class G{constructor(e,t,i){this.paymentIntegrationService=e,this.bigCommercePaymentsIntegrationService=t,this.payPalSdkHelper=i}initialize(e){return H(this,void 0,void 0,function*(){const{bigcommerce_payments_paylater:t,containerId:i,methodId:n}=e,{buyNowInitializeOptions:o,currencyCode:r,messagingContainerId:a}=t||{},s=!!o;if(!n)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!i)throw new N('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!t)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_paylater\" argument is not provided.');if(s&&!r)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_paylater.currencyCode\" argument is not provided.');if(s&&\"function\"!=typeof(null==o?void 0:o.getBuyNowCartRequestBody))throw new N('Unable to initialize payment because \"options.bigcommerce_payments_paylater.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.');s||(yield this.paymentIntegrationService.loadDefaultCheckout());const d=this.paymentIntegrationService.getState(),l=s?r:d.getCartOrThrow().currency.code;yield this.bigCommercePaymentsIntegrationService.loadPayPalSdk(n,l,!1),this.renderButton(i,n,t);const c=a&&document.getElementById(a);if(l&&c){const e=d.getPaymentMethodOrThrow(n),{paypalBNPLConfiguration:t=[]}=e.initializationData||{},i=t&&t.find(({id:e})=>\"cart\"===e);if(!(null==i?void 0:i.status))return;c.removeAttribute(\"data-pp-style-logo-type\"),c.removeAttribute(\"data-pp-style-logo-position\"),c.removeAttribute(\"data-pp-style-text-color\"),c.removeAttribute(\"data-pp-style-text-size\");const o=yield this.payPalSdkHelper.getPayPalMessages(e,l);this.renderMessages(o,a,i)}})}deinitialize(){return Promise.resolve()}renderButton(e,t,i){const{buyNowInitializeOptions:n,style:o,onComplete:r,onEligibilityFailure:a}=i,s=this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow(),d=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t),{isHostedCheckoutEnabled:l}=d.initializationData||{},c={createOrder:()=>this.bigCommercePaymentsIntegrationService.createOrder(\"bigcommerce_payments_paylater\"),onApprove:({orderID:e})=>this.bigCommercePaymentsIntegrationService.tokenizePayment(t,e)},m={onClick:()=>this.handleClick(n),onCancel:()=>this.paymentIntegrationService.loadDefaultCheckout()},u={onShippingAddressChange:e=>this.onShippingAddressChange(e),onShippingOptionsChange:e=>this.onShippingOptionsChange(e),onApprove:(e,i)=>this.onHostedCheckoutApprove(e,i,t,r)},h=[s.FUNDING.PAYLATER,s.FUNDING.CREDIT];let y=!1;h.forEach(t=>{if(!y){const i=Object.assign(Object.assign(Object.assign({fundingSource:t,style:this.bigCommercePaymentsIntegrationService.getValidButtonStyle(o)},c),n&&m),l&&u),r=s.Buttons(i);r.isEligible()?(r.render(`#${e}`),y=!0):a&&\"function\"==typeof a&&a()}}),y||this.bigCommercePaymentsIntegrationService.removeElement(e)}handleClick(e){return H(this,void 0,void 0,function*(){if(e){const t=yield this.bigCommercePaymentsIntegrationService.createBuyNowCartOrThrow(e);yield this.paymentIntegrationService.loadCheckout(t.id)}})}onHostedCheckoutApprove(e,t,i,n){return H(this,void 0,void 0,function*(){if(!e.orderID)throw new y(l.MissingOrderId);const o=this.paymentIntegrationService.getState().getCartOrThrow(),r=yield t.order.get();try{const t=this.bigCommercePaymentsIntegrationService.getBillingAddressFromOrderDetails(r);if(yield this.paymentIntegrationService.updateBillingAddress(t),o.lineItems.physicalItems.length>0){const e=this.bigCommercePaymentsIntegrationService.getShippingAddressFromOrderDetails(r);yield this.paymentIntegrationService.updateShippingAddress(e),yield this.bigCommercePaymentsIntegrationService.updateOrder()}return yield this.paymentIntegrationService.submitOrder({},{params:{methodId:i}}),yield this.bigCommercePaymentsIntegrationService.submitPayment(i,e.orderID),n&&\"function\"==typeof n&&n(),!0}catch(e){if(\"string\"==typeof e)throw new Error(e);throw e}})}onShippingAddressChange(e){return H(this,void 0,void 0,function*(){const t=this.bigCommercePaymentsIntegrationService.getAddress({city:e.shippingAddress.city,countryCode:e.shippingAddress.countryCode,postalCode:e.shippingAddress.postalCode,stateOrProvinceCode:e.shippingAddress.state});try{yield this.paymentIntegrationService.updateBillingAddress(t),yield this.paymentIntegrationService.updateShippingAddress(t);const e=this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow();yield this.paymentIntegrationService.selectShippingOption(e.id),yield this.bigCommercePaymentsIntegrationService.updateOrder()}catch(e){if(\"string\"==typeof e)throw new Error(e);throw e}})}onShippingOptionsChange(e){return H(this,void 0,void 0,function*(){const t=this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow(e.selectedShippingOption.id);try{yield this.paymentIntegrationService.selectShippingOption(t.id),yield this.bigCommercePaymentsIntegrationService.updateOrder()}catch(e){if(\"string\"==typeof e)throw new Error(e);throw e}})}renderMessages(e,t,i){const n={amount:this.paymentIntegrationService.getState().getCheckoutOrThrow().outstandingBalance,placement:\"cart\",style:q(i)};e.Messages(n).render(`#${t}`)}}const Y=m(e=>new G(e,D(e),$()),[{id:\"bigcommerce_payments_paylater\"}]);var W=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class K{constructor(e,t){this.paymentIntegrationService=e,this.bigCommercePaymentsIntegrationService=t}initialize(e){return W(this,void 0,void 0,function*(){const{bigcommerce_payments_apms:t,containerId:i,methodId:n}=e,{apm:o,buyNowInitializeOptions:r,currencyCode:a}=t||{},s=!!r;if(!n)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!i)throw new N('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!t)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_apms\" argument is not provided.');if(!o)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_apms.apm\" argument is not provided.');if(s&&!a)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_apms.currencyCode\" argument is not provided.');if(s&&\"function\"!=typeof(null==r?void 0:r.getBuyNowCartRequestBody))throw new N('Unable to initialize payment because \"options.bigcommerce_payments_apms.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.');s||(yield this.paymentIntegrationService.loadDefaultCheckout());const d=s?a:this.paymentIntegrationService.getState().getCartOrThrow().currency.code;yield this.bigCommercePaymentsIntegrationService.loadPayPalSdk(n,d,!1),this.renderButton(i,n,t)})}deinitialize(){return Promise.resolve()}renderButton(e,t,i){const{apm:n,buyNowInitializeOptions:o,style:r,onEligibilityFailure:a}=i,s=this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow();if(!Object.values(s.FUNDING).includes(n))throw new N('Unable to initialize PayPal button because \"options.bigcommerce_payments_apms.apm\" argument is not valid funding source.');const d={createOrder:()=>this.bigCommercePaymentsIntegrationService.createOrder(\"bigcommerce_payments_apms\"),onApprove:({orderID:e})=>this.bigCommercePaymentsIntegrationService.tokenizePayment(t,e)},l={onClick:()=>this.handleClick(o),onCancel:()=>this.paymentIntegrationService.loadDefaultCheckout()},c=Object.assign(Object.assign({fundingSource:n,style:this.bigCommercePaymentsIntegrationService.getValidButtonStyle(r)},d),o&&l),m=s.Buttons(c);m.isEligible()?m.render(`#${e}`):a&&\"function\"==typeof a?a():this.bigCommercePaymentsIntegrationService.removeElement(e)}handleClick(e){return W(this,void 0,void 0,function*(){if(e){const t=yield this.bigCommercePaymentsIntegrationService.createBuyNowCartOrThrow(e);yield this.paymentIntegrationService.loadCheckout(t.id)}})}}const J=m(e=>new K(e,D(e)),[{id:\"bigcommerce_payments_apms\"}]);var X=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Z{constructor(e,t){this.paymentIntegrationService=e,this.bigCommercePaymentsIntegrationService=t}initialize(e){return X(this,void 0,void 0,function*(){const{bigcommerce_payments_venmo:t,containerId:i,methodId:n}=e,{buyNowInitializeOptions:o,currencyCode:r}=t||{},a=!!o;if(!n)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!i)throw new N('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!t)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_venmo\" argument is not provided.');if(a&&!r)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_venmo.currencyCode\" argument is not provided.');if(a&&\"function\"!=typeof(null==o?void 0:o.getBuyNowCartRequestBody))throw new N('Unable to initialize payment because \"options.bigcommerce_payments_venmo.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.');a||(yield this.paymentIntegrationService.loadDefaultCheckout());const s=a?r:this.paymentIntegrationService.getState().getCartOrThrow().currency.code;yield this.bigCommercePaymentsIntegrationService.loadPayPalSdk(n,s,!1),this.renderButton(i,n,t)})}deinitialize(){return Promise.resolve()}renderButton(e,t,i){const{buyNowInitializeOptions:n,style:o,onEligibilityFailure:r}=i,a=this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow(),s=a.FUNDING.VENMO,d={createOrder:()=>this.bigCommercePaymentsIntegrationService.createOrder(\"bigcommerce_payments_venmo\"),onApprove:({orderID:e})=>this.bigCommercePaymentsIntegrationService.tokenizePayment(t,e)},l={onClick:()=>this.handleClick(n),onCancel:()=>this.paymentIntegrationService.loadDefaultCheckout()},c=Object.assign(Object.assign({fundingSource:s,style:this.getValidVenmoButtonStyles(o)},d),n&&l),m=a.Buttons(c);m.isEligible()?m.render(`#${e}`):r&&\"function\"==typeof r?r():this.bigCommercePaymentsIntegrationService.removeElement(e)}getValidVenmoButtonStyles(e){const t=this.bigCommercePaymentsIntegrationService.getValidButtonStyle(e);return t.color===I.gold?Object.assign(Object.assign({},t),{color:void 0}):t}handleClick(e){return X(this,void 0,void 0,function*(){if(e){const t=yield this.bigCommercePaymentsIntegrationService.createBuyNowCartOrThrow(e);yield this.paymentIntegrationService.loadCheckout(t.id)}})}}const Q=m(e=>new Z(e,D(e)),[{id:\"bigcommerce_payments_venmo\"}]),ee={size:70,color:\"#d9d9d9\",backgroundColor:\"#ffffff\"},te=\"embedded-checkout-loading-indicator-rotation\";class ie{constructor(e){this.styles=Object.assign(Object.assign({},ee),e&&e.styles),this.containerStyles=Object.assign({},e&&e.containerStyles),this.defineAnimation(),this.container=this.buildContainer(),this.indicator=this.buildIndicator(),this.container.appendChild(this.indicator)}show(e){if(e){const t=document.getElementById(e);if(!t)throw new Error(\"Unable to attach the loading indicator because the parent ID is not valid.\");t.appendChild(this.container)}this.container.style.visibility=\"visible\",this.container.style.opacity=\"1\"}hide(){const e=()=>{this.container.style.visibility=\"hidden\",this.container.removeEventListener(\"transitionend\",e)};this.container.addEventListener(\"transitionend\",e),this.container.style.opacity=\"0\"}buildContainer(){const e=document.createElement(\"div\");return e.style.display=\"block\",e.style.bottom=\"0\",e.style.left=\"0\",e.style.height=\"100%\",e.style.width=\"100%\",e.style.position=\"absolute\",e.style.right=\"0\",e.style.top=\"0\",e.style.transition=\"all 250ms ease-out\",e.style.opacity=\"0\",this.setStyleAttribute(e,this.containerStyles),e}buildIndicator(){const e=document.createElement(\"div\");return e.style.display=\"block\",e.style.width=`${this.styles.size}px`,e.style.height=`${this.styles.size}px`,e.style.borderRadius=`${this.styles.size}px`,e.style.border=\"solid 1px\",e.style.borderColor=`${this.styles.backgroundColor} ${this.styles.backgroundColor} ${this.styles.color} ${this.styles.color}`,e.style.margin=\"0 auto\",e.style.position=\"absolute\",e.style.left=\"0\",e.style.right=\"0\",e.style.top=\"50%\",e.style.transform=\"translateY(-50%) rotate(0deg)\",e.style.transformStyle=\"preserve-3d\",e.style.animation=`${te} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`,e}setStyleAttribute(e,t){Object.keys(t).forEach(i=>{e.style.setProperty(i,t[i])})}defineAnimation(){var e;if(document.getElementById(te))return;const t=document.createElement(\"style\");t.id=te,null===(e=document.head)||void 0===e||e.appendChild(t),t.sheet instanceof CSSStyleSheet&&t.sheet.insertRule(`\\n                @keyframes ${te} {\\n                    0% { transform: translateY(-50%) rotate(0deg); }\\n                    100% { transform: translateY(-50%) rotate(360deg); }\\n                }\\n            `,0)}}const ne={\"background-color\":\"rgba(0, 0, 0, 0.4)\",\"z-index\":\"1000\"};class oe extends N{constructor(e){let t=\"Unable to submit payment for the order because the payload is invalid.\";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(\", \")}.`),super(t),this.name=\"PaymentArgumentInvalidError\"}}class re extends v{constructor(e){super(e,{message:\"There is a problem processing your payment. Please try again later.\"}),this.name=\"PaymentMethodInvalidError\",this.type=\"payment_method_invalid\"}}class ae extends u{constructor(){super(\"The current order does not need to be finalized at this stage.\"),this.name=\"OrderFinalizationNotRequiredError\",this.type=\"order_finalization_not_required\"}}function se(e){return!(\"object\"!=typeof e||null===e||void 0!==e.shouldSaveInstrument&&\"boolean\"!=typeof e.shouldSaveInstrument||void 0!==e.shouldSetAsDefaultInstrument&&\"boolean\"!=typeof e.shouldSetAsDefaultInstrument)}function de(e){return Boolean(e.instrumentId)}function le(e){return\"object\"==typeof e&&null!==e&&\"bigpayToken\"in e&&\"defaultInstrument\"in e&&\"provider\"in e&&\"trustedShippingAddress\"in e&&\"method\"in e&&\"type\"in e}var ce=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class me{constructor(e,t,i,n){this.paymentIntegrationService=e,this.bigCommercePaymentsIntegrationService=t,this.paypalSdkHelper=i,this.loadingIndicator=n}initialize(e){return ce(this,void 0,void 0,function*(){const{methodId:t,bigcommerce_payments:i}=e||{};if(this.bigcommerce_payments=i,!t)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!i)throw new N('Unable to initialize payment because \"options.bigcommerce_payments\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(t);const n=this.paymentIntegrationService.getState(),o=n.getPaymentMethodOrThrow(t),{container:r,bannerContainerId:a}=i,{orderId:s,paypalBNPLConfiguration:d=[],isPayPalCreditAvailable:l}=o.initializationData||{};if(void 0!==a){if(!document.getElementById(a))return void console.error(\"Unable to create banner without valid banner container ID.\");const e=null==d?void 0:d.find(({id:e})=>\"checkout\"===e);if(l||!(null==e?void 0:e.status))return;const t=yield this.paypalSdkHelper.getPayPalMessages(o,n.getCartOrThrow().currency.code);return t&&\"function\"==typeof(null==t?void 0:t.Messages)?this.renderMessages(t,a,e):void console.error(\"[BC PayPalCommerce PayLater]: banner could not be rendered, due to issues with loading PayPal SDK\")}s?this.orderId=s:(this.loadingIndicatorContainer=null==r?void 0:r.split(\"#\")[1],yield this.bigCommercePaymentsIntegrationService.loadPayPalSdk(t),i.onInit&&\"function\"==typeof i.onInit&&i.onInit(()=>this.renderButton(t,i)),(void 0===i.shouldRenderPayPalButtonOnInitialization||i.shouldRenderPayPalButtonOnInitialization)&&this.renderButton(t,i))})}execute(e,t){return ce(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]),{onError:o}=this.bigcommerce_payments||{};if(!i)throw new oe([\"payment\"]);const{methodId:r,paymentData:a}=i;if(this.isPayPalVaultedInstrumentPaymentData(a)&&!this.orderId&&(this.orderId=yield this.createOrder()),!this.orderId)throw new re;const s=this.isPayPalVaultedInstrumentPaymentData(a)?this.prepareVaultedInstrumentPaymentPayload(r,this.orderId,a):this.preparePaymentPayload(r,this.orderId,a);try{yield this.paymentIntegrationService.submitOrder(n,t),yield this.paymentIntegrationService.submitPayment(s)}catch(e){return this.isProviderError(e)&&(yield this.bigCommercePaymentsIntegrationService.loadPayPalSdk(i.methodId),yield new Promise((e,t)=>{var n;this.bigcommerce_payments&&(null===(n=this.paypalButton)||void 0===n||n.close(),this.renderButton(i.methodId,this.bigcommerce_payments),this.handleError(new Error(\"INSTRUMENT_DECLINED\"),o)),t()})),this.handleError(e,o),Promise.reject()}})}finalize(){return Promise.reject(new ae)}deinitialize(){var e;return this.orderId=void 0,null===(e=this.paypalButton)||void 0===e||e.close(),Promise.resolve()}prepareVaultedInstrumentPaymentPayload(e,t,i){const{instrumentId:n,shouldSetAsDefaultInstrument:o}=i,r=!this.isTrustedVaultingFlow(i);return r?{methodId:e,paymentData:{shouldSaveInstrument:r,shouldSetAsDefaultInstrument:o,formattedPayload:{paypal_account:{order_id:t}}}}:{methodId:e,paymentData:{instrumentId:n,shouldSetAsDefaultInstrument:o,formattedPayload:{paypal_account:{order_id:t},bigpay_token:{token:n}}}}}preparePaymentPayload(e,t,i){const{shouldSaveInstrument:n=!1,shouldSetAsDefaultInstrument:o=!1}=se(i)?i:{};return{methodId:e,paymentData:{shouldSaveInstrument:n,shouldSetAsDefaultInstrument:o,formattedPayload:{paypal_account:{order_id:t}}}}}renderButton(e,t){const i=this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow(),n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),{paymentButtonStyles:o}=n.initializationData||{},{checkoutPaymentButtonStyles:r}=o||{},{container:a,onError:s,onRenderButton:d,onValidate:l,submitForm:c}=t;if(!a)throw new N('Unable to initialize payment because \"container\" argument is not provided.');const m={fundingSource:i.FUNDING.PAYPAL,style:this.bigCommercePaymentsIntegrationService.getValidButtonStyle(r),createOrder:()=>this.createOrder(),onClick:(e,t)=>this.handleClick(t,l),onApprove:e=>this.handleApprove(e,c),onError:e=>this.handleError(e,s),onCancel:()=>this.toggleLoadingIndicator(!1)};this.paypalButton=i.Buttons(m),this.paypalButton.isEligible()&&(d&&\"function\"==typeof d&&d(),this.paypalButton.render(a))}handleClick(e,t){return ce(this,void 0,void 0,function*(){const{resolve:i,reject:n}=e;yield null==t?void 0:t(()=>(this.toggleLoadingIndicator(!0),i()),n)})}handleApprove({orderID:e},t){this.orderId=e,null==t||t()}handleError(e,t){this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}createOrder(){return ce(this,void 0,void 0,function*(){const e=this.getFieldsValues();return this.bigCommercePaymentsIntegrationService.createOrder(\"bigcommerce_paymentscheckout\",{shouldSaveInstrument:(null==e?void 0:e.shouldSaveInstrument)||!1})})}getFieldsValues(){const{getFieldsValues:e}=this.bigcommerce_payments||{};return\"function\"==typeof e?e():void 0}isTrustedVaultingFlow(e){if(e&&de(e)){const t=this.paymentIntegrationService.getState().getInstruments(),i=null==t?void 0:t.find(t=>le(t)&&t.bigpayToken===e.instrumentId);return!(le(i)&&!i.trustedShippingAddress)}return!1}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}isPayPalVaultedInstrumentPaymentData(e){return!!e&&de(e)&&se(e)}renderMessages(e,t,i){const n={amount:this.paymentIntegrationService.getState().getCheckoutOrThrow().outstandingBalance,placement:\"payment\",style:q(i)};e.Messages(n).render(`#${t}`)}isProviderError(e){var t,i,n;return!!function(e){return\"object\"==typeof e&&null!==e&&\"errors\"in e}(e)&&\"INSTRUMENT_DECLINED\"===(null===(n=null===(i=((null===(t=null==e?void 0:e.errors)||void 0===t?void 0:t.filter(e=>e.provider_error))||[])[0])||void 0===i?void 0:i.provider_error)||void 0===n?void 0:n.code)}}const ue=m(e=>new me(e,D(e),$(),new ie({containerStyles:ne})),[{id:\"bigcommerce_payments\"}]);var he,ye,pe,ge,ve,fe,be,Pe,Se;!function(e){e.CVV=\"cvv\",e.PAN=\"pan\"}(he||(he={}));class Ie{static get(e){const t=`${encodeURIComponent(`${e}`)}=`,i=document.cookie;let n=null;const o=i.indexOf(t);if(o>-1){let e=i.indexOf(\";\",o);-1===e&&(e=i.length),n=decodeURIComponent(i.substring(o+t.length,e))}return n}static set(e,t,i={secure:!0}){let n=`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;const{expires:o,path:r,domain:a,secure:s}=i;if(o)n+=`; expires=${o.toUTCString()}`;else{const e=new Date,t=60;e.setTime(e.getTime()+60*t*1e3),n+=`; expires=${e.toUTCString()}`}r&&(n+=`; path=${r}`),a&&(n+=`; domain=${a}`),s&&(n+=\"; secure\"),document.cookie=n}static remove(e,t){Ie.set(e,\"\",Object.assign({expires:new Date(0)},t))}}!function(e){e.AUTHORIZE=\"authorize\",e.CAPTURE=\"capture\"}(ye||(ye={})),function(e){e.Possible=\"POSSIBLE\",e.No=\"NO\",e.Unknown=\"UNKNOWN\",e.Yes=\"YES\"}(pe||(pe={})),function(e){e.Always=\"SCA_ALWAYS\"}(ge||(ge={})),function(e){e.Succeeded=\"succeeded\",e.Cancelled=\"cancelled\",e.Errored=\"errored\"}(ve||(ve={})),function(e){e.paypal=\"paypal\",e.checkout=\"checkout\",e.buynow=\"buynow\",e.pay=\"pay\",e.installment=\"installment\"}(fe||(fe={})),function(e){e.gold=\"gold\",e.blue=\"blue\",e.silver=\"silver\",e.black=\"black\",e.white=\"white\"}(be||(be={})),function(e){e.pill=\"pill\",e.rect=\"rect\"}(Pe||(Pe={})),function(e){e.SUCCEEDED=\"succeeded\",e.FAILED=\"failed\",e.CANCELED=\"canceled\",e.UNRECOGNIZED=\"unrecognized\"}(Se||(Se={}));var Ce=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class we{constructor(){this.window=window}initializePayPalFastlane(e,t,i){return Ce(this,void 0,void 0,function*(){if(t&&(window.localStorage.setItem(\"fastlaneEnv\",\"sandbox\"),window.localStorage.setItem(\"axoEnv\",\"sandbox\")),!this.window.paypalFastlane){const t={root:{backgroundColorPrimary:\"transparent\"}};this.window.paypalFastlane=yield e.Fastlane({styles:i||t})}return this.window.paypalFastlane})}getPayPalFastlaneOrThrow(){if(!this.window.paypalFastlane)throw new h;return this.window.paypalFastlane}lookupCustomerOrThrow(e){return Ce(this,void 0,void 0,function*(){return this.getPayPalFastlaneOrThrow().identity.lookupCustomerByEmail(e)})}triggerAuthenticationFlowOrThrow(e){return Ce(this,void 0,void 0,function*(){return e?this.getPayPalFastlaneOrThrow().identity.triggerAuthenticationFlow(e):{}})}updateStorageSessionId(e){const t=new Date;t.setDate(t.getDate()+14);const i={expires:t,secure:!0};Ie.set(\"bc-fastlane-sessionId\",e,i)}removeStorageSessionId(){Ie.remove(\"bc-fastlane-sessionId\")}getStorageSessionId(){return Ie.get(\"bc-fastlane-sessionId\")||\"\"}mapPayPalFastlaneProfileToBcCustomerData(e,t){var i,n,o;const{authenticationState:r,profileData:a}=t,s=null===(o=null===(n=null===(i=null==a?void 0:a.card)||void 0===i?void 0:i.paymentSource)||void 0===n?void 0:n.card)||void 0===o?void 0:o.billingAddress,d=null==a?void 0:a.shippingAddress,l=null==a?void 0:a.name,c=null==a?void 0:a.card,m=d?this.mapPayPalToBcAddress(d.address,d.name,d.phoneNumber):void 0,u=s&&l?this.mapPayPalToBcAddress(s,l,null==d?void 0:d.phoneNumber):void 0,h=c?this.mapPayPalToBcInstrument(e,c):[],y=this.filterAddresses([m,u]);return{authenticationState:r||Se.UNRECOGNIZED,addresses:y,billingAddress:u,shippingAddress:m,instruments:h}}mapPayPalToBcInstrument(e,t){const{id:i,paymentSource:n}=t,{brand:o,expiry:r,lastDigits:a}=n.card,[s,d]=r.split(\"-\");return[{bigpayToken:i,brand:o,defaultInstrument:!1,expiryMonth:d,expiryYear:s,iin:\"\",last4:a,method:e,provider:e,trustedShippingAddress:!1,untrustedShippingCardVerificationMode:he.PAN,type:\"card\"}]}mapBcToPayPalAddress(e){return{company:(null==e?void 0:e.company)||\"\",addressLine1:(null==e?void 0:e.address1)||\"\",addressLine2:(null==e?void 0:e.address2)||\"\",adminArea1:(null==e?void 0:e.stateOrProvinceCode)||(null==e?void 0:e.stateOrProvince)||\"\",adminArea2:(null==e?void 0:e.city)||\"\",postalCode:(null==e?void 0:e.postalCode)||\"\",countryCode:(null==e?void 0:e.countryCode)||\"\"}}mapPayPalToBcAddress(e,t,i,n){const[o,r]=t.fullName.split(\" \"),a=(null==i?void 0:i.nationalNumber)||\"\",s=(null==i?void 0:i.countryCode)||\"\";return{id:Date.now(),type:\"paypal-address\",firstName:t.firstName||o||\"\",lastName:t.lastName||r||\"\",company:e.company||\"\",address1:e.addressLine1,address2:e.addressLine2||\"\",city:e.adminArea2,stateOrProvince:e.adminArea1,stateOrProvinceCode:e.adminArea1,country:e.countryCode||\"\",countryCode:e.countryCode||\"\",postalCode:e.postalCode,phone:s+a,customFields:n||[]}}filterAddresses(e){return e.reduce((e,t)=>t?e.some(e=>this.isEqualAddresses(e,t))?e:[...e,t]:e,[])}isEqualAddresses(e,t){return (0,lodash__WEBPACK_IMPORTED_MODULE_3__.isEqual)(this.normalizeAddress(e),this.normalizeAddress(t))}normalizeAddress(e){return (0,lodash__WEBPACK_IMPORTED_MODULE_3__.omit)(e,[\"id\",\"phone\"])}}function Oe(){return new we}function _e(e){return\"string\"!=typeof e}function ke(e,t){if(t||e)return function(e){var t,i;const n={},o=(0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)(e.root,_e),r=(0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)(e.input,_e),a=(0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)(e.toggle,_e),s=(0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)(null===(t=e.text)||void 0===t?void 0:t.body,_e),l=(0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)(null===(i=e.text)||void 0===i?void 0:i.caption,_e),c=e.branding;return Object.keys(o).length&&(n.root=o),Object.keys(r).length&&(n.input=r),Object.keys(a).length&&(n.toggle=a),Object.keys(s).length&&(n.text={},n.text.body=s),Object.keys(l).length&&(n.text=Object.assign({},n.text),n.text.caption=l),c&&(n.branding=c),n}(function(e,t){var i,n,o,r,a,s,d,l,c,m,u,h,y,p,g,v,f,b,P,S,I,C;return{root:{backgroundColorPrimary:(null==e?void 0:e.fastlaneRootSettingsBackgroundColor)||(null===(i=null==t?void 0:t.root)||void 0===i?void 0:i.backgroundColorPrimary),errorColor:(null==e?void 0:e.fastlaneRootSettingsErrorColor)||(null===(n=null==t?void 0:t.root)||void 0===n?void 0:n.errorColor),fontFamily:(null==e?void 0:e.fastlaneRootSettingsFontFamily)||(null===(o=null==t?void 0:t.root)||void 0===o?void 0:o.fontFamily),fontSizeBase:(null==e?void 0:e.fastlaneRootSettingsFontSize)||(null===(r=null==t?void 0:t.root)||void 0===r?void 0:r.fontSizeBase),padding:(null==e?void 0:e.fastlaneRootSettingsPadding)||(null===(a=null==t?void 0:t.root)||void 0===a?void 0:a.padding),primaryColor:(null==e?void 0:e.fastlaneRootSettingsPrimaryColor)||(null===(s=null==t?void 0:t.root)||void 0===s?void 0:s.primaryColor)},input:{borderRadius:(null==e?void 0:e.fastlaneInputSettingsBorderRadius)||(null===(d=null==t?void 0:t.input)||void 0===d?void 0:d.borderRadius),borderColor:(null==e?void 0:e.fastlaneInputSettingsBorderColor)||(null===(l=null==t?void 0:t.input)||void 0===l?void 0:l.borderColor),focusBorderColor:(null==e?void 0:e.fastlaneInputSettingsFocusBorderBase)||(null===(c=null==t?void 0:t.input)||void 0===c?void 0:c.focusBorderColor),backgroundColor:(null==e?void 0:e.fastlaneInputSettingsBackgroundColor)||(null===(m=null==t?void 0:t.input)||void 0===m?void 0:m.backgroundColor),borderWidth:(null==e?void 0:e.fastlaneInputSettingsBorderWidth)||(null===(u=null==t?void 0:t.input)||void 0===u?void 0:u.borderWidth),textColorBase:(null==e?void 0:e.fastlaneInputSettingsTextColorBase)||(null===(h=null==t?void 0:t.input)||void 0===h?void 0:h.textColorBase)},toggle:{colorPrimary:(null==e?void 0:e.fastlaneToggleSettingsColorPrimary)||(null===(y=null==t?void 0:t.toggle)||void 0===y?void 0:y.colorPrimary),colorSecondary:(null==e?void 0:e.fastlaneToggleSettingsColorSecondary)||(null===(p=null==t?void 0:t.toggle)||void 0===p?void 0:p.colorSecondary)},text:{body:{color:(null==e?void 0:e.fastlaneTextBodySettingsColor)||(null===(v=null===(g=null==t?void 0:t.text)||void 0===g?void 0:g.body)||void 0===v?void 0:v.color),fontSize:(null==e?void 0:e.fastlaneTextBodySettingsFontSize)||(null===(b=null===(f=null==t?void 0:t.text)||void 0===f?void 0:f.body)||void 0===b?void 0:b.fontSize)},caption:{color:(null==e?void 0:e.fastlaneTextCaptionSettingsColor)||(null===(S=null===(P=null==t?void 0:t.text)||void 0===P?void 0:P.caption)||void 0===S?void 0:S.color),fontSize:(null==e?void 0:e.fastlaneTextCaptionSettingsFontSize)||(null===(C=null===(I=null==t?void 0:t.text)||void 0===I?void 0:I.caption)||void 0===C?void 0:C.fontSize)}},branding:(null==e?void 0:e.fastlaneBrandingSettings)||(null==t?void 0:t.branding)}}(e,t))}function Ae(e){return!!e&&(\"authenticationState\"in e||\"addresses\"in e||\"instruments\"in e)}function Ee(e,t,i=!0){var n;return null!==(n=e[t])&&void 0!==n?n:i}var Te=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ze{constructor(e,t,i,n){this.paymentIntegrationService=e,this.bigCommercePaymentsRequestSender=t,this.bigCommercePaymentsSdk=i,this.bigCommercePaymentsFastlaneUtils=n}initialize(e){var t,i;return Te(this,void 0,void 0,function*(){const{methodId:n,bigcommerce_payments_fastlane:o}=e;if(!n)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(this.methodId=n,!o)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_fastlane\" argument is not provided.');if(this.bigcommerce_payments_fastlane=o,!o.onInit||\"function\"!=typeof o.onInit)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_fastlane.onInit\" argument is not provided or it is not a function.');if(!o.onChange||\"function\"!=typeof o.onChange)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_fastlane.onChange\" argument is not provided or it is not a function.');yield this.paymentIntegrationService.loadPaymentMethod(n);const r=this.paymentIntegrationService.getState(),a=r.getCartOrThrow(),s=r.getPaymentMethodOrThrow(n),{isDeveloperModeApplicable:d,isFastlaneStylingEnabled:l}=s.initializationData||{};this.threeDSVerificationMethod=null===(t=s.initializationData)||void 0===t?void 0:t.threeDSVerificationMethod,this.paypalFastlaneSdk=yield this.bigCommercePaymentsSdk.getPayPalFastlaneSdk(s,a.currency.code,a.id);const c=ke(l?null===(i=null==s?void 0:s.initializationData)||void 0===i?void 0:i.fastlaneStyles:{},null==o?void 0:o.styles);yield this.bigCommercePaymentsFastlaneUtils.initializePayPalFastlane(this.paypalFastlaneSdk,!!d,c),this.shouldRunAuthenticationFlow()&&(yield this.runPayPalAuthenticationFlowOrThrow(n)),yield this.initializePayPalPaymentComponent(),o.onInit(e=>this.renderPayPalPaymentComponent(e)),o.onChange(()=>this.handlePayPalStoredInstrumentChange(n))})}execute(e,t){return Te(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]);if(!i)throw new oe([\"payment\"]);const{paymentData:o,methodId:r}=i,a=o&&de(o);try{yield this.paymentIntegrationService.submitOrder(n,t);const e=a?yield this.prepareVaultedInstrumentPaymentPayload(r,o):yield this.preparePaymentPayload(r,o);yield this.paymentIntegrationService.submitPayment(e),this.bigCommercePaymentsFastlaneUtils.removeStorageSessionId()}catch(e){if(function(e){return\"object\"==typeof e&&null!==e&&\"message\"in e&&\"response\"in e&&\"name\"in e.response}(e)&&\"INVALID_REQUEST\"===e.response.name){const e={translationKey:\"payment.errors.invalid_request_error\"};return this.handleError(e),Promise.reject()}if(e instanceof Error&&\"FastlaneError\"!==e.name)throw e;return Promise.reject()}})}finalize(){return Promise.reject(new ae)}deinitialize(){return Te(this,void 0,void 0,function*(){return Promise.resolve()})}shouldRunAuthenticationFlow(){const e=this.paymentIntegrationService.getState(),t=e.getCartOrThrow(),i=e.getCustomerOrThrow(),n=e.getPaymentProviderCustomer(),o=Ae(n)?n:{},r=this.bigCommercePaymentsFastlaneUtils.getStorageSessionId();return!(!i.isGuest||(null==o?void 0:o.authenticationState)===Se.CANCELED||(null==o?void 0:o.authenticationState)||r!==t.id)}runPayPalAuthenticationFlowOrThrow(e){return Te(this,void 0,void 0,function*(){try{const t=this.paymentIntegrationService.getState(),i=t.getCartOrThrow(),n=t.getCustomer(),o=t.getBillingAddress(),r=(null==n?void 0:n.email)||(null==o?void 0:o.email)||\"\",{customerContextId:a}=yield this.bigCommercePaymentsFastlaneUtils.lookupCustomerOrThrow(r),s=yield this.bigCommercePaymentsFastlaneUtils.triggerAuthenticationFlowOrThrow(a),{authenticationState:d,addresses:l,instruments:c}=this.bigCommercePaymentsFastlaneUtils.mapPayPalFastlaneProfileToBcCustomerData(e,s);yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:d,addresses:l,instruments:c}),s.authenticationState===Se.CANCELED?this.bigCommercePaymentsFastlaneUtils.removeStorageSessionId():this.bigCommercePaymentsFastlaneUtils.updateStorageSessionId(i.id)}catch(e){}})}initializePayPalPaymentComponent(){return Te(this,void 0,void 0,function*(){const e=this.paymentIntegrationService.getState().getBillingAddressOrThrow(),t=e.phone,i=`${e.firstName} ${e.lastName}`.trim(),n=this.bigCommercePaymentsFastlaneUtils.getPayPalFastlaneOrThrow(),o={fields:Object.assign({cardholderName:{prefill:i,enabled:!0}},t&&{phoneNumber:{prefill:t}})};this.paypalComponentMethods=yield n.FastlaneCardComponent(o)})}renderPayPalPaymentComponent(e){const t=this.getPayPalComponentMethodsOrThrow();if(!e)throw new N('Unable to render card component because \"container\" argument is not provided.');t.render(e)}getPayPalComponentMethodsOrThrow(){if(!this.paypalComponentMethods)throw new h;return this.paypalComponentMethods}prepareVaultedInstrumentPaymentPayload(e,t){return Te(this,void 0,void 0,function*(){const{instrumentId:i}=t,n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),o=this.isBigcommercePaymentsFastlaneThreeDSAvailable()&&n.config.is3dsEnabled?yield this.get3DSNonce(i):i;return yield this.createOrder(o),{methodId:e,paymentData:{formattedPayload:{paypal_fastlane_token:{order_id:this.orderId,token:o}}}}})}preparePaymentPayload(e,t){return Te(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState(),n=i.getBillingAddressOrThrow(),o=i.getPaymentMethodOrThrow(e),r=`${n.firstName} ${n.lastName}`.trim(),{getPaymentToken:a}=this.getPayPalComponentMethodsOrThrow(),{id:s}=yield a({name:{fullName:r},billingAddress:this.bigCommercePaymentsFastlaneUtils.mapBcToPayPalAddress(n)}),d=this.isBigcommercePaymentsFastlaneThreeDSAvailable()&&o.config.is3dsEnabled,{shouldSaveInstrument:l=!1,shouldSetAsDefaultInstrument:c=!1}=se(t)?t:{},m=d?yield this.get3DSNonce(s):s;return yield this.createOrder(m),{methodId:e,paymentData:Object.assign(Object.assign({},t),{shouldSaveInstrument:l,shouldSetAsDefaultInstrument:c,formattedPayload:{paypal_fastlane_token:{order_id:this.orderId,token:m}}})}})}createOrder(e){return Te(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState().getCartOrThrow().id;if(this.methodId){const{orderId:i}=yield this.bigCommercePaymentsRequestSender.createOrder(this.methodId,{cartId:t,fastlaneToken:e});this.orderId=i}})}get3DSNonce(e){var t;return Te(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState(),n=i.getCartOrThrow(),o=i.getOrderOrThrow(),r=i.getStoreConfigOrThrow().links.checkoutLink,a=null===(t=this.paypalFastlaneSdk)||void 0===t?void 0:t.ThreeDomainSecureClient;if(!a)throw new h;const s={amount:o.orderAmount.toFixed(2),currency:n.currency.code,nonce:e,threeDSRequested:this.threeDSVerificationMethod===ge.Always,transactionContext:{experience_context:{locale:\"en-US\",return_url:r,cancel_url:r}}},d=yield a.isEligible(s);if(this.threeDSVerificationMethod===ge.Always&&!d)throw new re;if(d){const{liabilityShift:e,authenticationState:t,nonce:i}=yield a.show();if(e===b.No||e===b.Unknown||t===ve.Errored||t===ve.Cancelled)throw new re;if(t===ve.Succeeded&&[b.Yes,b.Possible].includes(e))return i}return e})}handlePayPalStoredInstrumentChange(e){return Te(this,void 0,void 0,function*(){const t=this.bigCommercePaymentsFastlaneUtils.getPayPalFastlaneOrThrow(),{selectionChanged:i,selectedCard:n}=yield t.profile.showCardSelector();if(i){const t=this.paymentIntegrationService.getState().getPaymentProviderCustomer(),i=Ae(t)?t:{},o=this.bigCommercePaymentsFastlaneUtils.mapPayPalToBcInstrument(e,n)[0];return yield this.paymentIntegrationService.updatePaymentProviderCustomer(Object.assign(Object.assign({},i),{instruments:[o]})),o}})}isBigcommercePaymentsFastlaneThreeDSAvailable(){return Ee(this.paymentIntegrationService.getState().getStoreConfigOrThrow().checkoutSettings.features,\"PROJECT-7080.bcp_fastlane_three_ds\")}handleError(e){var t;(null===(t=this.bigcommerce_payments_fastlane)||void 0===t?void 0:t.onError)&&\"function\"==typeof this.bigcommerce_payments_fastlane.onError&&this.bigcommerce_payments_fastlane.onError(e)}}const Fe=m(e=>{const{getHost:i}=e.getState();return new ze(e,new B((0,_bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_1__.createRequestSender)({host:i()})),$(),Oe())},[{id:\"bigcommerce_payments_fastlane\"}]);class Be extends u{constructor(e){super(e||\"Not implemented.\"),this.name=\"NotImplementedError\",this.type=\"not_implemented\"}}var Me=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class xe{constructor(e,t,i,n){this.paymentIntegrationService=e,this.bigCommercePaymentsIntegrationService=t,this.loadingIndicator=i,this.paypalSdkHelper=n}initialize(e){return Me(this,void 0,void 0,function*(){const{methodId:t,bigcommerce_payments_paylater:i}=e||{};if(!t)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!i)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_paylater\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(t);const n=this.paymentIntegrationService.getState(),o=n.getPaymentMethodOrThrow(t),{paypalBNPLConfiguration:r=[],orderId:a}=o.initializationData||{},{bannerContainerId:s,container:d}=i;if(void 0!==s){if(!document.getElementById(s))return void console.error(\"Unable to create banner without valid banner container ID.\");const e=r&&r.find(({id:e})=>\"checkout\"===e);if(!(null==e?void 0:e.status))return;const t=yield this.paypalSdkHelper.getPayPalMessages(o,n.getCartOrThrow().currency.code);return this.renderMessages(t,s,e)}a?this.orderId=a:(yield this.bigCommercePaymentsIntegrationService.loadPayPalSdk(t),this.loadingIndicatorContainer=null==d?void 0:d.split(\"#\")[1],this.renderButton(t,i))})}execute(e,t){return Me(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]);if(!i)throw new oe([\"payment\"]);if(!this.orderId)throw new re;yield this.paymentIntegrationService.submitOrder(n,t),yield this.bigCommercePaymentsIntegrationService.submitPayment(i.methodId,this.orderId)})}finalize(){return Promise.reject(new ae)}deinitialize(){var e;return this.orderId=void 0,null===(e=this.bigCommercePaymentsButtons)||void 0===e||e.close(),Promise.resolve()}renderButton(e,t){if(!(null==t?void 0:t.container))throw new N('Unable to initialize payment because \"container\" argument is not provided.');const i=this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow(),n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),{paymentButtonStyles:o}=n.initializationData||{},{checkoutPaymentButtonStyles:r}=o||{},{container:a,onError:s,onRenderButton:d,onValidate:l,submitForm:c}=t,m=[i.FUNDING.PAYLATER,i.FUNDING.CREDIT];let u=!1;m.forEach(e=>{if(u)return;const t={fundingSource:e,style:this.bigCommercePaymentsIntegrationService.getValidButtonStyle(r),createOrder:()=>this.bigCommercePaymentsIntegrationService.createOrder(\"bigcommerce_payments_paylater\"),onClick:(e,t)=>this.handleClick(t,l),onApprove:e=>this.handleApprove(e,c),onCancel:()=>this.toggleLoadingIndicator(!1),onError:e=>this.handleError(e,s)};if(this.bigCommercePaymentsButtons=i.Buttons(t),this.bigCommercePaymentsButtons.isEligible()||e!==i.FUNDING.PAYLATER){if(!this.bigCommercePaymentsButtons.isEligible()&&e===i.FUNDING.CREDIT)throw new Be(`BigCommercePayments ${e} is not available for your region. Please use BigCommercePayments Checkout instead.`);d&&\"function\"==typeof d&&d(),this.bigCommercePaymentsButtons.render(a),u=!0}})}handleClick(e,t){return Me(this,void 0,void 0,function*(){const{resolve:i,reject:n}=e;t&&\"function\"==typeof t&&(yield t(()=>(this.toggleLoadingIndicator(!0),i()),n))})}handleApprove({orderID:e},t){this.orderId=e,t&&\"function\"==typeof t&&t()}handleError(e,t){this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}renderMessages(e,t,i){const n={amount:this.paymentIntegrationService.getState().getCheckoutOrThrow().outstandingBalance,placement:\"payment\",style:q(i)};e.Messages(n).render(`#${t}`)}}const De=m(e=>new xe(e,D(e),new ie({containerStyles:ne}),$()),[{id:\"bigcommerce_payments_paylater\"}]);class Ne extends v{constructor(e){super(e,{message:\"The request has timed out or aborted.\"}),this.name=\"TimeoutError\",this.type=\"timeout\"}}var Ue=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class je{constructor(e,t,i,n=3e3,o=3e5){this.paymentIntegrationService=e,this.bigCommercePaymentsIntegrationService=t,this.loadingIndicator=i,this.pollingInterval=n,this.maxPollingIntervalTime=o,this.pollingTimer=0,this.stopPolling=lodash__WEBPACK_IMPORTED_MODULE_3__.noop}initialize(e){return Ue(this,void 0,void 0,function*(){const{gatewayId:t,methodId:i,bigcommerce_payments_ratepay:n}=e;if(!i)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new N('Unable to initialize payment because \"options.gatewayId\" argument is not provided.');if(!n)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_ratepay\" argument is not provided.');const{legalTextContainer:o,container:r,loadingContainerId:a}=n;if(!r)throw new N('Unable to initialize payment because \"options.container\" argument is not provided.');if(!o)throw new N('Unable to initialize payment because \"options.legalTextContainer\" argument is not provided.');if(!a)throw new N('Unable to initialize payment because \"options.loadingContainerId\" argument is not provided.');this.loadingIndicatorContainer=a;const s=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(i,t),{merchantId:d}=s.initializationData||{};if(!d)throw new N(\"Unable to initialize payment because merchantId argument is not provided.\");this.bigcommerce_payments_ratepay=n,yield this.bigCommercePaymentsIntegrationService.loadPayPalSdk(i),this.createFraudNetScript(d,i,t),this.loadFraudnetConfig(),this.renderLegalText(o,r)})}execute(e,t){return Ue(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]),{getFieldsValues:o}=this.bigcommerce_payments_ratepay||{};if(!i)throw new oe([\"payment\"]);if(!o||\"function\"!=typeof o)throw new N('Unable to initialize payment because \"options.getFieldsValues\" argument is not provided.');this.toggleLoadingIndicator(!0);try{const e=yield this.bigCommercePaymentsIntegrationService.createOrder(\"bigcommerce_payments_apmscheckout\",{metadataId:this.guid}),{ratepayBirthDate:r,ratepayPhoneNumber:a,ratepayPhoneCountryCode:s}=o(),d={formattedPayload:{vault_payment_instrument:null,set_as_default_stored_instrument:null,device_info:null,method_id:i.methodId,rate_pay:{birth_date:this.normalizeDate(r),phone:{national_number:a,country_code:s.split(\"+\")[1]}},paypal_account:{order_id:e}}};return yield this.paymentIntegrationService.submitOrder(n,t),yield this.paymentIntegrationService.submitPayment({methodId:i.methodId,paymentData:d}),yield new Promise((e,t)=>{this.initializePollingMechanism(i.methodId,e,t,i.gatewayId)})}catch(e){return this.handleError(e),new Promise((e,t)=>t())}})}finalize(){return Promise.reject(new ae)}deinitialize(){const{legalTextContainer:e}=this.bigcommerce_payments_ratepay||{},t=document.querySelectorAll('[data-id=\"fraudnetScript\"]')[0],i=document.querySelectorAll('[data-id=\"fraudnetConfig\"]')[0];if(this.deinitializePollingMechanism(),t.remove(),i.remove(),e){const t=document.getElementById(e);null==t||t.remove()}return Promise.resolve()}normalizeDate(e){const t=this.formatDate(e.getDate()),i=this.formatDate(e.getMonth()+1);return`${e.getFullYear()}-${i}-${t}`}formatDate(e){return`${e<10?0:\"\"}${e}`}renderLegalText(e,t){const i=e,n=t.split(\"#\")[1],o=document.getElementById(n),r=null==o?void 0:o.parentNode,a=document.createElement(\"div\");a.style.marginBottom=\"20px\",a.setAttribute(\"id\",i),null==r||r.prepend(a);const s=this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow(),d=s.Legal({fundingSource:s.Legal.FUNDING.PAY_UPON_INVOICE});if(!document.getElementById(i))throw new N('Unable to initialize payment because \"legalTextContainerElement\" argument is not found.');d.render(`#${i}`)}handleError(e){const{onError:t}=this.bigcommerce_payments_ratepay||{};this.resetPollingMechanism(),this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}createFraudNetScript(e,t,i){const n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t,i),{testMode:o}=n.config,r=document.createElement(\"script\");r.setAttribute(\"type\",\"application/json\"),r.setAttribute(\"fncls\",\"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99\"),r.setAttribute(\"data-id\",\"fraudnetScript\"),this.guid=this.generateGUID();const a={f:this.guid,s:`${e}_checkout-page`,sandbox:o};r.innerHTML=JSON.stringify(a),document.body.appendChild(r)}generateGUID(){let e=\"\";for(let t=0;t<32;t+=1)e+=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\"[Math.floor(62*Math.random())];return e}loadFraudnetConfig(){const e=document.createElement(\"script\");e.setAttribute(\"data-id\",\"fraudnetConfig\"),e.src=\"https://c.paypal.com/da/r/fb.js\",document.body.appendChild(e)}reinitializeStrategy(e){return Ue(this,void 0,void 0,function*(){yield this.deinitialize(),yield this.initialize(e)})}initializePollingMechanism(e,t,i,n){return Ue(this,void 0,void 0,function*(){yield new Promise((e,t)=>{const i=setTimeout(e,this.pollingInterval);this.stopPolling=()=>(clearTimeout(i),this.toggleLoadingIndicator(!1),t())});try{this.pollingTimer+=this.pollingInterval;const o=yield this.bigCommercePaymentsIntegrationService.getOrderStatus(\"bigcommerce_payments_apms\",{params:{useMetadata:!0}}),r=o===O.PollingStop,a=o===O.PollingError;if(r)return this.deinitializePollingMechanism(),t();if(a)return i();if(!r&&this.pollingTimer<this.maxPollingIntervalTime)return yield this.initializePollingMechanism(e,t,i,n);yield this.reinitializeStrategy({methodId:e,gatewayId:n,bigcommerce_payments_ratepay:this.bigcommerce_payments_ratepay}),this.handleError(new Ne)}catch(e){this.handleError(e),i()}})}deinitializePollingMechanism(){this.stopPolling(),this.pollingTimer=0}resetPollingMechanism(){this.deinitializePollingMechanism()}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}}const Ve=m(e=>new je(e,D(e),new ie({containerStyles:Object.assign(Object.assign({},ne),{position:\"fixed\"})})),[{gateway:\"bigcommerce_payments_apms\",id:\"ratepay\"}]);var Re;!function(e){e.CardCode=\"cardCode\",e.CardCodeVerification=\"cardCodeVerification\",e.CardExpiry=\"cardExpiry\",e.CardName=\"cardName\",e.CardNumber=\"cardNumber\",e.CardNumberVerification=\"cardNumberVerification\",e.CardExpiryVerification=\"cardExpiryVerification\"}(Re||(Re={}));const Le=Re;function $e(e){return Le.CardNumber in e&&Le.CardName in e&&Le.CardExpiry in e}function qe(e){return Le.CardNumberVerification in e&&Le.CardCodeVerification in e&&Le.CardExpiryVerification in e}class He extends u{constructor(e){super(e||\"Unable to proceed because the client library of a payment method has thrown an unexpected error.\"),this.name=\"PaymentMethodFailedError\",this.type=\"payment_method_client_invalid\"}}var Ge;!function(e){e[e.CheckoutButtonNotInitialized=0]=\"CheckoutButtonNotInitialized\",e[e.CustomerNotInitialized=1]=\"CustomerNotInitialized\",e[e.PaymentNotInitialized=2]=\"PaymentNotInitialized\",e[e.ShippingNotInitialized=3]=\"ShippingNotInitialized\",e[e.SpamProtectionNotInitialized=4]=\"SpamProtectionNotInitialized\"}(Ge||(Ge={}));class Ye extends u{constructor(e){super(function(e){switch(e){case Ge.CustomerNotInitialized:return\"Unable to proceed because the customer step of checkout has not been initialized.\";case Ge.PaymentNotInitialized:return\"Unable to proceed because the payment step of checkout has not been initialized.\";case Ge.ShippingNotInitialized:return\"Unable to proceed because the shipping step of checkout has not been initialized.\";case Ge.SpamProtectionNotInitialized:return\"Unable to proceed because the checkout spam protection has not been initialized.\";default:return\"Unable to proceed because the required component has not been initialized.\"}}(e)),this.subtype=e,this.name=\"NotInitializedError\",this.type=\"not_initialized\"}}class We extends u{constructor(e,t){super(t||\"Unable to proceed because the payment form contains invalid data.\"),this.details=e,this.name=\"PaymentInvalidFormError\",this.type=\"payment_invalid_form\"}}var Ke=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Je{constructor(e,t,i,n){this.paymentIntegrationService=e,this.bigCommercePaymentsIntegrationService=t,this.bigCommercePaymentsSdk=i,this.bigCommercePaymentsFastlaneUtils=n}initialize(e){return Ke(this,void 0,void 0,function*(){const{methodId:t,bigcommerce_payments_creditcards:i}=e,n=i,{form:o,onCreditCardFieldsRenderingError:r,onLoadComplete:a}=n||{};if(!t)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!o)throw new N('Unable to proceed because \"options.bigcommerce_payments_creditcards.form\" argument is not provided.');this.hostedFormOptions=o,this.isCreditCardForm=$e(o.fields),this.isCreditCardVaultedForm=qe(o.fields)&&!this.hasUndefinedValues(),yield this.paymentIntegrationService.loadPaymentMethod(t),yield this.bigCommercePaymentsIntegrationService.loadPayPalSdk(t,void 0,!0,!0),(this.isCreditCardForm||this.isCreditCardVaultedForm)&&(yield this.initializeFields(o,r)),null==a||a(),this.shouldInitializePayPalFastlane(t)&&(yield this.initializePayPalFastlaneOrThrow(t))})}execute(e,t){return Ke(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]),{methodId:o,paymentData:r}=i||{};if(!i||!o)throw new oe([\"payment\"]);if(this.executionPaymentData=r,this.isCreditCardForm||this.isCreditCardVaultedForm)yield this.validateHostedFormOrThrow(),yield this.submitHostedForm();else{const{orderId:e}=yield this.bigCommercePaymentsIntegrationService.createOrderCardFields(\"bigcommerce_payments_creditcardscheckout\",this.getInstrumentParams());this.returnedOrderId=e}const a=this.preparePaymentPayload(o,r,this.returnedOrderId,this.returnedVaultedToken);yield this.paymentIntegrationService.submitOrder(n,t),yield this.paymentIntegrationService.submitPayment(a)})}finalize(){return Promise.reject(new ae)}deinitialize(){var e,t,i,n;return Ke(this,void 0,void 0,function*(){return yield null===(e=this.cvvField)||void 0===e?void 0:e.close(),yield null===(t=this.expiryField)||void 0===t?void 0:t.close(),yield null===(i=this.numberField)||void 0===i?void 0:i.close(),yield null===(n=this.nameField)||void 0===n?void 0:n.close(),Promise.resolve()})}preparePaymentPayload(e,t,i,n){const{shouldSaveInstrument:o=!1,shouldSetAsDefaultInstrument:a=!1}=se(t)?t:{},s=t&&de(t)?t.instrumentId:void 0,l=(0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)({verification_nonce:n,token:s},lodash__WEBPACK_IMPORTED_MODULE_3__.isNil);return{methodId:e,paymentData:{shouldSaveInstrument:o,shouldSetAsDefaultInstrument:a,instrumentId:s,formattedPayload:Object.assign(Object.assign({},n||s?{bigpay_token:l}:{}),i?{card_with_order:{order_id:i}}:{})}}}initializeFields(e,t){return Ke(this,void 0,void 0,function*(){const{fields:i,styles:n}=e,o=this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow(),r=this.getExecuteCallback(i),a=Object.assign({style:this.getInputStyles(n),onApprove:({orderID:e,vaultSetupToken:t,liabilityShift:i})=>{if(i===b.No||i===b.Unknown)throw new Error;return this.handleApprove({orderID:e,vaultSetupToken:t})},onError:()=>{throw new He},inputEvents:{onChange:t=>this.onChangeHandler(e,t),onFocus:t=>this.onFocusHandler(e,t),onBlur:t=>this.onBlurHandler(e,t),onInputSubmitRequest:t=>this.onInputSubmitRequest(e,t)}},r);if(this.cardFields=yield o.CardFields(a),!this.cardFields.isEligible())throw new Ye(Ge.PaymentNotInitialized);try{this.stylizeInputContainers(i),$e(i)&&(yield this.renderFields(i)),qe(i)&&(yield this.renderVaultedFields(i))}catch(e){\"function\"==typeof t&&t(e)}})}getExecuteCallback(e){return qe(e)?this.createVaultSetupTokenCallback():this.createOrderCallback()}createVaultSetupTokenCallback(){return{createVaultSetupToken:()=>Ke(this,void 0,void 0,function*(){const{setupToken:e}=(yield this.bigCommercePaymentsIntegrationService.createOrderCardFields(\"bigcommerce_payments_creditcardscheckout\",Object.assign(Object.assign({},this.getInstrumentParams()),{setupToken:!0})))||{};return e})}}createOrderCallback(){return{createOrder:()=>Ke(this,void 0,void 0,function*(){const{orderId:e}=(yield this.bigCommercePaymentsIntegrationService.createOrderCardFields(\"bigcommerce_payments_creditcardscheckout\",this.getInstrumentParams()))||{};return e})}}handleApprove({orderID:e,vaultSetupToken:t}){e&&(this.returnedOrderId=e),t&&(this.returnedVaultedToken=t)}renderFields(e){var t,i,n,o;return Ke(this,void 0,void 0,function*(){const r=this.getCardFieldsOrThrow();(null===(t=e.cardCode)||void 0===t?void 0:t.containerId)&&(this.cvvField=r.CVVField({placeholder:\"\"}),yield this.cvvField.render(`#${e.cardCode.containerId}`)),(null===(i=e.cardExpiry)||void 0===i?void 0:i.containerId)&&(this.expiryField=r.ExpiryField(),yield this.expiryField.render(`#${e.cardExpiry.containerId}`)),(null===(n=e.cardName)||void 0===n?void 0:n.containerId)&&(this.nameField=r.NameField({placeholder:\"\"}),yield this.nameField.render(`#${e.cardName.containerId}`)),(null===(o=e.cardNumber)||void 0===o?void 0:o.containerId)&&(this.numberField=r.NumberField({placeholder:\"\"}),yield this.numberField.render(`#${e.cardNumber.containerId}`))})}renderVaultedFields(e){var t,i,n;return Ke(this,void 0,void 0,function*(){const o=this.getCardFieldsOrThrow();(null===(t=e.cardCodeVerification)||void 0===t?void 0:t.containerId)&&(this.cvvField=o.CVVField({placeholder:\"\"}),yield this.cvvField.render(`#${e.cardCodeVerification.containerId}`)),(null===(i=e.cardExpiryVerification)||void 0===i?void 0:i.containerId)&&(this.expiryField=o.ExpiryField(),yield this.expiryField.render(`#${e.cardExpiryVerification.containerId}`)),(null===(n=e.cardNumberVerification)||void 0===n?void 0:n.containerId)&&(this.numberField=o.NumberField({placeholder:\"\"}),yield this.numberField.render(`#${e.cardNumberVerification.containerId}`))})}getInstrumentParams(){if(!this.executionPaymentData)return{};if(se(this.executionPaymentData)){const{shouldSaveInstrument:e,shouldSetAsDefaultInstrument:t}=this.executionPaymentData;return{shouldSaveInstrument:e,shouldSetAsDefaultInstrument:t}}if(de(this.executionPaymentData)){const{instrumentId:e}=this.executionPaymentData;return{instrumentId:e}}return{}}getFieldTypeByEmittedField({emittedBy:e}){return{fieldType:this.mapFieldType(e)}}submitHostedForm(){return Ke(this,void 0,void 0,function*(){const e=this.getCardFieldsOrThrow(),t=this.paymentIntegrationService.getState().getBillingAddressOrThrow(),i={billingAddress:{company:t.company,addressLine1:t.address1,addressLine2:t.address2,adminArea1:t.stateOrProvinceCode,adminArea2:t.city,postalCode:t.postalCode,countryCode:t.countryCode}};try{this.isCreditCardVaultedForm?yield e.submit():yield e.submit(i)}catch(e){throw new He(\"Failed authentication. Please try to authorize again.\")}})}validateHostedFormOrThrow(){var e,t;return Ke(this,void 0,void 0,function*(){const i=this.getCardFieldsOrThrow(),n=yield i.getState().then(e=>e),o=this.getValidityData(n);if(!o.isValid)throw null===(t=null===(e=this.hostedFormOptions)||void 0===e?void 0:e.onValidate)||void 0===t||t.call(e,o),new We(this.mapValidationErrors(o.errors))})}getValidityData({fields:e}){const t=Object.assign({},e);delete t.cardNameField;const i=Object.keys(t);return{isValid:i.every(e=>{var i;return null===(i=t[e])||void 0===i?void 0:i.isValid}),errors:i.reduce((e,i)=>{var n;const o=this.mapFieldType(i);return Object.assign(Object.assign({},e),{[o]:(null===(n=t[i])||void 0===n?void 0:n.isValid)?void 0:[this.getInvalidErrorByFieldType(o)]})},{})}}getInvalidErrorByFieldType(e){switch(e){case Le.CardCode:case Le.CardCodeVerification:return{fieldType:e,message:\"Invalid card code\",type:\"invalid_card_code\"};case Le.CardNumber:case Le.CardNumberVerification:return{fieldType:e,message:\"Invalid card number\",type:\"invalid_card_number\"};case Le.CardExpiry:case Le.CardExpiryVerification:return{fieldType:e,message:\"Invalid card expiry\",type:\"invalid_card_expiry\"};default:return{fieldType:e,message:\"Invalid field\",type:\"invalid\"}}}mapValidationErrors(e={}){const t={};return Object.keys(e).forEach(i=>{var n,o;t[i]=[{message:(null===(o=null===(n=e[i])||void 0===n?void 0:n[0])||void 0===o?void 0:o.message)||\"\",type:i}]}),t}mapFieldType(e){switch(e){case\"name\":return Le.CardName;case\"cardNumberField\":case\"number\":return this.isCreditCardForm?Le.CardNumber:Le.CardNumberVerification;case\"cardExpiryField\":case\"expiry\":return this.isCreditCardForm?Le.CardExpiry:Le.CardExpiryVerification;case\"cardCvvField\":case\"cvv\":return this.isCreditCardForm?Le.CardCode:Le.CardCodeVerification;default:throw new Error(\"Unexpected field type\")}}getCardFieldsOrThrow(){if(!this.cardFields)throw new Ye(Ge.PaymentNotInitialized);return this.cardFields}getInputStyles(e){var t,i,n;const o={\"font-size\":(null===(t=null==e?void 0:e.default)||void 0===t?void 0:t.fontSize)||\"1rem\",\"font-family\":(null===(i=null==e?void 0:e.default)||void 0===i?void 0:i.fontFamily)||\"Montserrat, Arial, Helvetica, sans-serif\",\"font-weight\":(null===(n=null==e?void 0:e.default)||void 0===n?void 0:n.fontWeight)||\"400\",outline:\"none\",padding:\"9px 13px\"},r=Object.assign(Object.assign({},o),{color:\"#333333\"});return{input:r,\".invalid\":Object.assign(Object.assign({},o),{color:\"red\"}),\".valid\":r,\":focus\":r}}stylizeInputContainers(e){Object.values(e||{}).forEach(e=>{const t=document.getElementById(`${(null==e?void 0:e.containerId)||\"\"}`);t&&(t.style.padding=\"0px\",t.style.boxShadow=\"none\",t.style.border=\"none\",t.style.background=\"transparent\",t.style.marginBottom=\"10px\",t.style.marginLeft=\"-5px\")})}hasUndefinedValues(){return!this.hostedFormOptions||Object.values(this.hostedFormOptions.fields).some(e=>void 0===e)}onChangeHandler(e,t){var i;null===(i=null==e?void 0:e.onValidate)||void 0===i||i.call(e,this.getValidityData(t))}onFocusHandler(e,t){var i;null===(i=null==e?void 0:e.onFocus)||void 0===i||i.call(e,this.getFieldTypeByEmittedField(t))}onBlurHandler(e,t){var i;null===(i=null==e?void 0:e.onBlur)||void 0===i||i.call(e,this.getFieldTypeByEmittedField(t))}onInputSubmitRequest(e,t){var i;null===(i=null==e?void 0:e.onEnter)||void 0===i||i.call(e,this.getFieldTypeByEmittedField(t))}shouldInitializePayPalFastlane(e){var t,i;const n=this.paymentIntegrationService.getState(),o=n.getPaymentMethodOrThrow(e),r=n.getPaymentProviderCustomer(),a=(s=r)&&(\"authenticationState\"in s||\"addresses\"in s||\"instruments\"in s)?r:{};var s;return(null===(t=null==o?void 0:o.initializationData)||void 0===t?void 0:t.isAcceleratedCheckoutEnabled)&&(null===(i=null==o?void 0:o.initializationData)||void 0===i?void 0:i.isBigCommercePaymentsAnalyticsV2Enabled)&&!(null==a?void 0:a.authenticationState)}initializePayPalFastlaneOrThrow(e){return Ke(this,void 0,void 0,function*(){try{const t=this.paymentIntegrationService.getState(),i=t.getCartOrThrow(),n=t.getPaymentMethodOrThrow(e),{initializationData:o}=n;if(!(null==o?void 0:o.connectClientToken))return;const r=yield this.bigCommercePaymentsSdk.getPayPalFastlaneSdk(n,i.currency.code,i.id);yield this.bigCommercePaymentsFastlaneUtils.initializePayPalFastlane(r,!!(null==o?void 0:o.isDeveloperModeApplicable))}catch(e){}})}}const Xe=m(e=>new Je(e,D(e),$(),Oe()),[{id:\"bigcommerce_payments_creditcards\"}]);var Ze=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Qe{constructor(e,t,i,n,o=3e3,r=3e5){this.paymentIntegrationService=e,this.bigCommercePaymentsIntegrationService=t,this.bigCommercePaymentsSdkHelper=i,this.loadingIndicator=n,this.pollingInterval=o,this.maxPollingIntervalTime=r,this.pollingTimer=0,this.stopPolling=lodash__WEBPACK_IMPORTED_MODULE_3__.noop,this.isPollingEnabled=!1}initialize(e){return Ze(this,void 0,void 0,function*(){const{gatewayId:t,methodId:i,bigcommerce_payments_apms:n}=e;if(this.bigCommercePaymentsAlternativeMethods=n,!i)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new N('Unable to initialize payment because \"options.gatewayId\" argument is not provided.');if(!n)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_apms\" argument is not provided.');const o=this.paymentIntegrationService.getState(),r=o.getPaymentMethodOrThrow(i,t),{orderId:a,shouldRenderFields:s}=r.initializationData||{},d=o.getStoreConfigOrThrow().checkoutSettings.features;this.isPollingEnabled=Ee(d,\"PAYPAL-5624.bcp_ideal_polling\"),a?this.orderId=a:(this.paypalApms=yield this.bigCommercePaymentsSdkHelper.getPayPalApmsSdk(r,o.getCartOrThrow().currency.code),this.loadingIndicatorContainer=n.container.split(\"#\")[1],this.renderButton(i,t,n),s&&this.renderFields(i,n))})}execute(e,t){return Ze(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]);if(!i)throw new oe([\"payment\"]);const{methodId:o,gatewayId:r}=i;if(!this.orderId)throw new re;this.isPollingEnabled&&\"ideal\"===o&&(yield new Promise((e,t)=>{this.initializePollingMechanism(o,e,t,r)})),this.isNonInstantPaymentMethod(o)||(yield this.paymentIntegrationService.submitOrder(n,t)),yield this.bigCommercePaymentsIntegrationService.submitPayment(o,this.orderId,r)})}finalize(){return Promise.reject(new ae)}deinitialize(){var e;return this.orderId=void 0,this.isPollingEnabled&&this.resetPollingMechanism(),null===(e=this.bigCommercePaymentsButton)||void 0===e||e.close(),Promise.resolve()}initializePollingMechanism(e,t,i,n){return Ze(this,void 0,void 0,function*(){yield new Promise((e,t)=>{const i=setTimeout(e,this.pollingInterval);this.stopPolling=()=>(clearTimeout(i),this.toggleLoadingIndicator(!1),t())});try{this.pollingTimer+=this.pollingInterval;const o=yield this.bigCommercePaymentsIntegrationService.getOrderStatus(n),r=o===O.Approved,a=o===O.PollingError;if(r)return this.deInitializePollingMechanism(),t();if(a)return i();if(!r&&this.pollingTimer<this.maxPollingIntervalTime)return yield this.initializePollingMechanism(e,t,i,n);yield this.reinitializeStrategy({methodId:e,gatewayId:n,bigCommercePaymentsAlternativeMethods:this.bigCommercePaymentsAlternativeMethods}),this.handleError(new Ne)}catch(e){i()}})}deInitializePollingMechanism(){this.stopPolling(),this.pollingTimer=0}resetPollingMechanism(){this.deInitializePollingMechanism()}reinitializeStrategy(e){return Ze(this,void 0,void 0,function*(){yield this.deinitialize(),yield this.initialize(e)})}handleError(e){const{onError:t}=this.bigCommercePaymentsAlternativeMethods||{};this.isPollingEnabled&&this.resetPollingMechanism(),this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}renderButton(e,t,i){const n=this.getPaypalAmpsSdkOrThrow(),o=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e,t),{buttonStyle:r}=o.initializationData||{},{container:a,onError:s,onRenderButton:d,submitForm:l}=i,c={fundingSource:e,style:this.bigCommercePaymentsIntegrationService.getValidButtonStyle(r),onInit:(e,t)=>i.onInitButton(t),createOrder:()=>this.onCreateOrder(e,t,i),onApprove:e=>this.handleApprove(e,l),onCancel:()=>{this.toggleLoadingIndicator(!1),this.deInitializePollingMechanism()},onError:e=>{this.deInitializePollingMechanism(),this.handleFailure(e,s)},onClick:(e,t)=>Ze(this,void 0,void 0,function*(){return i.onValidate(t.resolve,t.reject)})};this.bigCommercePaymentsButton=n.Buttons(c),this.bigCommercePaymentsButton.isEligible()&&(d&&\"function\"==typeof d&&d(),this.bigCommercePaymentsButton.render(a))}onCreateOrder(e,t,i){return Ze(this,void 0,void 0,function*(){const{onValidate:n}=i;yield n(()=>(this.toggleLoadingIndicator(!0),()=>Promise.resolve()),lodash__WEBPACK_IMPORTED_MODULE_3__.noop);const o=yield this.bigCommercePaymentsIntegrationService.createOrder(\"bigcommerce_payments_apms\");if(this.isNonInstantPaymentMethod(e)){const i={useStoreCredit:!1},n={params:{methodId:e,gatewayId:t}};yield this.paymentIntegrationService.submitOrder(i,n),yield this.bigCommercePaymentsIntegrationService.submitPayment(e,o,t)}return o})}handleApprove({orderID:e},t){this.orderId=e,t()}handleFailure(e,t){this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}renderFields(e,t){const i=this.getPaypalAmpsSdkOrThrow(),n=this.paymentIntegrationService.getState(),{firstName:o,lastName:r,email:a}=n.getBillingAddressOrThrow(),{apmFieldsContainer:s,apmFieldsStyles:d}=t;if(!s)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_apms\" argument should contain \"apmFieldsContainer\".');const l=document.querySelector(s);l&&(l.innerHTML=\"\");const c={fundingSource:e,style:d||{},fields:{name:{value:`${o} ${r}`},email:{value:a}}};i.PaymentFields(c).render(s)}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}isNonInstantPaymentMethod(e){return e.toUpperCase()in w}getPaypalAmpsSdkOrThrow(){if(!this.paypalApms)throw new h;return this.paypalApms}}const et=m(e=>new Qe(e,D(e),$(),new ie({containerStyles:ne})),[{gateway:\"bigcommerce_payments_apms\"}]);class tt{constructor(e,t){this.paymentIntegrationService=e,this.bigCommercePaymentsIntegrationService=t}initialize(e){const{gatewayId:t,methodId:i,bigcommerce_payments_apms:n}=e;if(this.bigCommercePaymentsAlternativeMethods=n,!i)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new N('Unable to initialize payment because \"options.gatewayId\" argument is not provided.');return Promise.resolve()}execute(e,t){return i=this,n=void 0,r=function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]);if(!i)throw new oe([\"payment\"]);const{methodId:o,gatewayId:r}=i;try{const e={formattedPayload:{vault_payment_instrument:null,set_as_default_stored_instrument:null,device_info:null,method_id:o,paypal_account:{order_id:yield this.bigCommercePaymentsIntegrationService.createOrder(\"bigcommerce_payments_apms\",{gatewayId:\"bigcommerce_payments_apms\",methodId:o})}}};yield this.paymentIntegrationService.submitOrder(n,t),yield this.paymentIntegrationService.submitPayment({methodId:o,gatewayId:r,paymentData:e})}catch(e){if(function(e){var t,i;return(e=>\"object\"==typeof e&&null!==e&&\"body\"in e)(e)&&(null===(i=null===(t=e.body)||void 0===t?void 0:t.additional_action_required)||void 0===i?void 0:i.data.redirect_url)}(e)){const t=e.body.additional_action_required.data.redirect_url;return new Promise((e,i)=>{window.location.replace(t),i()})}return this.handleError(e),Promise.reject(e)}},new((o=void 0)||(o=Promise))(function(e,t){function a(e){try{d(r.next(e))}catch(e){t(e)}}function s(e){try{d(r.throw(e))}catch(e){t(e)}}function d(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o(function(e){e(i)})).then(a,s)}d((r=r.apply(i,n||[])).next())});// removed by dead control flow\n var i, n, o, r; }finalize(){return Promise.reject(new ae)}deinitialize(){return Promise.resolve()}handleError(e){const{onError:t}=this.bigCommercePaymentsAlternativeMethods||{};t&&\"function\"==typeof t&&t(e)}}const it=m(e=>new tt(e,D(e)),[{gateway:\"bigcommerce_payments_apms\",id:\"klarna\"},{gateway:\"bigcommerce_payments_apms\",id:\"afterpay\"}]);var nt=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ot{constructor(e,t,i){this.paymentIntegrationService=e,this.bigCommercePaymentsIntegrationService=t,this.loadingIndicator=i}initialize(e){var t,i;return nt(this,void 0,void 0,function*(){const{methodId:n,bigcommerce_payments_venmo:o}=e||{};if(!n)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!o)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_venmo\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(n);const r=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(n);(null===(t=r.initializationData)||void 0===t?void 0:t.orderId)?this.orderId=null===(i=r.initializationData)||void 0===i?void 0:i.orderId:(yield this.bigCommercePaymentsIntegrationService.loadPayPalSdk(n),this.loadingIndicatorContainer=o.container.split(\"#\")[1],this.renderButton(n,o))})}execute(e,t){return nt(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]);if(!i)throw new oe([\"payment\"]);if(!this.orderId)throw new re;yield this.paymentIntegrationService.submitOrder(n,t),yield this.bigCommercePaymentsIntegrationService.submitPayment(i.methodId,this.orderId)})}finalize(){return Promise.reject(new ae)}deinitialize(){var e;return this.orderId=void 0,null===(e=this.paypalButton)||void 0===e||e.close(),Promise.resolve()}renderButton(e,t){const i=this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow(),n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),{paymentButtonStyles:o}=n.initializationData||{},{checkoutPaymentButtonStyles:r}=o||{},{container:a,onError:s,onRenderButton:d,onValidate:l,submitForm:c}=t,m={fundingSource:i.FUNDING.VENMO,style:this.bigCommercePaymentsIntegrationService.getValidButtonStyle(r),createOrder:()=>this.bigCommercePaymentsIntegrationService.createOrder(\"bigcommerce_payments_venmocheckout\"),onClick:(e,t)=>this.handleClick(t,l),onApprove:e=>this.handleApprove(e,c),onCancel:()=>this.toggleLoadingIndicator(!1),onError:e=>this.handleError(e,s)};if(this.paypalButton=i.Buttons(m),!this.paypalButton.isEligible())throw new Be(\"Venmo is not available for your region. Please another payment method instead.\");d&&\"function\"==typeof d&&d(),this.paypalButton.render(a)}handleClick(e,t){return nt(this,void 0,void 0,function*(){const{resolve:i,reject:n}=e;yield t(()=>(this.toggleLoadingIndicator(!0),i()),n)})}handleApprove({orderID:e},t){this.orderId=e,t(),this.toggleLoadingIndicator(!1)}handleError(e,t){this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}}const rt=m(e=>new ot(e,D(e),new ie({styles:{backgroundColor:\"black\"}})),[{id:\"bigcommerce_payments_venmo\"}]);var at=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class st{constructor(e,t){this.paymentIntegrationService=e,this.bigCommercePaymentsIntegrationService=t,this.onError=lodash__WEBPACK_IMPORTED_MODULE_3__.noop}initialize(e){return at(this,void 0,void 0,function*(){const{bigcommerce_payments:t,methodId:i}=e;if(!i)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new N('Unable to initialize payment because \"options.bigcommerce_payments\" argument is not provided.');if(!t.container)throw new N('Unable to initialize payment because \"options.bigcommerce_payments.container\" argument is not provided.');if(t.onClick&&\"function\"!=typeof t.onClick)throw new N('Unable to initialize payment because \"options.bigcommerce_payments.onClick\" argument is not a function.');this.onError=t.onError||lodash__WEBPACK_IMPORTED_MODULE_3__.noop,this.paymentIntegrationService.getState().getPaymentMethod(i)||(yield this.paymentIntegrationService.loadPaymentMethod(i));const n=yield this.bigCommercePaymentsIntegrationService.loadPayPalSdk(i);n&&n.Buttons&&\"function\"==typeof n.Buttons?this.renderButton(i,t):console.error(\"[BC PayPal]: PayPal Button could not be rendered, due to issues with loading PayPal SDK\")})}deinitialize(){return Promise.resolve()}signIn(e,t){return at(this,void 0,void 0,function*(){return yield this.paymentIntegrationService.signInCustomer(e,t),Promise.resolve()})}signOut(e){return at(this,void 0,void 0,function*(){return yield this.paymentIntegrationService.signOutCustomer(e),Promise.resolve()})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}renderButton(e,t){const{container:i,onClick:n,onComplete:o}=t,r=this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow(),a=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),{isHostedCheckoutEnabled:s,paymentButtonStyles:d}=a.initializationData||{},{checkoutTopButtonStyles:l}=d||{},c=Object.assign({createOrder:()=>this.bigCommercePaymentsIntegrationService.createOrder(\"bigcommerce_payments\"),onApprove:({orderID:t})=>this.bigCommercePaymentsIntegrationService.tokenizePayment(e,t)},n&&{onClick:()=>n()}),m={onShippingAddressChange:e=>this.onShippingAddressChange(e),onShippingOptionsChange:e=>this.onShippingOptionsChange(e),onApprove:(t,i)=>this.onHostedCheckoutApprove(t,i,e,o)},u=Object.assign(Object.assign({fundingSource:r.FUNDING.PAYPAL,style:this.bigCommercePaymentsIntegrationService.getValidButtonStyle(Object.assign(Object.assign({},l),{height:40}))},c),s&&m),h=r.Buttons(u);h.isEligible()?h.render(`#${i}`):this.bigCommercePaymentsIntegrationService.removeElement(i)}onHostedCheckoutApprove(e,t,i,n){return at(this,void 0,void 0,function*(){if(!e.orderID)throw new y(l.MissingOrderId);const o=this.paymentIntegrationService.getState().getCartOrThrow(),r=yield t.order.get();try{const t=this.bigCommercePaymentsIntegrationService.getBillingAddressFromOrderDetails(r);if(yield this.paymentIntegrationService.updateBillingAddress(t),o.lineItems.physicalItems.length>0){const e=this.bigCommercePaymentsIntegrationService.getShippingAddressFromOrderDetails(r);yield this.paymentIntegrationService.updateShippingAddress(e),yield this.bigCommercePaymentsIntegrationService.updateOrder()}yield this.paymentIntegrationService.submitOrder({},{params:{methodId:i}}),yield this.bigCommercePaymentsIntegrationService.submitPayment(i,e.orderID),n&&\"function\"==typeof n&&n()}catch(e){this.handleError(e)}})}onShippingAddressChange(e){return at(this,void 0,void 0,function*(){const t=this.bigCommercePaymentsIntegrationService.getAddress({city:e.shippingAddress.city,countryCode:e.shippingAddress.countryCode,postalCode:e.shippingAddress.postalCode,stateOrProvinceCode:e.shippingAddress.state});try{yield this.paymentIntegrationService.updateBillingAddress(t),yield this.paymentIntegrationService.updateShippingAddress(t);const e=this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow();yield this.paymentIntegrationService.selectShippingOption(e.id),yield this.bigCommercePaymentsIntegrationService.updateOrder()}catch(e){this.handleError(e)}})}onShippingOptionsChange(e){return at(this,void 0,void 0,function*(){const t=this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow(e.selectedShippingOption.id);try{yield this.paymentIntegrationService.selectShippingOption(t.id),yield this.bigCommercePaymentsIntegrationService.updateOrder()}catch(e){this.handleError(e)}})}handleError(e){if(\"function\"!=typeof this.onError)throw e;this.onError(e)}}const dt=m(e=>new st(e,D(e)),[{id:\"bigcommerce_payments\"}]);var lt=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ct{constructor(e,t,i){this.paymentIntegrationService=e,this.bigCommercePaymentsSdk=t,this.bigCommercePaymentsFastlaneUtils=i}initialize(e){var t;return lt(this,void 0,void 0,function*(){const{methodId:i,bigcommerce_payments_fastlane:n}=e;if(!i)throw new N('Unable to proceed because \"methodId\" argument is not provided.');try{yield this.paymentIntegrationService.loadPaymentMethod(i);const e=this.paymentIntegrationService.getState(),o=e.getCartOrThrow(),r=e.getPaymentMethodOrThrow(i),a=!!(null===(t=r.initializationData)||void 0===t?void 0:t.isDeveloperModeApplicable),s=yield this.bigCommercePaymentsSdk.getPayPalFastlaneSdk(r,o.currency.code,o.id);yield this.bigCommercePaymentsFastlaneUtils.initializePayPalFastlane(s,a,this.getFastlaneStyles(i,n))}catch(e){}return Promise.resolve()})}deinitialize(){return lt(this,void 0,void 0,function*(){return Promise.resolve()})}signIn(e,t){return lt(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return lt(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){return lt(this,void 0,void 0,function*(){const{checkoutPaymentMethodExecuted:t,continueWithCheckoutCallback:i,methodId:n}=e||{};if(!n)throw new N('Unable to proceed because \"methodId\" argument is not provided.');if(\"function\"!=typeof i)throw new N('Unable to proceed because \"continueWithCheckoutCallback\" argument is not provided and it must be a function.');if(this.paymentIntegrationService.getState().getCustomerOrThrow().isGuest){t&&\"function\"==typeof t&&t();try{yield this.runPayPalAuthenticationFlowOrThrow(n)}catch(e){}}i()})}runPayPalAuthenticationFlowOrThrow(e){return lt(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState(),i=t.getCartOrThrow().id,n=t.getCustomer(),o=t.getBillingAddress(),r=(null==n?void 0:n.email)||(null==o?void 0:o.email)||\"\",{customerContextId:a}=yield this.bigCommercePaymentsFastlaneUtils.lookupCustomerOrThrow(r),s=yield this.bigCommercePaymentsFastlaneUtils.triggerAuthenticationFlowOrThrow(a),d=s.authenticationState===Se.CANCELED;yield this.updateCustomerDataState(e,s),d?this.bigCommercePaymentsFastlaneUtils.removeStorageSessionId():this.bigCommercePaymentsFastlaneUtils.updateStorageSessionId(i)})}updateCustomerDataState(e,t){var i;return lt(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState().getCartOrThrow(),{authenticationState:o,addresses:r,billingAddress:a,shippingAddress:s,instruments:d}=this.bigCommercePaymentsFastlaneUtils.mapPayPalFastlaneProfileToBcCustomerData(e,t);if(yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:o,addresses:r,instruments:d}),a&&(yield this.paymentIntegrationService.updateBillingAddress(a)),s&&n.lineItems.physicalItems.length>0){const t=yield this.paymentIntegrationService.updateShippingAddress(s),n=t.getPaymentMethodOrThrow(e),{isFastlaneShippingOptionAutoSelectEnabled:o}=n.initializationData||{},r=t.getConsignments()||[],a=(null===(i=r[0])||void 0===i?void 0:i.availableShippingOptions)||[],d=a[0],l=a.find(e=>e.isRecommended);if((l||d)&&o){const e=(null==l?void 0:l.id)||d.id;yield this.paymentIntegrationService.selectShippingOption(e)}}})}getFastlaneStyles(e,t){const i=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),{fastlaneStyles:n,isFastlaneStylingEnabled:o}=i.initializationData||{};return ke(o?n:{},null==t?void 0:t.styles)}}const mt=m(e=>new ct(e,$(),Oe()),[{id:\"bigcommerce_payments_fastlane\"},{id:\"bigcommerce_payments_creditcards\"}]);var ut=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ht{constructor(e,t){this.paymentIntegrationService=e,this.bigCommercePaymentsIntegrationService=t,this.onError=lodash__WEBPACK_IMPORTED_MODULE_3__.noop}initialize(e){return ut(this,void 0,void 0,function*(){const{bigcommerce_payments_paylater:t,methodId:i}=e;if(!i)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_paylater\" argument is not provided.');if(!t.container)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_paylater.container\" argument is not provided.');if(t.onClick&&\"function\"!=typeof t.onClick)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_paylater.onClick\" argument is not a function.');this.onError=t.onError||lodash__WEBPACK_IMPORTED_MODULE_3__.noop,this.paymentIntegrationService.getState().getPaymentMethod(i)||(yield this.paymentIntegrationService.loadPaymentMethod(i));const n=yield this.bigCommercePaymentsIntegrationService.loadPayPalSdk(i);n&&n.Buttons&&\"function\"==typeof n.Buttons?this.renderButton(i,t):console.error(\"[BC BigCommercePayments PayLater]: button could not be rendered, due to issues with loading PayPal SDK\")})}deinitialize(){return Promise.resolve()}signIn(e,t){return ut(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return ut(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}renderButton(e,t){const{container:i,onComplete:n,onClick:o}=t,r=this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow(),a=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),{isHostedCheckoutEnabled:s,paymentButtonStyles:d}=a.initializationData||{},{checkoutTopButtonStyles:l}=d||{},c=Object.assign({createOrder:()=>this.bigCommercePaymentsIntegrationService.createOrder(\"bigcommerce_payments_paylater\"),onApprove:({orderID:t})=>this.bigCommercePaymentsIntegrationService.tokenizePayment(e,t)},o&&{onClick:()=>o()}),m={onShippingAddressChange:e=>this.onShippingAddressChange(e),onShippingOptionsChange:e=>this.onShippingOptionsChange(e),onApprove:(t,i)=>this.onHostedCheckoutApprove(t,i,e,n)},u=[r.FUNDING.PAYLATER,r.FUNDING.CREDIT];let h=!1;u.forEach(e=>{if(!h){const t=Object.assign(Object.assign({fundingSource:e,style:this.bigCommercePaymentsIntegrationService.getValidButtonStyle(Object.assign(Object.assign({},l),{height:40}))},c),s&&m),n=r.Buttons(t);n.isEligible()&&(n.render(`#${i}`),h=!0)}}),h||this.bigCommercePaymentsIntegrationService.removeElement(i)}onHostedCheckoutApprove(e,t,i,n){return ut(this,void 0,void 0,function*(){if(!e.orderID)throw new y(l.MissingOrderId);const o=this.paymentIntegrationService.getState().getCartOrThrow(),r=yield t.order.get();try{const t=this.bigCommercePaymentsIntegrationService.getBillingAddressFromOrderDetails(r);if(yield this.paymentIntegrationService.updateBillingAddress(t),o.lineItems.physicalItems.length>0){const e=this.bigCommercePaymentsIntegrationService.getShippingAddressFromOrderDetails(r);yield this.paymentIntegrationService.updateShippingAddress(e),yield this.bigCommercePaymentsIntegrationService.updateOrder()}yield this.paymentIntegrationService.submitOrder({},{params:{methodId:i}}),yield this.bigCommercePaymentsIntegrationService.submitPayment(i,e.orderID),n&&\"function\"==typeof n&&n()}catch(e){this.handleError(e)}})}onShippingAddressChange(e){return ut(this,void 0,void 0,function*(){const t=this.bigCommercePaymentsIntegrationService.getAddress({city:e.shippingAddress.city,countryCode:e.shippingAddress.countryCode,postalCode:e.shippingAddress.postalCode,stateOrProvinceCode:e.shippingAddress.state});try{yield this.paymentIntegrationService.updateBillingAddress(t),yield this.paymentIntegrationService.updateShippingAddress(t);const e=this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow();yield this.paymentIntegrationService.selectShippingOption(e.id),yield this.bigCommercePaymentsIntegrationService.updateOrder()}catch(e){this.handleError(e)}})}onShippingOptionsChange(e){return ut(this,void 0,void 0,function*(){const t=this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow(e.selectedShippingOption.id);try{yield this.paymentIntegrationService.selectShippingOption(t.id),yield this.bigCommercePaymentsIntegrationService.updateOrder()}catch(e){this.handleError(e)}})}handleError(e){if(\"function\"!=typeof this.onError)throw e;this.onError(e)}}const yt=m(e=>new ht(e,D(e)),[{id:\"bigcommerce_payments_paylater\"}]);var pt=function(e,t,i,n){return new(i||(i=Promise))(function(o,r){function a(e){try{d(n.next(e))}catch(e){r(e)}}function s(e){try{d(n.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class gt{constructor(e,t){this.paymentIntegrationService=e,this.bigCommercePaymentsIntegrationService=t}initialize(e){return pt(this,void 0,void 0,function*(){const{bigcommerce_payments_venmo:t,methodId:i}=e;if(!i)throw new N('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_venmo\" argument is not provided.');if(!t.container)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_venmo.container\" argument is not provided.');if(t.onClick&&\"function\"!=typeof t.onClick)throw new N('Unable to initialize payment because \"options.bigcommerce_payments_venmo.onClick\" argument is not a function.');this.paymentIntegrationService.getState().getPaymentMethod(i)||(yield this.paymentIntegrationService.loadPaymentMethod(i));const n=yield this.bigCommercePaymentsIntegrationService.loadPayPalSdk(i);n&&n.Buttons&&\"function\"==typeof n.Buttons?this.renderButton(i,t):console.error(\"[BC Payments Venmo]: Button could not be rendered, due to issues with loading PayPal SDK\")})}deinitialize(){return Promise.resolve()}signIn(e,t){return pt(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return pt(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}renderButton(e,t){const{container:i,onClick:n}=t,o=this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow(),r=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),{paymentButtonStyles:a}=r.initializationData||{},{checkoutTopButtonStyles:s}=a||{},d=Object.assign({fundingSource:o.FUNDING.VENMO,style:this.bigCommercePaymentsIntegrationService.getValidButtonStyle(Object.assign(Object.assign({},s),{height:40})),createOrder:()=>this.bigCommercePaymentsIntegrationService.createOrder(\"bigcommerce_payments_venmo\"),onApprove:({orderID:t})=>this.bigCommercePaymentsIntegrationService.tokenizePayment(e,t)},n&&{onClick:()=>n()}),l=o.Buttons(d);l.isEligible()?l.render(`#${i}`):this.bigCommercePaymentsIntegrationService.removeElement(i)}}const vt=m(e=>new gt(e,D(e)),[{id:\"bigcommerce_payments_venmo\"}]);\n//# sourceMappingURL=bigcommerce-payments.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vY2hlY2tvdXQtc2RrLWpzL2Rpc3QvZXNtL2ludGVncmF0aW9ucy9iaWdjb21tZXJjZS1wYXltZW50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK1IsV0FBVyxnQkFBZ0Isd0JBQXdCLGFBQWEsRUFBRSxZQUFZLCtEQUErRCx1QkFBdUIsRUFBRSxzREFBc0Qsc0JBQXNCLGVBQWUsTUFBTSx1VEFBdVQsa0JBQWtCLGVBQWUsK01BQStNLGFBQWEsc3lCQUFzeUIsU0FBUyxHQUFHLGtCQUFrQixlQUFlLGtCQUFrQixVQUFVLG9HQUFvRywrRUFBK0UsK0ZBQStGLHVGQUF1Rix1RkFBdUYsNEhBQTRILGlGQUFpRixzR0FBc0cscUZBQXFGLGdIQUFnSCw2SEFBNkgsc0dBQXNHLDZFQUE2RSwyRUFBMkUsa0JBQWtCLGVBQWUsd0xBQXdMLFNBQVMsT0FBTyxXQUFXLFdBQVcsa0JBQWtCLGVBQWUsbUJBQW1CLEdBQUcsRUFBRSxNQUFNLDBCQUEwQixNQUFNLHVKQUF1SixvQkFBb0IsYUFBYSxtQkFBbUIsU0FBUyxlQUFlLGdFQUFnRSxTQUFTLGVBQWUsNENBQTRDLFNBQVMsZUFBZSxrR0FBa0csU0FBUyxlQUFlLDhFQUE4RSxTQUFTLGVBQWUsNEJBQTRCLFNBQVMsZUFBZSxjQUFjLFNBQVMsZUFBZSxvSkFBb0osU0FBUyxHQUFHLHdCQUF3Qix5Q0FBeUMsY0FBYyxJQUFJLGFBQWEsU0FBUyxNQUFNLGNBQWMsSUFBSSxjQUFjLFNBQVMsTUFBTSxjQUFjLE1BQU0sZ0VBQWdFLEtBQUssYUFBYSwrQkFBK0IsR0FBRyxRQUFRLHFCQUFxQixrSUFBa0ksdUJBQXVCLHdDQUF3Qyx1SEFBdUgsc0dBQXNHLEVBQUUsc0JBQXNCLCtCQUErQixzQkFBc0IsMkJBQTJCLHdDQUF3QyxxQ0FBcUMsaUNBQWlDLElBQUksZ0VBQWdFLFNBQVMsYUFBYSxFQUFFLGlCQUFpQix3Q0FBd0MsdUVBQXVFLFVBQVUsMEVBQTBFLFNBQVMsS0FBSyxTQUFTLEVBQUUs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SCw2SUFBNkksd0tBQXdLLDJIQUEySCwwRUFBMEUsNEtBQTRLLEVBQUUsZUFBZSx5QkFBeUIsWUFBWSx5Q0FBeUMseURBQXlELEVBQUUsV0FBVyx5Q0FBeUMsd0RBQXdELEVBQUUsZ0NBQWdDLE1BQU0seUdBQXlHLGtCQUFrQixNQUFNLHNCQUFzQiw4SUFBOEksc0JBQXNCLHlCQUF5QixFQUFFLDBCQUEwQixNQUFNLGtCQUFrQixpSUFBaUksS0FBSyxVQUFVLG9IQUFvSCxVQUFVLG1FQUFtRSxLQUFLLGdCQUFnQixpQkFBaUIsNEJBQTRCLEVBQUUsZ0VBQWdFLCtCQUErQixnQ0FBZ0MsR0FBaTRCO0FBQzNsaEgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaGVja291dC8uLi9jaGVja291dC1zZGstanMvZGlzdC9lc20vaW50ZWdyYXRpb25zL2JpZ2NvbW1lcmNlLXBheW1lbnRzLmpzPzJhOWUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0e2NyZWF0ZUZvcm1Qb3N0ZXIgYXMgZX1mcm9tXCJAYmlnY29tbWVyY2UvZm9ybS1wb3N0ZXJcIjtpbXBvcnR7Y3JlYXRlUmVxdWVzdFNlbmRlciBhcyB0fWZyb21cIkBiaWdjb21tZXJjZS9yZXF1ZXN0LXNlbmRlclwiO2ltcG9ydHtjcmVhdGVTY3JpcHRMb2FkZXIgYXMgaSxnZXRTY3JpcHRMb2FkZXIgYXMgbn1mcm9tXCJAYmlnY29tbWVyY2Uvc2NyaXB0LWxvYWRlclwiO2ltcG9ydHtpc0VxdWFsIGFzIG8saXNOaWwgYXMgcixub29wIGFzIGEsb21pdCBhcyBzLG9taXRCeSBhcyBkfWZyb21cImxvZGFzaFwiO3ZhciBsLGM9e307ZnVuY3Rpb24gbShlLHQpe3JldHVybiBPYmplY3QuYXNzaWduKGUse3Jlc29sdmVJZHM6dH0pfWMuZD0oZSx0KT0+e2Zvcih2YXIgaSBpbiB0KWMubyh0LGkpJiYhYy5vKGUsaSkmJk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLGkse2VudW1lcmFibGU6ITAsZ2V0OnRbaV19KX0sYy5vPShlLHQpPT5PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSx0KTtjbGFzcyB1IGV4dGVuZHMgRXJyb3J7Y29uc3RydWN0b3IoZSl7dmFyIHQ7c3VwZXIoZXx8XCJBbiB1bmV4cGVjdGVkIGVycm9yIGhhcyBvY2N1cnJlZC5cIiksdGhpcy5uYW1lPVwiU3RhbmRhcmRFcnJvclwiLHRoaXMudHlwZT1cInN0YW5kYXJkXCIsdD1uZXcudGFyZ2V0LnByb3RvdHlwZSxPYmplY3Quc2V0UHJvdG90eXBlT2Y/T2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsdCk6dGhpcy5fX3Byb3RvX189dCxcImZ1bmN0aW9uXCI9PXR5cGVvZiBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZT9FcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLG5ldy50YXJnZXQpOnRoaXMuc3RhY2s9bmV3IEVycm9yKHRoaXMubWVzc2FnZSkuc3RhY2t9fWNsYXNzIGggZXh0ZW5kcyB1e2NvbnN0cnVjdG9yKGUpe3N1cGVyKGV8fFwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgY2xpZW50IGxpYnJhcnkgb2YgYSBwYXltZW50IG1ldGhvZCBpcyBub3QgbG9hZGVkIG9yIHJlYWR5IHRvIGJlIHVzZWQuXCIpLHRoaXMubmFtZT1cIlBheW1lbnRNZXRob2RDbGllbnRVbmF2YWlsYWJsZUVycm9yXCIsdGhpcy50eXBlPVwicGF5bWVudF9tZXRob2RfY2xpZW50X3VuYXZhaWxhYmxlXCJ9fSFmdW5jdGlvbihlKXtlW2UuTWlzc2luZ0JpbGxpbmdBZGRyZXNzPTBdPVwiTWlzc2luZ0JpbGxpbmdBZGRyZXNzXCIsZVtlLk1pc3NpbmdDYXJ0PTFdPVwiTWlzc2luZ0NhcnRcIixlW2UuTWlzc2luZ0NoZWNrb3V0PTJdPVwiTWlzc2luZ0NoZWNrb3V0XCIsZVtlLk1pc3NpbmdDb25zaWdubWVudHM9M109XCJNaXNzaW5nQ29uc2lnbm1lbnRzXCIsZVtlLk1pc3NpbmdDdXN0b21lcj00XT1cIk1pc3NpbmdDdXN0b21lclwiLGVbZS5NaXNzaW5nQ2hlY2tvdXRDb25maWc9NV09XCJNaXNzaW5nQ2hlY2tvdXRDb25maWdcIixlW2UuTWlzc2luZ09yZGVyPTZdPVwiTWlzc2luZ09yZGVyXCIsZVtlLk1pc3NpbmdPcmRlckNvbmZpZz03XT1cIk1pc3NpbmdPcmRlckNvbmZpZ1wiLGVbZS5NaXNzaW5nT3JkZXJJZD04XT1cIk1pc3NpbmdPcmRlcklkXCIsZVtlLk1pc3NpbmdQYXltZW50PTldPVwiTWlzc2luZ1BheW1lbnRcIixlW2UuTWlzc2luZ1BheW1lbnRJZD0xMF09XCJNaXNzaW5nUGF5bWVudElkXCIsZVtlLk1pc3NpbmdQYXltZW50SW5zdHJ1bWVudD0xMV09XCJNaXNzaW5nUGF5bWVudEluc3RydW1lbnRcIixlW2UuTWlzc2luZ1BheW1lbnRNZXRob2Q9MTJdPVwiTWlzc2luZ1BheW1lbnRNZXRob2RcIixlW2UuTWlzc2luZ1BheW1lbnRSZWRpcmVjdFVybD0xM109XCJNaXNzaW5nUGF5bWVudFJlZGlyZWN0VXJsXCIsZVtlLk1pc3NpbmdQYXltZW50U3RhdHVzPTE0XT1cIk1pc3NpbmdQYXltZW50U3RhdHVzXCIsZVtlLk1pc3NpbmdQYXltZW50VG9rZW49MTVdPVwiTWlzc2luZ1BheW1lbnRUb2tlblwiLGVbZS5NaXNzaW5nU2hpcHBpbmdBZGRyZXNzPTE2XT1cIk1pc3NpbmdTaGlwcGluZ0FkZHJlc3NcIn0obHx8KGw9e30pKTtjbGFzcyB5IGV4dGVuZHMgdXtjb25zdHJ1Y3RvcihlKXtzdXBlcihmdW5jdGlvbihlKXtzd2l0Y2goZSl7Y2FzZSBsLk1pc3NpbmdCaWxsaW5nQWRkcmVzczpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgYmlsbGluZyBhZGRyZXNzIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBsLk1pc3NpbmdDYXJ0OnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBjYXJ0IGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBsLk1pc3NpbmdDb25zaWdubWVudHM6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGNvbnNpZ25tZW50cyBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgbC5NaXNzaW5nQ2hlY2tvdXQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGNoZWNrb3V0IGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBsLk1pc3NpbmdDdXN0b21lcjpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgY3VzdG9tZXIgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIGwuTWlzc2luZ0NoZWNrb3V0Q29uZmlnOmNhc2UgbC5NaXNzaW5nT3JkZXJDb25maWc6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGNvbmZpZ3VyYXRpb24gZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIGwuTWlzc2luZ09yZGVyOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBvcmRlciBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgbC5NaXNzaW5nT3JkZXJJZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2Ugb3JkZXIgSUQgaXMgdW5hdmFpbGFibGUgb3Igbm90IGdlbmVyYXRlZCB5ZXQuXCI7Y2FzZSBsLk1pc3NpbmdQYXltZW50OnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBwYXltZW50IGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBsLk1pc3NpbmdQYXltZW50VG9rZW46cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSB0b2tlbiByZXF1aXJlZCB0byBzdWJtaXQgYSBwYXltZW50IGlzIG1pc3NpbmcuXCI7Y2FzZSBsLk1pc3NpbmdQYXltZW50TWV0aG9kOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBwYXltZW50IG1ldGhvZCBkYXRhIGlzIHVuYXZhaWxhYmxlIG9yIG5vdCBwcm9wZXJseSBjb25maWd1cmVkLlwiO2Nhc2UgbC5NaXNzaW5nU2hpcHBpbmdBZGRyZXNzOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBzaGlwcGluZyBhZGRyZXNzIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7ZGVmYXVsdDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHJlcXVpcmVkIGRhdGEgaXMgdW5hdmFpbGFibGUuXCJ9fShlKSksdGhpcy5zdWJ0eXBlPWUsdGhpcy5uYW1lPVwiTWlzc2luZ0RhdGFFcnJvclwiLHRoaXMudHlwZT1cIm1pc3NpbmdfZGF0YVwifX1jbGFzcyBwIGV4dGVuZHMgdXtjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIkFuIHVuZXhwZWN0ZWQgZXJyb3IgaGFzIG9jY3VycmVkIGR1cmluZyBidXkgbm93IGNhcnQgY3JlYXRpb24gcHJvY2Vzcy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiksdGhpcy5uYW1lPVwiQnV5Tm93Q2FydENyZWF0aW9uRXJyb3JcIix0aGlzLnR5cGU9XCJidXlfbm93X2NhcnRfY3JlYXRpb25fZXJyb3JcIn19Y29uc3QgZz17Ym9keTp7fSxoZWFkZXJzOnt9LHN0YXR1czowfTtjbGFzcyB2IGV4dGVuZHMgdXtjb25zdHJ1Y3RvcihlLHttZXNzYWdlOnQsZXJyb3JzOml9PXt9KXtjb25zdHtib2R5Om4saGVhZGVyczpvLHN0YXR1czpyfT1lfHxnO3N1cGVyKHR8fFwiQW4gdW5leHBlY3RlZCBlcnJvciBoYXMgb2NjdXJyZWQuXCIpLHRoaXMubmFtZT1cIlJlcXVlc3RFcnJvclwiLHRoaXMudHlwZT1cInJlcXVlc3RcIix0aGlzLmJvZHk9bix0aGlzLmhlYWRlcnM9byx0aGlzLnN0YXR1cz1yLHRoaXMuZXJyb3JzPWl8fFtdfX12YXIgZixiLFAsUyxJLEMsdyxPOyFmdW5jdGlvbihlKXtlLkJ1eU5vdz1cIkJVWV9OT1dcIn0oZnx8KGY9e30pKSxmdW5jdGlvbihlKXtlLlBvc3NpYmxlPVwiUE9TU0lCTEVcIixlLk5vPVwiTk9cIixlLlVua25vd249XCJVTktOT1dOXCIsZS5ZZXM9XCJZRVNcIn0oYnx8KGI9e30pKSxmdW5jdGlvbihlKXtlLkFVVEhPUklaRT1cImF1dGhvcml6ZVwiLGUuQ0FQVFVSRT1cImNhcHR1cmVcIn0oUHx8KFA9e30pKSxmdW5jdGlvbihlKXtlLnBheXBhbD1cInBheXBhbFwiLGUuY2hlY2tvdXQ9XCJjaGVja291dFwiLGUuYnV5bm93PVwiYnV5bm93XCIsZS5wYXk9XCJwYXlcIixlLmluc3RhbGxtZW50PVwiaW5zdGFsbG1lbnRcIn0oU3x8KFM9e30pKSxmdW5jdGlvbihlKXtlLmdvbGQ9XCJnb2xkXCIsZS5ibHVlPVwiYmx1ZVwiLGUuc2lsdmVyPVwic2lsdmVyXCIsZS5ibGFjaz1cImJsYWNrXCIsZS53aGl0ZT1cIndoaXRlXCJ9KEl8fChJPXt9KSksZnVuY3Rpb24oZSl7ZS5waWxsPVwicGlsbFwiLGUucmVjdD1cInJlY3RcIn0oQ3x8KEM9e30pKSxmdW5jdGlvbihlKXtlLk9YWE89XCJveHhvXCJ9KHd8fCh3PXt9KSksZnVuY3Rpb24oZSl7ZS5BcHByb3ZlZD1cIkFQUFJPVkVEXCIsZS5DcmVhdGVkPVwiQ1JFQVRFRFwiLGUuUGF5ZXJBY3Rpb25SZXF1aXJlZD1cIlBBWUVSX0FDVElPTl9SRVFVSVJFRFwiLGUuUG9sbGluZ1N0b3A9XCJQT0xMSU5HX1NUT1BcIixlLlBvbGxpbmdFcnJvcj1cIlBPTExJTkdfRVJST1JcIn0oT3x8KE89e30pKTt2YXIgXz1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihvLHIpe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtyKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe3IoZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP28oZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBre2NvbnN0cnVjdG9yKGUsdCxpLG4pe3RoaXMuZm9ybVBvc3Rlcj1lLHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT10LHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c1JlcXVlc3RTZW5kZXI9aSx0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNTY3JpcHRMb2FkZXI9bn1sb2FkUGF5UGFsU2RrKGUsdCxpLG4pe3JldHVybiBfKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBvPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHI9dHx8by5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGUsYT1vLmdldFBheW1lbnRNZXRob2RPclRocm93KGUpO3JldHVybiB0aGlzLnBheXBhbFNkaz15aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNTY3JpcHRMb2FkZXIuZ2V0UGF5UGFsU0RLKGEscixpLG4pLHRoaXMucGF5cGFsU2RrfSl9Z2V0UGF5UGFsU2RrT3JUaHJvdygpe2lmKCF0aGlzLnBheXBhbFNkayl0aHJvdyBuZXcgaDtyZXR1cm4gdGhpcy5wYXlwYWxTZGt9Y3JlYXRlQnV5Tm93Q2FydE9yVGhyb3coZSl7cmV0dXJuIF8odGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9ZS5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkoKTtpZighdCl0aHJvdyBuZXcgeShsLk1pc3NpbmdDYXJ0KTt0cnl7cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5jcmVhdGVCdXlOb3dDYXJ0KHQpfWNhdGNoKGUpe3Rocm93IG5ldyBwfX0pfWNyZWF0ZU9yZGVyKGUsdCl7cmV0dXJuIF8odGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKS5pZCx7b3JkZXJJZDpufT15aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNSZXF1ZXN0U2VuZGVyLmNyZWF0ZU9yZGVyKGUsT2JqZWN0LmFzc2lnbih7Y2FydElkOml9LHQpKTtyZXR1cm4gbn0pfWNyZWF0ZU9yZGVyQ2FyZEZpZWxkcyhlLHQpe3JldHVybiBfKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnRPclRocm93KCkuaWQse29yZGVySWQ6bixzZXR1cFRva2VuOm99PXlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c1JlcXVlc3RTZW5kZXIuY3JlYXRlT3JkZXIoZSxPYmplY3QuYXNzaWduKHtjYXJ0SWQ6aX0sdCkpO3JldHVybiBPYmplY3QuYXNzaWduKHtvcmRlcklkOm59LG8/e3NldHVwVG9rZW46b306e30pfSl9dXBkYXRlT3JkZXIoKXtyZXR1cm4gXyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgZT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSx0PWUuZ2V0Q2FydE9yVGhyb3coKSxpPWUuZ2V0Q29uc2lnbm1lbnRzT3JUaHJvdygpWzBdO3RyeXt5aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNSZXF1ZXN0U2VuZGVyLnVwZGF0ZU9yZGVyKHthdmFpbGFibGVTaGlwcGluZ09wdGlvbnM6aS5hdmFpbGFibGVTaGlwcGluZ09wdGlvbnMsY2FydElkOnQuaWQsc2VsZWN0ZWRTaGlwcGluZ09wdGlvbjppLnNlbGVjdGVkU2hpcHBpbmdPcHRpb259KX1jYXRjaChlKXt0aHJvdyBuZXcgdn19KX1nZXRPcmRlclN0YXR1cyhlLHQpe3JldHVybiBfKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7Y29uc3R7c3RhdHVzOml9PXlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c1JlcXVlc3RTZW5kZXIuZ2V0T3JkZXJTdGF0dXMoZSx0KTtyZXR1cm4gaX1jYXRjaChlKXt0aHJvdyBuZXcgdn19KX10b2tlbml6ZVBheW1lbnQoZSx0KXtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnRPclRocm93KCk7aWYoIXQpdGhyb3cgbmV3IHkobC5NaXNzaW5nT3JkZXJJZCk7cmV0dXJuIHRoaXMuZm9ybVBvc3Rlci5wb3N0Rm9ybShcIi9jaGVja291dC5waHBcIixPYmplY3QuYXNzaWduKHtwYXltZW50X3R5cGU6XCJwYXlwYWxcIixhY3Rpb246XCJzZXRfZXh0ZXJuYWxfY2hlY2tvdXRcIixwcm92aWRlcjplLG9yZGVyX2lkOnR9LGkuc291cmNlPT09Zi5CdXlOb3cmJntjYXJ0X2lkOmkuaWR9KSl9c3VibWl0UGF5bWVudChlLHQsaSl7cmV0dXJuIF8odGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IG49e2Zvcm1hdHRlZFBheWxvYWQ6e3ZhdWx0X3BheW1lbnRfaW5zdHJ1bWVudDpudWxsLHNldF9hc19kZWZhdWx0X3N0b3JlZF9pbnN0cnVtZW50Om51bGwsZGV2aWNlX2luZm86bnVsbCxtZXRob2RfaWQ6ZSxwYXlwYWxfYWNjb3VudDp7b3JkZXJfaWQ6dH19fTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChPYmplY3QuYXNzaWduKHttZXRob2RJZDplLHBheW1lbnREYXRhOm59LGk/e2dhdGV3YXlJZDppfTp7fSkpfSl9Z2V0U2hpcHBpbmdPcHRpb25PclRocm93KGUpe2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q29uc2lnbm1lbnRzT3JUaHJvdygpWzBdLGk9dC5hdmFpbGFibGVTaGlwcGluZ09wdGlvbnN8fFtdLG49aS5maW5kKGU9PmUuaXNSZWNvbW1lbmRlZCksbz0oZT9pLmZpbmQodD0+dC5pZD09PWUpOmkuZmluZChlPT57dmFyIGk7cmV0dXJuIGUuaWQ9PT0obnVsbD09PShpPXQuc2VsZWN0ZWRTaGlwcGluZ09wdGlvbil8fHZvaWQgMD09PWk/dm9pZCAwOmkuaWQpfSkpfHxufHxpWzBdO2lmKCFvKXRocm93IG5ldyBFcnJvcihcIllvdXIgb3JkZXIgY2FuJ3QgYmUgc2hpcHBlZCB0byB0aGlzIGFkZHJlc3NcIik7cmV0dXJuIG99Z2V0QWRkcmVzcyhlKXtyZXR1cm57Zmlyc3ROYW1lOihudWxsPT1lP3ZvaWQgMDplLmZpcnN0TmFtZSl8fFwiXCIsbGFzdE5hbWU6KG51bGw9PWU/dm9pZCAwOmUubGFzdE5hbWUpfHxcIlwiLGVtYWlsOihudWxsPT1lP3ZvaWQgMDplLmVtYWlsKXx8XCJcIixwaG9uZToobnVsbD09ZT92b2lkIDA6ZS5waG9uZSl8fFwiXCIsY29tcGFueTpcIlwiLGFkZHJlc3MxOihudWxsPT1lP3ZvaWQgMDplLmFkZHJlc3MxKXx8XCJcIixhZGRyZXNzMjoobnVsbD09ZT92b2lkIDA6ZS5hZGRyZXNzMil8fFwiXCIsY2l0eToobnVsbD09ZT92b2lkIDA6ZS5jaXR5KXx8XCJcIixjb3VudHJ5Q29kZToobnVsbD09ZT92b2lkIDA6ZS5jb3VudHJ5Q29kZSl8fFwiXCIscG9zdGFsQ29kZToobnVsbD09ZT92b2lkIDA6ZS5wb3N0YWxDb2RlKXx8XCJcIixzdGF0ZU9yUHJvdmluY2U6XCJcIixzdGF0ZU9yUHJvdmluY2VDb2RlOihudWxsPT1lP3ZvaWQgMDplLnN0YXRlT3JQcm92aW5jZUNvZGUpfHxcIlwiLGN1c3RvbUZpZWxkczpbXX19Z2V0QmlsbGluZ0FkZHJlc3NGcm9tT3JkZXJEZXRhaWxzKHtwYXllcjplfSl7dmFyIHQsaTtyZXR1cm4gdGhpcy5nZXRBZGRyZXNzKHtmaXJzdE5hbWU6ZS5uYW1lLmdpdmVuX25hbWUsbGFzdE5hbWU6ZS5uYW1lLnN1cm5hbWUsZW1haWw6ZS5lbWFpbF9hZGRyZXNzLGFkZHJlc3MxOmUuYWRkcmVzcy5hZGRyZXNzX2xpbmVfMSxhZGRyZXNzMjplLmFkZHJlc3MuYWRkcmVzc19saW5lXzIsY2l0eTplLmFkZHJlc3MuYWRtaW5fYXJlYV8yLGNvdW50cnlDb2RlOmUuYWRkcmVzcy5jb3VudHJ5X2NvZGUscG9zdGFsQ29kZTplLmFkZHJlc3MucG9zdGFsX2NvZGUsc3RhdGVPclByb3ZpbmNlQ29kZTplLmFkZHJlc3MuYWRtaW5fYXJlYV8xLHBob25lOm51bGw9PT0oaT1udWxsPT09KHQ9ZS5waG9uZSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQucGhvbmVfbnVtYmVyKXx8dm9pZCAwPT09aT92b2lkIDA6aS5uYXRpb25hbF9udW1iZXJ9KX1nZXRTaGlwcGluZ0FkZHJlc3NGcm9tT3JkZXJEZXRhaWxzKGUpe2NvbnN0e3BheWVyOnQscHVyY2hhc2VfdW5pdHM6aX09ZSx7YWRkcmVzczpuLG5hbWU6e2Z1bGxfbmFtZTpvfX09aVswXS5zaGlwcGluZyxbciwuLi5hXT1vLnNwbGl0KFwiIFwiKTtyZXR1cm4gdGhpcy5nZXRBZGRyZXNzKHtmaXJzdE5hbWU6cixsYXN0TmFtZTphLmpvaW4oXCIgXCIpLGVtYWlsOnQuZW1haWxfYWRkcmVzcyxhZGRyZXNzMTpuLmFkZHJlc3NfbGluZV8xLGFkZHJlc3MyOm4uYWRkcmVzc19saW5lXzIsY2l0eTpuLmFkbWluX2FyZWFfMixjb3VudHJ5Q29kZTpuLmNvdW50cnlfY29kZSxwb3N0YWxDb2RlOm4ucG9zdGFsX2NvZGUsc3RhdGVPclByb3ZpbmNlQ29kZTpuLmFkbWluX2FyZWFfMX0pfWdldFZhbGlkQnV0dG9uU3R5bGUoZSl7Y29uc3R7Y29sb3I6dCxoZWlnaHQ6aSxsYWJlbDpuLHNoYXBlOm99PWV8fHt9LGE9e2NvbG9yOnQmJklbdF0/dDp2b2lkIDAsaGVpZ2h0OnRoaXMuZ2V0VmFsaWRIZWlnaHQoaSksbGFiZWw6biYmU1tuXT9uOnZvaWQgMCxzaGFwZTpvJiZDW29dP286dm9pZCAwfTtyZXR1cm4gZChhLHIpfWdldFZhbGlkSGVpZ2h0KGUpe3JldHVybiBlJiZcIm51bWJlclwiPT10eXBlb2YgZT9lPjU1PzU1OmU8MjU/MjU6ZTo0MH1yZW1vdmVFbGVtZW50KGUpe2NvbnN0IHQ9ZSYmZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSk7dCYmKHQuc3R5bGUuZGlzcGxheT1cIm5vbmVcIil9fWNvbnN0IEE9XCJUaGlzIEFQSSBlbmRwb2ludCBpcyBmb3IgaW50ZXJuYWwgdXNlIG9ubHkgYW5kIG1heSBjaGFuZ2UgaW4gdGhlIGZ1dHVyZVwiO3ZhciBFOyFmdW5jdGlvbihlKXtlLkpzb249XCJhcHBsaWNhdGlvbi9qc29uXCIsZS5Kc29uVjE9XCJhcHBsaWNhdGlvbi92bmQuYmMudjEranNvblwifShFfHwoRT17fSkpO2NvbnN0IFQ9RSx6PXtcIlgtQ2hlY2tvdXQtU0RLLVZlcnNpb25cIjpcIjEuODY3LjBcIn07dmFyIEY9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24obyxyKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7cihlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtyKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9vKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgQntjb25zdHJ1Y3RvcihlKXt0aGlzLnJlcXVlc3RTZW5kZXI9ZX1jcmVhdGVPcmRlcihlLHQpe3JldHVybiBGKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPWAvYXBpL3N0b3JlZnJvbnQvcGF5bWVudC8ke2V9YCxuPXQsbz1PYmplY3QuYXNzaWduKHtcIlgtQVBJLUlOVEVSTkFMXCI6QSxcIkNvbnRlbnQtVHlwZVwiOlQuSnNvbn0seik7cmV0dXJuKHlpZWxkIHRoaXMucmVxdWVzdFNlbmRlci5wb3N0KGkse2hlYWRlcnM6byxib2R5Om59KSkuYm9keX0pfXVwZGF0ZU9yZGVyKGUpe3JldHVybiBGKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PWUsaT1PYmplY3QuYXNzaWduKHtcIlgtQVBJLUlOVEVSTkFMXCI6QSxcIkNvbnRlbnQtVHlwZVwiOlQuSnNvbn0seik7cmV0dXJuKHlpZWxkIHRoaXMucmVxdWVzdFNlbmRlci5wdXQoXCIvYXBpL3N0b3JlZnJvbnQvaW5pdGlhbGl6YXRpb24vYmlnY29tbWVyY2VfcGF5bWVudHNcIix7aGVhZGVyczppLGJvZHk6dH0pKS5ib2R5fSl9Z2V0T3JkZXJTdGF0dXMoZT1cImJpZ2NvbW1lcmNlX3BheW1lbnRzXCIsdCl7cmV0dXJuIEYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9YC9hcGkvc3RvcmVmcm9udC9pbml0aWFsaXphdGlvbi8ke2V9YCxuPU9iamVjdC5hc3NpZ24oe1wiWC1BUEktSU5URVJOQUxcIjpBLFwiQ29udGVudC1UeXBlXCI6VC5Kc29ufSx6KTtyZXR1cm4oeWllbGQgdGhpcy5yZXF1ZXN0U2VuZGVyLmdldChpLE9iamVjdC5hc3NpZ24oe2hlYWRlcnM6bn0sdCkpKS5ib2R5fSl9fXZhciBNPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8scil7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe3IoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7cihlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIHh7Y29uc3RydWN0b3IoZSl7dGhpcy5zY3JpcHRMb2FkZXI9ZSx0aGlzLndpbmRvdz13aW5kb3d9Z2V0UGF5UGFsU0RLKGUsdCxpLG4pe3JldHVybiBNKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBvPXRoaXMuZ2V0UGF5UGFsU2RrU2NyaXB0Q29uZmlnT3JUaHJvdyhlLHQsaSk7cmV0dXJuIHRoaXMubG9hZFBheVBhbFNESyhvLG4pfSl9bG9hZFBheVBhbFNESyhlLHQ9ITEpe3JldHVybiBNKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy53aW5kb3cucGF5cGFsfHx0KXtjb25zdCB0PXRoaXMudHJhbnNmb3JtQ29uZmlnKGUub3B0aW9ucyksaT10aGlzLnRyYW5zZm9ybUNvbmZpZyhlLmF0dHJpYnV0ZXMpLG49YGh0dHBzOi8vd3d3LnBheXBhbC5jb20vc2RrL2pzPyR7bmV3IFVSTFNlYXJjaFBhcmFtcyh0KS50b1N0cmluZygpfWA7eWllbGQgdGhpcy5zY3JpcHRMb2FkZXIubG9hZFNjcmlwdChuLHthc3luYzohMCxhdHRyaWJ1dGVzOml9KX1pZighdGhpcy53aW5kb3cucGF5cGFsKXRocm93IG5ldyBoO3JldHVybiB0aGlzLndpbmRvdy5wYXlwYWx9KX1nZXRQYXlQYWxTZGtTY3JpcHRDb25maWdPclRocm93KGUsdCxpPSEwKXtjb25zdHtpZDpuLGNsaWVudFRva2VuOm8saW5pdGlhbGl6YXRpb25EYXRhOnJ9PWU7aWYoIShudWxsPT1yP3ZvaWQgMDpyLmNsaWVudElkKSl0aHJvdyBuZXcgeShsLk1pc3NpbmdQYXltZW50TWV0aG9kKTtjb25zdHtpbnRlbnQ6YSxjbGllbnRJZDpzLG1lcmNoYW50SWQ6ZCxidXllckNvdW50cnk6YyxhdHRyaWJ1dGlvbklkOm0saXNWZW5tb0VuYWJsZWQ6dSxpc0hvc3RlZENoZWNrb3V0RW5hYmxlZDpoLGlzUGF5UGFsQ3JlZGl0QXZhaWxhYmxlOnAsaXNEZXZlbG9wZXJNb2RlQXBwbGljYWJsZTpnLGF2YWlsYWJsZUFsdGVybmF0aXZlUGF5bWVudE1ldGhvZHM6dj1bXSxlbmFibGVkQWx0ZXJuYXRpdmVQYXltZW50TWV0aG9kczpmPVtdLGlzR29vZ2xlUGF5RW5hYmxlZDpifT1yLFA9aHx8aSxTPVwiYmlnY29tbWVyY2VfcGF5bWVudHNfY3JlZGl0Y2FyZHNcIj09PW4sST1TP1tcImNhcmRcIl06W10sQz1TP1tdOltcImNhcmRcIl0sdz1wP1tcImNyZWRpdFwiLFwicGF5bGF0ZXJcIl06W10sTz1wP1tdOltcImNyZWRpdFwiLFwicGF5bGF0ZXJcIl0sXz11P1tcInZlbm1vXCJdOltdLGs9dT9bXTpbXCJ2ZW5tb1wiXSxBPXYuZmlsdGVyKGU9PiFmLmluY2x1ZGVzKGUpKSxFPWI/W1wiZ29vZ2xlcGF5XCJdOltdLFQ9aT9bXCJjYXJkLWZpZWxkc1wiXTpbXSx6PXRoaXMuZmlsdGVyRnVuZGluZ09wdGlvbnMoWy4uLkMsLi4uTywuLi5rLC4uLkFdKSxGPXRoaXMuZmlsdGVyRnVuZGluZ09wdGlvbnMoWy4uLkksLi4udywuLi5fLC4uLmZdKTtyZXR1cm57b3B0aW9uczpPYmplY3QuYXNzaWduKHtcImNsaWVudC1pZFwiOnMsXCJtZXJjaGFudC1pZFwiOmQsXCJlbmFibGUtZnVuZGluZ1wiOkYubGVuZ3RoPjA/Rjp2b2lkIDAsXCJkaXNhYmxlLWZ1bmRpbmdcIjp6Lmxlbmd0aD4wP3o6dm9pZCAwLGNvbW1pdDpQLGNvbXBvbmVudHM6W1wiYnV0dG9uc1wiLFwiaG9zdGVkLWZpZWxkc1wiLFwicGF5bWVudC1maWVsZHNcIixcImxlZ2FsXCIsLi4uRSwuLi5UXSxjdXJyZW5jeTp0LGludGVudDphfSxnJiZ7XCJidXllci1jb3VudHJ5XCI6Y30pLGF0dHJpYnV0ZXM6e1wiZGF0YS1wYXJ0bmVyLWF0dHJpYnV0aW9uLWlkXCI6bSxcImRhdGEtY2xpZW50LXRva2VuXCI6b319fWZpbHRlckZ1bmRpbmdPcHRpb25zKGUpe2NvbnN0IHQ9W1wia2xhcm5hXCIsXCJhZnRlcnBheVwiXTtyZXR1cm4gZT9lLmZpbHRlcihlPT4hdC5pbmNsdWRlcyhlKSk6W119dHJhbnNmb3JtQ29uZmlnKGUpe2xldCB0PXt9O3JldHVybiBPYmplY3Qua2V5cyhlKS5mb3JFYWNoKGk9Pntjb25zdCBuPWVbaV07bnVsbD09bnx8XCJcIj09PW58fEFycmF5LmlzQXJyYXkobikmJjA9PT1uLmxlbmd0aHx8KHQ9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHQpLHtbaV06QXJyYXkuaXNBcnJheShuKT9uLmpvaW4oXCIsXCIpOm59KSl9KSx0fX1jb25zdCBEPWk9Pntjb25zdHtnZXRIb3N0Om99PWkuZ2V0U3RhdGUoKTtyZXR1cm4gbmV3IGsoZSgpLGksbmV3IEIodCh7aG9zdDpvKCl9KSksbmV3IHgobigpKSl9O2NsYXNzIE4gZXh0ZW5kcyB1e2NvbnN0cnVjdG9yKGUpe3N1cGVyKGV8fFwiSW52YWxpZCBhcmd1bWVudHMgaGF2ZSBiZWVuIHByb3ZpZGVkLlwiKSx0aGlzLm5hbWU9XCJJbnZhbGlkQXJndW1lbnRFcnJvclwiLHRoaXMudHlwZT1cImludmFsaWRfYXJndW1lbnRcIn19dmFyIFU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24obyxyKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7cihlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtyKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9vKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3Mgantjb25zdHJ1Y3RvcihlLHQpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZT10fWluaXRpYWxpemUoZSl7dmFyIHQ7cmV0dXJuIFUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2JpZ2NvbW1lcmNlX3BheW1lbnRzOmksY29udGFpbmVySWQ6bixtZXRob2RJZDpvfT1lLHI9Qm9vbGVhbihudWxsPT1pP3ZvaWQgMDppLmJ1eU5vd0luaXRpYWxpemVPcHRpb25zKTtpZighbyl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighbil0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5jb250YWluZXJJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighaSl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c1wiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZihyJiYhaS5jdXJyZW5jeUNvZGUpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYmlnY29tbWVyY2VfcGF5bWVudHMuY3VycmVuY3lDb2RlXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKHImJlwiZnVuY3Rpb25cIiE9dHlwZW9mKG51bGw9PT0odD1pLmJ1eU5vd0luaXRpYWxpemVPcHRpb25zKXx8dm9pZCAwPT09dD92b2lkIDA6dC5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkpKXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJpZ2NvbW1lcmNlX3BheW1lbnRzLmJ1eU5vd0luaXRpYWxpemVPcHRpb25zLmdldEJ1eU5vd0NhcnRSZXF1ZXN0Qm9keVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZCBvciBpdCBpcyBub3QgYSBmdW5jdGlvbi4nKTtyfHwoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWREZWZhdWx0Q2hlY2tvdXQoKSk7Y29uc3QgYT1yP2kuY3VycmVuY3lDb2RlOnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZTt5aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheVBhbFNkayhvLGEsITEpLHRoaXMucmVuZGVyQnV0dG9uKG4sbyxpLHIpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfXJlbmRlckJ1dHRvbihlLHQsaSxuKXt2YXIgbyxyO2NvbnN0e2J1eU5vd0luaXRpYWxpemVPcHRpb25zOmEsc3R5bGU6cyxvbkNvbXBsZXRlOmQsb25FbGlnaWJpbGl0eUZhaWx1cmU6bH09aSxjPXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRQYXlQYWxTZGtPclRocm93KCksbT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyh0KSx7aXNIb3N0ZWRDaGVja291dEVuYWJsZWQ6dSxpc0FwcFN3aXRjaEVuYWJsZWQ6aH09bS5pbml0aWFsaXphdGlvbkRhdGF8fHt9LHk9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCFuJiZ0aGlzLmlzUGF5cGFsQ29tbWVyY2VBcHBTd2l0Y2hFbmFibGVkKHQpJiZ7YXBwU3dpdGNoV2hlbkF2YWlsYWJsZTohMH0pLHtjcmVhdGVPcmRlcjooKT0+dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZU9yZGVyKFwiYmlnY29tbWVyY2VfcGF5bWVudHNcIiksb25BcHByb3ZlOih7b3JkZXJJRDplfSk9PnRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS50b2tlbml6ZVBheW1lbnQodCxlKX0pLHA9e29uQ2xpY2s6KCk9PnRoaXMuaGFuZGxlQ2xpY2soYSksb25DYW5jZWw6KCk9PnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCl9LGc9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCFoJiZ7b25TaGlwcGluZ0FkZHJlc3NDaGFuZ2U6ZT0+dGhpcy5vblNoaXBwaW5nQWRkcmVzc0NoYW5nZShlKSxvblNoaXBwaW5nT3B0aW9uc0NoYW5nZTplPT50aGlzLm9uU2hpcHBpbmdPcHRpb25zQ2hhbmdlKGUpfSkse29uQXBwcm92ZTooZSxpKT0+dGhpcy5vbkhvc3RlZENoZWNrb3V0QXBwcm92ZShlLGksdCxkKX0pLHY9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe2Z1bmRpbmdTb3VyY2U6Yy5GVU5ESU5HLlBBWVBBTCxzdHlsZTp0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0VmFsaWRCdXR0b25TdHlsZShzKX0seSksYSYmcCksdSYmZyksZj1jLkJ1dHRvbnModik7Zi5pc0VsaWdpYmxlKCk/KG51bGw9PT0obz1mLmhhc1JldHVybmVkKXx8dm9pZCAwPT09bz92b2lkIDA6by5jYWxsKGYpKSYmdGhpcy5pc1BheXBhbENvbW1lcmNlQXBwU3dpdGNoRW5hYmxlZCh0KT9udWxsPT09KHI9Zi5yZXN1bWUpfHx2b2lkIDA9PT1yfHxyLmNhbGwoZik6Zi5yZW5kZXIoYCMke2V9YCk6bCYmXCJmdW5jdGlvblwiPT10eXBlb2YgbD9sKCk6dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQoZSl9aGFuZGxlQ2xpY2soZSl7cmV0dXJuIFUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKGUpe2NvbnN0IHQ9eWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZUJ1eU5vd0NhcnRPclRocm93KGUpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkQ2hlY2tvdXQodC5pZCl9fSl9b25Ib3N0ZWRDaGVja291dEFwcHJvdmUoZSx0LGksbil7cmV0dXJuIFUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCFlLm9yZGVySUQpdGhyb3cgbmV3IHkobC5NaXNzaW5nT3JkZXJJZCk7Y29uc3Qgbz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDYXJ0T3JUaHJvdygpLHI9eWllbGQgdC5vcmRlci5nZXQoKTt0cnl7Y29uc3QgdD10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0QmlsbGluZ0FkZHJlc3NGcm9tT3JkZXJEZXRhaWxzKHIpO2lmKHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVCaWxsaW5nQWRkcmVzcyh0KSxvLmxpbmVJdGVtcy5waHlzaWNhbEl0ZW1zLmxlbmd0aD4wKXtjb25zdCBlPXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRTaGlwcGluZ0FkZHJlc3NGcm9tT3JkZXJEZXRhaWxzKHIpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVTaGlwcGluZ0FkZHJlc3MoZSkseWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZU9yZGVyKCl9cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcih7fSx7cGFyYW1zOnttZXRob2RJZDppfX0pLHlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGksZS5vcmRlcklEKSxuJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuJiZuKCksITB9Y2F0Y2goZSl7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGUpdGhyb3cgbmV3IEVycm9yKGUpO3Rocm93IGV9fSl9b25TaGlwcGluZ0FkZHJlc3NDaGFuZ2UoZSl7cmV0dXJuIFUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmdldEFkZHJlc3Moe2NpdHk6ZS5zaGlwcGluZ0FkZHJlc3MuY2l0eSxjb3VudHJ5Q29kZTplLnNoaXBwaW5nQWRkcmVzcy5jb3VudHJ5Q29kZSxwb3N0YWxDb2RlOmUuc2hpcHBpbmdBZGRyZXNzLnBvc3RhbENvZGUsc3RhdGVPclByb3ZpbmNlQ29kZTplLnNoaXBwaW5nQWRkcmVzcy5zdGF0ZX0pO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3ModCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVNoaXBwaW5nQWRkcmVzcyh0KTtjb25zdCBlPXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRTaGlwcGluZ09wdGlvbk9yVGhyb3coKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2VsZWN0U2hpcHBpbmdPcHRpb24oZS5pZCkseWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZU9yZGVyKCl9Y2F0Y2goZSl7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGUpdGhyb3cgbmV3IEVycm9yKGUpO3Rocm93IGV9fSl9b25TaGlwcGluZ09wdGlvbnNDaGFuZ2UoZSl7cmV0dXJuIFUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmdldFNoaXBwaW5nT3B0aW9uT3JUaHJvdyhlLnNlbGVjdGVkU2hpcHBpbmdPcHRpb24uaWQpO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2VsZWN0U2hpcHBpbmdPcHRpb24odC5pZCkseWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZU9yZGVyKCl9Y2F0Y2goZSl7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGUpdGhyb3cgbmV3IEVycm9yKGUpO3Rocm93IGV9fSl9aXNQYXlwYWxDb21tZXJjZUFwcFN3aXRjaEVuYWJsZWQoZSl7dmFyIHQsaTtyZXR1cm4gbnVsbCE9PShpPW51bGw9PT0odD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKS5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmlzQXBwU3dpdGNoRW5hYmxlZCkmJnZvaWQgMCE9PWkmJml9fWNvbnN0IFY9bShlPT5uZXcgaihlLEQoZSkpLFt7aWQ6XCJiaWdjb21tZXJjZV9wYXltZW50c1wifV0pO3ZhciBSPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8scil7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe3IoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7cihlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIEx7Y29uc3RydWN0b3IoZSl7dGhpcy5zY3JpcHRMb2FkZXI9ZSx0aGlzLndpbmRvdz13aW5kb3d9Z2V0UGF5UGFsRmFzdGxhbmVTZGsoZSx0LGkpe3JldHVybiBSKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy53aW5kb3cucGF5cGFsRmFzdGxhbmVTZGspe2NvbnN0IG49dGhpcy5nZXRQYXlQYWxGYXN0bGFuZVNka0NvbmZpZ3VyYXRpb24oZSx0LGkpO2lmKHlpZWxkIHRoaXMubG9hZFBheVBhbFNkayhuKSwhdGhpcy53aW5kb3cucGF5cGFsRmFzdGxhbmVTZGspdGhyb3cgbmV3IGh9cmV0dXJuIHRoaXMud2luZG93LnBheXBhbEZhc3RsYW5lU2RrfSl9Z2V0UGF5UGFsR29vZ2xlUGF5U2RrKGUsdCxpLG4pe3JldHVybiBSKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy53aW5kb3cucGF5cGFsR29vZ2xlUGF5fHxuKXtjb25zdCBuPXRoaXMuZ2V0UGF5UGFsR29vZ2xlUGF5U2RrU2NyaXB0Q29uZmlnT3JUaHJvdyhlLHQsaSk7eWllbGQgdGhpcy5sb2FkUGF5UGFsU2RrKG4pfWlmKCF0aGlzLndpbmRvdy5wYXlwYWxHb29nbGVQYXkpdGhyb3cgbmV3IGg7cmV0dXJuIHRoaXMud2luZG93LnBheXBhbEdvb2dsZVBheX0pfWdldFBheVBhbEFwbXNTZGsoZSx0KXtyZXR1cm4gUih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMud2luZG93LnBheXBhbEFwbXMpe2NvbnN0IGk9dGhpcy5nZXRQYXlQYWxBcG1TZGtDb25maWd1cmF0aW9uKGUsdCk7aWYoeWllbGQgdGhpcy5sb2FkUGF5UGFsU2RrKGkpLCF0aGlzLndpbmRvdy5wYXlwYWxBcG1zKXRocm93IG5ldyBofXJldHVybiB0aGlzLndpbmRvdy5wYXlwYWxBcG1zfSl9Z2V0UGF5UGFsTWVzc2FnZXMoZSx0KXtyZXR1cm4gUih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMud2luZG93LnBheXBhbE1lc3NhZ2VzKXtjb25zdCBpPXRoaXMuZ2V0UGF5UGFsU2RrTWVzc2FnZXNDb25maWd1cmF0aW9uKGUsdCk7eWllbGQgdGhpcy5sb2FkUGF5UGFsU2RrKGkpfWlmKCF0aGlzLndpbmRvdy5wYXlwYWxNZXNzYWdlcyl0aHJvdyBuZXcgaDtyZXR1cm4gdGhpcy53aW5kb3cucGF5cGFsTWVzc2FnZXN9KX1sb2FkUGF5UGFsU2RrKHtvcHRpb25zOmUsYXR0cmlidXRlczp0fSl7cmV0dXJuIFIodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9dGhpcy50cmFuc2Zvcm1Db25maWcoZSksbj10aGlzLnRyYW5zZm9ybUNvbmZpZyh0KSxvPWBodHRwczovL3d3dy5wYXlwYWwuY29tL3Nkay9qcz8ke25ldyBVUkxTZWFyY2hQYXJhbXMoaSkudG9TdHJpbmcoKX1gO3lpZWxkIHRoaXMuc2NyaXB0TG9hZGVyLmxvYWRTY3JpcHQobyx7YXN5bmM6ITAsYXR0cmlidXRlczpufSl9KX1nZXRQYXlQYWxGYXN0bGFuZVNka0NvbmZpZ3VyYXRpb24oZSx0LGkpe2NvbnN0e2NsaWVudFRva2VuOm4saW5pdGlhbGl6YXRpb25EYXRhOm99PWU7aWYoIW98fCFvLmNsaWVudElkKXRocm93IG5ldyB5KGwuTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0e2ludGVudDpyLGNsaWVudElkOmEsbWVyY2hhbnRJZDpzLGF0dHJpYnV0aW9uSWQ6ZH09bztyZXR1cm57b3B0aW9uczp7XCJjbGllbnQtaWRcIjphLFwibWVyY2hhbnQtaWRcIjpzLGNvbW1pdDohMCxjb21wb25lbnRzOltcImZhc3RsYW5lXCIsXCJ0aHJlZS1kb21haW4tc2VjdXJlXCJdLGN1cnJlbmN5OnQsaW50ZW50OnJ9LGF0dHJpYnV0ZXM6e1wiZGF0YS1jbGllbnQtbWV0YWRhdGEtaWRcIjppLnJlcGxhY2UoLy0vZyxcIlwiKSxcImRhdGEtbmFtZXNwYWNlXCI6XCJwYXlwYWxGYXN0bGFuZVNka1wiLFwiZGF0YS1wYXJ0bmVyLWF0dHJpYnV0aW9uLWlkXCI6ZCxcImRhdGEtc2RrLWNsaWVudC10b2tlblwiOm59fX1nZXRQYXlQYWxHb29nbGVQYXlTZGtTY3JpcHRDb25maWdPclRocm93KGUsdCxpPSEwKXtjb25zdHtjbGllbnRUb2tlbjpuLGluaXRpYWxpemF0aW9uRGF0YTpvfT1lO2lmKCFvfHwhby5jbGllbnRJZCl0aHJvdyBuZXcgeShsLk1pc3NpbmdQYXltZW50TWV0aG9kKTtjb25zdHtpbnRlbnQ6cixjbGllbnRJZDphLG1lcmNoYW50SWQ6cyxidXllckNvdW50cnk6ZCxhdHRyaWJ1dGlvbklkOmMsaXNIb3N0ZWRDaGVja291dEVuYWJsZWQ6bSxpc0RldmVsb3Blck1vZGVBcHBsaWNhYmxlOnV9PW8saD1tfHxpO3JldHVybntvcHRpb25zOk9iamVjdC5hc3NpZ24oe1wiY2xpZW50LWlkXCI6YSxcIm1lcmNoYW50LWlkXCI6cyxjb21taXQ6aCxjb21wb25lbnRzOltcImdvb2dsZXBheVwiXSxjdXJyZW5jeTp0LGludGVudDpyfSx1JiZ7XCJidXllci1jb3VudHJ5XCI6ZH0pLGF0dHJpYnV0ZXM6e1wiZGF0YS1wYXJ0bmVyLWF0dHJpYnV0aW9uLWlkXCI6YyxcImRhdGEtY2xpZW50LXRva2VuXCI6bixcImRhdGEtbmFtZXNwYWNlXCI6XCJwYXlwYWxHb29nbGVQYXlcIn19fWdldFBheVBhbEFwbVNka0NvbmZpZ3VyYXRpb24oZSx0KXtjb25zdHtpbml0aWFsaXphdGlvbkRhdGE6aX09ZTtpZighaXx8IWkuY2xpZW50SWQpdGhyb3cgbmV3IHkobC5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3R7aW50ZW50Om4sY2xpZW50SWQ6byxtZXJjaGFudElkOnIsYnV5ZXJDb3VudHJ5OmEsYXR0cmlidXRpb25JZDpzLGlzRGV2ZWxvcGVyTW9kZUFwcGxpY2FibGU6ZCxhdmFpbGFibGVBbHRlcm5hdGl2ZVBheW1lbnRNZXRob2RzOmM9W10sZW5hYmxlZEFsdGVybmF0aXZlUGF5bWVudE1ldGhvZHM6bT1bXX09aSx1PXRoaXMuZmlsdGVyRnVuZGluZ09wdGlvbnMobSksaD10aGlzLmZpbHRlckZ1bmRpbmdPcHRpb25zKGMuZmlsdGVyKGU9PiFtLmluY2x1ZGVzKGUpKSk7cmV0dXJue29wdGlvbnM6T2JqZWN0LmFzc2lnbih7XCJjbGllbnQtaWRcIjpvLFwibWVyY2hhbnQtaWRcIjpyLFwiZW5hYmxlLWZ1bmRpbmdcIjp1Lmxlbmd0aD4wP3U6dm9pZCAwLFwiZGlzYWJsZS1mdW5kaW5nXCI6aC5sZW5ndGg+MD9oOnZvaWQgMCxjb21taXQ6ITAsY29tcG9uZW50czpbXCJidXR0b25zXCIsXCJwYXltZW50LWZpZWxkc1wiXSxjdXJyZW5jeTp0LGludGVudDpufSxkJiZ7XCJidXllci1jb3VudHJ5XCI6YX0pLGF0dHJpYnV0ZXM6e1wiZGF0YS1wYXJ0bmVyLWF0dHJpYnV0aW9uLWlkXCI6cyxcImRhdGEtbmFtZXNwYWNlXCI6XCJwYXlwYWxBcG1zXCJ9fX1nZXRQYXlQYWxTZGtNZXNzYWdlc0NvbmZpZ3VyYXRpb24oZSx0KXtjb25zdHtpbml0aWFsaXphdGlvbkRhdGE6aX09ZTtpZighaXx8IWkuY2xpZW50SWQpdGhyb3cgbmV3IHkobC5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3R7Y2xpZW50SWQ6bixtZXJjaGFudElkOm8sYXR0cmlidXRpb25JZDpyLGlzRGV2ZWxvcGVyTW9kZUFwcGxpY2FibGU6YSxidXllckNvdW50cnk6c309aTtyZXR1cm57b3B0aW9uczpPYmplY3QuYXNzaWduKHtcImNsaWVudC1pZFwiOm4sXCJtZXJjaGFudC1pZFwiOm8sY29tcG9uZW50czpbXCJtZXNzYWdlc1wiXSxjdXJyZW5jeTp0fSxhJiZ7XCJidXllci1jb3VudHJ5XCI6c30pLGF0dHJpYnV0ZXM6e1wiZGF0YS1uYW1lc3BhY2VcIjpcInBheXBhbE1lc3NhZ2VzXCIsXCJkYXRhLXBhcnRuZXItYXR0cmlidXRpb24taWRcIjpyfX19ZmlsdGVyRnVuZGluZ09wdGlvbnMoZSl7Y29uc3QgdD1bXCJrbGFybmFcIixcImFmdGVycGF5XCJdO3JldHVybiBlP2UuZmlsdGVyKGU9PiF0LmluY2x1ZGVzKGUpKTpbXX10cmFuc2Zvcm1Db25maWcoZSl7bGV0IHQ9e307cmV0dXJuIE9iamVjdC5rZXlzKGUpLmZvckVhY2goaT0+e2NvbnN0IG49ZVtpXTtudWxsPT1ufHxcIlwiPT09bnx8QXJyYXkuaXNBcnJheShuKSYmMD09PW4ubGVuZ3RofHwodD1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse1tpXTpBcnJheS5pc0FycmF5KG4pP24uam9pbihcIixcIik6bn0pKX0pLHR9fWZ1bmN0aW9uICQoKXtyZXR1cm4gbmV3IEwoaSgpKX1jb25zdCBxPWZ1bmN0aW9uKHtzdHlsZXM6ZX0pe2NvbnN0IHQ9e307cmV0dXJuIGUuY29sb3ImJih0LmNvbG9yPWUuY29sb3IpLGUubGF5b3V0JiYodC5sYXlvdXQ9ZS5sYXlvdXQpLChlW1wibG9nby10eXBlXCJdfHxlW1wibG9nby1wb3NpdGlvblwiXSkmJih0LmxvZ289e30sZVtcImxvZ28tdHlwZVwiXSYmKHQubG9nby50eXBlPWVbXCJsb2dvLXR5cGVcIl0pLGVbXCJsb2dvLXBvc2l0aW9uXCJdJiYodC5sb2dvLnBvc2l0aW9uPWVbXCJsb2dvLXBvc2l0aW9uXCJdKSksZS5yYXRpbyYmKHQucmF0aW89ZS5yYXRpbyksKGVbXCJ0ZXh0LWNvbG9yXCJdfHxlW1widGV4dC1zaXplXCJdKSYmKHQudGV4dD17fSxlW1widGV4dC1jb2xvclwiXSYmKHQudGV4dC5jb2xvcj1lW1widGV4dC1jb2xvclwiXSksZVtcInRleHQtc2l6ZVwiXSYmKHQudGV4dC5zaXplPStlW1widGV4dC1zaXplXCJdKSksdH07dmFyIEg9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24obyxyKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7cihlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtyKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9vKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgR3tjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlPXQsdGhpcy5wYXlQYWxTZGtIZWxwZXI9aX1pbml0aWFsaXplKGUpe3JldHVybiBIKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtiaWdjb21tZXJjZV9wYXltZW50c19wYXlsYXRlcjp0LGNvbnRhaW5lcklkOmksbWV0aG9kSWQ6bn09ZSx7YnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnM6byxjdXJyZW5jeUNvZGU6cixtZXNzYWdpbmdDb250YWluZXJJZDphfT10fHx7fSxzPSEhbztpZighbil0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighaSl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5jb250YWluZXJJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdCl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c19wYXlsYXRlclwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZihzJiYhcil0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c19wYXlsYXRlci5jdXJyZW5jeUNvZGVcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYocyYmXCJmdW5jdGlvblwiIT10eXBlb2YobnVsbD09bz92b2lkIDA6by5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkpKXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJpZ2NvbW1lcmNlX3BheW1lbnRzX3BheWxhdGVyLmJ1eU5vd0luaXRpYWxpemVPcHRpb25zLmdldEJ1eU5vd0NhcnRSZXF1ZXN0Qm9keVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZCBvciBpdCBpcyBub3QgYSBmdW5jdGlvbi4nKTtzfHwoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWREZWZhdWx0Q2hlY2tvdXQoKSk7Y29uc3QgZD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxsPXM/cjpkLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZTt5aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheVBhbFNkayhuLGwsITEpLHRoaXMucmVuZGVyQnV0dG9uKGksbix0KTtjb25zdCBjPWEmJmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGEpO2lmKGwmJmMpe2NvbnN0IGU9ZC5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhuKSx7cGF5cGFsQk5QTENvbmZpZ3VyYXRpb246dD1bXX09ZS5pbml0aWFsaXphdGlvbkRhdGF8fHt9LGk9dCYmdC5maW5kKCh7aWQ6ZX0pPT5cImNhcnRcIj09PWUpO2lmKCEobnVsbD09aT92b2lkIDA6aS5zdGF0dXMpKXJldHVybjtjLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcHAtc3R5bGUtbG9nby10eXBlXCIpLGMucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcC1zdHlsZS1sb2dvLXBvc2l0aW9uXCIpLGMucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcC1zdHlsZS10ZXh0LWNvbG9yXCIpLGMucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcC1zdHlsZS10ZXh0LXNpemVcIik7Y29uc3Qgbz15aWVsZCB0aGlzLnBheVBhbFNka0hlbHBlci5nZXRQYXlQYWxNZXNzYWdlcyhlLGwpO3RoaXMucmVuZGVyTWVzc2FnZXMobyxhLGkpfX0pfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKX1yZW5kZXJCdXR0b24oZSx0LGkpe2NvbnN0e2J1eU5vd0luaXRpYWxpemVPcHRpb25zOm4sc3R5bGU6byxvbkNvbXBsZXRlOnIsb25FbGlnaWJpbGl0eUZhaWx1cmU6YX09aSxzPXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRQYXlQYWxTZGtPclRocm93KCksZD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyh0KSx7aXNIb3N0ZWRDaGVja291dEVuYWJsZWQ6bH09ZC5pbml0aWFsaXphdGlvbkRhdGF8fHt9LGM9e2NyZWF0ZU9yZGVyOigpPT50aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlT3JkZXIoXCJiaWdjb21tZXJjZV9wYXltZW50c19wYXlsYXRlclwiKSxvbkFwcHJvdmU6KHtvcmRlcklEOmV9KT0+dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLnRva2VuaXplUGF5bWVudCh0LGUpfSxtPXtvbkNsaWNrOigpPT50aGlzLmhhbmRsZUNsaWNrKG4pLG9uQ2FuY2VsOigpPT50aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZERlZmF1bHRDaGVja291dCgpfSx1PXtvblNoaXBwaW5nQWRkcmVzc0NoYW5nZTplPT50aGlzLm9uU2hpcHBpbmdBZGRyZXNzQ2hhbmdlKGUpLG9uU2hpcHBpbmdPcHRpb25zQ2hhbmdlOmU9PnRoaXMub25TaGlwcGluZ09wdGlvbnNDaGFuZ2UoZSksb25BcHByb3ZlOihlLGkpPT50aGlzLm9uSG9zdGVkQ2hlY2tvdXRBcHByb3ZlKGUsaSx0LHIpfSxoPVtzLkZVTkRJTkcuUEFZTEFURVIscy5GVU5ESU5HLkNSRURJVF07bGV0IHk9ITE7aC5mb3JFYWNoKHQ9PntpZigheSl7Y29uc3QgaT1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7ZnVuZGluZ1NvdXJjZTp0LHN0eWxlOnRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRWYWxpZEJ1dHRvblN0eWxlKG8pfSxjKSxuJiZtKSxsJiZ1KSxyPXMuQnV0dG9ucyhpKTtyLmlzRWxpZ2libGUoKT8oci5yZW5kZXIoYCMke2V9YCkseT0hMCk6YSYmXCJmdW5jdGlvblwiPT10eXBlb2YgYSYmYSgpfX0pLHl8fHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KGUpfWhhbmRsZUNsaWNrKGUpe3JldHVybiBIKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZihlKXtjb25zdCB0PXlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5jcmVhdGVCdXlOb3dDYXJ0T3JUaHJvdyhlKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZENoZWNrb3V0KHQuaWQpfX0pfW9uSG9zdGVkQ2hlY2tvdXRBcHByb3ZlKGUsdCxpLG4pe3JldHVybiBIKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighZS5vcmRlcklEKXRocm93IG5ldyB5KGwuTWlzc2luZ09yZGVySWQpO2NvbnN0IG89dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKSxyPXlpZWxkIHQub3JkZXIuZ2V0KCk7dHJ5e2NvbnN0IHQ9dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmdldEJpbGxpbmdBZGRyZXNzRnJvbU9yZGVyRGV0YWlscyhyKTtpZih5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3ModCksby5saW5lSXRlbXMucGh5c2ljYWxJdGVtcy5sZW5ndGg+MCl7Y29uc3QgZT10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U2hpcHBpbmdBZGRyZXNzRnJvbU9yZGVyRGV0YWlscyhyKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlU2hpcHBpbmdBZGRyZXNzKGUpLHlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS51cGRhdGVPcmRlcigpfXJldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIoe30se3BhcmFtczp7bWV0aG9kSWQ6aX19KSx5aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChpLGUub3JkZXJJRCksbiYmXCJmdW5jdGlvblwiPT10eXBlb2YgbiYmbigpLCEwfWNhdGNoKGUpe2lmKFwic3RyaW5nXCI9PXR5cGVvZiBlKXRocm93IG5ldyBFcnJvcihlKTt0aHJvdyBlfX0pfW9uU2hpcHBpbmdBZGRyZXNzQ2hhbmdlKGUpe3JldHVybiBIKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRBZGRyZXNzKHtjaXR5OmUuc2hpcHBpbmdBZGRyZXNzLmNpdHksY291bnRyeUNvZGU6ZS5zaGlwcGluZ0FkZHJlc3MuY291bnRyeUNvZGUscG9zdGFsQ29kZTplLnNoaXBwaW5nQWRkcmVzcy5wb3N0YWxDb2RlLHN0YXRlT3JQcm92aW5jZUNvZGU6ZS5zaGlwcGluZ0FkZHJlc3Muc3RhdGV9KTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZUJpbGxpbmdBZGRyZXNzKHQpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVTaGlwcGluZ0FkZHJlc3ModCk7Y29uc3QgZT10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U2hpcHBpbmdPcHRpb25PclRocm93KCk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNlbGVjdFNoaXBwaW5nT3B0aW9uKGUuaWQpLHlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS51cGRhdGVPcmRlcigpfWNhdGNoKGUpe2lmKFwic3RyaW5nXCI9PXR5cGVvZiBlKXRocm93IG5ldyBFcnJvcihlKTt0aHJvdyBlfX0pfW9uU2hpcHBpbmdPcHRpb25zQ2hhbmdlKGUpe3JldHVybiBIKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRTaGlwcGluZ09wdGlvbk9yVGhyb3coZS5zZWxlY3RlZFNoaXBwaW5nT3B0aW9uLmlkKTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNlbGVjdFNoaXBwaW5nT3B0aW9uKHQuaWQpLHlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS51cGRhdGVPcmRlcigpfWNhdGNoKGUpe2lmKFwic3RyaW5nXCI9PXR5cGVvZiBlKXRocm93IG5ldyBFcnJvcihlKTt0aHJvdyBlfX0pfXJlbmRlck1lc3NhZ2VzKGUsdCxpKXtjb25zdCBuPXthbW91bnQ6dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2hlY2tvdXRPclRocm93KCkub3V0c3RhbmRpbmdCYWxhbmNlLHBsYWNlbWVudDpcImNhcnRcIixzdHlsZTpxKGkpfTtlLk1lc3NhZ2VzKG4pLnJlbmRlcihgIyR7dH1gKX19Y29uc3QgWT1tKGU9Pm5ldyBHKGUsRChlKSwkKCkpLFt7aWQ6XCJiaWdjb21tZXJjZV9wYXltZW50c19wYXlsYXRlclwifV0pO3ZhciBXPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8scil7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe3IoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7cihlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIEt7Y29uc3RydWN0b3IoZSx0KXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2U9dH1pbml0aWFsaXplKGUpe3JldHVybiBXKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtiaWdjb21tZXJjZV9wYXltZW50c19hcG1zOnQsY29udGFpbmVySWQ6aSxtZXRob2RJZDpufT1lLHthcG06byxidXlOb3dJbml0aWFsaXplT3B0aW9uczpyLGN1cnJlbmN5Q29kZTphfT10fHx7fSxzPSEhcjtpZighbil0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighaSl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5jb250YWluZXJJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdCl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c19hcG1zXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFvKXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJpZ2NvbW1lcmNlX3BheW1lbnRzX2FwbXMuYXBtXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKHMmJiFhKXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJpZ2NvbW1lcmNlX3BheW1lbnRzX2FwbXMuY3VycmVuY3lDb2RlXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKHMmJlwiZnVuY3Rpb25cIiE9dHlwZW9mKG51bGw9PXI/dm9pZCAwOnIuZ2V0QnV5Tm93Q2FydFJlcXVlc3RCb2R5KSl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c19hcG1zLmJ1eU5vd0luaXRpYWxpemVPcHRpb25zLmdldEJ1eU5vd0NhcnRSZXF1ZXN0Qm9keVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZCBvciBpdCBpcyBub3QgYSBmdW5jdGlvbi4nKTtzfHwoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWREZWZhdWx0Q2hlY2tvdXQoKSk7Y29uc3QgZD1zP2E6dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlO3lpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5sb2FkUGF5UGFsU2RrKG4sZCwhMSksdGhpcy5yZW5kZXJCdXR0b24oaSxuLHQpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfXJlbmRlckJ1dHRvbihlLHQsaSl7Y29uc3R7YXBtOm4sYnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnM6byxzdHlsZTpyLG9uRWxpZ2liaWxpdHlGYWlsdXJlOmF9PWkscz10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5UGFsU2RrT3JUaHJvdygpO2lmKCFPYmplY3QudmFsdWVzKHMuRlVORElORykuaW5jbHVkZXMobikpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIFBheVBhbCBidXR0b24gYmVjYXVzZSBcIm9wdGlvbnMuYmlnY29tbWVyY2VfcGF5bWVudHNfYXBtcy5hcG1cIiBhcmd1bWVudCBpcyBub3QgdmFsaWQgZnVuZGluZyBzb3VyY2UuJyk7Y29uc3QgZD17Y3JlYXRlT3JkZXI6KCk9PnRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5jcmVhdGVPcmRlcihcImJpZ2NvbW1lcmNlX3BheW1lbnRzX2FwbXNcIiksb25BcHByb3ZlOih7b3JkZXJJRDplfSk9PnRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS50b2tlbml6ZVBheW1lbnQodCxlKX0sbD17b25DbGljazooKT0+dGhpcy5oYW5kbGVDbGljayhvKSxvbkNhbmNlbDooKT0+dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWREZWZhdWx0Q2hlY2tvdXQoKX0sYz1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe2Z1bmRpbmdTb3VyY2U6bixzdHlsZTp0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0VmFsaWRCdXR0b25TdHlsZShyKX0sZCksbyYmbCksbT1zLkJ1dHRvbnMoYyk7bS5pc0VsaWdpYmxlKCk/bS5yZW5kZXIoYCMke2V9YCk6YSYmXCJmdW5jdGlvblwiPT10eXBlb2YgYT9hKCk6dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQoZSl9aGFuZGxlQ2xpY2soZSl7cmV0dXJuIFcodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKGUpe2NvbnN0IHQ9eWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZUJ1eU5vd0NhcnRPclRocm93KGUpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkQ2hlY2tvdXQodC5pZCl9fSl9fWNvbnN0IEo9bShlPT5uZXcgSyhlLEQoZSkpLFt7aWQ6XCJiaWdjb21tZXJjZV9wYXltZW50c19hcG1zXCJ9XSk7dmFyIFg9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24obyxyKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7cihlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtyKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9vKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgWntjb25zdHJ1Y3RvcihlLHQpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZT10fWluaXRpYWxpemUoZSl7cmV0dXJuIFgodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2JpZ2NvbW1lcmNlX3BheW1lbnRzX3Zlbm1vOnQsY29udGFpbmVySWQ6aSxtZXRob2RJZDpufT1lLHtidXlOb3dJbml0aWFsaXplT3B0aW9uczpvLGN1cnJlbmN5Q29kZTpyfT10fHx7fSxhPSEhbztpZighbil0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighaSl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5jb250YWluZXJJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdCl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c192ZW5tb1wiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZihhJiYhcil0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c192ZW5tby5jdXJyZW5jeUNvZGVcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoYSYmXCJmdW5jdGlvblwiIT10eXBlb2YobnVsbD09bz92b2lkIDA6by5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkpKXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJpZ2NvbW1lcmNlX3BheW1lbnRzX3Zlbm1vLmJ1eU5vd0luaXRpYWxpemVPcHRpb25zLmdldEJ1eU5vd0NhcnRSZXF1ZXN0Qm9keVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZCBvciBpdCBpcyBub3QgYSBmdW5jdGlvbi4nKTthfHwoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWREZWZhdWx0Q2hlY2tvdXQoKSk7Y29uc3Qgcz1hP3I6dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlO3lpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5sb2FkUGF5UGFsU2RrKG4scywhMSksdGhpcy5yZW5kZXJCdXR0b24oaSxuLHQpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfXJlbmRlckJ1dHRvbihlLHQsaSl7Y29uc3R7YnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnM6bixzdHlsZTpvLG9uRWxpZ2liaWxpdHlGYWlsdXJlOnJ9PWksYT10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5UGFsU2RrT3JUaHJvdygpLHM9YS5GVU5ESU5HLlZFTk1PLGQ9e2NyZWF0ZU9yZGVyOigpPT50aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlT3JkZXIoXCJiaWdjb21tZXJjZV9wYXltZW50c192ZW5tb1wiKSxvbkFwcHJvdmU6KHtvcmRlcklEOmV9KT0+dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLnRva2VuaXplUGF5bWVudCh0LGUpfSxsPXtvbkNsaWNrOigpPT50aGlzLmhhbmRsZUNsaWNrKG4pLG9uQ2FuY2VsOigpPT50aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZERlZmF1bHRDaGVja291dCgpfSxjPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7ZnVuZGluZ1NvdXJjZTpzLHN0eWxlOnRoaXMuZ2V0VmFsaWRWZW5tb0J1dHRvblN0eWxlcyhvKX0sZCksbiYmbCksbT1hLkJ1dHRvbnMoYyk7bS5pc0VsaWdpYmxlKCk/bS5yZW5kZXIoYCMke2V9YCk6ciYmXCJmdW5jdGlvblwiPT10eXBlb2Ygcj9yKCk6dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQoZSl9Z2V0VmFsaWRWZW5tb0J1dHRvblN0eWxlcyhlKXtjb25zdCB0PXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRWYWxpZEJ1dHRvblN0eWxlKGUpO3JldHVybiB0LmNvbG9yPT09SS5nb2xkP09iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7Y29sb3I6dm9pZCAwfSk6dH1oYW5kbGVDbGljayhlKXtyZXR1cm4gWCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoZSl7Y29uc3QgdD15aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlQnV5Tm93Q2FydE9yVGhyb3coZSk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRDaGVja291dCh0LmlkKX19KX19Y29uc3QgUT1tKGU9Pm5ldyBaKGUsRChlKSksW3tpZDpcImJpZ2NvbW1lcmNlX3BheW1lbnRzX3Zlbm1vXCJ9XSksZWU9e3NpemU6NzAsY29sb3I6XCIjZDlkOWQ5XCIsYmFja2dyb3VuZENvbG9yOlwiI2ZmZmZmZlwifSx0ZT1cImVtYmVkZGVkLWNoZWNrb3V0LWxvYWRpbmctaW5kaWNhdG9yLXJvdGF0aW9uXCI7Y2xhc3MgaWV7Y29uc3RydWN0b3IoZSl7dGhpcy5zdHlsZXM9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGVlKSxlJiZlLnN0eWxlcyksdGhpcy5jb250YWluZXJTdHlsZXM9T2JqZWN0LmFzc2lnbih7fSxlJiZlLmNvbnRhaW5lclN0eWxlcyksdGhpcy5kZWZpbmVBbmltYXRpb24oKSx0aGlzLmNvbnRhaW5lcj10aGlzLmJ1aWxkQ29udGFpbmVyKCksdGhpcy5pbmRpY2F0b3I9dGhpcy5idWlsZEluZGljYXRvcigpLHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuaW5kaWNhdG9yKX1zaG93KGUpe2lmKGUpe2NvbnN0IHQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSk7aWYoIXQpdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIGF0dGFjaCB0aGUgbG9hZGluZyBpbmRpY2F0b3IgYmVjYXVzZSB0aGUgcGFyZW50IElEIGlzIG5vdCB2YWxpZC5cIik7dC5hcHBlbmRDaGlsZCh0aGlzLmNvbnRhaW5lcil9dGhpcy5jb250YWluZXIuc3R5bGUudmlzaWJpbGl0eT1cInZpc2libGVcIix0aGlzLmNvbnRhaW5lci5zdHlsZS5vcGFjaXR5PVwiMVwifWhpZGUoKXtjb25zdCBlPSgpPT57dGhpcy5jb250YWluZXIuc3R5bGUudmlzaWJpbGl0eT1cImhpZGRlblwiLHRoaXMuY29udGFpbmVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsZSl9O3RoaXMuY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsZSksdGhpcy5jb250YWluZXIuc3R5bGUub3BhY2l0eT1cIjBcIn1idWlsZENvbnRhaW5lcigpe2NvbnN0IGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtyZXR1cm4gZS5zdHlsZS5kaXNwbGF5PVwiYmxvY2tcIixlLnN0eWxlLmJvdHRvbT1cIjBcIixlLnN0eWxlLmxlZnQ9XCIwXCIsZS5zdHlsZS5oZWlnaHQ9XCIxMDAlXCIsZS5zdHlsZS53aWR0aD1cIjEwMCVcIixlLnN0eWxlLnBvc2l0aW9uPVwiYWJzb2x1dGVcIixlLnN0eWxlLnJpZ2h0PVwiMFwiLGUuc3R5bGUudG9wPVwiMFwiLGUuc3R5bGUudHJhbnNpdGlvbj1cImFsbCAyNTBtcyBlYXNlLW91dFwiLGUuc3R5bGUub3BhY2l0eT1cIjBcIix0aGlzLnNldFN0eWxlQXR0cmlidXRlKGUsdGhpcy5jb250YWluZXJTdHlsZXMpLGV9YnVpbGRJbmRpY2F0b3IoKXtjb25zdCBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7cmV0dXJuIGUuc3R5bGUuZGlzcGxheT1cImJsb2NrXCIsZS5zdHlsZS53aWR0aD1gJHt0aGlzLnN0eWxlcy5zaXplfXB4YCxlLnN0eWxlLmhlaWdodD1gJHt0aGlzLnN0eWxlcy5zaXplfXB4YCxlLnN0eWxlLmJvcmRlclJhZGl1cz1gJHt0aGlzLnN0eWxlcy5zaXplfXB4YCxlLnN0eWxlLmJvcmRlcj1cInNvbGlkIDFweFwiLGUuc3R5bGUuYm9yZGVyQ29sb3I9YCR7dGhpcy5zdHlsZXMuYmFja2dyb3VuZENvbG9yfSAke3RoaXMuc3R5bGVzLmJhY2tncm91bmRDb2xvcn0gJHt0aGlzLnN0eWxlcy5jb2xvcn0gJHt0aGlzLnN0eWxlcy5jb2xvcn1gLGUuc3R5bGUubWFyZ2luPVwiMCBhdXRvXCIsZS5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCIsZS5zdHlsZS5sZWZ0PVwiMFwiLGUuc3R5bGUucmlnaHQ9XCIwXCIsZS5zdHlsZS50b3A9XCI1MCVcIixlLnN0eWxlLnRyYW5zZm9ybT1cInRyYW5zbGF0ZVkoLTUwJSkgcm90YXRlKDBkZWcpXCIsZS5zdHlsZS50cmFuc2Zvcm1TdHlsZT1cInByZXNlcnZlLTNkXCIsZS5zdHlsZS5hbmltYXRpb249YCR7dGV9IDUwMG1zIGluZmluaXRlIGN1YmljLWJlemllcigwLjY5LCAwLjMxLCAwLjU2LCAwLjgzKWAsZX1zZXRTdHlsZUF0dHJpYnV0ZShlLHQpe09iamVjdC5rZXlzKHQpLmZvckVhY2goaT0+e2Uuc3R5bGUuc2V0UHJvcGVydHkoaSx0W2ldKX0pfWRlZmluZUFuaW1hdGlvbigpe3ZhciBlO2lmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRlKSlyZXR1cm47Y29uc3QgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7dC5pZD10ZSxudWxsPT09KGU9ZG9jdW1lbnQuaGVhZCl8fHZvaWQgMD09PWV8fGUuYXBwZW5kQ2hpbGQodCksdC5zaGVldCBpbnN0YW5jZW9mIENTU1N0eWxlU2hlZXQmJnQuc2hlZXQuaW5zZXJ0UnVsZShgXFxuICAgICAgICAgICAgICAgIEBrZXlmcmFtZXMgJHt0ZX0ge1xcbiAgICAgICAgICAgICAgICAgICAgMCUgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSkgcm90YXRlKDBkZWcpOyB9XFxuICAgICAgICAgICAgICAgICAgICAxMDAlIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpIHJvdGF0ZSgzNjBkZWcpOyB9XFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBgLDApfX1jb25zdCBuZT17XCJiYWNrZ3JvdW5kLWNvbG9yXCI6XCJyZ2JhKDAsIDAsIDAsIDAuNClcIixcInotaW5kZXhcIjpcIjEwMDBcIn07Y2xhc3Mgb2UgZXh0ZW5kcyBOe2NvbnN0cnVjdG9yKGUpe2xldCB0PVwiVW5hYmxlIHRvIHN1Ym1pdCBwYXltZW50IGZvciB0aGUgb3JkZXIgYmVjYXVzZSB0aGUgcGF5bG9hZCBpcyBpbnZhbGlkLlwiO2UmJih0PWAke3R9IE1ha2Ugc3VyZSB0aGUgZm9sbG93aW5nIGZpZWxkcyBhcmUgcHJvdmlkZWQgY29ycmVjdGx5OiAke2Uuam9pbihcIiwgXCIpfS5gKSxzdXBlcih0KSx0aGlzLm5hbWU9XCJQYXltZW50QXJndW1lbnRJbnZhbGlkRXJyb3JcIn19Y2xhc3MgcmUgZXh0ZW5kcyB2e2NvbnN0cnVjdG9yKGUpe3N1cGVyKGUse21lc3NhZ2U6XCJUaGVyZSBpcyBhIHByb2JsZW0gcHJvY2Vzc2luZyB5b3VyIHBheW1lbnQuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCJ9KSx0aGlzLm5hbWU9XCJQYXltZW50TWV0aG9kSW52YWxpZEVycm9yXCIsdGhpcy50eXBlPVwicGF5bWVudF9tZXRob2RfaW52YWxpZFwifX1jbGFzcyBhZSBleHRlbmRzIHV7Y29uc3RydWN0b3IoKXtzdXBlcihcIlRoZSBjdXJyZW50IG9yZGVyIGRvZXMgbm90IG5lZWQgdG8gYmUgZmluYWxpemVkIGF0IHRoaXMgc3RhZ2UuXCIpLHRoaXMubmFtZT1cIk9yZGVyRmluYWxpemF0aW9uTm90UmVxdWlyZWRFcnJvclwiLHRoaXMudHlwZT1cIm9yZGVyX2ZpbmFsaXphdGlvbl9ub3RfcmVxdWlyZWRcIn19ZnVuY3Rpb24gc2UoZSl7cmV0dXJuIShcIm9iamVjdFwiIT10eXBlb2YgZXx8bnVsbD09PWV8fHZvaWQgMCE9PWUuc2hvdWxkU2F2ZUluc3RydW1lbnQmJlwiYm9vbGVhblwiIT10eXBlb2YgZS5zaG91bGRTYXZlSW5zdHJ1bWVudHx8dm9pZCAwIT09ZS5zaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50JiZcImJvb2xlYW5cIiE9dHlwZW9mIGUuc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudCl9ZnVuY3Rpb24gZGUoZSl7cmV0dXJuIEJvb2xlYW4oZS5pbnN0cnVtZW50SWQpfWZ1bmN0aW9uIGxlKGUpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmXCJiaWdwYXlUb2tlblwiaW4gZSYmXCJkZWZhdWx0SW5zdHJ1bWVudFwiaW4gZSYmXCJwcm92aWRlclwiaW4gZSYmXCJ0cnVzdGVkU2hpcHBpbmdBZGRyZXNzXCJpbiBlJiZcIm1ldGhvZFwiaW4gZSYmXCJ0eXBlXCJpbiBlfXZhciBjZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihvLHIpe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtyKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe3IoZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP28oZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBtZXtjb25zdHJ1Y3RvcihlLHQsaSxuKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2U9dCx0aGlzLnBheXBhbFNka0hlbHBlcj1pLHRoaXMubG9hZGluZ0luZGljYXRvcj1ufWluaXRpYWxpemUoZSl7cmV0dXJuIGNlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHttZXRob2RJZDp0LGJpZ2NvbW1lcmNlX3BheW1lbnRzOml9PWV8fHt9O2lmKHRoaXMuYmlnY29tbWVyY2VfcGF5bWVudHM9aSwhdCl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighaSl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c1wiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QodCk7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxvPW4uZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCkse2NvbnRhaW5lcjpyLGJhbm5lckNvbnRhaW5lcklkOmF9PWkse29yZGVySWQ6cyxwYXlwYWxCTlBMQ29uZmlndXJhdGlvbjpkPVtdLGlzUGF5UGFsQ3JlZGl0QXZhaWxhYmxlOmx9PW8uaW5pdGlhbGl6YXRpb25EYXRhfHx7fTtpZih2b2lkIDAhPT1hKXtpZighZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYSkpcmV0dXJuIHZvaWQgY29uc29sZS5lcnJvcihcIlVuYWJsZSB0byBjcmVhdGUgYmFubmVyIHdpdGhvdXQgdmFsaWQgYmFubmVyIGNvbnRhaW5lciBJRC5cIik7Y29uc3QgZT1udWxsPT1kP3ZvaWQgMDpkLmZpbmQoKHtpZDplfSk9PlwiY2hlY2tvdXRcIj09PWUpO2lmKGx8fCEobnVsbD09ZT92b2lkIDA6ZS5zdGF0dXMpKXJldHVybjtjb25zdCB0PXlpZWxkIHRoaXMucGF5cGFsU2RrSGVscGVyLmdldFBheVBhbE1lc3NhZ2VzKG8sbi5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGUpO3JldHVybiB0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZihudWxsPT10P3ZvaWQgMDp0Lk1lc3NhZ2VzKT90aGlzLnJlbmRlck1lc3NhZ2VzKHQsYSxlKTp2b2lkIGNvbnNvbGUuZXJyb3IoXCJbQkMgUGF5UGFsQ29tbWVyY2UgUGF5TGF0ZXJdOiBiYW5uZXIgY291bGQgbm90IGJlIHJlbmRlcmVkLCBkdWUgdG8gaXNzdWVzIHdpdGggbG9hZGluZyBQYXlQYWwgU0RLXCIpfXM/dGhpcy5vcmRlcklkPXM6KHRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj1udWxsPT1yP3ZvaWQgMDpyLnNwbGl0KFwiI1wiKVsxXSx5aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheVBhbFNkayh0KSxpLm9uSW5pdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgaS5vbkluaXQmJmkub25Jbml0KCgpPT50aGlzLnJlbmRlckJ1dHRvbih0LGkpKSwodm9pZCAwPT09aS5zaG91bGRSZW5kZXJQYXlQYWxCdXR0b25PbkluaXRpYWxpemF0aW9ufHxpLnNob3VsZFJlbmRlclBheVBhbEJ1dHRvbk9uSW5pdGlhbGl6YXRpb24pJiZ0aGlzLnJlbmRlckJ1dHRvbih0LGkpKX0pfWV4ZWN1dGUoZSx0KXtyZXR1cm4gY2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6aX09ZSxuPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7bzxuLmxlbmd0aDtvKyspdC5pbmRleE9mKG5bb10pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bb10pJiYoaVtuW29dXT1lW25bb11dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKSx7b25FcnJvcjpvfT10aGlzLmJpZ2NvbW1lcmNlX3BheW1lbnRzfHx7fTtpZighaSl0aHJvdyBuZXcgb2UoW1wicGF5bWVudFwiXSk7Y29uc3R7bWV0aG9kSWQ6cixwYXltZW50RGF0YTphfT1pO2lmKHRoaXMuaXNQYXlQYWxWYXVsdGVkSW5zdHJ1bWVudFBheW1lbnREYXRhKGEpJiYhdGhpcy5vcmRlcklkJiYodGhpcy5vcmRlcklkPXlpZWxkIHRoaXMuY3JlYXRlT3JkZXIoKSksIXRoaXMub3JkZXJJZCl0aHJvdyBuZXcgcmU7Y29uc3Qgcz10aGlzLmlzUGF5UGFsVmF1bHRlZEluc3RydW1lbnRQYXltZW50RGF0YShhKT90aGlzLnByZXBhcmVWYXVsdGVkSW5zdHJ1bWVudFBheW1lbnRQYXlsb2FkKHIsdGhpcy5vcmRlcklkLGEpOnRoaXMucHJlcGFyZVBheW1lbnRQYXlsb2FkKHIsdGhpcy5vcmRlcklkLGEpO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIobix0KSx5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChzKX1jYXRjaChlKXtyZXR1cm4gdGhpcy5pc1Byb3ZpZGVyRXJyb3IoZSkmJih5aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheVBhbFNkayhpLm1ldGhvZElkKSx5aWVsZCBuZXcgUHJvbWlzZSgoZSx0KT0+e3ZhciBuO3RoaXMuYmlnY29tbWVyY2VfcGF5bWVudHMmJihudWxsPT09KG49dGhpcy5wYXlwYWxCdXR0b24pfHx2b2lkIDA9PT1ufHxuLmNsb3NlKCksdGhpcy5yZW5kZXJCdXR0b24oaS5tZXRob2RJZCx0aGlzLmJpZ2NvbW1lcmNlX3BheW1lbnRzKSx0aGlzLmhhbmRsZUVycm9yKG5ldyBFcnJvcihcIklOU1RSVU1FTlRfREVDTElORURcIiksbykpLHQoKX0pKSx0aGlzLmhhbmRsZUVycm9yKGUsbyksUHJvbWlzZS5yZWplY3QoKX19KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgYWUpfWRlaW5pdGlhbGl6ZSgpe3ZhciBlO3JldHVybiB0aGlzLm9yZGVySWQ9dm9pZCAwLG51bGw9PT0oZT10aGlzLnBheXBhbEJ1dHRvbil8fHZvaWQgMD09PWV8fGUuY2xvc2UoKSxQcm9taXNlLnJlc29sdmUoKX1wcmVwYXJlVmF1bHRlZEluc3RydW1lbnRQYXltZW50UGF5bG9hZChlLHQsaSl7Y29uc3R7aW5zdHJ1bWVudElkOm4sc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDpvfT1pLHI9IXRoaXMuaXNUcnVzdGVkVmF1bHRpbmdGbG93KGkpO3JldHVybiByP3ttZXRob2RJZDplLHBheW1lbnREYXRhOntzaG91bGRTYXZlSW5zdHJ1bWVudDpyLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6byxmb3JtYXR0ZWRQYXlsb2FkOntwYXlwYWxfYWNjb3VudDp7b3JkZXJfaWQ6dH19fX06e21ldGhvZElkOmUscGF5bWVudERhdGE6e2luc3RydW1lbnRJZDpuLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6byxmb3JtYXR0ZWRQYXlsb2FkOntwYXlwYWxfYWNjb3VudDp7b3JkZXJfaWQ6dH0sYmlncGF5X3Rva2VuOnt0b2tlbjpufX19fX1wcmVwYXJlUGF5bWVudFBheWxvYWQoZSx0LGkpe2NvbnN0e3Nob3VsZFNhdmVJbnN0cnVtZW50Om49ITEsc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDpvPSExfT1zZShpKT9pOnt9O3JldHVybnttZXRob2RJZDplLHBheW1lbnREYXRhOntzaG91bGRTYXZlSW5zdHJ1bWVudDpuLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6byxmb3JtYXR0ZWRQYXlsb2FkOntwYXlwYWxfYWNjb3VudDp7b3JkZXJfaWQ6dH19fX19cmVuZGVyQnV0dG9uKGUsdCl7Y29uc3QgaT10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5UGFsU2RrT3JUaHJvdygpLG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSkse3BheW1lbnRCdXR0b25TdHlsZXM6b309bi5pbml0aWFsaXphdGlvbkRhdGF8fHt9LHtjaGVja291dFBheW1lbnRCdXR0b25TdHlsZXM6cn09b3x8e30se2NvbnRhaW5lcjphLG9uRXJyb3I6cyxvblJlbmRlckJ1dHRvbjpkLG9uVmFsaWRhdGU6bCxzdWJtaXRGb3JtOmN9PXQ7aWYoIWEpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcImNvbnRhaW5lclwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtjb25zdCBtPXtmdW5kaW5nU291cmNlOmkuRlVORElORy5QQVlQQUwsc3R5bGU6dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmdldFZhbGlkQnV0dG9uU3R5bGUociksY3JlYXRlT3JkZXI6KCk9PnRoaXMuY3JlYXRlT3JkZXIoKSxvbkNsaWNrOihlLHQpPT50aGlzLmhhbmRsZUNsaWNrKHQsbCksb25BcHByb3ZlOmU9PnRoaXMuaGFuZGxlQXBwcm92ZShlLGMpLG9uRXJyb3I6ZT0+dGhpcy5oYW5kbGVFcnJvcihlLHMpLG9uQ2FuY2VsOigpPT50aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpfTt0aGlzLnBheXBhbEJ1dHRvbj1pLkJ1dHRvbnMobSksdGhpcy5wYXlwYWxCdXR0b24uaXNFbGlnaWJsZSgpJiYoZCYmXCJmdW5jdGlvblwiPT10eXBlb2YgZCYmZCgpLHRoaXMucGF5cGFsQnV0dG9uLnJlbmRlcihhKSl9aGFuZGxlQ2xpY2soZSx0KXtyZXR1cm4gY2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3Jlc29sdmU6aSxyZWplY3Q6bn09ZTt5aWVsZCBudWxsPT10P3ZvaWQgMDp0KCgpPT4odGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCEwKSxpKCkpLG4pfSl9aGFuZGxlQXBwcm92ZSh7b3JkZXJJRDplfSx0KXt0aGlzLm9yZGVySWQ9ZSxudWxsPT10fHx0KCl9aGFuZGxlRXJyb3IoZSx0KXt0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLHQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQmJnQoZSl9Y3JlYXRlT3JkZXIoKXtyZXR1cm4gY2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGU9dGhpcy5nZXRGaWVsZHNWYWx1ZXMoKTtyZXR1cm4gdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZU9yZGVyKFwiYmlnY29tbWVyY2VfcGF5bWVudHNjaGVja291dFwiLHtzaG91bGRTYXZlSW5zdHJ1bWVudDoobnVsbD09ZT92b2lkIDA6ZS5zaG91bGRTYXZlSW5zdHJ1bWVudCl8fCExfSl9KX1nZXRGaWVsZHNWYWx1ZXMoKXtjb25zdHtnZXRGaWVsZHNWYWx1ZXM6ZX09dGhpcy5iaWdjb21tZXJjZV9wYXltZW50c3x8e307cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgZT9lKCk6dm9pZCAwfWlzVHJ1c3RlZFZhdWx0aW5nRmxvdyhlKXtpZihlJiZkZShlKSl7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRJbnN0cnVtZW50cygpLGk9bnVsbD09dD92b2lkIDA6dC5maW5kKHQ9PmxlKHQpJiZ0LmJpZ3BheVRva2VuPT09ZS5pbnN0cnVtZW50SWQpO3JldHVybiEobGUoaSkmJiFpLnRydXN0ZWRTaGlwcGluZ0FkZHJlc3MpfXJldHVybiExfXRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoZSl7ZSYmdGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyP3RoaXMubG9hZGluZ0luZGljYXRvci5zaG93KHRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcik6dGhpcy5sb2FkaW5nSW5kaWNhdG9yLmhpZGUoKX1pc1BheVBhbFZhdWx0ZWRJbnN0cnVtZW50UGF5bWVudERhdGEoZSl7cmV0dXJuISFlJiZkZShlKSYmc2UoZSl9cmVuZGVyTWVzc2FnZXMoZSx0LGkpe2NvbnN0IG49e2Ftb3VudDp0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDaGVja291dE9yVGhyb3coKS5vdXRzdGFuZGluZ0JhbGFuY2UscGxhY2VtZW50OlwicGF5bWVudFwiLHN0eWxlOnEoaSl9O2UuTWVzc2FnZXMobikucmVuZGVyKGAjJHt0fWApfWlzUHJvdmlkZXJFcnJvcihlKXt2YXIgdCxpLG47cmV0dXJuISFmdW5jdGlvbihlKXtyZXR1cm5cIm9iamVjdFwiPT10eXBlb2YgZSYmbnVsbCE9PWUmJlwiZXJyb3JzXCJpbiBlfShlKSYmXCJJTlNUUlVNRU5UX0RFQ0xJTkVEXCI9PT0obnVsbD09PShuPW51bGw9PT0oaT0oKG51bGw9PT0odD1udWxsPT1lP3ZvaWQgMDplLmVycm9ycyl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuZmlsdGVyKGU9PmUucHJvdmlkZXJfZXJyb3IpKXx8W10pWzBdKXx8dm9pZCAwPT09aT92b2lkIDA6aS5wcm92aWRlcl9lcnJvcil8fHZvaWQgMD09PW4/dm9pZCAwOm4uY29kZSl9fWNvbnN0IHVlPW0oZT0+bmV3IG1lKGUsRChlKSwkKCksbmV3IGllKHtjb250YWluZXJTdHlsZXM6bmV9KSksW3tpZDpcImJpZ2NvbW1lcmNlX3BheW1lbnRzXCJ9XSk7dmFyIGhlLHllLHBlLGdlLHZlLGZlLGJlLFBlLFNlOyFmdW5jdGlvbihlKXtlLkNWVj1cImN2dlwiLGUuUEFOPVwicGFuXCJ9KGhlfHwoaGU9e30pKTtjbGFzcyBJZXtzdGF0aWMgZ2V0KGUpe2NvbnN0IHQ9YCR7ZW5jb2RlVVJJQ29tcG9uZW50KGAke2V9YCl9PWAsaT1kb2N1bWVudC5jb29raWU7bGV0IG49bnVsbDtjb25zdCBvPWkuaW5kZXhPZih0KTtpZihvPi0xKXtsZXQgZT1pLmluZGV4T2YoXCI7XCIsbyk7LTE9PT1lJiYoZT1pLmxlbmd0aCksbj1kZWNvZGVVUklDb21wb25lbnQoaS5zdWJzdHJpbmcobyt0Lmxlbmd0aCxlKSl9cmV0dXJuIG59c3RhdGljIHNldChlLHQsaT17c2VjdXJlOiEwfSl7bGV0IG49YCR7ZW5jb2RlVVJJQ29tcG9uZW50KGUpfT0ke2VuY29kZVVSSUNvbXBvbmVudCh0KX1gO2NvbnN0e2V4cGlyZXM6byxwYXRoOnIsZG9tYWluOmEsc2VjdXJlOnN9PWk7aWYobyluKz1gOyBleHBpcmVzPSR7by50b1VUQ1N0cmluZygpfWA7ZWxzZXtjb25zdCBlPW5ldyBEYXRlLHQ9NjA7ZS5zZXRUaW1lKGUuZ2V0VGltZSgpKzYwKnQqMWUzKSxuKz1gOyBleHBpcmVzPSR7ZS50b1VUQ1N0cmluZygpfWB9ciYmKG4rPWA7IHBhdGg9JHtyfWApLGEmJihuKz1gOyBkb21haW49JHthfWApLHMmJihuKz1cIjsgc2VjdXJlXCIpLGRvY3VtZW50LmNvb2tpZT1ufXN0YXRpYyByZW1vdmUoZSx0KXtJZS5zZXQoZSxcIlwiLE9iamVjdC5hc3NpZ24oe2V4cGlyZXM6bmV3IERhdGUoMCl9LHQpKX19IWZ1bmN0aW9uKGUpe2UuQVVUSE9SSVpFPVwiYXV0aG9yaXplXCIsZS5DQVBUVVJFPVwiY2FwdHVyZVwifSh5ZXx8KHllPXt9KSksZnVuY3Rpb24oZSl7ZS5Qb3NzaWJsZT1cIlBPU1NJQkxFXCIsZS5Obz1cIk5PXCIsZS5Vbmtub3duPVwiVU5LTk9XTlwiLGUuWWVzPVwiWUVTXCJ9KHBlfHwocGU9e30pKSxmdW5jdGlvbihlKXtlLkFsd2F5cz1cIlNDQV9BTFdBWVNcIn0oZ2V8fChnZT17fSkpLGZ1bmN0aW9uKGUpe2UuU3VjY2VlZGVkPVwic3VjY2VlZGVkXCIsZS5DYW5jZWxsZWQ9XCJjYW5jZWxsZWRcIixlLkVycm9yZWQ9XCJlcnJvcmVkXCJ9KHZlfHwodmU9e30pKSxmdW5jdGlvbihlKXtlLnBheXBhbD1cInBheXBhbFwiLGUuY2hlY2tvdXQ9XCJjaGVja291dFwiLGUuYnV5bm93PVwiYnV5bm93XCIsZS5wYXk9XCJwYXlcIixlLmluc3RhbGxtZW50PVwiaW5zdGFsbG1lbnRcIn0oZmV8fChmZT17fSkpLGZ1bmN0aW9uKGUpe2UuZ29sZD1cImdvbGRcIixlLmJsdWU9XCJibHVlXCIsZS5zaWx2ZXI9XCJzaWx2ZXJcIixlLmJsYWNrPVwiYmxhY2tcIixlLndoaXRlPVwid2hpdGVcIn0oYmV8fChiZT17fSkpLGZ1bmN0aW9uKGUpe2UucGlsbD1cInBpbGxcIixlLnJlY3Q9XCJyZWN0XCJ9KFBlfHwoUGU9e30pKSxmdW5jdGlvbihlKXtlLlNVQ0NFRURFRD1cInN1Y2NlZWRlZFwiLGUuRkFJTEVEPVwiZmFpbGVkXCIsZS5DQU5DRUxFRD1cImNhbmNlbGVkXCIsZS5VTlJFQ09HTklaRUQ9XCJ1bnJlY29nbml6ZWRcIn0oU2V8fChTZT17fSkpO3ZhciBDZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihvLHIpe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtyKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe3IoZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP28oZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyB3ZXtjb25zdHJ1Y3Rvcigpe3RoaXMud2luZG93PXdpbmRvd31pbml0aWFsaXplUGF5UGFsRmFzdGxhbmUoZSx0LGkpe3JldHVybiBDZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYodCYmKHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImZhc3RsYW5lRW52XCIsXCJzYW5kYm94XCIpLHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImF4b0VudlwiLFwic2FuZGJveFwiKSksIXRoaXMud2luZG93LnBheXBhbEZhc3RsYW5lKXtjb25zdCB0PXtyb290OntiYWNrZ3JvdW5kQ29sb3JQcmltYXJ5OlwidHJhbnNwYXJlbnRcIn19O3RoaXMud2luZG93LnBheXBhbEZhc3RsYW5lPXlpZWxkIGUuRmFzdGxhbmUoe3N0eWxlczppfHx0fSl9cmV0dXJuIHRoaXMud2luZG93LnBheXBhbEZhc3RsYW5lfSl9Z2V0UGF5UGFsRmFzdGxhbmVPclRocm93KCl7aWYoIXRoaXMud2luZG93LnBheXBhbEZhc3RsYW5lKXRocm93IG5ldyBoO3JldHVybiB0aGlzLndpbmRvdy5wYXlwYWxGYXN0bGFuZX1sb29rdXBDdXN0b21lck9yVGhyb3coZSl7cmV0dXJuIENlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5nZXRQYXlQYWxGYXN0bGFuZU9yVGhyb3coKS5pZGVudGl0eS5sb29rdXBDdXN0b21lckJ5RW1haWwoZSl9KX10cmlnZ2VyQXV0aGVudGljYXRpb25GbG93T3JUaHJvdyhlKXtyZXR1cm4gQ2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiBlP3RoaXMuZ2V0UGF5UGFsRmFzdGxhbmVPclRocm93KCkuaWRlbnRpdHkudHJpZ2dlckF1dGhlbnRpY2F0aW9uRmxvdyhlKTp7fX0pfXVwZGF0ZVN0b3JhZ2VTZXNzaW9uSWQoZSl7Y29uc3QgdD1uZXcgRGF0ZTt0LnNldERhdGUodC5nZXREYXRlKCkrMTQpO2NvbnN0IGk9e2V4cGlyZXM6dCxzZWN1cmU6ITB9O0llLnNldChcImJjLWZhc3RsYW5lLXNlc3Npb25JZFwiLGUsaSl9cmVtb3ZlU3RvcmFnZVNlc3Npb25JZCgpe0llLnJlbW92ZShcImJjLWZhc3RsYW5lLXNlc3Npb25JZFwiKX1nZXRTdG9yYWdlU2Vzc2lvbklkKCl7cmV0dXJuIEllLmdldChcImJjLWZhc3RsYW5lLXNlc3Npb25JZFwiKXx8XCJcIn1tYXBQYXlQYWxGYXN0bGFuZVByb2ZpbGVUb0JjQ3VzdG9tZXJEYXRhKGUsdCl7dmFyIGksbixvO2NvbnN0e2F1dGhlbnRpY2F0aW9uU3RhdGU6cixwcm9maWxlRGF0YTphfT10LHM9bnVsbD09PShvPW51bGw9PT0obj1udWxsPT09KGk9bnVsbD09YT92b2lkIDA6YS5jYXJkKXx8dm9pZCAwPT09aT92b2lkIDA6aS5wYXltZW50U291cmNlKXx8dm9pZCAwPT09bj92b2lkIDA6bi5jYXJkKXx8dm9pZCAwPT09bz92b2lkIDA6by5iaWxsaW5nQWRkcmVzcyxkPW51bGw9PWE/dm9pZCAwOmEuc2hpcHBpbmdBZGRyZXNzLGw9bnVsbD09YT92b2lkIDA6YS5uYW1lLGM9bnVsbD09YT92b2lkIDA6YS5jYXJkLG09ZD90aGlzLm1hcFBheVBhbFRvQmNBZGRyZXNzKGQuYWRkcmVzcyxkLm5hbWUsZC5waG9uZU51bWJlcik6dm9pZCAwLHU9cyYmbD90aGlzLm1hcFBheVBhbFRvQmNBZGRyZXNzKHMsbCxudWxsPT1kP3ZvaWQgMDpkLnBob25lTnVtYmVyKTp2b2lkIDAsaD1jP3RoaXMubWFwUGF5UGFsVG9CY0luc3RydW1lbnQoZSxjKTpbXSx5PXRoaXMuZmlsdGVyQWRkcmVzc2VzKFttLHVdKTtyZXR1cm57YXV0aGVudGljYXRpb25TdGF0ZTpyfHxTZS5VTlJFQ09HTklaRUQsYWRkcmVzc2VzOnksYmlsbGluZ0FkZHJlc3M6dSxzaGlwcGluZ0FkZHJlc3M6bSxpbnN0cnVtZW50czpofX1tYXBQYXlQYWxUb0JjSW5zdHJ1bWVudChlLHQpe2NvbnN0e2lkOmkscGF5bWVudFNvdXJjZTpufT10LHticmFuZDpvLGV4cGlyeTpyLGxhc3REaWdpdHM6YX09bi5jYXJkLFtzLGRdPXIuc3BsaXQoXCItXCIpO3JldHVyblt7YmlncGF5VG9rZW46aSxicmFuZDpvLGRlZmF1bHRJbnN0cnVtZW50OiExLGV4cGlyeU1vbnRoOmQsZXhwaXJ5WWVhcjpzLGlpbjpcIlwiLGxhc3Q0OmEsbWV0aG9kOmUscHJvdmlkZXI6ZSx0cnVzdGVkU2hpcHBpbmdBZGRyZXNzOiExLHVudHJ1c3RlZFNoaXBwaW5nQ2FyZFZlcmlmaWNhdGlvbk1vZGU6aGUuUEFOLHR5cGU6XCJjYXJkXCJ9XX1tYXBCY1RvUGF5UGFsQWRkcmVzcyhlKXtyZXR1cm57Y29tcGFueToobnVsbD09ZT92b2lkIDA6ZS5jb21wYW55KXx8XCJcIixhZGRyZXNzTGluZTE6KG51bGw9PWU/dm9pZCAwOmUuYWRkcmVzczEpfHxcIlwiLGFkZHJlc3NMaW5lMjoobnVsbD09ZT92b2lkIDA6ZS5hZGRyZXNzMil8fFwiXCIsYWRtaW5BcmVhMToobnVsbD09ZT92b2lkIDA6ZS5zdGF0ZU9yUHJvdmluY2VDb2RlKXx8KG51bGw9PWU/dm9pZCAwOmUuc3RhdGVPclByb3ZpbmNlKXx8XCJcIixhZG1pbkFyZWEyOihudWxsPT1lP3ZvaWQgMDplLmNpdHkpfHxcIlwiLHBvc3RhbENvZGU6KG51bGw9PWU/dm9pZCAwOmUucG9zdGFsQ29kZSl8fFwiXCIsY291bnRyeUNvZGU6KG51bGw9PWU/dm9pZCAwOmUuY291bnRyeUNvZGUpfHxcIlwifX1tYXBQYXlQYWxUb0JjQWRkcmVzcyhlLHQsaSxuKXtjb25zdFtvLHJdPXQuZnVsbE5hbWUuc3BsaXQoXCIgXCIpLGE9KG51bGw9PWk/dm9pZCAwOmkubmF0aW9uYWxOdW1iZXIpfHxcIlwiLHM9KG51bGw9PWk/dm9pZCAwOmkuY291bnRyeUNvZGUpfHxcIlwiO3JldHVybntpZDpEYXRlLm5vdygpLHR5cGU6XCJwYXlwYWwtYWRkcmVzc1wiLGZpcnN0TmFtZTp0LmZpcnN0TmFtZXx8b3x8XCJcIixsYXN0TmFtZTp0Lmxhc3ROYW1lfHxyfHxcIlwiLGNvbXBhbnk6ZS5jb21wYW55fHxcIlwiLGFkZHJlc3MxOmUuYWRkcmVzc0xpbmUxLGFkZHJlc3MyOmUuYWRkcmVzc0xpbmUyfHxcIlwiLGNpdHk6ZS5hZG1pbkFyZWEyLHN0YXRlT3JQcm92aW5jZTplLmFkbWluQXJlYTEsc3RhdGVPclByb3ZpbmNlQ29kZTplLmFkbWluQXJlYTEsY291bnRyeTplLmNvdW50cnlDb2RlfHxcIlwiLGNvdW50cnlDb2RlOmUuY291bnRyeUNvZGV8fFwiXCIscG9zdGFsQ29kZTplLnBvc3RhbENvZGUscGhvbmU6cythLGN1c3RvbUZpZWxkczpufHxbXX19ZmlsdGVyQWRkcmVzc2VzKGUpe3JldHVybiBlLnJlZHVjZSgoZSx0KT0+dD9lLnNvbWUoZT0+dGhpcy5pc0VxdWFsQWRkcmVzc2VzKGUsdCkpP2U6Wy4uLmUsdF06ZSxbXSl9aXNFcXVhbEFkZHJlc3NlcyhlLHQpe3JldHVybiBvKHRoaXMubm9ybWFsaXplQWRkcmVzcyhlKSx0aGlzLm5vcm1hbGl6ZUFkZHJlc3ModCkpfW5vcm1hbGl6ZUFkZHJlc3MoZSl7cmV0dXJuIHMoZSxbXCJpZFwiLFwicGhvbmVcIl0pfX1mdW5jdGlvbiBPZSgpe3JldHVybiBuZXcgd2V9ZnVuY3Rpb24gX2UoZSl7cmV0dXJuXCJzdHJpbmdcIiE9dHlwZW9mIGV9ZnVuY3Rpb24ga2UoZSx0KXtpZih0fHxlKXJldHVybiBmdW5jdGlvbihlKXt2YXIgdCxpO2NvbnN0IG49e30sbz1kKGUucm9vdCxfZSkscj1kKGUuaW5wdXQsX2UpLGE9ZChlLnRvZ2dsZSxfZSkscz1kKG51bGw9PT0odD1lLnRleHQpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmJvZHksX2UpLGw9ZChudWxsPT09KGk9ZS50ZXh0KXx8dm9pZCAwPT09aT92b2lkIDA6aS5jYXB0aW9uLF9lKSxjPWUuYnJhbmRpbmc7cmV0dXJuIE9iamVjdC5rZXlzKG8pLmxlbmd0aCYmKG4ucm9vdD1vKSxPYmplY3Qua2V5cyhyKS5sZW5ndGgmJihuLmlucHV0PXIpLE9iamVjdC5rZXlzKGEpLmxlbmd0aCYmKG4udG9nZ2xlPWEpLE9iamVjdC5rZXlzKHMpLmxlbmd0aCYmKG4udGV4dD17fSxuLnRleHQuYm9keT1zKSxPYmplY3Qua2V5cyhsKS5sZW5ndGgmJihuLnRleHQ9T2JqZWN0LmFzc2lnbih7fSxuLnRleHQpLG4udGV4dC5jYXB0aW9uPWwpLGMmJihuLmJyYW5kaW5nPWMpLG59KGZ1bmN0aW9uKGUsdCl7dmFyIGksbixvLHIsYSxzLGQsbCxjLG0sdSxoLHkscCxnLHYsZixiLFAsUyxJLEM7cmV0dXJue3Jvb3Q6e2JhY2tncm91bmRDb2xvclByaW1hcnk6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVSb290U2V0dGluZ3NCYWNrZ3JvdW5kQ29sb3IpfHwobnVsbD09PShpPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PWk/dm9pZCAwOmkuYmFja2dyb3VuZENvbG9yUHJpbWFyeSksZXJyb3JDb2xvcjoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVJvb3RTZXR0aW5nc0Vycm9yQ29sb3IpfHwobnVsbD09PShuPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PW4/dm9pZCAwOm4uZXJyb3JDb2xvciksZm9udEZhbWlseToobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVJvb3RTZXR0aW5nc0ZvbnRGYW1pbHkpfHwobnVsbD09PShvPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PW8/dm9pZCAwOm8uZm9udEZhbWlseSksZm9udFNpemVCYXNlOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lUm9vdFNldHRpbmdzRm9udFNpemUpfHwobnVsbD09PShyPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PXI/dm9pZCAwOnIuZm9udFNpemVCYXNlKSxwYWRkaW5nOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lUm9vdFNldHRpbmdzUGFkZGluZyl8fChudWxsPT09KGE9bnVsbD09dD92b2lkIDA6dC5yb290KXx8dm9pZCAwPT09YT92b2lkIDA6YS5wYWRkaW5nKSxwcmltYXJ5Q29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVSb290U2V0dGluZ3NQcmltYXJ5Q29sb3IpfHwobnVsbD09PShzPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PXM/dm9pZCAwOnMucHJpbWFyeUNvbG9yKX0saW5wdXQ6e2JvcmRlclJhZGl1czoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUlucHV0U2V0dGluZ3NCb3JkZXJSYWRpdXMpfHwobnVsbD09PShkPW51bGw9PXQ/dm9pZCAwOnQuaW5wdXQpfHx2b2lkIDA9PT1kP3ZvaWQgMDpkLmJvcmRlclJhZGl1cyksYm9yZGVyQ29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVJbnB1dFNldHRpbmdzQm9yZGVyQ29sb3IpfHwobnVsbD09PShsPW51bGw9PXQ/dm9pZCAwOnQuaW5wdXQpfHx2b2lkIDA9PT1sP3ZvaWQgMDpsLmJvcmRlckNvbG9yKSxmb2N1c0JvcmRlckNvbG9yOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lSW5wdXRTZXR0aW5nc0ZvY3VzQm9yZGVyQmFzZSl8fChudWxsPT09KGM9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PWM/dm9pZCAwOmMuZm9jdXNCb3JkZXJDb2xvciksYmFja2dyb3VuZENvbG9yOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lSW5wdXRTZXR0aW5nc0JhY2tncm91bmRDb2xvcil8fChudWxsPT09KG09bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PW0/dm9pZCAwOm0uYmFja2dyb3VuZENvbG9yKSxib3JkZXJXaWR0aDoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUlucHV0U2V0dGluZ3NCb3JkZXJXaWR0aCl8fChudWxsPT09KHU9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PXU/dm9pZCAwOnUuYm9yZGVyV2lkdGgpLHRleHRDb2xvckJhc2U6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVJbnB1dFNldHRpbmdzVGV4dENvbG9yQmFzZSl8fChudWxsPT09KGg9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PWg/dm9pZCAwOmgudGV4dENvbG9yQmFzZSl9LHRvZ2dsZTp7Y29sb3JQcmltYXJ5OihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lVG9nZ2xlU2V0dGluZ3NDb2xvclByaW1hcnkpfHwobnVsbD09PSh5PW51bGw9PXQ/dm9pZCAwOnQudG9nZ2xlKXx8dm9pZCAwPT09eT92b2lkIDA6eS5jb2xvclByaW1hcnkpLGNvbG9yU2Vjb25kYXJ5OihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lVG9nZ2xlU2V0dGluZ3NDb2xvclNlY29uZGFyeSl8fChudWxsPT09KHA9bnVsbD09dD92b2lkIDA6dC50b2dnbGUpfHx2b2lkIDA9PT1wP3ZvaWQgMDpwLmNvbG9yU2Vjb25kYXJ5KX0sdGV4dDp7Ym9keTp7Y29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVUZXh0Qm9keVNldHRpbmdzQ29sb3IpfHwobnVsbD09PSh2PW51bGw9PT0oZz1udWxsPT10P3ZvaWQgMDp0LnRleHQpfHx2b2lkIDA9PT1nP3ZvaWQgMDpnLmJvZHkpfHx2b2lkIDA9PT12P3ZvaWQgMDp2LmNvbG9yKSxmb250U2l6ZToobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVRleHRCb2R5U2V0dGluZ3NGb250U2l6ZSl8fChudWxsPT09KGI9bnVsbD09PShmPW51bGw9PXQ/dm9pZCAwOnQudGV4dCl8fHZvaWQgMD09PWY/dm9pZCAwOmYuYm9keSl8fHZvaWQgMD09PWI/dm9pZCAwOmIuZm9udFNpemUpfSxjYXB0aW9uOntjb2xvcjoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVRleHRDYXB0aW9uU2V0dGluZ3NDb2xvcil8fChudWxsPT09KFM9bnVsbD09PShQPW51bGw9PXQ/dm9pZCAwOnQudGV4dCl8fHZvaWQgMD09PVA/dm9pZCAwOlAuY2FwdGlvbil8fHZvaWQgMD09PVM/dm9pZCAwOlMuY29sb3IpLGZvbnRTaXplOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lVGV4dENhcHRpb25TZXR0aW5nc0ZvbnRTaXplKXx8KG51bGw9PT0oQz1udWxsPT09KEk9bnVsbD09dD92b2lkIDA6dC50ZXh0KXx8dm9pZCAwPT09ST92b2lkIDA6SS5jYXB0aW9uKXx8dm9pZCAwPT09Qz92b2lkIDA6Qy5mb250U2l6ZSl9fSxicmFuZGluZzoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUJyYW5kaW5nU2V0dGluZ3MpfHwobnVsbD09dD92b2lkIDA6dC5icmFuZGluZyl9fShlLHQpKX1mdW5jdGlvbiBBZShlKXtyZXR1cm4hIWUmJihcImF1dGhlbnRpY2F0aW9uU3RhdGVcImluIGV8fFwiYWRkcmVzc2VzXCJpbiBlfHxcImluc3RydW1lbnRzXCJpbiBlKX1mdW5jdGlvbiBFZShlLHQsaT0hMCl7dmFyIG47cmV0dXJuIG51bGwhPT0obj1lW3RdKSYmdm9pZCAwIT09bj9uOml9dmFyIFRlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8scil7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe3IoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7cihlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIHple2NvbnN0cnVjdG9yKGUsdCxpLG4pe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c1JlcXVlc3RTZW5kZXI9dCx0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNTZGs9aSx0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNGYXN0bGFuZVV0aWxzPW59aW5pdGlhbGl6ZShlKXt2YXIgdCxpO3JldHVybiBUZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6bixiaWdjb21tZXJjZV9wYXltZW50c19mYXN0bGFuZTpvfT1lO2lmKCFuKXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKHRoaXMubWV0aG9kSWQ9biwhbyl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c19mYXN0bGFuZVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZih0aGlzLmJpZ2NvbW1lcmNlX3BheW1lbnRzX2Zhc3RsYW5lPW8sIW8ub25Jbml0fHxcImZ1bmN0aW9uXCIhPXR5cGVvZiBvLm9uSW5pdCl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c19mYXN0bGFuZS5vbkluaXRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQgb3IgaXQgaXMgbm90IGEgZnVuY3Rpb24uJyk7aWYoIW8ub25DaGFuZ2V8fFwiZnVuY3Rpb25cIiE9dHlwZW9mIG8ub25DaGFuZ2UpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYmlnY29tbWVyY2VfcGF5bWVudHNfZmFzdGxhbmUub25DaGFuZ2VcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQgb3IgaXQgaXMgbm90IGEgZnVuY3Rpb24uJyk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKG4pO2NvbnN0IHI9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksYT1yLmdldENhcnRPclRocm93KCkscz1yLmdldFBheW1lbnRNZXRob2RPclRocm93KG4pLHtpc0RldmVsb3Blck1vZGVBcHBsaWNhYmxlOmQsaXNGYXN0bGFuZVN0eWxpbmdFbmFibGVkOmx9PXMuaW5pdGlhbGl6YXRpb25EYXRhfHx7fTt0aGlzLnRocmVlRFNWZXJpZmljYXRpb25NZXRob2Q9bnVsbD09PSh0PXMuaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09dD92b2lkIDA6dC50aHJlZURTVmVyaWZpY2F0aW9uTWV0aG9kLHRoaXMucGF5cGFsRmFzdGxhbmVTZGs9eWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzU2RrLmdldFBheVBhbEZhc3RsYW5lU2RrKHMsYS5jdXJyZW5jeS5jb2RlLGEuaWQpO2NvbnN0IGM9a2UobD9udWxsPT09KGk9bnVsbD09cz92b2lkIDA6cy5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmZhc3RsYW5lU3R5bGVzOnt9LG51bGw9PW8/dm9pZCAwOm8uc3R5bGVzKTt5aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNGYXN0bGFuZVV0aWxzLmluaXRpYWxpemVQYXlQYWxGYXN0bGFuZSh0aGlzLnBheXBhbEZhc3RsYW5lU2RrLCEhZCxjKSx0aGlzLnNob3VsZFJ1bkF1dGhlbnRpY2F0aW9uRmxvdygpJiYoeWllbGQgdGhpcy5ydW5QYXlQYWxBdXRoZW50aWNhdGlvbkZsb3dPclRocm93KG4pKSx5aWVsZCB0aGlzLmluaXRpYWxpemVQYXlQYWxQYXltZW50Q29tcG9uZW50KCksby5vbkluaXQoZT0+dGhpcy5yZW5kZXJQYXlQYWxQYXltZW50Q29tcG9uZW50KGUpKSxvLm9uQ2hhbmdlKCgpPT50aGlzLmhhbmRsZVBheVBhbFN0b3JlZEluc3RydW1lbnRDaGFuZ2UobikpfSl9ZXhlY3V0ZShlLHQpe3JldHVybiBUZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cGF5bWVudDppfT1lLG49ZnVuY3Rpb24oZSx0KXt2YXIgaT17fTtmb3IodmFyIG4gaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxuKSYmdC5pbmRleE9mKG4pPDAmJihpW25dPWVbbl0pO2lmKG51bGwhPWUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciBvPTA7Zm9yKG49T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtvPG4ubGVuZ3RoO28rKyl0LmluZGV4T2YobltvXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsbltvXSkmJihpW25bb11dPWVbbltvXV0pfXJldHVybiBpfShlLFtcInBheW1lbnRcIl0pO2lmKCFpKXRocm93IG5ldyBvZShbXCJwYXltZW50XCJdKTtjb25zdHtwYXltZW50RGF0YTpvLG1ldGhvZElkOnJ9PWksYT1vJiZkZShvKTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKG4sdCk7Y29uc3QgZT1hP3lpZWxkIHRoaXMucHJlcGFyZVZhdWx0ZWRJbnN0cnVtZW50UGF5bWVudFBheWxvYWQocixvKTp5aWVsZCB0aGlzLnByZXBhcmVQYXltZW50UGF5bG9hZChyLG8pO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGUpLHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0Zhc3RsYW5lVXRpbHMucmVtb3ZlU3RvcmFnZVNlc3Npb25JZCgpfWNhdGNoKGUpe2lmKGZ1bmN0aW9uKGUpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmXCJtZXNzYWdlXCJpbiBlJiZcInJlc3BvbnNlXCJpbiBlJiZcIm5hbWVcImluIGUucmVzcG9uc2V9KGUpJiZcIklOVkFMSURfUkVRVUVTVFwiPT09ZS5yZXNwb25zZS5uYW1lKXtjb25zdCBlPXt0cmFuc2xhdGlvbktleTpcInBheW1lbnQuZXJyb3JzLmludmFsaWRfcmVxdWVzdF9lcnJvclwifTtyZXR1cm4gdGhpcy5oYW5kbGVFcnJvcihlKSxQcm9taXNlLnJlamVjdCgpfWlmKGUgaW5zdGFuY2VvZiBFcnJvciYmXCJGYXN0bGFuZUVycm9yXCIhPT1lLm5hbWUpdGhyb3cgZTtyZXR1cm4gUHJvbWlzZS5yZWplY3QoKX19KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgYWUpfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBUZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfSl9c2hvdWxkUnVuQXV0aGVudGljYXRpb25GbG93KCl7Y29uc3QgZT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSx0PWUuZ2V0Q2FydE9yVGhyb3coKSxpPWUuZ2V0Q3VzdG9tZXJPclRocm93KCksbj1lLmdldFBheW1lbnRQcm92aWRlckN1c3RvbWVyKCksbz1BZShuKT9uOnt9LHI9dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzRmFzdGxhbmVVdGlscy5nZXRTdG9yYWdlU2Vzc2lvbklkKCk7cmV0dXJuISghaS5pc0d1ZXN0fHwobnVsbD09bz92b2lkIDA6by5hdXRoZW50aWNhdGlvblN0YXRlKT09PVNlLkNBTkNFTEVEfHwobnVsbD09bz92b2lkIDA6by5hdXRoZW50aWNhdGlvblN0YXRlKXx8ciE9PXQuaWQpfXJ1blBheVBhbEF1dGhlbnRpY2F0aW9uRmxvd09yVGhyb3coZSl7cmV0dXJuIFRlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxpPXQuZ2V0Q2FydE9yVGhyb3coKSxuPXQuZ2V0Q3VzdG9tZXIoKSxvPXQuZ2V0QmlsbGluZ0FkZHJlc3MoKSxyPShudWxsPT1uP3ZvaWQgMDpuLmVtYWlsKXx8KG51bGw9PW8/dm9pZCAwOm8uZW1haWwpfHxcIlwiLHtjdXN0b21lckNvbnRleHRJZDphfT15aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNGYXN0bGFuZVV0aWxzLmxvb2t1cEN1c3RvbWVyT3JUaHJvdyhyKSxzPXlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0Zhc3RsYW5lVXRpbHMudHJpZ2dlckF1dGhlbnRpY2F0aW9uRmxvd09yVGhyb3coYSkse2F1dGhlbnRpY2F0aW9uU3RhdGU6ZCxhZGRyZXNzZXM6bCxpbnN0cnVtZW50czpjfT10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNGYXN0bGFuZVV0aWxzLm1hcFBheVBhbEZhc3RsYW5lUHJvZmlsZVRvQmNDdXN0b21lckRhdGEoZSxzKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlUGF5bWVudFByb3ZpZGVyQ3VzdG9tZXIoe2F1dGhlbnRpY2F0aW9uU3RhdGU6ZCxhZGRyZXNzZXM6bCxpbnN0cnVtZW50czpjfSkscy5hdXRoZW50aWNhdGlvblN0YXRlPT09U2UuQ0FOQ0VMRUQ/dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzRmFzdGxhbmVVdGlscy5yZW1vdmVTdG9yYWdlU2Vzc2lvbklkKCk6dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzRmFzdGxhbmVVdGlscy51cGRhdGVTdG9yYWdlU2Vzc2lvbklkKGkuaWQpfWNhdGNoKGUpe319KX1pbml0aWFsaXplUGF5UGFsUGF5bWVudENvbXBvbmVudCgpe3JldHVybiBUZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgZT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRCaWxsaW5nQWRkcmVzc09yVGhyb3coKSx0PWUucGhvbmUsaT1gJHtlLmZpcnN0TmFtZX0gJHtlLmxhc3ROYW1lfWAudHJpbSgpLG49dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzRmFzdGxhbmVVdGlscy5nZXRQYXlQYWxGYXN0bGFuZU9yVGhyb3coKSxvPXtmaWVsZHM6T2JqZWN0LmFzc2lnbih7Y2FyZGhvbGRlck5hbWU6e3ByZWZpbGw6aSxlbmFibGVkOiEwfX0sdCYme3Bob25lTnVtYmVyOntwcmVmaWxsOnR9fSl9O3RoaXMucGF5cGFsQ29tcG9uZW50TWV0aG9kcz15aWVsZCBuLkZhc3RsYW5lQ2FyZENvbXBvbmVudChvKX0pfXJlbmRlclBheVBhbFBheW1lbnRDb21wb25lbnQoZSl7Y29uc3QgdD10aGlzLmdldFBheVBhbENvbXBvbmVudE1ldGhvZHNPclRocm93KCk7aWYoIWUpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byByZW5kZXIgY2FyZCBjb21wb25lbnQgYmVjYXVzZSBcImNvbnRhaW5lclwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt0LnJlbmRlcihlKX1nZXRQYXlQYWxDb21wb25lbnRNZXRob2RzT3JUaHJvdygpe2lmKCF0aGlzLnBheXBhbENvbXBvbmVudE1ldGhvZHMpdGhyb3cgbmV3IGg7cmV0dXJuIHRoaXMucGF5cGFsQ29tcG9uZW50TWV0aG9kc31wcmVwYXJlVmF1bHRlZEluc3RydW1lbnRQYXltZW50UGF5bG9hZChlLHQpe3JldHVybiBUZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7aW5zdHJ1bWVudElkOml9PXQsbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKSxvPXRoaXMuaXNCaWdjb21tZXJjZVBheW1lbnRzRmFzdGxhbmVUaHJlZURTQXZhaWxhYmxlKCkmJm4uY29uZmlnLmlzM2RzRW5hYmxlZD95aWVsZCB0aGlzLmdldDNEU05vbmNlKGkpOmk7cmV0dXJuIHlpZWxkIHRoaXMuY3JlYXRlT3JkZXIobykse21ldGhvZElkOmUscGF5bWVudERhdGE6e2Zvcm1hdHRlZFBheWxvYWQ6e3BheXBhbF9mYXN0bGFuZV90b2tlbjp7b3JkZXJfaWQ6dGhpcy5vcmRlcklkLHRva2VuOm99fX19fSl9cHJlcGFyZVBheW1lbnRQYXlsb2FkKGUsdCl7cmV0dXJuIFRlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG49aS5nZXRCaWxsaW5nQWRkcmVzc09yVGhyb3coKSxvPWkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSkscj1gJHtuLmZpcnN0TmFtZX0gJHtuLmxhc3ROYW1lfWAudHJpbSgpLHtnZXRQYXltZW50VG9rZW46YX09dGhpcy5nZXRQYXlQYWxDb21wb25lbnRNZXRob2RzT3JUaHJvdygpLHtpZDpzfT15aWVsZCBhKHtuYW1lOntmdWxsTmFtZTpyfSxiaWxsaW5nQWRkcmVzczp0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNGYXN0bGFuZVV0aWxzLm1hcEJjVG9QYXlQYWxBZGRyZXNzKG4pfSksZD10aGlzLmlzQmlnY29tbWVyY2VQYXltZW50c0Zhc3RsYW5lVGhyZWVEU0F2YWlsYWJsZSgpJiZvLmNvbmZpZy5pczNkc0VuYWJsZWQse3Nob3VsZFNhdmVJbnN0cnVtZW50Omw9ITEsc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDpjPSExfT1zZSh0KT90Ont9LG09ZD95aWVsZCB0aGlzLmdldDNEU05vbmNlKHMpOnM7cmV0dXJuIHlpZWxkIHRoaXMuY3JlYXRlT3JkZXIobSkse21ldGhvZElkOmUscGF5bWVudERhdGE6T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHQpLHtzaG91bGRTYXZlSW5zdHJ1bWVudDpsLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6Yyxmb3JtYXR0ZWRQYXlsb2FkOntwYXlwYWxfZmFzdGxhbmVfdG9rZW46e29yZGVyX2lkOnRoaXMub3JkZXJJZCx0b2tlbjptfX19KX19KX1jcmVhdGVPcmRlcihlKXtyZXR1cm4gVGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKS5pZDtpZih0aGlzLm1ldGhvZElkKXtjb25zdHtvcmRlcklkOml9PXlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c1JlcXVlc3RTZW5kZXIuY3JlYXRlT3JkZXIodGhpcy5tZXRob2RJZCx7Y2FydElkOnQsZmFzdGxhbmVUb2tlbjplfSk7dGhpcy5vcmRlcklkPWl9fSl9Z2V0M0RTTm9uY2UoZSl7dmFyIHQ7cmV0dXJuIFRlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG49aS5nZXRDYXJ0T3JUaHJvdygpLG89aS5nZXRPcmRlck9yVGhyb3coKSxyPWkuZ2V0U3RvcmVDb25maWdPclRocm93KCkubGlua3MuY2hlY2tvdXRMaW5rLGE9bnVsbD09PSh0PXRoaXMucGF5cGFsRmFzdGxhbmVTZGspfHx2b2lkIDA9PT10P3ZvaWQgMDp0LlRocmVlRG9tYWluU2VjdXJlQ2xpZW50O2lmKCFhKXRocm93IG5ldyBoO2NvbnN0IHM9e2Ftb3VudDpvLm9yZGVyQW1vdW50LnRvRml4ZWQoMiksY3VycmVuY3k6bi5jdXJyZW5jeS5jb2RlLG5vbmNlOmUsdGhyZWVEU1JlcXVlc3RlZDp0aGlzLnRocmVlRFNWZXJpZmljYXRpb25NZXRob2Q9PT1nZS5BbHdheXMsdHJhbnNhY3Rpb25Db250ZXh0OntleHBlcmllbmNlX2NvbnRleHQ6e2xvY2FsZTpcImVuLVVTXCIscmV0dXJuX3VybDpyLGNhbmNlbF91cmw6cn19fSxkPXlpZWxkIGEuaXNFbGlnaWJsZShzKTtpZih0aGlzLnRocmVlRFNWZXJpZmljYXRpb25NZXRob2Q9PT1nZS5BbHdheXMmJiFkKXRocm93IG5ldyByZTtpZihkKXtjb25zdHtsaWFiaWxpdHlTaGlmdDplLGF1dGhlbnRpY2F0aW9uU3RhdGU6dCxub25jZTppfT15aWVsZCBhLnNob3coKTtpZihlPT09Yi5Ob3x8ZT09PWIuVW5rbm93bnx8dD09PXZlLkVycm9yZWR8fHQ9PT12ZS5DYW5jZWxsZWQpdGhyb3cgbmV3IHJlO2lmKHQ9PT12ZS5TdWNjZWVkZWQmJltiLlllcyxiLlBvc3NpYmxlXS5pbmNsdWRlcyhlKSlyZXR1cm4gaX1yZXR1cm4gZX0pfWhhbmRsZVBheVBhbFN0b3JlZEluc3RydW1lbnRDaGFuZ2UoZSl7cmV0dXJuIFRlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0Zhc3RsYW5lVXRpbHMuZ2V0UGF5UGFsRmFzdGxhbmVPclRocm93KCkse3NlbGVjdGlvbkNoYW5nZWQ6aSxzZWxlY3RlZENhcmQ6bn09eWllbGQgdC5wcm9maWxlLnNob3dDYXJkU2VsZWN0b3IoKTtpZihpKXtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRQcm92aWRlckN1c3RvbWVyKCksaT1BZSh0KT90Ont9LG89dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzRmFzdGxhbmVVdGlscy5tYXBQYXlQYWxUb0JjSW5zdHJ1bWVudChlLG4pWzBdO3JldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlUGF5bWVudFByb3ZpZGVyQ3VzdG9tZXIoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGkpLHtpbnN0cnVtZW50czpbb119KSksb319KX1pc0JpZ2NvbW1lcmNlUGF5bWVudHNGYXN0bGFuZVRocmVlRFNBdmFpbGFibGUoKXtyZXR1cm4gRWUodGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0U3RvcmVDb25maWdPclRocm93KCkuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlcyxcIlBST0pFQ1QtNzA4MC5iY3BfZmFzdGxhbmVfdGhyZWVfZHNcIil9aGFuZGxlRXJyb3IoZSl7dmFyIHQ7KG51bGw9PT0odD10aGlzLmJpZ2NvbW1lcmNlX3BheW1lbnRzX2Zhc3RsYW5lKXx8dm9pZCAwPT09dD92b2lkIDA6dC5vbkVycm9yKSYmXCJmdW5jdGlvblwiPT10eXBlb2YgdGhpcy5iaWdjb21tZXJjZV9wYXltZW50c19mYXN0bGFuZS5vbkVycm9yJiZ0aGlzLmJpZ2NvbW1lcmNlX3BheW1lbnRzX2Zhc3RsYW5lLm9uRXJyb3IoZSl9fWNvbnN0IEZlPW0oZT0+e2NvbnN0e2dldEhvc3Q6aX09ZS5nZXRTdGF0ZSgpO3JldHVybiBuZXcgemUoZSxuZXcgQih0KHtob3N0OmkoKX0pKSwkKCksT2UoKSl9LFt7aWQ6XCJiaWdjb21tZXJjZV9wYXltZW50c19mYXN0bGFuZVwifV0pO2NsYXNzIEJlIGV4dGVuZHMgdXtjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIk5vdCBpbXBsZW1lbnRlZC5cIiksdGhpcy5uYW1lPVwiTm90SW1wbGVtZW50ZWRFcnJvclwiLHRoaXMudHlwZT1cIm5vdF9pbXBsZW1lbnRlZFwifX12YXIgTWU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24obyxyKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7cihlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtyKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9vKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgeGV7Y29uc3RydWN0b3IoZSx0LGksbil7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlPXQsdGhpcy5sb2FkaW5nSW5kaWNhdG9yPWksdGhpcy5wYXlwYWxTZGtIZWxwZXI9bn1pbml0aWFsaXplKGUpe3JldHVybiBNZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6dCxiaWdjb21tZXJjZV9wYXltZW50c19wYXlsYXRlcjppfT1lfHx7fTtpZighdCl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighaSl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c19wYXlsYXRlclwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QodCk7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxvPW4uZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCkse3BheXBhbEJOUExDb25maWd1cmF0aW9uOnI9W10sb3JkZXJJZDphfT1vLmluaXRpYWxpemF0aW9uRGF0YXx8e30se2Jhbm5lckNvbnRhaW5lcklkOnMsY29udGFpbmVyOmR9PWk7aWYodm9pZCAwIT09cyl7aWYoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHMpKXJldHVybiB2b2lkIGNvbnNvbGUuZXJyb3IoXCJVbmFibGUgdG8gY3JlYXRlIGJhbm5lciB3aXRob3V0IHZhbGlkIGJhbm5lciBjb250YWluZXIgSUQuXCIpO2NvbnN0IGU9ciYmci5maW5kKCh7aWQ6ZX0pPT5cImNoZWNrb3V0XCI9PT1lKTtpZighKG51bGw9PWU/dm9pZCAwOmUuc3RhdHVzKSlyZXR1cm47Y29uc3QgdD15aWVsZCB0aGlzLnBheXBhbFNka0hlbHBlci5nZXRQYXlQYWxNZXNzYWdlcyhvLG4uZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlKTtyZXR1cm4gdGhpcy5yZW5kZXJNZXNzYWdlcyh0LHMsZSl9YT90aGlzLm9yZGVySWQ9YTooeWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXlQYWxTZGsodCksdGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyPW51bGw9PWQ/dm9pZCAwOmQuc3BsaXQoXCIjXCIpWzFdLHRoaXMucmVuZGVyQnV0dG9uKHQsaSkpfSl9ZXhlY3V0ZShlLHQpe3JldHVybiBNZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cGF5bWVudDppfT1lLG49ZnVuY3Rpb24oZSx0KXt2YXIgaT17fTtmb3IodmFyIG4gaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxuKSYmdC5pbmRleE9mKG4pPDAmJihpW25dPWVbbl0pO2lmKG51bGwhPWUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciBvPTA7Zm9yKG49T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtvPG4ubGVuZ3RoO28rKyl0LmluZGV4T2YobltvXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsbltvXSkmJihpW25bb11dPWVbbltvXV0pfXJldHVybiBpfShlLFtcInBheW1lbnRcIl0pO2lmKCFpKXRocm93IG5ldyBvZShbXCJwYXltZW50XCJdKTtpZighdGhpcy5vcmRlcklkKXRocm93IG5ldyByZTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIobix0KSx5aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChpLm1ldGhvZElkLHRoaXMub3JkZXJJZCl9KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgYWUpfWRlaW5pdGlhbGl6ZSgpe3ZhciBlO3JldHVybiB0aGlzLm9yZGVySWQ9dm9pZCAwLG51bGw9PT0oZT10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNCdXR0b25zKXx8dm9pZCAwPT09ZXx8ZS5jbG9zZSgpLFByb21pc2UucmVzb2x2ZSgpfXJlbmRlckJ1dHRvbihlLHQpe2lmKCEobnVsbD09dD92b2lkIDA6dC5jb250YWluZXIpKXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJjb250YWluZXJcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7Y29uc3QgaT10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5UGFsU2RrT3JUaHJvdygpLG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSkse3BheW1lbnRCdXR0b25TdHlsZXM6b309bi5pbml0aWFsaXphdGlvbkRhdGF8fHt9LHtjaGVja291dFBheW1lbnRCdXR0b25TdHlsZXM6cn09b3x8e30se2NvbnRhaW5lcjphLG9uRXJyb3I6cyxvblJlbmRlckJ1dHRvbjpkLG9uVmFsaWRhdGU6bCxzdWJtaXRGb3JtOmN9PXQsbT1baS5GVU5ESU5HLlBBWUxBVEVSLGkuRlVORElORy5DUkVESVRdO2xldCB1PSExO20uZm9yRWFjaChlPT57aWYodSlyZXR1cm47Y29uc3QgdD17ZnVuZGluZ1NvdXJjZTplLHN0eWxlOnRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRWYWxpZEJ1dHRvblN0eWxlKHIpLGNyZWF0ZU9yZGVyOigpPT50aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlT3JkZXIoXCJiaWdjb21tZXJjZV9wYXltZW50c19wYXlsYXRlclwiKSxvbkNsaWNrOihlLHQpPT50aGlzLmhhbmRsZUNsaWNrKHQsbCksb25BcHByb3ZlOmU9PnRoaXMuaGFuZGxlQXBwcm92ZShlLGMpLG9uQ2FuY2VsOigpPT50aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLG9uRXJyb3I6ZT0+dGhpcy5oYW5kbGVFcnJvcihlLHMpfTtpZih0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNCdXR0b25zPWkuQnV0dG9ucyh0KSx0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNCdXR0b25zLmlzRWxpZ2libGUoKXx8ZSE9PWkuRlVORElORy5QQVlMQVRFUil7aWYoIXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0J1dHRvbnMuaXNFbGlnaWJsZSgpJiZlPT09aS5GVU5ESU5HLkNSRURJVCl0aHJvdyBuZXcgQmUoYEJpZ0NvbW1lcmNlUGF5bWVudHMgJHtlfSBpcyBub3QgYXZhaWxhYmxlIGZvciB5b3VyIHJlZ2lvbi4gUGxlYXNlIHVzZSBCaWdDb21tZXJjZVBheW1lbnRzIENoZWNrb3V0IGluc3RlYWQuYCk7ZCYmXCJmdW5jdGlvblwiPT10eXBlb2YgZCYmZCgpLHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0J1dHRvbnMucmVuZGVyKGEpLHU9ITB9fSl9aGFuZGxlQ2xpY2soZSx0KXtyZXR1cm4gTWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3Jlc29sdmU6aSxyZWplY3Q6bn09ZTt0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0JiYoeWllbGQgdCgoKT0+KHRoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMCksaSgpKSxuKSl9KX1oYW5kbGVBcHByb3ZlKHtvcmRlcklEOmV9LHQpe3RoaXMub3JkZXJJZD1lLHQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQmJnQoKX1oYW5kbGVFcnJvcihlLHQpe3RoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdCYmdChlKX10b2dnbGVMb2FkaW5nSW5kaWNhdG9yKGUpe2UmJnRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj90aGlzLmxvYWRpbmdJbmRpY2F0b3Iuc2hvdyh0aGlzLmxvYWRpbmdJbmRpY2F0b3JDb250YWluZXIpOnRoaXMubG9hZGluZ0luZGljYXRvci5oaWRlKCl9cmVuZGVyTWVzc2FnZXMoZSx0LGkpe2NvbnN0IG49e2Ftb3VudDp0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDaGVja291dE9yVGhyb3coKS5vdXRzdGFuZGluZ0JhbGFuY2UscGxhY2VtZW50OlwicGF5bWVudFwiLHN0eWxlOnEoaSl9O2UuTWVzc2FnZXMobikucmVuZGVyKGAjJHt0fWApfX1jb25zdCBEZT1tKGU9Pm5ldyB4ZShlLEQoZSksbmV3IGllKHtjb250YWluZXJTdHlsZXM6bmV9KSwkKCkpLFt7aWQ6XCJiaWdjb21tZXJjZV9wYXltZW50c19wYXlsYXRlclwifV0pO2NsYXNzIE5lIGV4dGVuZHMgdntjb25zdHJ1Y3RvcihlKXtzdXBlcihlLHttZXNzYWdlOlwiVGhlIHJlcXVlc3QgaGFzIHRpbWVkIG91dCBvciBhYm9ydGVkLlwifSksdGhpcy5uYW1lPVwiVGltZW91dEVycm9yXCIsdGhpcy50eXBlPVwidGltZW91dFwifX12YXIgVWU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24obyxyKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7cihlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtyKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9vKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgamV7Y29uc3RydWN0b3IoZSx0LGksbj0zZTMsbz0zZTUpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZT10LHRoaXMubG9hZGluZ0luZGljYXRvcj1pLHRoaXMucG9sbGluZ0ludGVydmFsPW4sdGhpcy5tYXhQb2xsaW5nSW50ZXJ2YWxUaW1lPW8sdGhpcy5wb2xsaW5nVGltZXI9MCx0aGlzLnN0b3BQb2xsaW5nPWF9aW5pdGlhbGl6ZShlKXtyZXR1cm4gVWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2dhdGV3YXlJZDp0LG1ldGhvZElkOmksYmlnY29tbWVyY2VfcGF5bWVudHNfcmF0ZXBheTpufT1lO2lmKCFpKXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCF0KXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmdhdGV3YXlJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighbil0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c19yYXRlcGF5XCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2NvbnN0e2xlZ2FsVGV4dENvbnRhaW5lcjpvLGNvbnRhaW5lcjpyLGxvYWRpbmdDb250YWluZXJJZDphfT1uO2lmKCFyKXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmNvbnRhaW5lclwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighbyl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5sZWdhbFRleHRDb250YWluZXJcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIWEpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubG9hZGluZ0NvbnRhaW5lcklkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3RoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj1hO2NvbnN0IHM9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSx0KSx7bWVyY2hhbnRJZDpkfT1zLmluaXRpYWxpemF0aW9uRGF0YXx8e307aWYoIWQpdGhyb3cgbmV3IE4oXCJVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgbWVyY2hhbnRJZCBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuXCIpO3RoaXMuYmlnY29tbWVyY2VfcGF5bWVudHNfcmF0ZXBheT1uLHlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5sb2FkUGF5UGFsU2RrKGkpLHRoaXMuY3JlYXRlRnJhdWROZXRTY3JpcHQoZCxpLHQpLHRoaXMubG9hZEZyYXVkbmV0Q29uZmlnKCksdGhpcy5yZW5kZXJMZWdhbFRleHQobyxyKX0pfWV4ZWN1dGUoZSx0KXtyZXR1cm4gVWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6aX09ZSxuPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7bzxuLmxlbmd0aDtvKyspdC5pbmRleE9mKG5bb10pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bb10pJiYoaVtuW29dXT1lW25bb11dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKSx7Z2V0RmllbGRzVmFsdWVzOm99PXRoaXMuYmlnY29tbWVyY2VfcGF5bWVudHNfcmF0ZXBheXx8e307aWYoIWkpdGhyb3cgbmV3IG9lKFtcInBheW1lbnRcIl0pO2lmKCFvfHxcImZ1bmN0aW9uXCIhPXR5cGVvZiBvKXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmdldEZpZWxkc1ZhbHVlc1wiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITApO3RyeXtjb25zdCBlPXlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5jcmVhdGVPcmRlcihcImJpZ2NvbW1lcmNlX3BheW1lbnRzX2FwbXNjaGVja291dFwiLHttZXRhZGF0YUlkOnRoaXMuZ3VpZH0pLHtyYXRlcGF5QmlydGhEYXRlOnIscmF0ZXBheVBob25lTnVtYmVyOmEscmF0ZXBheVBob25lQ291bnRyeUNvZGU6c309bygpLGQ9e2Zvcm1hdHRlZFBheWxvYWQ6e3ZhdWx0X3BheW1lbnRfaW5zdHJ1bWVudDpudWxsLHNldF9hc19kZWZhdWx0X3N0b3JlZF9pbnN0cnVtZW50Om51bGwsZGV2aWNlX2luZm86bnVsbCxtZXRob2RfaWQ6aS5tZXRob2RJZCxyYXRlX3BheTp7YmlydGhfZGF0ZTp0aGlzLm5vcm1hbGl6ZURhdGUocikscGhvbmU6e25hdGlvbmFsX251bWJlcjphLGNvdW50cnlfY29kZTpzLnNwbGl0KFwiK1wiKVsxXX19LHBheXBhbF9hY2NvdW50OntvcmRlcl9pZDplfX19O3JldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIobix0KSx5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudCh7bWV0aG9kSWQ6aS5tZXRob2RJZCxwYXltZW50RGF0YTpkfSkseWllbGQgbmV3IFByb21pc2UoKGUsdCk9Pnt0aGlzLmluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKGkubWV0aG9kSWQsZSx0LGkuZ2F0ZXdheUlkKX0pfWNhdGNoKGUpe3JldHVybiB0aGlzLmhhbmRsZUVycm9yKGUpLG5ldyBQcm9taXNlKChlLHQpPT50KCkpfX0pfWZpbmFsaXplKCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBhZSl9ZGVpbml0aWFsaXplKCl7Y29uc3R7bGVnYWxUZXh0Q29udGFpbmVyOmV9PXRoaXMuYmlnY29tbWVyY2VfcGF5bWVudHNfcmF0ZXBheXx8e30sdD1kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1pZD1cImZyYXVkbmV0U2NyaXB0XCJdJylbMF0saT1kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1pZD1cImZyYXVkbmV0Q29uZmlnXCJdJylbMF07aWYodGhpcy5kZWluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKCksdC5yZW1vdmUoKSxpLnJlbW92ZSgpLGUpe2NvbnN0IHQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSk7bnVsbD09dHx8dC5yZW1vdmUoKX1yZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9bm9ybWFsaXplRGF0ZShlKXtjb25zdCB0PXRoaXMuZm9ybWF0RGF0ZShlLmdldERhdGUoKSksaT10aGlzLmZvcm1hdERhdGUoZS5nZXRNb250aCgpKzEpO3JldHVybmAke2UuZ2V0RnVsbFllYXIoKX0tJHtpfS0ke3R9YH1mb3JtYXREYXRlKGUpe3JldHVybmAke2U8MTA/MDpcIlwifSR7ZX1gfXJlbmRlckxlZ2FsVGV4dChlLHQpe2NvbnN0IGk9ZSxuPXQuc3BsaXQoXCIjXCIpWzFdLG89ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobikscj1udWxsPT1vP3ZvaWQgMDpvLnBhcmVudE5vZGUsYT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2Euc3R5bGUubWFyZ2luQm90dG9tPVwiMjBweFwiLGEuc2V0QXR0cmlidXRlKFwiaWRcIixpKSxudWxsPT1yfHxyLnByZXBlbmQoYSk7Y29uc3Qgcz10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5UGFsU2RrT3JUaHJvdygpLGQ9cy5MZWdhbCh7ZnVuZGluZ1NvdXJjZTpzLkxlZ2FsLkZVTkRJTkcuUEFZX1VQT05fSU5WT0lDRX0pO2lmKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpKSl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwibGVnYWxUZXh0Q29udGFpbmVyRWxlbWVudFwiIGFyZ3VtZW50IGlzIG5vdCBmb3VuZC4nKTtkLnJlbmRlcihgIyR7aX1gKX1oYW5kbGVFcnJvcihlKXtjb25zdHtvbkVycm9yOnR9PXRoaXMuYmlnY29tbWVyY2VfcGF5bWVudHNfcmF0ZXBheXx8e307dGhpcy5yZXNldFBvbGxpbmdNZWNoYW5pc20oKSx0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLHQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQmJnQoZSl9Y3JlYXRlRnJhdWROZXRTY3JpcHQoZSx0LGkpe2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCxpKSx7dGVzdE1vZGU6b309bi5jb25maWcscj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO3Iuc2V0QXR0cmlidXRlKFwidHlwZVwiLFwiYXBwbGljYXRpb24vanNvblwiKSxyLnNldEF0dHJpYnV0ZShcImZuY2xzXCIsXCJmbnBhcmFtcy1kZWRlN2NjNS0xNWZkLTRjNzUtYTlmNC0zNmM0MzBlZTNhOTlcIiksci5zZXRBdHRyaWJ1dGUoXCJkYXRhLWlkXCIsXCJmcmF1ZG5ldFNjcmlwdFwiKSx0aGlzLmd1aWQ9dGhpcy5nZW5lcmF0ZUdVSUQoKTtjb25zdCBhPXtmOnRoaXMuZ3VpZCxzOmAke2V9X2NoZWNrb3V0LXBhZ2VgLHNhbmRib3g6b307ci5pbm5lckhUTUw9SlNPTi5zdHJpbmdpZnkoYSksZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChyKX1nZW5lcmF0ZUdVSUQoKXtsZXQgZT1cIlwiO2ZvcihsZXQgdD0wO3Q8MzI7dCs9MSllKz1cIkFCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5XCJbTWF0aC5mbG9vcig2MipNYXRoLnJhbmRvbSgpKV07cmV0dXJuIGV9bG9hZEZyYXVkbmV0Q29uZmlnKCl7Y29uc3QgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO2Uuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLFwiZnJhdWRuZXRDb25maWdcIiksZS5zcmM9XCJodHRwczovL2MucGF5cGFsLmNvbS9kYS9yL2ZiLmpzXCIsZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlKX1yZWluaXRpYWxpemVTdHJhdGVneShlKXtyZXR1cm4gVWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMuZGVpbml0aWFsaXplKCkseWllbGQgdGhpcy5pbml0aWFsaXplKGUpfSl9aW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oZSx0LGksbil7cmV0dXJuIFVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCBuZXcgUHJvbWlzZSgoZSx0KT0+e2NvbnN0IGk9c2V0VGltZW91dChlLHRoaXMucG9sbGluZ0ludGVydmFsKTt0aGlzLnN0b3BQb2xsaW5nPSgpPT4oY2xlYXJUaW1lb3V0KGkpLHRoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksdCgpKX0pO3RyeXt0aGlzLnBvbGxpbmdUaW1lcis9dGhpcy5wb2xsaW5nSW50ZXJ2YWw7Y29uc3Qgbz15aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0T3JkZXJTdGF0dXMoXCJiaWdjb21tZXJjZV9wYXltZW50c19hcG1zXCIse3BhcmFtczp7dXNlTWV0YWRhdGE6ITB9fSkscj1vPT09Ty5Qb2xsaW5nU3RvcCxhPW89PT1PLlBvbGxpbmdFcnJvcjtpZihyKXJldHVybiB0aGlzLmRlaW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oKSx0KCk7aWYoYSlyZXR1cm4gaSgpO2lmKCFyJiZ0aGlzLnBvbGxpbmdUaW1lcjx0aGlzLm1heFBvbGxpbmdJbnRlcnZhbFRpbWUpcmV0dXJuIHlpZWxkIHRoaXMuaW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oZSx0LGksbik7eWllbGQgdGhpcy5yZWluaXRpYWxpemVTdHJhdGVneSh7bWV0aG9kSWQ6ZSxnYXRld2F5SWQ6bixiaWdjb21tZXJjZV9wYXltZW50c19yYXRlcGF5OnRoaXMuYmlnY29tbWVyY2VfcGF5bWVudHNfcmF0ZXBheX0pLHRoaXMuaGFuZGxlRXJyb3IobmV3IE5lKX1jYXRjaChlKXt0aGlzLmhhbmRsZUVycm9yKGUpLGkoKX19KX1kZWluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKCl7dGhpcy5zdG9wUG9sbGluZygpLHRoaXMucG9sbGluZ1RpbWVyPTB9cmVzZXRQb2xsaW5nTWVjaGFuaXNtKCl7dGhpcy5kZWluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKCl9dG9nZ2xlTG9hZGluZ0luZGljYXRvcihlKXtlJiZ0aGlzLmxvYWRpbmdJbmRpY2F0b3JDb250YWluZXI/dGhpcy5sb2FkaW5nSW5kaWNhdG9yLnNob3codGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyKTp0aGlzLmxvYWRpbmdJbmRpY2F0b3IuaGlkZSgpfX1jb25zdCBWZT1tKGU9Pm5ldyBqZShlLEQoZSksbmV3IGllKHtjb250YWluZXJTdHlsZXM6T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LG5lKSx7cG9zaXRpb246XCJmaXhlZFwifSl9KSksW3tnYXRld2F5OlwiYmlnY29tbWVyY2VfcGF5bWVudHNfYXBtc1wiLGlkOlwicmF0ZXBheVwifV0pO3ZhciBSZTshZnVuY3Rpb24oZSl7ZS5DYXJkQ29kZT1cImNhcmRDb2RlXCIsZS5DYXJkQ29kZVZlcmlmaWNhdGlvbj1cImNhcmRDb2RlVmVyaWZpY2F0aW9uXCIsZS5DYXJkRXhwaXJ5PVwiY2FyZEV4cGlyeVwiLGUuQ2FyZE5hbWU9XCJjYXJkTmFtZVwiLGUuQ2FyZE51bWJlcj1cImNhcmROdW1iZXJcIixlLkNhcmROdW1iZXJWZXJpZmljYXRpb249XCJjYXJkTnVtYmVyVmVyaWZpY2F0aW9uXCIsZS5DYXJkRXhwaXJ5VmVyaWZpY2F0aW9uPVwiY2FyZEV4cGlyeVZlcmlmaWNhdGlvblwifShSZXx8KFJlPXt9KSk7Y29uc3QgTGU9UmU7ZnVuY3Rpb24gJGUoZSl7cmV0dXJuIExlLkNhcmROdW1iZXIgaW4gZSYmTGUuQ2FyZE5hbWUgaW4gZSYmTGUuQ2FyZEV4cGlyeSBpbiBlfWZ1bmN0aW9uIHFlKGUpe3JldHVybiBMZS5DYXJkTnVtYmVyVmVyaWZpY2F0aW9uIGluIGUmJkxlLkNhcmRDb2RlVmVyaWZpY2F0aW9uIGluIGUmJkxlLkNhcmRFeHBpcnlWZXJpZmljYXRpb24gaW4gZX1jbGFzcyBIZSBleHRlbmRzIHV7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBjbGllbnQgbGlicmFyeSBvZiBhIHBheW1lbnQgbWV0aG9kIGhhcyB0aHJvd24gYW4gdW5leHBlY3RlZCBlcnJvci5cIiksdGhpcy5uYW1lPVwiUGF5bWVudE1ldGhvZEZhaWxlZEVycm9yXCIsdGhpcy50eXBlPVwicGF5bWVudF9tZXRob2RfY2xpZW50X2ludmFsaWRcIn19dmFyIEdlOyFmdW5jdGlvbihlKXtlW2UuQ2hlY2tvdXRCdXR0b25Ob3RJbml0aWFsaXplZD0wXT1cIkNoZWNrb3V0QnV0dG9uTm90SW5pdGlhbGl6ZWRcIixlW2UuQ3VzdG9tZXJOb3RJbml0aWFsaXplZD0xXT1cIkN1c3RvbWVyTm90SW5pdGlhbGl6ZWRcIixlW2UuUGF5bWVudE5vdEluaXRpYWxpemVkPTJdPVwiUGF5bWVudE5vdEluaXRpYWxpemVkXCIsZVtlLlNoaXBwaW5nTm90SW5pdGlhbGl6ZWQ9M109XCJTaGlwcGluZ05vdEluaXRpYWxpemVkXCIsZVtlLlNwYW1Qcm90ZWN0aW9uTm90SW5pdGlhbGl6ZWQ9NF09XCJTcGFtUHJvdGVjdGlvbk5vdEluaXRpYWxpemVkXCJ9KEdlfHwoR2U9e30pKTtjbGFzcyBZZSBleHRlbmRzIHV7Y29uc3RydWN0b3IoZSl7c3VwZXIoZnVuY3Rpb24oZSl7c3dpdGNoKGUpe2Nhc2UgR2UuQ3VzdG9tZXJOb3RJbml0aWFsaXplZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIGN1c3RvbWVyIHN0ZXAgb2YgY2hlY2tvdXQgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkLlwiO2Nhc2UgR2UuUGF5bWVudE5vdEluaXRpYWxpemVkOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgcGF5bWVudCBzdGVwIG9mIGNoZWNrb3V0IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIjtjYXNlIEdlLlNoaXBwaW5nTm90SW5pdGlhbGl6ZWQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBzaGlwcGluZyBzdGVwIG9mIGNoZWNrb3V0IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIjtjYXNlIEdlLlNwYW1Qcm90ZWN0aW9uTm90SW5pdGlhbGl6ZWQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBjaGVja291dCBzcGFtIHByb3RlY3Rpb24gaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkLlwiO2RlZmF1bHQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSByZXF1aXJlZCBjb21wb25lbnQgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkLlwifX0oZSkpLHRoaXMuc3VidHlwZT1lLHRoaXMubmFtZT1cIk5vdEluaXRpYWxpemVkRXJyb3JcIix0aGlzLnR5cGU9XCJub3RfaW5pdGlhbGl6ZWRcIn19Y2xhc3MgV2UgZXh0ZW5kcyB1e2NvbnN0cnVjdG9yKGUsdCl7c3VwZXIodHx8XCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBwYXltZW50IGZvcm0gY29udGFpbnMgaW52YWxpZCBkYXRhLlwiKSx0aGlzLmRldGFpbHM9ZSx0aGlzLm5hbWU9XCJQYXltZW50SW52YWxpZEZvcm1FcnJvclwiLHRoaXMudHlwZT1cInBheW1lbnRfaW52YWxpZF9mb3JtXCJ9fXZhciBLZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihvLHIpe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtyKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe3IoZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP28oZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBKZXtjb25zdHJ1Y3RvcihlLHQsaSxuKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2U9dCx0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNTZGs9aSx0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNGYXN0bGFuZVV0aWxzPW59aW5pdGlhbGl6ZShlKXtyZXR1cm4gS2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e21ldGhvZElkOnQsYmlnY29tbWVyY2VfcGF5bWVudHNfY3JlZGl0Y2FyZHM6aX09ZSxuPWkse2Zvcm06byxvbkNyZWRpdENhcmRGaWVsZHNSZW5kZXJpbmdFcnJvcjpyLG9uTG9hZENvbXBsZXRlOmF9PW58fHt9O2lmKCF0KXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFvKXRocm93IG5ldyBOKCdVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c19jcmVkaXRjYXJkcy5mb3JtXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3RoaXMuaG9zdGVkRm9ybU9wdGlvbnM9byx0aGlzLmlzQ3JlZGl0Q2FyZEZvcm09JGUoby5maWVsZHMpLHRoaXMuaXNDcmVkaXRDYXJkVmF1bHRlZEZvcm09cWUoby5maWVsZHMpJiYhdGhpcy5oYXNVbmRlZmluZWRWYWx1ZXMoKSx5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QodCkseWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXlQYWxTZGsodCx2b2lkIDAsITAsITApLCh0aGlzLmlzQ3JlZGl0Q2FyZEZvcm18fHRoaXMuaXNDcmVkaXRDYXJkVmF1bHRlZEZvcm0pJiYoeWllbGQgdGhpcy5pbml0aWFsaXplRmllbGRzKG8scikpLG51bGw9PWF8fGEoKSx0aGlzLnNob3VsZEluaXRpYWxpemVQYXlQYWxGYXN0bGFuZSh0KSYmKHlpZWxkIHRoaXMuaW5pdGlhbGl6ZVBheVBhbEZhc3RsYW5lT3JUaHJvdyh0KSl9KX1leGVjdXRlKGUsdCl7cmV0dXJuIEtlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Oml9PWUsbj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIG89MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO288bi5sZW5ndGg7bysrKXQuaW5kZXhPZihuW29dKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW29dKSYmKGlbbltvXV09ZVtuW29dXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSkse21ldGhvZElkOm8scGF5bWVudERhdGE6cn09aXx8e307aWYoIWl8fCFvKXRocm93IG5ldyBvZShbXCJwYXltZW50XCJdKTtpZih0aGlzLmV4ZWN1dGlvblBheW1lbnREYXRhPXIsdGhpcy5pc0NyZWRpdENhcmRGb3JtfHx0aGlzLmlzQ3JlZGl0Q2FyZFZhdWx0ZWRGb3JtKXlpZWxkIHRoaXMudmFsaWRhdGVIb3N0ZWRGb3JtT3JUaHJvdygpLHlpZWxkIHRoaXMuc3VibWl0SG9zdGVkRm9ybSgpO2Vsc2V7Y29uc3R7b3JkZXJJZDplfT15aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlT3JkZXJDYXJkRmllbGRzKFwiYmlnY29tbWVyY2VfcGF5bWVudHNfY3JlZGl0Y2FyZHNjaGVja291dFwiLHRoaXMuZ2V0SW5zdHJ1bWVudFBhcmFtcygpKTt0aGlzLnJldHVybmVkT3JkZXJJZD1lfWNvbnN0IGE9dGhpcy5wcmVwYXJlUGF5bWVudFBheWxvYWQobyxyLHRoaXMucmV0dXJuZWRPcmRlcklkLHRoaXMucmV0dXJuZWRWYXVsdGVkVG9rZW4pO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihuLHQpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGEpfSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IGFlKX1kZWluaXRpYWxpemUoKXt2YXIgZSx0LGksbjtyZXR1cm4gS2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB5aWVsZCBudWxsPT09KGU9dGhpcy5jdnZGaWVsZCl8fHZvaWQgMD09PWU/dm9pZCAwOmUuY2xvc2UoKSx5aWVsZCBudWxsPT09KHQ9dGhpcy5leHBpcnlGaWVsZCl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuY2xvc2UoKSx5aWVsZCBudWxsPT09KGk9dGhpcy5udW1iZXJGaWVsZCl8fHZvaWQgMD09PWk/dm9pZCAwOmkuY2xvc2UoKSx5aWVsZCBudWxsPT09KG49dGhpcy5uYW1lRmllbGQpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmNsb3NlKCksUHJvbWlzZS5yZXNvbHZlKCl9KX1wcmVwYXJlUGF5bWVudFBheWxvYWQoZSx0LGksbil7Y29uc3R7c2hvdWxkU2F2ZUluc3RydW1lbnQ6bz0hMSxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OmE9ITF9PXNlKHQpP3Q6e30scz10JiZkZSh0KT90Lmluc3RydW1lbnRJZDp2b2lkIDAsbD1kKHt2ZXJpZmljYXRpb25fbm9uY2U6bix0b2tlbjpzfSxyKTtyZXR1cm57bWV0aG9kSWQ6ZSxwYXltZW50RGF0YTp7c2hvdWxkU2F2ZUluc3RydW1lbnQ6byxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OmEsaW5zdHJ1bWVudElkOnMsZm9ybWF0dGVkUGF5bG9hZDpPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sbnx8cz97YmlncGF5X3Rva2VuOmx9Ont9KSxpP3tjYXJkX3dpdGhfb3JkZXI6e29yZGVyX2lkOml9fTp7fSl9fX1pbml0aWFsaXplRmllbGRzKGUsdCl7cmV0dXJuIEtlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtmaWVsZHM6aSxzdHlsZXM6bn09ZSxvPXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRQYXlQYWxTZGtPclRocm93KCkscj10aGlzLmdldEV4ZWN1dGVDYWxsYmFjayhpKSxhPU9iamVjdC5hc3NpZ24oe3N0eWxlOnRoaXMuZ2V0SW5wdXRTdHlsZXMobiksb25BcHByb3ZlOih7b3JkZXJJRDplLHZhdWx0U2V0dXBUb2tlbjp0LGxpYWJpbGl0eVNoaWZ0Oml9KT0+e2lmKGk9PT1iLk5vfHxpPT09Yi5Vbmtub3duKXRocm93IG5ldyBFcnJvcjtyZXR1cm4gdGhpcy5oYW5kbGVBcHByb3ZlKHtvcmRlcklEOmUsdmF1bHRTZXR1cFRva2VuOnR9KX0sb25FcnJvcjooKT0+e3Rocm93IG5ldyBIZX0saW5wdXRFdmVudHM6e29uQ2hhbmdlOnQ9PnRoaXMub25DaGFuZ2VIYW5kbGVyKGUsdCksb25Gb2N1czp0PT50aGlzLm9uRm9jdXNIYW5kbGVyKGUsdCksb25CbHVyOnQ9PnRoaXMub25CbHVySGFuZGxlcihlLHQpLG9uSW5wdXRTdWJtaXRSZXF1ZXN0OnQ9PnRoaXMub25JbnB1dFN1Ym1pdFJlcXVlc3QoZSx0KX19LHIpO2lmKHRoaXMuY2FyZEZpZWxkcz15aWVsZCBvLkNhcmRGaWVsZHMoYSksIXRoaXMuY2FyZEZpZWxkcy5pc0VsaWdpYmxlKCkpdGhyb3cgbmV3IFllKEdlLlBheW1lbnROb3RJbml0aWFsaXplZCk7dHJ5e3RoaXMuc3R5bGl6ZUlucHV0Q29udGFpbmVycyhpKSwkZShpKSYmKHlpZWxkIHRoaXMucmVuZGVyRmllbGRzKGkpKSxxZShpKSYmKHlpZWxkIHRoaXMucmVuZGVyVmF1bHRlZEZpZWxkcyhpKSl9Y2F0Y2goZSl7XCJmdW5jdGlvblwiPT10eXBlb2YgdCYmdChlKX19KX1nZXRFeGVjdXRlQ2FsbGJhY2soZSl7cmV0dXJuIHFlKGUpP3RoaXMuY3JlYXRlVmF1bHRTZXR1cFRva2VuQ2FsbGJhY2soKTp0aGlzLmNyZWF0ZU9yZGVyQ2FsbGJhY2soKX1jcmVhdGVWYXVsdFNldHVwVG9rZW5DYWxsYmFjaygpe3JldHVybntjcmVhdGVWYXVsdFNldHVwVG9rZW46KCk9PktlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtzZXR1cFRva2VuOmV9PSh5aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlT3JkZXJDYXJkRmllbGRzKFwiYmlnY29tbWVyY2VfcGF5bWVudHNfY3JlZGl0Y2FyZHNjaGVja291dFwiLE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0aGlzLmdldEluc3RydW1lbnRQYXJhbXMoKSkse3NldHVwVG9rZW46ITB9KSkpfHx7fTtyZXR1cm4gZX0pfX1jcmVhdGVPcmRlckNhbGxiYWNrKCl7cmV0dXJue2NyZWF0ZU9yZGVyOigpPT5LZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7b3JkZXJJZDplfT0oeWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZU9yZGVyQ2FyZEZpZWxkcyhcImJpZ2NvbW1lcmNlX3BheW1lbnRzX2NyZWRpdGNhcmRzY2hlY2tvdXRcIix0aGlzLmdldEluc3RydW1lbnRQYXJhbXMoKSkpfHx7fTtyZXR1cm4gZX0pfX1oYW5kbGVBcHByb3ZlKHtvcmRlcklEOmUsdmF1bHRTZXR1cFRva2VuOnR9KXtlJiYodGhpcy5yZXR1cm5lZE9yZGVySWQ9ZSksdCYmKHRoaXMucmV0dXJuZWRWYXVsdGVkVG9rZW49dCl9cmVuZGVyRmllbGRzKGUpe3ZhciB0LGksbixvO3JldHVybiBLZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgcj10aGlzLmdldENhcmRGaWVsZHNPclRocm93KCk7KG51bGw9PT0odD1lLmNhcmRDb2RlKXx8dm9pZCAwPT09dD92b2lkIDA6dC5jb250YWluZXJJZCkmJih0aGlzLmN2dkZpZWxkPXIuQ1ZWRmllbGQoe3BsYWNlaG9sZGVyOlwiXCJ9KSx5aWVsZCB0aGlzLmN2dkZpZWxkLnJlbmRlcihgIyR7ZS5jYXJkQ29kZS5jb250YWluZXJJZH1gKSksKG51bGw9PT0oaT1lLmNhcmRFeHBpcnkpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmNvbnRhaW5lcklkKSYmKHRoaXMuZXhwaXJ5RmllbGQ9ci5FeHBpcnlGaWVsZCgpLHlpZWxkIHRoaXMuZXhwaXJ5RmllbGQucmVuZGVyKGAjJHtlLmNhcmRFeHBpcnkuY29udGFpbmVySWR9YCkpLChudWxsPT09KG49ZS5jYXJkTmFtZSl8fHZvaWQgMD09PW4/dm9pZCAwOm4uY29udGFpbmVySWQpJiYodGhpcy5uYW1lRmllbGQ9ci5OYW1lRmllbGQoe3BsYWNlaG9sZGVyOlwiXCJ9KSx5aWVsZCB0aGlzLm5hbWVGaWVsZC5yZW5kZXIoYCMke2UuY2FyZE5hbWUuY29udGFpbmVySWR9YCkpLChudWxsPT09KG89ZS5jYXJkTnVtYmVyKXx8dm9pZCAwPT09bz92b2lkIDA6by5jb250YWluZXJJZCkmJih0aGlzLm51bWJlckZpZWxkPXIuTnVtYmVyRmllbGQoe3BsYWNlaG9sZGVyOlwiXCJ9KSx5aWVsZCB0aGlzLm51bWJlckZpZWxkLnJlbmRlcihgIyR7ZS5jYXJkTnVtYmVyLmNvbnRhaW5lcklkfWApKX0pfXJlbmRlclZhdWx0ZWRGaWVsZHMoZSl7dmFyIHQsaSxuO3JldHVybiBLZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgbz10aGlzLmdldENhcmRGaWVsZHNPclRocm93KCk7KG51bGw9PT0odD1lLmNhcmRDb2RlVmVyaWZpY2F0aW9uKXx8dm9pZCAwPT09dD92b2lkIDA6dC5jb250YWluZXJJZCkmJih0aGlzLmN2dkZpZWxkPW8uQ1ZWRmllbGQoe3BsYWNlaG9sZGVyOlwiXCJ9KSx5aWVsZCB0aGlzLmN2dkZpZWxkLnJlbmRlcihgIyR7ZS5jYXJkQ29kZVZlcmlmaWNhdGlvbi5jb250YWluZXJJZH1gKSksKG51bGw9PT0oaT1lLmNhcmRFeHBpcnlWZXJpZmljYXRpb24pfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmNvbnRhaW5lcklkKSYmKHRoaXMuZXhwaXJ5RmllbGQ9by5FeHBpcnlGaWVsZCgpLHlpZWxkIHRoaXMuZXhwaXJ5RmllbGQucmVuZGVyKGAjJHtlLmNhcmRFeHBpcnlWZXJpZmljYXRpb24uY29udGFpbmVySWR9YCkpLChudWxsPT09KG49ZS5jYXJkTnVtYmVyVmVyaWZpY2F0aW9uKXx8dm9pZCAwPT09bj92b2lkIDA6bi5jb250YWluZXJJZCkmJih0aGlzLm51bWJlckZpZWxkPW8uTnVtYmVyRmllbGQoe3BsYWNlaG9sZGVyOlwiXCJ9KSx5aWVsZCB0aGlzLm51bWJlckZpZWxkLnJlbmRlcihgIyR7ZS5jYXJkTnVtYmVyVmVyaWZpY2F0aW9uLmNvbnRhaW5lcklkfWApKX0pfWdldEluc3RydW1lbnRQYXJhbXMoKXtpZighdGhpcy5leGVjdXRpb25QYXltZW50RGF0YSlyZXR1cm57fTtpZihzZSh0aGlzLmV4ZWN1dGlvblBheW1lbnREYXRhKSl7Y29uc3R7c2hvdWxkU2F2ZUluc3RydW1lbnQ6ZSxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OnR9PXRoaXMuZXhlY3V0aW9uUGF5bWVudERhdGE7cmV0dXJue3Nob3VsZFNhdmVJbnN0cnVtZW50OmUsc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDp0fX1pZihkZSh0aGlzLmV4ZWN1dGlvblBheW1lbnREYXRhKSl7Y29uc3R7aW5zdHJ1bWVudElkOmV9PXRoaXMuZXhlY3V0aW9uUGF5bWVudERhdGE7cmV0dXJue2luc3RydW1lbnRJZDplfX1yZXR1cm57fX1nZXRGaWVsZFR5cGVCeUVtaXR0ZWRGaWVsZCh7ZW1pdHRlZEJ5OmV9KXtyZXR1cm57ZmllbGRUeXBlOnRoaXMubWFwRmllbGRUeXBlKGUpfX1zdWJtaXRIb3N0ZWRGb3JtKCl7cmV0dXJuIEtlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBlPXRoaXMuZ2V0Q2FyZEZpZWxkc09yVGhyb3coKSx0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldEJpbGxpbmdBZGRyZXNzT3JUaHJvdygpLGk9e2JpbGxpbmdBZGRyZXNzOntjb21wYW55OnQuY29tcGFueSxhZGRyZXNzTGluZTE6dC5hZGRyZXNzMSxhZGRyZXNzTGluZTI6dC5hZGRyZXNzMixhZG1pbkFyZWExOnQuc3RhdGVPclByb3ZpbmNlQ29kZSxhZG1pbkFyZWEyOnQuY2l0eSxwb3N0YWxDb2RlOnQucG9zdGFsQ29kZSxjb3VudHJ5Q29kZTp0LmNvdW50cnlDb2RlfX07dHJ5e3RoaXMuaXNDcmVkaXRDYXJkVmF1bHRlZEZvcm0/eWllbGQgZS5zdWJtaXQoKTp5aWVsZCBlLnN1Ym1pdChpKX1jYXRjaChlKXt0aHJvdyBuZXcgSGUoXCJGYWlsZWQgYXV0aGVudGljYXRpb24uIFBsZWFzZSB0cnkgdG8gYXV0aG9yaXplIGFnYWluLlwiKX19KX12YWxpZGF0ZUhvc3RlZEZvcm1PclRocm93KCl7dmFyIGUsdDtyZXR1cm4gS2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9dGhpcy5nZXRDYXJkRmllbGRzT3JUaHJvdygpLG49eWllbGQgaS5nZXRTdGF0ZSgpLnRoZW4oZT0+ZSksbz10aGlzLmdldFZhbGlkaXR5RGF0YShuKTtpZighby5pc1ZhbGlkKXRocm93IG51bGw9PT0odD1udWxsPT09KGU9dGhpcy5ob3N0ZWRGb3JtT3B0aW9ucyl8fHZvaWQgMD09PWU/dm9pZCAwOmUub25WYWxpZGF0ZSl8fHZvaWQgMD09PXR8fHQuY2FsbChlLG8pLG5ldyBXZSh0aGlzLm1hcFZhbGlkYXRpb25FcnJvcnMoby5lcnJvcnMpKX0pfWdldFZhbGlkaXR5RGF0YSh7ZmllbGRzOmV9KXtjb25zdCB0PU9iamVjdC5hc3NpZ24oe30sZSk7ZGVsZXRlIHQuY2FyZE5hbWVGaWVsZDtjb25zdCBpPU9iamVjdC5rZXlzKHQpO3JldHVybntpc1ZhbGlkOmkuZXZlcnkoZT0+e3ZhciBpO3JldHVybiBudWxsPT09KGk9dFtlXSl8fHZvaWQgMD09PWk/dm9pZCAwOmkuaXNWYWxpZH0pLGVycm9yczppLnJlZHVjZSgoZSxpKT0+e3ZhciBuO2NvbnN0IG89dGhpcy5tYXBGaWVsZFR5cGUoaSk7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7W29dOihudWxsPT09KG49dFtpXSl8fHZvaWQgMD09PW4/dm9pZCAwOm4uaXNWYWxpZCk/dm9pZCAwOlt0aGlzLmdldEludmFsaWRFcnJvckJ5RmllbGRUeXBlKG8pXX0pfSx7fSl9fWdldEludmFsaWRFcnJvckJ5RmllbGRUeXBlKGUpe3N3aXRjaChlKXtjYXNlIExlLkNhcmRDb2RlOmNhc2UgTGUuQ2FyZENvZGVWZXJpZmljYXRpb246cmV0dXJue2ZpZWxkVHlwZTplLG1lc3NhZ2U6XCJJbnZhbGlkIGNhcmQgY29kZVwiLHR5cGU6XCJpbnZhbGlkX2NhcmRfY29kZVwifTtjYXNlIExlLkNhcmROdW1iZXI6Y2FzZSBMZS5DYXJkTnVtYmVyVmVyaWZpY2F0aW9uOnJldHVybntmaWVsZFR5cGU6ZSxtZXNzYWdlOlwiSW52YWxpZCBjYXJkIG51bWJlclwiLHR5cGU6XCJpbnZhbGlkX2NhcmRfbnVtYmVyXCJ9O2Nhc2UgTGUuQ2FyZEV4cGlyeTpjYXNlIExlLkNhcmRFeHBpcnlWZXJpZmljYXRpb246cmV0dXJue2ZpZWxkVHlwZTplLG1lc3NhZ2U6XCJJbnZhbGlkIGNhcmQgZXhwaXJ5XCIsdHlwZTpcImludmFsaWRfY2FyZF9leHBpcnlcIn07ZGVmYXVsdDpyZXR1cm57ZmllbGRUeXBlOmUsbWVzc2FnZTpcIkludmFsaWQgZmllbGRcIix0eXBlOlwiaW52YWxpZFwifX19bWFwVmFsaWRhdGlvbkVycm9ycyhlPXt9KXtjb25zdCB0PXt9O3JldHVybiBPYmplY3Qua2V5cyhlKS5mb3JFYWNoKGk9Pnt2YXIgbixvO3RbaV09W3ttZXNzYWdlOihudWxsPT09KG89bnVsbD09PShuPWVbaV0pfHx2b2lkIDA9PT1uP3ZvaWQgMDpuWzBdKXx8dm9pZCAwPT09bz92b2lkIDA6by5tZXNzYWdlKXx8XCJcIix0eXBlOml9XX0pLHR9bWFwRmllbGRUeXBlKGUpe3N3aXRjaChlKXtjYXNlXCJuYW1lXCI6cmV0dXJuIExlLkNhcmROYW1lO2Nhc2VcImNhcmROdW1iZXJGaWVsZFwiOmNhc2VcIm51bWJlclwiOnJldHVybiB0aGlzLmlzQ3JlZGl0Q2FyZEZvcm0/TGUuQ2FyZE51bWJlcjpMZS5DYXJkTnVtYmVyVmVyaWZpY2F0aW9uO2Nhc2VcImNhcmRFeHBpcnlGaWVsZFwiOmNhc2VcImV4cGlyeVwiOnJldHVybiB0aGlzLmlzQ3JlZGl0Q2FyZEZvcm0/TGUuQ2FyZEV4cGlyeTpMZS5DYXJkRXhwaXJ5VmVyaWZpY2F0aW9uO2Nhc2VcImNhcmRDdnZGaWVsZFwiOmNhc2VcImN2dlwiOnJldHVybiB0aGlzLmlzQ3JlZGl0Q2FyZEZvcm0/TGUuQ2FyZENvZGU6TGUuQ2FyZENvZGVWZXJpZmljYXRpb247ZGVmYXVsdDp0aHJvdyBuZXcgRXJyb3IoXCJVbmV4cGVjdGVkIGZpZWxkIHR5cGVcIil9fWdldENhcmRGaWVsZHNPclRocm93KCl7aWYoIXRoaXMuY2FyZEZpZWxkcyl0aHJvdyBuZXcgWWUoR2UuUGF5bWVudE5vdEluaXRpYWxpemVkKTtyZXR1cm4gdGhpcy5jYXJkRmllbGRzfWdldElucHV0U3R5bGVzKGUpe3ZhciB0LGksbjtjb25zdCBvPXtcImZvbnQtc2l6ZVwiOihudWxsPT09KHQ9bnVsbD09ZT92b2lkIDA6ZS5kZWZhdWx0KXx8dm9pZCAwPT09dD92b2lkIDA6dC5mb250U2l6ZSl8fFwiMXJlbVwiLFwiZm9udC1mYW1pbHlcIjoobnVsbD09PShpPW51bGw9PWU/dm9pZCAwOmUuZGVmYXVsdCl8fHZvaWQgMD09PWk/dm9pZCAwOmkuZm9udEZhbWlseSl8fFwiTW9udHNlcnJhdCwgQXJpYWwsIEhlbHZldGljYSwgc2Fucy1zZXJpZlwiLFwiZm9udC13ZWlnaHRcIjoobnVsbD09PShuPW51bGw9PWU/dm9pZCAwOmUuZGVmYXVsdCl8fHZvaWQgMD09PW4/dm9pZCAwOm4uZm9udFdlaWdodCl8fFwiNDAwXCIsb3V0bGluZTpcIm5vbmVcIixwYWRkaW5nOlwiOXB4IDEzcHhcIn0scj1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sbykse2NvbG9yOlwiIzMzMzMzM1wifSk7cmV0dXJue2lucHV0OnIsXCIuaW52YWxpZFwiOk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxvKSx7Y29sb3I6XCJyZWRcIn0pLFwiLnZhbGlkXCI6cixcIjpmb2N1c1wiOnJ9fXN0eWxpemVJbnB1dENvbnRhaW5lcnMoZSl7T2JqZWN0LnZhbHVlcyhlfHx7fSkuZm9yRWFjaChlPT57Y29uc3QgdD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHsobnVsbD09ZT92b2lkIDA6ZS5jb250YWluZXJJZCl8fFwiXCJ9YCk7dCYmKHQuc3R5bGUucGFkZGluZz1cIjBweFwiLHQuc3R5bGUuYm94U2hhZG93PVwibm9uZVwiLHQuc3R5bGUuYm9yZGVyPVwibm9uZVwiLHQuc3R5bGUuYmFja2dyb3VuZD1cInRyYW5zcGFyZW50XCIsdC5zdHlsZS5tYXJnaW5Cb3R0b209XCIxMHB4XCIsdC5zdHlsZS5tYXJnaW5MZWZ0PVwiLTVweFwiKX0pfWhhc1VuZGVmaW5lZFZhbHVlcygpe3JldHVybiF0aGlzLmhvc3RlZEZvcm1PcHRpb25zfHxPYmplY3QudmFsdWVzKHRoaXMuaG9zdGVkRm9ybU9wdGlvbnMuZmllbGRzKS5zb21lKGU9PnZvaWQgMD09PWUpfW9uQ2hhbmdlSGFuZGxlcihlLHQpe3ZhciBpO251bGw9PT0oaT1udWxsPT1lP3ZvaWQgMDplLm9uVmFsaWRhdGUpfHx2b2lkIDA9PT1pfHxpLmNhbGwoZSx0aGlzLmdldFZhbGlkaXR5RGF0YSh0KSl9b25Gb2N1c0hhbmRsZXIoZSx0KXt2YXIgaTtudWxsPT09KGk9bnVsbD09ZT92b2lkIDA6ZS5vbkZvY3VzKXx8dm9pZCAwPT09aXx8aS5jYWxsKGUsdGhpcy5nZXRGaWVsZFR5cGVCeUVtaXR0ZWRGaWVsZCh0KSl9b25CbHVySGFuZGxlcihlLHQpe3ZhciBpO251bGw9PT0oaT1udWxsPT1lP3ZvaWQgMDplLm9uQmx1cil8fHZvaWQgMD09PWl8fGkuY2FsbChlLHRoaXMuZ2V0RmllbGRUeXBlQnlFbWl0dGVkRmllbGQodCkpfW9uSW5wdXRTdWJtaXRSZXF1ZXN0KGUsdCl7dmFyIGk7bnVsbD09PShpPW51bGw9PWU/dm9pZCAwOmUub25FbnRlcil8fHZvaWQgMD09PWl8fGkuY2FsbChlLHRoaXMuZ2V0RmllbGRUeXBlQnlFbWl0dGVkRmllbGQodCkpfXNob3VsZEluaXRpYWxpemVQYXlQYWxGYXN0bGFuZShlKXt2YXIgdCxpO2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksbz1uLmdldFBheW1lbnRNZXRob2RPclRocm93KGUpLHI9bi5nZXRQYXltZW50UHJvdmlkZXJDdXN0b21lcigpLGE9KHM9cikmJihcImF1dGhlbnRpY2F0aW9uU3RhdGVcImluIHN8fFwiYWRkcmVzc2VzXCJpbiBzfHxcImluc3RydW1lbnRzXCJpbiBzKT9yOnt9O3ZhciBzO3JldHVybihudWxsPT09KHQ9bnVsbD09bz92b2lkIDA6by5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmlzQWNjZWxlcmF0ZWRDaGVja291dEVuYWJsZWQpJiYobnVsbD09PShpPW51bGw9PW8/dm9pZCAwOm8uaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09aT92b2lkIDA6aS5pc0JpZ0NvbW1lcmNlUGF5bWVudHNBbmFseXRpY3NWMkVuYWJsZWQpJiYhKG51bGw9PWE/dm9pZCAwOmEuYXV0aGVudGljYXRpb25TdGF0ZSl9aW5pdGlhbGl6ZVBheVBhbEZhc3RsYW5lT3JUaHJvdyhlKXtyZXR1cm4gS2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLGk9dC5nZXRDYXJ0T3JUaHJvdygpLG49dC5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKSx7aW5pdGlhbGl6YXRpb25EYXRhOm99PW47aWYoIShudWxsPT1vP3ZvaWQgMDpvLmNvbm5lY3RDbGllbnRUb2tlbikpcmV0dXJuO2NvbnN0IHI9eWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzU2RrLmdldFBheVBhbEZhc3RsYW5lU2RrKG4saS5jdXJyZW5jeS5jb2RlLGkuaWQpO3lpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0Zhc3RsYW5lVXRpbHMuaW5pdGlhbGl6ZVBheVBhbEZhc3RsYW5lKHIsISEobnVsbD09bz92b2lkIDA6by5pc0RldmVsb3Blck1vZGVBcHBsaWNhYmxlKSl9Y2F0Y2goZSl7fX0pfX1jb25zdCBYZT1tKGU9Pm5ldyBKZShlLEQoZSksJCgpLE9lKCkpLFt7aWQ6XCJiaWdjb21tZXJjZV9wYXltZW50c19jcmVkaXRjYXJkc1wifV0pO3ZhciBaZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihvLHIpe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtyKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe3IoZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP28oZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBRZXtjb25zdHJ1Y3RvcihlLHQsaSxuLG89M2UzLHI9M2U1KXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2U9dCx0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNTZGtIZWxwZXI9aSx0aGlzLmxvYWRpbmdJbmRpY2F0b3I9bix0aGlzLnBvbGxpbmdJbnRlcnZhbD1vLHRoaXMubWF4UG9sbGluZ0ludGVydmFsVGltZT1yLHRoaXMucG9sbGluZ1RpbWVyPTAsdGhpcy5zdG9wUG9sbGluZz1hLHRoaXMuaXNQb2xsaW5nRW5hYmxlZD0hMX1pbml0aWFsaXplKGUpe3JldHVybiBaZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7Z2F0ZXdheUlkOnQsbWV0aG9kSWQ6aSxiaWdjb21tZXJjZV9wYXltZW50c19hcG1zOm59PWU7aWYodGhpcy5iaWdDb21tZXJjZVBheW1lbnRzQWx0ZXJuYXRpdmVNZXRob2RzPW4sIWkpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuZ2F0ZXdheUlkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuKXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJpZ2NvbW1lcmNlX3BheW1lbnRzX2FwbXNcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7Y29uc3Qgbz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPW8uZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSx0KSx7b3JkZXJJZDphLHNob3VsZFJlbmRlckZpZWxkczpzfT1yLmluaXRpYWxpemF0aW9uRGF0YXx8e30sZD1vLmdldFN0b3JlQ29uZmlnT3JUaHJvdygpLmNoZWNrb3V0U2V0dGluZ3MuZmVhdHVyZXM7dGhpcy5pc1BvbGxpbmdFbmFibGVkPUVlKGQsXCJQQVlQQUwtNTYyNC5iY3BfaWRlYWxfcG9sbGluZ1wiKSxhP3RoaXMub3JkZXJJZD1hOih0aGlzLnBheXBhbEFwbXM9eWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzU2RrSGVscGVyLmdldFBheVBhbEFwbXNTZGsocixvLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZSksdGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyPW4uY29udGFpbmVyLnNwbGl0KFwiI1wiKVsxXSx0aGlzLnJlbmRlckJ1dHRvbihpLHQsbikscyYmdGhpcy5yZW5kZXJGaWVsZHMoaSxuKSl9KX1leGVjdXRlKGUsdCl7cmV0dXJuIFplKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Oml9PWUsbj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIG89MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO288bi5sZW5ndGg7bysrKXQuaW5kZXhPZihuW29dKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW29dKSYmKGlbbltvXV09ZVtuW29dXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSk7aWYoIWkpdGhyb3cgbmV3IG9lKFtcInBheW1lbnRcIl0pO2NvbnN0e21ldGhvZElkOm8sZ2F0ZXdheUlkOnJ9PWk7aWYoIXRoaXMub3JkZXJJZCl0aHJvdyBuZXcgcmU7dGhpcy5pc1BvbGxpbmdFbmFibGVkJiZcImlkZWFsXCI9PT1vJiYoeWllbGQgbmV3IFByb21pc2UoKGUsdCk9Pnt0aGlzLmluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKG8sZSx0LHIpfSkpLHRoaXMuaXNOb25JbnN0YW50UGF5bWVudE1ldGhvZChvKXx8KHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihuLHQpKSx5aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChvLHRoaXMub3JkZXJJZCxyKX0pfWZpbmFsaXplKCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBhZSl9ZGVpbml0aWFsaXplKCl7dmFyIGU7cmV0dXJuIHRoaXMub3JkZXJJZD12b2lkIDAsdGhpcy5pc1BvbGxpbmdFbmFibGVkJiZ0aGlzLnJlc2V0UG9sbGluZ01lY2hhbmlzbSgpLG51bGw9PT0oZT10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNCdXR0b24pfHx2b2lkIDA9PT1lfHxlLmNsb3NlKCksUHJvbWlzZS5yZXNvbHZlKCl9aW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oZSx0LGksbil7cmV0dXJuIFplKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCBuZXcgUHJvbWlzZSgoZSx0KT0+e2NvbnN0IGk9c2V0VGltZW91dChlLHRoaXMucG9sbGluZ0ludGVydmFsKTt0aGlzLnN0b3BQb2xsaW5nPSgpPT4oY2xlYXJUaW1lb3V0KGkpLHRoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksdCgpKX0pO3RyeXt0aGlzLnBvbGxpbmdUaW1lcis9dGhpcy5wb2xsaW5nSW50ZXJ2YWw7Y29uc3Qgbz15aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0T3JkZXJTdGF0dXMobikscj1vPT09Ty5BcHByb3ZlZCxhPW89PT1PLlBvbGxpbmdFcnJvcjtpZihyKXJldHVybiB0aGlzLmRlSW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oKSx0KCk7aWYoYSlyZXR1cm4gaSgpO2lmKCFyJiZ0aGlzLnBvbGxpbmdUaW1lcjx0aGlzLm1heFBvbGxpbmdJbnRlcnZhbFRpbWUpcmV0dXJuIHlpZWxkIHRoaXMuaW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oZSx0LGksbik7eWllbGQgdGhpcy5yZWluaXRpYWxpemVTdHJhdGVneSh7bWV0aG9kSWQ6ZSxnYXRld2F5SWQ6bixiaWdDb21tZXJjZVBheW1lbnRzQWx0ZXJuYXRpdmVNZXRob2RzOnRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0FsdGVybmF0aXZlTWV0aG9kc30pLHRoaXMuaGFuZGxlRXJyb3IobmV3IE5lKX1jYXRjaChlKXtpKCl9fSl9ZGVJbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbSgpe3RoaXMuc3RvcFBvbGxpbmcoKSx0aGlzLnBvbGxpbmdUaW1lcj0wfXJlc2V0UG9sbGluZ01lY2hhbmlzbSgpe3RoaXMuZGVJbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbSgpfXJlaW5pdGlhbGl6ZVN0cmF0ZWd5KGUpe3JldHVybiBaZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5kZWluaXRpYWxpemUoKSx5aWVsZCB0aGlzLmluaXRpYWxpemUoZSl9KX1oYW5kbGVFcnJvcihlKXtjb25zdHtvbkVycm9yOnR9PXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0FsdGVybmF0aXZlTWV0aG9kc3x8e307dGhpcy5pc1BvbGxpbmdFbmFibGVkJiZ0aGlzLnJlc2V0UG9sbGluZ01lY2hhbmlzbSgpLHRoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdCYmdChlKX1yZW5kZXJCdXR0b24oZSx0LGkpe2NvbnN0IG49dGhpcy5nZXRQYXlwYWxBbXBzU2RrT3JUaHJvdygpLG89dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSx0KSx7YnV0dG9uU3R5bGU6cn09by5pbml0aWFsaXphdGlvbkRhdGF8fHt9LHtjb250YWluZXI6YSxvbkVycm9yOnMsb25SZW5kZXJCdXR0b246ZCxzdWJtaXRGb3JtOmx9PWksYz17ZnVuZGluZ1NvdXJjZTplLHN0eWxlOnRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRWYWxpZEJ1dHRvblN0eWxlKHIpLG9uSW5pdDooZSx0KT0+aS5vbkluaXRCdXR0b24odCksY3JlYXRlT3JkZXI6KCk9PnRoaXMub25DcmVhdGVPcmRlcihlLHQsaSksb25BcHByb3ZlOmU9PnRoaXMuaGFuZGxlQXBwcm92ZShlLGwpLG9uQ2FuY2VsOigpPT57dGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKSx0aGlzLmRlSW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oKX0sb25FcnJvcjplPT57dGhpcy5kZUluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKCksdGhpcy5oYW5kbGVGYWlsdXJlKGUscyl9LG9uQ2xpY2s6KGUsdCk9PlplKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gaS5vblZhbGlkYXRlKHQucmVzb2x2ZSx0LnJlamVjdCl9KX07dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzQnV0dG9uPW4uQnV0dG9ucyhjKSx0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNCdXR0b24uaXNFbGlnaWJsZSgpJiYoZCYmXCJmdW5jdGlvblwiPT10eXBlb2YgZCYmZCgpLHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0J1dHRvbi5yZW5kZXIoYSkpfW9uQ3JlYXRlT3JkZXIoZSx0LGkpe3JldHVybiBaZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7b25WYWxpZGF0ZTpufT1pO3lpZWxkIG4oKCk9Pih0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITApLCgpPT5Qcm9taXNlLnJlc29sdmUoKSksYSk7Y29uc3Qgbz15aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlT3JkZXIoXCJiaWdjb21tZXJjZV9wYXltZW50c19hcG1zXCIpO2lmKHRoaXMuaXNOb25JbnN0YW50UGF5bWVudE1ldGhvZChlKSl7Y29uc3QgaT17dXNlU3RvcmVDcmVkaXQ6ITF9LG49e3BhcmFtczp7bWV0aG9kSWQ6ZSxnYXRld2F5SWQ6dH19O3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihpLG4pLHlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGUsbyx0KX1yZXR1cm4gb30pfWhhbmRsZUFwcHJvdmUoe29yZGVySUQ6ZX0sdCl7dGhpcy5vcmRlcklkPWUsdCgpfWhhbmRsZUZhaWx1cmUoZSx0KXt0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLHQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQmJnQoZSl9cmVuZGVyRmllbGRzKGUsdCl7Y29uc3QgaT10aGlzLmdldFBheXBhbEFtcHNTZGtPclRocm93KCksbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSx7Zmlyc3ROYW1lOm8sbGFzdE5hbWU6cixlbWFpbDphfT1uLmdldEJpbGxpbmdBZGRyZXNzT3JUaHJvdygpLHthcG1GaWVsZHNDb250YWluZXI6cyxhcG1GaWVsZHNTdHlsZXM6ZH09dDtpZighcyl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c19hcG1zXCIgYXJndW1lbnQgc2hvdWxkIGNvbnRhaW4gXCJhcG1GaWVsZHNDb250YWluZXJcIi4nKTtjb25zdCBsPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iocyk7bCYmKGwuaW5uZXJIVE1MPVwiXCIpO2NvbnN0IGM9e2Z1bmRpbmdTb3VyY2U6ZSxzdHlsZTpkfHx7fSxmaWVsZHM6e25hbWU6e3ZhbHVlOmAke299ICR7cn1gfSxlbWFpbDp7dmFsdWU6YX19fTtpLlBheW1lbnRGaWVsZHMoYykucmVuZGVyKHMpfXRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoZSl7ZSYmdGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyP3RoaXMubG9hZGluZ0luZGljYXRvci5zaG93KHRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcik6dGhpcy5sb2FkaW5nSW5kaWNhdG9yLmhpZGUoKX1pc05vbkluc3RhbnRQYXltZW50TWV0aG9kKGUpe3JldHVybiBlLnRvVXBwZXJDYXNlKClpbiB3fWdldFBheXBhbEFtcHNTZGtPclRocm93KCl7aWYoIXRoaXMucGF5cGFsQXBtcyl0aHJvdyBuZXcgaDtyZXR1cm4gdGhpcy5wYXlwYWxBcG1zfX1jb25zdCBldD1tKGU9Pm5ldyBRZShlLEQoZSksJCgpLG5ldyBpZSh7Y29udGFpbmVyU3R5bGVzOm5lfSkpLFt7Z2F0ZXdheTpcImJpZ2NvbW1lcmNlX3BheW1lbnRzX2FwbXNcIn1dKTtjbGFzcyB0dHtjb25zdHJ1Y3RvcihlLHQpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZT10fWluaXRpYWxpemUoZSl7Y29uc3R7Z2F0ZXdheUlkOnQsbWV0aG9kSWQ6aSxiaWdjb21tZXJjZV9wYXltZW50c19hcG1zOm59PWU7aWYodGhpcy5iaWdDb21tZXJjZVBheW1lbnRzQWx0ZXJuYXRpdmVNZXRob2RzPW4sIWkpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuZ2F0ZXdheUlkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3JldHVybiBQcm9taXNlLnJlc29sdmUoKX1leGVjdXRlKGUsdCl7cmV0dXJuIGk9dGhpcyxuPXZvaWQgMCxyPWZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6aX09ZSxuPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7bzxuLmxlbmd0aDtvKyspdC5pbmRleE9mKG5bb10pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bb10pJiYoaVtuW29dXT1lW25bb11dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKTtpZighaSl0aHJvdyBuZXcgb2UoW1wicGF5bWVudFwiXSk7Y29uc3R7bWV0aG9kSWQ6byxnYXRld2F5SWQ6cn09aTt0cnl7Y29uc3QgZT17Zm9ybWF0dGVkUGF5bG9hZDp7dmF1bHRfcGF5bWVudF9pbnN0cnVtZW50Om51bGwsc2V0X2FzX2RlZmF1bHRfc3RvcmVkX2luc3RydW1lbnQ6bnVsbCxkZXZpY2VfaW5mbzpudWxsLG1ldGhvZF9pZDpvLHBheXBhbF9hY2NvdW50OntvcmRlcl9pZDp5aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlT3JkZXIoXCJiaWdjb21tZXJjZV9wYXltZW50c19hcG1zXCIse2dhdGV3YXlJZDpcImJpZ2NvbW1lcmNlX3BheW1lbnRzX2FwbXNcIixtZXRob2RJZDpvfSl9fX07eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKG4sdCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoe21ldGhvZElkOm8sZ2F0ZXdheUlkOnIscGF5bWVudERhdGE6ZX0pfWNhdGNoKGUpe2lmKGZ1bmN0aW9uKGUpe3ZhciB0LGk7cmV0dXJuKGU9Plwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmXCJib2R5XCJpbiBlKShlKSYmKG51bGw9PT0oaT1udWxsPT09KHQ9ZS5ib2R5KXx8dm9pZCAwPT09dD92b2lkIDA6dC5hZGRpdGlvbmFsX2FjdGlvbl9yZXF1aXJlZCl8fHZvaWQgMD09PWk/dm9pZCAwOmkuZGF0YS5yZWRpcmVjdF91cmwpfShlKSl7Y29uc3QgdD1lLmJvZHkuYWRkaXRpb25hbF9hY3Rpb25fcmVxdWlyZWQuZGF0YS5yZWRpcmVjdF91cmw7cmV0dXJuIG5ldyBQcm9taXNlKChlLGkpPT57d2luZG93LmxvY2F0aW9uLnJlcGxhY2UodCksaSgpfSl9cmV0dXJuIHRoaXMuaGFuZGxlRXJyb3IoZSksUHJvbWlzZS5yZWplY3QoZSl9fSxuZXcoKG89dm9pZCAwKXx8KG89UHJvbWlzZSkpKGZ1bmN0aW9uKGUsdCl7ZnVuY3Rpb24gYShlKXt0cnl7ZChyLm5leHQoZSkpfWNhdGNoKGUpe3QoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qoci50aHJvdyhlKSl9Y2F0Y2goZSl7dChlKX19ZnVuY3Rpb24gZCh0KXt2YXIgaTt0LmRvbmU/ZSh0LnZhbHVlKTooaT10LnZhbHVlLGkgaW5zdGFuY2VvZiBvP2k6bmV3IG8oZnVuY3Rpb24oZSl7ZShpKX0pKS50aGVuKGEscyl9ZCgocj1yLmFwcGx5KGksbnx8W10pKS5uZXh0KCkpfSk7dmFyIGksbixvLHJ9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IGFlKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9aGFuZGxlRXJyb3IoZSl7Y29uc3R7b25FcnJvcjp0fT10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNBbHRlcm5hdGl2ZU1ldGhvZHN8fHt9O3QmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQmJnQoZSl9fWNvbnN0IGl0PW0oZT0+bmV3IHR0KGUsRChlKSksW3tnYXRld2F5OlwiYmlnY29tbWVyY2VfcGF5bWVudHNfYXBtc1wiLGlkOlwia2xhcm5hXCJ9LHtnYXRld2F5OlwiYmlnY29tbWVyY2VfcGF5bWVudHNfYXBtc1wiLGlkOlwiYWZ0ZXJwYXlcIn1dKTt2YXIgbnQ9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24obyxyKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7cihlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtyKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9vKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3Mgb3R7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZT10LHRoaXMubG9hZGluZ0luZGljYXRvcj1pfWluaXRpYWxpemUoZSl7dmFyIHQsaTtyZXR1cm4gbnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e21ldGhvZElkOm4sYmlnY29tbWVyY2VfcGF5bWVudHNfdmVubW86b309ZXx8e307aWYoIW4pdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIW8pdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYmlnY29tbWVyY2VfcGF5bWVudHNfdmVubW9cIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKG4pO2NvbnN0IHI9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3cobik7KG51bGw9PT0odD1yLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQub3JkZXJJZCk/dGhpcy5vcmRlcklkPW51bGw9PT0oaT1yLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PWk/dm9pZCAwOmkub3JkZXJJZDooeWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXlQYWxTZGsobiksdGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyPW8uY29udGFpbmVyLnNwbGl0KFwiI1wiKVsxXSx0aGlzLnJlbmRlckJ1dHRvbihuLG8pKX0pfWV4ZWN1dGUoZSx0KXtyZXR1cm4gbnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6aX09ZSxuPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7bzxuLmxlbmd0aDtvKyspdC5pbmRleE9mKG5bb10pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bb10pJiYoaVtuW29dXT1lW25bb11dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKTtpZighaSl0aHJvdyBuZXcgb2UoW1wicGF5bWVudFwiXSk7aWYoIXRoaXMub3JkZXJJZCl0aHJvdyBuZXcgcmU7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKG4sdCkseWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoaS5tZXRob2RJZCx0aGlzLm9yZGVySWQpfSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IGFlKX1kZWluaXRpYWxpemUoKXt2YXIgZTtyZXR1cm4gdGhpcy5vcmRlcklkPXZvaWQgMCxudWxsPT09KGU9dGhpcy5wYXlwYWxCdXR0b24pfHx2b2lkIDA9PT1lfHxlLmNsb3NlKCksUHJvbWlzZS5yZXNvbHZlKCl9cmVuZGVyQnV0dG9uKGUsdCl7Y29uc3QgaT10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5UGFsU2RrT3JUaHJvdygpLG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSkse3BheW1lbnRCdXR0b25TdHlsZXM6b309bi5pbml0aWFsaXphdGlvbkRhdGF8fHt9LHtjaGVja291dFBheW1lbnRCdXR0b25TdHlsZXM6cn09b3x8e30se2NvbnRhaW5lcjphLG9uRXJyb3I6cyxvblJlbmRlckJ1dHRvbjpkLG9uVmFsaWRhdGU6bCxzdWJtaXRGb3JtOmN9PXQsbT17ZnVuZGluZ1NvdXJjZTppLkZVTkRJTkcuVkVOTU8sc3R5bGU6dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmdldFZhbGlkQnV0dG9uU3R5bGUociksY3JlYXRlT3JkZXI6KCk9PnRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5jcmVhdGVPcmRlcihcImJpZ2NvbW1lcmNlX3BheW1lbnRzX3Zlbm1vY2hlY2tvdXRcIiksb25DbGljazooZSx0KT0+dGhpcy5oYW5kbGVDbGljayh0LGwpLG9uQXBwcm92ZTplPT50aGlzLmhhbmRsZUFwcHJvdmUoZSxjKSxvbkNhbmNlbDooKT0+dGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKSxvbkVycm9yOmU9PnRoaXMuaGFuZGxlRXJyb3IoZSxzKX07aWYodGhpcy5wYXlwYWxCdXR0b249aS5CdXR0b25zKG0pLCF0aGlzLnBheXBhbEJ1dHRvbi5pc0VsaWdpYmxlKCkpdGhyb3cgbmV3IEJlKFwiVmVubW8gaXMgbm90IGF2YWlsYWJsZSBmb3IgeW91ciByZWdpb24uIFBsZWFzZSBhbm90aGVyIHBheW1lbnQgbWV0aG9kIGluc3RlYWQuXCIpO2QmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGQmJmQoKSx0aGlzLnBheXBhbEJ1dHRvbi5yZW5kZXIoYSl9aGFuZGxlQ2xpY2soZSx0KXtyZXR1cm4gbnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3Jlc29sdmU6aSxyZWplY3Q6bn09ZTt5aWVsZCB0KCgpPT4odGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCEwKSxpKCkpLG4pfSl9aGFuZGxlQXBwcm92ZSh7b3JkZXJJRDplfSx0KXt0aGlzLm9yZGVySWQ9ZSx0KCksdGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKX1oYW5kbGVFcnJvcihlLHQpe3RoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdCYmdChlKX10b2dnbGVMb2FkaW5nSW5kaWNhdG9yKGUpe2UmJnRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj90aGlzLmxvYWRpbmdJbmRpY2F0b3Iuc2hvdyh0aGlzLmxvYWRpbmdJbmRpY2F0b3JDb250YWluZXIpOnRoaXMubG9hZGluZ0luZGljYXRvci5oaWRlKCl9fWNvbnN0IHJ0PW0oZT0+bmV3IG90KGUsRChlKSxuZXcgaWUoe3N0eWxlczp7YmFja2dyb3VuZENvbG9yOlwiYmxhY2tcIn19KSksW3tpZDpcImJpZ2NvbW1lcmNlX3BheW1lbnRzX3Zlbm1vXCJ9XSk7dmFyIGF0PWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8scil7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe3IoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7cihlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIHN0e2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlPXQsdGhpcy5vbkVycm9yPWF9aW5pdGlhbGl6ZShlKXtyZXR1cm4gYXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2JpZ2NvbW1lcmNlX3BheW1lbnRzOnQsbWV0aG9kSWQ6aX09ZTtpZighaSl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdCl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c1wiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdC5jb250YWluZXIpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYmlnY29tbWVyY2VfcGF5bWVudHMuY29udGFpbmVyXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKHQub25DbGljayYmXCJmdW5jdGlvblwiIT10eXBlb2YgdC5vbkNsaWNrKXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJpZ2NvbW1lcmNlX3BheW1lbnRzLm9uQ2xpY2tcIiBhcmd1bWVudCBpcyBub3QgYSBmdW5jdGlvbi4nKTt0aGlzLm9uRXJyb3I9dC5vbkVycm9yfHxhLHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2QoaSl8fCh5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSkpO2NvbnN0IG49eWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXlQYWxTZGsoaSk7biYmbi5CdXR0b25zJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLkJ1dHRvbnM/dGhpcy5yZW5kZXJCdXR0b24oaSx0KTpjb25zb2xlLmVycm9yKFwiW0JDIFBheVBhbF06IFBheVBhbCBCdXR0b24gY291bGQgbm90IGJlIHJlbmRlcmVkLCBkdWUgdG8gaXNzdWVzIHdpdGggbG9hZGluZyBQYXlQYWwgU0RLXCIpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfXNpZ25JbihlLHQpe3JldHVybiBhdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zaWduSW5DdXN0b21lcihlLHQpLFByb21pc2UucmVzb2x2ZSgpfSl9c2lnbk91dChlKXtyZXR1cm4gYXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbk91dEN1c3RvbWVyKGUpLFByb21pc2UucmVzb2x2ZSgpfSl9ZXhlY3V0ZVBheW1lbnRNZXRob2RDaGVja291dChlKXt2YXIgdDtyZXR1cm4gbnVsbD09PSh0PW51bGw9PWU/dm9pZCAwOmUuY29udGludWVXaXRoQ2hlY2tvdXRDYWxsYmFjayl8fHZvaWQgMD09PXR8fHQuY2FsbChlKSxQcm9taXNlLnJlc29sdmUoKX1yZW5kZXJCdXR0b24oZSx0KXtjb25zdHtjb250YWluZXI6aSxvbkNsaWNrOm4sb25Db21wbGV0ZTpvfT10LHI9dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheVBhbFNka09yVGhyb3coKSxhPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KGUpLHtpc0hvc3RlZENoZWNrb3V0RW5hYmxlZDpzLHBheW1lbnRCdXR0b25TdHlsZXM6ZH09YS5pbml0aWFsaXphdGlvbkRhdGF8fHt9LHtjaGVja291dFRvcEJ1dHRvblN0eWxlczpsfT1kfHx7fSxjPU9iamVjdC5hc3NpZ24oe2NyZWF0ZU9yZGVyOigpPT50aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlT3JkZXIoXCJiaWdjb21tZXJjZV9wYXltZW50c1wiKSxvbkFwcHJvdmU6KHtvcmRlcklEOnR9KT0+dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLnRva2VuaXplUGF5bWVudChlLHQpfSxuJiZ7b25DbGljazooKT0+bigpfSksbT17b25TaGlwcGluZ0FkZHJlc3NDaGFuZ2U6ZT0+dGhpcy5vblNoaXBwaW5nQWRkcmVzc0NoYW5nZShlKSxvblNoaXBwaW5nT3B0aW9uc0NoYW5nZTplPT50aGlzLm9uU2hpcHBpbmdPcHRpb25zQ2hhbmdlKGUpLG9uQXBwcm92ZToodCxpKT0+dGhpcy5vbkhvc3RlZENoZWNrb3V0QXBwcm92ZSh0LGksZSxvKX0sdT1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe2Z1bmRpbmdTb3VyY2U6ci5GVU5ESU5HLlBBWVBBTCxzdHlsZTp0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0VmFsaWRCdXR0b25TdHlsZShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sbCkse2hlaWdodDo0MH0pKX0sYykscyYmbSksaD1yLkJ1dHRvbnModSk7aC5pc0VsaWdpYmxlKCk/aC5yZW5kZXIoYCMke2l9YCk6dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQoaSl9b25Ib3N0ZWRDaGVja291dEFwcHJvdmUoZSx0LGksbil7cmV0dXJuIGF0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighZS5vcmRlcklEKXRocm93IG5ldyB5KGwuTWlzc2luZ09yZGVySWQpO2NvbnN0IG89dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKSxyPXlpZWxkIHQub3JkZXIuZ2V0KCk7dHJ5e2NvbnN0IHQ9dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmdldEJpbGxpbmdBZGRyZXNzRnJvbU9yZGVyRGV0YWlscyhyKTtpZih5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3ModCksby5saW5lSXRlbXMucGh5c2ljYWxJdGVtcy5sZW5ndGg+MCl7Y29uc3QgZT10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U2hpcHBpbmdBZGRyZXNzRnJvbU9yZGVyRGV0YWlscyhyKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlU2hpcHBpbmdBZGRyZXNzKGUpLHlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS51cGRhdGVPcmRlcigpfXlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcih7fSx7cGFyYW1zOnttZXRob2RJZDppfX0pLHlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGksZS5vcmRlcklEKSxuJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuJiZuKCl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX19KX1vblNoaXBwaW5nQWRkcmVzc0NoYW5nZShlKXtyZXR1cm4gYXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmdldEFkZHJlc3Moe2NpdHk6ZS5zaGlwcGluZ0FkZHJlc3MuY2l0eSxjb3VudHJ5Q29kZTplLnNoaXBwaW5nQWRkcmVzcy5jb3VudHJ5Q29kZSxwb3N0YWxDb2RlOmUuc2hpcHBpbmdBZGRyZXNzLnBvc3RhbENvZGUsc3RhdGVPclByb3ZpbmNlQ29kZTplLnNoaXBwaW5nQWRkcmVzcy5zdGF0ZX0pO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3ModCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVNoaXBwaW5nQWRkcmVzcyh0KTtjb25zdCBlPXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRTaGlwcGluZ09wdGlvbk9yVGhyb3coKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2VsZWN0U2hpcHBpbmdPcHRpb24oZS5pZCkseWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZU9yZGVyKCl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX19KX1vblNoaXBwaW5nT3B0aW9uc0NoYW5nZShlKXtyZXR1cm4gYXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmdldFNoaXBwaW5nT3B0aW9uT3JUaHJvdyhlLnNlbGVjdGVkU2hpcHBpbmdPcHRpb24uaWQpO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2VsZWN0U2hpcHBpbmdPcHRpb24odC5pZCkseWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZU9yZGVyKCl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX19KX1oYW5kbGVFcnJvcihlKXtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiB0aGlzLm9uRXJyb3IpdGhyb3cgZTt0aGlzLm9uRXJyb3IoZSl9fWNvbnN0IGR0PW0oZT0+bmV3IHN0KGUsRChlKSksW3tpZDpcImJpZ2NvbW1lcmNlX3BheW1lbnRzXCJ9XSk7dmFyIGx0PWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8scil7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe3IoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7cihlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIGN0e2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNTZGs9dCx0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNGYXN0bGFuZVV0aWxzPWl9aW5pdGlhbGl6ZShlKXt2YXIgdDtyZXR1cm4gbHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e21ldGhvZElkOmksYmlnY29tbWVyY2VfcGF5bWVudHNfZmFzdGxhbmU6bn09ZTtpZighaSl0aHJvdyBuZXcgTignVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBcIm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSk7Y29uc3QgZT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxvPWUuZ2V0Q2FydE9yVGhyb3coKSxyPWUuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSksYT0hIShudWxsPT09KHQ9ci5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmlzRGV2ZWxvcGVyTW9kZUFwcGxpY2FibGUpLHM9eWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzU2RrLmdldFBheVBhbEZhc3RsYW5lU2RrKHIsby5jdXJyZW5jeS5jb2RlLG8uaWQpO3lpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0Zhc3RsYW5lVXRpbHMuaW5pdGlhbGl6ZVBheVBhbEZhc3RsYW5lKHMsYSx0aGlzLmdldEZhc3RsYW5lU3R5bGVzKGksbikpfWNhdGNoKGUpe31yZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gbHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKX0pfXNpZ25JbihlLHQpe3JldHVybiBsdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25JbkN1c3RvbWVyKGUsdCl9KX1zaWduT3V0KGUpe3JldHVybiBsdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25PdXRDdXN0b21lcihlKX0pfWV4ZWN1dGVQYXltZW50TWV0aG9kQ2hlY2tvdXQoZSl7cmV0dXJuIGx0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtjaGVja291dFBheW1lbnRNZXRob2RFeGVjdXRlZDp0LGNvbnRpbnVlV2l0aENoZWNrb3V0Q2FsbGJhY2s6aSxtZXRob2RJZDpufT1lfHx7fTtpZighbil0aHJvdyBuZXcgTignVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBcIm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIGkpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgXCJjb250aW51ZVdpdGhDaGVja291dENhbGxiYWNrXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkIGFuZCBpdCBtdXN0IGJlIGEgZnVuY3Rpb24uJyk7aWYodGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q3VzdG9tZXJPclRocm93KCkuaXNHdWVzdCl7dCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdCYmdCgpO3RyeXt5aWVsZCB0aGlzLnJ1blBheVBhbEF1dGhlbnRpY2F0aW9uRmxvd09yVGhyb3cobil9Y2F0Y2goZSl7fX1pKCl9KX1ydW5QYXlQYWxBdXRoZW50aWNhdGlvbkZsb3dPclRocm93KGUpe3JldHVybiBsdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxpPXQuZ2V0Q2FydE9yVGhyb3coKS5pZCxuPXQuZ2V0Q3VzdG9tZXIoKSxvPXQuZ2V0QmlsbGluZ0FkZHJlc3MoKSxyPShudWxsPT1uP3ZvaWQgMDpuLmVtYWlsKXx8KG51bGw9PW8/dm9pZCAwOm8uZW1haWwpfHxcIlwiLHtjdXN0b21lckNvbnRleHRJZDphfT15aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNGYXN0bGFuZVV0aWxzLmxvb2t1cEN1c3RvbWVyT3JUaHJvdyhyKSxzPXlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0Zhc3RsYW5lVXRpbHMudHJpZ2dlckF1dGhlbnRpY2F0aW9uRmxvd09yVGhyb3coYSksZD1zLmF1dGhlbnRpY2F0aW9uU3RhdGU9PT1TZS5DQU5DRUxFRDt5aWVsZCB0aGlzLnVwZGF0ZUN1c3RvbWVyRGF0YVN0YXRlKGUscyksZD90aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNGYXN0bGFuZVV0aWxzLnJlbW92ZVN0b3JhZ2VTZXNzaW9uSWQoKTp0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNGYXN0bGFuZVV0aWxzLnVwZGF0ZVN0b3JhZ2VTZXNzaW9uSWQoaSl9KX11cGRhdGVDdXN0b21lckRhdGFTdGF0ZShlLHQpe3ZhciBpO3JldHVybiBsdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDYXJ0T3JUaHJvdygpLHthdXRoZW50aWNhdGlvblN0YXRlOm8sYWRkcmVzc2VzOnIsYmlsbGluZ0FkZHJlc3M6YSxzaGlwcGluZ0FkZHJlc3M6cyxpbnN0cnVtZW50czpkfT10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNGYXN0bGFuZVV0aWxzLm1hcFBheVBhbEZhc3RsYW5lUHJvZmlsZVRvQmNDdXN0b21lckRhdGEoZSx0KTtpZih5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlUGF5bWVudFByb3ZpZGVyQ3VzdG9tZXIoe2F1dGhlbnRpY2F0aW9uU3RhdGU6byxhZGRyZXNzZXM6cixpbnN0cnVtZW50czpkfSksYSYmKHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVCaWxsaW5nQWRkcmVzcyhhKSkscyYmbi5saW5lSXRlbXMucGh5c2ljYWxJdGVtcy5sZW5ndGg+MCl7Y29uc3QgdD15aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlU2hpcHBpbmdBZGRyZXNzKHMpLG49dC5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKSx7aXNGYXN0bGFuZVNoaXBwaW5nT3B0aW9uQXV0b1NlbGVjdEVuYWJsZWQ6b309bi5pbml0aWFsaXphdGlvbkRhdGF8fHt9LHI9dC5nZXRDb25zaWdubWVudHMoKXx8W10sYT0obnVsbD09PShpPXJbMF0pfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmF2YWlsYWJsZVNoaXBwaW5nT3B0aW9ucyl8fFtdLGQ9YVswXSxsPWEuZmluZChlPT5lLmlzUmVjb21tZW5kZWQpO2lmKChsfHxkKSYmbyl7Y29uc3QgZT0obnVsbD09bD92b2lkIDA6bC5pZCl8fGQuaWQ7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNlbGVjdFNoaXBwaW5nT3B0aW9uKGUpfX19KX1nZXRGYXN0bGFuZVN0eWxlcyhlLHQpe2NvbnN0IGk9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSkse2Zhc3RsYW5lU3R5bGVzOm4saXNGYXN0bGFuZVN0eWxpbmdFbmFibGVkOm99PWkuaW5pdGlhbGl6YXRpb25EYXRhfHx7fTtyZXR1cm4ga2Uobz9uOnt9LG51bGw9PXQ/dm9pZCAwOnQuc3R5bGVzKX19Y29uc3QgbXQ9bShlPT5uZXcgY3QoZSwkKCksT2UoKSksW3tpZDpcImJpZ2NvbW1lcmNlX3BheW1lbnRzX2Zhc3RsYW5lXCJ9LHtpZDpcImJpZ2NvbW1lcmNlX3BheW1lbnRzX2NyZWRpdGNhcmRzXCJ9XSk7dmFyIHV0PWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8scil7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe3IoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7cihlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIGh0e2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlPXQsdGhpcy5vbkVycm9yPWF9aW5pdGlhbGl6ZShlKXtyZXR1cm4gdXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2JpZ2NvbW1lcmNlX3BheW1lbnRzX3BheWxhdGVyOnQsbWV0aG9kSWQ6aX09ZTtpZighaSl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdCl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c19wYXlsYXRlclwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdC5jb250YWluZXIpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYmlnY29tbWVyY2VfcGF5bWVudHNfcGF5bGF0ZXIuY29udGFpbmVyXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKHQub25DbGljayYmXCJmdW5jdGlvblwiIT10eXBlb2YgdC5vbkNsaWNrKXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJpZ2NvbW1lcmNlX3BheW1lbnRzX3BheWxhdGVyLm9uQ2xpY2tcIiBhcmd1bWVudCBpcyBub3QgYSBmdW5jdGlvbi4nKTt0aGlzLm9uRXJyb3I9dC5vbkVycm9yfHxhLHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2QoaSl8fCh5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSkpO2NvbnN0IG49eWllbGQgdGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXlQYWxTZGsoaSk7biYmbi5CdXR0b25zJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLkJ1dHRvbnM/dGhpcy5yZW5kZXJCdXR0b24oaSx0KTpjb25zb2xlLmVycm9yKFwiW0JDIEJpZ0NvbW1lcmNlUGF5bWVudHMgUGF5TGF0ZXJdOiBidXR0b24gY291bGQgbm90IGJlIHJlbmRlcmVkLCBkdWUgdG8gaXNzdWVzIHdpdGggbG9hZGluZyBQYXlQYWwgU0RLXCIpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfXNpZ25JbihlLHQpe3JldHVybiB1dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25JbkN1c3RvbWVyKGUsdCl9KX1zaWduT3V0KGUpe3JldHVybiB1dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25PdXRDdXN0b21lcihlKX0pfWV4ZWN1dGVQYXltZW50TWV0aG9kQ2hlY2tvdXQoZSl7dmFyIHQ7cmV0dXJuIG51bGw9PT0odD1udWxsPT1lP3ZvaWQgMDplLmNvbnRpbnVlV2l0aENoZWNrb3V0Q2FsbGJhY2spfHx2b2lkIDA9PT10fHx0LmNhbGwoZSksUHJvbWlzZS5yZXNvbHZlKCl9cmVuZGVyQnV0dG9uKGUsdCl7Y29uc3R7Y29udGFpbmVyOmksb25Db21wbGV0ZTpuLG9uQ2xpY2s6b309dCxyPXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRQYXlQYWxTZGtPclRocm93KCksYT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKSx7aXNIb3N0ZWRDaGVja291dEVuYWJsZWQ6cyxwYXltZW50QnV0dG9uU3R5bGVzOmR9PWEuaW5pdGlhbGl6YXRpb25EYXRhfHx7fSx7Y2hlY2tvdXRUb3BCdXR0b25TdHlsZXM6bH09ZHx8e30sYz1PYmplY3QuYXNzaWduKHtjcmVhdGVPcmRlcjooKT0+dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZU9yZGVyKFwiYmlnY29tbWVyY2VfcGF5bWVudHNfcGF5bGF0ZXJcIiksb25BcHByb3ZlOih7b3JkZXJJRDp0fSk9PnRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS50b2tlbml6ZVBheW1lbnQoZSx0KX0sbyYme29uQ2xpY2s6KCk9Pm8oKX0pLG09e29uU2hpcHBpbmdBZGRyZXNzQ2hhbmdlOmU9PnRoaXMub25TaGlwcGluZ0FkZHJlc3NDaGFuZ2UoZSksb25TaGlwcGluZ09wdGlvbnNDaGFuZ2U6ZT0+dGhpcy5vblNoaXBwaW5nT3B0aW9uc0NoYW5nZShlKSxvbkFwcHJvdmU6KHQsaSk9PnRoaXMub25Ib3N0ZWRDaGVja291dEFwcHJvdmUodCxpLGUsbil9LHU9W3IuRlVORElORy5QQVlMQVRFUixyLkZVTkRJTkcuQ1JFRElUXTtsZXQgaD0hMTt1LmZvckVhY2goZT0+e2lmKCFoKXtjb25zdCB0PU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7ZnVuZGluZ1NvdXJjZTplLHN0eWxlOnRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRWYWxpZEJ1dHRvblN0eWxlKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxsKSx7aGVpZ2h0OjQwfSkpfSxjKSxzJiZtKSxuPXIuQnV0dG9ucyh0KTtuLmlzRWxpZ2libGUoKSYmKG4ucmVuZGVyKGAjJHtpfWApLGg9ITApfX0pLGh8fHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KGkpfW9uSG9zdGVkQ2hlY2tvdXRBcHByb3ZlKGUsdCxpLG4pe3JldHVybiB1dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIWUub3JkZXJJRCl0aHJvdyBuZXcgeShsLk1pc3NpbmdPcmRlcklkKTtjb25zdCBvPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnRPclRocm93KCkscj15aWVsZCB0Lm9yZGVyLmdldCgpO3RyeXtjb25zdCB0PXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRCaWxsaW5nQWRkcmVzc0Zyb21PcmRlckRldGFpbHMocik7aWYoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZUJpbGxpbmdBZGRyZXNzKHQpLG8ubGluZUl0ZW1zLnBoeXNpY2FsSXRlbXMubGVuZ3RoPjApe2NvbnN0IGU9dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmdldFNoaXBwaW5nQWRkcmVzc0Zyb21PcmRlckRldGFpbHMocik7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVNoaXBwaW5nQWRkcmVzcyhlKSx5aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlT3JkZXIoKX15aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIoe30se3BhcmFtczp7bWV0aG9kSWQ6aX19KSx5aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChpLGUub3JkZXJJRCksbiYmXCJmdW5jdGlvblwiPT10eXBlb2YgbiYmbigpfWNhdGNoKGUpe3RoaXMuaGFuZGxlRXJyb3IoZSl9fSl9b25TaGlwcGluZ0FkZHJlc3NDaGFuZ2UoZSl7cmV0dXJuIHV0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRBZGRyZXNzKHtjaXR5OmUuc2hpcHBpbmdBZGRyZXNzLmNpdHksY291bnRyeUNvZGU6ZS5zaGlwcGluZ0FkZHJlc3MuY291bnRyeUNvZGUscG9zdGFsQ29kZTplLnNoaXBwaW5nQWRkcmVzcy5wb3N0YWxDb2RlLHN0YXRlT3JQcm92aW5jZUNvZGU6ZS5zaGlwcGluZ0FkZHJlc3Muc3RhdGV9KTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZUJpbGxpbmdBZGRyZXNzKHQpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVTaGlwcGluZ0FkZHJlc3ModCk7Y29uc3QgZT10aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U2hpcHBpbmdPcHRpb25PclRocm93KCk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNlbGVjdFNoaXBwaW5nT3B0aW9uKGUuaWQpLHlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS51cGRhdGVPcmRlcigpfWNhdGNoKGUpe3RoaXMuaGFuZGxlRXJyb3IoZSl9fSl9b25TaGlwcGluZ09wdGlvbnNDaGFuZ2UoZSl7cmV0dXJuIHV0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5nZXRTaGlwcGluZ09wdGlvbk9yVGhyb3coZS5zZWxlY3RlZFNoaXBwaW5nT3B0aW9uLmlkKTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNlbGVjdFNoaXBwaW5nT3B0aW9uKHQuaWQpLHlpZWxkIHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS51cGRhdGVPcmRlcigpfWNhdGNoKGUpe3RoaXMuaGFuZGxlRXJyb3IoZSl9fSl9aGFuZGxlRXJyb3IoZSl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgdGhpcy5vbkVycm9yKXRocm93IGU7dGhpcy5vbkVycm9yKGUpfX1jb25zdCB5dD1tKGU9Pm5ldyBodChlLEQoZSkpLFt7aWQ6XCJiaWdjb21tZXJjZV9wYXltZW50c19wYXlsYXRlclwifV0pO3ZhciBwdD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihvLHIpe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtyKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe3IoZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP28oZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBndHtjb25zdHJ1Y3RvcihlLHQpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZT10fWluaXRpYWxpemUoZSl7cmV0dXJuIHB0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtiaWdjb21tZXJjZV9wYXltZW50c192ZW5tbzp0LG1ldGhvZElkOml9PWU7aWYoIWkpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQpdGhyb3cgbmV3IE4oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYmlnY29tbWVyY2VfcGF5bWVudHNfdmVubW9cIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQuY29udGFpbmVyKXRocm93IG5ldyBOKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJpZ2NvbW1lcmNlX3BheW1lbnRzX3Zlbm1vLmNvbnRhaW5lclwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZih0Lm9uQ2xpY2smJlwiZnVuY3Rpb25cIiE9dHlwZW9mIHQub25DbGljayl0aHJvdyBuZXcgTignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5iaWdjb21tZXJjZV9wYXltZW50c192ZW5tby5vbkNsaWNrXCIgYXJndW1lbnQgaXMgbm90IGEgZnVuY3Rpb24uJyk7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZChpKXx8KHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKSk7Y29uc3Qgbj15aWVsZCB0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheVBhbFNkayhpKTtuJiZuLkJ1dHRvbnMmJlwiZnVuY3Rpb25cIj09dHlwZW9mIG4uQnV0dG9ucz90aGlzLnJlbmRlckJ1dHRvbihpLHQpOmNvbnNvbGUuZXJyb3IoXCJbQkMgUGF5bWVudHMgVmVubW9dOiBCdXR0b24gY291bGQgbm90IGJlIHJlbmRlcmVkLCBkdWUgdG8gaXNzdWVzIHdpdGggbG9hZGluZyBQYXlQYWwgU0RLXCIpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfXNpZ25JbihlLHQpe3JldHVybiBwdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25JbkN1c3RvbWVyKGUsdCl9KX1zaWduT3V0KGUpe3JldHVybiBwdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25PdXRDdXN0b21lcihlKX0pfWV4ZWN1dGVQYXltZW50TWV0aG9kQ2hlY2tvdXQoZSl7dmFyIHQ7cmV0dXJuIG51bGw9PT0odD1udWxsPT1lP3ZvaWQgMDplLmNvbnRpbnVlV2l0aENoZWNrb3V0Q2FsbGJhY2spfHx2b2lkIDA9PT10fHx0LmNhbGwoZSksUHJvbWlzZS5yZXNvbHZlKCl9cmVuZGVyQnV0dG9uKGUsdCl7Y29uc3R7Y29udGFpbmVyOmksb25DbGljazpufT10LG89dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheVBhbFNka09yVGhyb3coKSxyPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KGUpLHtwYXltZW50QnV0dG9uU3R5bGVzOmF9PXIuaW5pdGlhbGl6YXRpb25EYXRhfHx7fSx7Y2hlY2tvdXRUb3BCdXR0b25TdHlsZXM6c309YXx8e30sZD1PYmplY3QuYXNzaWduKHtmdW5kaW5nU291cmNlOm8uRlVORElORy5WRU5NTyxzdHlsZTp0aGlzLmJpZ0NvbW1lcmNlUGF5bWVudHNJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0VmFsaWRCdXR0b25TdHlsZShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scykse2hlaWdodDo0MH0pKSxjcmVhdGVPcmRlcjooKT0+dGhpcy5iaWdDb21tZXJjZVBheW1lbnRzSW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZU9yZGVyKFwiYmlnY29tbWVyY2VfcGF5bWVudHNfdmVubW9cIiksb25BcHByb3ZlOih7b3JkZXJJRDp0fSk9PnRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS50b2tlbml6ZVBheW1lbnQoZSx0KX0sbiYme29uQ2xpY2s6KCk9Pm4oKX0pLGw9by5CdXR0b25zKGQpO2wuaXNFbGlnaWJsZSgpP2wucmVuZGVyKGAjJHtpfWApOnRoaXMuYmlnQ29tbWVyY2VQYXltZW50c0ludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KGkpfX1jb25zdCB2dD1tKGU9Pm5ldyBndChlLEQoZSkpLFt7aWQ6XCJiaWdjb21tZXJjZV9wYXltZW50c192ZW5tb1wifV0pO2V4cG9ydHtKIGFzIGNyZWF0ZUJpZ0NvbW1lcmNlUGF5bWVudHNBbHRlcm5hdGl2ZU1ldGhvZHNCdXR0b25TdHJhdGVneSxldCBhcyBjcmVhdGVCaWdDb21tZXJjZVBheW1lbnRzQWx0ZXJuYXRpdmVNZXRob2RzUGF5bWVudFN0cmF0ZWd5LFYgYXMgY3JlYXRlQmlnQ29tbWVyY2VQYXltZW50c0J1dHRvblN0cmF0ZWd5LFhlIGFzIGNyZWF0ZUJpZ0NvbW1lcmNlUGF5bWVudHNDcmVkaXRDYXJkc1BheW1lbnRTdHJhdGVneSxkdCBhcyBjcmVhdGVCaWdDb21tZXJjZVBheW1lbnRzQ3VzdG9tZXJTdHJhdGVneSxtdCBhcyBjcmVhdGVCaWdDb21tZXJjZVBheW1lbnRzRmFzdGxhbmVDdXN0b21lclN0cmF0ZWd5LEZlIGFzIGNyZWF0ZUJpZ0NvbW1lcmNlUGF5bWVudHNGYXN0bGFuZVBheW1lbnRTdHJhdGVneSxZIGFzIGNyZWF0ZUJpZ0NvbW1lcmNlUGF5bWVudHNQYXlMYXRlckJ1dHRvblN0cmF0ZWd5LHl0IGFzIGNyZWF0ZUJpZ0NvbW1lcmNlUGF5bWVudHNQYXlMYXRlckN1c3RvbWVyU3RyYXRlZ3ksRGUgYXMgY3JlYXRlQmlnQ29tbWVyY2VQYXltZW50c1BheUxhdGVyUGF5bWVudFN0cmF0ZWd5LHVlIGFzIGNyZWF0ZUJpZ0NvbW1lcmNlUGF5bWVudHNQYXltZW50U3RyYXRlZ3ksVmUgYXMgY3JlYXRlQmlnQ29tbWVyY2VQYXltZW50c1JhdGVQYXlQYXlQYXltZW50U3RyYXRlZ3ksaXQgYXMgY3JlYXRlQmlnQ29tbWVyY2VQYXltZW50c1JlZGlyZWN0QWx0ZXJuYXRpdmVNZXRob2RzUGF5bWVudFN0cmF0ZWd5LFEgYXMgY3JlYXRlQmlnQ29tbWVyY2VQYXltZW50c1Zlbm1vQnV0dG9uU3RyYXRlZ3ksdnQgYXMgY3JlYXRlQmlnQ29tbWVyY2VQYXltZW50c1Zlbm1vQ3VzdG9tZXJTdHJhdGVneSxydCBhcyBjcmVhdGVCaWdDb21tZXJjZVBheW1lbnRzVmVubW9QYXltZW50U3RyYXRlZ3l9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmlnY29tbWVyY2UtcGF5bWVudHMuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///../checkout-sdk-js/dist/esm/integrations/bigcommerce-payments.js\n\n}");

/***/ })

}]);