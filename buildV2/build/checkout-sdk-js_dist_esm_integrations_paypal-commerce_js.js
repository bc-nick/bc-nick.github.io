"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonpCheckout"] = self["webpackJsonpCheckout"] || []).push([["checkout-sdk-js_dist_esm_integrations_paypal-commerce_js"],{

/***/ "../checkout-sdk-js/dist/esm/integrations/paypal-commerce.js":
/*!*******************************************************************!*\
  !*** ../checkout-sdk-js/dist/esm/integrations/paypal-commerce.js ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createPayPalCommerceAlternativeMethodsButtonStrategy: () => (/* binding */ ye),\n/* harmony export */   createPayPalCommerceAlternativeMethodsPaymentStrategy: () => (/* binding */ Re),\n/* harmony export */   createPayPalCommerceButtonStrategy: () => (/* binding */ V),\n/* harmony export */   createPayPalCommerceCreditButtonStrategy: () => (/* binding */ de),\n/* harmony export */   createPayPalCommerceCreditCardsPaymentStrategy: () => (/* binding */ nt),\n/* harmony export */   createPayPalCommerceCreditCustomerStrategy: () => (/* binding */ ft),\n/* harmony export */   createPayPalCommerceCreditPaymentStrategy: () => (/* binding */ De),\n/* harmony export */   createPayPalCommerceCustomerStrategy: () => (/* binding */ mt),\n/* harmony export */   createPayPalCommerceFastlaneCustomerStrategy: () => (/* binding */ Ct),\n/* harmony export */   createPayPalCommerceFastlanePaymentStrategy: () => (/* binding */ ut),\n/* harmony export */   createPayPalCommercePaymentStrategy: () => (/* binding */ ze),\n/* harmony export */   createPayPalCommerceRatePayPaymentStrategy: () => (/* binding */ rt),\n/* harmony export */   createPayPalCommerceVenmoButtonStrategy: () => (/* binding */ pe),\n/* harmony export */   createPayPalCommerceVenmoCustomerStrategy: () => (/* binding */ wt),\n/* harmony export */   createPayPalCommerceVenmoPaymentStrategy: () => (/* binding */ _e)\n/* harmony export */ });\n/* harmony import */ var _bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @bigcommerce/form-poster */ \"../checkout-sdk-js/node_modules/@bigcommerce/form-poster/lib/index.js\");\n/* harmony import */ var _bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @bigcommerce/request-sender */ \"../checkout-sdk-js/node_modules/@bigcommerce/request-sender/esm/index.js\");\n/* harmony import */ var _bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @bigcommerce/script-loader */ \"../checkout-sdk-js/node_modules/@bigcommerce/script-loader/lib/index.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! lodash */ \"../checkout-sdk-js/node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_3__);\nvar l,c={};function p(e,t){return Object.assign(e,{resolveIds:t})}c.d=(e,t)=>{for(var i in t)c.o(t,i)&&!c.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);class u extends Error{constructor(e){var t;super(e||\"An unexpected error has occurred.\"),this.name=\"StandardError\",this.type=\"standard\",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,\"function\"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class h extends u{constructor(e){super(e||\"Unable to proceed because the client library of a payment method is not loaded or ready to be used.\"),this.name=\"PaymentMethodClientUnavailableError\",this.type=\"payment_method_client_unavailable\"}}!function(e){e[e.MissingBillingAddress=0]=\"MissingBillingAddress\",e[e.MissingCart=1]=\"MissingCart\",e[e.MissingCheckout=2]=\"MissingCheckout\",e[e.MissingConsignments=3]=\"MissingConsignments\",e[e.MissingCustomer=4]=\"MissingCustomer\",e[e.MissingCheckoutConfig=5]=\"MissingCheckoutConfig\",e[e.MissingOrder=6]=\"MissingOrder\",e[e.MissingOrderConfig=7]=\"MissingOrderConfig\",e[e.MissingOrderId=8]=\"MissingOrderId\",e[e.MissingPayment=9]=\"MissingPayment\",e[e.MissingPaymentId=10]=\"MissingPaymentId\",e[e.MissingPaymentInstrument=11]=\"MissingPaymentInstrument\",e[e.MissingPaymentMethod=12]=\"MissingPaymentMethod\",e[e.MissingPaymentRedirectUrl=13]=\"MissingPaymentRedirectUrl\",e[e.MissingPaymentStatus=14]=\"MissingPaymentStatus\",e[e.MissingPaymentToken=15]=\"MissingPaymentToken\",e[e.MissingShippingAddress=16]=\"MissingShippingAddress\"}(l||(l={}));class y extends u{constructor(e){super(function(e){switch(e){case l.MissingBillingAddress:return\"Unable to proceed because billing address data is unavailable.\";case l.MissingCart:return\"Unable to proceed because cart data is unavailable.\";case l.MissingConsignments:return\"Unable to proceed because consignments data is unavailable.\";case l.MissingCheckout:return\"Unable to proceed because checkout data is unavailable.\";case l.MissingCustomer:return\"Unable to proceed because customer data is unavailable.\";case l.MissingCheckoutConfig:case l.MissingOrderConfig:return\"Unable to proceed because configuration data is unavailable.\";case l.MissingOrder:return\"Unable to proceed because order data is unavailable.\";case l.MissingOrderId:return\"Unable to proceed because order ID is unavailable or not generated yet.\";case l.MissingPayment:return\"Unable to proceed because payment data is unavailable.\";case l.MissingPaymentToken:return\"Unable to proceed because the token required to submit a payment is missing.\";case l.MissingPaymentMethod:return\"Unable to proceed because payment method data is unavailable or not properly configured.\";case l.MissingShippingAddress:return\"Unable to proceed because shipping address data is unavailable.\";default:return\"Unable to proceed because the required data is unavailable.\"}}(e)),this.subtype=e,this.name=\"MissingDataError\",this.type=\"missing_data\"}}class m extends u{constructor(e){super(e||\"An unexpected error has occurred during buy now cart creation process. Please try again later.\"),this.name=\"BuyNowCartCreationError\",this.type=\"buy_now_cart_creation_error\"}}const g={body:{},headers:{},status:0};class v extends u{constructor(e,{message:t,errors:i}={}){const{body:n,headers:o,status:a}=e||g;super(t||\"An unexpected error has occurred.\"),this.name=\"RequestError\",this.type=\"request\",this.body=n,this.headers=o,this.status=a,this.errors=i||[]}}var f,S,I,w,b,P,C,O;!function(e){e.BuyNow=\"BUY_NOW\"}(f||(f={})),function(e){e.Possible=\"POSSIBLE\",e.No=\"NO\",e.Unknown=\"UNKNOWN\",e.Yes=\"YES\"}(S||(S={})),function(e){e.AUTHORIZE=\"authorize\",e.CAPTURE=\"capture\"}(I||(I={})),function(e){e.paypal=\"paypal\",e.checkout=\"checkout\",e.buynow=\"buynow\",e.pay=\"pay\",e.installment=\"installment\"}(w||(w={})),function(e){e.gold=\"gold\",e.blue=\"blue\",e.silver=\"silver\",e.black=\"black\",e.white=\"white\"}(b||(b={})),function(e){e.pill=\"pill\",e.rect=\"rect\"}(P||(P={})),function(e){e.OXXO=\"oxxo\",e.IDEAL=\"ideal\"}(C||(C={})),function(e){e.Approved=\"APPROVED\",e.Created=\"CREATED\",e.PayerActionRequired=\"PAYER_ACTION_REQUIRED\",e.PollingStop=\"POLLING_STOP\",e.PollingError=\"POLLING_ERROR\"}(O||(O={}));var k=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class A{constructor(e,t,i,n){this.formPoster=e,this.paymentIntegrationService=t,this.paypalCommerceRequestSender=i,this.paypalCommerceScriptLoader=n}loadPayPalSdk(e,t,i,n){return k(this,void 0,void 0,function*(){const o=this.paymentIntegrationService.getState(),a=t||o.getCartOrThrow().currency.code,r=o.getPaymentMethodOrThrow(e);return this.paypalSdk=yield this.paypalCommerceScriptLoader.getPayPalSDK(r,a,i,n),this.paypalSdk})}getPayPalSdkOrThrow(){if(!this.paypalSdk)throw new h;return this.paypalSdk}createBuyNowCartOrThrow(e){return k(this,void 0,void 0,function*(){const t=e.getBuyNowCartRequestBody();if(!t)throw new y(l.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(t)}catch(e){throw new m}})}createOrder(e,t){return k(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState().getCartOrThrow().id,{orderId:n}=yield this.paypalCommerceRequestSender.createOrder(e,Object.assign({cartId:i},t));return n})}createOrderCardFields(e,t){return k(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState().getCartOrThrow().id,{orderId:n,setupToken:o}=yield this.paypalCommerceRequestSender.createOrder(e,Object.assign({cartId:i},t));return Object.assign({orderId:n},o?{setupToken:o}:{})})}updateOrder(){return k(this,void 0,void 0,function*(){const e=this.paymentIntegrationService.getState(),t=e.getCartOrThrow(),i=e.getConsignmentsOrThrow()[0];try{yield this.paypalCommerceRequestSender.updateOrder({availableShippingOptions:i.availableShippingOptions,cartId:t.id,selectedShippingOption:i.selectedShippingOption})}catch(e){throw new v}})}getOrderStatus(e,t){return k(this,void 0,void 0,function*(){try{const{status:i}=yield this.paypalCommerceRequestSender.getOrderStatus(e,t);return i}catch(e){throw new v}})}tokenizePayment(e,t){const i=this.paymentIntegrationService.getState().getCartOrThrow();if(!t)throw new y(l.MissingOrderId);return this.formPoster.postForm(\"/checkout.php\",Object.assign({payment_type:\"paypal\",action:\"set_external_checkout\",provider:e,order_id:t},i.source===f.BuyNow&&{cart_id:i.id}))}submitPayment(e,t,i){return k(this,void 0,void 0,function*(){const n={formattedPayload:{vault_payment_instrument:null,set_as_default_stored_instrument:null,device_info:null,method_id:e,paypal_account:{order_id:t}}};yield this.paymentIntegrationService.submitPayment(Object.assign({methodId:e,paymentData:n},i?{gatewayId:i}:{}))})}getShippingOptionOrThrow(e){const t=this.paymentIntegrationService.getState().getConsignmentsOrThrow()[0],i=t.availableShippingOptions||[],n=i.find(e=>e.isRecommended),o=(e?i.find(t=>t.id===e):i.find(e=>{var i;return e.id===(null===(i=t.selectedShippingOption)||void 0===i?void 0:i.id)}))||n||i[0];if(!o)throw new Error(\"Your order can't be shipped to this address\");return o}getAddress(e){return{firstName:(null==e?void 0:e.firstName)||\"\",lastName:(null==e?void 0:e.lastName)||\"\",email:(null==e?void 0:e.email)||\"\",phone:(null==e?void 0:e.phone)||\"\",company:\"\",address1:(null==e?void 0:e.address1)||\"\",address2:(null==e?void 0:e.address2)||\"\",city:(null==e?void 0:e.city)||\"\",countryCode:(null==e?void 0:e.countryCode)||\"\",postalCode:(null==e?void 0:e.postalCode)||\"\",stateOrProvince:\"\",stateOrProvinceCode:(null==e?void 0:e.stateOrProvinceCode)||\"\",customFields:[]}}getBillingAddressFromOrderDetails({payer:e}){var t,i;return this.getAddress({firstName:e.name.given_name,lastName:e.name.surname,email:e.email_address,address1:e.address.address_line_1,address2:e.address.address_line_2,city:e.address.admin_area_2,countryCode:e.address.country_code,postalCode:e.address.postal_code,stateOrProvinceCode:e.address.admin_area_1,phone:null===(i=null===(t=e.phone)||void 0===t?void 0:t.phone_number)||void 0===i?void 0:i.national_number})}getShippingAddressFromOrderDetails(e){const{payer:t,purchase_units:i}=e,{address:n,name:{full_name:o}}=i[0].shipping,[a,...r]=o.split(\" \");return this.getAddress({firstName:a,lastName:r.join(\" \"),email:t.email_address,address1:n.address_line_1,address2:n.address_line_2,city:n.admin_area_2,countryCode:n.country_code,postalCode:n.postal_code,stateOrProvinceCode:n.admin_area_1})}getValidButtonStyle(e){const{color:t,height:i,label:n,shape:o}=e||{},r={color:t&&b[t]?t:void 0,height:this.getValidHeight(i),label:n&&w[n]?n:void 0,shape:o&&P[o]?o:void 0};return (0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)(r,lodash__WEBPACK_IMPORTED_MODULE_3__.isNil)}getValidHeight(e){return e&&\"number\"==typeof e?e>55?55:e<25?25:e:40}removeElement(e){const t=e&&document.getElementById(e);t&&(t.style.display=\"none\")}}const E=\"This API endpoint is for internal use only and may change in the future\";var T;!function(e){e.Json=\"application/json\",e.JsonV1=\"application/vnd.bc.v1+json\"}(T||(T={}));const z=T,F={\"X-Checkout-SDK-Version\":\"1.867.0\"};var B=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class M{constructor(e){this.requestSender=e}createOrder(e,t){return B(this,void 0,void 0,function*(){const i=`/api/storefront/payment/${e}`,n=t,o=Object.assign({\"X-API-INTERNAL\":E,\"Content-Type\":z.Json},F);return(yield this.requestSender.post(i,{headers:o,body:n})).body})}updateOrder(e){return B(this,void 0,void 0,function*(){const t=e,i=Object.assign({\"X-API-INTERNAL\":E,\"Content-Type\":z.Json},F);return(yield this.requestSender.put(\"/api/storefront/initialization/paypalcommerce\",{headers:i,body:t})).body})}getOrderStatus(e=\"paypalcommerce\",t){return B(this,void 0,void 0,function*(){const i=`/api/storefront/initialization/${e}`,n=Object.assign({\"X-API-INTERNAL\":E,\"Content-Type\":z.Json},F);return(yield this.requestSender.get(i,Object.assign({headers:n},t))).body})}}var D=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class x{constructor(e){this.scriptLoader=e,this.window=window}getPayPalSDK(e,t,i,n){return D(this,void 0,void 0,function*(){const o=this.getPayPalSdkScriptConfigOrThrow(e,t,i);return this.loadPayPalSDK(o,n)})}loadPayPalSDK(e,t=!1){return D(this,void 0,void 0,function*(){if(!this.window.paypal||t){const t=this.transformConfig(e.options),i=this.transformConfig(e.attributes),n=`https://www.paypal.com/sdk/js?${new URLSearchParams(t).toString()}`;yield this.scriptLoader.loadScript(n,{async:!0,attributes:i})}if(!this.window.paypal)throw new h;return this.window.paypal})}getPayPalSdkScriptConfigOrThrow(e,t,i=!0){const{id:n,clientToken:o,initializationData:a}=e;if(!(null==a?void 0:a.clientId))throw new y(l.MissingPaymentMethod);const{intent:r,clientId:s,merchantId:d,buyerCountry:c,attributionId:p,isVenmoEnabled:u,isHostedCheckoutEnabled:h,isPayPalCreditAvailable:m,isDeveloperModeApplicable:g,availableAlternativePaymentMethods:v=[],enabledAlternativePaymentMethods:f=[],isGooglePayEnabled:S}=a,I=h||i,w=\"paypalcommercecreditcards\"===n,b=w?[\"card\"]:[],P=m?[\"credit\",\"paylater\"]:[],C=u?[\"venmo\"]:[],O=S?[\"googlepay\"]:[],k=i?[\"card-fields\"]:[],A=[...w?[]:[\"card\"],...m?[]:[\"credit\",\"paylater\"],...u?[]:[\"venmo\"],...v.filter(e=>!f.includes(e))],E=[...b,...P,...C,...f];return{options:Object.assign({\"client-id\":s,\"merchant-id\":d,\"enable-funding\":E.length>0?E:void 0,\"disable-funding\":A.length>0?A:void 0,commit:I,components:[\"buttons\",\"hosted-fields\",\"payment-fields\",\"legal\",...O,...k],currency:t,intent:r},g&&{\"buyer-country\":c}),attributes:{\"data-partner-attribution-id\":p,\"data-client-token\":o}}}transformConfig(e){let t={};return Object.keys(e).forEach(i=>{const n=e[i];null==n||\"\"===n||Array.isArray(n)&&0===n.length||(t=Object.assign(Object.assign({},t),{[i]:Array.isArray(n)?n.join(\",\"):n}))}),t}}const N=i=>{const{getHost:o}=i.getState();return new A((0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),i,new M((0,_bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_1__.createRequestSender)({host:o()})),new x((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_2__.getScriptLoader)()))};class _ extends u{constructor(e){super(e||\"Invalid arguments have been provided.\"),this.name=\"InvalidArgumentError\",this.type=\"invalid_argument\"}}var j=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class U{constructor(e,t){this.paymentIntegrationService=e,this.paypalCommerceIntegrationService=t}initialize(e){var t;return j(this,void 0,void 0,function*(){const{paypalcommerce:i,containerId:n,methodId:o}=e,a=Boolean(null==i?void 0:i.buyNowInitializeOptions);if(!o)throw new _('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!n)throw new _('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!i)throw new _('Unable to initialize payment because \"options.paypalcommerce\" argument is not provided.');if(a&&!i.currencyCode)throw new _('Unable to initialize payment because \"options.paypalcommerce.currencyCode\" argument is not provided.');if(a&&\"function\"!=typeof(null===(t=i.buyNowInitializeOptions)||void 0===t?void 0:t.getBuyNowCartRequestBody))throw new _('Unable to initialize payment because \"options.paypalcommerce.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.');a||(yield this.paymentIntegrationService.loadDefaultCheckout());const r=a?i.currencyCode:this.paymentIntegrationService.getState().getCartOrThrow().currency.code;yield this.paypalCommerceIntegrationService.loadPayPalSdk(o,r,!1),this.renderButton(n,o,i,a)})}deinitialize(){return Promise.resolve()}renderButton(e,t,i,n){var o,a;const{buyNowInitializeOptions:r,style:s,onComplete:d,onEligibilityFailure:l}=i,c=this.paypalCommerceIntegrationService.getPayPalSdkOrThrow(),p=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t),{isHostedCheckoutEnabled:u,isAppSwitchEnabled:h}=p.initializationData||{},y=Object.assign(Object.assign({},!n&&this.isPaypalCommerceAppSwitchEnabled(t)&&{appSwitchWhenAvailable:!0}),{createOrder:()=>this.paypalCommerceIntegrationService.createOrder(\"paypalcommerce\"),onApprove:({orderID:e})=>this.paypalCommerceIntegrationService.tokenizePayment(t,e)}),m={onClick:()=>this.handleClick(r),onCancel:()=>this.paymentIntegrationService.loadDefaultCheckout()},g=Object.assign(Object.assign({},!h&&{onShippingAddressChange:e=>this.onShippingAddressChange(e),onShippingOptionsChange:e=>this.onShippingOptionsChange(e)}),{onApprove:(e,i)=>this.onHostedCheckoutApprove(e,i,t,d)}),v=Object.assign(Object.assign(Object.assign({fundingSource:c.FUNDING.PAYPAL,style:this.paypalCommerceIntegrationService.getValidButtonStyle(s)},y),r&&m),u&&g),f=c.Buttons(v);f.isEligible()?(null===(o=f.hasReturned)||void 0===o?void 0:o.call(f))&&this.isPaypalCommerceAppSwitchEnabled(t)?null===(a=f.resume)||void 0===a||a.call(f):f.render(`#${e}`):l&&\"function\"==typeof l?l():this.paypalCommerceIntegrationService.removeElement(e)}handleClick(e){return j(this,void 0,void 0,function*(){if(e){const t=yield this.paypalCommerceIntegrationService.createBuyNowCartOrThrow(e);yield this.paymentIntegrationService.loadCheckout(t.id)}})}onHostedCheckoutApprove(e,t,i,n){return j(this,void 0,void 0,function*(){if(!e.orderID)throw new y(l.MissingOrderId);const o=this.paymentIntegrationService.getState().getCartOrThrow(),a=yield t.order.get();try{const t=this.paypalCommerceIntegrationService.getBillingAddressFromOrderDetails(a);if(yield this.paymentIntegrationService.updateBillingAddress(t),o.lineItems.physicalItems.length>0){const e=this.paypalCommerceIntegrationService.getShippingAddressFromOrderDetails(a);yield this.paymentIntegrationService.updateShippingAddress(e),yield this.paypalCommerceIntegrationService.updateOrder()}return yield this.paymentIntegrationService.submitOrder({},{params:{methodId:i}}),yield this.paypalCommerceIntegrationService.submitPayment(i,e.orderID),n&&\"function\"==typeof n&&n(),!0}catch(e){if(\"string\"==typeof e)throw new Error(e);throw e}})}onShippingAddressChange(e){return j(this,void 0,void 0,function*(){const t=this.paypalCommerceIntegrationService.getAddress({city:e.shippingAddress.city,countryCode:e.shippingAddress.countryCode,postalCode:e.shippingAddress.postalCode,stateOrProvinceCode:e.shippingAddress.state});try{yield this.paymentIntegrationService.updateBillingAddress(t),yield this.paymentIntegrationService.updateShippingAddress(t);const e=this.paypalCommerceIntegrationService.getShippingOptionOrThrow();yield this.paymentIntegrationService.selectShippingOption(e.id),yield this.paypalCommerceIntegrationService.updateOrder()}catch(e){if(\"string\"==typeof e)throw new Error(e);throw e}})}onShippingOptionsChange(e){return j(this,void 0,void 0,function*(){const t=this.paypalCommerceIntegrationService.getShippingOptionOrThrow(e.selectedShippingOption.id);try{yield this.paymentIntegrationService.selectShippingOption(t.id),yield this.paypalCommerceIntegrationService.updateOrder()}catch(e){if(\"string\"==typeof e)throw new Error(e);throw e}})}isPaypalCommerceAppSwitchEnabled(e){var t;return(null===(t=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e).initializationData)||void 0===t?void 0:t.isAppSwitchEnabled)||!1}}const V=p(e=>new U(e,N(e)),[{id:\"paypalcommerce\"}]);var R,L,$,q,G,H,Y,W,K,X,J=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class Z{constructor(e){this.scriptLoader=e,this.window=window}getPayPalSDK(e,t,i,n){return J(this,void 0,void 0,function*(){if(!this.window.paypal||n){const n=this.getPayPalSdkScriptConfigOrThrow(e,t,i);if(yield this.loadPayPalSdk(n),!this.window.paypal)throw new h}return this.window.paypal})}getPayPalFastlaneSdk(e,t,i){return J(this,void 0,void 0,function*(){if(!this.window.paypalFastlaneSdk){const n=this.getPayPalFastlaneSdkConfiguration(e,t,i);if(yield this.loadPayPalSdk(n),!this.window.paypalFastlaneSdk)throw new h}return this.window.paypalFastlaneSdk})}getPayPalGooglePaySdk(e,t,i,n){return J(this,void 0,void 0,function*(){if(!this.window.paypalGooglePay||n){const n=this.getPayPalGooglePaySdkScriptConfigOrThrow(e,t,i);yield this.loadPayPalSdk(n)}if(!this.window.paypalGooglePay)throw new h;return this.window.paypalGooglePay})}getPayPalApmsSdk(e,t){return J(this,void 0,void 0,function*(){if(!this.window.paypalApms){const i=this.getPayPalApmSdkConfiguration(e,t);if(yield this.loadPayPalSdk(i),!this.window.paypalApms)throw new h}return this.window.paypalApms})}getPayPalMessages(e,t){return J(this,void 0,void 0,function*(){if(!this.window.paypalMessages){const i=this.getPayPalSdkMessagesConfiguration(e,t);yield this.loadPayPalSdk(i)}if(!this.window.paypalMessages)throw new h;return this.window.paypalMessages})}loadPayPalSdk({options:e,attributes:t}){return J(this,void 0,void 0,function*(){const i=this.transformConfig(e),n=this.transformConfig(t),o=`https://www.paypal.com/sdk/js?${new URLSearchParams(i).toString()}`;yield this.scriptLoader.loadScript(o,{async:!0,attributes:n})})}getPayPalSdkScriptConfigOrThrow(e,t,i=!0){const{id:n,clientToken:o,initializationData:a}=e;if(!a||!a.clientId)throw new y(l.MissingPaymentMethod);const{intent:r,clientId:s,merchantId:d,buyerCountry:c,attributionId:p,isVenmoEnabled:u,isHostedCheckoutEnabled:h,isPayPalCreditAvailable:m,isDeveloperModeApplicable:g,availableAlternativePaymentMethods:v=[],enabledAlternativePaymentMethods:f=[],isGooglePayEnabled:S}=a,I=h||i,w=\"paypalcommercecreditcards\"===n||\"bigcommerce_payments_creditcards\"===n,b=w?[\"card\"]:[],P=m?[\"credit\",\"paylater\"]:[],C=u?[\"venmo\"]:[],O=S?[\"googlepay\"]:[],k=i?[\"card-fields\"]:[],A=[...w?[]:[\"card\"],...m?[]:[\"credit\",\"paylater\"],...u?[]:[\"venmo\"],...v.filter(e=>!f.includes(e))],E=[...b,...P,...C,...f];return{options:Object.assign({\"client-id\":s,\"merchant-id\":d,\"enable-funding\":E.length>0?E:void 0,\"disable-funding\":A.length>0?A:void 0,commit:I,components:[\"buttons\",\"hosted-fields\",\"payment-fields\",\"legal\",...O,...k],currency:t,intent:r},g&&{\"buyer-country\":c}),attributes:{\"data-partner-attribution-id\":p,\"data-client-token\":o}}}getPayPalFastlaneSdkConfiguration(e,t,i){const{clientToken:n,initializationData:o}=e;if(!o||!o.clientId)throw new y(l.MissingPaymentMethod);const{intent:a,clientId:r,merchantId:s,attributionId:d}=o;return{options:{\"client-id\":r,\"merchant-id\":s,commit:!0,components:[\"fastlane\",\"buttons\",\"payment-fields\",\"hosted-fields\",\"three-domain-secure\"],currency:t,intent:a},attributes:{\"data-client-metadata-id\":i.replace(/-/g,\"\"),\"data-namespace\":\"paypalFastlaneSdk\",\"data-partner-attribution-id\":d,\"data-sdk-client-token\":n}}}getPayPalGooglePaySdkScriptConfigOrThrow(e,t,i=!0){const{clientToken:n,initializationData:o}=e;if(!o||!o.clientId)throw new y(l.MissingPaymentMethod);const{intent:a,clientId:r,merchantId:s,buyerCountry:d,attributionId:c,isHostedCheckoutEnabled:p,isDeveloperModeApplicable:u}=o,h=p||i;return{options:Object.assign({\"client-id\":r,\"merchant-id\":s,commit:h,components:[\"googlepay\"],currency:t,intent:a},u&&{\"buyer-country\":d}),attributes:{\"data-partner-attribution-id\":c,\"data-client-token\":n,\"data-namespace\":\"paypalGooglePay\"}}}getPayPalApmSdkConfiguration(e,t){const{initializationData:i}=e;if(!i||!i.clientId)throw new y(l.MissingPaymentMethod);const{intent:n,clientId:o,merchantId:a,buyerCountry:r,attributionId:s,isDeveloperModeApplicable:d,availableAlternativePaymentMethods:c=[],enabledAlternativePaymentMethods:p=[]}=i,u=p,h=c.filter(e=>!p.includes(e));return{options:Object.assign({\"client-id\":o,\"merchant-id\":a,\"enable-funding\":u.length>0?u:void 0,\"disable-funding\":h.length>0?h:void 0,commit:!0,components:[\"buttons\",\"payment-fields\"],currency:t,intent:n},d&&{\"buyer-country\":r}),attributes:{\"data-partner-attribution-id\":s,\"data-namespace\":\"paypalApms\"}}}getPayPalSdkMessagesConfiguration(e,t){const{initializationData:i}=e;if(!i||!i.clientId)throw new y(l.MissingPaymentMethod);const{clientId:n,merchantId:o,attributionId:a,isDeveloperModeApplicable:r,buyerCountry:s}=i;return{options:Object.assign({\"client-id\":n,\"merchant-id\":o,components:[\"messages\"],currency:t},r&&{\"buyer-country\":s}),attributes:{\"data-namespace\":\"paypalMessages\",\"data-partner-attribution-id\":a}}}transformConfig(e){let t={};return Object.keys(e).forEach(i=>{const n=e[i];null==n||\"\"===n||Array.isArray(n)&&0===n.length||(t=Object.assign(Object.assign({},t),{[i]:Array.isArray(n)?n.join(\",\"):n}))}),t}}function Q(){return new Z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_2__.createScriptLoader)())}!function(e){e.AUTHORIZE=\"authorize\",e.CAPTURE=\"capture\"}(R||(R={})),function(e){e.Always=\"SCA_ALWAYS\"}(L||(L={})),function(e){e.Succeeded=\"succeeded\",e.Cancelled=\"cancelled\",e.Errored=\"errored\"}($||($={})),function(e){e.Possible=\"POSSIBLE\",e.No=\"NO\",e.Unknown=\"UNKNOWN\",e.Yes=\"YES\"}(q||(q={})),function(e){e.paypal=\"paypal\",e.checkout=\"checkout\",e.buynow=\"buynow\",e.pay=\"pay\",e.installment=\"installment\"}(G||(G={})),function(e){e.gold=\"gold\",e.blue=\"blue\",e.silver=\"silver\",e.black=\"black\",e.white=\"white\"}(H||(H={})),function(e){e.pill=\"pill\",e.rect=\"rect\"}(Y||(Y={})),function(e){e.SUCCEEDED=\"succeeded\",e.FAILED=\"failed\",e.CANCELED=\"canceled\",e.UNRECOGNIZED=\"unrecognized\"}(W||(W={})),(K||(K={})).OXXO=\"oxxo\",function(e){e.Approved=\"APPROVED\",e.Created=\"CREATED\",e.PayerActionRequired=\"PAYER_ACTION_REQUIRED\",e.PollingStop=\"POLLING_STOP\",e.PollingError=\"POLLING_ERROR\"}(X||(X={}));var ee=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class te{constructor(e,t,i,n){this.formPoster=e,this.paymentIntegrationService=t,this.paypalRequestSender=i,this.paypalSdkLoader=n}loadPayPalSdk(e,t,i,n){return ee(this,void 0,void 0,function*(){const o=this.paymentIntegrationService.getState(),a=t||o.getCartOrThrow().currency.code,r=o.getPaymentMethodOrThrow(e);return this.paypalSdk=yield this.paypalSdkLoader.getPayPalSDK(r,a,i,n),this.paypalSdk})}getPayPalSdkOrThrow(){if(!this.paypalSdk)throw new h;return this.paypalSdk}createBuyNowCartOrThrow(e){return ee(this,void 0,void 0,function*(){const t=e.getBuyNowCartRequestBody();if(!t)throw new y(l.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(t)}catch(e){throw new m}})}createOrder(e,t){return ee(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState().getCartOrThrow().id,{orderId:n}=yield this.paypalRequestSender.createOrder(e,Object.assign({cartId:i},t));return n})}createOrderCardFields(e,t){return ee(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState().getCartOrThrow().id,{orderId:n,setupToken:o}=yield this.paypalRequestSender.createOrder(e,Object.assign({cartId:i},t));return Object.assign({orderId:n},o?{setupToken:o}:{})})}updateOrder(e,t,i){return ee(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState(),o=n.getCartOrThrow(),a=n.getConsignmentsOrThrow()[0];try{yield this.paypalRequestSender.updateOrder(e,Object.assign(Object.assign({availableShippingOptions:a.availableShippingOptions,cartId:o.id,selectedShippingOption:a.selectedShippingOption},t?{methodId:t}:{}),i?{orderId:i}:{}))}catch(e){throw new v}})}getOrderStatus(e,t){return ee(this,void 0,void 0,function*(){try{const{status:i}=yield this.paypalRequestSender.getOrderStatus(e,t);return i}catch(e){throw new v}})}tokenizePayment(e,t){const i=this.paymentIntegrationService.getState().getCartOrThrow();if(!t)throw new y(l.MissingOrderId);return this.formPoster.postForm(\"/checkout.php\",Object.assign({payment_type:\"paypal\",action:\"set_external_checkout\",provider:e,order_id:t},i.source===f.BuyNow&&{cart_id:i.id}))}submitPayment(e,t,i){return ee(this,void 0,void 0,function*(){const n={formattedPayload:{vault_payment_instrument:null,set_as_default_stored_instrument:null,device_info:null,method_id:e,paypal_account:{order_id:t}}};yield this.paymentIntegrationService.submitPayment(Object.assign({methodId:e,paymentData:n},i?{gatewayId:i}:{}))})}getShippingOptionOrThrow(e){const t=this.paymentIntegrationService.getState().getConsignmentsOrThrow()[0],i=t.availableShippingOptions||[],n=i.find(e=>e.isRecommended),o=(e?i.find(t=>t.id===e):i.find(e=>{if(t.selectedShippingOption){const i=t.selectedShippingOption.id;return e.id===i}return!1}))||n||i[0];if(!o)throw new Error(\"Your order can't be shipped to this address\");return o}getAddress(e){return{firstName:(null==e?void 0:e.firstName)||\"\",lastName:(null==e?void 0:e.lastName)||\"\",email:(null==e?void 0:e.email)||\"\",phone:(null==e?void 0:e.phone)||\"\",company:\"\",address1:(null==e?void 0:e.address1)||\"\",address2:(null==e?void 0:e.address2)||\"\",city:(null==e?void 0:e.city)||\"\",countryCode:(null==e?void 0:e.countryCode)||\"\",postalCode:(null==e?void 0:e.postalCode)||\"\",stateOrProvince:\"\",stateOrProvinceCode:(null==e?void 0:e.stateOrProvinceCode)||\"\",customFields:[]}}getBillingAddressFromOrderDetails({payer:e}){var t,i;return this.getAddress({firstName:e.name.given_name,lastName:e.name.surname,email:e.email_address,address1:e.address.address_line_1,address2:e.address.address_line_2,city:e.address.admin_area_2,countryCode:e.address.country_code,postalCode:e.address.postal_code,stateOrProvinceCode:e.address.admin_area_1,phone:null===(i=null===(t=e.phone)||void 0===t?void 0:t.phone_number)||void 0===i?void 0:i.national_number})}getShippingAddressFromOrderDetails(e){const{payer:t,purchase_units:i}=e,{address:n,name:{full_name:o}}=i[0].shipping,[a,...r]=o.split(\" \");return this.getAddress({firstName:a,lastName:r.join(\" \"),email:t.email_address,address1:n.address_line_1,address2:n.address_line_2,city:n.admin_area_2,countryCode:n.country_code,postalCode:n.postal_code,stateOrProvinceCode:n.admin_area_1})}getValidButtonStyle(e={}){const{color:t,height:i,label:n,shape:o}=e,r={color:t&&H[t]?t:void 0,height:this.getValidHeight(i),label:n&&G[n]?n:void 0,shape:o&&Y[o]?o:void 0};return (0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)(r,lodash__WEBPACK_IMPORTED_MODULE_3__.isNil)}getValidHeight(e){return e&&\"number\"==typeof e?e>55?55:e<25?25:e:40}removeElement(e){const t=e&&document.getElementById(e);t&&(t.style.display=\"none\")}}var ie=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class ne{constructor(e){this.requestSender=e}createOrder(e,t){return ie(this,void 0,void 0,function*(){const i=`/api/storefront/payment/${e}`,n=t,o=Object.assign({\"X-API-INTERNAL\":E,\"Content-Type\":z.Json},F);return(yield this.requestSender.post(i,{headers:o,body:n})).body})}updateOrder(e,t){return ie(this,void 0,void 0,function*(){const i=`/api/storefront/initialization/${e}`,n=t,o=Object.assign({\"X-API-INTERNAL\":E,\"Content-Type\":z.Json},F);return(yield this.requestSender.put(i,{headers:o,body:n})).body})}getOrderStatus(e,t){return ie(this,void 0,void 0,function*(){const i=`/api/storefront/initialization/${e}`,n=Object.assign({\"X-API-INTERNAL\":E,\"Content-Type\":z.Json},F);return(yield this.requestSender.get(i,Object.assign({headers:n},t))).body})}}const oe=i=>{const{getHost:n}=i.getState();return new te((0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),i,new ne((0,_bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_1__.createRequestSender)({host:n()})),Q())},ae=function({styles:e}){const t={};return e.color&&(t.color=e.color),e.layout&&(t.layout=e.layout),(e[\"logo-type\"]||e[\"logo-position\"])&&(t.logo={},e[\"logo-type\"]&&(t.logo.type=e[\"logo-type\"]),e[\"logo-position\"]&&(t.logo.position=e[\"logo-position\"])),e.ratio&&(t.ratio=e.ratio),(e[\"text-color\"]||e[\"text-size\"])&&(t.text={},e[\"text-color\"]&&(t.text.color=e[\"text-color\"]),e[\"text-size\"]&&(t.text.size=+e[\"text-size\"])),t};var re=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class se{constructor(e,t,i){this.paymentIntegrationService=e,this.paypalIntegrationService=t,this.paypalCommerceSdk=i}initialize(e){var t;return re(this,void 0,void 0,function*(){const{paypalcommercecredit:i,containerId:n,methodId:o}=e,{buyNowInitializeOptions:a,currencyCode:r,messagingContainerId:s}=i||{},d=!!a;if(!o)throw new _('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!n)throw new _('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!i)throw new _('Unable to initialize payment because \"options.paypalcommercecredit\" argument is not provided.');if(d&&!r)throw new _('Unable to initialize payment because \"options.paypalcommercecredit.currencyCode\" argument is not provided.');if(d&&\"function\"!=typeof(null==a?void 0:a.getBuyNowCartRequestBody))throw new _('Unable to initialize payment because \"options.paypalcommercecredit.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.');d||(yield this.paymentIntegrationService.loadDefaultCheckout());const l=this.paymentIntegrationService.getState(),c=d?r:l.getCartOrThrow().currency.code;yield this.paypalIntegrationService.loadPayPalSdk(o,c,!1),this.renderButton(n,o,i);const p=l.getStoreConfigOrThrow().checkoutSettings.features;if(null!==(t=p[\"PAYPAL-5557.Hide_ppc_banner_implementation\"])&&void 0!==t&&t)return;const u=s&&document.getElementById(s);if(c&&u){const e=l.getPaymentMethodOrThrow(o),{paypalBNPLConfiguration:t=[]}=e.initializationData||{},i=t&&t.find(({id:e})=>\"cart\"===e);if(!(null==i?void 0:i.status))return;u.removeAttribute(\"data-pp-style-logo-type\"),u.removeAttribute(\"data-pp-style-logo-position\"),u.removeAttribute(\"data-pp-style-text-color\"),u.removeAttribute(\"data-pp-style-text-size\");const n=yield this.paypalCommerceSdk.getPayPalMessages(e,c);this.renderMessages(n,s,i)}})}deinitialize(){return Promise.resolve()}renderButton(e,t,i){const{buyNowInitializeOptions:n,style:o,onComplete:a,onEligibilityFailure:r}=i,s=this.paypalIntegrationService.getPayPalSdkOrThrow(),d=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t),{isHostedCheckoutEnabled:l,isAppSwitchEnabled:c}=d.initializationData||{},p={createOrder:()=>this.paypalIntegrationService.createOrder(\"paypalcommercecredit\"),onApprove:({orderID:e})=>this.paypalIntegrationService.tokenizePayment(t,e)},u={onClick:()=>this.handleClick(n),onCancel:()=>this.paymentIntegrationService.loadDefaultCheckout()},h=Object.assign(Object.assign({},!c&&{onShippingAddressChange:e=>this.onShippingAddressChange(e),onShippingOptionsChange:e=>this.onShippingOptionsChange(e)}),{onApprove:(e,i)=>this.onHostedCheckoutApprove(e,i,t,a)}),y=[s.FUNDING.PAYLATER,s.FUNDING.CREDIT];let m=!1;y.forEach(t=>{if(!m){const i=Object.assign(Object.assign(Object.assign({fundingSource:t,style:this.paypalIntegrationService.getValidButtonStyle(o)},p),n&&u),l&&h),a=s.Buttons(i);a.isEligible()?(a.render(`#${e}`),m=!0):r&&\"function\"==typeof r&&r()}}),m||this.paypalIntegrationService.removeElement(e)}handleClick(e){return re(this,void 0,void 0,function*(){if(e){const t=yield this.paypalIntegrationService.createBuyNowCartOrThrow(e);yield this.paymentIntegrationService.loadCheckout(t.id)}})}onHostedCheckoutApprove(e,t,i,n){return re(this,void 0,void 0,function*(){if(!e.orderID)throw new y(l.MissingOrderId);const o=this.paymentIntegrationService.getState().getCartOrThrow(),a=yield t.order.get();try{const t=this.paypalIntegrationService.getBillingAddressFromOrderDetails(a);if(yield this.paymentIntegrationService.updateBillingAddress(t),o.lineItems.physicalItems.length>0){const e=this.paypalIntegrationService.getShippingAddressFromOrderDetails(a);yield this.paymentIntegrationService.updateShippingAddress(e),yield this.paypalIntegrationService.updateOrder(\"paypalcommerce\")}return yield this.paymentIntegrationService.submitOrder({},{params:{methodId:i}}),yield this.paypalIntegrationService.submitPayment(i,e.orderID),n&&\"function\"==typeof n&&n(),!0}catch(e){if(\"string\"==typeof e)throw new Error(e);throw e}})}onShippingAddressChange(e){return re(this,void 0,void 0,function*(){const t=this.paypalIntegrationService.getAddress({city:e.shippingAddress.city,countryCode:e.shippingAddress.countryCode,postalCode:e.shippingAddress.postalCode,stateOrProvinceCode:e.shippingAddress.state});try{yield this.paymentIntegrationService.updateBillingAddress(t),yield this.paymentIntegrationService.updateShippingAddress(t);const e=this.paypalIntegrationService.getShippingOptionOrThrow();yield this.paymentIntegrationService.selectShippingOption(e.id),yield this.paypalIntegrationService.updateOrder(\"paypalcommerce\")}catch(e){if(\"string\"==typeof e)throw new Error(e);throw e}})}onShippingOptionsChange(e){return re(this,void 0,void 0,function*(){const t=this.paypalIntegrationService.getShippingOptionOrThrow(e.selectedShippingOption.id);try{yield this.paymentIntegrationService.selectShippingOption(t.id),yield this.paypalIntegrationService.updateOrder(\"paypalcommerce\")}catch(e){if(\"string\"==typeof e)throw new Error(e);throw e}})}renderMessages(e,t,i){const n={amount:this.paymentIntegrationService.getState().getCheckoutOrThrow().outstandingBalance,placement:\"cart\",style:ae(i)};e.Messages(n).render(`#${t}`)}}const de=p(e=>new se(e,oe(e),Q()),[{id:\"paypalcommercecredit\"}]);var le=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class ce{constructor(e,t){this.paymentIntegrationService=e,this.paypalCommerceIntegrationService=t}initialize(e){return le(this,void 0,void 0,function*(){const{paypalcommercevenmo:t,containerId:i,methodId:n}=e,{buyNowInitializeOptions:o,currencyCode:a}=t||{},r=!!o;if(!n)throw new _('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!i)throw new _('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!t)throw new _('Unable to initialize payment because \"options.paypalcommercevenmo\" argument is not provided.');if(r&&!a)throw new _('Unable to initialize payment because \"options.paypalcommercevenmo.currencyCode\" argument is not provided.');if(r&&\"function\"!=typeof(null==o?void 0:o.getBuyNowCartRequestBody))throw new _('Unable to initialize payment because \"options.paypalcommercevenmo.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.');r||(yield this.paymentIntegrationService.loadDefaultCheckout());const s=r?a:this.paymentIntegrationService.getState().getCartOrThrow().currency.code;yield this.paypalCommerceIntegrationService.loadPayPalSdk(n,s,!1),this.renderButton(i,n,t)})}deinitialize(){return Promise.resolve()}renderButton(e,t,i){const{buyNowInitializeOptions:n,style:o,onEligibilityFailure:a}=i,r=this.paypalCommerceIntegrationService.getPayPalSdkOrThrow(),s=r.FUNDING.VENMO,d={createOrder:()=>this.paypalCommerceIntegrationService.createOrder(\"paypalcommercevenmo\"),onApprove:({orderID:e})=>this.paypalCommerceIntegrationService.tokenizePayment(t,e)},l={onClick:()=>this.handleClick(n),onCancel:()=>this.paymentIntegrationService.loadDefaultCheckout()},c=Object.assign(Object.assign({fundingSource:s,style:this.getValidVenmoButtonStyles(o)},d),n&&l),p=r.Buttons(c);p.isEligible()?p.render(`#${e}`):a&&\"function\"==typeof a?a():this.paypalCommerceIntegrationService.removeElement(e)}getValidVenmoButtonStyles(e){const t=this.paypalCommerceIntegrationService.getValidButtonStyle(e);return t.color===b.gold?Object.assign(Object.assign({},t),{color:void 0}):t}handleClick(e){return le(this,void 0,void 0,function*(){if(e){const t=yield this.paypalCommerceIntegrationService.createBuyNowCartOrThrow(e);yield this.paymentIntegrationService.loadCheckout(t.id)}})}}const pe=p(e=>new ce(e,N(e)),[{id:\"paypalcommercevenmo\"}]);var ue=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class he{constructor(e,t){this.paymentIntegrationService=e,this.paypalIntegrationService=t}initialize(e){return ue(this,void 0,void 0,function*(){const{paypalcommercealternativemethods:t,containerId:i,methodId:n}=e,{apm:o,buyNowInitializeOptions:a,currencyCode:r}=t||{},s=!!a;if(!n)throw new _('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!i)throw new _('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!t)throw new _('Unable to initialize payment because \"options.paypalcommercealternativemethods\" argument is not provided.');if(!o)throw new _('Unable to initialize payment because \"options.paypalcommercealternativemethods.apm\" argument is not provided.');if(s&&!r)throw new _('Unable to initialize payment because \"options.paypalcommercealternativemethods.currencyCode\" argument is not provided.');if(s&&\"function\"!=typeof(null==a?void 0:a.getBuyNowCartRequestBody))throw new _('Unable to initialize payment because \"options.paypalcommercealternativemethods.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.');s||(yield this.paymentIntegrationService.loadDefaultCheckout());const d=s?r:this.paymentIntegrationService.getState().getCartOrThrow().currency.code;yield this.paypalIntegrationService.loadPayPalSdk(n,d,!1),this.renderButton(i,n,t)})}deinitialize(){return Promise.resolve()}renderButton(e,t,i){const{apm:n,buyNowInitializeOptions:o,style:a,onEligibilityFailure:r}=i,s=this.paypalIntegrationService.getPayPalSdkOrThrow();if(!Object.values(s.FUNDING).includes(n))throw new _('Unable to initialize PayPal button because \"options.paypalcommercealternativemethods.apm\" argument is not valid funding source.');const d={createOrder:()=>this.paypalIntegrationService.createOrder(\"paypalcommercealternativemethod\"),onApprove:({orderID:e})=>this.paypalIntegrationService.tokenizePayment(t,e)},l={onClick:()=>this.handleClick(o),onCancel:()=>this.paymentIntegrationService.loadDefaultCheckout()},c=Object.assign(Object.assign({fundingSource:n,style:this.paypalIntegrationService.getValidButtonStyle(a)},d),o&&l),p=s.Buttons(c);p.isEligible()?p.render(`#${e}`):r&&\"function\"==typeof r?r():this.paypalIntegrationService.removeElement(e)}handleClick(e){return ue(this,void 0,void 0,function*(){if(e){const t=yield this.paypalIntegrationService.createBuyNowCartOrThrow(e);yield this.paymentIntegrationService.loadCheckout(t.id)}})}}const ye=p(e=>new he(e,oe(e)),[{id:\"paypalcommercealternativemethods\"}]);var me=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class ge{constructor(e){this.scriptLoader=e,this.window=window}getPayPalFastlaneSdk(e,t,i){return me(this,void 0,void 0,function*(){if(!this.window.paypalFastlaneSdk){const n=this.getPayPalFastlaneSdkConfiguration(e,t,i);if(yield this.loadPayPalSdk(n),!this.window.paypalFastlaneSdk)throw new h}return this.window.paypalFastlaneSdk})}getPayPalGooglePaySdk(e,t,i,n){return me(this,void 0,void 0,function*(){if(!this.window.paypalGooglePay||n){const n=this.getPayPalGooglePaySdkScriptConfigOrThrow(e,t,i);yield this.loadPayPalSdk(n)}if(!this.window.paypalGooglePay)throw new h;return this.window.paypalGooglePay})}getPayPalApmsSdk(e,t){return me(this,void 0,void 0,function*(){if(!this.window.paypalApms){const i=this.getPayPalApmSdkConfiguration(e,t);if(yield this.loadPayPalSdk(i),!this.window.paypalApms)throw new h}return this.window.paypalApms})}getPayPalMessages(e,t){return me(this,void 0,void 0,function*(){if(!this.window.paypalMessages){const i=this.getPayPalSdkMessagesConfiguration(e,t);yield this.loadPayPalSdk(i)}if(!this.window.paypalMessages)throw new h;return this.window.paypalMessages})}loadPayPalSdk({options:e,attributes:t}){return me(this,void 0,void 0,function*(){const i=this.transformConfig(e),n=this.transformConfig(t),o=`https://www.paypal.com/sdk/js?${new URLSearchParams(i).toString()}`;yield this.scriptLoader.loadScript(o,{async:!0,attributes:n})})}getPayPalFastlaneSdkConfiguration(e,t,i){const{clientToken:n,initializationData:o}=e;if(!o||!o.clientId)throw new y(l.MissingPaymentMethod);const{intent:a,clientId:r,merchantId:s,attributionId:d}=o;return{options:{\"client-id\":r,\"merchant-id\":s,commit:!0,components:[\"fastlane\",\"buttons\",\"payment-fields\",\"hosted-fields\",\"three-domain-secure\"],currency:t,intent:a},attributes:{\"data-client-metadata-id\":i.replace(/-/g,\"\"),\"data-namespace\":\"paypalFastlaneSdk\",\"data-partner-attribution-id\":d,\"data-sdk-client-token\":n}}}getPayPalGooglePaySdkScriptConfigOrThrow(e,t,i=!0){const{clientToken:n,initializationData:o}=e;if(!o||!o.clientId)throw new y(l.MissingPaymentMethod);const{intent:a,clientId:r,merchantId:s,buyerCountry:d,attributionId:c,isHostedCheckoutEnabled:p,isDeveloperModeApplicable:u}=o,h=p||i;return{options:Object.assign({\"client-id\":r,\"merchant-id\":s,commit:h,components:[\"googlepay\"],currency:t,intent:a},u&&{\"buyer-country\":d}),attributes:{\"data-partner-attribution-id\":c,\"data-client-token\":n,\"data-namespace\":\"paypalGooglePay\"}}}getPayPalApmSdkConfiguration(e,t){const{initializationData:i}=e;if(!i||!i.clientId)throw new y(l.MissingPaymentMethod);const{intent:n,clientId:o,merchantId:a,buyerCountry:r,attributionId:s,isDeveloperModeApplicable:d,availableAlternativePaymentMethods:c=[],enabledAlternativePaymentMethods:p=[]}=i,u=p,h=c.filter(e=>!p.includes(e));return{options:Object.assign({\"client-id\":o,\"merchant-id\":a,\"enable-funding\":u.length>0?u:void 0,\"disable-funding\":h.length>0?h:void 0,commit:!0,components:[\"buttons\",\"payment-fields\"],currency:t,intent:n},d&&{\"buyer-country\":r}),attributes:{\"data-partner-attribution-id\":s,\"data-namespace\":\"paypalApms\"}}}getPayPalSdkMessagesConfiguration(e,t){const{initializationData:i}=e;if(!i||!i.clientId)throw new y(l.MissingPaymentMethod);const{clientId:n,merchantId:o,attributionId:a,isDeveloperModeApplicable:r,buyerCountry:s}=i;return{options:Object.assign({\"client-id\":n,\"merchant-id\":o,components:[\"messages\"],currency:t},r&&{\"buyer-country\":s}),attributes:{\"data-namespace\":\"paypalMessages\",\"data-partner-attribution-id\":a}}}transformConfig(e){let t={};return Object.keys(e).forEach(i=>{const n=e[i];null==n||\"\"===n||Array.isArray(n)&&0===n.length||(t=Object.assign(Object.assign({},t),{[i]:Array.isArray(n)?n.join(\",\"):n}))}),t}}const ve={size:70,color:\"#d9d9d9\",backgroundColor:\"#ffffff\"},fe=\"embedded-checkout-loading-indicator-rotation\";class Se{constructor(e){this.styles=Object.assign(Object.assign({},ve),e&&e.styles),this.containerStyles=Object.assign({},e&&e.containerStyles),this.defineAnimation(),this.container=this.buildContainer(),this.indicator=this.buildIndicator(),this.container.appendChild(this.indicator)}show(e){if(e){const t=document.getElementById(e);if(!t)throw new Error(\"Unable to attach the loading indicator because the parent ID is not valid.\");t.appendChild(this.container)}this.container.style.visibility=\"visible\",this.container.style.opacity=\"1\"}hide(){const e=()=>{this.container.style.visibility=\"hidden\",this.container.removeEventListener(\"transitionend\",e)};this.container.addEventListener(\"transitionend\",e),this.container.style.opacity=\"0\"}buildContainer(){const e=document.createElement(\"div\");return e.style.display=\"block\",e.style.bottom=\"0\",e.style.left=\"0\",e.style.height=\"100%\",e.style.width=\"100%\",e.style.position=\"absolute\",e.style.right=\"0\",e.style.top=\"0\",e.style.transition=\"all 250ms ease-out\",e.style.opacity=\"0\",this.setStyleAttribute(e,this.containerStyles),e}buildIndicator(){const e=document.createElement(\"div\");return e.style.display=\"block\",e.style.width=`${this.styles.size}px`,e.style.height=`${this.styles.size}px`,e.style.borderRadius=`${this.styles.size}px`,e.style.border=\"solid 1px\",e.style.borderColor=`${this.styles.backgroundColor} ${this.styles.backgroundColor} ${this.styles.color} ${this.styles.color}`,e.style.margin=\"0 auto\",e.style.position=\"absolute\",e.style.left=\"0\",e.style.right=\"0\",e.style.top=\"50%\",e.style.transform=\"translateY(-50%) rotate(0deg)\",e.style.transformStyle=\"preserve-3d\",e.style.animation=`${fe} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`,e}setStyleAttribute(e,t){Object.keys(t).forEach(i=>{e.style.setProperty(i,t[i])})}defineAnimation(){var e;if(document.getElementById(fe))return;const t=document.createElement(\"style\");t.id=fe,null===(e=document.head)||void 0===e||e.appendChild(t),t.sheet instanceof CSSStyleSheet&&t.sheet.insertRule(`\\n                @keyframes ${fe} {\\n                    0% { transform: translateY(-50%) rotate(0deg); }\\n                    100% { transform: translateY(-50%) rotate(360deg); }\\n                }\\n            `,0)}}const Ie={\"background-color\":\"rgba(0, 0, 0, 0.4)\",\"z-index\":\"1000\"};class we extends _{constructor(e){let t=\"Unable to submit payment for the order because the payload is invalid.\";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(\", \")}.`),super(t),this.name=\"PaymentArgumentInvalidError\"}}class be extends v{constructor(e){super(e,{message:\"There is a problem processing your payment. Please try again later.\"}),this.name=\"PaymentMethodInvalidError\",this.type=\"payment_method_invalid\"}}class Pe extends u{constructor(){super(\"The current order does not need to be finalized at this stage.\"),this.name=\"OrderFinalizationNotRequiredError\",this.type=\"order_finalization_not_required\"}}function Ce(e){return!(\"object\"!=typeof e||null===e||void 0!==e.shouldSaveInstrument&&\"boolean\"!=typeof e.shouldSaveInstrument||void 0!==e.shouldSetAsDefaultInstrument&&\"boolean\"!=typeof e.shouldSetAsDefaultInstrument)}function Oe(e){return Boolean(e.instrumentId)}const ke=function({styles:e}){const t={};return e.color&&(t.color=e.color),e.layout&&(t.layout=e.layout),(e[\"logo-type\"]||e[\"logo-position\"])&&(t.logo={},e[\"logo-type\"]&&(t.logo.type=e[\"logo-type\"]),e[\"logo-position\"]&&(t.logo.position=e[\"logo-position\"])),e.ratio&&(t.ratio=e.ratio),(e[\"text-color\"]||e[\"text-size\"])&&(t.text={},e[\"text-color\"]&&(t.text.color=e[\"text-color\"]),e[\"text-size\"]&&(t.text.size=+e[\"text-size\"])),t};function Ae(e){return\"object\"==typeof e&&null!==e&&\"bigpayToken\"in e&&\"defaultInstrument\"in e&&\"provider\"in e&&\"trustedShippingAddress\"in e&&\"method\"in e&&\"type\"in e}var Ee=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class Te{constructor(e,t,i,n){this.paymentIntegrationService=e,this.paypalCommerceIntegrationService=t,this.paypalCommerceSdk=i,this.loadingIndicator=n}initialize(e){var t;return Ee(this,void 0,void 0,function*(){const{methodId:i,paypalcommerce:n}=e||{};if(this.paypalcommerce=n,!i)throw new _('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!n)throw new _('Unable to initialize payment because \"options.paypalcommerce\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(i);const o=this.paymentIntegrationService.getState(),a=o.getPaymentMethodOrThrow(i),{container:r,bannerContainerId:s}=n,{orderId:d,paypalBNPLConfiguration:l=[],isPayPalCreditAvailable:c}=a.initializationData||{};if(void 0!==s){if(!document.getElementById(s))return void console.error(\"Unable to create banner without valid banner container ID.\");const e=null==l?void 0:l.find(({id:e})=>\"checkout\"===e);if(c||!(null==e?void 0:e.status))return;const t=yield this.paypalCommerceSdk.getPayPalMessages(a,o.getCartOrThrow().currency.code);return t&&\"function\"==typeof(null==t?void 0:t.Messages)?this.renderMessages(t,s,e):void console.error(\"[BC PayPalCommerce PayLater]: banner could not be rendered, due to issues with loading PayPal SDK\")}d?this.orderId=null===(t=a.initializationData)||void 0===t?void 0:t.orderId:(this.loadingIndicatorContainer=null==r?void 0:r.split(\"#\")[1],yield this.paypalCommerceIntegrationService.loadPayPalSdk(i),n.onInit&&\"function\"==typeof n.onInit&&n.onInit(()=>this.renderButton(i,n)),(void 0===n.shouldRenderPayPalButtonOnInitialization||n.shouldRenderPayPalButtonOnInitialization)&&this.renderButton(i,n))})}execute(e,t){var i,n;return Ee(this,void 0,void 0,function*(){const{payment:o}=e,a=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]),{onError:r}=this.paypalcommerce||{};if(!o)throw new we([\"payment\"]);const{methodId:s,paymentData:d}=o;if(this.isPayPalVaultedInstrumentPaymentData(d)&&!this.orderId&&(this.orderId=yield this.createOrder()),!this.orderId)throw new be;const l=this.isPayPalVaultedInstrumentPaymentData(d)?this.prepareVaultedInstrumentPaymentPayload(s,this.orderId,d):this.preparePaymentPayload(s,this.orderId,d);try{yield this.paymentIntegrationService.submitOrder(a,t),yield this.paymentIntegrationService.submitPayment(l)}catch(e){if(function(e){var t;return(e=>\"object\"==typeof e&&null!==e&&\"body\"in e)(e)&&\"offsite_redirect\"===(null===(t=e.body.additional_action_required)||void 0===t?void 0:t.type)}(e)){const t=null===(n=null===(i=e.body.additional_action_required)||void 0===i?void 0:i.data)||void 0===n?void 0:n.redirect_url;return new Promise(()=>window.location.replace(t))}return this.isProviderError(e)&&(yield this.paypalCommerceIntegrationService.loadPayPalSdk(o.methodId),yield new Promise((e,t)=>{var i;this.paypalcommerce&&(null===(i=this.paypalButton)||void 0===i||i.close(),this.renderButton(o.methodId,this.paypalcommerce),this.handleError(new Error(\"INSTRUMENT_DECLINED\"),r)),t()})),this.handleError(e,r),Promise.reject()}})}finalize(){return Promise.reject(new Pe)}deinitialize(){var e;return this.orderId=void 0,null===(e=this.paypalButton)||void 0===e||e.close(),Promise.resolve()}prepareVaultedInstrumentPaymentPayload(e,t,i){const{instrumentId:n,shouldSetAsDefaultInstrument:o}=i,a=!this.isTrustedVaultingFlow(i);return a?{methodId:e,paymentData:{shouldSaveInstrument:a,shouldSetAsDefaultInstrument:o,formattedPayload:{paypal_account:{order_id:t}}}}:{methodId:e,paymentData:{instrumentId:n,shouldSetAsDefaultInstrument:o,formattedPayload:{paypal_account:{order_id:t},bigpay_token:{token:n}}}}}preparePaymentPayload(e,t,i){const{shouldSaveInstrument:n=!1,shouldSetAsDefaultInstrument:o=!1}=Ce(i)?i:{};return{methodId:e,paymentData:{shouldSaveInstrument:n,shouldSetAsDefaultInstrument:o,formattedPayload:{paypal_account:{order_id:t}}}}}renderButton(e,t){var i,n,o,a;const r=this.paypalCommerceIntegrationService.getPayPalSdkOrThrow(),s=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),{paymentButtonStyles:d}=s.initializationData||{},{checkoutPaymentButtonStyles:l}=d||{},{container:c,onError:p,onRenderButton:u,onValidate:h,submitForm:y}=t;if(!c)throw new _('Unable to initialize payment because \"container\" argument is not provided.');const m=Object.assign(Object.assign({},this.isPaypalCommerceAppSwitchEnabled(e)&&{appSwitchWhenAvailable:!0}),{fundingSource:r.FUNDING.PAYPAL,style:this.paypalCommerceIntegrationService.getValidButtonStyle(l),createOrder:()=>this.createOrder(),onClick:(e,t)=>this.handleClick(t,h),onApprove:e=>this.handleApprove(e,y),onError:e=>this.handleError(e,p),onCancel:()=>this.toggleLoadingIndicator(!1)});this.paypalButton=r.Buttons(m),this.paypalButton.isEligible()&&(u&&\"function\"==typeof u&&u(),(null===(n=(i=this.paypalButton).hasReturned)||void 0===n?void 0:n.call(i))&&this.isPaypalCommerceAppSwitchEnabled(e)?null===(a=(o=this.paypalButton).resume)||void 0===a||a.call(o):this.paypalButton.render(c))}handleClick(e,t){return Ee(this,void 0,void 0,function*(){const{resolve:i,reject:n}=e;return null==t?void 0:t(()=>(this.toggleLoadingIndicator(!0),i()),n)})}handleApprove({orderID:e},t){this.orderId=e,null==t||t()}handleError(e,t){this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}createOrder(){return Ee(this,void 0,void 0,function*(){const e=this.getFieldsValues();return this.paypalCommerceIntegrationService.createOrder(\"paypalcommercecheckout\",{shouldSaveInstrument:(null==e?void 0:e.shouldSaveInstrument)||!1})})}getFieldsValues(){const{getFieldsValues:e}=this.paypalcommerce||{};return\"function\"==typeof e?e():void 0}isTrustedVaultingFlow(e){if(e&&Oe(e)){const t=this.paymentIntegrationService.getState().getInstruments(),i=null==t?void 0:t.find(t=>Ae(t)&&t.bigpayToken===e.instrumentId);return!(Ae(i)&&!i.trustedShippingAddress)}return!1}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}isPayPalVaultedInstrumentPaymentData(e){return!!e&&Oe(e)&&Ce(e)}renderMessages(e,t,i){const n={amount:this.paymentIntegrationService.getState().getCheckoutOrThrow().outstandingBalance,placement:\"payment\",style:ke(i)};e.Messages(n).render(`#${t}`)}isProviderError(e){var t,i,n;return!!function(e){return\"object\"==typeof e&&null!==e&&\"errors\"in e}(e)&&\"INSTRUMENT_DECLINED\"===(null===(n=null===(i=((null===(t=null==e?void 0:e.errors)||void 0===t?void 0:t.filter(e=>e.provider_error))||[])[0])||void 0===i?void 0:i.provider_error)||void 0===n?void 0:n.code)}isPaypalCommerceAppSwitchEnabled(e){var t;return(null===(t=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e).initializationData)||void 0===t?void 0:t.isAppSwitchEnabled)||!1}}const ze=p(e=>new Te(e,N(e),new ge((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_2__.getScriptLoader)()),new Se({containerStyles:Ie})),[{id:\"paypalcommerce\"}]);class Fe extends u{constructor(e){super(e||\"Not implemented.\"),this.name=\"NotImplementedError\",this.type=\"not_implemented\"}}var Be=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class Me{constructor(e,t,i,n){this.paymentIntegrationService=e,this.paypalCommerceIntegrationService=t,this.loadingIndicator=i,this.paypalCommerceSdk=n}initialize(e){return Be(this,void 0,void 0,function*(){const{methodId:t,paypalcommerce:i,paypalcommercecredit:n}=e||{},o=n||i;if(!t)throw new _('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!o)throw new _('Unable to initialize payment because \"options.paypalcommerce\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(t);const a=this.paymentIntegrationService.getState(),r=a.getPaymentMethodOrThrow(t),{paypalBNPLConfiguration:s=[],orderId:d}=r.initializationData||{},{bannerContainerId:l,container:c}=o;if(void 0!==l){if(!document.getElementById(l))return void console.error(\"Unable to create banner without valid banner container ID.\");const e=s&&s.find(({id:e})=>\"checkout\"===e);if(!(null==e?void 0:e.status))return;const t=yield this.paypalCommerceSdk.getPayPalMessages(r,a.getCartOrThrow().currency.code);return this.renderMessages(t,l,e)}d?this.orderId=d:(yield this.paypalCommerceIntegrationService.loadPayPalSdk(t),this.loadingIndicatorContainer=null==c?void 0:c.split(\"#\")[1],this.renderButton(t,o))})}execute(e,t){return Be(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]);if(!i)throw new we([\"payment\"]);if(!this.orderId)throw new be;yield this.paymentIntegrationService.submitOrder(n,t),yield this.paypalCommerceIntegrationService.submitPayment(i.methodId,this.orderId)})}finalize(){return Promise.reject(new Pe)}deinitialize(){var e;return this.orderId=void 0,null===(e=this.paypalButton)||void 0===e||e.close(),Promise.resolve()}renderButton(e,t){if(!(null==t?void 0:t.container))throw new _('Unable to initialize payment because \"container\" argument is not provided.');const i=this.paypalCommerceIntegrationService.getPayPalSdkOrThrow(),n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),{paymentButtonStyles:o}=n.initializationData||{},{checkoutPaymentButtonStyles:a}=o||{},{container:r,onError:s,onRenderButton:d,onValidate:l,submitForm:c}=t,p=[i.FUNDING.PAYLATER,i.FUNDING.CREDIT];let u=!1;p.forEach(e=>{if(u)return;const t={fundingSource:e,style:this.paypalCommerceIntegrationService.getValidButtonStyle(a),createOrder:()=>this.paypalCommerceIntegrationService.createOrder(\"paypalcommercecreditcheckout\"),onClick:(e,t)=>this.handleClick(t,l),onApprove:e=>this.handleApprove(e,c),onCancel:()=>this.toggleLoadingIndicator(!1),onError:e=>this.handleError(e,s)};if(this.paypalButton=i.Buttons(t),this.paypalButton.isEligible()||e!==i.FUNDING.PAYLATER){if(!this.paypalButton.isEligible()&&e===i.FUNDING.CREDIT)throw new Fe(`PayPal ${e} is not available for your region. Please use PayPal Checkout instead.`);d&&\"function\"==typeof d&&d(),this.paypalButton.render(r),u=!0}})}handleClick(e,t){return Be(this,void 0,void 0,function*(){const{resolve:i,reject:n}=e;if(t&&\"function\"==typeof t)return t(()=>(this.toggleLoadingIndicator(!0),i()),n)})}handleApprove({orderID:e},t){this.orderId=e,t&&\"function\"==typeof t&&t()}handleError(e,t){this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}renderMessages(e,t,i){const n={amount:this.paymentIntegrationService.getState().getCheckoutOrThrow().outstandingBalance,placement:\"payment\",style:ke(i)};e.Messages(n).render(`#${t}`)}}const De=p(e=>new Me(e,N(e),new Se({containerStyles:Ie}),new ge((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_2__.createScriptLoader)())),[{id:\"paypalcommercecredit\"}]);var xe=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class Ne{constructor(e,t,i){this.paymentIntegrationService=e,this.paypalCommerceIntegrationService=t,this.loadingIndicator=i}initialize(e){var t,i;return xe(this,void 0,void 0,function*(){const{methodId:n,paypalcommerce:o,paypalcommercevenmo:a}=e||{},r=a||o;if(!n)throw new _('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!r)throw new _('Unable to initialize payment because \"options.paypalcommercevenmo\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(n);const s=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(n);(null===(t=s.initializationData)||void 0===t?void 0:t.orderId)?this.orderId=null===(i=s.initializationData)||void 0===i?void 0:i.orderId:(yield this.paypalCommerceIntegrationService.loadPayPalSdk(n),this.loadingIndicatorContainer=r.container.split(\"#\")[1],this.renderButton(n,r))})}execute(e,t){return xe(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]);if(!i)throw new we([\"payment\"]);if(!this.orderId)throw new be;yield this.paymentIntegrationService.submitOrder(n,t),yield this.paypalCommerceIntegrationService.submitPayment(i.methodId,this.orderId)})}finalize(){return Promise.reject(new Pe)}deinitialize(){var e;return this.orderId=void 0,null===(e=this.paypalButton)||void 0===e||e.close(),Promise.resolve()}renderButton(e,t){const i=this.paypalCommerceIntegrationService.getPayPalSdkOrThrow(),n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),{paymentButtonStyles:o}=n.initializationData||{},{checkoutPaymentButtonStyles:a}=o||{},{container:r,onError:s,onRenderButton:d,onValidate:l,submitForm:c}=t,p={fundingSource:i.FUNDING.VENMO,style:this.paypalCommerceIntegrationService.getValidButtonStyle(a),createOrder:()=>this.paypalCommerceIntegrationService.createOrder(\"paypalcommercevenmocheckout\"),onClick:(e,t)=>this.handleClick(t,l),onApprove:e=>this.handleApprove(e,c),onCancel:()=>this.toggleLoadingIndicator(!1),onError:e=>this.handleError(e,s)};if(this.paypalButton=i.Buttons(p),!this.paypalButton.isEligible())throw new Fe(\"PayPal Venmo is not available for your region. Please use PayPal Checkout instead.\");d&&\"function\"==typeof d&&d(),this.paypalButton.render(r)}handleClick(e,t){return xe(this,void 0,void 0,function*(){const{resolve:i,reject:n}=e;return t(()=>(this.toggleLoadingIndicator(!0),i()),n)})}handleApprove({orderID:e},t){this.orderId=e,t(),this.toggleLoadingIndicator(!1)}handleError(e,t){this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}}const _e=p(e=>new Ne(e,N(e),new Se({styles:{backgroundColor:\"black\"}})),[{id:\"paypalcommercevenmo\"}]);class je extends v{constructor(e){super(e,{message:\"The request has timed out or aborted.\"}),this.name=\"TimeoutError\",this.type=\"timeout\"}}var Ue=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class Ve{constructor(e,t,i,n,o=3e3,a=3e5){this.paymentIntegrationService=e,this.paypalCommerceIntegrationService=t,this.paypalSdkScriptLoader=i,this.loadingIndicator=n,this.pollingInterval=o,this.maxPollingIntervalTime=a,this.pollingTimer=0,this.stopPolling=lodash__WEBPACK_IMPORTED_MODULE_3__.noop,this.isOrderApprovedProcessing=!1}initialize(e){return Ue(this,void 0,void 0,function*(){const{gatewayId:t,methodId:i,paypalcommerce:n,paypalcommercealternativemethods:o}=e,a=o||n;if(this.paypalcommercealternativemethods=o,!i)throw new _('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new _('Unable to initialize payment because \"options.gatewayId\" argument is not provided.');if(!a)throw new _('Unable to initialize payment because \"options.paypalcommercealternativemethods\" argument is not provided.');const r=this.paymentIntegrationService.getState(),s=r.getPaymentMethodOrThrow(i,t),{orderId:d,shouldRenderFields:l}=s.initializationData||{},c=r.getStoreConfigOrThrow().checkoutSettings.features;this.isOrderApprovedProcessing=function(e,t,i=!0){var n;return null!==(n=e[\"PAYPAL-5431.order_approved_processing\"])&&void 0!==n?n:i}(c),d?this.orderId=d:(this.paypalApms=yield this.paypalSdkScriptLoader.getPayPalApmsSdk(s,r.getCartOrThrow().currency.code),this.loadingIndicatorContainer=a.container.split(\"#\")[1],this.renderButton(i,t,a),l&&this.renderFields(i,a))})}execute(e,t){return Ue(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]);if(!i)throw new we([\"payment\"]);const{methodId:o,gatewayId:a}=i;if(!this.orderId)throw new be;this.isOrderApprovedProcessing||\"ideal\"!==o||(yield new Promise((e,t)=>{this.initializePollingMechanism(o,e,t,a)})),this.isNonInstantPaymentMethod(o)&&(o!==C.IDEAL||this.isOrderApprovedProcessing)||(yield this.paymentIntegrationService.submitOrder(n,t)),yield this.paypalCommerceIntegrationService.submitPayment(o,this.orderId,a)})}finalize(){return Promise.reject(new Pe)}deinitialize(){var e;return this.orderId=void 0,this.isOrderApprovedProcessing||this.resetPollingMechanism(),null===(e=this.paypalButton)||void 0===e||e.close(),Promise.resolve()}initializePollingMechanism(e,t,i,n){return Ue(this,void 0,void 0,function*(){yield new Promise((e,t)=>{const i=setTimeout(e,this.pollingInterval);this.stopPolling=()=>(clearTimeout(i),this.toggleLoadingIndicator(!1),t())});try{this.pollingTimer+=this.pollingInterval;const o=yield this.paypalCommerceIntegrationService.getOrderStatus(null!=n?n:\"paypalcommerce\"),a=o===O.Approved,r=o===O.PollingError;if(a)return this.deinitializePollingMechanism(),t();if(r)return i();if(!a&&this.pollingTimer<this.maxPollingIntervalTime)return yield this.initializePollingMechanism(e,t,i,n);yield this.reinitializeStrategy({methodId:e,gatewayId:n,paypalcommercealternativemethods:this.paypalcommercealternativemethods}),this.handleError(new je)}catch(e){i()}})}deinitializePollingMechanism(){this.stopPolling(),this.pollingTimer=0}resetPollingMechanism(){this.deinitializePollingMechanism()}reinitializeStrategy(e){return Ue(this,void 0,void 0,function*(){yield this.deinitialize(),yield this.initialize(e)})}handleError(e){const{onError:t}=this.paypalcommercealternativemethods||{};this.isOrderApprovedProcessing||this.resetPollingMechanism(),this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}renderButton(e,t,i){const n=this.getPaypalAmpsSdkOrThrow(),o=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e,t),{buttonStyle:a}=o.initializationData||{},{container:r,onError:s,onRenderButton:d,submitForm:l}=i,c={fundingSource:e,style:this.paypalCommerceIntegrationService.getValidButtonStyle(a),onInit:(e,t)=>i.onInitButton(t),createOrder:()=>this.onCreateOrder(e,t,i),onApprove:e=>this.handleApprove(e,l),onCancel:()=>{this.toggleLoadingIndicator(!1),this.deinitializePollingMechanism()},onError:e=>{this.deinitializePollingMechanism(),this.handleFailure(e,s)},onClick:(e,t)=>Ue(this,void 0,void 0,function*(){return i.onValidate(t.resolve,t.reject)})};this.paypalButton=n.Buttons(c),this.paypalButton.isEligible()&&(d&&\"function\"==typeof d&&d(),this.paypalButton.render(r))}onCreateOrder(e,t,i){var n;return Ue(this,void 0,void 0,function*(){const{onValidate:o}=i;yield o(()=>(this.toggleLoadingIndicator(!0),()=>Promise.resolve()),lodash__WEBPACK_IMPORTED_MODULE_3__.noop);const a=yield this.paypalCommerceIntegrationService.createOrder(\"paypalcommercealternativemethodscheckout\");if(this.isNonInstantPaymentMethod(e)&&(e===C.IDEAL&&!this.isOrderApprovedProcessing||e===C.OXXO)){const i={useStoreCredit:!1},o={params:{methodId:e,gatewayId:t}};if(yield this.paymentIntegrationService.submitOrder(i,o),e===C.IDEAL){const t=this.paymentIntegrationService.getState(),i=null===(n=t.getOrder())||void 0===n?void 0:n.orderId;yield this.paypalCommerceIntegrationService.updateOrder(\"paypalcommercealternativemethodscheckout\",e,i)}yield this.paypalCommerceIntegrationService.submitPayment(e,a,t)}return a})}handleApprove({orderID:e},t){this.orderId=e,t()}handleFailure(e,t){this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}renderFields(e,t){const i=this.getPaypalAmpsSdkOrThrow(),n=this.paymentIntegrationService.getState(),{firstName:o,lastName:a,email:r}=n.getBillingAddressOrThrow(),{apmFieldsContainer:s,apmFieldsStyles:d}=t;if(!s)throw new _('Unable to initialize payment because \"options.paypalcommercealternativemethods\" argument should contain \"apmFieldsContainer\".');const l=document.querySelector(s);l&&(l.innerHTML=\"\");const c={fundingSource:e,style:d||{},fields:{name:{value:`${o} ${a}`},email:{value:r}}};i.PaymentFields(c).render(s)}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}isNonInstantPaymentMethod(e){return e.toUpperCase()in C}getPaypalAmpsSdkOrThrow(){if(!this.paypalApms)throw new h;return this.paypalApms}}const Re=p(e=>new Ve(e,oe(e),Q(),new Se({containerStyles:Ie})),[{gateway:\"paypalcommercealternativemethods\"}]);var Le;!function(e){e.CVV=\"cvv\",e.PAN=\"pan\"}(Le||(Le={}));class $e{static get(e){const t=`${encodeURIComponent(`${e}`)}=`,i=document.cookie;let n=null;const o=i.indexOf(t);if(o>-1){let e=i.indexOf(\";\",o);-1===e&&(e=i.length),n=decodeURIComponent(i.substring(o+t.length,e))}return n}static set(e,t,i={secure:!0}){let n=`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;const{expires:o,path:a,domain:r,secure:s}=i;if(o)n+=`; expires=${o.toUTCString()}`;else{const e=new Date,t=60;e.setTime(e.getTime()+60*t*1e3),n+=`; expires=${e.toUTCString()}`}a&&(n+=`; path=${a}`),r&&(n+=`; domain=${r}`),s&&(n+=\"; secure\"),document.cookie=n}static remove(e,t){$e.set(e,\"\",Object.assign({expires:new Date(0)},t))}}var qe,Ge=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class He{constructor(){this.window=window}initializePayPalFastlane(e,t,i){return Ge(this,void 0,void 0,function*(){if(t&&(window.localStorage.setItem(\"fastlaneEnv\",\"sandbox\"),window.localStorage.setItem(\"axoEnv\",\"sandbox\")),!this.window.paypalFastlane){const t={root:{backgroundColorPrimary:\"transparent\"}};this.window.paypalFastlane=yield e.Fastlane({styles:i||t})}return this.window.paypalFastlane})}getPayPalFastlaneOrThrow(){if(!this.window.paypalFastlane)throw new h;return this.window.paypalFastlane}lookupCustomerOrThrow(e){return Ge(this,void 0,void 0,function*(){return this.getPayPalFastlaneOrThrow().identity.lookupCustomerByEmail(e)})}triggerAuthenticationFlowOrThrow(e){return Ge(this,void 0,void 0,function*(){return e?this.getPayPalFastlaneOrThrow().identity.triggerAuthenticationFlow(e):{}})}updateStorageSessionId(e){const t=new Date;t.setDate(t.getDate()+14);const i={expires:t,secure:!0};$e.set(\"bc-fastlane-sessionId\",e,i)}removeStorageSessionId(){$e.remove(\"bc-fastlane-sessionId\")}getStorageSessionId(){return $e.get(\"bc-fastlane-sessionId\")||\"\"}mapPayPalFastlaneProfileToBcCustomerData(e,t){var i,n,o;const{authenticationState:a,profileData:r}=t,s=null===(o=null===(n=null===(i=null==r?void 0:r.card)||void 0===i?void 0:i.paymentSource)||void 0===n?void 0:n.card)||void 0===o?void 0:o.billingAddress,d=null==r?void 0:r.shippingAddress,l=null==r?void 0:r.name,c=null==r?void 0:r.card,p=d?this.mapPayPalToBcAddress(d.address,d.name,d.phoneNumber):void 0,u=s&&l?this.mapPayPalToBcAddress(s,l,null==d?void 0:d.phoneNumber):void 0,h=c?this.mapPayPalToBcInstrument(e,c):[],y=this.filterAddresses([p,u]);return{authenticationState:a||W.UNRECOGNIZED,addresses:y,billingAddress:u,shippingAddress:p,instruments:h}}mapPayPalToBcInstrument(e,t){const{id:i,paymentSource:n}=t,{brand:o,expiry:a,lastDigits:r}=n.card,[s,d]=a.split(\"-\");return[{bigpayToken:i,brand:o,defaultInstrument:!1,expiryMonth:d,expiryYear:s,iin:\"\",last4:r,method:e,provider:e,trustedShippingAddress:!1,untrustedShippingCardVerificationMode:Le.PAN,type:\"card\"}]}mapBcToPayPalAddress(e){return{company:(null==e?void 0:e.company)||\"\",addressLine1:(null==e?void 0:e.address1)||\"\",addressLine2:(null==e?void 0:e.address2)||\"\",adminArea1:(null==e?void 0:e.stateOrProvinceCode)||(null==e?void 0:e.stateOrProvince)||\"\",adminArea2:(null==e?void 0:e.city)||\"\",postalCode:(null==e?void 0:e.postalCode)||\"\",countryCode:(null==e?void 0:e.countryCode)||\"\"}}mapPayPalToBcAddress(e,t,i,n){const[o,a]=t.fullName.split(\" \"),r=(null==i?void 0:i.nationalNumber)||\"\",s=(null==i?void 0:i.countryCode)||\"\";return{id:Date.now(),type:\"paypal-address\",firstName:t.firstName||o||\"\",lastName:t.lastName||a||\"\",company:e.company||\"\",address1:e.addressLine1,address2:e.addressLine2||\"\",city:e.adminArea2,stateOrProvince:e.adminArea1,stateOrProvinceCode:e.adminArea1,country:e.countryCode||\"\",countryCode:e.countryCode||\"\",postalCode:e.postalCode,phone:s+r,customFields:n||[]}}filterAddresses(e){return e.reduce((e,t)=>t?e.some(e=>this.isEqualAddresses(e,t))?e:[...e,t]:e,[])}isEqualAddresses(e,t){return (0,lodash__WEBPACK_IMPORTED_MODULE_3__.isEqual)(this.normalizeAddress(e),this.normalizeAddress(t))}normalizeAddress(e){return (0,lodash__WEBPACK_IMPORTED_MODULE_3__.omit)(e,[\"id\",\"phone\"])}}function Ye(){return new He}!function(e){e.CardCode=\"cardCode\",e.CardCodeVerification=\"cardCodeVerification\",e.CardExpiry=\"cardExpiry\",e.CardName=\"cardName\",e.CardNumber=\"cardNumber\",e.CardNumberVerification=\"cardNumberVerification\",e.CardExpiryVerification=\"cardExpiryVerification\"}(qe||(qe={}));const We=qe;function Ke(e){return We.CardNumber in e&&We.CardName in e&&We.CardExpiry in e}function Xe(e){return We.CardNumberVerification in e&&We.CardCodeVerification in e&&We.CardExpiryVerification in e}class Je extends u{constructor(e){super(e||\"Unable to proceed because the client library of a payment method has thrown an unexpected error.\"),this.name=\"PaymentMethodFailedError\",this.type=\"payment_method_client_invalid\"}}var Ze;!function(e){e[e.CheckoutButtonNotInitialized=0]=\"CheckoutButtonNotInitialized\",e[e.CustomerNotInitialized=1]=\"CustomerNotInitialized\",e[e.PaymentNotInitialized=2]=\"PaymentNotInitialized\",e[e.ShippingNotInitialized=3]=\"ShippingNotInitialized\",e[e.SpamProtectionNotInitialized=4]=\"SpamProtectionNotInitialized\"}(Ze||(Ze={}));class Qe extends u{constructor(e){super(function(e){switch(e){case Ze.CustomerNotInitialized:return\"Unable to proceed because the customer step of checkout has not been initialized.\";case Ze.PaymentNotInitialized:return\"Unable to proceed because the payment step of checkout has not been initialized.\";case Ze.ShippingNotInitialized:return\"Unable to proceed because the shipping step of checkout has not been initialized.\";case Ze.SpamProtectionNotInitialized:return\"Unable to proceed because the checkout spam protection has not been initialized.\";default:return\"Unable to proceed because the required component has not been initialized.\"}}(e)),this.subtype=e,this.name=\"NotInitializedError\",this.type=\"not_initialized\"}}class et extends u{constructor(e,t){super(t||\"Unable to proceed because the payment form contains invalid data.\"),this.details=e,this.name=\"PaymentInvalidFormError\",this.type=\"payment_invalid_form\"}}var tt=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class it{constructor(e,t,i,n){this.paymentIntegrationService=e,this.paypalIntegrationService=t,this.paypalSdkScriptLoader=i,this.paypalFastlaneUtils=n}initialize(e){return tt(this,void 0,void 0,function*(){const{methodId:t,paypalcommercecreditcards:i,paypalcommerce:n}=e,o=i||n,{form:a,onCreditCardFieldsRenderingError:r,onLoadComplete:s}=o||{};if(!t)throw new _('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!a)throw new _('Unable to proceed because \"options.paypalcommercecreditcards.form\" argument is not provided.');this.hostedFormOptions=a,this.isCreditCardForm=Ke(a.fields),this.isCreditCardVaultedForm=Xe(a.fields)&&!this.hasUndefinedValues(),yield this.paymentIntegrationService.loadPaymentMethod(t),yield this.paypalIntegrationService.loadPayPalSdk(t,void 0,!0,!0),(this.isCreditCardForm||this.isCreditCardVaultedForm)&&(yield this.initializeFields(a,r)),null==s||s(),this.shouldInitializePayPalFastlane(t)&&(yield this.initializePayPalFastlaneOrThrow(t))})}execute(e,t){return tt(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]),{methodId:o,paymentData:a}=i||{};if(!i||!o)throw new we([\"payment\"]);if(this.executionPaymentData=a,this.isCreditCardForm||this.isCreditCardVaultedForm)yield this.validateHostedFormOrThrow(),yield this.submitHostedForm();else{const{orderId:e}=yield this.paypalIntegrationService.createOrderCardFields(\"paypalcommercecreditcardscheckout\",this.getInstrumentParams());this.returnedOrderId=e}const r=this.preparePaymentPayload(o,a,this.returnedOrderId,this.returnedVaultedToken);yield this.paymentIntegrationService.submitOrder(n,t),yield this.paymentIntegrationService.submitPayment(r)})}finalize(){return Promise.reject(new Pe)}deinitialize(){var e,t,i,n;return tt(this,void 0,void 0,function*(){return yield null===(e=this.cvvField)||void 0===e?void 0:e.close(),yield null===(t=this.expiryField)||void 0===t?void 0:t.close(),yield null===(i=this.numberField)||void 0===i?void 0:i.close(),yield null===(n=this.nameField)||void 0===n?void 0:n.close(),Promise.resolve()})}preparePaymentPayload(e,t,i,n){const{shouldSaveInstrument:o=!1,shouldSetAsDefaultInstrument:r=!1}=Ce(t)?t:{},s=t&&Oe(t)?t.instrumentId:void 0,l=(0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)({verification_nonce:n,token:s},lodash__WEBPACK_IMPORTED_MODULE_3__.isNil);return{methodId:e,paymentData:{shouldSaveInstrument:o,shouldSetAsDefaultInstrument:r,instrumentId:s,formattedPayload:Object.assign(Object.assign({},n||s?{bigpay_token:l}:{}),i?{card_with_order:{order_id:i}}:{})}}}initializeFields(e,t){return tt(this,void 0,void 0,function*(){const{fields:i,styles:n}=e,o=this.paypalIntegrationService.getPayPalSdkOrThrow(),a=this.getExecuteCallback(i),r=Object.assign({style:this.getInputStyles(n),onApprove:({orderID:e,vaultSetupToken:t,liabilityShift:i})=>{if(i===S.No||i===S.Unknown)throw new Error;return this.handleApprove({orderID:e,vaultSetupToken:t})},onError:()=>{throw new Je},inputEvents:{onChange:t=>this.onChangeHandler(e,t),onFocus:t=>this.onFocusHandler(e,t),onBlur:t=>this.onBlurHandler(e,t),onInputSubmitRequest:t=>this.onInputSubmitRequest(e,t)}},a);if(this.cardFields=yield o.CardFields(r),!this.cardFields.isEligible())throw new Qe(Ze.PaymentNotInitialized);try{this.stylizeInputContainers(i),Ke(i)&&(yield this.renderFields(i)),Xe(i)&&(yield this.renderVaultedFields(i))}catch(e){\"function\"==typeof t&&t(e)}})}getExecuteCallback(e){return Xe(e)?this.createVaultSetupTokenCallback():this.createOrderCallback()}createVaultSetupTokenCallback(){return{createVaultSetupToken:()=>tt(this,void 0,void 0,function*(){const{setupToken:e}=(yield this.paypalIntegrationService.createOrderCardFields(\"paypalcommercecreditcardscheckout\",Object.assign(Object.assign({},this.getInstrumentParams()),{setupToken:!0})))||{};return e})}}createOrderCallback(){return{createOrder:()=>tt(this,void 0,void 0,function*(){const{orderId:e}=(yield this.paypalIntegrationService.createOrderCardFields(\"paypalcommercecreditcardscheckout\",this.getInstrumentParams()))||{};return e})}}handleApprove({orderID:e,vaultSetupToken:t}){e&&(this.returnedOrderId=e),t&&(this.returnedVaultedToken=t)}renderFields(e){var t,i,n,o;return tt(this,void 0,void 0,function*(){const a=this.getCardFieldsOrThrow();(null===(t=e.cardCode)||void 0===t?void 0:t.containerId)&&(this.cvvField=a.CVVField({placeholder:\"\"}),yield this.cvvField.render(`#${e.cardCode.containerId}`)),(null===(i=e.cardExpiry)||void 0===i?void 0:i.containerId)&&(this.expiryField=a.ExpiryField(),yield this.expiryField.render(`#${e.cardExpiry.containerId}`)),(null===(n=e.cardName)||void 0===n?void 0:n.containerId)&&(this.nameField=a.NameField({placeholder:\"\"}),yield this.nameField.render(`#${e.cardName.containerId}`)),(null===(o=e.cardNumber)||void 0===o?void 0:o.containerId)&&(this.numberField=a.NumberField({placeholder:\"\"}),yield this.numberField.render(`#${e.cardNumber.containerId}`))})}renderVaultedFields(e){var t,i,n;return tt(this,void 0,void 0,function*(){const o=this.getCardFieldsOrThrow();(null===(t=e.cardCodeVerification)||void 0===t?void 0:t.containerId)&&(this.cvvField=o.CVVField({placeholder:\"\"}),yield this.cvvField.render(`#${e.cardCodeVerification.containerId}`)),(null===(i=e.cardExpiryVerification)||void 0===i?void 0:i.containerId)&&(this.expiryField=o.ExpiryField(),yield this.expiryField.render(`#${e.cardExpiryVerification.containerId}`)),(null===(n=e.cardNumberVerification)||void 0===n?void 0:n.containerId)&&(this.numberField=o.NumberField({placeholder:\"\"}),yield this.numberField.render(`#${e.cardNumberVerification.containerId}`))})}getInstrumentParams(){if(!this.executionPaymentData)return{};if(Ce(this.executionPaymentData)){const{shouldSaveInstrument:e,shouldSetAsDefaultInstrument:t}=this.executionPaymentData;return{shouldSaveInstrument:e,shouldSetAsDefaultInstrument:t}}if(Oe(this.executionPaymentData)){const{instrumentId:e}=this.executionPaymentData;return{instrumentId:e}}return{}}getFieldTypeByEmittedField({emittedBy:e}){return{fieldType:this.mapFieldType(e)}}submitHostedForm(){return tt(this,void 0,void 0,function*(){const e=this.getCardFieldsOrThrow(),t=this.paymentIntegrationService.getState().getBillingAddressOrThrow(),i={billingAddress:{company:t.company,addressLine1:t.address1,addressLine2:t.address2,adminArea1:t.stateOrProvinceCode,adminArea2:t.city,postalCode:t.postalCode,countryCode:t.countryCode}};try{this.isCreditCardVaultedForm?yield e.submit():yield e.submit(i)}catch(e){throw new Je(\"Failed authentication. Please try to authorize again.\")}})}validateHostedFormOrThrow(){var e,t;return tt(this,void 0,void 0,function*(){const i=this.getCardFieldsOrThrow(),n=yield i.getState().then(e=>e),o=this.getValidityData(n);if(!o.isValid)throw null===(t=null===(e=this.hostedFormOptions)||void 0===e?void 0:e.onValidate)||void 0===t||t.call(e,o),new et(this.mapValidationErrors(o.errors))})}getValidityData({fields:e}){const t=Object.assign({},e);delete t.cardNameField;const i=Object.keys(t);return{isValid:i.every(e=>{var i;return null===(i=t[e])||void 0===i?void 0:i.isValid}),errors:i.reduce((e,i)=>{var n;const o=this.mapFieldType(i);return Object.assign(Object.assign({},e),{[o]:(null===(n=t[i])||void 0===n?void 0:n.isValid)?void 0:[this.getInvalidErrorByFieldType(o)]})},{})}}getInvalidErrorByFieldType(e){switch(e){case We.CardCode:case We.CardCodeVerification:return{fieldType:e,message:\"Invalid card code\",type:\"invalid_card_code\"};case We.CardNumber:case We.CardNumberVerification:return{fieldType:e,message:\"Invalid card number\",type:\"invalid_card_number\"};case We.CardExpiry:case We.CardExpiryVerification:return{fieldType:e,message:\"Invalid card expiry\",type:\"invalid_card_expiry\"};default:return{fieldType:e,message:\"Invalid field\",type:\"invalid\"}}}mapValidationErrors(e={}){const t={};return Object.keys(e).forEach(i=>{var n,o;t[i]=[{message:(null===(o=null===(n=e[i])||void 0===n?void 0:n[0])||void 0===o?void 0:o.message)||\"\",type:i}]}),t}mapFieldType(e){switch(e){case\"name\":return We.CardName;case\"cardNumberField\":case\"number\":return this.isCreditCardForm?We.CardNumber:We.CardNumberVerification;case\"cardExpiryField\":case\"expiry\":return this.isCreditCardForm?We.CardExpiry:We.CardExpiryVerification;case\"cardCvvField\":case\"cvv\":return this.isCreditCardForm?We.CardCode:We.CardCodeVerification;default:throw new Error(\"Unexpected field type\")}}getCardFieldsOrThrow(){if(!this.cardFields)throw new Qe(Ze.PaymentNotInitialized);return this.cardFields}getInputStyles(e){var t,i,n;const o={\"font-size\":(null===(t=null==e?void 0:e.default)||void 0===t?void 0:t.fontSize)||\"1rem\",\"font-family\":(null===(i=null==e?void 0:e.default)||void 0===i?void 0:i.fontFamily)||\"Montserrat, Arial, Helvetica, sans-serif\",\"font-weight\":(null===(n=null==e?void 0:e.default)||void 0===n?void 0:n.fontWeight)||\"400\",outline:\"none\",padding:\"9px 13px\"},a=Object.assign(Object.assign({},o),{color:\"#333333\"});return{input:a,\".invalid\":Object.assign(Object.assign({},o),{color:\"red\"}),\".valid\":a,\":focus\":a}}stylizeInputContainers(e){Object.values(e||{}).forEach(e=>{const t=document.getElementById(`${(null==e?void 0:e.containerId)||\"\"}`);t&&(t.style.padding=\"0px\",t.style.boxShadow=\"none\",t.style.border=\"none\",t.style.background=\"transparent\",t.style.marginBottom=\"10px\",t.style.marginLeft=\"-5px\")})}hasUndefinedValues(){return!this.hostedFormOptions||Object.values(this.hostedFormOptions.fields).some(e=>void 0===e)}onChangeHandler(e,t){var i;null===(i=null==e?void 0:e.onValidate)||void 0===i||i.call(e,this.getValidityData(t))}onFocusHandler(e,t){var i;null===(i=null==e?void 0:e.onFocus)||void 0===i||i.call(e,this.getFieldTypeByEmittedField(t))}onBlurHandler(e,t){var i;null===(i=null==e?void 0:e.onBlur)||void 0===i||i.call(e,this.getFieldTypeByEmittedField(t))}onInputSubmitRequest(e,t){var i;null===(i=null==e?void 0:e.onEnter)||void 0===i||i.call(e,this.getFieldTypeByEmittedField(t))}shouldInitializePayPalFastlane(e){var t,i;const n=this.paymentIntegrationService.getState(),o=n.getPaymentMethodOrThrow(e),a=n.getPaymentProviderCustomer(),r=(s=a)&&(\"authenticationState\"in s||\"addresses\"in s||\"instruments\"in s)?a:{};var s;return(null===(t=null==o?void 0:o.initializationData)||void 0===t?void 0:t.isAcceleratedCheckoutEnabled)&&(null===(i=null==o?void 0:o.initializationData)||void 0===i?void 0:i.isPayPalCommerceAnalyticsV2Enabled)&&!(null==r?void 0:r.authenticationState)}initializePayPalFastlaneOrThrow(e){return tt(this,void 0,void 0,function*(){try{const t=this.paymentIntegrationService.getState(),i=t.getCartOrThrow(),n=t.getPaymentMethodOrThrow(e),{initializationData:o}=n;if(!(null==o?void 0:o.connectClientToken))return;const a=yield this.paypalSdkScriptLoader.getPayPalFastlaneSdk(n,i.currency.code,i.id);yield this.paypalFastlaneUtils.initializePayPalFastlane(a,!!(null==o?void 0:o.isDeveloperModeApplicable))}catch(e){}})}}const nt=p(e=>new it(e,oe(e),Q(),Ye()),[{id:\"paypalcommercecreditcards\"}]);var ot=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class at{constructor(e,t,i,n=3e3,o=3e5){this.paymentIntegrationService=e,this.paypalCommerceIntegrationService=t,this.loadingIndicator=i,this.pollingInterval=n,this.maxPollingIntervalTime=o,this.pollingTimer=0,this.stopPolling=lodash__WEBPACK_IMPORTED_MODULE_3__.noop}initialize(e){return ot(this,void 0,void 0,function*(){const{gatewayId:t,methodId:i,paypalcommerceratepay:n}=e;if(!i)throw new _('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new _('Unable to initialize payment because \"options.gatewayId\" argument is not provided.');if(!n)throw new _('Unable to initialize payment because \"options.paypalcommerceratepay\" argument is not provided.');const{legalTextContainer:o,container:a,loadingContainerId:r}=n;if(!a)throw new _('Unable to initialize payment because \"options.container\" argument is not provided.');if(!o)throw new _('Unable to initialize payment because \"options.legalTextContainer\" argument is not provided.');if(!r)throw new _('Unable to initialize payment because \"options.loadingContainerId\" argument is not provided.');this.loadingIndicatorContainer=r;const s=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(i,t),{merchantId:d}=s.initializationData||{};if(!d)throw new _(\"Unable to initialize payment because merchantId argument is not provided.\");this.paypalcommerceratepay=n,yield this.paypalCommerceIntegrationService.loadPayPalSdk(i),this.createFraudNetScript(d,i,t),this.loadFraudnetConfig(),this.renderLegalText(o,a)})}execute(e,t){return ot(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]),{getFieldsValues:o}=this.paypalcommerceratepay||{};if(!i)throw new we([\"payment\"]);if(!o||\"function\"!=typeof o)throw new _('Unable to initialize payment because \"options.getFieldsValues\" argument is not provided.');this.toggleLoadingIndicator(!0);try{const e=yield this.paypalCommerceIntegrationService.createOrder(\"paypalcommercealternativemethodscheckout\",{metadataId:this.guid}),{ratepayBirthDate:a,ratepayPhoneNumber:r,ratepayPhoneCountryCode:s}=o(),d={formattedPayload:{vault_payment_instrument:null,set_as_default_stored_instrument:null,device_info:null,method_id:i.methodId,rate_pay:{birth_date:this.normalizeDate(a),phone:{national_number:r,country_code:s.split(\"+\")[1]}},paypal_account:{order_id:e}}};return yield this.paymentIntegrationService.submitOrder(n,t),yield this.paymentIntegrationService.submitPayment({methodId:i.methodId,paymentData:d}),yield new Promise((e,t)=>{this.initializePollingMechanism(i.methodId,e,t,i.gatewayId)})}catch(e){return this.handleError(e),new Promise((e,t)=>t())}})}finalize(){return Promise.reject(new Pe)}deinitialize(){const{legalTextContainer:e}=this.paypalcommerceratepay||{},t=document.querySelectorAll('[data-id=\"fraudnetScript\"]')[0],i=document.querySelectorAll('[data-id=\"fraudnetConfig\"]')[0];if(this.deinitializePollingMechanism(),t.remove(),i.remove(),e){const t=document.getElementById(e);null==t||t.remove()}return Promise.resolve()}normalizeDate(e){const t=this.formatDate(e.getDate()),i=this.formatDate(e.getMonth()+1);return`${e.getFullYear()}-${i}-${t}`}formatDate(e){return`${e<10?0:\"\"}${e}`}renderLegalText(e,t){const i=e,n=t.split(\"#\")[1],o=document.getElementById(n),a=null==o?void 0:o.parentNode,r=document.createElement(\"div\");r.style.marginBottom=\"20px\",r.setAttribute(\"id\",i),null==a||a.prepend(r);const s=this.paypalCommerceIntegrationService.getPayPalSdkOrThrow(),d=s.Legal({fundingSource:s.Legal.FUNDING.PAY_UPON_INVOICE});if(!document.getElementById(i))throw new _('Unable to initialize payment because \"legalTextContainerElement\" argument is not found.');d.render(`#${i}`)}handleError(e){const{onError:t}=this.paypalcommerceratepay||{};this.resetPollingMechanism(),this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}createFraudNetScript(e,t,i){const n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t,i),{testMode:o}=n.config,a=document.createElement(\"script\");a.setAttribute(\"type\",\"application/json\"),a.setAttribute(\"fncls\",\"fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99\"),a.setAttribute(\"data-id\",\"fraudnetScript\"),this.guid=this.generateGUID();const r={f:this.guid,s:`${e}_checkout-page`,sandbox:o};a.innerHTML=JSON.stringify(r),document.body.appendChild(a)}generateGUID(){let e=\"\";for(let t=0;t<32;t+=1)e+=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\"[Math.floor(62*Math.random())];return e}loadFraudnetConfig(){const e=document.createElement(\"script\");e.setAttribute(\"data-id\",\"fraudnetConfig\"),e.src=\"https://c.paypal.com/da/r/fb.js\",document.body.appendChild(e)}reinitializeStrategy(e){return ot(this,void 0,void 0,function*(){yield this.deinitialize(),yield this.initialize(e)})}initializePollingMechanism(e,t,i,n){return ot(this,void 0,void 0,function*(){yield new Promise((e,t)=>{const i=setTimeout(e,this.pollingInterval);this.stopPolling=()=>(clearTimeout(i),this.toggleLoadingIndicator(!1),t())});try{this.pollingTimer+=this.pollingInterval;const o=yield this.paypalCommerceIntegrationService.getOrderStatus(\"paypalcommercealternativemethods\",{params:{useMetadata:!0}}),a=o===O.PollingStop,r=o===O.PollingError;if(a)return this.deinitializePollingMechanism(),t();if(r)return i();if(!a&&this.pollingTimer<this.maxPollingIntervalTime)return yield this.initializePollingMechanism(e,t,i,n);yield this.reinitializeStrategy({methodId:e,gatewayId:n,paypalcommerceratepay:this.paypalcommerceratepay}),this.handleError(new je)}catch(e){this.handleError(e),i()}})}deinitializePollingMechanism(){this.stopPolling(),this.pollingTimer=0}resetPollingMechanism(){this.deinitializePollingMechanism()}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}}const rt=p(e=>new at(e,N(e),new Se({containerStyles:Object.assign(Object.assign({},Ie),{position:\"fixed\"})})),[{gateway:\"paypalcommercealternativemethods\",id:\"ratepay\"}]);function st(e){return\"string\"!=typeof e}function dt(e,t){if(t||e)return function(e){var t,i;const n={},o=(0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)(e.root,st),a=(0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)(e.input,st),r=(0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)(e.toggle,st),s=(0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)(null===(t=e.text)||void 0===t?void 0:t.body,st),l=(0,lodash__WEBPACK_IMPORTED_MODULE_3__.omitBy)(null===(i=e.text)||void 0===i?void 0:i.caption,st),c=e.branding;return Object.keys(o).length&&(n.root=o),Object.keys(a).length&&(n.input=a),Object.keys(r).length&&(n.toggle=r),Object.keys(s).length&&(n.text={},n.text.body=s),Object.keys(l).length&&(n.text=Object.assign({},n.text),n.text.caption=l),c&&(n.branding=c),n}(function(e,t){var i,n,o,a,r,s,d,l,c,p,u,h,y,m,g,v,f,S,I,w,b,P;return{root:{backgroundColorPrimary:(null==e?void 0:e.fastlaneRootSettingsBackgroundColor)||(null===(i=null==t?void 0:t.root)||void 0===i?void 0:i.backgroundColorPrimary),errorColor:(null==e?void 0:e.fastlaneRootSettingsErrorColor)||(null===(n=null==t?void 0:t.root)||void 0===n?void 0:n.errorColor),fontFamily:(null==e?void 0:e.fastlaneRootSettingsFontFamily)||(null===(o=null==t?void 0:t.root)||void 0===o?void 0:o.fontFamily),fontSizeBase:(null==e?void 0:e.fastlaneRootSettingsFontSize)||(null===(a=null==t?void 0:t.root)||void 0===a?void 0:a.fontSizeBase),padding:(null==e?void 0:e.fastlaneRootSettingsPadding)||(null===(r=null==t?void 0:t.root)||void 0===r?void 0:r.padding),primaryColor:(null==e?void 0:e.fastlaneRootSettingsPrimaryColor)||(null===(s=null==t?void 0:t.root)||void 0===s?void 0:s.primaryColor)},input:{borderRadius:(null==e?void 0:e.fastlaneInputSettingsBorderRadius)||(null===(d=null==t?void 0:t.input)||void 0===d?void 0:d.borderRadius),borderColor:(null==e?void 0:e.fastlaneInputSettingsBorderColor)||(null===(l=null==t?void 0:t.input)||void 0===l?void 0:l.borderColor),focusBorderColor:(null==e?void 0:e.fastlaneInputSettingsFocusBorderBase)||(null===(c=null==t?void 0:t.input)||void 0===c?void 0:c.focusBorderColor),backgroundColor:(null==e?void 0:e.fastlaneInputSettingsBackgroundColor)||(null===(p=null==t?void 0:t.input)||void 0===p?void 0:p.backgroundColor),borderWidth:(null==e?void 0:e.fastlaneInputSettingsBorderWidth)||(null===(u=null==t?void 0:t.input)||void 0===u?void 0:u.borderWidth),textColorBase:(null==e?void 0:e.fastlaneInputSettingsTextColorBase)||(null===(h=null==t?void 0:t.input)||void 0===h?void 0:h.textColorBase)},toggle:{colorPrimary:(null==e?void 0:e.fastlaneToggleSettingsColorPrimary)||(null===(y=null==t?void 0:t.toggle)||void 0===y?void 0:y.colorPrimary),colorSecondary:(null==e?void 0:e.fastlaneToggleSettingsColorSecondary)||(null===(m=null==t?void 0:t.toggle)||void 0===m?void 0:m.colorSecondary)},text:{body:{color:(null==e?void 0:e.fastlaneTextBodySettingsColor)||(null===(v=null===(g=null==t?void 0:t.text)||void 0===g?void 0:g.body)||void 0===v?void 0:v.color),fontSize:(null==e?void 0:e.fastlaneTextBodySettingsFontSize)||(null===(S=null===(f=null==t?void 0:t.text)||void 0===f?void 0:f.body)||void 0===S?void 0:S.fontSize)},caption:{color:(null==e?void 0:e.fastlaneTextCaptionSettingsColor)||(null===(w=null===(I=null==t?void 0:t.text)||void 0===I?void 0:I.caption)||void 0===w?void 0:w.color),fontSize:(null==e?void 0:e.fastlaneTextCaptionSettingsFontSize)||(null===(P=null===(b=null==t?void 0:t.text)||void 0===b?void 0:b.caption)||void 0===P?void 0:P.fontSize)}},branding:(null==e?void 0:e.fastlaneBrandingSettings)||(null==t?void 0:t.branding)}}(e,t))}function lt(e){return!!e&&(\"authenticationState\"in e||\"addresses\"in e||\"instruments\"in e)}var ct=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class pt{constructor(e,t,i,n){this.paymentIntegrationService=e,this.paypalCommerceRequestSender=t,this.paypalSdkScriptLoader=i,this.paypalFastlaneUtils=n}initialize(e){var t,i;return ct(this,void 0,void 0,function*(){const{methodId:n,paypalcommercefastlane:o}=e;if(this.methodId=n,this.paypalcommercefastlane=o,!n)throw new _('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!o)throw new _('Unable to initialize payment because \"options.paypalcommercefastlane\" argument is not provided.');if(!o.onInit||\"function\"!=typeof o.onInit)throw new _('Unable to initialize payment because \"options.paypalcommercefastlane.onInit\" argument is not provided or it is not a function.');if(!o.onChange||\"function\"!=typeof o.onChange)throw new _('Unable to initialize payment because \"options.paypalcommercefastlane.onChange\" argument is not provided or it is not a function.');yield this.paymentIntegrationService.loadPaymentMethod(n);const a=this.paymentIntegrationService.getState(),r=a.getCartOrThrow(),s=a.getPaymentMethodOrThrow(n),{isDeveloperModeApplicable:d,isFastlaneStylingEnabled:l}=s.initializationData||{};this.threeDSVerificationMethod=null===(t=s.initializationData)||void 0===t?void 0:t.threeDSVerificationMethod,this.paypalFastlaneSdk=yield this.paypalSdkScriptLoader.getPayPalFastlaneSdk(s,r.currency.code,r.id);const c=dt(l?null===(i=null==s?void 0:s.initializationData)||void 0===i?void 0:i.fastlaneStyles:{},null==o?void 0:o.styles);yield this.paypalFastlaneUtils.initializePayPalFastlane(this.paypalFastlaneSdk,!!d,c),this.shouldRunAuthenticationFlow()&&(yield this.runPayPalAuthenticationFlowOrThrow(n)),yield this.initializePayPalPaymentComponent(),o.onInit(e=>this.renderPayPalPaymentComponent(e)),o.onChange(()=>this.handlePayPalStoredInstrumentChange(n))})}execute(e,t){return ct(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(i[n[o]]=e[n[o]])}return i}(e,[\"payment\"]);if(!i)throw new we([\"payment\"]);const{paymentData:o,methodId:a}=i,r=o&&Oe(o);try{yield this.paymentIntegrationService.submitOrder(n,t);const e=r?yield this.prepareVaultedInstrumentPaymentPayload(a,o):yield this.preparePaymentPayload(a,o);yield this.paymentIntegrationService.submitPayment(e),this.paypalFastlaneUtils.removeStorageSessionId()}catch(e){if(function(e){return\"object\"==typeof e&&null!==e&&\"message\"in e&&\"response\"in e&&\"body\"in e.response&&\"name\"in e.response.body}(e)&&\"INVALID_REQUEST\"===e.response.body.name){const e={translationKey:\"payment.errors.invalid_request_error\"};return this.handleError(e),Promise.reject()}if(e instanceof Error&&\"FastlaneError\"!==e.name)throw e;return Promise.reject()}})}finalize(){return Promise.reject(new Pe)}deinitialize(){return ct(this,void 0,void 0,function*(){return Promise.resolve()})}shouldRunAuthenticationFlow(){const e=this.paymentIntegrationService.getState(),t=e.getCartOrThrow(),i=e.getCustomerOrThrow(),n=e.getPaymentProviderCustomer(),o=lt(n)?n:{},a=this.paypalFastlaneUtils.getStorageSessionId();return!(!i.isGuest||(null==o?void 0:o.authenticationState)===W.CANCELED||(null==o?void 0:o.authenticationState)||a!==t.id)}runPayPalAuthenticationFlowOrThrow(e){return ct(this,void 0,void 0,function*(){try{const t=this.paymentIntegrationService.getState(),i=t.getCartOrThrow(),n=t.getCustomer(),o=t.getBillingAddress(),a=(null==n?void 0:n.email)||(null==o?void 0:o.email)||\"\",{customerContextId:r}=yield this.paypalFastlaneUtils.lookupCustomerOrThrow(a),s=yield this.paypalFastlaneUtils.triggerAuthenticationFlowOrThrow(r),{authenticationState:d,addresses:l,instruments:c}=this.paypalFastlaneUtils.mapPayPalFastlaneProfileToBcCustomerData(e,s);yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:d,addresses:l,instruments:c}),s.authenticationState===W.CANCELED?this.paypalFastlaneUtils.removeStorageSessionId():this.paypalFastlaneUtils.updateStorageSessionId(i.id)}catch(e){}})}initializePayPalPaymentComponent(){return ct(this,void 0,void 0,function*(){const e=this.paymentIntegrationService.getState().getBillingAddressOrThrow(),t=e.phone,i=`${e.firstName} ${e.lastName}`.trim(),n=this.paypalFastlaneUtils.getPayPalFastlaneOrThrow(),o={fields:Object.assign({cardholderName:{prefill:i,enabled:!0}},t&&{phoneNumber:{prefill:t}})};this.paypalComponentMethods=yield n.FastlaneCardComponent(o)})}renderPayPalPaymentComponent(e){const t=this.getPayPalComponentMethodsOrThrow();if(!e)throw new _('Unable to render card component because \"container\" argument is not provided.');t.render(e)}getPayPalComponentMethodsOrThrow(){if(!this.paypalComponentMethods)throw new h;return this.paypalComponentMethods}prepareVaultedInstrumentPaymentPayload(e,t){return ct(this,void 0,void 0,function*(){const{instrumentId:i}=t,n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e).config.is3dsEnabled?yield this.get3DSNonce(i):i;return yield this.createOrder(n),{methodId:e,paymentData:{formattedPayload:{paypal_fastlane_token:{order_id:this.orderId,token:n}}}}})}preparePaymentPayload(e,t){return ct(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState(),n=i.getBillingAddressOrThrow(),o=i.getPaymentMethodOrThrow(e),a=`${n.firstName} ${n.lastName}`.trim(),{getPaymentToken:r}=this.getPayPalComponentMethodsOrThrow(),{id:s}=yield r({name:{fullName:a},billingAddress:this.paypalFastlaneUtils.mapBcToPayPalAddress(n)}),d=o.config.is3dsEnabled?yield this.get3DSNonce(s):s;yield this.createOrder(d);const{shouldSaveInstrument:l=!1,shouldSetAsDefaultInstrument:c=!1}=Ce(t)?t:{};return{methodId:e,paymentData:Object.assign(Object.assign({},t),{shouldSaveInstrument:l,shouldSetAsDefaultInstrument:c,formattedPayload:{paypal_fastlane_token:{order_id:this.orderId,token:d}}})}})}createOrder(e){return ct(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState().getCartOrThrow().id;if(this.methodId){const{orderId:i}=yield this.paypalCommerceRequestSender.createOrder(this.methodId,{cartId:t,fastlaneToken:e});this.orderId=i}})}get3DSNonce(e){var t;return ct(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState(),n=i.getCartOrThrow(),o=i.getOrderOrThrow(),a=i.getStoreConfigOrThrow().links.checkoutLink,r=null===(t=this.paypalFastlaneSdk)||void 0===t?void 0:t.ThreeDomainSecureClient;if(!r)throw new h;const s={amount:o.orderAmount.toFixed(2),currency:n.currency.code,nonce:e,threeDSRequested:this.threeDSVerificationMethod===L.Always,transactionContext:{experience_context:{locale:\"en-US\",return_url:a,cancel_url:a}}},d=yield r.isEligible(s);if(this.threeDSVerificationMethod===L.Always&&!d)throw new be;if(d){const{liabilityShift:e,authenticationState:t,nonce:i}=yield r.show();if(e===S.No||e===S.Unknown||t===$.Errored||t===$.Cancelled)throw new be;if(t===$.Succeeded&&[S.Yes,S.Possible].includes(e))return i}return e})}handlePayPalStoredInstrumentChange(e){return ct(this,void 0,void 0,function*(){const t=this.paypalFastlaneUtils.getPayPalFastlaneOrThrow(),{selectionChanged:i,selectedCard:n}=yield t.profile.showCardSelector();if(i){const t=this.paymentIntegrationService.getState().getPaymentProviderCustomer(),i=lt(t)?t:{},o=this.paypalFastlaneUtils.mapPayPalToBcInstrument(e,n)[0];return yield this.paymentIntegrationService.updatePaymentProviderCustomer(Object.assign(Object.assign({},i),{instruments:[o]})),o}})}handleError(e){var t;(null===(t=this.paypalcommercefastlane)||void 0===t?void 0:t.onError)&&\"function\"==typeof this.paypalcommercefastlane.onError&&this.paypalcommercefastlane.onError(e)}}const ut=p(e=>{const{getHost:i}=e.getState();return new pt(e,new M((0,_bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_1__.createRequestSender)({host:i()})),Q(),Ye())},[{id:\"paypalcommerceacceleratedcheckout\"}]);var ht=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class yt{constructor(e,t){this.paymentIntegrationService=e,this.paypalCommerceIntegrationService=t,this.onError=lodash__WEBPACK_IMPORTED_MODULE_3__.noop}initialize(e){return ht(this,void 0,void 0,function*(){const{paypalcommerce:t,methodId:i}=e;if(!i)throw new _('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new _('Unable to initialize payment because \"options.paypalcommerce\" argument is not provided.');if(!t.container)throw new _('Unable to initialize payment because \"options.paypalcommerce.container\" argument is not provided.');if(t.onClick&&\"function\"!=typeof t.onClick)throw new _('Unable to initialize payment because \"options.paypalcommerce.onClick\" argument is not a function.');this.onError=t.onError||lodash__WEBPACK_IMPORTED_MODULE_3__.noop,this.paymentIntegrationService.getState().getPaymentMethod(i)||(yield this.paymentIntegrationService.loadPaymentMethod(i));const n=yield this.paypalCommerceIntegrationService.loadPayPalSdk(i);n&&n.Buttons&&\"function\"==typeof n.Buttons?this.renderButton(i,t):console.error(\"[BC PayPal]: PayPal Button could not be rendered, due to issues with loading PayPal SDK\")})}deinitialize(){return Promise.resolve()}signIn(e,t){return ht(this,void 0,void 0,function*(){return yield this.paymentIntegrationService.signInCustomer(e,t),Promise.resolve()})}signOut(e){return ht(this,void 0,void 0,function*(){return yield this.paymentIntegrationService.signOutCustomer(e),Promise.resolve()})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}renderButton(e,t){var i,n;const{container:o,onClick:a,onComplete:r}=t,s=this.paypalCommerceIntegrationService.getPayPalSdkOrThrow(),d=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),{isHostedCheckoutEnabled:l,paymentButtonStyles:c,isAppSwitchEnabled:p}=d.initializationData||{},{checkoutTopButtonStyles:u}=c||{},h=Object.assign(Object.assign(Object.assign({},this.isPaypalCommerceAppSwitchEnabled(e)&&{appSwitchWhenAvailable:!0}),{createOrder:()=>this.paypalCommerceIntegrationService.createOrder(\"paypalcommerce\"),onApprove:({orderID:t})=>this.paypalCommerceIntegrationService.tokenizePayment(e,t)}),a&&{onClick:()=>a()}),y=Object.assign(Object.assign({},!p&&{onShippingAddressChange:e=>this.onShippingAddressChange(e),onShippingOptionsChange:e=>this.onShippingOptionsChange(e)}),{onApprove:(t,i)=>this.onHostedCheckoutApprove(t,i,e,r)}),m=Object.assign(Object.assign({fundingSource:s.FUNDING.PAYPAL,style:this.paypalCommerceIntegrationService.getValidButtonStyle(Object.assign(Object.assign({},u),{height:40}))},h),l&&y),g=s.Buttons(m);g.isEligible()?(null===(i=g.hasReturned)||void 0===i?void 0:i.call(g))&&this.isPaypalCommerceAppSwitchEnabled(e)?null===(n=g.resume)||void 0===n||n.call(g):g.render(`#${o}`):this.paypalCommerceIntegrationService.removeElement(o)}onHostedCheckoutApprove(e,t,i,n){return ht(this,void 0,void 0,function*(){if(!e.orderID)throw new y(l.MissingOrderId);const o=this.paymentIntegrationService.getState().getCartOrThrow(),a=yield t.order.get();try{const t=this.paypalCommerceIntegrationService.getBillingAddressFromOrderDetails(a);if(yield this.paymentIntegrationService.updateBillingAddress(t),o.lineItems.physicalItems.length>0){const e=this.paypalCommerceIntegrationService.getShippingAddressFromOrderDetails(a);yield this.paymentIntegrationService.updateShippingAddress(e),yield this.paypalCommerceIntegrationService.updateOrder()}yield this.paymentIntegrationService.submitOrder({},{params:{methodId:i}}),yield this.paypalCommerceIntegrationService.submitPayment(i,e.orderID),n&&\"function\"==typeof n&&n()}catch(e){this.handleError(e)}})}onShippingAddressChange(e){return ht(this,void 0,void 0,function*(){const t=this.paypalCommerceIntegrationService.getAddress({city:e.shippingAddress.city,countryCode:e.shippingAddress.countryCode,postalCode:e.shippingAddress.postalCode,stateOrProvinceCode:e.shippingAddress.state});try{yield this.paymentIntegrationService.updateBillingAddress(t),yield this.paymentIntegrationService.updateShippingAddress(t);const e=this.paypalCommerceIntegrationService.getShippingOptionOrThrow();yield this.paymentIntegrationService.selectShippingOption(e.id),yield this.paypalCommerceIntegrationService.updateOrder()}catch(e){this.handleError(e)}})}onShippingOptionsChange(e){return ht(this,void 0,void 0,function*(){const t=this.paypalCommerceIntegrationService.getShippingOptionOrThrow(e.selectedShippingOption.id);try{yield this.paymentIntegrationService.selectShippingOption(t.id),yield this.paypalCommerceIntegrationService.updateOrder()}catch(e){this.handleError(e)}})}handleError(e){if(\"function\"!=typeof this.onError)throw e;this.onError(e)}isPaypalCommerceAppSwitchEnabled(e){var t;return(null===(t=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e).initializationData)||void 0===t?void 0:t.isAppSwitchEnabled)||!1}}const mt=p(e=>new yt(e,N(e)),[{id:\"paypalcommerce\"}]);var gt=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class vt{constructor(e,t){this.paymentIntegrationService=e,this.paypalCommerceIntegrationService=t,this.onError=lodash__WEBPACK_IMPORTED_MODULE_3__.noop}initialize(e){return gt(this,void 0,void 0,function*(){const{paypalcommercecredit:t,methodId:i}=e;if(!i)throw new _('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new _('Unable to initialize payment because \"options.paypalcommercecredit\" argument is not provided.');if(!t.container)throw new _('Unable to initialize payment because \"options.paypalcommercecredit.container\" argument is not provided.');if(t.onClick&&\"function\"!=typeof t.onClick)throw new _('Unable to initialize payment because \"options.paypalcommercecredit.onClick\" argument is not a function.');this.onError=t.onError||lodash__WEBPACK_IMPORTED_MODULE_3__.noop,this.paymentIntegrationService.getState().getPaymentMethod(i)||(yield this.paymentIntegrationService.loadPaymentMethod(i));const n=yield this.paypalCommerceIntegrationService.loadPayPalSdk(i);n&&n.Buttons&&\"function\"==typeof n.Buttons?this.renderButton(i,t):console.error(\"[BC PayPal]: PayPal Button could not be rendered, due to issues with loading PayPal SDK\")})}deinitialize(){return Promise.resolve()}signIn(e,t){return gt(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return gt(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}renderButton(e,t){const{container:i,onComplete:n,onClick:o}=t,a=this.paypalCommerceIntegrationService.getPayPalSdkOrThrow(),r=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),{isHostedCheckoutEnabled:s,paymentButtonStyles:d,isAppSwitchEnabled:l}=r.initializationData||{},{checkoutTopButtonStyles:c}=d||{},p=Object.assign({createOrder:()=>this.paypalCommerceIntegrationService.createOrder(\"paypalcommercecredit\"),onApprove:({orderID:t})=>this.paypalCommerceIntegrationService.tokenizePayment(e,t)},o&&{onClick:()=>o()}),u=Object.assign(Object.assign({},!l&&{onShippingAddressChange:e=>this.onShippingAddressChange(e),onShippingOptionsChange:e=>this.onShippingOptionsChange(e)}),{onApprove:(t,i)=>this.onHostedCheckoutApprove(t,i,e,n)}),h=[a.FUNDING.PAYLATER,a.FUNDING.CREDIT];let y=!1;h.forEach(e=>{if(!y){const t=Object.assign(Object.assign({fundingSource:e,style:this.paypalCommerceIntegrationService.getValidButtonStyle(Object.assign(Object.assign({},c),{height:40}))},p),s&&u),n=a.Buttons(t);n.isEligible()&&(n.render(`#${i}`),y=!0)}}),y||this.paypalCommerceIntegrationService.removeElement(i)}onHostedCheckoutApprove(e,t,i,n){return gt(this,void 0,void 0,function*(){if(!e.orderID)throw new y(l.MissingOrderId);const o=this.paymentIntegrationService.getState().getCartOrThrow(),a=yield t.order.get();try{const t=this.paypalCommerceIntegrationService.getBillingAddressFromOrderDetails(a);if(yield this.paymentIntegrationService.updateBillingAddress(t),o.lineItems.physicalItems.length>0){const e=this.paypalCommerceIntegrationService.getShippingAddressFromOrderDetails(a);yield this.paymentIntegrationService.updateShippingAddress(e),yield this.paypalCommerceIntegrationService.updateOrder()}yield this.paymentIntegrationService.submitOrder({},{params:{methodId:i}}),yield this.paypalCommerceIntegrationService.submitPayment(i,e.orderID),n&&\"function\"==typeof n&&n()}catch(e){this.handleError(e)}})}onShippingAddressChange(e){return gt(this,void 0,void 0,function*(){const t=this.paypalCommerceIntegrationService.getAddress({city:e.shippingAddress.city,countryCode:e.shippingAddress.countryCode,postalCode:e.shippingAddress.postalCode,stateOrProvinceCode:e.shippingAddress.state});try{yield this.paymentIntegrationService.updateBillingAddress(t),yield this.paymentIntegrationService.updateShippingAddress(t);const e=this.paypalCommerceIntegrationService.getShippingOptionOrThrow();yield this.paymentIntegrationService.selectShippingOption(e.id),yield this.paypalCommerceIntegrationService.updateOrder()}catch(e){this.handleError(e)}})}onShippingOptionsChange(e){return gt(this,void 0,void 0,function*(){const t=this.paypalCommerceIntegrationService.getShippingOptionOrThrow(e.selectedShippingOption.id);try{yield this.paymentIntegrationService.selectShippingOption(t.id),yield this.paypalCommerceIntegrationService.updateOrder()}catch(e){this.handleError(e)}})}handleError(e){if(\"function\"!=typeof this.onError)throw e;this.onError(e)}}const ft=p(e=>new vt(e,N(e)),[{id:\"paypalcommercecredit\"}]);var St=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class It{constructor(e,t){this.paymentIntegrationService=e,this.paypalCommerceIntegrationService=t}initialize(e){return St(this,void 0,void 0,function*(){const{paypalcommercevenmo:t,methodId:i}=e;if(!i)throw new _('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new _('Unable to initialize payment because \"options.paypalcommercevenmo\" argument is not provided.');if(!t.container)throw new _('Unable to initialize payment because \"options.paypalcommercevenmo.container\" argument is not provided.');if(t.onClick&&\"function\"!=typeof t.onClick)throw new _('Unable to initialize payment because \"options.paypalcommercevenmo.onClick\" argument is not a function.');this.paymentIntegrationService.getState().getPaymentMethod(i)||(yield this.paymentIntegrationService.loadPaymentMethod(i));const n=yield this.paypalCommerceIntegrationService.loadPayPalSdk(i);n&&n.Buttons&&\"function\"==typeof n.Buttons?this.renderButton(i,t):console.error(\"[BC PayPal]: PayPal Button could not be rendered, due to issues with loading PayPal SDK\")})}deinitialize(){return Promise.resolve()}signIn(e,t){return St(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return St(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}renderButton(e,t){const{container:i,onClick:n}=t,o=this.paypalCommerceIntegrationService.getPayPalSdkOrThrow(),a=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),{paymentButtonStyles:r}=a.initializationData||{},{checkoutTopButtonStyles:s}=r||{},d=Object.assign({fundingSource:o.FUNDING.VENMO,style:this.paypalCommerceIntegrationService.getValidButtonStyle(Object.assign(Object.assign({},s),{height:40})),createOrder:()=>this.paypalCommerceIntegrationService.createOrder(\"paypalcommercevenmo\"),onApprove:({orderID:t})=>this.paypalCommerceIntegrationService.tokenizePayment(e,t)},n&&{onClick:()=>n()}),l=o.Buttons(d);l.isEligible()?l.render(`#${i}`):this.paypalCommerceIntegrationService.removeElement(i)}}const wt=p(e=>new It(e,N(e)),[{id:\"paypalcommercevenmo\"}]);var bt=function(e,t,i,n){return new(i||(i=Promise))(function(o,a){function r(e){try{d(n.next(e))}catch(e){a(e)}}function s(e){try{d(n.throw(e))}catch(e){a(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(r,s)}d((n=n.apply(e,t||[])).next())})};class Pt{constructor(e,t,i){this.paymentIntegrationService=e,this.paypalSdkScriptLoader=t,this.paypalFastlaneUtils=i}initialize(e){var t;return bt(this,void 0,void 0,function*(){const{methodId:i,paypalcommercefastlane:n}=e;if(!i)throw new _('Unable to proceed because \"methodId\" argument is not provided.');try{yield this.paymentIntegrationService.loadPaymentMethod(i);const e=this.paymentIntegrationService.getState(),o=e.getCartOrThrow(),a=e.getPaymentMethodOrThrow(i),r=!!(null===(t=a.initializationData)||void 0===t?void 0:t.isDeveloperModeApplicable),s=yield this.paypalSdkScriptLoader.getPayPalFastlaneSdk(a,o.currency.code,o.id);yield this.paypalFastlaneUtils.initializePayPalFastlane(s,r,this.getFastlaneStyles(i,n))}catch(e){}return Promise.resolve()})}deinitialize(){return bt(this,void 0,void 0,function*(){return Promise.resolve()})}signIn(e,t){return bt(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return bt(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){return bt(this,void 0,void 0,function*(){const{checkoutPaymentMethodExecuted:t,continueWithCheckoutCallback:i,methodId:n}=e||{};if(!n)throw new _('Unable to proceed because \"methodId\" argument is not provided.');if(\"function\"!=typeof i)throw new _('Unable to proceed because \"continueWithCheckoutCallback\" argument is not provided and it must be a function.');if(this.paymentIntegrationService.getState().getCustomerOrThrow().isGuest){t&&\"function\"==typeof t&&t();try{yield this.runPayPalAuthenticationFlowOrThrow(n)}catch(e){}}i()})}runPayPalAuthenticationFlowOrThrow(e){return bt(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState(),i=t.getCartOrThrow().id,n=t.getCustomer(),o=t.getBillingAddress(),a=(null==n?void 0:n.email)||(null==o?void 0:o.email)||\"\",{customerContextId:r}=yield this.paypalFastlaneUtils.lookupCustomerOrThrow(a),s=yield this.paypalFastlaneUtils.triggerAuthenticationFlowOrThrow(r),d=s.authenticationState===W.CANCELED;yield this.updateCustomerDataState(e,s),d?this.paypalFastlaneUtils.removeStorageSessionId():this.paypalFastlaneUtils.updateStorageSessionId(i)})}updateCustomerDataState(e,t){var i;return bt(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState().getCartOrThrow(),{authenticationState:o,addresses:a,billingAddress:r,shippingAddress:s,instruments:d}=this.paypalFastlaneUtils.mapPayPalFastlaneProfileToBcCustomerData(e,t);if(yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:o,addresses:a,instruments:d}),r&&(yield this.paymentIntegrationService.updateBillingAddress(r)),s&&n.lineItems.physicalItems.length>0){const t=yield this.paymentIntegrationService.updateShippingAddress(s),n=t.getPaymentMethodOrThrow(e),{isFastlaneShippingOptionAutoSelectEnabled:o}=n.initializationData||{},a=t.getConsignments()||[],r=(null===(i=a[0])||void 0===i?void 0:i.availableShippingOptions)||[],d=r[0],l=r.find(e=>e.isRecommended);if((l||d)&&o){const e=(null==l?void 0:l.id)||d.id;yield this.paymentIntegrationService.selectShippingOption(e)}}})}getFastlaneStyles(e,t){const i=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e),{fastlaneStyles:n,isFastlaneStylingEnabled:o}=i.initializationData||{};return dt(o?n:{},null==t?void 0:t.styles)}}const Ct=p(e=>new Pt(e,Q(),Ye()),[{id:\"paypalcommerceacceleratedcheckout\"},{id:\"paypalcommercecreditcards\"}]);\n//# sourceMappingURL=paypal-commerce.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vY2hlY2tvdXQtc2RrLWpzL2Rpc3QvZXNtL2ludGVncmF0aW9ucy9wYXlwYWwtY29tbWVyY2UuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBK1IsV0FBVyxnQkFBZ0Isd0JBQXdCLGFBQWEsRUFBRSxZQUFZLCtEQUErRCx1QkFBdUIsRUFBRSxzREFBc0Qsc0JBQXNCLGVBQWUsTUFBTSx1VEFBdVQsa0JBQWtCLGVBQWUsK01BQStNLGFBQWEsc3lCQUFzeUIsU0FBUyxHQUFHLGtCQUFrQixlQUFlLGtCQUFrQixVQUFVLG9HQUFvRywrRUFBK0UsK0ZBQStGLHVGQUF1Rix1RkFBdUYsNEhBQTRILGlGQUFpRixzR0FBc0cscUZBQXFGLGdIQUFnSCw2SEFBNkgsc0dBQXNHLDZFQUE2RSwyRUFBMkUsa0JBQWtCLGVBQWUsd0xBQXdMLFNBQVMsT0FBTyxXQUFXLFdBQVcsa0JBQWtCLGVBQWUsbUJBQW1CLEdBQUcsRUFBRSxNQUFNLDBCQUEwQixNQUFNLHVKQUF1SixvQkFBb0IsYUFBYSxtQkFBbUIsU0FBUyxlQUFlLGdFQUFnRSxTQUFTLGVBQWUsNENBQTRDLFNBQVMsZUFBZSxrR0FBa0csU0FBUyxlQUFlLDhFQUE4RSxTQUFTLGVBQWUsNEJBQTRCLFNBQVMsZUFBZSw4QkFBOEIsU0FBUyxlQUFlLG9KQUFvSixTQUFTLEdBQUcsd0JBQXdCLHlDQUF5QyxjQUFjLElBQUksYUFBYSxTQUFTLE1BQU0sY0FBYyxJQUFJLGNBQWMsU0FBUyxNQUFNLGNBQWMsTUFBTSxnRUFBZ0UsS0FBSyxhQUFhLCtCQUErQixHQUFHLFFBQVEscUJBQXFCLHdIQUF3SCx1QkFBdUIsd0NBQXdDLHVIQUF1SCxpR0FBaUcsRUFBRSxzQkFBc0IsK0JBQStCLHNCQUFzQiwyQkFBMkIsd0NBQXdDLHFDQUFxQyxpQ0FBaUMsSUFBSSxnRUFBZ0UsU0FBUyxhQUFhLEVBQUUsaUJBQWlCLHdDQUF3Qyx1RUFBdUUsVUFBVSxxRUFBcUUsU0FBUyxLQUFLLFNBQVMsRUFBRSwyQkFB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QixHQUFHLFNBQVMsbUJBQW1CLHlGQUF5RixjQUFjLE1BQU0seUNBQXlDLE1BQU0sb0NBQW9DLEdBQUcsb0ZBQW9GLElBQUksMERBQTBELDJRQUEyUSx5RkFBeUYsVUFBVSx5QkFBeUIsRUFBRSxlQUFlLHlDQUF5Qyx5QkFBeUIsRUFBRSxZQUFZLHlDQUF5Qyx5REFBeUQsRUFBRSxXQUFXLHlDQUF5Qyx3REFBd0QsRUFBRSxnQ0FBZ0MseUNBQXlDLE1BQU0sMEVBQTBFLE9BQU8sb0ZBQW9GLG9KQUFvSiwyRUFBMkUsNkJBQTZCLElBQUksaURBQWlELFdBQVcsSUFBSSxFQUFFLHNDQUFzQyx5Q0FBeUMsOEtBQThLLG9CQUFvQixtS0FBbUssK0lBQStJLEVBQUUsNkJBQTZCLE1BQU0seUNBQXlDLG9FQUFvRSxtRkFBbUYsd0VBQXdFLHVFQUF1RSxnREFBZ0QsMkdBQTJHLHNHQUFzRyw0Q0FBNEMseUJBQXlCLHFJQUFxSSxjQUFjLG9DQUFvQywrREFBK0QsRUFBRSx1QkFBdUIsOEVBQThFLDRDQUE0QywwQkFBMEIsZ0JBQWdCLDJCQUEyQixtQ0FBbUMsdUNBQXVDLEVBQUUsK0JBQStCLEdBQXV1QjtBQUN6anpIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2hlY2tvdXQvLi4vY2hlY2tvdXQtc2RrLWpzL2Rpc3QvZXNtL2ludGVncmF0aW9ucy9wYXlwYWwtY29tbWVyY2UuanM/ZWUwNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnR7Y3JlYXRlRm9ybVBvc3RlciBhcyBlfWZyb21cIkBiaWdjb21tZXJjZS9mb3JtLXBvc3RlclwiO2ltcG9ydHtjcmVhdGVSZXF1ZXN0U2VuZGVyIGFzIHR9ZnJvbVwiQGJpZ2NvbW1lcmNlL3JlcXVlc3Qtc2VuZGVyXCI7aW1wb3J0e2NyZWF0ZVNjcmlwdExvYWRlciBhcyBpLGdldFNjcmlwdExvYWRlciBhcyBufWZyb21cIkBiaWdjb21tZXJjZS9zY3JpcHQtbG9hZGVyXCI7aW1wb3J0e2lzRXF1YWwgYXMgbyxpc05pbCBhcyBhLG5vb3AgYXMgcixvbWl0IGFzIHMsb21pdEJ5IGFzIGR9ZnJvbVwibG9kYXNoXCI7dmFyIGwsYz17fTtmdW5jdGlvbiBwKGUsdCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oZSx7cmVzb2x2ZUlkczp0fSl9Yy5kPShlLHQpPT57Zm9yKHZhciBpIGluIHQpYy5vKHQsaSkmJiFjLm8oZSxpKSYmT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsaSx7ZW51bWVyYWJsZTohMCxnZXQ6dFtpXX0pfSxjLm89KGUsdCk9Pk9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHQpO2NsYXNzIHUgZXh0ZW5kcyBFcnJvcntjb25zdHJ1Y3RvcihlKXt2YXIgdDtzdXBlcihlfHxcIkFuIHVuZXhwZWN0ZWQgZXJyb3IgaGFzIG9jY3VycmVkLlwiKSx0aGlzLm5hbWU9XCJTdGFuZGFyZEVycm9yXCIsdGhpcy50eXBlPVwic3RhbmRhcmRcIix0PW5ldy50YXJnZXQucHJvdG90eXBlLE9iamVjdC5zZXRQcm90b3R5cGVPZj9PYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyx0KTp0aGlzLl9fcHJvdG9fXz10LFwiZnVuY3Rpb25cIj09dHlwZW9mIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlP0Vycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsbmV3LnRhcmdldCk6dGhpcy5zdGFjaz1uZXcgRXJyb3IodGhpcy5tZXNzYWdlKS5zdGFja319Y2xhc3MgaCBleHRlbmRzIHV7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBjbGllbnQgbGlicmFyeSBvZiBhIHBheW1lbnQgbWV0aG9kIGlzIG5vdCBsb2FkZWQgb3IgcmVhZHkgdG8gYmUgdXNlZC5cIiksdGhpcy5uYW1lPVwiUGF5bWVudE1ldGhvZENsaWVudFVuYXZhaWxhYmxlRXJyb3JcIix0aGlzLnR5cGU9XCJwYXltZW50X21ldGhvZF9jbGllbnRfdW5hdmFpbGFibGVcIn19IWZ1bmN0aW9uKGUpe2VbZS5NaXNzaW5nQmlsbGluZ0FkZHJlc3M9MF09XCJNaXNzaW5nQmlsbGluZ0FkZHJlc3NcIixlW2UuTWlzc2luZ0NhcnQ9MV09XCJNaXNzaW5nQ2FydFwiLGVbZS5NaXNzaW5nQ2hlY2tvdXQ9Ml09XCJNaXNzaW5nQ2hlY2tvdXRcIixlW2UuTWlzc2luZ0NvbnNpZ25tZW50cz0zXT1cIk1pc3NpbmdDb25zaWdubWVudHNcIixlW2UuTWlzc2luZ0N1c3RvbWVyPTRdPVwiTWlzc2luZ0N1c3RvbWVyXCIsZVtlLk1pc3NpbmdDaGVja291dENvbmZpZz01XT1cIk1pc3NpbmdDaGVja291dENvbmZpZ1wiLGVbZS5NaXNzaW5nT3JkZXI9Nl09XCJNaXNzaW5nT3JkZXJcIixlW2UuTWlzc2luZ09yZGVyQ29uZmlnPTddPVwiTWlzc2luZ09yZGVyQ29uZmlnXCIsZVtlLk1pc3NpbmdPcmRlcklkPThdPVwiTWlzc2luZ09yZGVySWRcIixlW2UuTWlzc2luZ1BheW1lbnQ9OV09XCJNaXNzaW5nUGF5bWVudFwiLGVbZS5NaXNzaW5nUGF5bWVudElkPTEwXT1cIk1pc3NpbmdQYXltZW50SWRcIixlW2UuTWlzc2luZ1BheW1lbnRJbnN0cnVtZW50PTExXT1cIk1pc3NpbmdQYXltZW50SW5zdHJ1bWVudFwiLGVbZS5NaXNzaW5nUGF5bWVudE1ldGhvZD0xMl09XCJNaXNzaW5nUGF5bWVudE1ldGhvZFwiLGVbZS5NaXNzaW5nUGF5bWVudFJlZGlyZWN0VXJsPTEzXT1cIk1pc3NpbmdQYXltZW50UmVkaXJlY3RVcmxcIixlW2UuTWlzc2luZ1BheW1lbnRTdGF0dXM9MTRdPVwiTWlzc2luZ1BheW1lbnRTdGF0dXNcIixlW2UuTWlzc2luZ1BheW1lbnRUb2tlbj0xNV09XCJNaXNzaW5nUGF5bWVudFRva2VuXCIsZVtlLk1pc3NpbmdTaGlwcGluZ0FkZHJlc3M9MTZdPVwiTWlzc2luZ1NoaXBwaW5nQWRkcmVzc1wifShsfHwobD17fSkpO2NsYXNzIHkgZXh0ZW5kcyB1e2NvbnN0cnVjdG9yKGUpe3N1cGVyKGZ1bmN0aW9uKGUpe3N3aXRjaChlKXtjYXNlIGwuTWlzc2luZ0JpbGxpbmdBZGRyZXNzOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBiaWxsaW5nIGFkZHJlc3MgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIGwuTWlzc2luZ0NhcnQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGNhcnQgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIGwuTWlzc2luZ0NvbnNpZ25tZW50czpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgY29uc2lnbm1lbnRzIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBsLk1pc3NpbmdDaGVja291dDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgY2hlY2tvdXQgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIGwuTWlzc2luZ0N1c3RvbWVyOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBjdXN0b21lciBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgbC5NaXNzaW5nQ2hlY2tvdXRDb25maWc6Y2FzZSBsLk1pc3NpbmdPcmRlckNvbmZpZzpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgY29uZmlndXJhdGlvbiBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgbC5NaXNzaW5nT3JkZXI6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIG9yZGVyIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBsLk1pc3NpbmdPcmRlcklkOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBvcmRlciBJRCBpcyB1bmF2YWlsYWJsZSBvciBub3QgZ2VuZXJhdGVkIHlldC5cIjtjYXNlIGwuTWlzc2luZ1BheW1lbnQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHBheW1lbnQgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIGwuTWlzc2luZ1BheW1lbnRUb2tlbjpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHRva2VuIHJlcXVpcmVkIHRvIHN1Ym1pdCBhIHBheW1lbnQgaXMgbWlzc2luZy5cIjtjYXNlIGwuTWlzc2luZ1BheW1lbnRNZXRob2Q6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHBheW1lbnQgbWV0aG9kIGRhdGEgaXMgdW5hdmFpbGFibGUgb3Igbm90IHByb3Blcmx5IGNvbmZpZ3VyZWQuXCI7Y2FzZSBsLk1pc3NpbmdTaGlwcGluZ0FkZHJlc3M6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHNoaXBwaW5nIGFkZHJlc3MgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtkZWZhdWx0OnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgcmVxdWlyZWQgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIn19KGUpKSx0aGlzLnN1YnR5cGU9ZSx0aGlzLm5hbWU9XCJNaXNzaW5nRGF0YUVycm9yXCIsdGhpcy50eXBlPVwibWlzc2luZ19kYXRhXCJ9fWNsYXNzIG0gZXh0ZW5kcyB1e2NvbnN0cnVjdG9yKGUpe3N1cGVyKGV8fFwiQW4gdW5leHBlY3RlZCBlcnJvciBoYXMgb2NjdXJyZWQgZHVyaW5nIGJ1eSBub3cgY2FydCBjcmVhdGlvbiBwcm9jZXNzLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiKSx0aGlzLm5hbWU9XCJCdXlOb3dDYXJ0Q3JlYXRpb25FcnJvclwiLHRoaXMudHlwZT1cImJ1eV9ub3dfY2FydF9jcmVhdGlvbl9lcnJvclwifX1jb25zdCBnPXtib2R5Ont9LGhlYWRlcnM6e30sc3RhdHVzOjB9O2NsYXNzIHYgZXh0ZW5kcyB1e2NvbnN0cnVjdG9yKGUse21lc3NhZ2U6dCxlcnJvcnM6aX09e30pe2NvbnN0e2JvZHk6bixoZWFkZXJzOm8sc3RhdHVzOmF9PWV8fGc7c3VwZXIodHx8XCJBbiB1bmV4cGVjdGVkIGVycm9yIGhhcyBvY2N1cnJlZC5cIiksdGhpcy5uYW1lPVwiUmVxdWVzdEVycm9yXCIsdGhpcy50eXBlPVwicmVxdWVzdFwiLHRoaXMuYm9keT1uLHRoaXMuaGVhZGVycz1vLHRoaXMuc3RhdHVzPWEsdGhpcy5lcnJvcnM9aXx8W119fXZhciBmLFMsSSx3LGIsUCxDLE87IWZ1bmN0aW9uKGUpe2UuQnV5Tm93PVwiQlVZX05PV1wifShmfHwoZj17fSkpLGZ1bmN0aW9uKGUpe2UuUG9zc2libGU9XCJQT1NTSUJMRVwiLGUuTm89XCJOT1wiLGUuVW5rbm93bj1cIlVOS05PV05cIixlLlllcz1cIllFU1wifShTfHwoUz17fSkpLGZ1bmN0aW9uKGUpe2UuQVVUSE9SSVpFPVwiYXV0aG9yaXplXCIsZS5DQVBUVVJFPVwiY2FwdHVyZVwifShJfHwoST17fSkpLGZ1bmN0aW9uKGUpe2UucGF5cGFsPVwicGF5cGFsXCIsZS5jaGVja291dD1cImNoZWNrb3V0XCIsZS5idXlub3c9XCJidXlub3dcIixlLnBheT1cInBheVwiLGUuaW5zdGFsbG1lbnQ9XCJpbnN0YWxsbWVudFwifSh3fHwodz17fSkpLGZ1bmN0aW9uKGUpe2UuZ29sZD1cImdvbGRcIixlLmJsdWU9XCJibHVlXCIsZS5zaWx2ZXI9XCJzaWx2ZXJcIixlLmJsYWNrPVwiYmxhY2tcIixlLndoaXRlPVwid2hpdGVcIn0oYnx8KGI9e30pKSxmdW5jdGlvbihlKXtlLnBpbGw9XCJwaWxsXCIsZS5yZWN0PVwicmVjdFwifShQfHwoUD17fSkpLGZ1bmN0aW9uKGUpe2UuT1hYTz1cIm94eG9cIixlLklERUFMPVwiaWRlYWxcIn0oQ3x8KEM9e30pKSxmdW5jdGlvbihlKXtlLkFwcHJvdmVkPVwiQVBQUk9WRURcIixlLkNyZWF0ZWQ9XCJDUkVBVEVEXCIsZS5QYXllckFjdGlvblJlcXVpcmVkPVwiUEFZRVJfQUNUSU9OX1JFUVVJUkVEXCIsZS5Qb2xsaW5nU3RvcD1cIlBPTExJTkdfU1RPUFwiLGUuUG9sbGluZ0Vycm9yPVwiUE9MTElOR19FUlJPUlwifShPfHwoTz17fSkpO3ZhciBrPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8sYSl7ZnVuY3Rpb24gcihlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHIscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIEF7Y29uc3RydWN0b3IoZSx0LGksbil7dGhpcy5mb3JtUG9zdGVyPWUsdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPXQsdGhpcy5wYXlwYWxDb21tZXJjZVJlcXVlc3RTZW5kZXI9aSx0aGlzLnBheXBhbENvbW1lcmNlU2NyaXB0TG9hZGVyPW59bG9hZFBheVBhbFNkayhlLHQsaSxuKXtyZXR1cm4gayh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgbz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxhPXR8fG8uZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlLHI9by5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKTtyZXR1cm4gdGhpcy5wYXlwYWxTZGs9eWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZVNjcmlwdExvYWRlci5nZXRQYXlQYWxTREsocixhLGksbiksdGhpcy5wYXlwYWxTZGt9KX1nZXRQYXlQYWxTZGtPclRocm93KCl7aWYoIXRoaXMucGF5cGFsU2RrKXRocm93IG5ldyBoO3JldHVybiB0aGlzLnBheXBhbFNka31jcmVhdGVCdXlOb3dDYXJ0T3JUaHJvdyhlKXtyZXR1cm4gayh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD1lLmdldEJ1eU5vd0NhcnRSZXF1ZXN0Qm9keSgpO2lmKCF0KXRocm93IG5ldyB5KGwuTWlzc2luZ0NhcnQpO3RyeXtyZXR1cm4geWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZUJ1eU5vd0NhcnQodCl9Y2F0Y2goZSl7dGhyb3cgbmV3IG19fSl9Y3JlYXRlT3JkZXIoZSx0KXtyZXR1cm4gayh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDYXJ0T3JUaHJvdygpLmlkLHtvcmRlcklkOm59PXlpZWxkIHRoaXMucGF5cGFsQ29tbWVyY2VSZXF1ZXN0U2VuZGVyLmNyZWF0ZU9yZGVyKGUsT2JqZWN0LmFzc2lnbih7Y2FydElkOml9LHQpKTtyZXR1cm4gbn0pfWNyZWF0ZU9yZGVyQ2FyZEZpZWxkcyhlLHQpe3JldHVybiBrKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnRPclRocm93KCkuaWQse29yZGVySWQ6bixzZXR1cFRva2VuOm99PXlpZWxkIHRoaXMucGF5cGFsQ29tbWVyY2VSZXF1ZXN0U2VuZGVyLmNyZWF0ZU9yZGVyKGUsT2JqZWN0LmFzc2lnbih7Y2FydElkOml9LHQpKTtyZXR1cm4gT2JqZWN0LmFzc2lnbih7b3JkZXJJZDpufSxvP3tzZXR1cFRva2VuOm99Ont9KX0pfXVwZGF0ZU9yZGVyKCl7cmV0dXJuIGsodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGU9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksdD1lLmdldENhcnRPclRocm93KCksaT1lLmdldENvbnNpZ25tZW50c09yVGhyb3coKVswXTt0cnl7eWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZVJlcXVlc3RTZW5kZXIudXBkYXRlT3JkZXIoe2F2YWlsYWJsZVNoaXBwaW5nT3B0aW9uczppLmF2YWlsYWJsZVNoaXBwaW5nT3B0aW9ucyxjYXJ0SWQ6dC5pZCxzZWxlY3RlZFNoaXBwaW5nT3B0aW9uOmkuc2VsZWN0ZWRTaGlwcGluZ09wdGlvbn0pfWNhdGNoKGUpe3Rocm93IG5ldyB2fX0pfWdldE9yZGVyU3RhdHVzKGUsdCl7cmV0dXJuIGsodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtjb25zdHtzdGF0dXM6aX09eWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZVJlcXVlc3RTZW5kZXIuZ2V0T3JkZXJTdGF0dXMoZSx0KTtyZXR1cm4gaX1jYXRjaChlKXt0aHJvdyBuZXcgdn19KX10b2tlbml6ZVBheW1lbnQoZSx0KXtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnRPclRocm93KCk7aWYoIXQpdGhyb3cgbmV3IHkobC5NaXNzaW5nT3JkZXJJZCk7cmV0dXJuIHRoaXMuZm9ybVBvc3Rlci5wb3N0Rm9ybShcIi9jaGVja291dC5waHBcIixPYmplY3QuYXNzaWduKHtwYXltZW50X3R5cGU6XCJwYXlwYWxcIixhY3Rpb246XCJzZXRfZXh0ZXJuYWxfY2hlY2tvdXRcIixwcm92aWRlcjplLG9yZGVyX2lkOnR9LGkuc291cmNlPT09Zi5CdXlOb3cmJntjYXJ0X2lkOmkuaWR9KSl9c3VibWl0UGF5bWVudChlLHQsaSl7cmV0dXJuIGsodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IG49e2Zvcm1hdHRlZFBheWxvYWQ6e3ZhdWx0X3BheW1lbnRfaW5zdHJ1bWVudDpudWxsLHNldF9hc19kZWZhdWx0X3N0b3JlZF9pbnN0cnVtZW50Om51bGwsZGV2aWNlX2luZm86bnVsbCxtZXRob2RfaWQ6ZSxwYXlwYWxfYWNjb3VudDp7b3JkZXJfaWQ6dH19fTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChPYmplY3QuYXNzaWduKHttZXRob2RJZDplLHBheW1lbnREYXRhOm59LGk/e2dhdGV3YXlJZDppfTp7fSkpfSl9Z2V0U2hpcHBpbmdPcHRpb25PclRocm93KGUpe2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q29uc2lnbm1lbnRzT3JUaHJvdygpWzBdLGk9dC5hdmFpbGFibGVTaGlwcGluZ09wdGlvbnN8fFtdLG49aS5maW5kKGU9PmUuaXNSZWNvbW1lbmRlZCksbz0oZT9pLmZpbmQodD0+dC5pZD09PWUpOmkuZmluZChlPT57dmFyIGk7cmV0dXJuIGUuaWQ9PT0obnVsbD09PShpPXQuc2VsZWN0ZWRTaGlwcGluZ09wdGlvbil8fHZvaWQgMD09PWk/dm9pZCAwOmkuaWQpfSkpfHxufHxpWzBdO2lmKCFvKXRocm93IG5ldyBFcnJvcihcIllvdXIgb3JkZXIgY2FuJ3QgYmUgc2hpcHBlZCB0byB0aGlzIGFkZHJlc3NcIik7cmV0dXJuIG99Z2V0QWRkcmVzcyhlKXtyZXR1cm57Zmlyc3ROYW1lOihudWxsPT1lP3ZvaWQgMDplLmZpcnN0TmFtZSl8fFwiXCIsbGFzdE5hbWU6KG51bGw9PWU/dm9pZCAwOmUubGFzdE5hbWUpfHxcIlwiLGVtYWlsOihudWxsPT1lP3ZvaWQgMDplLmVtYWlsKXx8XCJcIixwaG9uZToobnVsbD09ZT92b2lkIDA6ZS5waG9uZSl8fFwiXCIsY29tcGFueTpcIlwiLGFkZHJlc3MxOihudWxsPT1lP3ZvaWQgMDplLmFkZHJlc3MxKXx8XCJcIixhZGRyZXNzMjoobnVsbD09ZT92b2lkIDA6ZS5hZGRyZXNzMil8fFwiXCIsY2l0eToobnVsbD09ZT92b2lkIDA6ZS5jaXR5KXx8XCJcIixjb3VudHJ5Q29kZToobnVsbD09ZT92b2lkIDA6ZS5jb3VudHJ5Q29kZSl8fFwiXCIscG9zdGFsQ29kZToobnVsbD09ZT92b2lkIDA6ZS5wb3N0YWxDb2RlKXx8XCJcIixzdGF0ZU9yUHJvdmluY2U6XCJcIixzdGF0ZU9yUHJvdmluY2VDb2RlOihudWxsPT1lP3ZvaWQgMDplLnN0YXRlT3JQcm92aW5jZUNvZGUpfHxcIlwiLGN1c3RvbUZpZWxkczpbXX19Z2V0QmlsbGluZ0FkZHJlc3NGcm9tT3JkZXJEZXRhaWxzKHtwYXllcjplfSl7dmFyIHQsaTtyZXR1cm4gdGhpcy5nZXRBZGRyZXNzKHtmaXJzdE5hbWU6ZS5uYW1lLmdpdmVuX25hbWUsbGFzdE5hbWU6ZS5uYW1lLnN1cm5hbWUsZW1haWw6ZS5lbWFpbF9hZGRyZXNzLGFkZHJlc3MxOmUuYWRkcmVzcy5hZGRyZXNzX2xpbmVfMSxhZGRyZXNzMjplLmFkZHJlc3MuYWRkcmVzc19saW5lXzIsY2l0eTplLmFkZHJlc3MuYWRtaW5fYXJlYV8yLGNvdW50cnlDb2RlOmUuYWRkcmVzcy5jb3VudHJ5X2NvZGUscG9zdGFsQ29kZTplLmFkZHJlc3MucG9zdGFsX2NvZGUsc3RhdGVPclByb3ZpbmNlQ29kZTplLmFkZHJlc3MuYWRtaW5fYXJlYV8xLHBob25lOm51bGw9PT0oaT1udWxsPT09KHQ9ZS5waG9uZSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQucGhvbmVfbnVtYmVyKXx8dm9pZCAwPT09aT92b2lkIDA6aS5uYXRpb25hbF9udW1iZXJ9KX1nZXRTaGlwcGluZ0FkZHJlc3NGcm9tT3JkZXJEZXRhaWxzKGUpe2NvbnN0e3BheWVyOnQscHVyY2hhc2VfdW5pdHM6aX09ZSx7YWRkcmVzczpuLG5hbWU6e2Z1bGxfbmFtZTpvfX09aVswXS5zaGlwcGluZyxbYSwuLi5yXT1vLnNwbGl0KFwiIFwiKTtyZXR1cm4gdGhpcy5nZXRBZGRyZXNzKHtmaXJzdE5hbWU6YSxsYXN0TmFtZTpyLmpvaW4oXCIgXCIpLGVtYWlsOnQuZW1haWxfYWRkcmVzcyxhZGRyZXNzMTpuLmFkZHJlc3NfbGluZV8xLGFkZHJlc3MyOm4uYWRkcmVzc19saW5lXzIsY2l0eTpuLmFkbWluX2FyZWFfMixjb3VudHJ5Q29kZTpuLmNvdW50cnlfY29kZSxwb3N0YWxDb2RlOm4ucG9zdGFsX2NvZGUsc3RhdGVPclByb3ZpbmNlQ29kZTpuLmFkbWluX2FyZWFfMX0pfWdldFZhbGlkQnV0dG9uU3R5bGUoZSl7Y29uc3R7Y29sb3I6dCxoZWlnaHQ6aSxsYWJlbDpuLHNoYXBlOm99PWV8fHt9LHI9e2NvbG9yOnQmJmJbdF0/dDp2b2lkIDAsaGVpZ2h0OnRoaXMuZ2V0VmFsaWRIZWlnaHQoaSksbGFiZWw6biYmd1tuXT9uOnZvaWQgMCxzaGFwZTpvJiZQW29dP286dm9pZCAwfTtyZXR1cm4gZChyLGEpfWdldFZhbGlkSGVpZ2h0KGUpe3JldHVybiBlJiZcIm51bWJlclwiPT10eXBlb2YgZT9lPjU1PzU1OmU8MjU/MjU6ZTo0MH1yZW1vdmVFbGVtZW50KGUpe2NvbnN0IHQ9ZSYmZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSk7dCYmKHQuc3R5bGUuZGlzcGxheT1cIm5vbmVcIil9fWNvbnN0IEU9XCJUaGlzIEFQSSBlbmRwb2ludCBpcyBmb3IgaW50ZXJuYWwgdXNlIG9ubHkgYW5kIG1heSBjaGFuZ2UgaW4gdGhlIGZ1dHVyZVwiO3ZhciBUOyFmdW5jdGlvbihlKXtlLkpzb249XCJhcHBsaWNhdGlvbi9qc29uXCIsZS5Kc29uVjE9XCJhcHBsaWNhdGlvbi92bmQuYmMudjEranNvblwifShUfHwoVD17fSkpO2NvbnN0IHo9VCxGPXtcIlgtQ2hlY2tvdXQtU0RLLVZlcnNpb25cIjpcIjEuODY3LjBcIn07dmFyIEI9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24obyxhKXtmdW5jdGlvbiByKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9vKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4ocixzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgTXtjb25zdHJ1Y3RvcihlKXt0aGlzLnJlcXVlc3RTZW5kZXI9ZX1jcmVhdGVPcmRlcihlLHQpe3JldHVybiBCKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPWAvYXBpL3N0b3JlZnJvbnQvcGF5bWVudC8ke2V9YCxuPXQsbz1PYmplY3QuYXNzaWduKHtcIlgtQVBJLUlOVEVSTkFMXCI6RSxcIkNvbnRlbnQtVHlwZVwiOnouSnNvbn0sRik7cmV0dXJuKHlpZWxkIHRoaXMucmVxdWVzdFNlbmRlci5wb3N0KGkse2hlYWRlcnM6byxib2R5Om59KSkuYm9keX0pfXVwZGF0ZU9yZGVyKGUpe3JldHVybiBCKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PWUsaT1PYmplY3QuYXNzaWduKHtcIlgtQVBJLUlOVEVSTkFMXCI6RSxcIkNvbnRlbnQtVHlwZVwiOnouSnNvbn0sRik7cmV0dXJuKHlpZWxkIHRoaXMucmVxdWVzdFNlbmRlci5wdXQoXCIvYXBpL3N0b3JlZnJvbnQvaW5pdGlhbGl6YXRpb24vcGF5cGFsY29tbWVyY2VcIix7aGVhZGVyczppLGJvZHk6dH0pKS5ib2R5fSl9Z2V0T3JkZXJTdGF0dXMoZT1cInBheXBhbGNvbW1lcmNlXCIsdCl7cmV0dXJuIEIodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9YC9hcGkvc3RvcmVmcm9udC9pbml0aWFsaXphdGlvbi8ke2V9YCxuPU9iamVjdC5hc3NpZ24oe1wiWC1BUEktSU5URVJOQUxcIjpFLFwiQ29udGVudC1UeXBlXCI6ei5Kc29ufSxGKTtyZXR1cm4oeWllbGQgdGhpcy5yZXF1ZXN0U2VuZGVyLmdldChpLE9iamVjdC5hc3NpZ24oe2hlYWRlcnM6bn0sdCkpKS5ib2R5fSl9fXZhciBEPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8sYSl7ZnVuY3Rpb24gcihlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHIscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIHh7Y29uc3RydWN0b3IoZSl7dGhpcy5zY3JpcHRMb2FkZXI9ZSx0aGlzLndpbmRvdz13aW5kb3d9Z2V0UGF5UGFsU0RLKGUsdCxpLG4pe3JldHVybiBEKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBvPXRoaXMuZ2V0UGF5UGFsU2RrU2NyaXB0Q29uZmlnT3JUaHJvdyhlLHQsaSk7cmV0dXJuIHRoaXMubG9hZFBheVBhbFNESyhvLG4pfSl9bG9hZFBheVBhbFNESyhlLHQ9ITEpe3JldHVybiBEKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy53aW5kb3cucGF5cGFsfHx0KXtjb25zdCB0PXRoaXMudHJhbnNmb3JtQ29uZmlnKGUub3B0aW9ucyksaT10aGlzLnRyYW5zZm9ybUNvbmZpZyhlLmF0dHJpYnV0ZXMpLG49YGh0dHBzOi8vd3d3LnBheXBhbC5jb20vc2RrL2pzPyR7bmV3IFVSTFNlYXJjaFBhcmFtcyh0KS50b1N0cmluZygpfWA7eWllbGQgdGhpcy5zY3JpcHRMb2FkZXIubG9hZFNjcmlwdChuLHthc3luYzohMCxhdHRyaWJ1dGVzOml9KX1pZighdGhpcy53aW5kb3cucGF5cGFsKXRocm93IG5ldyBoO3JldHVybiB0aGlzLndpbmRvdy5wYXlwYWx9KX1nZXRQYXlQYWxTZGtTY3JpcHRDb25maWdPclRocm93KGUsdCxpPSEwKXtjb25zdHtpZDpuLGNsaWVudFRva2VuOm8saW5pdGlhbGl6YXRpb25EYXRhOmF9PWU7aWYoIShudWxsPT1hP3ZvaWQgMDphLmNsaWVudElkKSl0aHJvdyBuZXcgeShsLk1pc3NpbmdQYXltZW50TWV0aG9kKTtjb25zdHtpbnRlbnQ6cixjbGllbnRJZDpzLG1lcmNoYW50SWQ6ZCxidXllckNvdW50cnk6YyxhdHRyaWJ1dGlvbklkOnAsaXNWZW5tb0VuYWJsZWQ6dSxpc0hvc3RlZENoZWNrb3V0RW5hYmxlZDpoLGlzUGF5UGFsQ3JlZGl0QXZhaWxhYmxlOm0saXNEZXZlbG9wZXJNb2RlQXBwbGljYWJsZTpnLGF2YWlsYWJsZUFsdGVybmF0aXZlUGF5bWVudE1ldGhvZHM6dj1bXSxlbmFibGVkQWx0ZXJuYXRpdmVQYXltZW50TWV0aG9kczpmPVtdLGlzR29vZ2xlUGF5RW5hYmxlZDpTfT1hLEk9aHx8aSx3PVwicGF5cGFsY29tbWVyY2VjcmVkaXRjYXJkc1wiPT09bixiPXc/W1wiY2FyZFwiXTpbXSxQPW0/W1wiY3JlZGl0XCIsXCJwYXlsYXRlclwiXTpbXSxDPXU/W1widmVubW9cIl06W10sTz1TP1tcImdvb2dsZXBheVwiXTpbXSxrPWk/W1wiY2FyZC1maWVsZHNcIl06W10sQT1bLi4udz9bXTpbXCJjYXJkXCJdLC4uLm0/W106W1wiY3JlZGl0XCIsXCJwYXlsYXRlclwiXSwuLi51P1tdOltcInZlbm1vXCJdLC4uLnYuZmlsdGVyKGU9PiFmLmluY2x1ZGVzKGUpKV0sRT1bLi4uYiwuLi5QLC4uLkMsLi4uZl07cmV0dXJue29wdGlvbnM6T2JqZWN0LmFzc2lnbih7XCJjbGllbnQtaWRcIjpzLFwibWVyY2hhbnQtaWRcIjpkLFwiZW5hYmxlLWZ1bmRpbmdcIjpFLmxlbmd0aD4wP0U6dm9pZCAwLFwiZGlzYWJsZS1mdW5kaW5nXCI6QS5sZW5ndGg+MD9BOnZvaWQgMCxjb21taXQ6SSxjb21wb25lbnRzOltcImJ1dHRvbnNcIixcImhvc3RlZC1maWVsZHNcIixcInBheW1lbnQtZmllbGRzXCIsXCJsZWdhbFwiLC4uLk8sLi4ua10sY3VycmVuY3k6dCxpbnRlbnQ6cn0sZyYme1wiYnV5ZXItY291bnRyeVwiOmN9KSxhdHRyaWJ1dGVzOntcImRhdGEtcGFydG5lci1hdHRyaWJ1dGlvbi1pZFwiOnAsXCJkYXRhLWNsaWVudC10b2tlblwiOm99fX10cmFuc2Zvcm1Db25maWcoZSl7bGV0IHQ9e307cmV0dXJuIE9iamVjdC5rZXlzKGUpLmZvckVhY2goaT0+e2NvbnN0IG49ZVtpXTtudWxsPT1ufHxcIlwiPT09bnx8QXJyYXkuaXNBcnJheShuKSYmMD09PW4ubGVuZ3RofHwodD1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse1tpXTpBcnJheS5pc0FycmF5KG4pP24uam9pbihcIixcIik6bn0pKX0pLHR9fWNvbnN0IE49aT0+e2NvbnN0e2dldEhvc3Q6b309aS5nZXRTdGF0ZSgpO3JldHVybiBuZXcgQShlKCksaSxuZXcgTSh0KHtob3N0Om8oKX0pKSxuZXcgeChuKCkpKX07Y2xhc3MgXyBleHRlbmRzIHV7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJJbnZhbGlkIGFyZ3VtZW50cyBoYXZlIGJlZW4gcHJvdmlkZWQuXCIpLHRoaXMubmFtZT1cIkludmFsaWRBcmd1bWVudEVycm9yXCIsdGhpcy50eXBlPVwiaW52YWxpZF9hcmd1bWVudFwifX12YXIgaj1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihvLGEpe2Z1bmN0aW9uIHIoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP28oZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihyLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBVe2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZT10fWluaXRpYWxpemUoZSl7dmFyIHQ7cmV0dXJuIGoodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheXBhbGNvbW1lcmNlOmksY29udGFpbmVySWQ6bixtZXRob2RJZDpvfT1lLGE9Qm9vbGVhbihudWxsPT1pP3ZvaWQgMDppLmJ1eU5vd0luaXRpYWxpemVPcHRpb25zKTtpZighbyl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighbil0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5jb250YWluZXJJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighaSl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5wYXlwYWxjb21tZXJjZVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZihhJiYhaS5jdXJyZW5jeUNvZGUpdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMucGF5cGFsY29tbWVyY2UuY3VycmVuY3lDb2RlXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKGEmJlwiZnVuY3Rpb25cIiE9dHlwZW9mKG51bGw9PT0odD1pLmJ1eU5vd0luaXRpYWxpemVPcHRpb25zKXx8dm9pZCAwPT09dD92b2lkIDA6dC5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkpKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLnBheXBhbGNvbW1lcmNlLmJ1eU5vd0luaXRpYWxpemVPcHRpb25zLmdldEJ1eU5vd0NhcnRSZXF1ZXN0Qm9keVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZCBvciBpdCBpcyBub3QgYSBmdW5jdGlvbi4nKTthfHwoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWREZWZhdWx0Q2hlY2tvdXQoKSk7Y29uc3Qgcj1hP2kuY3VycmVuY3lDb2RlOnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZTt5aWVsZCB0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXlQYWxTZGsobyxyLCExKSx0aGlzLnJlbmRlckJ1dHRvbihuLG8saSxhKX0pfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKX1yZW5kZXJCdXR0b24oZSx0LGksbil7dmFyIG8sYTtjb25zdHtidXlOb3dJbml0aWFsaXplT3B0aW9uczpyLHN0eWxlOnMsb25Db21wbGV0ZTpkLG9uRWxpZ2liaWxpdHlGYWlsdXJlOmx9PWksYz10aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheVBhbFNka09yVGhyb3coKSxwPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KHQpLHtpc0hvc3RlZENoZWNrb3V0RW5hYmxlZDp1LGlzQXBwU3dpdGNoRW5hYmxlZDpofT1wLmluaXRpYWxpemF0aW9uRGF0YXx8e30seT1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIW4mJnRoaXMuaXNQYXlwYWxDb21tZXJjZUFwcFN3aXRjaEVuYWJsZWQodCkmJnthcHBTd2l0Y2hXaGVuQXZhaWxhYmxlOiEwfSkse2NyZWF0ZU9yZGVyOigpPT50aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZU9yZGVyKFwicGF5cGFsY29tbWVyY2VcIiksb25BcHByb3ZlOih7b3JkZXJJRDplfSk9PnRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UudG9rZW5pemVQYXltZW50KHQsZSl9KSxtPXtvbkNsaWNrOigpPT50aGlzLmhhbmRsZUNsaWNrKHIpLG9uQ2FuY2VsOigpPT50aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZERlZmF1bHRDaGVja291dCgpfSxnPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwhaCYme29uU2hpcHBpbmdBZGRyZXNzQ2hhbmdlOmU9PnRoaXMub25TaGlwcGluZ0FkZHJlc3NDaGFuZ2UoZSksb25TaGlwcGluZ09wdGlvbnNDaGFuZ2U6ZT0+dGhpcy5vblNoaXBwaW5nT3B0aW9uc0NoYW5nZShlKX0pLHtvbkFwcHJvdmU6KGUsaSk9PnRoaXMub25Ib3N0ZWRDaGVja291dEFwcHJvdmUoZSxpLHQsZCl9KSx2PU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHtmdW5kaW5nU291cmNlOmMuRlVORElORy5QQVlQQUwsc3R5bGU6dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5nZXRWYWxpZEJ1dHRvblN0eWxlKHMpfSx5KSxyJiZtKSx1JiZnKSxmPWMuQnV0dG9ucyh2KTtmLmlzRWxpZ2libGUoKT8obnVsbD09PShvPWYuaGFzUmV0dXJuZWQpfHx2b2lkIDA9PT1vP3ZvaWQgMDpvLmNhbGwoZikpJiZ0aGlzLmlzUGF5cGFsQ29tbWVyY2VBcHBTd2l0Y2hFbmFibGVkKHQpP251bGw9PT0oYT1mLnJlc3VtZSl8fHZvaWQgMD09PWF8fGEuY2FsbChmKTpmLnJlbmRlcihgIyR7ZX1gKTpsJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBsP2woKTp0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQoZSl9aGFuZGxlQ2xpY2soZSl7cmV0dXJuIGoodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKGUpe2NvbnN0IHQ9eWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5jcmVhdGVCdXlOb3dDYXJ0T3JUaHJvdyhlKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZENoZWNrb3V0KHQuaWQpfX0pfW9uSG9zdGVkQ2hlY2tvdXRBcHByb3ZlKGUsdCxpLG4pe3JldHVybiBqKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighZS5vcmRlcklEKXRocm93IG5ldyB5KGwuTWlzc2luZ09yZGVySWQpO2NvbnN0IG89dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKSxhPXlpZWxkIHQub3JkZXIuZ2V0KCk7dHJ5e2NvbnN0IHQ9dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5nZXRCaWxsaW5nQWRkcmVzc0Zyb21PcmRlckRldGFpbHMoYSk7aWYoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZUJpbGxpbmdBZGRyZXNzKHQpLG8ubGluZUl0ZW1zLnBoeXNpY2FsSXRlbXMubGVuZ3RoPjApe2NvbnN0IGU9dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5nZXRTaGlwcGluZ0FkZHJlc3NGcm9tT3JkZXJEZXRhaWxzKGEpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVTaGlwcGluZ0FkZHJlc3MoZSkseWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS51cGRhdGVPcmRlcigpfXJldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIoe30se3BhcmFtczp7bWV0aG9kSWQ6aX19KSx5aWVsZCB0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoaSxlLm9yZGVySUQpLG4mJlwiZnVuY3Rpb25cIj09dHlwZW9mIG4mJm4oKSwhMH1jYXRjaChlKXtpZihcInN0cmluZ1wiPT10eXBlb2YgZSl0aHJvdyBuZXcgRXJyb3IoZSk7dGhyb3cgZX19KX1vblNoaXBwaW5nQWRkcmVzc0NoYW5nZShlKXtyZXR1cm4gaih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldEFkZHJlc3Moe2NpdHk6ZS5zaGlwcGluZ0FkZHJlc3MuY2l0eSxjb3VudHJ5Q29kZTplLnNoaXBwaW5nQWRkcmVzcy5jb3VudHJ5Q29kZSxwb3N0YWxDb2RlOmUuc2hpcHBpbmdBZGRyZXNzLnBvc3RhbENvZGUsc3RhdGVPclByb3ZpbmNlQ29kZTplLnNoaXBwaW5nQWRkcmVzcy5zdGF0ZX0pO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3ModCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVNoaXBwaW5nQWRkcmVzcyh0KTtjb25zdCBlPXRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U2hpcHBpbmdPcHRpb25PclRocm93KCk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNlbGVjdFNoaXBwaW5nT3B0aW9uKGUuaWQpLHlpZWxkIHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlT3JkZXIoKX1jYXRjaChlKXtpZihcInN0cmluZ1wiPT10eXBlb2YgZSl0aHJvdyBuZXcgRXJyb3IoZSk7dGhyb3cgZX19KX1vblNoaXBwaW5nT3B0aW9uc0NoYW5nZShlKXtyZXR1cm4gaih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFNoaXBwaW5nT3B0aW9uT3JUaHJvdyhlLnNlbGVjdGVkU2hpcHBpbmdPcHRpb24uaWQpO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2VsZWN0U2hpcHBpbmdPcHRpb24odC5pZCkseWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS51cGRhdGVPcmRlcigpfWNhdGNoKGUpe2lmKFwic3RyaW5nXCI9PXR5cGVvZiBlKXRocm93IG5ldyBFcnJvcihlKTt0aHJvdyBlfX0pfWlzUGF5cGFsQ29tbWVyY2VBcHBTd2l0Y2hFbmFibGVkKGUpe3ZhciB0O3JldHVybihudWxsPT09KHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSkuaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09dD92b2lkIDA6dC5pc0FwcFN3aXRjaEVuYWJsZWQpfHwhMX19Y29uc3QgVj1wKGU9Pm5ldyBVKGUsTihlKSksW3tpZDpcInBheXBhbGNvbW1lcmNlXCJ9XSk7dmFyIFIsTCwkLHEsRyxILFksVyxLLFgsSj1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihvLGEpe2Z1bmN0aW9uIHIoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP28oZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihyLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBae2NvbnN0cnVjdG9yKGUpe3RoaXMuc2NyaXB0TG9hZGVyPWUsdGhpcy53aW5kb3c9d2luZG93fWdldFBheVBhbFNESyhlLHQsaSxuKXtyZXR1cm4gSih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMud2luZG93LnBheXBhbHx8bil7Y29uc3Qgbj10aGlzLmdldFBheVBhbFNka1NjcmlwdENvbmZpZ09yVGhyb3coZSx0LGkpO2lmKHlpZWxkIHRoaXMubG9hZFBheVBhbFNkayhuKSwhdGhpcy53aW5kb3cucGF5cGFsKXRocm93IG5ldyBofXJldHVybiB0aGlzLndpbmRvdy5wYXlwYWx9KX1nZXRQYXlQYWxGYXN0bGFuZVNkayhlLHQsaSl7cmV0dXJuIEoodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLndpbmRvdy5wYXlwYWxGYXN0bGFuZVNkayl7Y29uc3Qgbj10aGlzLmdldFBheVBhbEZhc3RsYW5lU2RrQ29uZmlndXJhdGlvbihlLHQsaSk7aWYoeWllbGQgdGhpcy5sb2FkUGF5UGFsU2RrKG4pLCF0aGlzLndpbmRvdy5wYXlwYWxGYXN0bGFuZVNkayl0aHJvdyBuZXcgaH1yZXR1cm4gdGhpcy53aW5kb3cucGF5cGFsRmFzdGxhbmVTZGt9KX1nZXRQYXlQYWxHb29nbGVQYXlTZGsoZSx0LGksbil7cmV0dXJuIEoodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLndpbmRvdy5wYXlwYWxHb29nbGVQYXl8fG4pe2NvbnN0IG49dGhpcy5nZXRQYXlQYWxHb29nbGVQYXlTZGtTY3JpcHRDb25maWdPclRocm93KGUsdCxpKTt5aWVsZCB0aGlzLmxvYWRQYXlQYWxTZGsobil9aWYoIXRoaXMud2luZG93LnBheXBhbEdvb2dsZVBheSl0aHJvdyBuZXcgaDtyZXR1cm4gdGhpcy53aW5kb3cucGF5cGFsR29vZ2xlUGF5fSl9Z2V0UGF5UGFsQXBtc1NkayhlLHQpe3JldHVybiBKKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy53aW5kb3cucGF5cGFsQXBtcyl7Y29uc3QgaT10aGlzLmdldFBheVBhbEFwbVNka0NvbmZpZ3VyYXRpb24oZSx0KTtpZih5aWVsZCB0aGlzLmxvYWRQYXlQYWxTZGsoaSksIXRoaXMud2luZG93LnBheXBhbEFwbXMpdGhyb3cgbmV3IGh9cmV0dXJuIHRoaXMud2luZG93LnBheXBhbEFwbXN9KX1nZXRQYXlQYWxNZXNzYWdlcyhlLHQpe3JldHVybiBKKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy53aW5kb3cucGF5cGFsTWVzc2FnZXMpe2NvbnN0IGk9dGhpcy5nZXRQYXlQYWxTZGtNZXNzYWdlc0NvbmZpZ3VyYXRpb24oZSx0KTt5aWVsZCB0aGlzLmxvYWRQYXlQYWxTZGsoaSl9aWYoIXRoaXMud2luZG93LnBheXBhbE1lc3NhZ2VzKXRocm93IG5ldyBoO3JldHVybiB0aGlzLndpbmRvdy5wYXlwYWxNZXNzYWdlc30pfWxvYWRQYXlQYWxTZGsoe29wdGlvbnM6ZSxhdHRyaWJ1dGVzOnR9KXtyZXR1cm4gSih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgaT10aGlzLnRyYW5zZm9ybUNvbmZpZyhlKSxuPXRoaXMudHJhbnNmb3JtQ29uZmlnKHQpLG89YGh0dHBzOi8vd3d3LnBheXBhbC5jb20vc2RrL2pzPyR7bmV3IFVSTFNlYXJjaFBhcmFtcyhpKS50b1N0cmluZygpfWA7eWllbGQgdGhpcy5zY3JpcHRMb2FkZXIubG9hZFNjcmlwdChvLHthc3luYzohMCxhdHRyaWJ1dGVzOm59KX0pfWdldFBheVBhbFNka1NjcmlwdENvbmZpZ09yVGhyb3coZSx0LGk9ITApe2NvbnN0e2lkOm4sY2xpZW50VG9rZW46byxpbml0aWFsaXphdGlvbkRhdGE6YX09ZTtpZighYXx8IWEuY2xpZW50SWQpdGhyb3cgbmV3IHkobC5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3R7aW50ZW50OnIsY2xpZW50SWQ6cyxtZXJjaGFudElkOmQsYnV5ZXJDb3VudHJ5OmMsYXR0cmlidXRpb25JZDpwLGlzVmVubW9FbmFibGVkOnUsaXNIb3N0ZWRDaGVja291dEVuYWJsZWQ6aCxpc1BheVBhbENyZWRpdEF2YWlsYWJsZTptLGlzRGV2ZWxvcGVyTW9kZUFwcGxpY2FibGU6ZyxhdmFpbGFibGVBbHRlcm5hdGl2ZVBheW1lbnRNZXRob2RzOnY9W10sZW5hYmxlZEFsdGVybmF0aXZlUGF5bWVudE1ldGhvZHM6Zj1bXSxpc0dvb2dsZVBheUVuYWJsZWQ6U309YSxJPWh8fGksdz1cInBheXBhbGNvbW1lcmNlY3JlZGl0Y2FyZHNcIj09PW58fFwiYmlnY29tbWVyY2VfcGF5bWVudHNfY3JlZGl0Y2FyZHNcIj09PW4sYj13P1tcImNhcmRcIl06W10sUD1tP1tcImNyZWRpdFwiLFwicGF5bGF0ZXJcIl06W10sQz11P1tcInZlbm1vXCJdOltdLE89Uz9bXCJnb29nbGVwYXlcIl06W10saz1pP1tcImNhcmQtZmllbGRzXCJdOltdLEE9Wy4uLnc/W106W1wiY2FyZFwiXSwuLi5tP1tdOltcImNyZWRpdFwiLFwicGF5bGF0ZXJcIl0sLi4udT9bXTpbXCJ2ZW5tb1wiXSwuLi52LmZpbHRlcihlPT4hZi5pbmNsdWRlcyhlKSldLEU9Wy4uLmIsLi4uUCwuLi5DLC4uLmZdO3JldHVybntvcHRpb25zOk9iamVjdC5hc3NpZ24oe1wiY2xpZW50LWlkXCI6cyxcIm1lcmNoYW50LWlkXCI6ZCxcImVuYWJsZS1mdW5kaW5nXCI6RS5sZW5ndGg+MD9FOnZvaWQgMCxcImRpc2FibGUtZnVuZGluZ1wiOkEubGVuZ3RoPjA/QTp2b2lkIDAsY29tbWl0OkksY29tcG9uZW50czpbXCJidXR0b25zXCIsXCJob3N0ZWQtZmllbGRzXCIsXCJwYXltZW50LWZpZWxkc1wiLFwibGVnYWxcIiwuLi5PLC4uLmtdLGN1cnJlbmN5OnQsaW50ZW50OnJ9LGcmJntcImJ1eWVyLWNvdW50cnlcIjpjfSksYXR0cmlidXRlczp7XCJkYXRhLXBhcnRuZXItYXR0cmlidXRpb24taWRcIjpwLFwiZGF0YS1jbGllbnQtdG9rZW5cIjpvfX19Z2V0UGF5UGFsRmFzdGxhbmVTZGtDb25maWd1cmF0aW9uKGUsdCxpKXtjb25zdHtjbGllbnRUb2tlbjpuLGluaXRpYWxpemF0aW9uRGF0YTpvfT1lO2lmKCFvfHwhby5jbGllbnRJZCl0aHJvdyBuZXcgeShsLk1pc3NpbmdQYXltZW50TWV0aG9kKTtjb25zdHtpbnRlbnQ6YSxjbGllbnRJZDpyLG1lcmNoYW50SWQ6cyxhdHRyaWJ1dGlvbklkOmR9PW87cmV0dXJue29wdGlvbnM6e1wiY2xpZW50LWlkXCI6cixcIm1lcmNoYW50LWlkXCI6cyxjb21taXQ6ITAsY29tcG9uZW50czpbXCJmYXN0bGFuZVwiLFwiYnV0dG9uc1wiLFwicGF5bWVudC1maWVsZHNcIixcImhvc3RlZC1maWVsZHNcIixcInRocmVlLWRvbWFpbi1zZWN1cmVcIl0sY3VycmVuY3k6dCxpbnRlbnQ6YX0sYXR0cmlidXRlczp7XCJkYXRhLWNsaWVudC1tZXRhZGF0YS1pZFwiOmkucmVwbGFjZSgvLS9nLFwiXCIpLFwiZGF0YS1uYW1lc3BhY2VcIjpcInBheXBhbEZhc3RsYW5lU2RrXCIsXCJkYXRhLXBhcnRuZXItYXR0cmlidXRpb24taWRcIjpkLFwiZGF0YS1zZGstY2xpZW50LXRva2VuXCI6bn19fWdldFBheVBhbEdvb2dsZVBheVNka1NjcmlwdENvbmZpZ09yVGhyb3coZSx0LGk9ITApe2NvbnN0e2NsaWVudFRva2VuOm4saW5pdGlhbGl6YXRpb25EYXRhOm99PWU7aWYoIW98fCFvLmNsaWVudElkKXRocm93IG5ldyB5KGwuTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0e2ludGVudDphLGNsaWVudElkOnIsbWVyY2hhbnRJZDpzLGJ1eWVyQ291bnRyeTpkLGF0dHJpYnV0aW9uSWQ6Yyxpc0hvc3RlZENoZWNrb3V0RW5hYmxlZDpwLGlzRGV2ZWxvcGVyTW9kZUFwcGxpY2FibGU6dX09byxoPXB8fGk7cmV0dXJue29wdGlvbnM6T2JqZWN0LmFzc2lnbih7XCJjbGllbnQtaWRcIjpyLFwibWVyY2hhbnQtaWRcIjpzLGNvbW1pdDpoLGNvbXBvbmVudHM6W1wiZ29vZ2xlcGF5XCJdLGN1cnJlbmN5OnQsaW50ZW50OmF9LHUmJntcImJ1eWVyLWNvdW50cnlcIjpkfSksYXR0cmlidXRlczp7XCJkYXRhLXBhcnRuZXItYXR0cmlidXRpb24taWRcIjpjLFwiZGF0YS1jbGllbnQtdG9rZW5cIjpuLFwiZGF0YS1uYW1lc3BhY2VcIjpcInBheXBhbEdvb2dsZVBheVwifX19Z2V0UGF5UGFsQXBtU2RrQ29uZmlndXJhdGlvbihlLHQpe2NvbnN0e2luaXRpYWxpemF0aW9uRGF0YTppfT1lO2lmKCFpfHwhaS5jbGllbnRJZCl0aHJvdyBuZXcgeShsLk1pc3NpbmdQYXltZW50TWV0aG9kKTtjb25zdHtpbnRlbnQ6bixjbGllbnRJZDpvLG1lcmNoYW50SWQ6YSxidXllckNvdW50cnk6cixhdHRyaWJ1dGlvbklkOnMsaXNEZXZlbG9wZXJNb2RlQXBwbGljYWJsZTpkLGF2YWlsYWJsZUFsdGVybmF0aXZlUGF5bWVudE1ldGhvZHM6Yz1bXSxlbmFibGVkQWx0ZXJuYXRpdmVQYXltZW50TWV0aG9kczpwPVtdfT1pLHU9cCxoPWMuZmlsdGVyKGU9PiFwLmluY2x1ZGVzKGUpKTtyZXR1cm57b3B0aW9uczpPYmplY3QuYXNzaWduKHtcImNsaWVudC1pZFwiOm8sXCJtZXJjaGFudC1pZFwiOmEsXCJlbmFibGUtZnVuZGluZ1wiOnUubGVuZ3RoPjA/dTp2b2lkIDAsXCJkaXNhYmxlLWZ1bmRpbmdcIjpoLmxlbmd0aD4wP2g6dm9pZCAwLGNvbW1pdDohMCxjb21wb25lbnRzOltcImJ1dHRvbnNcIixcInBheW1lbnQtZmllbGRzXCJdLGN1cnJlbmN5OnQsaW50ZW50Om59LGQmJntcImJ1eWVyLWNvdW50cnlcIjpyfSksYXR0cmlidXRlczp7XCJkYXRhLXBhcnRuZXItYXR0cmlidXRpb24taWRcIjpzLFwiZGF0YS1uYW1lc3BhY2VcIjpcInBheXBhbEFwbXNcIn19fWdldFBheVBhbFNka01lc3NhZ2VzQ29uZmlndXJhdGlvbihlLHQpe2NvbnN0e2luaXRpYWxpemF0aW9uRGF0YTppfT1lO2lmKCFpfHwhaS5jbGllbnRJZCl0aHJvdyBuZXcgeShsLk1pc3NpbmdQYXltZW50TWV0aG9kKTtjb25zdHtjbGllbnRJZDpuLG1lcmNoYW50SWQ6byxhdHRyaWJ1dGlvbklkOmEsaXNEZXZlbG9wZXJNb2RlQXBwbGljYWJsZTpyLGJ1eWVyQ291bnRyeTpzfT1pO3JldHVybntvcHRpb25zOk9iamVjdC5hc3NpZ24oe1wiY2xpZW50LWlkXCI6bixcIm1lcmNoYW50LWlkXCI6byxjb21wb25lbnRzOltcIm1lc3NhZ2VzXCJdLGN1cnJlbmN5OnR9LHImJntcImJ1eWVyLWNvdW50cnlcIjpzfSksYXR0cmlidXRlczp7XCJkYXRhLW5hbWVzcGFjZVwiOlwicGF5cGFsTWVzc2FnZXNcIixcImRhdGEtcGFydG5lci1hdHRyaWJ1dGlvbi1pZFwiOmF9fX10cmFuc2Zvcm1Db25maWcoZSl7bGV0IHQ9e307cmV0dXJuIE9iamVjdC5rZXlzKGUpLmZvckVhY2goaT0+e2NvbnN0IG49ZVtpXTtudWxsPT1ufHxcIlwiPT09bnx8QXJyYXkuaXNBcnJheShuKSYmMD09PW4ubGVuZ3RofHwodD1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse1tpXTpBcnJheS5pc0FycmF5KG4pP24uam9pbihcIixcIik6bn0pKX0pLHR9fWZ1bmN0aW9uIFEoKXtyZXR1cm4gbmV3IFooaSgpKX0hZnVuY3Rpb24oZSl7ZS5BVVRIT1JJWkU9XCJhdXRob3JpemVcIixlLkNBUFRVUkU9XCJjYXB0dXJlXCJ9KFJ8fChSPXt9KSksZnVuY3Rpb24oZSl7ZS5BbHdheXM9XCJTQ0FfQUxXQVlTXCJ9KEx8fChMPXt9KSksZnVuY3Rpb24oZSl7ZS5TdWNjZWVkZWQ9XCJzdWNjZWVkZWRcIixlLkNhbmNlbGxlZD1cImNhbmNlbGxlZFwiLGUuRXJyb3JlZD1cImVycm9yZWRcIn0oJHx8KCQ9e30pKSxmdW5jdGlvbihlKXtlLlBvc3NpYmxlPVwiUE9TU0lCTEVcIixlLk5vPVwiTk9cIixlLlVua25vd249XCJVTktOT1dOXCIsZS5ZZXM9XCJZRVNcIn0ocXx8KHE9e30pKSxmdW5jdGlvbihlKXtlLnBheXBhbD1cInBheXBhbFwiLGUuY2hlY2tvdXQ9XCJjaGVja291dFwiLGUuYnV5bm93PVwiYnV5bm93XCIsZS5wYXk9XCJwYXlcIixlLmluc3RhbGxtZW50PVwiaW5zdGFsbG1lbnRcIn0oR3x8KEc9e30pKSxmdW5jdGlvbihlKXtlLmdvbGQ9XCJnb2xkXCIsZS5ibHVlPVwiYmx1ZVwiLGUuc2lsdmVyPVwic2lsdmVyXCIsZS5ibGFjaz1cImJsYWNrXCIsZS53aGl0ZT1cIndoaXRlXCJ9KEh8fChIPXt9KSksZnVuY3Rpb24oZSl7ZS5waWxsPVwicGlsbFwiLGUucmVjdD1cInJlY3RcIn0oWXx8KFk9e30pKSxmdW5jdGlvbihlKXtlLlNVQ0NFRURFRD1cInN1Y2NlZWRlZFwiLGUuRkFJTEVEPVwiZmFpbGVkXCIsZS5DQU5DRUxFRD1cImNhbmNlbGVkXCIsZS5VTlJFQ09HTklaRUQ9XCJ1bnJlY29nbml6ZWRcIn0oV3x8KFc9e30pKSwoS3x8KEs9e30pKS5PWFhPPVwib3h4b1wiLGZ1bmN0aW9uKGUpe2UuQXBwcm92ZWQ9XCJBUFBST1ZFRFwiLGUuQ3JlYXRlZD1cIkNSRUFURURcIixlLlBheWVyQWN0aW9uUmVxdWlyZWQ9XCJQQVlFUl9BQ1RJT05fUkVRVUlSRURcIixlLlBvbGxpbmdTdG9wPVwiUE9MTElOR19TVE9QXCIsZS5Qb2xsaW5nRXJyb3I9XCJQT0xMSU5HX0VSUk9SXCJ9KFh8fChYPXt9KSk7dmFyIGVlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8sYSl7ZnVuY3Rpb24gcihlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHIscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIHRle2NvbnN0cnVjdG9yKGUsdCxpLG4pe3RoaXMuZm9ybVBvc3Rlcj1lLHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT10LHRoaXMucGF5cGFsUmVxdWVzdFNlbmRlcj1pLHRoaXMucGF5cGFsU2RrTG9hZGVyPW59bG9hZFBheVBhbFNkayhlLHQsaSxuKXtyZXR1cm4gZWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IG89dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksYT10fHxvLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZSxyPW8uZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSk7cmV0dXJuIHRoaXMucGF5cGFsU2RrPXlpZWxkIHRoaXMucGF5cGFsU2RrTG9hZGVyLmdldFBheVBhbFNESyhyLGEsaSxuKSx0aGlzLnBheXBhbFNka30pfWdldFBheVBhbFNka09yVGhyb3coKXtpZighdGhpcy5wYXlwYWxTZGspdGhyb3cgbmV3IGg7cmV0dXJuIHRoaXMucGF5cGFsU2RrfWNyZWF0ZUJ1eU5vd0NhcnRPclRocm93KGUpe3JldHVybiBlZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD1lLmdldEJ1eU5vd0NhcnRSZXF1ZXN0Qm9keSgpO2lmKCF0KXRocm93IG5ldyB5KGwuTWlzc2luZ0NhcnQpO3RyeXtyZXR1cm4geWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZUJ1eU5vd0NhcnQodCl9Y2F0Y2goZSl7dGhyb3cgbmV3IG19fSl9Y3JlYXRlT3JkZXIoZSx0KXtyZXR1cm4gZWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKS5pZCx7b3JkZXJJZDpufT15aWVsZCB0aGlzLnBheXBhbFJlcXVlc3RTZW5kZXIuY3JlYXRlT3JkZXIoZSxPYmplY3QuYXNzaWduKHtjYXJ0SWQ6aX0sdCkpO3JldHVybiBufSl9Y3JlYXRlT3JkZXJDYXJkRmllbGRzKGUsdCl7cmV0dXJuIGVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnRPclRocm93KCkuaWQse29yZGVySWQ6bixzZXR1cFRva2VuOm99PXlpZWxkIHRoaXMucGF5cGFsUmVxdWVzdFNlbmRlci5jcmVhdGVPcmRlcihlLE9iamVjdC5hc3NpZ24oe2NhcnRJZDppfSx0KSk7cmV0dXJuIE9iamVjdC5hc3NpZ24oe29yZGVySWQ6bn0sbz97c2V0dXBUb2tlbjpvfTp7fSl9KX11cGRhdGVPcmRlcihlLHQsaSl7cmV0dXJuIGVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG89bi5nZXRDYXJ0T3JUaHJvdygpLGE9bi5nZXRDb25zaWdubWVudHNPclRocm93KClbMF07dHJ5e3lpZWxkIHRoaXMucGF5cGFsUmVxdWVzdFNlbmRlci51cGRhdGVPcmRlcihlLE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7YXZhaWxhYmxlU2hpcHBpbmdPcHRpb25zOmEuYXZhaWxhYmxlU2hpcHBpbmdPcHRpb25zLGNhcnRJZDpvLmlkLHNlbGVjdGVkU2hpcHBpbmdPcHRpb246YS5zZWxlY3RlZFNoaXBwaW5nT3B0aW9ufSx0P3ttZXRob2RJZDp0fTp7fSksaT97b3JkZXJJZDppfTp7fSkpfWNhdGNoKGUpe3Rocm93IG5ldyB2fX0pfWdldE9yZGVyU3RhdHVzKGUsdCl7cmV0dXJuIGVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7Y29uc3R7c3RhdHVzOml9PXlpZWxkIHRoaXMucGF5cGFsUmVxdWVzdFNlbmRlci5nZXRPcmRlclN0YXR1cyhlLHQpO3JldHVybiBpfWNhdGNoKGUpe3Rocm93IG5ldyB2fX0pfXRva2VuaXplUGF5bWVudChlLHQpe2NvbnN0IGk9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKTtpZighdCl0aHJvdyBuZXcgeShsLk1pc3NpbmdPcmRlcklkKTtyZXR1cm4gdGhpcy5mb3JtUG9zdGVyLnBvc3RGb3JtKFwiL2NoZWNrb3V0LnBocFwiLE9iamVjdC5hc3NpZ24oe3BheW1lbnRfdHlwZTpcInBheXBhbFwiLGFjdGlvbjpcInNldF9leHRlcm5hbF9jaGVja291dFwiLHByb3ZpZGVyOmUsb3JkZXJfaWQ6dH0saS5zb3VyY2U9PT1mLkJ1eU5vdyYme2NhcnRfaWQ6aS5pZH0pKX1zdWJtaXRQYXltZW50KGUsdCxpKXtyZXR1cm4gZWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IG49e2Zvcm1hdHRlZFBheWxvYWQ6e3ZhdWx0X3BheW1lbnRfaW5zdHJ1bWVudDpudWxsLHNldF9hc19kZWZhdWx0X3N0b3JlZF9pbnN0cnVtZW50Om51bGwsZGV2aWNlX2luZm86bnVsbCxtZXRob2RfaWQ6ZSxwYXlwYWxfYWNjb3VudDp7b3JkZXJfaWQ6dH19fTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChPYmplY3QuYXNzaWduKHttZXRob2RJZDplLHBheW1lbnREYXRhOm59LGk/e2dhdGV3YXlJZDppfTp7fSkpfSl9Z2V0U2hpcHBpbmdPcHRpb25PclRocm93KGUpe2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q29uc2lnbm1lbnRzT3JUaHJvdygpWzBdLGk9dC5hdmFpbGFibGVTaGlwcGluZ09wdGlvbnN8fFtdLG49aS5maW5kKGU9PmUuaXNSZWNvbW1lbmRlZCksbz0oZT9pLmZpbmQodD0+dC5pZD09PWUpOmkuZmluZChlPT57aWYodC5zZWxlY3RlZFNoaXBwaW5nT3B0aW9uKXtjb25zdCBpPXQuc2VsZWN0ZWRTaGlwcGluZ09wdGlvbi5pZDtyZXR1cm4gZS5pZD09PWl9cmV0dXJuITF9KSl8fG58fGlbMF07aWYoIW8pdGhyb3cgbmV3IEVycm9yKFwiWW91ciBvcmRlciBjYW4ndCBiZSBzaGlwcGVkIHRvIHRoaXMgYWRkcmVzc1wiKTtyZXR1cm4gb31nZXRBZGRyZXNzKGUpe3JldHVybntmaXJzdE5hbWU6KG51bGw9PWU/dm9pZCAwOmUuZmlyc3ROYW1lKXx8XCJcIixsYXN0TmFtZToobnVsbD09ZT92b2lkIDA6ZS5sYXN0TmFtZSl8fFwiXCIsZW1haWw6KG51bGw9PWU/dm9pZCAwOmUuZW1haWwpfHxcIlwiLHBob25lOihudWxsPT1lP3ZvaWQgMDplLnBob25lKXx8XCJcIixjb21wYW55OlwiXCIsYWRkcmVzczE6KG51bGw9PWU/dm9pZCAwOmUuYWRkcmVzczEpfHxcIlwiLGFkZHJlc3MyOihudWxsPT1lP3ZvaWQgMDplLmFkZHJlc3MyKXx8XCJcIixjaXR5OihudWxsPT1lP3ZvaWQgMDplLmNpdHkpfHxcIlwiLGNvdW50cnlDb2RlOihudWxsPT1lP3ZvaWQgMDplLmNvdW50cnlDb2RlKXx8XCJcIixwb3N0YWxDb2RlOihudWxsPT1lP3ZvaWQgMDplLnBvc3RhbENvZGUpfHxcIlwiLHN0YXRlT3JQcm92aW5jZTpcIlwiLHN0YXRlT3JQcm92aW5jZUNvZGU6KG51bGw9PWU/dm9pZCAwOmUuc3RhdGVPclByb3ZpbmNlQ29kZSl8fFwiXCIsY3VzdG9tRmllbGRzOltdfX1nZXRCaWxsaW5nQWRkcmVzc0Zyb21PcmRlckRldGFpbHMoe3BheWVyOmV9KXt2YXIgdCxpO3JldHVybiB0aGlzLmdldEFkZHJlc3Moe2ZpcnN0TmFtZTplLm5hbWUuZ2l2ZW5fbmFtZSxsYXN0TmFtZTplLm5hbWUuc3VybmFtZSxlbWFpbDplLmVtYWlsX2FkZHJlc3MsYWRkcmVzczE6ZS5hZGRyZXNzLmFkZHJlc3NfbGluZV8xLGFkZHJlc3MyOmUuYWRkcmVzcy5hZGRyZXNzX2xpbmVfMixjaXR5OmUuYWRkcmVzcy5hZG1pbl9hcmVhXzIsY291bnRyeUNvZGU6ZS5hZGRyZXNzLmNvdW50cnlfY29kZSxwb3N0YWxDb2RlOmUuYWRkcmVzcy5wb3N0YWxfY29kZSxzdGF0ZU9yUHJvdmluY2VDb2RlOmUuYWRkcmVzcy5hZG1pbl9hcmVhXzEscGhvbmU6bnVsbD09PShpPW51bGw9PT0odD1lLnBob25lKXx8dm9pZCAwPT09dD92b2lkIDA6dC5waG9uZV9udW1iZXIpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLm5hdGlvbmFsX251bWJlcn0pfWdldFNoaXBwaW5nQWRkcmVzc0Zyb21PcmRlckRldGFpbHMoZSl7Y29uc3R7cGF5ZXI6dCxwdXJjaGFzZV91bml0czppfT1lLHthZGRyZXNzOm4sbmFtZTp7ZnVsbF9uYW1lOm99fT1pWzBdLnNoaXBwaW5nLFthLC4uLnJdPW8uc3BsaXQoXCIgXCIpO3JldHVybiB0aGlzLmdldEFkZHJlc3Moe2ZpcnN0TmFtZTphLGxhc3ROYW1lOnIuam9pbihcIiBcIiksZW1haWw6dC5lbWFpbF9hZGRyZXNzLGFkZHJlc3MxOm4uYWRkcmVzc19saW5lXzEsYWRkcmVzczI6bi5hZGRyZXNzX2xpbmVfMixjaXR5Om4uYWRtaW5fYXJlYV8yLGNvdW50cnlDb2RlOm4uY291bnRyeV9jb2RlLHBvc3RhbENvZGU6bi5wb3N0YWxfY29kZSxzdGF0ZU9yUHJvdmluY2VDb2RlOm4uYWRtaW5fYXJlYV8xfSl9Z2V0VmFsaWRCdXR0b25TdHlsZShlPXt9KXtjb25zdHtjb2xvcjp0LGhlaWdodDppLGxhYmVsOm4sc2hhcGU6b309ZSxyPXtjb2xvcjp0JiZIW3RdP3Q6dm9pZCAwLGhlaWdodDp0aGlzLmdldFZhbGlkSGVpZ2h0KGkpLGxhYmVsOm4mJkdbbl0/bjp2b2lkIDAsc2hhcGU6byYmWVtvXT9vOnZvaWQgMH07cmV0dXJuIGQocixhKX1nZXRWYWxpZEhlaWdodChlKXtyZXR1cm4gZSYmXCJudW1iZXJcIj09dHlwZW9mIGU/ZT41NT81NTplPDI1PzI1OmU6NDB9cmVtb3ZlRWxlbWVudChlKXtjb25zdCB0PWUmJmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGUpO3QmJih0LnN0eWxlLmRpc3BsYXk9XCJub25lXCIpfX12YXIgaWU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24obyxhKXtmdW5jdGlvbiByKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9vKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4ocixzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgbmV7Y29uc3RydWN0b3IoZSl7dGhpcy5yZXF1ZXN0U2VuZGVyPWV9Y3JlYXRlT3JkZXIoZSx0KXtyZXR1cm4gaWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9YC9hcGkvc3RvcmVmcm9udC9wYXltZW50LyR7ZX1gLG49dCxvPU9iamVjdC5hc3NpZ24oe1wiWC1BUEktSU5URVJOQUxcIjpFLFwiQ29udGVudC1UeXBlXCI6ei5Kc29ufSxGKTtyZXR1cm4oeWllbGQgdGhpcy5yZXF1ZXN0U2VuZGVyLnBvc3QoaSx7aGVhZGVyczpvLGJvZHk6bn0pKS5ib2R5fSl9dXBkYXRlT3JkZXIoZSx0KXtyZXR1cm4gaWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9YC9hcGkvc3RvcmVmcm9udC9pbml0aWFsaXphdGlvbi8ke2V9YCxuPXQsbz1PYmplY3QuYXNzaWduKHtcIlgtQVBJLUlOVEVSTkFMXCI6RSxcIkNvbnRlbnQtVHlwZVwiOnouSnNvbn0sRik7cmV0dXJuKHlpZWxkIHRoaXMucmVxdWVzdFNlbmRlci5wdXQoaSx7aGVhZGVyczpvLGJvZHk6bn0pKS5ib2R5fSl9Z2V0T3JkZXJTdGF0dXMoZSx0KXtyZXR1cm4gaWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9YC9hcGkvc3RvcmVmcm9udC9pbml0aWFsaXphdGlvbi8ke2V9YCxuPU9iamVjdC5hc3NpZ24oe1wiWC1BUEktSU5URVJOQUxcIjpFLFwiQ29udGVudC1UeXBlXCI6ei5Kc29ufSxGKTtyZXR1cm4oeWllbGQgdGhpcy5yZXF1ZXN0U2VuZGVyLmdldChpLE9iamVjdC5hc3NpZ24oe2hlYWRlcnM6bn0sdCkpKS5ib2R5fSl9fWNvbnN0IG9lPWk9Pntjb25zdHtnZXRIb3N0Om59PWkuZ2V0U3RhdGUoKTtyZXR1cm4gbmV3IHRlKGUoKSxpLG5ldyBuZSh0KHtob3N0Om4oKX0pKSxRKCkpfSxhZT1mdW5jdGlvbih7c3R5bGVzOmV9KXtjb25zdCB0PXt9O3JldHVybiBlLmNvbG9yJiYodC5jb2xvcj1lLmNvbG9yKSxlLmxheW91dCYmKHQubGF5b3V0PWUubGF5b3V0KSwoZVtcImxvZ28tdHlwZVwiXXx8ZVtcImxvZ28tcG9zaXRpb25cIl0pJiYodC5sb2dvPXt9LGVbXCJsb2dvLXR5cGVcIl0mJih0LmxvZ28udHlwZT1lW1wibG9nby10eXBlXCJdKSxlW1wibG9nby1wb3NpdGlvblwiXSYmKHQubG9nby5wb3NpdGlvbj1lW1wibG9nby1wb3NpdGlvblwiXSkpLGUucmF0aW8mJih0LnJhdGlvPWUucmF0aW8pLChlW1widGV4dC1jb2xvclwiXXx8ZVtcInRleHQtc2l6ZVwiXSkmJih0LnRleHQ9e30sZVtcInRleHQtY29sb3JcIl0mJih0LnRleHQuY29sb3I9ZVtcInRleHQtY29sb3JcIl0pLGVbXCJ0ZXh0LXNpemVcIl0mJih0LnRleHQuc2l6ZT0rZVtcInRleHQtc2l6ZVwiXSkpLHR9O3ZhciByZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihvLGEpe2Z1bmN0aW9uIHIoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP28oZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihyLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBzZXtjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2U9dCx0aGlzLnBheXBhbENvbW1lcmNlU2RrPWl9aW5pdGlhbGl6ZShlKXt2YXIgdDtyZXR1cm4gcmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheXBhbGNvbW1lcmNlY3JlZGl0OmksY29udGFpbmVySWQ6bixtZXRob2RJZDpvfT1lLHtidXlOb3dJbml0aWFsaXplT3B0aW9uczphLGN1cnJlbmN5Q29kZTpyLG1lc3NhZ2luZ0NvbnRhaW5lcklkOnN9PWl8fHt9LGQ9ISFhO2lmKCFvKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmNvbnRhaW5lcklkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFpKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLnBheXBhbGNvbW1lcmNlY3JlZGl0XCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKGQmJiFyKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLnBheXBhbGNvbW1lcmNlY3JlZGl0LmN1cnJlbmN5Q29kZVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZihkJiZcImZ1bmN0aW9uXCIhPXR5cGVvZihudWxsPT1hP3ZvaWQgMDphLmdldEJ1eU5vd0NhcnRSZXF1ZXN0Qm9keSkpdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMucGF5cGFsY29tbWVyY2VjcmVkaXQuYnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnMuZ2V0QnV5Tm93Q2FydFJlcXVlc3RCb2R5XCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkIG9yIGl0IGlzIG5vdCBhIGZ1bmN0aW9uLicpO2R8fCh5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZERlZmF1bHRDaGVja291dCgpKTtjb25zdCBsPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLGM9ZD9yOmwuZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlO3lpZWxkIHRoaXMucGF5cGFsSW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXlQYWxTZGsobyxjLCExKSx0aGlzLnJlbmRlckJ1dHRvbihuLG8saSk7Y29uc3QgcD1sLmdldFN0b3JlQ29uZmlnT3JUaHJvdygpLmNoZWNrb3V0U2V0dGluZ3MuZmVhdHVyZXM7aWYobnVsbCE9PSh0PXBbXCJQQVlQQUwtNTU1Ny5IaWRlX3BwY19iYW5uZXJfaW1wbGVtZW50YXRpb25cIl0pJiZ2b2lkIDAhPT10JiZ0KXJldHVybjtjb25zdCB1PXMmJmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHMpO2lmKGMmJnUpe2NvbnN0IGU9bC5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhvKSx7cGF5cGFsQk5QTENvbmZpZ3VyYXRpb246dD1bXX09ZS5pbml0aWFsaXphdGlvbkRhdGF8fHt9LGk9dCYmdC5maW5kKCh7aWQ6ZX0pPT5cImNhcnRcIj09PWUpO2lmKCEobnVsbD09aT92b2lkIDA6aS5zdGF0dXMpKXJldHVybjt1LnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcHAtc3R5bGUtbG9nby10eXBlXCIpLHUucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcC1zdHlsZS1sb2dvLXBvc2l0aW9uXCIpLHUucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcC1zdHlsZS10ZXh0LWNvbG9yXCIpLHUucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcC1zdHlsZS10ZXh0LXNpemVcIik7Y29uc3Qgbj15aWVsZCB0aGlzLnBheXBhbENvbW1lcmNlU2RrLmdldFBheVBhbE1lc3NhZ2VzKGUsYyk7dGhpcy5yZW5kZXJNZXNzYWdlcyhuLHMsaSl9fSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfXJlbmRlckJ1dHRvbihlLHQsaSl7Y29uc3R7YnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnM6bixzdHlsZTpvLG9uQ29tcGxldGU6YSxvbkVsaWdpYmlsaXR5RmFpbHVyZTpyfT1pLHM9dGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5UGFsU2RrT3JUaHJvdygpLGQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCkse2lzSG9zdGVkQ2hlY2tvdXRFbmFibGVkOmwsaXNBcHBTd2l0Y2hFbmFibGVkOmN9PWQuaW5pdGlhbGl6YXRpb25EYXRhfHx7fSxwPXtjcmVhdGVPcmRlcjooKT0+dGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlT3JkZXIoXCJwYXlwYWxjb21tZXJjZWNyZWRpdFwiKSxvbkFwcHJvdmU6KHtvcmRlcklEOmV9KT0+dGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2UudG9rZW5pemVQYXltZW50KHQsZSl9LHU9e29uQ2xpY2s6KCk9PnRoaXMuaGFuZGxlQ2xpY2sobiksb25DYW5jZWw6KCk9PnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCl9LGg9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCFjJiZ7b25TaGlwcGluZ0FkZHJlc3NDaGFuZ2U6ZT0+dGhpcy5vblNoaXBwaW5nQWRkcmVzc0NoYW5nZShlKSxvblNoaXBwaW5nT3B0aW9uc0NoYW5nZTplPT50aGlzLm9uU2hpcHBpbmdPcHRpb25zQ2hhbmdlKGUpfSkse29uQXBwcm92ZTooZSxpKT0+dGhpcy5vbkhvc3RlZENoZWNrb3V0QXBwcm92ZShlLGksdCxhKX0pLHk9W3MuRlVORElORy5QQVlMQVRFUixzLkZVTkRJTkcuQ1JFRElUXTtsZXQgbT0hMTt5LmZvckVhY2godD0+e2lmKCFtKXtjb25zdCBpPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHtmdW5kaW5nU291cmNlOnQsc3R5bGU6dGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0VmFsaWRCdXR0b25TdHlsZShvKX0scCksbiYmdSksbCYmaCksYT1zLkJ1dHRvbnMoaSk7YS5pc0VsaWdpYmxlKCk/KGEucmVuZGVyKGAjJHtlfWApLG09ITApOnImJlwiZnVuY3Rpb25cIj09dHlwZW9mIHImJnIoKX19KSxtfHx0aGlzLnBheXBhbEludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KGUpfWhhbmRsZUNsaWNrKGUpe3JldHVybiByZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoZSl7Y29uc3QgdD15aWVsZCB0aGlzLnBheXBhbEludGVncmF0aW9uU2VydmljZS5jcmVhdGVCdXlOb3dDYXJ0T3JUaHJvdyhlKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZENoZWNrb3V0KHQuaWQpfX0pfW9uSG9zdGVkQ2hlY2tvdXRBcHByb3ZlKGUsdCxpLG4pe3JldHVybiByZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIWUub3JkZXJJRCl0aHJvdyBuZXcgeShsLk1pc3NpbmdPcmRlcklkKTtjb25zdCBvPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnRPclRocm93KCksYT15aWVsZCB0Lm9yZGVyLmdldCgpO3RyeXtjb25zdCB0PXRoaXMucGF5cGFsSW50ZWdyYXRpb25TZXJ2aWNlLmdldEJpbGxpbmdBZGRyZXNzRnJvbU9yZGVyRGV0YWlscyhhKTtpZih5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3ModCksby5saW5lSXRlbXMucGh5c2ljYWxJdGVtcy5sZW5ndGg+MCl7Y29uc3QgZT10aGlzLnBheXBhbEludGVncmF0aW9uU2VydmljZS5nZXRTaGlwcGluZ0FkZHJlc3NGcm9tT3JkZXJEZXRhaWxzKGEpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVTaGlwcGluZ0FkZHJlc3MoZSkseWllbGQgdGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlT3JkZXIoXCJwYXlwYWxjb21tZXJjZVwiKX1yZXR1cm4geWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKHt9LHtwYXJhbXM6e21ldGhvZElkOml9fSkseWllbGQgdGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChpLGUub3JkZXJJRCksbiYmXCJmdW5jdGlvblwiPT10eXBlb2YgbiYmbigpLCEwfWNhdGNoKGUpe2lmKFwic3RyaW5nXCI9PXR5cGVvZiBlKXRocm93IG5ldyBFcnJvcihlKTt0aHJvdyBlfX0pfW9uU2hpcHBpbmdBZGRyZXNzQ2hhbmdlKGUpe3JldHVybiByZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLnBheXBhbEludGVncmF0aW9uU2VydmljZS5nZXRBZGRyZXNzKHtjaXR5OmUuc2hpcHBpbmdBZGRyZXNzLmNpdHksY291bnRyeUNvZGU6ZS5zaGlwcGluZ0FkZHJlc3MuY291bnRyeUNvZGUscG9zdGFsQ29kZTplLnNoaXBwaW5nQWRkcmVzcy5wb3N0YWxDb2RlLHN0YXRlT3JQcm92aW5jZUNvZGU6ZS5zaGlwcGluZ0FkZHJlc3Muc3RhdGV9KTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZUJpbGxpbmdBZGRyZXNzKHQpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVTaGlwcGluZ0FkZHJlc3ModCk7Y29uc3QgZT10aGlzLnBheXBhbEludGVncmF0aW9uU2VydmljZS5nZXRTaGlwcGluZ09wdGlvbk9yVGhyb3coKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2VsZWN0U2hpcHBpbmdPcHRpb24oZS5pZCkseWllbGQgdGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlT3JkZXIoXCJwYXlwYWxjb21tZXJjZVwiKX1jYXRjaChlKXtpZihcInN0cmluZ1wiPT10eXBlb2YgZSl0aHJvdyBuZXcgRXJyb3IoZSk7dGhyb3cgZX19KX1vblNoaXBwaW5nT3B0aW9uc0NoYW5nZShlKXtyZXR1cm4gcmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U2hpcHBpbmdPcHRpb25PclRocm93KGUuc2VsZWN0ZWRTaGlwcGluZ09wdGlvbi5pZCk7dHJ5e3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zZWxlY3RTaGlwcGluZ09wdGlvbih0LmlkKSx5aWVsZCB0aGlzLnBheXBhbEludGVncmF0aW9uU2VydmljZS51cGRhdGVPcmRlcihcInBheXBhbGNvbW1lcmNlXCIpfWNhdGNoKGUpe2lmKFwic3RyaW5nXCI9PXR5cGVvZiBlKXRocm93IG5ldyBFcnJvcihlKTt0aHJvdyBlfX0pfXJlbmRlck1lc3NhZ2VzKGUsdCxpKXtjb25zdCBuPXthbW91bnQ6dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2hlY2tvdXRPclRocm93KCkub3V0c3RhbmRpbmdCYWxhbmNlLHBsYWNlbWVudDpcImNhcnRcIixzdHlsZTphZShpKX07ZS5NZXNzYWdlcyhuKS5yZW5kZXIoYCMke3R9YCl9fWNvbnN0IGRlPXAoZT0+bmV3IHNlKGUsb2UoZSksUSgpKSxbe2lkOlwicGF5cGFsY29tbWVyY2VjcmVkaXRcIn1dKTt2YXIgbGU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24obyxhKXtmdW5jdGlvbiByKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9vKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4ocixzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgY2V7Y29uc3RydWN0b3IoZSx0KXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlPXR9aW5pdGlhbGl6ZShlKXtyZXR1cm4gbGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheXBhbGNvbW1lcmNldmVubW86dCxjb250YWluZXJJZDppLG1ldGhvZElkOm59PWUse2J1eU5vd0luaXRpYWxpemVPcHRpb25zOm8sY3VycmVuY3lDb2RlOmF9PXR8fHt9LHI9ISFvO2lmKCFuKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFpKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmNvbnRhaW5lcklkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCF0KXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLnBheXBhbGNvbW1lcmNldmVubW9cIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYociYmIWEpdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMucGF5cGFsY29tbWVyY2V2ZW5tby5jdXJyZW5jeUNvZGVcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYociYmXCJmdW5jdGlvblwiIT10eXBlb2YobnVsbD09bz92b2lkIDA6by5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkpKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLnBheXBhbGNvbW1lcmNldmVubW8uYnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnMuZ2V0QnV5Tm93Q2FydFJlcXVlc3RCb2R5XCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkIG9yIGl0IGlzIG5vdCBhIGZ1bmN0aW9uLicpO3J8fCh5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZERlZmF1bHRDaGVja291dCgpKTtjb25zdCBzPXI/YTp0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGU7eWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5sb2FkUGF5UGFsU2RrKG4scywhMSksdGhpcy5yZW5kZXJCdXR0b24oaSxuLHQpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfXJlbmRlckJ1dHRvbihlLHQsaSl7Y29uc3R7YnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnM6bixzdHlsZTpvLG9uRWxpZ2liaWxpdHlGYWlsdXJlOmF9PWkscj10aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheVBhbFNka09yVGhyb3coKSxzPXIuRlVORElORy5WRU5NTyxkPXtjcmVhdGVPcmRlcjooKT0+dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5jcmVhdGVPcmRlcihcInBheXBhbGNvbW1lcmNldmVubW9cIiksb25BcHByb3ZlOih7b3JkZXJJRDplfSk9PnRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UudG9rZW5pemVQYXltZW50KHQsZSl9LGw9e29uQ2xpY2s6KCk9PnRoaXMuaGFuZGxlQ2xpY2sobiksb25DYW5jZWw6KCk9PnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCl9LGM9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHtmdW5kaW5nU291cmNlOnMsc3R5bGU6dGhpcy5nZXRWYWxpZFZlbm1vQnV0dG9uU3R5bGVzKG8pfSxkKSxuJiZsKSxwPXIuQnV0dG9ucyhjKTtwLmlzRWxpZ2libGUoKT9wLnJlbmRlcihgIyR7ZX1gKTphJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBhP2EoKTp0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQoZSl9Z2V0VmFsaWRWZW5tb0J1dHRvblN0eWxlcyhlKXtjb25zdCB0PXRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0VmFsaWRCdXR0b25TdHlsZShlKTtyZXR1cm4gdC5jb2xvcj09PWIuZ29sZD9PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse2NvbG9yOnZvaWQgMH0pOnR9aGFuZGxlQ2xpY2soZSl7cmV0dXJuIGxlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZihlKXtjb25zdCB0PXlpZWxkIHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlQnV5Tm93Q2FydE9yVGhyb3coZSk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRDaGVja291dCh0LmlkKX19KX19Y29uc3QgcGU9cChlPT5uZXcgY2UoZSxOKGUpKSxbe2lkOlwicGF5cGFsY29tbWVyY2V2ZW5tb1wifV0pO3ZhciB1ZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihvLGEpe2Z1bmN0aW9uIHIoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP28oZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihyLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBoZXtjb25zdHJ1Y3RvcihlLHQpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMucGF5cGFsSW50ZWdyYXRpb25TZXJ2aWNlPXR9aW5pdGlhbGl6ZShlKXtyZXR1cm4gdWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheXBhbGNvbW1lcmNlYWx0ZXJuYXRpdmVtZXRob2RzOnQsY29udGFpbmVySWQ6aSxtZXRob2RJZDpufT1lLHthcG06byxidXlOb3dJbml0aWFsaXplT3B0aW9uczphLGN1cnJlbmN5Q29kZTpyfT10fHx7fSxzPSEhYTtpZighbil0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighaSl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5jb250YWluZXJJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdCl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5wYXlwYWxjb21tZXJjZWFsdGVybmF0aXZlbWV0aG9kc1wiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighbyl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5wYXlwYWxjb21tZXJjZWFsdGVybmF0aXZlbWV0aG9kcy5hcG1cIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYocyYmIXIpdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMucGF5cGFsY29tbWVyY2VhbHRlcm5hdGl2ZW1ldGhvZHMuY3VycmVuY3lDb2RlXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKHMmJlwiZnVuY3Rpb25cIiE9dHlwZW9mKG51bGw9PWE/dm9pZCAwOmEuZ2V0QnV5Tm93Q2FydFJlcXVlc3RCb2R5KSl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5wYXlwYWxjb21tZXJjZWFsdGVybmF0aXZlbWV0aG9kcy5idXlOb3dJbml0aWFsaXplT3B0aW9ucy5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHlcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQgb3IgaXQgaXMgbm90IGEgZnVuY3Rpb24uJyk7c3x8KHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCkpO2NvbnN0IGQ9cz9yOnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZTt5aWVsZCB0aGlzLnBheXBhbEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5UGFsU2RrKG4sZCwhMSksdGhpcy5yZW5kZXJCdXR0b24oaSxuLHQpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfXJlbmRlckJ1dHRvbihlLHQsaSl7Y29uc3R7YXBtOm4sYnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnM6byxzdHlsZTphLG9uRWxpZ2liaWxpdHlGYWlsdXJlOnJ9PWkscz10aGlzLnBheXBhbEludGVncmF0aW9uU2VydmljZS5nZXRQYXlQYWxTZGtPclRocm93KCk7aWYoIU9iamVjdC52YWx1ZXMocy5GVU5ESU5HKS5pbmNsdWRlcyhuKSl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgUGF5UGFsIGJ1dHRvbiBiZWNhdXNlIFwib3B0aW9ucy5wYXlwYWxjb21tZXJjZWFsdGVybmF0aXZlbWV0aG9kcy5hcG1cIiBhcmd1bWVudCBpcyBub3QgdmFsaWQgZnVuZGluZyBzb3VyY2UuJyk7Y29uc3QgZD17Y3JlYXRlT3JkZXI6KCk9PnRoaXMucGF5cGFsSW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZU9yZGVyKFwicGF5cGFsY29tbWVyY2VhbHRlcm5hdGl2ZW1ldGhvZFwiKSxvbkFwcHJvdmU6KHtvcmRlcklEOmV9KT0+dGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2UudG9rZW5pemVQYXltZW50KHQsZSl9LGw9e29uQ2xpY2s6KCk9PnRoaXMuaGFuZGxlQ2xpY2sobyksb25DYW5jZWw6KCk9PnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCl9LGM9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHtmdW5kaW5nU291cmNlOm4sc3R5bGU6dGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0VmFsaWRCdXR0b25TdHlsZShhKX0sZCksbyYmbCkscD1zLkJ1dHRvbnMoYyk7cC5pc0VsaWdpYmxlKCk/cC5yZW5kZXIoYCMke2V9YCk6ciYmXCJmdW5jdGlvblwiPT10eXBlb2Ygcj9yKCk6dGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2UucmVtb3ZlRWxlbWVudChlKX1oYW5kbGVDbGljayhlKXtyZXR1cm4gdWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKGUpe2NvbnN0IHQ9eWllbGQgdGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlQnV5Tm93Q2FydE9yVGhyb3coZSk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRDaGVja291dCh0LmlkKX19KX19Y29uc3QgeWU9cChlPT5uZXcgaGUoZSxvZShlKSksW3tpZDpcInBheXBhbGNvbW1lcmNlYWx0ZXJuYXRpdmVtZXRob2RzXCJ9XSk7dmFyIG1lPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8sYSl7ZnVuY3Rpb24gcihlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHIscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIGdle2NvbnN0cnVjdG9yKGUpe3RoaXMuc2NyaXB0TG9hZGVyPWUsdGhpcy53aW5kb3c9d2luZG93fWdldFBheVBhbEZhc3RsYW5lU2RrKGUsdCxpKXtyZXR1cm4gbWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLndpbmRvdy5wYXlwYWxGYXN0bGFuZVNkayl7Y29uc3Qgbj10aGlzLmdldFBheVBhbEZhc3RsYW5lU2RrQ29uZmlndXJhdGlvbihlLHQsaSk7aWYoeWllbGQgdGhpcy5sb2FkUGF5UGFsU2RrKG4pLCF0aGlzLndpbmRvdy5wYXlwYWxGYXN0bGFuZVNkayl0aHJvdyBuZXcgaH1yZXR1cm4gdGhpcy53aW5kb3cucGF5cGFsRmFzdGxhbmVTZGt9KX1nZXRQYXlQYWxHb29nbGVQYXlTZGsoZSx0LGksbil7cmV0dXJuIG1lKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy53aW5kb3cucGF5cGFsR29vZ2xlUGF5fHxuKXtjb25zdCBuPXRoaXMuZ2V0UGF5UGFsR29vZ2xlUGF5U2RrU2NyaXB0Q29uZmlnT3JUaHJvdyhlLHQsaSk7eWllbGQgdGhpcy5sb2FkUGF5UGFsU2RrKG4pfWlmKCF0aGlzLndpbmRvdy5wYXlwYWxHb29nbGVQYXkpdGhyb3cgbmV3IGg7cmV0dXJuIHRoaXMud2luZG93LnBheXBhbEdvb2dsZVBheX0pfWdldFBheVBhbEFwbXNTZGsoZSx0KXtyZXR1cm4gbWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLndpbmRvdy5wYXlwYWxBcG1zKXtjb25zdCBpPXRoaXMuZ2V0UGF5UGFsQXBtU2RrQ29uZmlndXJhdGlvbihlLHQpO2lmKHlpZWxkIHRoaXMubG9hZFBheVBhbFNkayhpKSwhdGhpcy53aW5kb3cucGF5cGFsQXBtcyl0aHJvdyBuZXcgaH1yZXR1cm4gdGhpcy53aW5kb3cucGF5cGFsQXBtc30pfWdldFBheVBhbE1lc3NhZ2VzKGUsdCl7cmV0dXJuIG1lKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy53aW5kb3cucGF5cGFsTWVzc2FnZXMpe2NvbnN0IGk9dGhpcy5nZXRQYXlQYWxTZGtNZXNzYWdlc0NvbmZpZ3VyYXRpb24oZSx0KTt5aWVsZCB0aGlzLmxvYWRQYXlQYWxTZGsoaSl9aWYoIXRoaXMud2luZG93LnBheXBhbE1lc3NhZ2VzKXRocm93IG5ldyBoO3JldHVybiB0aGlzLndpbmRvdy5wYXlwYWxNZXNzYWdlc30pfWxvYWRQYXlQYWxTZGsoe29wdGlvbnM6ZSxhdHRyaWJ1dGVzOnR9KXtyZXR1cm4gbWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9dGhpcy50cmFuc2Zvcm1Db25maWcoZSksbj10aGlzLnRyYW5zZm9ybUNvbmZpZyh0KSxvPWBodHRwczovL3d3dy5wYXlwYWwuY29tL3Nkay9qcz8ke25ldyBVUkxTZWFyY2hQYXJhbXMoaSkudG9TdHJpbmcoKX1gO3lpZWxkIHRoaXMuc2NyaXB0TG9hZGVyLmxvYWRTY3JpcHQobyx7YXN5bmM6ITAsYXR0cmlidXRlczpufSl9KX1nZXRQYXlQYWxGYXN0bGFuZVNka0NvbmZpZ3VyYXRpb24oZSx0LGkpe2NvbnN0e2NsaWVudFRva2VuOm4saW5pdGlhbGl6YXRpb25EYXRhOm99PWU7aWYoIW98fCFvLmNsaWVudElkKXRocm93IG5ldyB5KGwuTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0e2ludGVudDphLGNsaWVudElkOnIsbWVyY2hhbnRJZDpzLGF0dHJpYnV0aW9uSWQ6ZH09bztyZXR1cm57b3B0aW9uczp7XCJjbGllbnQtaWRcIjpyLFwibWVyY2hhbnQtaWRcIjpzLGNvbW1pdDohMCxjb21wb25lbnRzOltcImZhc3RsYW5lXCIsXCJidXR0b25zXCIsXCJwYXltZW50LWZpZWxkc1wiLFwiaG9zdGVkLWZpZWxkc1wiLFwidGhyZWUtZG9tYWluLXNlY3VyZVwiXSxjdXJyZW5jeTp0LGludGVudDphfSxhdHRyaWJ1dGVzOntcImRhdGEtY2xpZW50LW1ldGFkYXRhLWlkXCI6aS5yZXBsYWNlKC8tL2csXCJcIiksXCJkYXRhLW5hbWVzcGFjZVwiOlwicGF5cGFsRmFzdGxhbmVTZGtcIixcImRhdGEtcGFydG5lci1hdHRyaWJ1dGlvbi1pZFwiOmQsXCJkYXRhLXNkay1jbGllbnQtdG9rZW5cIjpufX19Z2V0UGF5UGFsR29vZ2xlUGF5U2RrU2NyaXB0Q29uZmlnT3JUaHJvdyhlLHQsaT0hMCl7Y29uc3R7Y2xpZW50VG9rZW46bixpbml0aWFsaXphdGlvbkRhdGE6b309ZTtpZighb3x8IW8uY2xpZW50SWQpdGhyb3cgbmV3IHkobC5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3R7aW50ZW50OmEsY2xpZW50SWQ6cixtZXJjaGFudElkOnMsYnV5ZXJDb3VudHJ5OmQsYXR0cmlidXRpb25JZDpjLGlzSG9zdGVkQ2hlY2tvdXRFbmFibGVkOnAsaXNEZXZlbG9wZXJNb2RlQXBwbGljYWJsZTp1fT1vLGg9cHx8aTtyZXR1cm57b3B0aW9uczpPYmplY3QuYXNzaWduKHtcImNsaWVudC1pZFwiOnIsXCJtZXJjaGFudC1pZFwiOnMsY29tbWl0OmgsY29tcG9uZW50czpbXCJnb29nbGVwYXlcIl0sY3VycmVuY3k6dCxpbnRlbnQ6YX0sdSYme1wiYnV5ZXItY291bnRyeVwiOmR9KSxhdHRyaWJ1dGVzOntcImRhdGEtcGFydG5lci1hdHRyaWJ1dGlvbi1pZFwiOmMsXCJkYXRhLWNsaWVudC10b2tlblwiOm4sXCJkYXRhLW5hbWVzcGFjZVwiOlwicGF5cGFsR29vZ2xlUGF5XCJ9fX1nZXRQYXlQYWxBcG1TZGtDb25maWd1cmF0aW9uKGUsdCl7Y29uc3R7aW5pdGlhbGl6YXRpb25EYXRhOml9PWU7aWYoIWl8fCFpLmNsaWVudElkKXRocm93IG5ldyB5KGwuTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0e2ludGVudDpuLGNsaWVudElkOm8sbWVyY2hhbnRJZDphLGJ1eWVyQ291bnRyeTpyLGF0dHJpYnV0aW9uSWQ6cyxpc0RldmVsb3Blck1vZGVBcHBsaWNhYmxlOmQsYXZhaWxhYmxlQWx0ZXJuYXRpdmVQYXltZW50TWV0aG9kczpjPVtdLGVuYWJsZWRBbHRlcm5hdGl2ZVBheW1lbnRNZXRob2RzOnA9W119PWksdT1wLGg9Yy5maWx0ZXIoZT0+IXAuaW5jbHVkZXMoZSkpO3JldHVybntvcHRpb25zOk9iamVjdC5hc3NpZ24oe1wiY2xpZW50LWlkXCI6byxcIm1lcmNoYW50LWlkXCI6YSxcImVuYWJsZS1mdW5kaW5nXCI6dS5sZW5ndGg+MD91OnZvaWQgMCxcImRpc2FibGUtZnVuZGluZ1wiOmgubGVuZ3RoPjA/aDp2b2lkIDAsY29tbWl0OiEwLGNvbXBvbmVudHM6W1wiYnV0dG9uc1wiLFwicGF5bWVudC1maWVsZHNcIl0sY3VycmVuY3k6dCxpbnRlbnQ6bn0sZCYme1wiYnV5ZXItY291bnRyeVwiOnJ9KSxhdHRyaWJ1dGVzOntcImRhdGEtcGFydG5lci1hdHRyaWJ1dGlvbi1pZFwiOnMsXCJkYXRhLW5hbWVzcGFjZVwiOlwicGF5cGFsQXBtc1wifX19Z2V0UGF5UGFsU2RrTWVzc2FnZXNDb25maWd1cmF0aW9uKGUsdCl7Y29uc3R7aW5pdGlhbGl6YXRpb25EYXRhOml9PWU7aWYoIWl8fCFpLmNsaWVudElkKXRocm93IG5ldyB5KGwuTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0e2NsaWVudElkOm4sbWVyY2hhbnRJZDpvLGF0dHJpYnV0aW9uSWQ6YSxpc0RldmVsb3Blck1vZGVBcHBsaWNhYmxlOnIsYnV5ZXJDb3VudHJ5OnN9PWk7cmV0dXJue29wdGlvbnM6T2JqZWN0LmFzc2lnbih7XCJjbGllbnQtaWRcIjpuLFwibWVyY2hhbnQtaWRcIjpvLGNvbXBvbmVudHM6W1wibWVzc2FnZXNcIl0sY3VycmVuY3k6dH0sciYme1wiYnV5ZXItY291bnRyeVwiOnN9KSxhdHRyaWJ1dGVzOntcImRhdGEtbmFtZXNwYWNlXCI6XCJwYXlwYWxNZXNzYWdlc1wiLFwiZGF0YS1wYXJ0bmVyLWF0dHJpYnV0aW9uLWlkXCI6YX19fXRyYW5zZm9ybUNvbmZpZyhlKXtsZXQgdD17fTtyZXR1cm4gT2JqZWN0LmtleXMoZSkuZm9yRWFjaChpPT57Y29uc3Qgbj1lW2ldO251bGw9PW58fFwiXCI9PT1ufHxBcnJheS5pc0FycmF5KG4pJiYwPT09bi5sZW5ndGh8fCh0PU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7W2ldOkFycmF5LmlzQXJyYXkobik/bi5qb2luKFwiLFwiKTpufSkpfSksdH19Y29uc3QgdmU9e3NpemU6NzAsY29sb3I6XCIjZDlkOWQ5XCIsYmFja2dyb3VuZENvbG9yOlwiI2ZmZmZmZlwifSxmZT1cImVtYmVkZGVkLWNoZWNrb3V0LWxvYWRpbmctaW5kaWNhdG9yLXJvdGF0aW9uXCI7Y2xhc3MgU2V7Y29uc3RydWN0b3IoZSl7dGhpcy5zdHlsZXM9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHZlKSxlJiZlLnN0eWxlcyksdGhpcy5jb250YWluZXJTdHlsZXM9T2JqZWN0LmFzc2lnbih7fSxlJiZlLmNvbnRhaW5lclN0eWxlcyksdGhpcy5kZWZpbmVBbmltYXRpb24oKSx0aGlzLmNvbnRhaW5lcj10aGlzLmJ1aWxkQ29udGFpbmVyKCksdGhpcy5pbmRpY2F0b3I9dGhpcy5idWlsZEluZGljYXRvcigpLHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuaW5kaWNhdG9yKX1zaG93KGUpe2lmKGUpe2NvbnN0IHQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSk7aWYoIXQpdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIGF0dGFjaCB0aGUgbG9hZGluZyBpbmRpY2F0b3IgYmVjYXVzZSB0aGUgcGFyZW50IElEIGlzIG5vdCB2YWxpZC5cIik7dC5hcHBlbmRDaGlsZCh0aGlzLmNvbnRhaW5lcil9dGhpcy5jb250YWluZXIuc3R5bGUudmlzaWJpbGl0eT1cInZpc2libGVcIix0aGlzLmNvbnRhaW5lci5zdHlsZS5vcGFjaXR5PVwiMVwifWhpZGUoKXtjb25zdCBlPSgpPT57dGhpcy5jb250YWluZXIuc3R5bGUudmlzaWJpbGl0eT1cImhpZGRlblwiLHRoaXMuY29udGFpbmVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsZSl9O3RoaXMuY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsZSksdGhpcy5jb250YWluZXIuc3R5bGUub3BhY2l0eT1cIjBcIn1idWlsZENvbnRhaW5lcigpe2NvbnN0IGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtyZXR1cm4gZS5zdHlsZS5kaXNwbGF5PVwiYmxvY2tcIixlLnN0eWxlLmJvdHRvbT1cIjBcIixlLnN0eWxlLmxlZnQ9XCIwXCIsZS5zdHlsZS5oZWlnaHQ9XCIxMDAlXCIsZS5zdHlsZS53aWR0aD1cIjEwMCVcIixlLnN0eWxlLnBvc2l0aW9uPVwiYWJzb2x1dGVcIixlLnN0eWxlLnJpZ2h0PVwiMFwiLGUuc3R5bGUudG9wPVwiMFwiLGUuc3R5bGUudHJhbnNpdGlvbj1cImFsbCAyNTBtcyBlYXNlLW91dFwiLGUuc3R5bGUub3BhY2l0eT1cIjBcIix0aGlzLnNldFN0eWxlQXR0cmlidXRlKGUsdGhpcy5jb250YWluZXJTdHlsZXMpLGV9YnVpbGRJbmRpY2F0b3IoKXtjb25zdCBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7cmV0dXJuIGUuc3R5bGUuZGlzcGxheT1cImJsb2NrXCIsZS5zdHlsZS53aWR0aD1gJHt0aGlzLnN0eWxlcy5zaXplfXB4YCxlLnN0eWxlLmhlaWdodD1gJHt0aGlzLnN0eWxlcy5zaXplfXB4YCxlLnN0eWxlLmJvcmRlclJhZGl1cz1gJHt0aGlzLnN0eWxlcy5zaXplfXB4YCxlLnN0eWxlLmJvcmRlcj1cInNvbGlkIDFweFwiLGUuc3R5bGUuYm9yZGVyQ29sb3I9YCR7dGhpcy5zdHlsZXMuYmFja2dyb3VuZENvbG9yfSAke3RoaXMuc3R5bGVzLmJhY2tncm91bmRDb2xvcn0gJHt0aGlzLnN0eWxlcy5jb2xvcn0gJHt0aGlzLnN0eWxlcy5jb2xvcn1gLGUuc3R5bGUubWFyZ2luPVwiMCBhdXRvXCIsZS5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCIsZS5zdHlsZS5sZWZ0PVwiMFwiLGUuc3R5bGUucmlnaHQ9XCIwXCIsZS5zdHlsZS50b3A9XCI1MCVcIixlLnN0eWxlLnRyYW5zZm9ybT1cInRyYW5zbGF0ZVkoLTUwJSkgcm90YXRlKDBkZWcpXCIsZS5zdHlsZS50cmFuc2Zvcm1TdHlsZT1cInByZXNlcnZlLTNkXCIsZS5zdHlsZS5hbmltYXRpb249YCR7ZmV9IDUwMG1zIGluZmluaXRlIGN1YmljLWJlemllcigwLjY5LCAwLjMxLCAwLjU2LCAwLjgzKWAsZX1zZXRTdHlsZUF0dHJpYnV0ZShlLHQpe09iamVjdC5rZXlzKHQpLmZvckVhY2goaT0+e2Uuc3R5bGUuc2V0UHJvcGVydHkoaSx0W2ldKX0pfWRlZmluZUFuaW1hdGlvbigpe3ZhciBlO2lmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGZlKSlyZXR1cm47Y29uc3QgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7dC5pZD1mZSxudWxsPT09KGU9ZG9jdW1lbnQuaGVhZCl8fHZvaWQgMD09PWV8fGUuYXBwZW5kQ2hpbGQodCksdC5zaGVldCBpbnN0YW5jZW9mIENTU1N0eWxlU2hlZXQmJnQuc2hlZXQuaW5zZXJ0UnVsZShgXFxuICAgICAgICAgICAgICAgIEBrZXlmcmFtZXMgJHtmZX0ge1xcbiAgICAgICAgICAgICAgICAgICAgMCUgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSkgcm90YXRlKDBkZWcpOyB9XFxuICAgICAgICAgICAgICAgICAgICAxMDAlIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpIHJvdGF0ZSgzNjBkZWcpOyB9XFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBgLDApfX1jb25zdCBJZT17XCJiYWNrZ3JvdW5kLWNvbG9yXCI6XCJyZ2JhKDAsIDAsIDAsIDAuNClcIixcInotaW5kZXhcIjpcIjEwMDBcIn07Y2xhc3Mgd2UgZXh0ZW5kcyBfe2NvbnN0cnVjdG9yKGUpe2xldCB0PVwiVW5hYmxlIHRvIHN1Ym1pdCBwYXltZW50IGZvciB0aGUgb3JkZXIgYmVjYXVzZSB0aGUgcGF5bG9hZCBpcyBpbnZhbGlkLlwiO2UmJih0PWAke3R9IE1ha2Ugc3VyZSB0aGUgZm9sbG93aW5nIGZpZWxkcyBhcmUgcHJvdmlkZWQgY29ycmVjdGx5OiAke2Uuam9pbihcIiwgXCIpfS5gKSxzdXBlcih0KSx0aGlzLm5hbWU9XCJQYXltZW50QXJndW1lbnRJbnZhbGlkRXJyb3JcIn19Y2xhc3MgYmUgZXh0ZW5kcyB2e2NvbnN0cnVjdG9yKGUpe3N1cGVyKGUse21lc3NhZ2U6XCJUaGVyZSBpcyBhIHByb2JsZW0gcHJvY2Vzc2luZyB5b3VyIHBheW1lbnQuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCJ9KSx0aGlzLm5hbWU9XCJQYXltZW50TWV0aG9kSW52YWxpZEVycm9yXCIsdGhpcy50eXBlPVwicGF5bWVudF9tZXRob2RfaW52YWxpZFwifX1jbGFzcyBQZSBleHRlbmRzIHV7Y29uc3RydWN0b3IoKXtzdXBlcihcIlRoZSBjdXJyZW50IG9yZGVyIGRvZXMgbm90IG5lZWQgdG8gYmUgZmluYWxpemVkIGF0IHRoaXMgc3RhZ2UuXCIpLHRoaXMubmFtZT1cIk9yZGVyRmluYWxpemF0aW9uTm90UmVxdWlyZWRFcnJvclwiLHRoaXMudHlwZT1cIm9yZGVyX2ZpbmFsaXphdGlvbl9ub3RfcmVxdWlyZWRcIn19ZnVuY3Rpb24gQ2UoZSl7cmV0dXJuIShcIm9iamVjdFwiIT10eXBlb2YgZXx8bnVsbD09PWV8fHZvaWQgMCE9PWUuc2hvdWxkU2F2ZUluc3RydW1lbnQmJlwiYm9vbGVhblwiIT10eXBlb2YgZS5zaG91bGRTYXZlSW5zdHJ1bWVudHx8dm9pZCAwIT09ZS5zaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50JiZcImJvb2xlYW5cIiE9dHlwZW9mIGUuc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudCl9ZnVuY3Rpb24gT2UoZSl7cmV0dXJuIEJvb2xlYW4oZS5pbnN0cnVtZW50SWQpfWNvbnN0IGtlPWZ1bmN0aW9uKHtzdHlsZXM6ZX0pe2NvbnN0IHQ9e307cmV0dXJuIGUuY29sb3ImJih0LmNvbG9yPWUuY29sb3IpLGUubGF5b3V0JiYodC5sYXlvdXQ9ZS5sYXlvdXQpLChlW1wibG9nby10eXBlXCJdfHxlW1wibG9nby1wb3NpdGlvblwiXSkmJih0LmxvZ289e30sZVtcImxvZ28tdHlwZVwiXSYmKHQubG9nby50eXBlPWVbXCJsb2dvLXR5cGVcIl0pLGVbXCJsb2dvLXBvc2l0aW9uXCJdJiYodC5sb2dvLnBvc2l0aW9uPWVbXCJsb2dvLXBvc2l0aW9uXCJdKSksZS5yYXRpbyYmKHQucmF0aW89ZS5yYXRpbyksKGVbXCJ0ZXh0LWNvbG9yXCJdfHxlW1widGV4dC1zaXplXCJdKSYmKHQudGV4dD17fSxlW1widGV4dC1jb2xvclwiXSYmKHQudGV4dC5jb2xvcj1lW1widGV4dC1jb2xvclwiXSksZVtcInRleHQtc2l6ZVwiXSYmKHQudGV4dC5zaXplPStlW1widGV4dC1zaXplXCJdKSksdH07ZnVuY3Rpb24gQWUoZSl7cmV0dXJuXCJvYmplY3RcIj09dHlwZW9mIGUmJm51bGwhPT1lJiZcImJpZ3BheVRva2VuXCJpbiBlJiZcImRlZmF1bHRJbnN0cnVtZW50XCJpbiBlJiZcInByb3ZpZGVyXCJpbiBlJiZcInRydXN0ZWRTaGlwcGluZ0FkZHJlc3NcImluIGUmJlwibWV0aG9kXCJpbiBlJiZcInR5cGVcImluIGV9dmFyIEVlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8sYSl7ZnVuY3Rpb24gcihlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHIscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIFRle2NvbnN0cnVjdG9yKGUsdCxpLG4pe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2U9dCx0aGlzLnBheXBhbENvbW1lcmNlU2RrPWksdGhpcy5sb2FkaW5nSW5kaWNhdG9yPW59aW5pdGlhbGl6ZShlKXt2YXIgdDtyZXR1cm4gRWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e21ldGhvZElkOmkscGF5cGFsY29tbWVyY2U6bn09ZXx8e307aWYodGhpcy5wYXlwYWxjb21tZXJjZT1uLCFpKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLnBheXBhbGNvbW1lcmNlXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKTtjb25zdCBvPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLGE9by5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSx7Y29udGFpbmVyOnIsYmFubmVyQ29udGFpbmVySWQ6c309bix7b3JkZXJJZDpkLHBheXBhbEJOUExDb25maWd1cmF0aW9uOmw9W10saXNQYXlQYWxDcmVkaXRBdmFpbGFibGU6Y309YS5pbml0aWFsaXphdGlvbkRhdGF8fHt9O2lmKHZvaWQgMCE9PXMpe2lmKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChzKSlyZXR1cm4gdm9pZCBjb25zb2xlLmVycm9yKFwiVW5hYmxlIHRvIGNyZWF0ZSBiYW5uZXIgd2l0aG91dCB2YWxpZCBiYW5uZXIgY29udGFpbmVyIElELlwiKTtjb25zdCBlPW51bGw9PWw/dm9pZCAwOmwuZmluZCgoe2lkOmV9KT0+XCJjaGVja291dFwiPT09ZSk7aWYoY3x8IShudWxsPT1lP3ZvaWQgMDplLnN0YXR1cykpcmV0dXJuO2NvbnN0IHQ9eWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZVNkay5nZXRQYXlQYWxNZXNzYWdlcyhhLG8uZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlKTtyZXR1cm4gdCYmXCJmdW5jdGlvblwiPT10eXBlb2YobnVsbD09dD92b2lkIDA6dC5NZXNzYWdlcyk/dGhpcy5yZW5kZXJNZXNzYWdlcyh0LHMsZSk6dm9pZCBjb25zb2xlLmVycm9yKFwiW0JDIFBheVBhbENvbW1lcmNlIFBheUxhdGVyXTogYmFubmVyIGNvdWxkIG5vdCBiZSByZW5kZXJlZCwgZHVlIHRvIGlzc3VlcyB3aXRoIGxvYWRpbmcgUGF5UGFsIFNES1wiKX1kP3RoaXMub3JkZXJJZD1udWxsPT09KHQ9YS5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT10P3ZvaWQgMDp0Lm9yZGVySWQ6KHRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj1udWxsPT1yP3ZvaWQgMDpyLnNwbGl0KFwiI1wiKVsxXSx5aWVsZCB0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXlQYWxTZGsoaSksbi5vbkluaXQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIG4ub25Jbml0JiZuLm9uSW5pdCgoKT0+dGhpcy5yZW5kZXJCdXR0b24oaSxuKSksKHZvaWQgMD09PW4uc2hvdWxkUmVuZGVyUGF5UGFsQnV0dG9uT25Jbml0aWFsaXphdGlvbnx8bi5zaG91bGRSZW5kZXJQYXlQYWxCdXR0b25PbkluaXRpYWxpemF0aW9uKSYmdGhpcy5yZW5kZXJCdXR0b24oaSxuKSl9KX1leGVjdXRlKGUsdCl7dmFyIGksbjtyZXR1cm4gRWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6b309ZSxhPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7bzxuLmxlbmd0aDtvKyspdC5pbmRleE9mKG5bb10pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bb10pJiYoaVtuW29dXT1lW25bb11dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKSx7b25FcnJvcjpyfT10aGlzLnBheXBhbGNvbW1lcmNlfHx7fTtpZighbyl0aHJvdyBuZXcgd2UoW1wicGF5bWVudFwiXSk7Y29uc3R7bWV0aG9kSWQ6cyxwYXltZW50RGF0YTpkfT1vO2lmKHRoaXMuaXNQYXlQYWxWYXVsdGVkSW5zdHJ1bWVudFBheW1lbnREYXRhKGQpJiYhdGhpcy5vcmRlcklkJiYodGhpcy5vcmRlcklkPXlpZWxkIHRoaXMuY3JlYXRlT3JkZXIoKSksIXRoaXMub3JkZXJJZCl0aHJvdyBuZXcgYmU7Y29uc3QgbD10aGlzLmlzUGF5UGFsVmF1bHRlZEluc3RydW1lbnRQYXltZW50RGF0YShkKT90aGlzLnByZXBhcmVWYXVsdGVkSW5zdHJ1bWVudFBheW1lbnRQYXlsb2FkKHMsdGhpcy5vcmRlcklkLGQpOnRoaXMucHJlcGFyZVBheW1lbnRQYXlsb2FkKHMsdGhpcy5vcmRlcklkLGQpO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIoYSx0KSx5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChsKX1jYXRjaChlKXtpZihmdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4oZT0+XCJvYmplY3RcIj09dHlwZW9mIGUmJm51bGwhPT1lJiZcImJvZHlcImluIGUpKGUpJiZcIm9mZnNpdGVfcmVkaXJlY3RcIj09PShudWxsPT09KHQ9ZS5ib2R5LmFkZGl0aW9uYWxfYWN0aW9uX3JlcXVpcmVkKXx8dm9pZCAwPT09dD92b2lkIDA6dC50eXBlKX0oZSkpe2NvbnN0IHQ9bnVsbD09PShuPW51bGw9PT0oaT1lLmJvZHkuYWRkaXRpb25hbF9hY3Rpb25fcmVxdWlyZWQpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmRhdGEpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLnJlZGlyZWN0X3VybDtyZXR1cm4gbmV3IFByb21pc2UoKCk9PndpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHQpKX1yZXR1cm4gdGhpcy5pc1Byb3ZpZGVyRXJyb3IoZSkmJih5aWVsZCB0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXlQYWxTZGsoby5tZXRob2RJZCkseWllbGQgbmV3IFByb21pc2UoKGUsdCk9Pnt2YXIgaTt0aGlzLnBheXBhbGNvbW1lcmNlJiYobnVsbD09PShpPXRoaXMucGF5cGFsQnV0dG9uKXx8dm9pZCAwPT09aXx8aS5jbG9zZSgpLHRoaXMucmVuZGVyQnV0dG9uKG8ubWV0aG9kSWQsdGhpcy5wYXlwYWxjb21tZXJjZSksdGhpcy5oYW5kbGVFcnJvcihuZXcgRXJyb3IoXCJJTlNUUlVNRU5UX0RFQ0xJTkVEXCIpLHIpKSx0KCl9KSksdGhpcy5oYW5kbGVFcnJvcihlLHIpLFByb21pc2UucmVqZWN0KCl9fSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFBlKX1kZWluaXRpYWxpemUoKXt2YXIgZTtyZXR1cm4gdGhpcy5vcmRlcklkPXZvaWQgMCxudWxsPT09KGU9dGhpcy5wYXlwYWxCdXR0b24pfHx2b2lkIDA9PT1lfHxlLmNsb3NlKCksUHJvbWlzZS5yZXNvbHZlKCl9cHJlcGFyZVZhdWx0ZWRJbnN0cnVtZW50UGF5bWVudFBheWxvYWQoZSx0LGkpe2NvbnN0e2luc3RydW1lbnRJZDpuLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6b309aSxhPSF0aGlzLmlzVHJ1c3RlZFZhdWx0aW5nRmxvdyhpKTtyZXR1cm4gYT97bWV0aG9kSWQ6ZSxwYXltZW50RGF0YTp7c2hvdWxkU2F2ZUluc3RydW1lbnQ6YSxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50Om8sZm9ybWF0dGVkUGF5bG9hZDp7cGF5cGFsX2FjY291bnQ6e29yZGVyX2lkOnR9fX19OnttZXRob2RJZDplLHBheW1lbnREYXRhOntpbnN0cnVtZW50SWQ6bixzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50Om8sZm9ybWF0dGVkUGF5bG9hZDp7cGF5cGFsX2FjY291bnQ6e29yZGVyX2lkOnR9LGJpZ3BheV90b2tlbjp7dG9rZW46bn19fX19cHJlcGFyZVBheW1lbnRQYXlsb2FkKGUsdCxpKXtjb25zdHtzaG91bGRTYXZlSW5zdHJ1bWVudDpuPSExLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6bz0hMX09Q2UoaSk/aTp7fTtyZXR1cm57bWV0aG9kSWQ6ZSxwYXltZW50RGF0YTp7c2hvdWxkU2F2ZUluc3RydW1lbnQ6bixzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50Om8sZm9ybWF0dGVkUGF5bG9hZDp7cGF5cGFsX2FjY291bnQ6e29yZGVyX2lkOnR9fX19fXJlbmRlckJ1dHRvbihlLHQpe3ZhciBpLG4sbyxhO2NvbnN0IHI9dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5nZXRQYXlQYWxTZGtPclRocm93KCkscz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKSx7cGF5bWVudEJ1dHRvblN0eWxlczpkfT1zLmluaXRpYWxpemF0aW9uRGF0YXx8e30se2NoZWNrb3V0UGF5bWVudEJ1dHRvblN0eWxlczpsfT1kfHx7fSx7Y29udGFpbmVyOmMsb25FcnJvcjpwLG9uUmVuZGVyQnV0dG9uOnUsb25WYWxpZGF0ZTpoLHN1Ym1pdEZvcm06eX09dDtpZighYyl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwiY29udGFpbmVyXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2NvbnN0IG09T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHRoaXMuaXNQYXlwYWxDb21tZXJjZUFwcFN3aXRjaEVuYWJsZWQoZSkmJnthcHBTd2l0Y2hXaGVuQXZhaWxhYmxlOiEwfSkse2Z1bmRpbmdTb3VyY2U6ci5GVU5ESU5HLlBBWVBBTCxzdHlsZTp0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFZhbGlkQnV0dG9uU3R5bGUobCksY3JlYXRlT3JkZXI6KCk9PnRoaXMuY3JlYXRlT3JkZXIoKSxvbkNsaWNrOihlLHQpPT50aGlzLmhhbmRsZUNsaWNrKHQsaCksb25BcHByb3ZlOmU9PnRoaXMuaGFuZGxlQXBwcm92ZShlLHkpLG9uRXJyb3I6ZT0+dGhpcy5oYW5kbGVFcnJvcihlLHApLG9uQ2FuY2VsOigpPT50aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpfSk7dGhpcy5wYXlwYWxCdXR0b249ci5CdXR0b25zKG0pLHRoaXMucGF5cGFsQnV0dG9uLmlzRWxpZ2libGUoKSYmKHUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHUmJnUoKSwobnVsbD09PShuPShpPXRoaXMucGF5cGFsQnV0dG9uKS5oYXNSZXR1cm5lZCl8fHZvaWQgMD09PW4/dm9pZCAwOm4uY2FsbChpKSkmJnRoaXMuaXNQYXlwYWxDb21tZXJjZUFwcFN3aXRjaEVuYWJsZWQoZSk/bnVsbD09PShhPShvPXRoaXMucGF5cGFsQnV0dG9uKS5yZXN1bWUpfHx2b2lkIDA9PT1hfHxhLmNhbGwobyk6dGhpcy5wYXlwYWxCdXR0b24ucmVuZGVyKGMpKX1oYW5kbGVDbGljayhlLHQpe3JldHVybiBFZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cmVzb2x2ZTppLHJlamVjdDpufT1lO3JldHVybiBudWxsPT10P3ZvaWQgMDp0KCgpPT4odGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCEwKSxpKCkpLG4pfSl9aGFuZGxlQXBwcm92ZSh7b3JkZXJJRDplfSx0KXt0aGlzLm9yZGVySWQ9ZSxudWxsPT10fHx0KCl9aGFuZGxlRXJyb3IoZSx0KXt0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLHQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQmJnQoZSl9Y3JlYXRlT3JkZXIoKXtyZXR1cm4gRWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGU9dGhpcy5nZXRGaWVsZHNWYWx1ZXMoKTtyZXR1cm4gdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5jcmVhdGVPcmRlcihcInBheXBhbGNvbW1lcmNlY2hlY2tvdXRcIix7c2hvdWxkU2F2ZUluc3RydW1lbnQ6KG51bGw9PWU/dm9pZCAwOmUuc2hvdWxkU2F2ZUluc3RydW1lbnQpfHwhMX0pfSl9Z2V0RmllbGRzVmFsdWVzKCl7Y29uc3R7Z2V0RmllbGRzVmFsdWVzOmV9PXRoaXMucGF5cGFsY29tbWVyY2V8fHt9O3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIGU/ZSgpOnZvaWQgMH1pc1RydXN0ZWRWYXVsdGluZ0Zsb3coZSl7aWYoZSYmT2UoZSkpe2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0SW5zdHJ1bWVudHMoKSxpPW51bGw9PXQ/dm9pZCAwOnQuZmluZCh0PT5BZSh0KSYmdC5iaWdwYXlUb2tlbj09PWUuaW5zdHJ1bWVudElkKTtyZXR1cm4hKEFlKGkpJiYhaS50cnVzdGVkU2hpcHBpbmdBZGRyZXNzKX1yZXR1cm4hMX10b2dnbGVMb2FkaW5nSW5kaWNhdG9yKGUpe2UmJnRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj90aGlzLmxvYWRpbmdJbmRpY2F0b3Iuc2hvdyh0aGlzLmxvYWRpbmdJbmRpY2F0b3JDb250YWluZXIpOnRoaXMubG9hZGluZ0luZGljYXRvci5oaWRlKCl9aXNQYXlQYWxWYXVsdGVkSW5zdHJ1bWVudFBheW1lbnREYXRhKGUpe3JldHVybiEhZSYmT2UoZSkmJkNlKGUpfXJlbmRlck1lc3NhZ2VzKGUsdCxpKXtjb25zdCBuPXthbW91bnQ6dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2hlY2tvdXRPclRocm93KCkub3V0c3RhbmRpbmdCYWxhbmNlLHBsYWNlbWVudDpcInBheW1lbnRcIixzdHlsZTprZShpKX07ZS5NZXNzYWdlcyhuKS5yZW5kZXIoYCMke3R9YCl9aXNQcm92aWRlckVycm9yKGUpe3ZhciB0LGksbjtyZXR1cm4hIWZ1bmN0aW9uKGUpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmXCJlcnJvcnNcImluIGV9KGUpJiZcIklOU1RSVU1FTlRfREVDTElORURcIj09PShudWxsPT09KG49bnVsbD09PShpPSgobnVsbD09PSh0PW51bGw9PWU/dm9pZCAwOmUuZXJyb3JzKXx8dm9pZCAwPT09dD92b2lkIDA6dC5maWx0ZXIoZT0+ZS5wcm92aWRlcl9lcnJvcikpfHxbXSlbMF0pfHx2b2lkIDA9PT1pP3ZvaWQgMDppLnByb3ZpZGVyX2Vycm9yKXx8dm9pZCAwPT09bj92b2lkIDA6bi5jb2RlKX1pc1BheXBhbENvbW1lcmNlQXBwU3dpdGNoRW5hYmxlZChlKXt2YXIgdDtyZXR1cm4obnVsbD09PSh0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KGUpLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuaXNBcHBTd2l0Y2hFbmFibGVkKXx8ITF9fWNvbnN0IHplPXAoZT0+bmV3IFRlKGUsTihlKSxuZXcgZ2UobigpKSxuZXcgU2Uoe2NvbnRhaW5lclN0eWxlczpJZX0pKSxbe2lkOlwicGF5cGFsY29tbWVyY2VcIn1dKTtjbGFzcyBGZSBleHRlbmRzIHV7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJOb3QgaW1wbGVtZW50ZWQuXCIpLHRoaXMubmFtZT1cIk5vdEltcGxlbWVudGVkRXJyb3JcIix0aGlzLnR5cGU9XCJub3RfaW1wbGVtZW50ZWRcIn19dmFyIEJlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8sYSl7ZnVuY3Rpb24gcihlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHIscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIE1le2NvbnN0cnVjdG9yKGUsdCxpLG4pe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2U9dCx0aGlzLmxvYWRpbmdJbmRpY2F0b3I9aSx0aGlzLnBheXBhbENvbW1lcmNlU2RrPW59aW5pdGlhbGl6ZShlKXtyZXR1cm4gQmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e21ldGhvZElkOnQscGF5cGFsY29tbWVyY2U6aSxwYXlwYWxjb21tZXJjZWNyZWRpdDpufT1lfHx7fSxvPW58fGk7aWYoIXQpdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIW8pdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMucGF5cGFsY29tbWVyY2VcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKHQpO2NvbnN0IGE9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkscj1hLmdldFBheW1lbnRNZXRob2RPclRocm93KHQpLHtwYXlwYWxCTlBMQ29uZmlndXJhdGlvbjpzPVtdLG9yZGVySWQ6ZH09ci5pbml0aWFsaXphdGlvbkRhdGF8fHt9LHtiYW5uZXJDb250YWluZXJJZDpsLGNvbnRhaW5lcjpjfT1vO2lmKHZvaWQgMCE9PWwpe2lmKCFkb2N1bWVudC5nZXRFbGVtZW50QnlJZChsKSlyZXR1cm4gdm9pZCBjb25zb2xlLmVycm9yKFwiVW5hYmxlIHRvIGNyZWF0ZSBiYW5uZXIgd2l0aG91dCB2YWxpZCBiYW5uZXIgY29udGFpbmVyIElELlwiKTtjb25zdCBlPXMmJnMuZmluZCgoe2lkOmV9KT0+XCJjaGVja291dFwiPT09ZSk7aWYoIShudWxsPT1lP3ZvaWQgMDplLnN0YXR1cykpcmV0dXJuO2NvbnN0IHQ9eWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZVNkay5nZXRQYXlQYWxNZXNzYWdlcyhyLGEuZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlKTtyZXR1cm4gdGhpcy5yZW5kZXJNZXNzYWdlcyh0LGwsZSl9ZD90aGlzLm9yZGVySWQ9ZDooeWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5sb2FkUGF5UGFsU2RrKHQpLHRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj1udWxsPT1jP3ZvaWQgMDpjLnNwbGl0KFwiI1wiKVsxXSx0aGlzLnJlbmRlckJ1dHRvbih0LG8pKX0pfWV4ZWN1dGUoZSx0KXtyZXR1cm4gQmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6aX09ZSxuPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7bzxuLmxlbmd0aDtvKyspdC5pbmRleE9mKG5bb10pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bb10pJiYoaVtuW29dXT1lW25bb11dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKTtpZighaSl0aHJvdyBuZXcgd2UoW1wicGF5bWVudFwiXSk7aWYoIXRoaXMub3JkZXJJZCl0aHJvdyBuZXcgYmU7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKG4sdCkseWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGkubWV0aG9kSWQsdGhpcy5vcmRlcklkKX0pfWZpbmFsaXplKCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBQZSl9ZGVpbml0aWFsaXplKCl7dmFyIGU7cmV0dXJuIHRoaXMub3JkZXJJZD12b2lkIDAsbnVsbD09PShlPXRoaXMucGF5cGFsQnV0dG9uKXx8dm9pZCAwPT09ZXx8ZS5jbG9zZSgpLFByb21pc2UucmVzb2x2ZSgpfXJlbmRlckJ1dHRvbihlLHQpe2lmKCEobnVsbD09dD92b2lkIDA6dC5jb250YWluZXIpKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJjb250YWluZXJcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7Y29uc3QgaT10aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheVBhbFNka09yVGhyb3coKSxuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KGUpLHtwYXltZW50QnV0dG9uU3R5bGVzOm99PW4uaW5pdGlhbGl6YXRpb25EYXRhfHx7fSx7Y2hlY2tvdXRQYXltZW50QnV0dG9uU3R5bGVzOmF9PW98fHt9LHtjb250YWluZXI6cixvbkVycm9yOnMsb25SZW5kZXJCdXR0b246ZCxvblZhbGlkYXRlOmwsc3VibWl0Rm9ybTpjfT10LHA9W2kuRlVORElORy5QQVlMQVRFUixpLkZVTkRJTkcuQ1JFRElUXTtsZXQgdT0hMTtwLmZvckVhY2goZT0+e2lmKHUpcmV0dXJuO2NvbnN0IHQ9e2Z1bmRpbmdTb3VyY2U6ZSxzdHlsZTp0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFZhbGlkQnV0dG9uU3R5bGUoYSksY3JlYXRlT3JkZXI6KCk9PnRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlT3JkZXIoXCJwYXlwYWxjb21tZXJjZWNyZWRpdGNoZWNrb3V0XCIpLG9uQ2xpY2s6KGUsdCk9PnRoaXMuaGFuZGxlQ2xpY2sodCxsKSxvbkFwcHJvdmU6ZT0+dGhpcy5oYW5kbGVBcHByb3ZlKGUsYyksb25DYW5jZWw6KCk9PnRoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksb25FcnJvcjplPT50aGlzLmhhbmRsZUVycm9yKGUscyl9O2lmKHRoaXMucGF5cGFsQnV0dG9uPWkuQnV0dG9ucyh0KSx0aGlzLnBheXBhbEJ1dHRvbi5pc0VsaWdpYmxlKCl8fGUhPT1pLkZVTkRJTkcuUEFZTEFURVIpe2lmKCF0aGlzLnBheXBhbEJ1dHRvbi5pc0VsaWdpYmxlKCkmJmU9PT1pLkZVTkRJTkcuQ1JFRElUKXRocm93IG5ldyBGZShgUGF5UGFsICR7ZX0gaXMgbm90IGF2YWlsYWJsZSBmb3IgeW91ciByZWdpb24uIFBsZWFzZSB1c2UgUGF5UGFsIENoZWNrb3V0IGluc3RlYWQuYCk7ZCYmXCJmdW5jdGlvblwiPT10eXBlb2YgZCYmZCgpLHRoaXMucGF5cGFsQnV0dG9uLnJlbmRlcihyKSx1PSEwfX0pfWhhbmRsZUNsaWNrKGUsdCl7cmV0dXJuIEJlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtyZXNvbHZlOmkscmVqZWN0Om59PWU7aWYodCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdClyZXR1cm4gdCgoKT0+KHRoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMCksaSgpKSxuKX0pfWhhbmRsZUFwcHJvdmUoe29yZGVySUQ6ZX0sdCl7dGhpcy5vcmRlcklkPWUsdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdCYmdCgpfWhhbmRsZUVycm9yKGUsdCl7dGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKSx0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0JiZ0KGUpfXRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoZSl7ZSYmdGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyP3RoaXMubG9hZGluZ0luZGljYXRvci5zaG93KHRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcik6dGhpcy5sb2FkaW5nSW5kaWNhdG9yLmhpZGUoKX1yZW5kZXJNZXNzYWdlcyhlLHQsaSl7Y29uc3Qgbj17YW1vdW50OnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENoZWNrb3V0T3JUaHJvdygpLm91dHN0YW5kaW5nQmFsYW5jZSxwbGFjZW1lbnQ6XCJwYXltZW50XCIsc3R5bGU6a2UoaSl9O2UuTWVzc2FnZXMobikucmVuZGVyKGAjJHt0fWApfX1jb25zdCBEZT1wKGU9Pm5ldyBNZShlLE4oZSksbmV3IFNlKHtjb250YWluZXJTdHlsZXM6SWV9KSxuZXcgZ2UoaSgpKSksW3tpZDpcInBheXBhbGNvbW1lcmNlY3JlZGl0XCJ9XSk7dmFyIHhlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8sYSl7ZnVuY3Rpb24gcihlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHIscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIE5le2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlPXQsdGhpcy5sb2FkaW5nSW5kaWNhdG9yPWl9aW5pdGlhbGl6ZShlKXt2YXIgdCxpO3JldHVybiB4ZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6bixwYXlwYWxjb21tZXJjZTpvLHBheXBhbGNvbW1lcmNldmVubW86YX09ZXx8e30scj1hfHxvO2lmKCFuKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFyKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLnBheXBhbGNvbW1lcmNldmVubW9cIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKG4pO2NvbnN0IHM9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3cobik7KG51bGw9PT0odD1zLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQub3JkZXJJZCk/dGhpcy5vcmRlcklkPW51bGw9PT0oaT1zLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PWk/dm9pZCAwOmkub3JkZXJJZDooeWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5sb2FkUGF5UGFsU2RrKG4pLHRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj1yLmNvbnRhaW5lci5zcGxpdChcIiNcIilbMV0sdGhpcy5yZW5kZXJCdXR0b24obixyKSl9KX1leGVjdXRlKGUsdCl7cmV0dXJuIHhlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Oml9PWUsbj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIG89MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO288bi5sZW5ndGg7bysrKXQuaW5kZXhPZihuW29dKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW29dKSYmKGlbbltvXV09ZVtuW29dXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSk7aWYoIWkpdGhyb3cgbmV3IHdlKFtcInBheW1lbnRcIl0pO2lmKCF0aGlzLm9yZGVySWQpdGhyb3cgbmV3IGJlO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihuLHQpLHlpZWxkIHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChpLm1ldGhvZElkLHRoaXMub3JkZXJJZCl9KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgUGUpfWRlaW5pdGlhbGl6ZSgpe3ZhciBlO3JldHVybiB0aGlzLm9yZGVySWQ9dm9pZCAwLG51bGw9PT0oZT10aGlzLnBheXBhbEJ1dHRvbil8fHZvaWQgMD09PWV8fGUuY2xvc2UoKSxQcm9taXNlLnJlc29sdmUoKX1yZW5kZXJCdXR0b24oZSx0KXtjb25zdCBpPXRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5UGFsU2RrT3JUaHJvdygpLG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSkse3BheW1lbnRCdXR0b25TdHlsZXM6b309bi5pbml0aWFsaXphdGlvbkRhdGF8fHt9LHtjaGVja291dFBheW1lbnRCdXR0b25TdHlsZXM6YX09b3x8e30se2NvbnRhaW5lcjpyLG9uRXJyb3I6cyxvblJlbmRlckJ1dHRvbjpkLG9uVmFsaWRhdGU6bCxzdWJtaXRGb3JtOmN9PXQscD17ZnVuZGluZ1NvdXJjZTppLkZVTkRJTkcuVkVOTU8sc3R5bGU6dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5nZXRWYWxpZEJ1dHRvblN0eWxlKGEpLGNyZWF0ZU9yZGVyOigpPT50aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZU9yZGVyKFwicGF5cGFsY29tbWVyY2V2ZW5tb2NoZWNrb3V0XCIpLG9uQ2xpY2s6KGUsdCk9PnRoaXMuaGFuZGxlQ2xpY2sodCxsKSxvbkFwcHJvdmU6ZT0+dGhpcy5oYW5kbGVBcHByb3ZlKGUsYyksb25DYW5jZWw6KCk9PnRoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksb25FcnJvcjplPT50aGlzLmhhbmRsZUVycm9yKGUscyl9O2lmKHRoaXMucGF5cGFsQnV0dG9uPWkuQnV0dG9ucyhwKSwhdGhpcy5wYXlwYWxCdXR0b24uaXNFbGlnaWJsZSgpKXRocm93IG5ldyBGZShcIlBheVBhbCBWZW5tbyBpcyBub3QgYXZhaWxhYmxlIGZvciB5b3VyIHJlZ2lvbi4gUGxlYXNlIHVzZSBQYXlQYWwgQ2hlY2tvdXQgaW5zdGVhZC5cIik7ZCYmXCJmdW5jdGlvblwiPT10eXBlb2YgZCYmZCgpLHRoaXMucGF5cGFsQnV0dG9uLnJlbmRlcihyKX1oYW5kbGVDbGljayhlLHQpe3JldHVybiB4ZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cmVzb2x2ZTppLHJlamVjdDpufT1lO3JldHVybiB0KCgpPT4odGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCEwKSxpKCkpLG4pfSl9aGFuZGxlQXBwcm92ZSh7b3JkZXJJRDplfSx0KXt0aGlzLm9yZGVySWQ9ZSx0KCksdGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKX1oYW5kbGVFcnJvcihlLHQpe3RoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdCYmdChlKX10b2dnbGVMb2FkaW5nSW5kaWNhdG9yKGUpe2UmJnRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj90aGlzLmxvYWRpbmdJbmRpY2F0b3Iuc2hvdyh0aGlzLmxvYWRpbmdJbmRpY2F0b3JDb250YWluZXIpOnRoaXMubG9hZGluZ0luZGljYXRvci5oaWRlKCl9fWNvbnN0IF9lPXAoZT0+bmV3IE5lKGUsTihlKSxuZXcgU2Uoe3N0eWxlczp7YmFja2dyb3VuZENvbG9yOlwiYmxhY2tcIn19KSksW3tpZDpcInBheXBhbGNvbW1lcmNldmVubW9cIn1dKTtjbGFzcyBqZSBleHRlbmRzIHZ7Y29uc3RydWN0b3IoZSl7c3VwZXIoZSx7bWVzc2FnZTpcIlRoZSByZXF1ZXN0IGhhcyB0aW1lZCBvdXQgb3IgYWJvcnRlZC5cIn0pLHRoaXMubmFtZT1cIlRpbWVvdXRFcnJvclwiLHRoaXMudHlwZT1cInRpbWVvdXRcIn19dmFyIFVlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8sYSl7ZnVuY3Rpb24gcihlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHIscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIFZle2NvbnN0cnVjdG9yKGUsdCxpLG4sbz0zZTMsYT0zZTUpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2U9dCx0aGlzLnBheXBhbFNka1NjcmlwdExvYWRlcj1pLHRoaXMubG9hZGluZ0luZGljYXRvcj1uLHRoaXMucG9sbGluZ0ludGVydmFsPW8sdGhpcy5tYXhQb2xsaW5nSW50ZXJ2YWxUaW1lPWEsdGhpcy5wb2xsaW5nVGltZXI9MCx0aGlzLnN0b3BQb2xsaW5nPXIsdGhpcy5pc09yZGVyQXBwcm92ZWRQcm9jZXNzaW5nPSExfWluaXRpYWxpemUoZSl7cmV0dXJuIFVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtnYXRld2F5SWQ6dCxtZXRob2RJZDppLHBheXBhbGNvbW1lcmNlOm4scGF5cGFsY29tbWVyY2VhbHRlcm5hdGl2ZW1ldGhvZHM6b309ZSxhPW98fG47aWYodGhpcy5wYXlwYWxjb21tZXJjZWFsdGVybmF0aXZlbWV0aG9kcz1vLCFpKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCF0KXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmdhdGV3YXlJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighYSl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5wYXlwYWxjb21tZXJjZWFsdGVybmF0aXZlbWV0aG9kc1wiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtjb25zdCByPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHM9ci5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpLHQpLHtvcmRlcklkOmQsc2hvdWxkUmVuZGVyRmllbGRzOmx9PXMuaW5pdGlhbGl6YXRpb25EYXRhfHx7fSxjPXIuZ2V0U3RvcmVDb25maWdPclRocm93KCkuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlczt0aGlzLmlzT3JkZXJBcHByb3ZlZFByb2Nlc3Npbmc9ZnVuY3Rpb24oZSx0LGk9ITApe3ZhciBuO3JldHVybiBudWxsIT09KG49ZVtcIlBBWVBBTC01NDMxLm9yZGVyX2FwcHJvdmVkX3Byb2Nlc3NpbmdcIl0pJiZ2b2lkIDAhPT1uP246aX0oYyksZD90aGlzLm9yZGVySWQ9ZDoodGhpcy5wYXlwYWxBcG1zPXlpZWxkIHRoaXMucGF5cGFsU2RrU2NyaXB0TG9hZGVyLmdldFBheVBhbEFwbXNTZGsocyxyLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZSksdGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyPWEuY29udGFpbmVyLnNwbGl0KFwiI1wiKVsxXSx0aGlzLnJlbmRlckJ1dHRvbihpLHQsYSksbCYmdGhpcy5yZW5kZXJGaWVsZHMoaSxhKSl9KX1leGVjdXRlKGUsdCl7cmV0dXJuIFVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Oml9PWUsbj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIG89MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO288bi5sZW5ndGg7bysrKXQuaW5kZXhPZihuW29dKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW29dKSYmKGlbbltvXV09ZVtuW29dXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSk7aWYoIWkpdGhyb3cgbmV3IHdlKFtcInBheW1lbnRcIl0pO2NvbnN0e21ldGhvZElkOm8sZ2F0ZXdheUlkOmF9PWk7aWYoIXRoaXMub3JkZXJJZCl0aHJvdyBuZXcgYmU7dGhpcy5pc09yZGVyQXBwcm92ZWRQcm9jZXNzaW5nfHxcImlkZWFsXCIhPT1vfHwoeWllbGQgbmV3IFByb21pc2UoKGUsdCk9Pnt0aGlzLmluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKG8sZSx0LGEpfSkpLHRoaXMuaXNOb25JbnN0YW50UGF5bWVudE1ldGhvZChvKSYmKG8hPT1DLklERUFMfHx0aGlzLmlzT3JkZXJBcHByb3ZlZFByb2Nlc3NpbmcpfHwoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKG4sdCkpLHlpZWxkIHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChvLHRoaXMub3JkZXJJZCxhKX0pfWZpbmFsaXplKCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBQZSl9ZGVpbml0aWFsaXplKCl7dmFyIGU7cmV0dXJuIHRoaXMub3JkZXJJZD12b2lkIDAsdGhpcy5pc09yZGVyQXBwcm92ZWRQcm9jZXNzaW5nfHx0aGlzLnJlc2V0UG9sbGluZ01lY2hhbmlzbSgpLG51bGw9PT0oZT10aGlzLnBheXBhbEJ1dHRvbil8fHZvaWQgMD09PWV8fGUuY2xvc2UoKSxQcm9taXNlLnJlc29sdmUoKX1pbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbShlLHQsaSxuKXtyZXR1cm4gVWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIG5ldyBQcm9taXNlKChlLHQpPT57Y29uc3QgaT1zZXRUaW1lb3V0KGUsdGhpcy5wb2xsaW5nSW50ZXJ2YWwpO3RoaXMuc3RvcFBvbGxpbmc9KCk9PihjbGVhclRpbWVvdXQoaSksdGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKSx0KCkpfSk7dHJ5e3RoaXMucG9sbGluZ1RpbWVyKz10aGlzLnBvbGxpbmdJbnRlcnZhbDtjb25zdCBvPXlpZWxkIHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0T3JkZXJTdGF0dXMobnVsbCE9bj9uOlwicGF5cGFsY29tbWVyY2VcIiksYT1vPT09Ty5BcHByb3ZlZCxyPW89PT1PLlBvbGxpbmdFcnJvcjtpZihhKXJldHVybiB0aGlzLmRlaW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oKSx0KCk7aWYocilyZXR1cm4gaSgpO2lmKCFhJiZ0aGlzLnBvbGxpbmdUaW1lcjx0aGlzLm1heFBvbGxpbmdJbnRlcnZhbFRpbWUpcmV0dXJuIHlpZWxkIHRoaXMuaW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oZSx0LGksbik7eWllbGQgdGhpcy5yZWluaXRpYWxpemVTdHJhdGVneSh7bWV0aG9kSWQ6ZSxnYXRld2F5SWQ6bixwYXlwYWxjb21tZXJjZWFsdGVybmF0aXZlbWV0aG9kczp0aGlzLnBheXBhbGNvbW1lcmNlYWx0ZXJuYXRpdmVtZXRob2RzfSksdGhpcy5oYW5kbGVFcnJvcihuZXcgamUpfWNhdGNoKGUpe2koKX19KX1kZWluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKCl7dGhpcy5zdG9wUG9sbGluZygpLHRoaXMucG9sbGluZ1RpbWVyPTB9cmVzZXRQb2xsaW5nTWVjaGFuaXNtKCl7dGhpcy5kZWluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKCl9cmVpbml0aWFsaXplU3RyYXRlZ3koZSl7cmV0dXJuIFVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLmRlaW5pdGlhbGl6ZSgpLHlpZWxkIHRoaXMuaW5pdGlhbGl6ZShlKX0pfWhhbmRsZUVycm9yKGUpe2NvbnN0e29uRXJyb3I6dH09dGhpcy5wYXlwYWxjb21tZXJjZWFsdGVybmF0aXZlbWV0aG9kc3x8e307dGhpcy5pc09yZGVyQXBwcm92ZWRQcm9jZXNzaW5nfHx0aGlzLnJlc2V0UG9sbGluZ01lY2hhbmlzbSgpLHRoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdCYmdChlKX1yZW5kZXJCdXR0b24oZSx0LGkpe2NvbnN0IG49dGhpcy5nZXRQYXlwYWxBbXBzU2RrT3JUaHJvdygpLG89dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSx0KSx7YnV0dG9uU3R5bGU6YX09by5pbml0aWFsaXphdGlvbkRhdGF8fHt9LHtjb250YWluZXI6cixvbkVycm9yOnMsb25SZW5kZXJCdXR0b246ZCxzdWJtaXRGb3JtOmx9PWksYz17ZnVuZGluZ1NvdXJjZTplLHN0eWxlOnRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0VmFsaWRCdXR0b25TdHlsZShhKSxvbkluaXQ6KGUsdCk9Pmkub25Jbml0QnV0dG9uKHQpLGNyZWF0ZU9yZGVyOigpPT50aGlzLm9uQ3JlYXRlT3JkZXIoZSx0LGkpLG9uQXBwcm92ZTplPT50aGlzLmhhbmRsZUFwcHJvdmUoZSxsKSxvbkNhbmNlbDooKT0+e3RoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksdGhpcy5kZWluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKCl9LG9uRXJyb3I6ZT0+e3RoaXMuZGVpbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbSgpLHRoaXMuaGFuZGxlRmFpbHVyZShlLHMpfSxvbkNsaWNrOihlLHQpPT5VZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIGkub25WYWxpZGF0ZSh0LnJlc29sdmUsdC5yZWplY3QpfSl9O3RoaXMucGF5cGFsQnV0dG9uPW4uQnV0dG9ucyhjKSx0aGlzLnBheXBhbEJ1dHRvbi5pc0VsaWdpYmxlKCkmJihkJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBkJiZkKCksdGhpcy5wYXlwYWxCdXR0b24ucmVuZGVyKHIpKX1vbkNyZWF0ZU9yZGVyKGUsdCxpKXt2YXIgbjtyZXR1cm4gVWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e29uVmFsaWRhdGU6b309aTt5aWVsZCBvKCgpPT4odGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCEwKSwoKT0+UHJvbWlzZS5yZXNvbHZlKCkpLHIpO2NvbnN0IGE9eWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5jcmVhdGVPcmRlcihcInBheXBhbGNvbW1lcmNlYWx0ZXJuYXRpdmVtZXRob2RzY2hlY2tvdXRcIik7aWYodGhpcy5pc05vbkluc3RhbnRQYXltZW50TWV0aG9kKGUpJiYoZT09PUMuSURFQUwmJiF0aGlzLmlzT3JkZXJBcHByb3ZlZFByb2Nlc3Npbmd8fGU9PT1DLk9YWE8pKXtjb25zdCBpPXt1c2VTdG9yZUNyZWRpdDohMX0sbz17cGFyYW1zOnttZXRob2RJZDplLGdhdGV3YXlJZDp0fX07aWYoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKGksbyksZT09PUMuSURFQUwpe2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksaT1udWxsPT09KG49dC5nZXRPcmRlcigpKXx8dm9pZCAwPT09bj92b2lkIDA6bi5vcmRlcklkO3lpZWxkIHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlT3JkZXIoXCJwYXlwYWxjb21tZXJjZWFsdGVybmF0aXZlbWV0aG9kc2NoZWNrb3V0XCIsZSxpKX15aWVsZCB0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoZSxhLHQpfXJldHVybiBhfSl9aGFuZGxlQXBwcm92ZSh7b3JkZXJJRDplfSx0KXt0aGlzLm9yZGVySWQ9ZSx0KCl9aGFuZGxlRmFpbHVyZShlLHQpe3RoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdCYmdChlKX1yZW5kZXJGaWVsZHMoZSx0KXtjb25zdCBpPXRoaXMuZ2V0UGF5cGFsQW1wc1Nka09yVGhyb3coKSxuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHtmaXJzdE5hbWU6byxsYXN0TmFtZTphLGVtYWlsOnJ9PW4uZ2V0QmlsbGluZ0FkZHJlc3NPclRocm93KCkse2FwbUZpZWxkc0NvbnRhaW5lcjpzLGFwbUZpZWxkc1N0eWxlczpkfT10O2lmKCFzKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLnBheXBhbGNvbW1lcmNlYWx0ZXJuYXRpdmVtZXRob2RzXCIgYXJndW1lbnQgc2hvdWxkIGNvbnRhaW4gXCJhcG1GaWVsZHNDb250YWluZXJcIi4nKTtjb25zdCBsPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Iocyk7bCYmKGwuaW5uZXJIVE1MPVwiXCIpO2NvbnN0IGM9e2Z1bmRpbmdTb3VyY2U6ZSxzdHlsZTpkfHx7fSxmaWVsZHM6e25hbWU6e3ZhbHVlOmAke299ICR7YX1gfSxlbWFpbDp7dmFsdWU6cn19fTtpLlBheW1lbnRGaWVsZHMoYykucmVuZGVyKHMpfXRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoZSl7ZSYmdGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyP3RoaXMubG9hZGluZ0luZGljYXRvci5zaG93KHRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcik6dGhpcy5sb2FkaW5nSW5kaWNhdG9yLmhpZGUoKX1pc05vbkluc3RhbnRQYXltZW50TWV0aG9kKGUpe3JldHVybiBlLnRvVXBwZXJDYXNlKClpbiBDfWdldFBheXBhbEFtcHNTZGtPclRocm93KCl7aWYoIXRoaXMucGF5cGFsQXBtcyl0aHJvdyBuZXcgaDtyZXR1cm4gdGhpcy5wYXlwYWxBcG1zfX1jb25zdCBSZT1wKGU9Pm5ldyBWZShlLG9lKGUpLFEoKSxuZXcgU2Uoe2NvbnRhaW5lclN0eWxlczpJZX0pKSxbe2dhdGV3YXk6XCJwYXlwYWxjb21tZXJjZWFsdGVybmF0aXZlbWV0aG9kc1wifV0pO3ZhciBMZTshZnVuY3Rpb24oZSl7ZS5DVlY9XCJjdnZcIixlLlBBTj1cInBhblwifShMZXx8KExlPXt9KSk7Y2xhc3MgJGV7c3RhdGljIGdldChlKXtjb25zdCB0PWAke2VuY29kZVVSSUNvbXBvbmVudChgJHtlfWApfT1gLGk9ZG9jdW1lbnQuY29va2llO2xldCBuPW51bGw7Y29uc3Qgbz1pLmluZGV4T2YodCk7aWYobz4tMSl7bGV0IGU9aS5pbmRleE9mKFwiO1wiLG8pOy0xPT09ZSYmKGU9aS5sZW5ndGgpLG49ZGVjb2RlVVJJQ29tcG9uZW50KGkuc3Vic3RyaW5nKG8rdC5sZW5ndGgsZSkpfXJldHVybiBufXN0YXRpYyBzZXQoZSx0LGk9e3NlY3VyZTohMH0pe2xldCBuPWAke2VuY29kZVVSSUNvbXBvbmVudChlKX09JHtlbmNvZGVVUklDb21wb25lbnQodCl9YDtjb25zdHtleHBpcmVzOm8scGF0aDphLGRvbWFpbjpyLHNlY3VyZTpzfT1pO2lmKG8pbis9YDsgZXhwaXJlcz0ke28udG9VVENTdHJpbmcoKX1gO2Vsc2V7Y29uc3QgZT1uZXcgRGF0ZSx0PTYwO2Uuc2V0VGltZShlLmdldFRpbWUoKSs2MCp0KjFlMyksbis9YDsgZXhwaXJlcz0ke2UudG9VVENTdHJpbmcoKX1gfWEmJihuKz1gOyBwYXRoPSR7YX1gKSxyJiYobis9YDsgZG9tYWluPSR7cn1gKSxzJiYobis9XCI7IHNlY3VyZVwiKSxkb2N1bWVudC5jb29raWU9bn1zdGF0aWMgcmVtb3ZlKGUsdCl7JGUuc2V0KGUsXCJcIixPYmplY3QuYXNzaWduKHtleHBpcmVzOm5ldyBEYXRlKDApfSx0KSl9fXZhciBxZSxHZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihvLGEpe2Z1bmN0aW9uIHIoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP28oZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihyLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBIZXtjb25zdHJ1Y3Rvcigpe3RoaXMud2luZG93PXdpbmRvd31pbml0aWFsaXplUGF5UGFsRmFzdGxhbmUoZSx0LGkpe3JldHVybiBHZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYodCYmKHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImZhc3RsYW5lRW52XCIsXCJzYW5kYm94XCIpLHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImF4b0VudlwiLFwic2FuZGJveFwiKSksIXRoaXMud2luZG93LnBheXBhbEZhc3RsYW5lKXtjb25zdCB0PXtyb290OntiYWNrZ3JvdW5kQ29sb3JQcmltYXJ5OlwidHJhbnNwYXJlbnRcIn19O3RoaXMud2luZG93LnBheXBhbEZhc3RsYW5lPXlpZWxkIGUuRmFzdGxhbmUoe3N0eWxlczppfHx0fSl9cmV0dXJuIHRoaXMud2luZG93LnBheXBhbEZhc3RsYW5lfSl9Z2V0UGF5UGFsRmFzdGxhbmVPclRocm93KCl7aWYoIXRoaXMud2luZG93LnBheXBhbEZhc3RsYW5lKXRocm93IG5ldyBoO3JldHVybiB0aGlzLndpbmRvdy5wYXlwYWxGYXN0bGFuZX1sb29rdXBDdXN0b21lck9yVGhyb3coZSl7cmV0dXJuIEdlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5nZXRQYXlQYWxGYXN0bGFuZU9yVGhyb3coKS5pZGVudGl0eS5sb29rdXBDdXN0b21lckJ5RW1haWwoZSl9KX10cmlnZ2VyQXV0aGVudGljYXRpb25GbG93T3JUaHJvdyhlKXtyZXR1cm4gR2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiBlP3RoaXMuZ2V0UGF5UGFsRmFzdGxhbmVPclRocm93KCkuaWRlbnRpdHkudHJpZ2dlckF1dGhlbnRpY2F0aW9uRmxvdyhlKTp7fX0pfXVwZGF0ZVN0b3JhZ2VTZXNzaW9uSWQoZSl7Y29uc3QgdD1uZXcgRGF0ZTt0LnNldERhdGUodC5nZXREYXRlKCkrMTQpO2NvbnN0IGk9e2V4cGlyZXM6dCxzZWN1cmU6ITB9OyRlLnNldChcImJjLWZhc3RsYW5lLXNlc3Npb25JZFwiLGUsaSl9cmVtb3ZlU3RvcmFnZVNlc3Npb25JZCgpeyRlLnJlbW92ZShcImJjLWZhc3RsYW5lLXNlc3Npb25JZFwiKX1nZXRTdG9yYWdlU2Vzc2lvbklkKCl7cmV0dXJuICRlLmdldChcImJjLWZhc3RsYW5lLXNlc3Npb25JZFwiKXx8XCJcIn1tYXBQYXlQYWxGYXN0bGFuZVByb2ZpbGVUb0JjQ3VzdG9tZXJEYXRhKGUsdCl7dmFyIGksbixvO2NvbnN0e2F1dGhlbnRpY2F0aW9uU3RhdGU6YSxwcm9maWxlRGF0YTpyfT10LHM9bnVsbD09PShvPW51bGw9PT0obj1udWxsPT09KGk9bnVsbD09cj92b2lkIDA6ci5jYXJkKXx8dm9pZCAwPT09aT92b2lkIDA6aS5wYXltZW50U291cmNlKXx8dm9pZCAwPT09bj92b2lkIDA6bi5jYXJkKXx8dm9pZCAwPT09bz92b2lkIDA6by5iaWxsaW5nQWRkcmVzcyxkPW51bGw9PXI/dm9pZCAwOnIuc2hpcHBpbmdBZGRyZXNzLGw9bnVsbD09cj92b2lkIDA6ci5uYW1lLGM9bnVsbD09cj92b2lkIDA6ci5jYXJkLHA9ZD90aGlzLm1hcFBheVBhbFRvQmNBZGRyZXNzKGQuYWRkcmVzcyxkLm5hbWUsZC5waG9uZU51bWJlcik6dm9pZCAwLHU9cyYmbD90aGlzLm1hcFBheVBhbFRvQmNBZGRyZXNzKHMsbCxudWxsPT1kP3ZvaWQgMDpkLnBob25lTnVtYmVyKTp2b2lkIDAsaD1jP3RoaXMubWFwUGF5UGFsVG9CY0luc3RydW1lbnQoZSxjKTpbXSx5PXRoaXMuZmlsdGVyQWRkcmVzc2VzKFtwLHVdKTtyZXR1cm57YXV0aGVudGljYXRpb25TdGF0ZTphfHxXLlVOUkVDT0dOSVpFRCxhZGRyZXNzZXM6eSxiaWxsaW5nQWRkcmVzczp1LHNoaXBwaW5nQWRkcmVzczpwLGluc3RydW1lbnRzOmh9fW1hcFBheVBhbFRvQmNJbnN0cnVtZW50KGUsdCl7Y29uc3R7aWQ6aSxwYXltZW50U291cmNlOm59PXQse2JyYW5kOm8sZXhwaXJ5OmEsbGFzdERpZ2l0czpyfT1uLmNhcmQsW3MsZF09YS5zcGxpdChcIi1cIik7cmV0dXJuW3tiaWdwYXlUb2tlbjppLGJyYW5kOm8sZGVmYXVsdEluc3RydW1lbnQ6ITEsZXhwaXJ5TW9udGg6ZCxleHBpcnlZZWFyOnMsaWluOlwiXCIsbGFzdDQ6cixtZXRob2Q6ZSxwcm92aWRlcjplLHRydXN0ZWRTaGlwcGluZ0FkZHJlc3M6ITEsdW50cnVzdGVkU2hpcHBpbmdDYXJkVmVyaWZpY2F0aW9uTW9kZTpMZS5QQU4sdHlwZTpcImNhcmRcIn1dfW1hcEJjVG9QYXlQYWxBZGRyZXNzKGUpe3JldHVybntjb21wYW55OihudWxsPT1lP3ZvaWQgMDplLmNvbXBhbnkpfHxcIlwiLGFkZHJlc3NMaW5lMToobnVsbD09ZT92b2lkIDA6ZS5hZGRyZXNzMSl8fFwiXCIsYWRkcmVzc0xpbmUyOihudWxsPT1lP3ZvaWQgMDplLmFkZHJlc3MyKXx8XCJcIixhZG1pbkFyZWExOihudWxsPT1lP3ZvaWQgMDplLnN0YXRlT3JQcm92aW5jZUNvZGUpfHwobnVsbD09ZT92b2lkIDA6ZS5zdGF0ZU9yUHJvdmluY2UpfHxcIlwiLGFkbWluQXJlYTI6KG51bGw9PWU/dm9pZCAwOmUuY2l0eSl8fFwiXCIscG9zdGFsQ29kZToobnVsbD09ZT92b2lkIDA6ZS5wb3N0YWxDb2RlKXx8XCJcIixjb3VudHJ5Q29kZToobnVsbD09ZT92b2lkIDA6ZS5jb3VudHJ5Q29kZSl8fFwiXCJ9fW1hcFBheVBhbFRvQmNBZGRyZXNzKGUsdCxpLG4pe2NvbnN0W28sYV09dC5mdWxsTmFtZS5zcGxpdChcIiBcIikscj0obnVsbD09aT92b2lkIDA6aS5uYXRpb25hbE51bWJlcil8fFwiXCIscz0obnVsbD09aT92b2lkIDA6aS5jb3VudHJ5Q29kZSl8fFwiXCI7cmV0dXJue2lkOkRhdGUubm93KCksdHlwZTpcInBheXBhbC1hZGRyZXNzXCIsZmlyc3ROYW1lOnQuZmlyc3ROYW1lfHxvfHxcIlwiLGxhc3ROYW1lOnQubGFzdE5hbWV8fGF8fFwiXCIsY29tcGFueTplLmNvbXBhbnl8fFwiXCIsYWRkcmVzczE6ZS5hZGRyZXNzTGluZTEsYWRkcmVzczI6ZS5hZGRyZXNzTGluZTJ8fFwiXCIsY2l0eTplLmFkbWluQXJlYTIsc3RhdGVPclByb3ZpbmNlOmUuYWRtaW5BcmVhMSxzdGF0ZU9yUHJvdmluY2VDb2RlOmUuYWRtaW5BcmVhMSxjb3VudHJ5OmUuY291bnRyeUNvZGV8fFwiXCIsY291bnRyeUNvZGU6ZS5jb3VudHJ5Q29kZXx8XCJcIixwb3N0YWxDb2RlOmUucG9zdGFsQ29kZSxwaG9uZTpzK3IsY3VzdG9tRmllbGRzOm58fFtdfX1maWx0ZXJBZGRyZXNzZXMoZSl7cmV0dXJuIGUucmVkdWNlKChlLHQpPT50P2Uuc29tZShlPT50aGlzLmlzRXF1YWxBZGRyZXNzZXMoZSx0KSk/ZTpbLi4uZSx0XTplLFtdKX1pc0VxdWFsQWRkcmVzc2VzKGUsdCl7cmV0dXJuIG8odGhpcy5ub3JtYWxpemVBZGRyZXNzKGUpLHRoaXMubm9ybWFsaXplQWRkcmVzcyh0KSl9bm9ybWFsaXplQWRkcmVzcyhlKXtyZXR1cm4gcyhlLFtcImlkXCIsXCJwaG9uZVwiXSl9fWZ1bmN0aW9uIFllKCl7cmV0dXJuIG5ldyBIZX0hZnVuY3Rpb24oZSl7ZS5DYXJkQ29kZT1cImNhcmRDb2RlXCIsZS5DYXJkQ29kZVZlcmlmaWNhdGlvbj1cImNhcmRDb2RlVmVyaWZpY2F0aW9uXCIsZS5DYXJkRXhwaXJ5PVwiY2FyZEV4cGlyeVwiLGUuQ2FyZE5hbWU9XCJjYXJkTmFtZVwiLGUuQ2FyZE51bWJlcj1cImNhcmROdW1iZXJcIixlLkNhcmROdW1iZXJWZXJpZmljYXRpb249XCJjYXJkTnVtYmVyVmVyaWZpY2F0aW9uXCIsZS5DYXJkRXhwaXJ5VmVyaWZpY2F0aW9uPVwiY2FyZEV4cGlyeVZlcmlmaWNhdGlvblwifShxZXx8KHFlPXt9KSk7Y29uc3QgV2U9cWU7ZnVuY3Rpb24gS2UoZSl7cmV0dXJuIFdlLkNhcmROdW1iZXIgaW4gZSYmV2UuQ2FyZE5hbWUgaW4gZSYmV2UuQ2FyZEV4cGlyeSBpbiBlfWZ1bmN0aW9uIFhlKGUpe3JldHVybiBXZS5DYXJkTnVtYmVyVmVyaWZpY2F0aW9uIGluIGUmJldlLkNhcmRDb2RlVmVyaWZpY2F0aW9uIGluIGUmJldlLkNhcmRFeHBpcnlWZXJpZmljYXRpb24gaW4gZX1jbGFzcyBKZSBleHRlbmRzIHV7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBjbGllbnQgbGlicmFyeSBvZiBhIHBheW1lbnQgbWV0aG9kIGhhcyB0aHJvd24gYW4gdW5leHBlY3RlZCBlcnJvci5cIiksdGhpcy5uYW1lPVwiUGF5bWVudE1ldGhvZEZhaWxlZEVycm9yXCIsdGhpcy50eXBlPVwicGF5bWVudF9tZXRob2RfY2xpZW50X2ludmFsaWRcIn19dmFyIFplOyFmdW5jdGlvbihlKXtlW2UuQ2hlY2tvdXRCdXR0b25Ob3RJbml0aWFsaXplZD0wXT1cIkNoZWNrb3V0QnV0dG9uTm90SW5pdGlhbGl6ZWRcIixlW2UuQ3VzdG9tZXJOb3RJbml0aWFsaXplZD0xXT1cIkN1c3RvbWVyTm90SW5pdGlhbGl6ZWRcIixlW2UuUGF5bWVudE5vdEluaXRpYWxpemVkPTJdPVwiUGF5bWVudE5vdEluaXRpYWxpemVkXCIsZVtlLlNoaXBwaW5nTm90SW5pdGlhbGl6ZWQ9M109XCJTaGlwcGluZ05vdEluaXRpYWxpemVkXCIsZVtlLlNwYW1Qcm90ZWN0aW9uTm90SW5pdGlhbGl6ZWQ9NF09XCJTcGFtUHJvdGVjdGlvbk5vdEluaXRpYWxpemVkXCJ9KFplfHwoWmU9e30pKTtjbGFzcyBRZSBleHRlbmRzIHV7Y29uc3RydWN0b3IoZSl7c3VwZXIoZnVuY3Rpb24oZSl7c3dpdGNoKGUpe2Nhc2UgWmUuQ3VzdG9tZXJOb3RJbml0aWFsaXplZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIGN1c3RvbWVyIHN0ZXAgb2YgY2hlY2tvdXQgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkLlwiO2Nhc2UgWmUuUGF5bWVudE5vdEluaXRpYWxpemVkOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgcGF5bWVudCBzdGVwIG9mIGNoZWNrb3V0IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIjtjYXNlIFplLlNoaXBwaW5nTm90SW5pdGlhbGl6ZWQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBzaGlwcGluZyBzdGVwIG9mIGNoZWNrb3V0IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIjtjYXNlIFplLlNwYW1Qcm90ZWN0aW9uTm90SW5pdGlhbGl6ZWQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBjaGVja291dCBzcGFtIHByb3RlY3Rpb24gaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkLlwiO2RlZmF1bHQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSByZXF1aXJlZCBjb21wb25lbnQgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkLlwifX0oZSkpLHRoaXMuc3VidHlwZT1lLHRoaXMubmFtZT1cIk5vdEluaXRpYWxpemVkRXJyb3JcIix0aGlzLnR5cGU9XCJub3RfaW5pdGlhbGl6ZWRcIn19Y2xhc3MgZXQgZXh0ZW5kcyB1e2NvbnN0cnVjdG9yKGUsdCl7c3VwZXIodHx8XCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBwYXltZW50IGZvcm0gY29udGFpbnMgaW52YWxpZCBkYXRhLlwiKSx0aGlzLmRldGFpbHM9ZSx0aGlzLm5hbWU9XCJQYXltZW50SW52YWxpZEZvcm1FcnJvclwiLHRoaXMudHlwZT1cInBheW1lbnRfaW52YWxpZF9mb3JtXCJ9fXZhciB0dD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihvLGEpe2Z1bmN0aW9uIHIoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP28oZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihyLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBpdHtjb25zdHJ1Y3RvcihlLHQsaSxuKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLnBheXBhbEludGVncmF0aW9uU2VydmljZT10LHRoaXMucGF5cGFsU2RrU2NyaXB0TG9hZGVyPWksdGhpcy5wYXlwYWxGYXN0bGFuZVV0aWxzPW59aW5pdGlhbGl6ZShlKXtyZXR1cm4gdHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e21ldGhvZElkOnQscGF5cGFsY29tbWVyY2VjcmVkaXRjYXJkczppLHBheXBhbGNvbW1lcmNlOm59PWUsbz1pfHxuLHtmb3JtOmEsb25DcmVkaXRDYXJkRmllbGRzUmVuZGVyaW5nRXJyb3I6cixvbkxvYWRDb21wbGV0ZTpzfT1vfHx7fTtpZighdCl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighYSl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBcIm9wdGlvbnMucGF5cGFsY29tbWVyY2VjcmVkaXRjYXJkcy5mb3JtXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3RoaXMuaG9zdGVkRm9ybU9wdGlvbnM9YSx0aGlzLmlzQ3JlZGl0Q2FyZEZvcm09S2UoYS5maWVsZHMpLHRoaXMuaXNDcmVkaXRDYXJkVmF1bHRlZEZvcm09WGUoYS5maWVsZHMpJiYhdGhpcy5oYXNVbmRlZmluZWRWYWx1ZXMoKSx5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QodCkseWllbGQgdGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheVBhbFNkayh0LHZvaWQgMCwhMCwhMCksKHRoaXMuaXNDcmVkaXRDYXJkRm9ybXx8dGhpcy5pc0NyZWRpdENhcmRWYXVsdGVkRm9ybSkmJih5aWVsZCB0aGlzLmluaXRpYWxpemVGaWVsZHMoYSxyKSksbnVsbD09c3x8cygpLHRoaXMuc2hvdWxkSW5pdGlhbGl6ZVBheVBhbEZhc3RsYW5lKHQpJiYoeWllbGQgdGhpcy5pbml0aWFsaXplUGF5UGFsRmFzdGxhbmVPclRocm93KHQpKX0pfWV4ZWN1dGUoZSx0KXtyZXR1cm4gdHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6aX09ZSxuPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgbz0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7bzxuLmxlbmd0aDtvKyspdC5pbmRleE9mKG5bb10pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bb10pJiYoaVtuW29dXT1lW25bb11dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKSx7bWV0aG9kSWQ6byxwYXltZW50RGF0YTphfT1pfHx7fTtpZighaXx8IW8pdGhyb3cgbmV3IHdlKFtcInBheW1lbnRcIl0pO2lmKHRoaXMuZXhlY3V0aW9uUGF5bWVudERhdGE9YSx0aGlzLmlzQ3JlZGl0Q2FyZEZvcm18fHRoaXMuaXNDcmVkaXRDYXJkVmF1bHRlZEZvcm0peWllbGQgdGhpcy52YWxpZGF0ZUhvc3RlZEZvcm1PclRocm93KCkseWllbGQgdGhpcy5zdWJtaXRIb3N0ZWRGb3JtKCk7ZWxzZXtjb25zdHtvcmRlcklkOmV9PXlpZWxkIHRoaXMucGF5cGFsSW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZU9yZGVyQ2FyZEZpZWxkcyhcInBheXBhbGNvbW1lcmNlY3JlZGl0Y2FyZHNjaGVja291dFwiLHRoaXMuZ2V0SW5zdHJ1bWVudFBhcmFtcygpKTt0aGlzLnJldHVybmVkT3JkZXJJZD1lfWNvbnN0IHI9dGhpcy5wcmVwYXJlUGF5bWVudFBheWxvYWQobyxhLHRoaXMucmV0dXJuZWRPcmRlcklkLHRoaXMucmV0dXJuZWRWYXVsdGVkVG9rZW4pO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihuLHQpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KHIpfSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFBlKX1kZWluaXRpYWxpemUoKXt2YXIgZSx0LGksbjtyZXR1cm4gdHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB5aWVsZCBudWxsPT09KGU9dGhpcy5jdnZGaWVsZCl8fHZvaWQgMD09PWU/dm9pZCAwOmUuY2xvc2UoKSx5aWVsZCBudWxsPT09KHQ9dGhpcy5leHBpcnlGaWVsZCl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuY2xvc2UoKSx5aWVsZCBudWxsPT09KGk9dGhpcy5udW1iZXJGaWVsZCl8fHZvaWQgMD09PWk/dm9pZCAwOmkuY2xvc2UoKSx5aWVsZCBudWxsPT09KG49dGhpcy5uYW1lRmllbGQpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmNsb3NlKCksUHJvbWlzZS5yZXNvbHZlKCl9KX1wcmVwYXJlUGF5bWVudFBheWxvYWQoZSx0LGksbil7Y29uc3R7c2hvdWxkU2F2ZUluc3RydW1lbnQ6bz0hMSxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OnI9ITF9PUNlKHQpP3Q6e30scz10JiZPZSh0KT90Lmluc3RydW1lbnRJZDp2b2lkIDAsbD1kKHt2ZXJpZmljYXRpb25fbm9uY2U6bix0b2tlbjpzfSxhKTtyZXR1cm57bWV0aG9kSWQ6ZSxwYXltZW50RGF0YTp7c2hvdWxkU2F2ZUluc3RydW1lbnQ6byxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OnIsaW5zdHJ1bWVudElkOnMsZm9ybWF0dGVkUGF5bG9hZDpPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sbnx8cz97YmlncGF5X3Rva2VuOmx9Ont9KSxpP3tjYXJkX3dpdGhfb3JkZXI6e29yZGVyX2lkOml9fTp7fSl9fX1pbml0aWFsaXplRmllbGRzKGUsdCl7cmV0dXJuIHR0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtmaWVsZHM6aSxzdHlsZXM6bn09ZSxvPXRoaXMucGF5cGFsSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheVBhbFNka09yVGhyb3coKSxhPXRoaXMuZ2V0RXhlY3V0ZUNhbGxiYWNrKGkpLHI9T2JqZWN0LmFzc2lnbih7c3R5bGU6dGhpcy5nZXRJbnB1dFN0eWxlcyhuKSxvbkFwcHJvdmU6KHtvcmRlcklEOmUsdmF1bHRTZXR1cFRva2VuOnQsbGlhYmlsaXR5U2hpZnQ6aX0pPT57aWYoaT09PVMuTm98fGk9PT1TLlVua25vd24pdGhyb3cgbmV3IEVycm9yO3JldHVybiB0aGlzLmhhbmRsZUFwcHJvdmUoe29yZGVySUQ6ZSx2YXVsdFNldHVwVG9rZW46dH0pfSxvbkVycm9yOigpPT57dGhyb3cgbmV3IEplfSxpbnB1dEV2ZW50czp7b25DaGFuZ2U6dD0+dGhpcy5vbkNoYW5nZUhhbmRsZXIoZSx0KSxvbkZvY3VzOnQ9PnRoaXMub25Gb2N1c0hhbmRsZXIoZSx0KSxvbkJsdXI6dD0+dGhpcy5vbkJsdXJIYW5kbGVyKGUsdCksb25JbnB1dFN1Ym1pdFJlcXVlc3Q6dD0+dGhpcy5vbklucHV0U3VibWl0UmVxdWVzdChlLHQpfX0sYSk7aWYodGhpcy5jYXJkRmllbGRzPXlpZWxkIG8uQ2FyZEZpZWxkcyhyKSwhdGhpcy5jYXJkRmllbGRzLmlzRWxpZ2libGUoKSl0aHJvdyBuZXcgUWUoWmUuUGF5bWVudE5vdEluaXRpYWxpemVkKTt0cnl7dGhpcy5zdHlsaXplSW5wdXRDb250YWluZXJzKGkpLEtlKGkpJiYoeWllbGQgdGhpcy5yZW5kZXJGaWVsZHMoaSkpLFhlKGkpJiYoeWllbGQgdGhpcy5yZW5kZXJWYXVsdGVkRmllbGRzKGkpKX1jYXRjaChlKXtcImZ1bmN0aW9uXCI9PXR5cGVvZiB0JiZ0KGUpfX0pfWdldEV4ZWN1dGVDYWxsYmFjayhlKXtyZXR1cm4gWGUoZSk/dGhpcy5jcmVhdGVWYXVsdFNldHVwVG9rZW5DYWxsYmFjaygpOnRoaXMuY3JlYXRlT3JkZXJDYWxsYmFjaygpfWNyZWF0ZVZhdWx0U2V0dXBUb2tlbkNhbGxiYWNrKCl7cmV0dXJue2NyZWF0ZVZhdWx0U2V0dXBUb2tlbjooKT0+dHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3NldHVwVG9rZW46ZX09KHlpZWxkIHRoaXMucGF5cGFsSW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZU9yZGVyQ2FyZEZpZWxkcyhcInBheXBhbGNvbW1lcmNlY3JlZGl0Y2FyZHNjaGVja291dFwiLE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0aGlzLmdldEluc3RydW1lbnRQYXJhbXMoKSkse3NldHVwVG9rZW46ITB9KSkpfHx7fTtyZXR1cm4gZX0pfX1jcmVhdGVPcmRlckNhbGxiYWNrKCl7cmV0dXJue2NyZWF0ZU9yZGVyOigpPT50dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7b3JkZXJJZDplfT0oeWllbGQgdGhpcy5wYXlwYWxJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlT3JkZXJDYXJkRmllbGRzKFwicGF5cGFsY29tbWVyY2VjcmVkaXRjYXJkc2NoZWNrb3V0XCIsdGhpcy5nZXRJbnN0cnVtZW50UGFyYW1zKCkpKXx8e307cmV0dXJuIGV9KX19aGFuZGxlQXBwcm92ZSh7b3JkZXJJRDplLHZhdWx0U2V0dXBUb2tlbjp0fSl7ZSYmKHRoaXMucmV0dXJuZWRPcmRlcklkPWUpLHQmJih0aGlzLnJldHVybmVkVmF1bHRlZFRva2VuPXQpfXJlbmRlckZpZWxkcyhlKXt2YXIgdCxpLG4sbztyZXR1cm4gdHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGE9dGhpcy5nZXRDYXJkRmllbGRzT3JUaHJvdygpOyhudWxsPT09KHQ9ZS5jYXJkQ29kZSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuY29udGFpbmVySWQpJiYodGhpcy5jdnZGaWVsZD1hLkNWVkZpZWxkKHtwbGFjZWhvbGRlcjpcIlwifSkseWllbGQgdGhpcy5jdnZGaWVsZC5yZW5kZXIoYCMke2UuY2FyZENvZGUuY29udGFpbmVySWR9YCkpLChudWxsPT09KGk9ZS5jYXJkRXhwaXJ5KXx8dm9pZCAwPT09aT92b2lkIDA6aS5jb250YWluZXJJZCkmJih0aGlzLmV4cGlyeUZpZWxkPWEuRXhwaXJ5RmllbGQoKSx5aWVsZCB0aGlzLmV4cGlyeUZpZWxkLnJlbmRlcihgIyR7ZS5jYXJkRXhwaXJ5LmNvbnRhaW5lcklkfWApKSwobnVsbD09PShuPWUuY2FyZE5hbWUpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmNvbnRhaW5lcklkKSYmKHRoaXMubmFtZUZpZWxkPWEuTmFtZUZpZWxkKHtwbGFjZWhvbGRlcjpcIlwifSkseWllbGQgdGhpcy5uYW1lRmllbGQucmVuZGVyKGAjJHtlLmNhcmROYW1lLmNvbnRhaW5lcklkfWApKSwobnVsbD09PShvPWUuY2FyZE51bWJlcil8fHZvaWQgMD09PW8/dm9pZCAwOm8uY29udGFpbmVySWQpJiYodGhpcy5udW1iZXJGaWVsZD1hLk51bWJlckZpZWxkKHtwbGFjZWhvbGRlcjpcIlwifSkseWllbGQgdGhpcy5udW1iZXJGaWVsZC5yZW5kZXIoYCMke2UuY2FyZE51bWJlci5jb250YWluZXJJZH1gKSl9KX1yZW5kZXJWYXVsdGVkRmllbGRzKGUpe3ZhciB0LGksbjtyZXR1cm4gdHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IG89dGhpcy5nZXRDYXJkRmllbGRzT3JUaHJvdygpOyhudWxsPT09KHQ9ZS5jYXJkQ29kZVZlcmlmaWNhdGlvbil8fHZvaWQgMD09PXQ/dm9pZCAwOnQuY29udGFpbmVySWQpJiYodGhpcy5jdnZGaWVsZD1vLkNWVkZpZWxkKHtwbGFjZWhvbGRlcjpcIlwifSkseWllbGQgdGhpcy5jdnZGaWVsZC5yZW5kZXIoYCMke2UuY2FyZENvZGVWZXJpZmljYXRpb24uY29udGFpbmVySWR9YCkpLChudWxsPT09KGk9ZS5jYXJkRXhwaXJ5VmVyaWZpY2F0aW9uKXx8dm9pZCAwPT09aT92b2lkIDA6aS5jb250YWluZXJJZCkmJih0aGlzLmV4cGlyeUZpZWxkPW8uRXhwaXJ5RmllbGQoKSx5aWVsZCB0aGlzLmV4cGlyeUZpZWxkLnJlbmRlcihgIyR7ZS5jYXJkRXhwaXJ5VmVyaWZpY2F0aW9uLmNvbnRhaW5lcklkfWApKSwobnVsbD09PShuPWUuY2FyZE51bWJlclZlcmlmaWNhdGlvbil8fHZvaWQgMD09PW4/dm9pZCAwOm4uY29udGFpbmVySWQpJiYodGhpcy5udW1iZXJGaWVsZD1vLk51bWJlckZpZWxkKHtwbGFjZWhvbGRlcjpcIlwifSkseWllbGQgdGhpcy5udW1iZXJGaWVsZC5yZW5kZXIoYCMke2UuY2FyZE51bWJlclZlcmlmaWNhdGlvbi5jb250YWluZXJJZH1gKSl9KX1nZXRJbnN0cnVtZW50UGFyYW1zKCl7aWYoIXRoaXMuZXhlY3V0aW9uUGF5bWVudERhdGEpcmV0dXJue307aWYoQ2UodGhpcy5leGVjdXRpb25QYXltZW50RGF0YSkpe2NvbnN0e3Nob3VsZFNhdmVJbnN0cnVtZW50OmUsc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDp0fT10aGlzLmV4ZWN1dGlvblBheW1lbnREYXRhO3JldHVybntzaG91bGRTYXZlSW5zdHJ1bWVudDplLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6dH19aWYoT2UodGhpcy5leGVjdXRpb25QYXltZW50RGF0YSkpe2NvbnN0e2luc3RydW1lbnRJZDplfT10aGlzLmV4ZWN1dGlvblBheW1lbnREYXRhO3JldHVybntpbnN0cnVtZW50SWQ6ZX19cmV0dXJue319Z2V0RmllbGRUeXBlQnlFbWl0dGVkRmllbGQoe2VtaXR0ZWRCeTplfSl7cmV0dXJue2ZpZWxkVHlwZTp0aGlzLm1hcEZpZWxkVHlwZShlKX19c3VibWl0SG9zdGVkRm9ybSgpe3JldHVybiB0dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgZT10aGlzLmdldENhcmRGaWVsZHNPclRocm93KCksdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRCaWxsaW5nQWRkcmVzc09yVGhyb3coKSxpPXtiaWxsaW5nQWRkcmVzczp7Y29tcGFueTp0LmNvbXBhbnksYWRkcmVzc0xpbmUxOnQuYWRkcmVzczEsYWRkcmVzc0xpbmUyOnQuYWRkcmVzczIsYWRtaW5BcmVhMTp0LnN0YXRlT3JQcm92aW5jZUNvZGUsYWRtaW5BcmVhMjp0LmNpdHkscG9zdGFsQ29kZTp0LnBvc3RhbENvZGUsY291bnRyeUNvZGU6dC5jb3VudHJ5Q29kZX19O3RyeXt0aGlzLmlzQ3JlZGl0Q2FyZFZhdWx0ZWRGb3JtP3lpZWxkIGUuc3VibWl0KCk6eWllbGQgZS5zdWJtaXQoaSl9Y2F0Y2goZSl7dGhyb3cgbmV3IEplKFwiRmFpbGVkIGF1dGhlbnRpY2F0aW9uLiBQbGVhc2UgdHJ5IHRvIGF1dGhvcml6ZSBhZ2Fpbi5cIil9fSl9dmFsaWRhdGVIb3N0ZWRGb3JtT3JUaHJvdygpe3ZhciBlLHQ7cmV0dXJuIHR0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPXRoaXMuZ2V0Q2FyZEZpZWxkc09yVGhyb3coKSxuPXlpZWxkIGkuZ2V0U3RhdGUoKS50aGVuKGU9PmUpLG89dGhpcy5nZXRWYWxpZGl0eURhdGEobik7aWYoIW8uaXNWYWxpZCl0aHJvdyBudWxsPT09KHQ9bnVsbD09PShlPXRoaXMuaG9zdGVkRm9ybU9wdGlvbnMpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLm9uVmFsaWRhdGUpfHx2b2lkIDA9PT10fHx0LmNhbGwoZSxvKSxuZXcgZXQodGhpcy5tYXBWYWxpZGF0aW9uRXJyb3JzKG8uZXJyb3JzKSl9KX1nZXRWYWxpZGl0eURhdGEoe2ZpZWxkczplfSl7Y29uc3QgdD1PYmplY3QuYXNzaWduKHt9LGUpO2RlbGV0ZSB0LmNhcmROYW1lRmllbGQ7Y29uc3QgaT1PYmplY3Qua2V5cyh0KTtyZXR1cm57aXNWYWxpZDppLmV2ZXJ5KGU9Pnt2YXIgaTtyZXR1cm4gbnVsbD09PShpPXRbZV0pfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmlzVmFsaWR9KSxlcnJvcnM6aS5yZWR1Y2UoKGUsaSk9Pnt2YXIgbjtjb25zdCBvPXRoaXMubWFwRmllbGRUeXBlKGkpO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse1tvXToobnVsbD09PShuPXRbaV0pfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmlzVmFsaWQpP3ZvaWQgMDpbdGhpcy5nZXRJbnZhbGlkRXJyb3JCeUZpZWxkVHlwZShvKV19KX0se30pfX1nZXRJbnZhbGlkRXJyb3JCeUZpZWxkVHlwZShlKXtzd2l0Y2goZSl7Y2FzZSBXZS5DYXJkQ29kZTpjYXNlIFdlLkNhcmRDb2RlVmVyaWZpY2F0aW9uOnJldHVybntmaWVsZFR5cGU6ZSxtZXNzYWdlOlwiSW52YWxpZCBjYXJkIGNvZGVcIix0eXBlOlwiaW52YWxpZF9jYXJkX2NvZGVcIn07Y2FzZSBXZS5DYXJkTnVtYmVyOmNhc2UgV2UuQ2FyZE51bWJlclZlcmlmaWNhdGlvbjpyZXR1cm57ZmllbGRUeXBlOmUsbWVzc2FnZTpcIkludmFsaWQgY2FyZCBudW1iZXJcIix0eXBlOlwiaW52YWxpZF9jYXJkX251bWJlclwifTtjYXNlIFdlLkNhcmRFeHBpcnk6Y2FzZSBXZS5DYXJkRXhwaXJ5VmVyaWZpY2F0aW9uOnJldHVybntmaWVsZFR5cGU6ZSxtZXNzYWdlOlwiSW52YWxpZCBjYXJkIGV4cGlyeVwiLHR5cGU6XCJpbnZhbGlkX2NhcmRfZXhwaXJ5XCJ9O2RlZmF1bHQ6cmV0dXJue2ZpZWxkVHlwZTplLG1lc3NhZ2U6XCJJbnZhbGlkIGZpZWxkXCIsdHlwZTpcImludmFsaWRcIn19fW1hcFZhbGlkYXRpb25FcnJvcnMoZT17fSl7Y29uc3QgdD17fTtyZXR1cm4gT2JqZWN0LmtleXMoZSkuZm9yRWFjaChpPT57dmFyIG4sbzt0W2ldPVt7bWVzc2FnZToobnVsbD09PShvPW51bGw9PT0obj1lW2ldKXx8dm9pZCAwPT09bj92b2lkIDA6blswXSl8fHZvaWQgMD09PW8/dm9pZCAwOm8ubWVzc2FnZSl8fFwiXCIsdHlwZTppfV19KSx0fW1hcEZpZWxkVHlwZShlKXtzd2l0Y2goZSl7Y2FzZVwibmFtZVwiOnJldHVybiBXZS5DYXJkTmFtZTtjYXNlXCJjYXJkTnVtYmVyRmllbGRcIjpjYXNlXCJudW1iZXJcIjpyZXR1cm4gdGhpcy5pc0NyZWRpdENhcmRGb3JtP1dlLkNhcmROdW1iZXI6V2UuQ2FyZE51bWJlclZlcmlmaWNhdGlvbjtjYXNlXCJjYXJkRXhwaXJ5RmllbGRcIjpjYXNlXCJleHBpcnlcIjpyZXR1cm4gdGhpcy5pc0NyZWRpdENhcmRGb3JtP1dlLkNhcmRFeHBpcnk6V2UuQ2FyZEV4cGlyeVZlcmlmaWNhdGlvbjtjYXNlXCJjYXJkQ3Z2RmllbGRcIjpjYXNlXCJjdnZcIjpyZXR1cm4gdGhpcy5pc0NyZWRpdENhcmRGb3JtP1dlLkNhcmRDb2RlOldlLkNhcmRDb2RlVmVyaWZpY2F0aW9uO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCBmaWVsZCB0eXBlXCIpfX1nZXRDYXJkRmllbGRzT3JUaHJvdygpe2lmKCF0aGlzLmNhcmRGaWVsZHMpdGhyb3cgbmV3IFFlKFplLlBheW1lbnROb3RJbml0aWFsaXplZCk7cmV0dXJuIHRoaXMuY2FyZEZpZWxkc31nZXRJbnB1dFN0eWxlcyhlKXt2YXIgdCxpLG47Y29uc3Qgbz17XCJmb250LXNpemVcIjoobnVsbD09PSh0PW51bGw9PWU/dm9pZCAwOmUuZGVmYXVsdCl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuZm9udFNpemUpfHxcIjFyZW1cIixcImZvbnQtZmFtaWx5XCI6KG51bGw9PT0oaT1udWxsPT1lP3ZvaWQgMDplLmRlZmF1bHQpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmZvbnRGYW1pbHkpfHxcIk1vbnRzZXJyYXQsIEFyaWFsLCBIZWx2ZXRpY2EsIHNhbnMtc2VyaWZcIixcImZvbnQtd2VpZ2h0XCI6KG51bGw9PT0obj1udWxsPT1lP3ZvaWQgMDplLmRlZmF1bHQpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmZvbnRXZWlnaHQpfHxcIjQwMFwiLG91dGxpbmU6XCJub25lXCIscGFkZGluZzpcIjlweCAxM3B4XCJ9LGE9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LG8pLHtjb2xvcjpcIiMzMzMzMzNcIn0pO3JldHVybntpbnB1dDphLFwiLmludmFsaWRcIjpPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sbykse2NvbG9yOlwicmVkXCJ9KSxcIi52YWxpZFwiOmEsXCI6Zm9jdXNcIjphfX1zdHlsaXplSW5wdXRDb250YWluZXJzKGUpe09iamVjdC52YWx1ZXMoZXx8e30pLmZvckVhY2goZT0+e2NvbnN0IHQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYCR7KG51bGw9PWU/dm9pZCAwOmUuY29udGFpbmVySWQpfHxcIlwifWApO3QmJih0LnN0eWxlLnBhZGRpbmc9XCIwcHhcIix0LnN0eWxlLmJveFNoYWRvdz1cIm5vbmVcIix0LnN0eWxlLmJvcmRlcj1cIm5vbmVcIix0LnN0eWxlLmJhY2tncm91bmQ9XCJ0cmFuc3BhcmVudFwiLHQuc3R5bGUubWFyZ2luQm90dG9tPVwiMTBweFwiLHQuc3R5bGUubWFyZ2luTGVmdD1cIi01cHhcIil9KX1oYXNVbmRlZmluZWRWYWx1ZXMoKXtyZXR1cm4hdGhpcy5ob3N0ZWRGb3JtT3B0aW9uc3x8T2JqZWN0LnZhbHVlcyh0aGlzLmhvc3RlZEZvcm1PcHRpb25zLmZpZWxkcykuc29tZShlPT52b2lkIDA9PT1lKX1vbkNoYW5nZUhhbmRsZXIoZSx0KXt2YXIgaTtudWxsPT09KGk9bnVsbD09ZT92b2lkIDA6ZS5vblZhbGlkYXRlKXx8dm9pZCAwPT09aXx8aS5jYWxsKGUsdGhpcy5nZXRWYWxpZGl0eURhdGEodCkpfW9uRm9jdXNIYW5kbGVyKGUsdCl7dmFyIGk7bnVsbD09PShpPW51bGw9PWU/dm9pZCAwOmUub25Gb2N1cyl8fHZvaWQgMD09PWl8fGkuY2FsbChlLHRoaXMuZ2V0RmllbGRUeXBlQnlFbWl0dGVkRmllbGQodCkpfW9uQmx1ckhhbmRsZXIoZSx0KXt2YXIgaTtudWxsPT09KGk9bnVsbD09ZT92b2lkIDA6ZS5vbkJsdXIpfHx2b2lkIDA9PT1pfHxpLmNhbGwoZSx0aGlzLmdldEZpZWxkVHlwZUJ5RW1pdHRlZEZpZWxkKHQpKX1vbklucHV0U3VibWl0UmVxdWVzdChlLHQpe3ZhciBpO251bGw9PT0oaT1udWxsPT1lP3ZvaWQgMDplLm9uRW50ZXIpfHx2b2lkIDA9PT1pfHxpLmNhbGwoZSx0aGlzLmdldEZpZWxkVHlwZUJ5RW1pdHRlZEZpZWxkKHQpKX1zaG91bGRJbml0aWFsaXplUGF5UGFsRmFzdGxhbmUoZSl7dmFyIHQsaTtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG89bi5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKSxhPW4uZ2V0UGF5bWVudFByb3ZpZGVyQ3VzdG9tZXIoKSxyPShzPWEpJiYoXCJhdXRoZW50aWNhdGlvblN0YXRlXCJpbiBzfHxcImFkZHJlc3Nlc1wiaW4gc3x8XCJpbnN0cnVtZW50c1wiaW4gcyk/YTp7fTt2YXIgcztyZXR1cm4obnVsbD09PSh0PW51bGw9PW8/dm9pZCAwOm8uaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09dD92b2lkIDA6dC5pc0FjY2VsZXJhdGVkQ2hlY2tvdXRFbmFibGVkKSYmKG51bGw9PT0oaT1udWxsPT1vP3ZvaWQgMDpvLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PWk/dm9pZCAwOmkuaXNQYXlQYWxDb21tZXJjZUFuYWx5dGljc1YyRW5hYmxlZCkmJiEobnVsbD09cj92b2lkIDA6ci5hdXRoZW50aWNhdGlvblN0YXRlKX1pbml0aWFsaXplUGF5UGFsRmFzdGxhbmVPclRocm93KGUpe3JldHVybiB0dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksaT10LmdldENhcnRPclRocm93KCksbj10LmdldFBheW1lbnRNZXRob2RPclRocm93KGUpLHtpbml0aWFsaXphdGlvbkRhdGE6b309bjtpZighKG51bGw9PW8/dm9pZCAwOm8uY29ubmVjdENsaWVudFRva2VuKSlyZXR1cm47Y29uc3QgYT15aWVsZCB0aGlzLnBheXBhbFNka1NjcmlwdExvYWRlci5nZXRQYXlQYWxGYXN0bGFuZVNkayhuLGkuY3VycmVuY3kuY29kZSxpLmlkKTt5aWVsZCB0aGlzLnBheXBhbEZhc3RsYW5lVXRpbHMuaW5pdGlhbGl6ZVBheVBhbEZhc3RsYW5lKGEsISEobnVsbD09bz92b2lkIDA6by5pc0RldmVsb3Blck1vZGVBcHBsaWNhYmxlKSl9Y2F0Y2goZSl7fX0pfX1jb25zdCBudD1wKGU9Pm5ldyBpdChlLG9lKGUpLFEoKSxZZSgpKSxbe2lkOlwicGF5cGFsY29tbWVyY2VjcmVkaXRjYXJkc1wifV0pO3ZhciBvdD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihvLGEpe2Z1bmN0aW9uIHIoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP28oZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihyLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBhdHtjb25zdHJ1Y3RvcihlLHQsaSxuPTNlMyxvPTNlNSl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZT10LHRoaXMubG9hZGluZ0luZGljYXRvcj1pLHRoaXMucG9sbGluZ0ludGVydmFsPW4sdGhpcy5tYXhQb2xsaW5nSW50ZXJ2YWxUaW1lPW8sdGhpcy5wb2xsaW5nVGltZXI9MCx0aGlzLnN0b3BQb2xsaW5nPXJ9aW5pdGlhbGl6ZShlKXtyZXR1cm4gb3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2dhdGV3YXlJZDp0LG1ldGhvZElkOmkscGF5cGFsY29tbWVyY2VyYXRlcGF5Om59PWU7aWYoIWkpdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQpdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuZ2F0ZXdheUlkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLnBheXBhbGNvbW1lcmNlcmF0ZXBheVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtjb25zdHtsZWdhbFRleHRDb250YWluZXI6byxjb250YWluZXI6YSxsb2FkaW5nQ29udGFpbmVySWQ6cn09bjtpZighYSl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5jb250YWluZXJcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIW8pdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubGVnYWxUZXh0Q29udGFpbmVyXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFyKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmxvYWRpbmdDb250YWluZXJJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt0aGlzLmxvYWRpbmdJbmRpY2F0b3JDb250YWluZXI9cjtjb25zdCBzPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KGksdCkse21lcmNoYW50SWQ6ZH09cy5pbml0aWFsaXphdGlvbkRhdGF8fHt9O2lmKCFkKXRocm93IG5ldyBfKFwiVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIG1lcmNoYW50SWQgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLlwiKTt0aGlzLnBheXBhbGNvbW1lcmNlcmF0ZXBheT1uLHlpZWxkIHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheVBhbFNkayhpKSx0aGlzLmNyZWF0ZUZyYXVkTmV0U2NyaXB0KGQsaSx0KSx0aGlzLmxvYWRGcmF1ZG5ldENvbmZpZygpLHRoaXMucmVuZGVyTGVnYWxUZXh0KG8sYSl9KX1leGVjdXRlKGUsdCl7cmV0dXJuIG90KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Oml9PWUsbj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIG89MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO288bi5sZW5ndGg7bysrKXQuaW5kZXhPZihuW29dKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW29dKSYmKGlbbltvXV09ZVtuW29dXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSkse2dldEZpZWxkc1ZhbHVlczpvfT10aGlzLnBheXBhbGNvbW1lcmNlcmF0ZXBheXx8e307aWYoIWkpdGhyb3cgbmV3IHdlKFtcInBheW1lbnRcIl0pO2lmKCFvfHxcImZ1bmN0aW9uXCIhPXR5cGVvZiBvKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmdldEZpZWxkc1ZhbHVlc1wiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITApO3RyeXtjb25zdCBlPXlpZWxkIHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlT3JkZXIoXCJwYXlwYWxjb21tZXJjZWFsdGVybmF0aXZlbWV0aG9kc2NoZWNrb3V0XCIse21ldGFkYXRhSWQ6dGhpcy5ndWlkfSkse3JhdGVwYXlCaXJ0aERhdGU6YSxyYXRlcGF5UGhvbmVOdW1iZXI6cixyYXRlcGF5UGhvbmVDb3VudHJ5Q29kZTpzfT1vKCksZD17Zm9ybWF0dGVkUGF5bG9hZDp7dmF1bHRfcGF5bWVudF9pbnN0cnVtZW50Om51bGwsc2V0X2FzX2RlZmF1bHRfc3RvcmVkX2luc3RydW1lbnQ6bnVsbCxkZXZpY2VfaW5mbzpudWxsLG1ldGhvZF9pZDppLm1ldGhvZElkLHJhdGVfcGF5OntiaXJ0aF9kYXRlOnRoaXMubm9ybWFsaXplRGF0ZShhKSxwaG9uZTp7bmF0aW9uYWxfbnVtYmVyOnIsY291bnRyeV9jb2RlOnMuc3BsaXQoXCIrXCIpWzFdfX0scGF5cGFsX2FjY291bnQ6e29yZGVyX2lkOmV9fX07cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihuLHQpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KHttZXRob2RJZDppLm1ldGhvZElkLHBheW1lbnREYXRhOmR9KSx5aWVsZCBuZXcgUHJvbWlzZSgoZSx0KT0+e3RoaXMuaW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oaS5tZXRob2RJZCxlLHQsaS5nYXRld2F5SWQpfSl9Y2F0Y2goZSl7cmV0dXJuIHRoaXMuaGFuZGxlRXJyb3IoZSksbmV3IFByb21pc2UoKGUsdCk9PnQoKSl9fSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFBlKX1kZWluaXRpYWxpemUoKXtjb25zdHtsZWdhbFRleHRDb250YWluZXI6ZX09dGhpcy5wYXlwYWxjb21tZXJjZXJhdGVwYXl8fHt9LHQ9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtaWQ9XCJmcmF1ZG5ldFNjcmlwdFwiXScpWzBdLGk9ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtaWQ9XCJmcmF1ZG5ldENvbmZpZ1wiXScpWzBdO2lmKHRoaXMuZGVpbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbSgpLHQucmVtb3ZlKCksaS5yZW1vdmUoKSxlKXtjb25zdCB0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGUpO251bGw9PXR8fHQucmVtb3ZlKCl9cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfW5vcm1hbGl6ZURhdGUoZSl7Y29uc3QgdD10aGlzLmZvcm1hdERhdGUoZS5nZXREYXRlKCkpLGk9dGhpcy5mb3JtYXREYXRlKGUuZ2V0TW9udGgoKSsxKTtyZXR1cm5gJHtlLmdldEZ1bGxZZWFyKCl9LSR7aX0tJHt0fWB9Zm9ybWF0RGF0ZShlKXtyZXR1cm5gJHtlPDEwPzA6XCJcIn0ke2V9YH1yZW5kZXJMZWdhbFRleHQoZSx0KXtjb25zdCBpPWUsbj10LnNwbGl0KFwiI1wiKVsxXSxvPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG4pLGE9bnVsbD09bz92b2lkIDA6by5wYXJlbnROb2RlLHI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtyLnN0eWxlLm1hcmdpbkJvdHRvbT1cIjIwcHhcIixyLnNldEF0dHJpYnV0ZShcImlkXCIsaSksbnVsbD09YXx8YS5wcmVwZW5kKHIpO2NvbnN0IHM9dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5nZXRQYXlQYWxTZGtPclRocm93KCksZD1zLkxlZ2FsKHtmdW5kaW5nU291cmNlOnMuTGVnYWwuRlVORElORy5QQVlfVVBPTl9JTlZPSUNFfSk7aWYoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGkpKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJsZWdhbFRleHRDb250YWluZXJFbGVtZW50XCIgYXJndW1lbnQgaXMgbm90IGZvdW5kLicpO2QucmVuZGVyKGAjJHtpfWApfWhhbmRsZUVycm9yKGUpe2NvbnN0e29uRXJyb3I6dH09dGhpcy5wYXlwYWxjb21tZXJjZXJhdGVwYXl8fHt9O3RoaXMucmVzZXRQb2xsaW5nTWVjaGFuaXNtKCksdGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKSx0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0JiZ0KGUpfWNyZWF0ZUZyYXVkTmV0U2NyaXB0KGUsdCxpKXtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KHQsaSkse3Rlc3RNb2RlOm99PW4uY29uZmlnLGE9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTthLnNldEF0dHJpYnV0ZShcInR5cGVcIixcImFwcGxpY2F0aW9uL2pzb25cIiksYS5zZXRBdHRyaWJ1dGUoXCJmbmNsc1wiLFwiZm5wYXJhbXMtZGVkZTdjYzUtMTVmZC00Yzc1LWE5ZjQtMzZjNDMwZWUzYTk5XCIpLGEuc2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiLFwiZnJhdWRuZXRTY3JpcHRcIiksdGhpcy5ndWlkPXRoaXMuZ2VuZXJhdGVHVUlEKCk7Y29uc3Qgcj17Zjp0aGlzLmd1aWQsczpgJHtlfV9jaGVja291dC1wYWdlYCxzYW5kYm94Om99O2EuaW5uZXJIVE1MPUpTT04uc3RyaW5naWZ5KHIpLGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSl9Z2VuZXJhdGVHVUlEKCl7bGV0IGU9XCJcIjtmb3IobGV0IHQ9MDt0PDMyO3QrPTEpZSs9XCJBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OVwiW01hdGguZmxvb3IoNjIqTWF0aC5yYW5kb20oKSldO3JldHVybiBlfWxvYWRGcmF1ZG5ldENvbmZpZygpe2NvbnN0IGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTtlLnNldEF0dHJpYnV0ZShcImRhdGEtaWRcIixcImZyYXVkbmV0Q29uZmlnXCIpLGUuc3JjPVwiaHR0cHM6Ly9jLnBheXBhbC5jb20vZGEvci9mYi5qc1wiLGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZSl9cmVpbml0aWFsaXplU3RyYXRlZ3koZSl7cmV0dXJuIG90KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLmRlaW5pdGlhbGl6ZSgpLHlpZWxkIHRoaXMuaW5pdGlhbGl6ZShlKX0pfWluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKGUsdCxpLG4pe3JldHVybiBvdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgbmV3IFByb21pc2UoKGUsdCk9Pntjb25zdCBpPXNldFRpbWVvdXQoZSx0aGlzLnBvbGxpbmdJbnRlcnZhbCk7dGhpcy5zdG9wUG9sbGluZz0oKT0+KGNsZWFyVGltZW91dChpKSx0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLHQoKSl9KTt0cnl7dGhpcy5wb2xsaW5nVGltZXIrPXRoaXMucG9sbGluZ0ludGVydmFsO2NvbnN0IG89eWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5nZXRPcmRlclN0YXR1cyhcInBheXBhbGNvbW1lcmNlYWx0ZXJuYXRpdmVtZXRob2RzXCIse3BhcmFtczp7dXNlTWV0YWRhdGE6ITB9fSksYT1vPT09Ty5Qb2xsaW5nU3RvcCxyPW89PT1PLlBvbGxpbmdFcnJvcjtpZihhKXJldHVybiB0aGlzLmRlaW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oKSx0KCk7aWYocilyZXR1cm4gaSgpO2lmKCFhJiZ0aGlzLnBvbGxpbmdUaW1lcjx0aGlzLm1heFBvbGxpbmdJbnRlcnZhbFRpbWUpcmV0dXJuIHlpZWxkIHRoaXMuaW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oZSx0LGksbik7eWllbGQgdGhpcy5yZWluaXRpYWxpemVTdHJhdGVneSh7bWV0aG9kSWQ6ZSxnYXRld2F5SWQ6bixwYXlwYWxjb21tZXJjZXJhdGVwYXk6dGhpcy5wYXlwYWxjb21tZXJjZXJhdGVwYXl9KSx0aGlzLmhhbmRsZUVycm9yKG5ldyBqZSl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKSxpKCl9fSl9ZGVpbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbSgpe3RoaXMuc3RvcFBvbGxpbmcoKSx0aGlzLnBvbGxpbmdUaW1lcj0wfXJlc2V0UG9sbGluZ01lY2hhbmlzbSgpe3RoaXMuZGVpbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbSgpfXRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoZSl7ZSYmdGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyP3RoaXMubG9hZGluZ0luZGljYXRvci5zaG93KHRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcik6dGhpcy5sb2FkaW5nSW5kaWNhdG9yLmhpZGUoKX19Y29uc3QgcnQ9cChlPT5uZXcgYXQoZSxOKGUpLG5ldyBTZSh7Y29udGFpbmVyU3R5bGVzOk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxJZSkse3Bvc2l0aW9uOlwiZml4ZWRcIn0pfSkpLFt7Z2F0ZXdheTpcInBheXBhbGNvbW1lcmNlYWx0ZXJuYXRpdmVtZXRob2RzXCIsaWQ6XCJyYXRlcGF5XCJ9XSk7ZnVuY3Rpb24gc3QoZSl7cmV0dXJuXCJzdHJpbmdcIiE9dHlwZW9mIGV9ZnVuY3Rpb24gZHQoZSx0KXtpZih0fHxlKXJldHVybiBmdW5jdGlvbihlKXt2YXIgdCxpO2NvbnN0IG49e30sbz1kKGUucm9vdCxzdCksYT1kKGUuaW5wdXQsc3QpLHI9ZChlLnRvZ2dsZSxzdCkscz1kKG51bGw9PT0odD1lLnRleHQpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmJvZHksc3QpLGw9ZChudWxsPT09KGk9ZS50ZXh0KXx8dm9pZCAwPT09aT92b2lkIDA6aS5jYXB0aW9uLHN0KSxjPWUuYnJhbmRpbmc7cmV0dXJuIE9iamVjdC5rZXlzKG8pLmxlbmd0aCYmKG4ucm9vdD1vKSxPYmplY3Qua2V5cyhhKS5sZW5ndGgmJihuLmlucHV0PWEpLE9iamVjdC5rZXlzKHIpLmxlbmd0aCYmKG4udG9nZ2xlPXIpLE9iamVjdC5rZXlzKHMpLmxlbmd0aCYmKG4udGV4dD17fSxuLnRleHQuYm9keT1zKSxPYmplY3Qua2V5cyhsKS5sZW5ndGgmJihuLnRleHQ9T2JqZWN0LmFzc2lnbih7fSxuLnRleHQpLG4udGV4dC5jYXB0aW9uPWwpLGMmJihuLmJyYW5kaW5nPWMpLG59KGZ1bmN0aW9uKGUsdCl7dmFyIGksbixvLGEscixzLGQsbCxjLHAsdSxoLHksbSxnLHYsZixTLEksdyxiLFA7cmV0dXJue3Jvb3Q6e2JhY2tncm91bmRDb2xvclByaW1hcnk6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVSb290U2V0dGluZ3NCYWNrZ3JvdW5kQ29sb3IpfHwobnVsbD09PShpPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PWk/dm9pZCAwOmkuYmFja2dyb3VuZENvbG9yUHJpbWFyeSksZXJyb3JDb2xvcjoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVJvb3RTZXR0aW5nc0Vycm9yQ29sb3IpfHwobnVsbD09PShuPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PW4/dm9pZCAwOm4uZXJyb3JDb2xvciksZm9udEZhbWlseToobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVJvb3RTZXR0aW5nc0ZvbnRGYW1pbHkpfHwobnVsbD09PShvPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PW8/dm9pZCAwOm8uZm9udEZhbWlseSksZm9udFNpemVCYXNlOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lUm9vdFNldHRpbmdzRm9udFNpemUpfHwobnVsbD09PShhPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PWE/dm9pZCAwOmEuZm9udFNpemVCYXNlKSxwYWRkaW5nOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lUm9vdFNldHRpbmdzUGFkZGluZyl8fChudWxsPT09KHI9bnVsbD09dD92b2lkIDA6dC5yb290KXx8dm9pZCAwPT09cj92b2lkIDA6ci5wYWRkaW5nKSxwcmltYXJ5Q29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVSb290U2V0dGluZ3NQcmltYXJ5Q29sb3IpfHwobnVsbD09PShzPW51bGw9PXQ/dm9pZCAwOnQucm9vdCl8fHZvaWQgMD09PXM/dm9pZCAwOnMucHJpbWFyeUNvbG9yKX0saW5wdXQ6e2JvcmRlclJhZGl1czoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUlucHV0U2V0dGluZ3NCb3JkZXJSYWRpdXMpfHwobnVsbD09PShkPW51bGw9PXQ/dm9pZCAwOnQuaW5wdXQpfHx2b2lkIDA9PT1kP3ZvaWQgMDpkLmJvcmRlclJhZGl1cyksYm9yZGVyQ29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVJbnB1dFNldHRpbmdzQm9yZGVyQ29sb3IpfHwobnVsbD09PShsPW51bGw9PXQ/dm9pZCAwOnQuaW5wdXQpfHx2b2lkIDA9PT1sP3ZvaWQgMDpsLmJvcmRlckNvbG9yKSxmb2N1c0JvcmRlckNvbG9yOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lSW5wdXRTZXR0aW5nc0ZvY3VzQm9yZGVyQmFzZSl8fChudWxsPT09KGM9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PWM/dm9pZCAwOmMuZm9jdXNCb3JkZXJDb2xvciksYmFja2dyb3VuZENvbG9yOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lSW5wdXRTZXR0aW5nc0JhY2tncm91bmRDb2xvcil8fChudWxsPT09KHA9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PXA/dm9pZCAwOnAuYmFja2dyb3VuZENvbG9yKSxib3JkZXJXaWR0aDoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUlucHV0U2V0dGluZ3NCb3JkZXJXaWR0aCl8fChudWxsPT09KHU9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PXU/dm9pZCAwOnUuYm9yZGVyV2lkdGgpLHRleHRDb2xvckJhc2U6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVJbnB1dFNldHRpbmdzVGV4dENvbG9yQmFzZSl8fChudWxsPT09KGg9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PWg/dm9pZCAwOmgudGV4dENvbG9yQmFzZSl9LHRvZ2dsZTp7Y29sb3JQcmltYXJ5OihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lVG9nZ2xlU2V0dGluZ3NDb2xvclByaW1hcnkpfHwobnVsbD09PSh5PW51bGw9PXQ/dm9pZCAwOnQudG9nZ2xlKXx8dm9pZCAwPT09eT92b2lkIDA6eS5jb2xvclByaW1hcnkpLGNvbG9yU2Vjb25kYXJ5OihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lVG9nZ2xlU2V0dGluZ3NDb2xvclNlY29uZGFyeSl8fChudWxsPT09KG09bnVsbD09dD92b2lkIDA6dC50b2dnbGUpfHx2b2lkIDA9PT1tP3ZvaWQgMDptLmNvbG9yU2Vjb25kYXJ5KX0sdGV4dDp7Ym9keTp7Y29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVUZXh0Qm9keVNldHRpbmdzQ29sb3IpfHwobnVsbD09PSh2PW51bGw9PT0oZz1udWxsPT10P3ZvaWQgMDp0LnRleHQpfHx2b2lkIDA9PT1nP3ZvaWQgMDpnLmJvZHkpfHx2b2lkIDA9PT12P3ZvaWQgMDp2LmNvbG9yKSxmb250U2l6ZToobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVRleHRCb2R5U2V0dGluZ3NGb250U2l6ZSl8fChudWxsPT09KFM9bnVsbD09PShmPW51bGw9PXQ/dm9pZCAwOnQudGV4dCl8fHZvaWQgMD09PWY/dm9pZCAwOmYuYm9keSl8fHZvaWQgMD09PVM/dm9pZCAwOlMuZm9udFNpemUpfSxjYXB0aW9uOntjb2xvcjoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVRleHRDYXB0aW9uU2V0dGluZ3NDb2xvcil8fChudWxsPT09KHc9bnVsbD09PShJPW51bGw9PXQ/dm9pZCAwOnQudGV4dCl8fHZvaWQgMD09PUk/dm9pZCAwOkkuY2FwdGlvbil8fHZvaWQgMD09PXc/dm9pZCAwOncuY29sb3IpLGZvbnRTaXplOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lVGV4dENhcHRpb25TZXR0aW5nc0ZvbnRTaXplKXx8KG51bGw9PT0oUD1udWxsPT09KGI9bnVsbD09dD92b2lkIDA6dC50ZXh0KXx8dm9pZCAwPT09Yj92b2lkIDA6Yi5jYXB0aW9uKXx8dm9pZCAwPT09UD92b2lkIDA6UC5mb250U2l6ZSl9fSxicmFuZGluZzoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUJyYW5kaW5nU2V0dGluZ3MpfHwobnVsbD09dD92b2lkIDA6dC5icmFuZGluZyl9fShlLHQpKX1mdW5jdGlvbiBsdChlKXtyZXR1cm4hIWUmJihcImF1dGhlbnRpY2F0aW9uU3RhdGVcImluIGV8fFwiYWRkcmVzc2VzXCJpbiBlfHxcImluc3RydW1lbnRzXCJpbiBlKX12YXIgY3Q9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24obyxhKXtmdW5jdGlvbiByKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9vKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4ocixzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgcHR7Y29uc3RydWN0b3IoZSx0LGksbil7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5wYXlwYWxDb21tZXJjZVJlcXVlc3RTZW5kZXI9dCx0aGlzLnBheXBhbFNka1NjcmlwdExvYWRlcj1pLHRoaXMucGF5cGFsRmFzdGxhbmVVdGlscz1ufWluaXRpYWxpemUoZSl7dmFyIHQsaTtyZXR1cm4gY3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e21ldGhvZElkOm4scGF5cGFsY29tbWVyY2VmYXN0bGFuZTpvfT1lO2lmKHRoaXMubWV0aG9kSWQ9bix0aGlzLnBheXBhbGNvbW1lcmNlZmFzdGxhbmU9bywhbil0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighbyl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5wYXlwYWxjb21tZXJjZWZhc3RsYW5lXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFvLm9uSW5pdHx8XCJmdW5jdGlvblwiIT10eXBlb2Ygby5vbkluaXQpdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMucGF5cGFsY29tbWVyY2VmYXN0bGFuZS5vbkluaXRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQgb3IgaXQgaXMgbm90IGEgZnVuY3Rpb24uJyk7aWYoIW8ub25DaGFuZ2V8fFwiZnVuY3Rpb25cIiE9dHlwZW9mIG8ub25DaGFuZ2UpdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMucGF5cGFsY29tbWVyY2VmYXN0bGFuZS5vbkNoYW5nZVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZCBvciBpdCBpcyBub3QgYSBmdW5jdGlvbi4nKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2Qobik7Y29uc3QgYT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPWEuZ2V0Q2FydE9yVGhyb3coKSxzPWEuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3cobikse2lzRGV2ZWxvcGVyTW9kZUFwcGxpY2FibGU6ZCxpc0Zhc3RsYW5lU3R5bGluZ0VuYWJsZWQ6bH09cy5pbml0aWFsaXphdGlvbkRhdGF8fHt9O3RoaXMudGhyZWVEU1ZlcmlmaWNhdGlvbk1ldGhvZD1udWxsPT09KHQ9cy5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LnRocmVlRFNWZXJpZmljYXRpb25NZXRob2QsdGhpcy5wYXlwYWxGYXN0bGFuZVNkaz15aWVsZCB0aGlzLnBheXBhbFNka1NjcmlwdExvYWRlci5nZXRQYXlQYWxGYXN0bGFuZVNkayhzLHIuY3VycmVuY3kuY29kZSxyLmlkKTtjb25zdCBjPWR0KGw/bnVsbD09PShpPW51bGw9PXM/dm9pZCAwOnMuaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09aT92b2lkIDA6aS5mYXN0bGFuZVN0eWxlczp7fSxudWxsPT1vP3ZvaWQgMDpvLnN0eWxlcyk7eWllbGQgdGhpcy5wYXlwYWxGYXN0bGFuZVV0aWxzLmluaXRpYWxpemVQYXlQYWxGYXN0bGFuZSh0aGlzLnBheXBhbEZhc3RsYW5lU2RrLCEhZCxjKSx0aGlzLnNob3VsZFJ1bkF1dGhlbnRpY2F0aW9uRmxvdygpJiYoeWllbGQgdGhpcy5ydW5QYXlQYWxBdXRoZW50aWNhdGlvbkZsb3dPclRocm93KG4pKSx5aWVsZCB0aGlzLmluaXRpYWxpemVQYXlQYWxQYXltZW50Q29tcG9uZW50KCksby5vbkluaXQoZT0+dGhpcy5yZW5kZXJQYXlQYWxQYXltZW50Q29tcG9uZW50KGUpKSxvLm9uQ2hhbmdlKCgpPT50aGlzLmhhbmRsZVBheVBhbFN0b3JlZEluc3RydW1lbnRDaGFuZ2UobikpfSl9ZXhlY3V0ZShlLHQpe3JldHVybiBjdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cGF5bWVudDppfT1lLG49ZnVuY3Rpb24oZSx0KXt2YXIgaT17fTtmb3IodmFyIG4gaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxuKSYmdC5pbmRleE9mKG4pPDAmJihpW25dPWVbbl0pO2lmKG51bGwhPWUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciBvPTA7Zm9yKG49T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtvPG4ubGVuZ3RoO28rKyl0LmluZGV4T2YobltvXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsbltvXSkmJihpW25bb11dPWVbbltvXV0pfXJldHVybiBpfShlLFtcInBheW1lbnRcIl0pO2lmKCFpKXRocm93IG5ldyB3ZShbXCJwYXltZW50XCJdKTtjb25zdHtwYXltZW50RGF0YTpvLG1ldGhvZElkOmF9PWkscj1vJiZPZShvKTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKG4sdCk7Y29uc3QgZT1yP3lpZWxkIHRoaXMucHJlcGFyZVZhdWx0ZWRJbnN0cnVtZW50UGF5bWVudFBheWxvYWQoYSxvKTp5aWVsZCB0aGlzLnByZXBhcmVQYXltZW50UGF5bG9hZChhLG8pO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGUpLHRoaXMucGF5cGFsRmFzdGxhbmVVdGlscy5yZW1vdmVTdG9yYWdlU2Vzc2lvbklkKCl9Y2F0Y2goZSl7aWYoZnVuY3Rpb24oZSl7cmV0dXJuXCJvYmplY3RcIj09dHlwZW9mIGUmJm51bGwhPT1lJiZcIm1lc3NhZ2VcImluIGUmJlwicmVzcG9uc2VcImluIGUmJlwiYm9keVwiaW4gZS5yZXNwb25zZSYmXCJuYW1lXCJpbiBlLnJlc3BvbnNlLmJvZHl9KGUpJiZcIklOVkFMSURfUkVRVUVTVFwiPT09ZS5yZXNwb25zZS5ib2R5Lm5hbWUpe2NvbnN0IGU9e3RyYW5zbGF0aW9uS2V5OlwicGF5bWVudC5lcnJvcnMuaW52YWxpZF9yZXF1ZXN0X2Vycm9yXCJ9O3JldHVybiB0aGlzLmhhbmRsZUVycm9yKGUpLFByb21pc2UucmVqZWN0KCl9aWYoZSBpbnN0YW5jZW9mIEVycm9yJiZcIkZhc3RsYW5lRXJyb3JcIiE9PWUubmFtZSl0aHJvdyBlO3JldHVybiBQcm9taXNlLnJlamVjdCgpfX0pfWZpbmFsaXplKCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBQZSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIGN0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9KX1zaG91bGRSdW5BdXRoZW50aWNhdGlvbkZsb3coKXtjb25zdCBlPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHQ9ZS5nZXRDYXJ0T3JUaHJvdygpLGk9ZS5nZXRDdXN0b21lck9yVGhyb3coKSxuPWUuZ2V0UGF5bWVudFByb3ZpZGVyQ3VzdG9tZXIoKSxvPWx0KG4pP246e30sYT10aGlzLnBheXBhbEZhc3RsYW5lVXRpbHMuZ2V0U3RvcmFnZVNlc3Npb25JZCgpO3JldHVybiEoIWkuaXNHdWVzdHx8KG51bGw9PW8/dm9pZCAwOm8uYXV0aGVudGljYXRpb25TdGF0ZSk9PT1XLkNBTkNFTEVEfHwobnVsbD09bz92b2lkIDA6by5hdXRoZW50aWNhdGlvblN0YXRlKXx8YSE9PXQuaWQpfXJ1blBheVBhbEF1dGhlbnRpY2F0aW9uRmxvd09yVGhyb3coZSl7cmV0dXJuIGN0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxpPXQuZ2V0Q2FydE9yVGhyb3coKSxuPXQuZ2V0Q3VzdG9tZXIoKSxvPXQuZ2V0QmlsbGluZ0FkZHJlc3MoKSxhPShudWxsPT1uP3ZvaWQgMDpuLmVtYWlsKXx8KG51bGw9PW8/dm9pZCAwOm8uZW1haWwpfHxcIlwiLHtjdXN0b21lckNvbnRleHRJZDpyfT15aWVsZCB0aGlzLnBheXBhbEZhc3RsYW5lVXRpbHMubG9va3VwQ3VzdG9tZXJPclRocm93KGEpLHM9eWllbGQgdGhpcy5wYXlwYWxGYXN0bGFuZVV0aWxzLnRyaWdnZXJBdXRoZW50aWNhdGlvbkZsb3dPclRocm93KHIpLHthdXRoZW50aWNhdGlvblN0YXRlOmQsYWRkcmVzc2VzOmwsaW5zdHJ1bWVudHM6Y309dGhpcy5wYXlwYWxGYXN0bGFuZVV0aWxzLm1hcFBheVBhbEZhc3RsYW5lUHJvZmlsZVRvQmNDdXN0b21lckRhdGEoZSxzKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlUGF5bWVudFByb3ZpZGVyQ3VzdG9tZXIoe2F1dGhlbnRpY2F0aW9uU3RhdGU6ZCxhZGRyZXNzZXM6bCxpbnN0cnVtZW50czpjfSkscy5hdXRoZW50aWNhdGlvblN0YXRlPT09Vy5DQU5DRUxFRD90aGlzLnBheXBhbEZhc3RsYW5lVXRpbHMucmVtb3ZlU3RvcmFnZVNlc3Npb25JZCgpOnRoaXMucGF5cGFsRmFzdGxhbmVVdGlscy51cGRhdGVTdG9yYWdlU2Vzc2lvbklkKGkuaWQpfWNhdGNoKGUpe319KX1pbml0aWFsaXplUGF5UGFsUGF5bWVudENvbXBvbmVudCgpe3JldHVybiBjdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgZT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRCaWxsaW5nQWRkcmVzc09yVGhyb3coKSx0PWUucGhvbmUsaT1gJHtlLmZpcnN0TmFtZX0gJHtlLmxhc3ROYW1lfWAudHJpbSgpLG49dGhpcy5wYXlwYWxGYXN0bGFuZVV0aWxzLmdldFBheVBhbEZhc3RsYW5lT3JUaHJvdygpLG89e2ZpZWxkczpPYmplY3QuYXNzaWduKHtjYXJkaG9sZGVyTmFtZTp7cHJlZmlsbDppLGVuYWJsZWQ6ITB9fSx0JiZ7cGhvbmVOdW1iZXI6e3ByZWZpbGw6dH19KX07dGhpcy5wYXlwYWxDb21wb25lbnRNZXRob2RzPXlpZWxkIG4uRmFzdGxhbmVDYXJkQ29tcG9uZW50KG8pfSl9cmVuZGVyUGF5UGFsUGF5bWVudENvbXBvbmVudChlKXtjb25zdCB0PXRoaXMuZ2V0UGF5UGFsQ29tcG9uZW50TWV0aG9kc09yVGhyb3coKTtpZighZSl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIHJlbmRlciBjYXJkIGNvbXBvbmVudCBiZWNhdXNlIFwiY29udGFpbmVyXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3QucmVuZGVyKGUpfWdldFBheVBhbENvbXBvbmVudE1ldGhvZHNPclRocm93KCl7aWYoIXRoaXMucGF5cGFsQ29tcG9uZW50TWV0aG9kcyl0aHJvdyBuZXcgaDtyZXR1cm4gdGhpcy5wYXlwYWxDb21wb25lbnRNZXRob2RzfXByZXBhcmVWYXVsdGVkSW5zdHJ1bWVudFBheW1lbnRQYXlsb2FkKGUsdCl7cmV0dXJuIGN0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtpbnN0cnVtZW50SWQ6aX09dCxuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KGUpLmNvbmZpZy5pczNkc0VuYWJsZWQ/eWllbGQgdGhpcy5nZXQzRFNOb25jZShpKTppO3JldHVybiB5aWVsZCB0aGlzLmNyZWF0ZU9yZGVyKG4pLHttZXRob2RJZDplLHBheW1lbnREYXRhOntmb3JtYXR0ZWRQYXlsb2FkOntwYXlwYWxfZmFzdGxhbmVfdG9rZW46e29yZGVyX2lkOnRoaXMub3JkZXJJZCx0b2tlbjpufX19fX0pfXByZXBhcmVQYXltZW50UGF5bG9hZChlLHQpe3JldHVybiBjdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxuPWkuZ2V0QmlsbGluZ0FkZHJlc3NPclRocm93KCksbz1pLmdldFBheW1lbnRNZXRob2RPclRocm93KGUpLGE9YCR7bi5maXJzdE5hbWV9ICR7bi5sYXN0TmFtZX1gLnRyaW0oKSx7Z2V0UGF5bWVudFRva2VuOnJ9PXRoaXMuZ2V0UGF5UGFsQ29tcG9uZW50TWV0aG9kc09yVGhyb3coKSx7aWQ6c309eWllbGQgcih7bmFtZTp7ZnVsbE5hbWU6YX0sYmlsbGluZ0FkZHJlc3M6dGhpcy5wYXlwYWxGYXN0bGFuZVV0aWxzLm1hcEJjVG9QYXlQYWxBZGRyZXNzKG4pfSksZD1vLmNvbmZpZy5pczNkc0VuYWJsZWQ/eWllbGQgdGhpcy5nZXQzRFNOb25jZShzKTpzO3lpZWxkIHRoaXMuY3JlYXRlT3JkZXIoZCk7Y29uc3R7c2hvdWxkU2F2ZUluc3RydW1lbnQ6bD0hMSxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OmM9ITF9PUNlKHQpP3Q6e307cmV0dXJue21ldGhvZElkOmUscGF5bWVudERhdGE6T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHQpLHtzaG91bGRTYXZlSW5zdHJ1bWVudDpsLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6Yyxmb3JtYXR0ZWRQYXlsb2FkOntwYXlwYWxfZmFzdGxhbmVfdG9rZW46e29yZGVyX2lkOnRoaXMub3JkZXJJZCx0b2tlbjpkfX19KX19KX1jcmVhdGVPcmRlcihlKXtyZXR1cm4gY3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKS5pZDtpZih0aGlzLm1ldGhvZElkKXtjb25zdHtvcmRlcklkOml9PXlpZWxkIHRoaXMucGF5cGFsQ29tbWVyY2VSZXF1ZXN0U2VuZGVyLmNyZWF0ZU9yZGVyKHRoaXMubWV0aG9kSWQse2NhcnRJZDp0LGZhc3RsYW5lVG9rZW46ZX0pO3RoaXMub3JkZXJJZD1pfX0pfWdldDNEU05vbmNlKGUpe3ZhciB0O3JldHVybiBjdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxuPWkuZ2V0Q2FydE9yVGhyb3coKSxvPWkuZ2V0T3JkZXJPclRocm93KCksYT1pLmdldFN0b3JlQ29uZmlnT3JUaHJvdygpLmxpbmtzLmNoZWNrb3V0TGluayxyPW51bGw9PT0odD10aGlzLnBheXBhbEZhc3RsYW5lU2RrKXx8dm9pZCAwPT09dD92b2lkIDA6dC5UaHJlZURvbWFpblNlY3VyZUNsaWVudDtpZighcil0aHJvdyBuZXcgaDtjb25zdCBzPXthbW91bnQ6by5vcmRlckFtb3VudC50b0ZpeGVkKDIpLGN1cnJlbmN5Om4uY3VycmVuY3kuY29kZSxub25jZTplLHRocmVlRFNSZXF1ZXN0ZWQ6dGhpcy50aHJlZURTVmVyaWZpY2F0aW9uTWV0aG9kPT09TC5BbHdheXMsdHJhbnNhY3Rpb25Db250ZXh0OntleHBlcmllbmNlX2NvbnRleHQ6e2xvY2FsZTpcImVuLVVTXCIscmV0dXJuX3VybDphLGNhbmNlbF91cmw6YX19fSxkPXlpZWxkIHIuaXNFbGlnaWJsZShzKTtpZih0aGlzLnRocmVlRFNWZXJpZmljYXRpb25NZXRob2Q9PT1MLkFsd2F5cyYmIWQpdGhyb3cgbmV3IGJlO2lmKGQpe2NvbnN0e2xpYWJpbGl0eVNoaWZ0OmUsYXV0aGVudGljYXRpb25TdGF0ZTp0LG5vbmNlOml9PXlpZWxkIHIuc2hvdygpO2lmKGU9PT1TLk5vfHxlPT09Uy5Vbmtub3dufHx0PT09JC5FcnJvcmVkfHx0PT09JC5DYW5jZWxsZWQpdGhyb3cgbmV3IGJlO2lmKHQ9PT0kLlN1Y2NlZWRlZCYmW1MuWWVzLFMuUG9zc2libGVdLmluY2x1ZGVzKGUpKXJldHVybiBpfXJldHVybiBlfSl9aGFuZGxlUGF5UGFsU3RvcmVkSW5zdHJ1bWVudENoYW5nZShlKXtyZXR1cm4gY3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5wYXlwYWxGYXN0bGFuZVV0aWxzLmdldFBheVBhbEZhc3RsYW5lT3JUaHJvdygpLHtzZWxlY3Rpb25DaGFuZ2VkOmksc2VsZWN0ZWRDYXJkOm59PXlpZWxkIHQucHJvZmlsZS5zaG93Q2FyZFNlbGVjdG9yKCk7aWYoaSl7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50UHJvdmlkZXJDdXN0b21lcigpLGk9bHQodCk/dDp7fSxvPXRoaXMucGF5cGFsRmFzdGxhbmVVdGlscy5tYXBQYXlQYWxUb0JjSW5zdHJ1bWVudChlLG4pWzBdO3JldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlUGF5bWVudFByb3ZpZGVyQ3VzdG9tZXIoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGkpLHtpbnN0cnVtZW50czpbb119KSksb319KX1oYW5kbGVFcnJvcihlKXt2YXIgdDsobnVsbD09PSh0PXRoaXMucGF5cGFsY29tbWVyY2VmYXN0bGFuZSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQub25FcnJvcikmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXMucGF5cGFsY29tbWVyY2VmYXN0bGFuZS5vbkVycm9yJiZ0aGlzLnBheXBhbGNvbW1lcmNlZmFzdGxhbmUub25FcnJvcihlKX19Y29uc3QgdXQ9cChlPT57Y29uc3R7Z2V0SG9zdDppfT1lLmdldFN0YXRlKCk7cmV0dXJuIG5ldyBwdChlLG5ldyBNKHQoe2hvc3Q6aSgpfSkpLFEoKSxZZSgpKX0sW3tpZDpcInBheXBhbGNvbW1lcmNlYWNjZWxlcmF0ZWRjaGVja291dFwifV0pO3ZhciBodD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihvLGEpe2Z1bmN0aW9uIHIoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP28oZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihyLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyB5dHtjb25zdHJ1Y3RvcihlLHQpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2U9dCx0aGlzLm9uRXJyb3I9cn1pbml0aWFsaXplKGUpe3JldHVybiBodCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cGF5cGFsY29tbWVyY2U6dCxtZXRob2RJZDppfT1lO2lmKCFpKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCF0KXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLnBheXBhbGNvbW1lcmNlXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCF0LmNvbnRhaW5lcil0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5wYXlwYWxjb21tZXJjZS5jb250YWluZXJcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYodC5vbkNsaWNrJiZcImZ1bmN0aW9uXCIhPXR5cGVvZiB0Lm9uQ2xpY2spdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMucGF5cGFsY29tbWVyY2Uub25DbGlja1wiIGFyZ3VtZW50IGlzIG5vdCBhIGZ1bmN0aW9uLicpO3RoaXMub25FcnJvcj10Lm9uRXJyb3J8fHIsdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZChpKXx8KHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKSk7Y29uc3Qgbj15aWVsZCB0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXlQYWxTZGsoaSk7biYmbi5CdXR0b25zJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLkJ1dHRvbnM/dGhpcy5yZW5kZXJCdXR0b24oaSx0KTpjb25zb2xlLmVycm9yKFwiW0JDIFBheVBhbF06IFBheVBhbCBCdXR0b24gY291bGQgbm90IGJlIHJlbmRlcmVkLCBkdWUgdG8gaXNzdWVzIHdpdGggbG9hZGluZyBQYXlQYWwgU0RLXCIpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfXNpZ25JbihlLHQpe3JldHVybiBodCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zaWduSW5DdXN0b21lcihlLHQpLFByb21pc2UucmVzb2x2ZSgpfSl9c2lnbk91dChlKXtyZXR1cm4gaHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbk91dEN1c3RvbWVyKGUpLFByb21pc2UucmVzb2x2ZSgpfSl9ZXhlY3V0ZVBheW1lbnRNZXRob2RDaGVja291dChlKXt2YXIgdDtyZXR1cm4gbnVsbD09PSh0PW51bGw9PWU/dm9pZCAwOmUuY29udGludWVXaXRoQ2hlY2tvdXRDYWxsYmFjayl8fHZvaWQgMD09PXR8fHQuY2FsbChlKSxQcm9taXNlLnJlc29sdmUoKX1yZW5kZXJCdXR0b24oZSx0KXt2YXIgaSxuO2NvbnN0e2NvbnRhaW5lcjpvLG9uQ2xpY2s6YSxvbkNvbXBsZXRlOnJ9PXQscz10aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheVBhbFNka09yVGhyb3coKSxkPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KGUpLHtpc0hvc3RlZENoZWNrb3V0RW5hYmxlZDpsLHBheW1lbnRCdXR0b25TdHlsZXM6Yyxpc0FwcFN3aXRjaEVuYWJsZWQ6cH09ZC5pbml0aWFsaXphdGlvbkRhdGF8fHt9LHtjaGVja291dFRvcEJ1dHRvblN0eWxlczp1fT1jfHx7fSxoPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHRoaXMuaXNQYXlwYWxDb21tZXJjZUFwcFN3aXRjaEVuYWJsZWQoZSkmJnthcHBTd2l0Y2hXaGVuQXZhaWxhYmxlOiEwfSkse2NyZWF0ZU9yZGVyOigpPT50aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZU9yZGVyKFwicGF5cGFsY29tbWVyY2VcIiksb25BcHByb3ZlOih7b3JkZXJJRDp0fSk9PnRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UudG9rZW5pemVQYXltZW50KGUsdCl9KSxhJiZ7b25DbGljazooKT0+YSgpfSkseT1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIXAmJntvblNoaXBwaW5nQWRkcmVzc0NoYW5nZTplPT50aGlzLm9uU2hpcHBpbmdBZGRyZXNzQ2hhbmdlKGUpLG9uU2hpcHBpbmdPcHRpb25zQ2hhbmdlOmU9PnRoaXMub25TaGlwcGluZ09wdGlvbnNDaGFuZ2UoZSl9KSx7b25BcHByb3ZlOih0LGkpPT50aGlzLm9uSG9zdGVkQ2hlY2tvdXRBcHByb3ZlKHQsaSxlLHIpfSksbT1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe2Z1bmRpbmdTb3VyY2U6cy5GVU5ESU5HLlBBWVBBTCxzdHlsZTp0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFZhbGlkQnV0dG9uU3R5bGUoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHUpLHtoZWlnaHQ6NDB9KSl9LGgpLGwmJnkpLGc9cy5CdXR0b25zKG0pO2cuaXNFbGlnaWJsZSgpPyhudWxsPT09KGk9Zy5oYXNSZXR1cm5lZCl8fHZvaWQgMD09PWk/dm9pZCAwOmkuY2FsbChnKSkmJnRoaXMuaXNQYXlwYWxDb21tZXJjZUFwcFN3aXRjaEVuYWJsZWQoZSk/bnVsbD09PShuPWcucmVzdW1lKXx8dm9pZCAwPT09bnx8bi5jYWxsKGcpOmcucmVuZGVyKGAjJHtvfWApOnRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UucmVtb3ZlRWxlbWVudChvKX1vbkhvc3RlZENoZWNrb3V0QXBwcm92ZShlLHQsaSxuKXtyZXR1cm4gaHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCFlLm9yZGVySUQpdGhyb3cgbmV3IHkobC5NaXNzaW5nT3JkZXJJZCk7Y29uc3Qgbz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDYXJ0T3JUaHJvdygpLGE9eWllbGQgdC5vcmRlci5nZXQoKTt0cnl7Y29uc3QgdD10aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldEJpbGxpbmdBZGRyZXNzRnJvbU9yZGVyRGV0YWlscyhhKTtpZih5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3ModCksby5saW5lSXRlbXMucGh5c2ljYWxJdGVtcy5sZW5ndGg+MCl7Y29uc3QgZT10aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFNoaXBwaW5nQWRkcmVzc0Zyb21PcmRlckRldGFpbHMoYSk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVNoaXBwaW5nQWRkcmVzcyhlKSx5aWVsZCB0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZU9yZGVyKCl9eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKHt9LHtwYXJhbXM6e21ldGhvZElkOml9fSkseWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGksZS5vcmRlcklEKSxuJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuJiZuKCl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX19KX1vblNoaXBwaW5nQWRkcmVzc0NoYW5nZShlKXtyZXR1cm4gaHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5nZXRBZGRyZXNzKHtjaXR5OmUuc2hpcHBpbmdBZGRyZXNzLmNpdHksY291bnRyeUNvZGU6ZS5zaGlwcGluZ0FkZHJlc3MuY291bnRyeUNvZGUscG9zdGFsQ29kZTplLnNoaXBwaW5nQWRkcmVzcy5wb3N0YWxDb2RlLHN0YXRlT3JQcm92aW5jZUNvZGU6ZS5zaGlwcGluZ0FkZHJlc3Muc3RhdGV9KTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZUJpbGxpbmdBZGRyZXNzKHQpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVTaGlwcGluZ0FkZHJlc3ModCk7Y29uc3QgZT10aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFNoaXBwaW5nT3B0aW9uT3JUaHJvdygpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zZWxlY3RTaGlwcGluZ09wdGlvbihlLmlkKSx5aWVsZCB0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZU9yZGVyKCl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX19KX1vblNoaXBwaW5nT3B0aW9uc0NoYW5nZShlKXtyZXR1cm4gaHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5nZXRTaGlwcGluZ09wdGlvbk9yVGhyb3coZS5zZWxlY3RlZFNoaXBwaW5nT3B0aW9uLmlkKTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNlbGVjdFNoaXBwaW5nT3B0aW9uKHQuaWQpLHlpZWxkIHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlT3JkZXIoKX1jYXRjaChlKXt0aGlzLmhhbmRsZUVycm9yKGUpfX0pfWhhbmRsZUVycm9yKGUpe2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIHRoaXMub25FcnJvcil0aHJvdyBlO3RoaXMub25FcnJvcihlKX1pc1BheXBhbENvbW1lcmNlQXBwU3dpdGNoRW5hYmxlZChlKXt2YXIgdDtyZXR1cm4obnVsbD09PSh0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KGUpLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuaXNBcHBTd2l0Y2hFbmFibGVkKXx8ITF9fWNvbnN0IG10PXAoZT0+bmV3IHl0KGUsTihlKSksW3tpZDpcInBheXBhbGNvbW1lcmNlXCJ9XSk7dmFyIGd0PWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKG8sYSl7ZnVuY3Rpb24gcihlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe2EoZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/byhlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHIscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIHZ0e2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZT10LHRoaXMub25FcnJvcj1yfWluaXRpYWxpemUoZSl7cmV0dXJuIGd0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXlwYWxjb21tZXJjZWNyZWRpdDp0LG1ldGhvZElkOml9PWU7aWYoIWkpdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQpdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMucGF5cGFsY29tbWVyY2VjcmVkaXRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQuY29udGFpbmVyKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLnBheXBhbGNvbW1lcmNlY3JlZGl0LmNvbnRhaW5lclwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZih0Lm9uQ2xpY2smJlwiZnVuY3Rpb25cIiE9dHlwZW9mIHQub25DbGljayl0aHJvdyBuZXcgXygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5wYXlwYWxjb21tZXJjZWNyZWRpdC5vbkNsaWNrXCIgYXJndW1lbnQgaXMgbm90IGEgZnVuY3Rpb24uJyk7dGhpcy5vbkVycm9yPXQub25FcnJvcnx8cix0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50TWV0aG9kKGkpfHwoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKGkpKTtjb25zdCBuPXlpZWxkIHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheVBhbFNkayhpKTtuJiZuLkJ1dHRvbnMmJlwiZnVuY3Rpb25cIj09dHlwZW9mIG4uQnV0dG9ucz90aGlzLnJlbmRlckJ1dHRvbihpLHQpOmNvbnNvbGUuZXJyb3IoXCJbQkMgUGF5UGFsXTogUGF5UGFsIEJ1dHRvbiBjb3VsZCBub3QgYmUgcmVuZGVyZWQsIGR1ZSB0byBpc3N1ZXMgd2l0aCBsb2FkaW5nIFBheVBhbCBTREtcIil9KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9c2lnbkluKGUsdCl7cmV0dXJuIGd0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbkluQ3VzdG9tZXIoZSx0KX0pfXNpZ25PdXQoZSl7cmV0dXJuIGd0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbk91dEN1c3RvbWVyKGUpfSl9ZXhlY3V0ZVBheW1lbnRNZXRob2RDaGVja291dChlKXt2YXIgdDtyZXR1cm4gbnVsbD09PSh0PW51bGw9PWU/dm9pZCAwOmUuY29udGludWVXaXRoQ2hlY2tvdXRDYWxsYmFjayl8fHZvaWQgMD09PXR8fHQuY2FsbChlKSxQcm9taXNlLnJlc29sdmUoKX1yZW5kZXJCdXR0b24oZSx0KXtjb25zdHtjb250YWluZXI6aSxvbkNvbXBsZXRlOm4sb25DbGljazpvfT10LGE9dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5nZXRQYXlQYWxTZGtPclRocm93KCkscj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKSx7aXNIb3N0ZWRDaGVja291dEVuYWJsZWQ6cyxwYXltZW50QnV0dG9uU3R5bGVzOmQsaXNBcHBTd2l0Y2hFbmFibGVkOmx9PXIuaW5pdGlhbGl6YXRpb25EYXRhfHx7fSx7Y2hlY2tvdXRUb3BCdXR0b25TdHlsZXM6Y309ZHx8e30scD1PYmplY3QuYXNzaWduKHtjcmVhdGVPcmRlcjooKT0+dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5jcmVhdGVPcmRlcihcInBheXBhbGNvbW1lcmNlY3JlZGl0XCIpLG9uQXBwcm92ZTooe29yZGVySUQ6dH0pPT50aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLnRva2VuaXplUGF5bWVudChlLHQpfSxvJiZ7b25DbGljazooKT0+bygpfSksdT1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIWwmJntvblNoaXBwaW5nQWRkcmVzc0NoYW5nZTplPT50aGlzLm9uU2hpcHBpbmdBZGRyZXNzQ2hhbmdlKGUpLG9uU2hpcHBpbmdPcHRpb25zQ2hhbmdlOmU9PnRoaXMub25TaGlwcGluZ09wdGlvbnNDaGFuZ2UoZSl9KSx7b25BcHByb3ZlOih0LGkpPT50aGlzLm9uSG9zdGVkQ2hlY2tvdXRBcHByb3ZlKHQsaSxlLG4pfSksaD1bYS5GVU5ESU5HLlBBWUxBVEVSLGEuRlVORElORy5DUkVESVRdO2xldCB5PSExO2guZm9yRWFjaChlPT57aWYoIXkpe2NvbnN0IHQ9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHtmdW5kaW5nU291cmNlOmUsc3R5bGU6dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5nZXRWYWxpZEJ1dHRvblN0eWxlKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxjKSx7aGVpZ2h0OjQwfSkpfSxwKSxzJiZ1KSxuPWEuQnV0dG9ucyh0KTtuLmlzRWxpZ2libGUoKSYmKG4ucmVuZGVyKGAjJHtpfWApLHk9ITApfX0pLHl8fHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UucmVtb3ZlRWxlbWVudChpKX1vbkhvc3RlZENoZWNrb3V0QXBwcm92ZShlLHQsaSxuKXtyZXR1cm4gZ3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCFlLm9yZGVySUQpdGhyb3cgbmV3IHkobC5NaXNzaW5nT3JkZXJJZCk7Y29uc3Qgbz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDYXJ0T3JUaHJvdygpLGE9eWllbGQgdC5vcmRlci5nZXQoKTt0cnl7Y29uc3QgdD10aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldEJpbGxpbmdBZGRyZXNzRnJvbU9yZGVyRGV0YWlscyhhKTtpZih5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3ModCksby5saW5lSXRlbXMucGh5c2ljYWxJdGVtcy5sZW5ndGg+MCl7Y29uc3QgZT10aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFNoaXBwaW5nQWRkcmVzc0Zyb21PcmRlckRldGFpbHMoYSk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVNoaXBwaW5nQWRkcmVzcyhlKSx5aWVsZCB0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZU9yZGVyKCl9eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKHt9LHtwYXJhbXM6e21ldGhvZElkOml9fSkseWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGksZS5vcmRlcklEKSxuJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuJiZuKCl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX19KX1vblNoaXBwaW5nQWRkcmVzc0NoYW5nZShlKXtyZXR1cm4gZ3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5nZXRBZGRyZXNzKHtjaXR5OmUuc2hpcHBpbmdBZGRyZXNzLmNpdHksY291bnRyeUNvZGU6ZS5zaGlwcGluZ0FkZHJlc3MuY291bnRyeUNvZGUscG9zdGFsQ29kZTplLnNoaXBwaW5nQWRkcmVzcy5wb3N0YWxDb2RlLHN0YXRlT3JQcm92aW5jZUNvZGU6ZS5zaGlwcGluZ0FkZHJlc3Muc3RhdGV9KTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZUJpbGxpbmdBZGRyZXNzKHQpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVTaGlwcGluZ0FkZHJlc3ModCk7Y29uc3QgZT10aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFNoaXBwaW5nT3B0aW9uT3JUaHJvdygpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zZWxlY3RTaGlwcGluZ09wdGlvbihlLmlkKSx5aWVsZCB0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZU9yZGVyKCl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX19KX1vblNoaXBwaW5nT3B0aW9uc0NoYW5nZShlKXtyZXR1cm4gZ3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5nZXRTaGlwcGluZ09wdGlvbk9yVGhyb3coZS5zZWxlY3RlZFNoaXBwaW5nT3B0aW9uLmlkKTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNlbGVjdFNoaXBwaW5nT3B0aW9uKHQuaWQpLHlpZWxkIHRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlT3JkZXIoKX1jYXRjaChlKXt0aGlzLmhhbmRsZUVycm9yKGUpfX0pfWhhbmRsZUVycm9yKGUpe2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIHRoaXMub25FcnJvcil0aHJvdyBlO3RoaXMub25FcnJvcihlKX19Y29uc3QgZnQ9cChlPT5uZXcgdnQoZSxOKGUpKSxbe2lkOlwicGF5cGFsY29tbWVyY2VjcmVkaXRcIn1dKTt2YXIgU3Q9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24obyxhKXtmdW5jdGlvbiByKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9vKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4ocixzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgSXR7Y29uc3RydWN0b3IoZSx0KXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlPXR9aW5pdGlhbGl6ZShlKXtyZXR1cm4gU3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheXBhbGNvbW1lcmNldmVubW86dCxtZXRob2RJZDppfT1lO2lmKCFpKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCF0KXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLnBheXBhbGNvbW1lcmNldmVubW9cIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIXQuY29udGFpbmVyKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLnBheXBhbGNvbW1lcmNldmVubW8uY29udGFpbmVyXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKHQub25DbGljayYmXCJmdW5jdGlvblwiIT10eXBlb2YgdC5vbkNsaWNrKXRocm93IG5ldyBfKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLnBheXBhbGNvbW1lcmNldmVubW8ub25DbGlja1wiIGFyZ3VtZW50IGlzIG5vdCBhIGZ1bmN0aW9uLicpO3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2QoaSl8fCh5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSkpO2NvbnN0IG49eWllbGQgdGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5sb2FkUGF5UGFsU2RrKGkpO24mJm4uQnV0dG9ucyYmXCJmdW5jdGlvblwiPT10eXBlb2Ygbi5CdXR0b25zP3RoaXMucmVuZGVyQnV0dG9uKGksdCk6Y29uc29sZS5lcnJvcihcIltCQyBQYXlQYWxdOiBQYXlQYWwgQnV0dG9uIGNvdWxkIG5vdCBiZSByZW5kZXJlZCwgZHVlIHRvIGlzc3VlcyB3aXRoIGxvYWRpbmcgUGF5UGFsIFNES1wiKX0pfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKX1zaWduSW4oZSx0KXtyZXR1cm4gU3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zaWduSW5DdXN0b21lcihlLHQpfSl9c2lnbk91dChlKXtyZXR1cm4gU3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zaWduT3V0Q3VzdG9tZXIoZSl9KX1leGVjdXRlUGF5bWVudE1ldGhvZENoZWNrb3V0KGUpe3ZhciB0O3JldHVybiBudWxsPT09KHQ9bnVsbD09ZT92b2lkIDA6ZS5jb250aW51ZVdpdGhDaGVja291dENhbGxiYWNrKXx8dm9pZCAwPT09dHx8dC5jYWxsKGUpLFByb21pc2UucmVzb2x2ZSgpfXJlbmRlckJ1dHRvbihlLHQpe2NvbnN0e2NvbnRhaW5lcjppLG9uQ2xpY2s6bn09dCxvPXRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5UGFsU2RrT3JUaHJvdygpLGE9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSkse3BheW1lbnRCdXR0b25TdHlsZXM6cn09YS5pbml0aWFsaXphdGlvbkRhdGF8fHt9LHtjaGVja291dFRvcEJ1dHRvblN0eWxlczpzfT1yfHx7fSxkPU9iamVjdC5hc3NpZ24oe2Z1bmRpbmdTb3VyY2U6by5GVU5ESU5HLlZFTk1PLHN0eWxlOnRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0VmFsaWRCdXR0b25TdHlsZShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scykse2hlaWdodDo0MH0pKSxjcmVhdGVPcmRlcjooKT0+dGhpcy5wYXlwYWxDb21tZXJjZUludGVncmF0aW9uU2VydmljZS5jcmVhdGVPcmRlcihcInBheXBhbGNvbW1lcmNldmVubW9cIiksb25BcHByb3ZlOih7b3JkZXJJRDp0fSk9PnRoaXMucGF5cGFsQ29tbWVyY2VJbnRlZ3JhdGlvblNlcnZpY2UudG9rZW5pemVQYXltZW50KGUsdCl9LG4mJntvbkNsaWNrOigpPT5uKCl9KSxsPW8uQnV0dG9ucyhkKTtsLmlzRWxpZ2libGUoKT9sLnJlbmRlcihgIyR7aX1gKTp0aGlzLnBheXBhbENvbW1lcmNlSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQoaSl9fWNvbnN0IHd0PXAoZT0+bmV3IEl0KGUsTihlKSksW3tpZDpcInBheXBhbGNvbW1lcmNldmVubW9cIn1dKTt2YXIgYnQ9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24obyxhKXtmdW5jdGlvbiByKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7YShlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXthKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9vKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4ocixzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgUHR7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMucGF5cGFsU2RrU2NyaXB0TG9hZGVyPXQsdGhpcy5wYXlwYWxGYXN0bGFuZVV0aWxzPWl9aW5pdGlhbGl6ZShlKXt2YXIgdDtyZXR1cm4gYnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e21ldGhvZElkOmkscGF5cGFsY29tbWVyY2VmYXN0bGFuZTpufT1lO2lmKCFpKXRocm93IG5ldyBfKCdVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIFwibWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7dHJ5e3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKTtjb25zdCBlPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG89ZS5nZXRDYXJ0T3JUaHJvdygpLGE9ZS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSxyPSEhKG51bGw9PT0odD1hLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuaXNEZXZlbG9wZXJNb2RlQXBwbGljYWJsZSkscz15aWVsZCB0aGlzLnBheXBhbFNka1NjcmlwdExvYWRlci5nZXRQYXlQYWxGYXN0bGFuZVNkayhhLG8uY3VycmVuY3kuY29kZSxvLmlkKTt5aWVsZCB0aGlzLnBheXBhbEZhc3RsYW5lVXRpbHMuaW5pdGlhbGl6ZVBheVBhbEZhc3RsYW5lKHMscix0aGlzLmdldEZhc3RsYW5lU3R5bGVzKGksbikpfWNhdGNoKGUpe31yZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gYnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKX0pfXNpZ25JbihlLHQpe3JldHVybiBidCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25JbkN1c3RvbWVyKGUsdCl9KX1zaWduT3V0KGUpe3JldHVybiBidCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25PdXRDdXN0b21lcihlKX0pfWV4ZWN1dGVQYXltZW50TWV0aG9kQ2hlY2tvdXQoZSl7cmV0dXJuIGJ0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtjaGVja291dFBheW1lbnRNZXRob2RFeGVjdXRlZDp0LGNvbnRpbnVlV2l0aENoZWNrb3V0Q2FsbGJhY2s6aSxtZXRob2RJZDpufT1lfHx7fTtpZighbil0aHJvdyBuZXcgXygnVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBcIm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIGkpdGhyb3cgbmV3IF8oJ1VuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgXCJjb250aW51ZVdpdGhDaGVja291dENhbGxiYWNrXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkIGFuZCBpdCBtdXN0IGJlIGEgZnVuY3Rpb24uJyk7aWYodGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q3VzdG9tZXJPclRocm93KCkuaXNHdWVzdCl7dCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdCYmdCgpO3RyeXt5aWVsZCB0aGlzLnJ1blBheVBhbEF1dGhlbnRpY2F0aW9uRmxvd09yVGhyb3cobil9Y2F0Y2goZSl7fX1pKCl9KX1ydW5QYXlQYWxBdXRoZW50aWNhdGlvbkZsb3dPclRocm93KGUpe3JldHVybiBidCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxpPXQuZ2V0Q2FydE9yVGhyb3coKS5pZCxuPXQuZ2V0Q3VzdG9tZXIoKSxvPXQuZ2V0QmlsbGluZ0FkZHJlc3MoKSxhPShudWxsPT1uP3ZvaWQgMDpuLmVtYWlsKXx8KG51bGw9PW8/dm9pZCAwOm8uZW1haWwpfHxcIlwiLHtjdXN0b21lckNvbnRleHRJZDpyfT15aWVsZCB0aGlzLnBheXBhbEZhc3RsYW5lVXRpbHMubG9va3VwQ3VzdG9tZXJPclRocm93KGEpLHM9eWllbGQgdGhpcy5wYXlwYWxGYXN0bGFuZVV0aWxzLnRyaWdnZXJBdXRoZW50aWNhdGlvbkZsb3dPclRocm93KHIpLGQ9cy5hdXRoZW50aWNhdGlvblN0YXRlPT09Vy5DQU5DRUxFRDt5aWVsZCB0aGlzLnVwZGF0ZUN1c3RvbWVyRGF0YVN0YXRlKGUscyksZD90aGlzLnBheXBhbEZhc3RsYW5lVXRpbHMucmVtb3ZlU3RvcmFnZVNlc3Npb25JZCgpOnRoaXMucGF5cGFsRmFzdGxhbmVVdGlscy51cGRhdGVTdG9yYWdlU2Vzc2lvbklkKGkpfSl9dXBkYXRlQ3VzdG9tZXJEYXRhU3RhdGUoZSx0KXt2YXIgaTtyZXR1cm4gYnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKSx7YXV0aGVudGljYXRpb25TdGF0ZTpvLGFkZHJlc3NlczphLGJpbGxpbmdBZGRyZXNzOnIsc2hpcHBpbmdBZGRyZXNzOnMsaW5zdHJ1bWVudHM6ZH09dGhpcy5wYXlwYWxGYXN0bGFuZVV0aWxzLm1hcFBheVBhbEZhc3RsYW5lUHJvZmlsZVRvQmNDdXN0b21lckRhdGEoZSx0KTtpZih5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlUGF5bWVudFByb3ZpZGVyQ3VzdG9tZXIoe2F1dGhlbnRpY2F0aW9uU3RhdGU6byxhZGRyZXNzZXM6YSxpbnN0cnVtZW50czpkfSksciYmKHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVCaWxsaW5nQWRkcmVzcyhyKSkscyYmbi5saW5lSXRlbXMucGh5c2ljYWxJdGVtcy5sZW5ndGg+MCl7Y29uc3QgdD15aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlU2hpcHBpbmdBZGRyZXNzKHMpLG49dC5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKSx7aXNGYXN0bGFuZVNoaXBwaW5nT3B0aW9uQXV0b1NlbGVjdEVuYWJsZWQ6b309bi5pbml0aWFsaXphdGlvbkRhdGF8fHt9LGE9dC5nZXRDb25zaWdubWVudHMoKXx8W10scj0obnVsbD09PShpPWFbMF0pfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmF2YWlsYWJsZVNoaXBwaW5nT3B0aW9ucyl8fFtdLGQ9clswXSxsPXIuZmluZChlPT5lLmlzUmVjb21tZW5kZWQpO2lmKChsfHxkKSYmbyl7Y29uc3QgZT0obnVsbD09bD92b2lkIDA6bC5pZCl8fGQuaWQ7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNlbGVjdFNoaXBwaW5nT3B0aW9uKGUpfX19KX1nZXRGYXN0bGFuZVN0eWxlcyhlLHQpe2NvbnN0IGk9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSkse2Zhc3RsYW5lU3R5bGVzOm4saXNGYXN0bGFuZVN0eWxpbmdFbmFibGVkOm99PWkuaW5pdGlhbGl6YXRpb25EYXRhfHx7fTtyZXR1cm4gZHQobz9uOnt9LG51bGw9PXQ/dm9pZCAwOnQuc3R5bGVzKX19Y29uc3QgQ3Q9cChlPT5uZXcgUHQoZSxRKCksWWUoKSksW3tpZDpcInBheXBhbGNvbW1lcmNlYWNjZWxlcmF0ZWRjaGVja291dFwifSx7aWQ6XCJwYXlwYWxjb21tZXJjZWNyZWRpdGNhcmRzXCJ9XSk7ZXhwb3J0e3llIGFzIGNyZWF0ZVBheVBhbENvbW1lcmNlQWx0ZXJuYXRpdmVNZXRob2RzQnV0dG9uU3RyYXRlZ3ksUmUgYXMgY3JlYXRlUGF5UGFsQ29tbWVyY2VBbHRlcm5hdGl2ZU1ldGhvZHNQYXltZW50U3RyYXRlZ3ksViBhcyBjcmVhdGVQYXlQYWxDb21tZXJjZUJ1dHRvblN0cmF0ZWd5LGRlIGFzIGNyZWF0ZVBheVBhbENvbW1lcmNlQ3JlZGl0QnV0dG9uU3RyYXRlZ3ksbnQgYXMgY3JlYXRlUGF5UGFsQ29tbWVyY2VDcmVkaXRDYXJkc1BheW1lbnRTdHJhdGVneSxmdCBhcyBjcmVhdGVQYXlQYWxDb21tZXJjZUNyZWRpdEN1c3RvbWVyU3RyYXRlZ3ksRGUgYXMgY3JlYXRlUGF5UGFsQ29tbWVyY2VDcmVkaXRQYXltZW50U3RyYXRlZ3ksbXQgYXMgY3JlYXRlUGF5UGFsQ29tbWVyY2VDdXN0b21lclN0cmF0ZWd5LEN0IGFzIGNyZWF0ZVBheVBhbENvbW1lcmNlRmFzdGxhbmVDdXN0b21lclN0cmF0ZWd5LHV0IGFzIGNyZWF0ZVBheVBhbENvbW1lcmNlRmFzdGxhbmVQYXltZW50U3RyYXRlZ3ksemUgYXMgY3JlYXRlUGF5UGFsQ29tbWVyY2VQYXltZW50U3RyYXRlZ3kscnQgYXMgY3JlYXRlUGF5UGFsQ29tbWVyY2VSYXRlUGF5UGF5bWVudFN0cmF0ZWd5LHBlIGFzIGNyZWF0ZVBheVBhbENvbW1lcmNlVmVubW9CdXR0b25TdHJhdGVneSx3dCBhcyBjcmVhdGVQYXlQYWxDb21tZXJjZVZlbm1vQ3VzdG9tZXJTdHJhdGVneSxfZSBhcyBjcmVhdGVQYXlQYWxDb21tZXJjZVZlbm1vUGF5bWVudFN0cmF0ZWd5fTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBheXBhbC1jb21tZXJjZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///../checkout-sdk-js/dist/esm/integrations/paypal-commerce.js\n\n}");

/***/ })

}]);