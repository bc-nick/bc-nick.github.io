"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonpCheckout"] = self["webpackJsonpCheckout"] || []).push([["checkout-sdk-js_dist_esm_integrations_stripe_js"],{

/***/ "../checkout-sdk-js/dist/esm/integrations/stripe.js":
/*!**********************************************************!*\
  !*** ../checkout-sdk-js/dist/esm/integrations/stripe.js ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLinkV2ButtonStrategy: () => (/* binding */ j),\n/* harmony export */   createStripeCSPaymentStrategy: () => (/* binding */ _e),\n/* harmony export */   createStripeLinkV2CustomerStrategy: () => (/* binding */ Pe),\n/* harmony export */   createStripeOCSPaymentStrategy: () => (/* binding */ ge),\n/* harmony export */   createStripeUPECustomerStrategy: () => (/* binding */ Ce),\n/* harmony export */   createStripeUPEPaymentStrategy: () => (/* binding */ he),\n/* harmony export */   createStripeV3PaymentStrategy: () => (/* binding */ ie)\n/* harmony export */ });\n/* harmony import */ var _bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @bigcommerce/script-loader */ \"../checkout-sdk-js/node_modules/@bigcommerce/script-loader/lib/index.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash */ \"../checkout-sdk-js/node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_1__);\nvar s,a,d,l,c,u,h,p,m,y,g={};function v(e,t){return Object.assign(e,{resolveIds:t})}g.d=(e,t)=>{for(var i in t)g.o(t,i)&&!g.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},g.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);class S extends Error{constructor(e){var t;super(e||\"An unexpected error has occurred.\"),this.name=\"StandardError\",this.type=\"standard\",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,\"function\"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class _ extends S{constructor(e){super(e||\"Unable to proceed because the client library of a payment method is not loaded or ready to be used.\"),this.name=\"PaymentMethodClientUnavailableError\",this.type=\"payment_method_client_unavailable\"}}!function(e){e.SHIPPING=\"shipping\",e.BILLING=\"billing\"}(s||(s={})),function(e){e.SPLIT=\"split\",e.FULL=\"full\",e.ORGANIZATION=\"organization\"}(a||(a={})),function(e){e.SUCCESS=\"success\",e.ERROR=\"error\"}(d||(d={})),function(e){e.CreditCard=\"card\",e.Link=\"link\",e.EPS=\"eps\",e.GRABPAY=\"grabpay\",e.BANCONTACT=\"bancontact\",e.IDEAL=\"ideal\",e.ALIPAY=\"alipay\",e.KLARNA=\"klarna\",e.OCS=\"optimized_checkout\"}(l||(l={})),function(e){e.NEVER=\"never\",e.AUTO=\"auto\",e.ALWAYS=\"always\",e.PAYMENT=\"payment\",e.IF_REQUIRED=\"if_required\"}(c||(c={})),function(e){e.V3=\"v3\",e.ACACIA=\"acacia\",e.BASIL=\"basil\",e.CLOVER=\"clover\"}(u||(u={})),function(e){e.PAYMENT=\"payment\",e.AUTHENTICATION=\"linkAuthentication\",e.SHIPPING=\"address\",e.EXPRESS_CHECKOUT=\"expressCheckout\"}(h||(h={})),function(e){e.REQUIRES_PAYMENT_METHOD=\"requires_payment_method\",e.REQUIRES_CONFIRMATION=\"requires_confirmation\",e.REQUIRES_ACTION=\"requires_action\",e.PROCESSING=\"processing\",e.SUCCEEDED=\"succeeded\",e.CANCELED=\"canceled\"}(p||(p={})),function(e){e.CLICK=\"click\",e.CHANGE=\"change\",e.READY=\"ready\",e.SHIPPING_ADDRESS_CHANGE=\"shippingaddresschange\",e.SHIPPING_RATE_CHANGE=\"shippingratechange\",e.CONFIRM=\"confirm\",e.CANCEL=\"cancel\",e.LOADER_START=\"loaderstart\"}(m||(m={})),function(e){e.ON_SESSION=\"on_session\",e.OFF_SESSION=\"off_session\"}(y||(y={}));var f,C,E=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{d(n.next(e))}catch(e){o(e)}}function a(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(s,a)}d((n=n.apply(e,t||[])).next())})};class I{constructor(e,t=window){this.scriptLoader=e,this.stripeWindow=t}getStripeClient(e,t,i,n,r){return E(this,void 0,void 0,function*(){if(this.stripeWindow.bcStripeClient)return this.stripeWindow.bcStripeClient;const o=yield this.load(i),{stripePublishableKey:s,stripeConnectedAccount:a}=e,d=o(s,Object.assign(Object.assign(Object.assign(Object.assign({},a?{stripeAccount:a}:{}),t?{locale:t}:{}),n?{betas:n}:{}),r?{apiVersion:r}:{}));return Object.assign(this.stripeWindow,{bcStripeClient:d}),d})}getElements(e,t){return E(this,void 0,void 0,function*(){let i=this.stripeWindow.bcStripeElements;return i?yield this.updateStripeElements(t):(i=e.elements(t),Object.assign(this.stripeWindow,{bcStripeElements:i})),i})}updateStripeElements(e){return E(this,void 0,void 0,function*(){const t=this.stripeWindow.bcStripeElements;t&&(t.update(e),yield t.fetchUpdates())})}getCheckoutSession(e,t){return E(this,void 0,void 0,function*(){let i=this.stripeWindow.bcStripeCheckoutSession;return i||(i=yield e.initCheckout(t),Object.assign(this.stripeWindow,{bcStripeCheckoutSession:i})),i})}load(e){return E(this,void 0,void 0,function*(){if(!this.stripeWindow.Stripe&&(yield this.scriptLoader.loadScript(this.getScriptUrl(e)),!this.stripeWindow.Stripe))throw new _;return this.stripeWindow.Stripe})}getScriptUrl(e){return e&&e!==u.V3?`https://js.stripe.com/${e}/stripe.js`:\"https://js.stripe.com/v3/\"}}class P extends S{constructor(e){super(e||\"Payment process was cancelled.\"),this.name=\"PaymentMethodCancelledError\",this.type=\"payment_cancelled\"}}class b extends S{constructor(e){super(e||\"Unable to proceed because the client library of a payment method has thrown an unexpected error.\"),this.name=\"PaymentMethodFailedError\",this.type=\"payment_method_client_invalid\"}}!function(e){e[e.CheckoutButtonNotInitialized=0]=\"CheckoutButtonNotInitialized\",e[e.CustomerNotInitialized=1]=\"CustomerNotInitialized\",e[e.PaymentNotInitialized=2]=\"PaymentNotInitialized\",e[e.ShippingNotInitialized=3]=\"ShippingNotInitialized\",e[e.SpamProtectionNotInitialized=4]=\"SpamProtectionNotInitialized\"}(f||(f={}));class w extends S{constructor(e){super(function(e){switch(e){case f.CustomerNotInitialized:return\"Unable to proceed because the customer step of checkout has not been initialized.\";case f.PaymentNotInitialized:return\"Unable to proceed because the payment step of checkout has not been initialized.\";case f.ShippingNotInitialized:return\"Unable to proceed because the shipping step of checkout has not been initialized.\";case f.SpamProtectionNotInitialized:return\"Unable to proceed because the checkout spam protection has not been initialized.\";default:return\"Unable to proceed because the required component has not been initialized.\"}}(e)),this.subtype=e,this.name=\"NotInitializedError\",this.type=\"not_initialized\"}}!function(e){e[e.MissingBillingAddress=0]=\"MissingBillingAddress\",e[e.MissingCart=1]=\"MissingCart\",e[e.MissingCheckout=2]=\"MissingCheckout\",e[e.MissingConsignments=3]=\"MissingConsignments\",e[e.MissingCustomer=4]=\"MissingCustomer\",e[e.MissingCheckoutConfig=5]=\"MissingCheckoutConfig\",e[e.MissingOrder=6]=\"MissingOrder\",e[e.MissingOrderConfig=7]=\"MissingOrderConfig\",e[e.MissingOrderId=8]=\"MissingOrderId\",e[e.MissingPayment=9]=\"MissingPayment\",e[e.MissingPaymentId=10]=\"MissingPaymentId\",e[e.MissingPaymentInstrument=11]=\"MissingPaymentInstrument\",e[e.MissingPaymentMethod=12]=\"MissingPaymentMethod\",e[e.MissingPaymentRedirectUrl=13]=\"MissingPaymentRedirectUrl\",e[e.MissingPaymentStatus=14]=\"MissingPaymentStatus\",e[e.MissingPaymentToken=15]=\"MissingPaymentToken\",e[e.MissingShippingAddress=16]=\"MissingShippingAddress\"}(C||(C={}));class A extends S{constructor(e){super(function(e){switch(e){case C.MissingBillingAddress:return\"Unable to proceed because billing address data is unavailable.\";case C.MissingCart:return\"Unable to proceed because cart data is unavailable.\";case C.MissingConsignments:return\"Unable to proceed because consignments data is unavailable.\";case C.MissingCheckout:return\"Unable to proceed because checkout data is unavailable.\";case C.MissingCustomer:return\"Unable to proceed because customer data is unavailable.\";case C.MissingCheckoutConfig:case C.MissingOrderConfig:return\"Unable to proceed because configuration data is unavailable.\";case C.MissingOrder:return\"Unable to proceed because order data is unavailable.\";case C.MissingOrderId:return\"Unable to proceed because order ID is unavailable or not generated yet.\";case C.MissingPayment:return\"Unable to proceed because payment data is unavailable.\";case C.MissingPaymentToken:return\"Unable to proceed because the token required to submit a payment is missing.\";case C.MissingPaymentMethod:return\"Unable to proceed because payment method data is unavailable or not properly configured.\";case C.MissingShippingAddress:return\"Unable to proceed because shipping address data is unavailable.\";default:return\"Unable to proceed because the required data is unavailable.\"}}(e)),this.subtype=e,this.name=\"MissingDataError\",this.type=\"missing_data\"}}var O=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{d(n.next(e))}catch(e){o(e)}}function a(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(s,a)}d((n=n.apply(e,t||[])).next())})};class M{constructor(e,t){this.paymentIntegrationService=e,this.scriptLoader=t,this.isMounted=!1}deinitialize(){var e;null===(e=this.checkoutEventsUnsubscribe)||void 0===e||e.call(this),this.isMounted=!1}initCheckoutEventsSubscription(e,t,i,n){this.checkoutEventsUnsubscribe=this.paymentIntegrationService.subscribe(()=>O(this,void 0,void 0,function*(){var r;const o=null==n?void 0:n.getElement(h.PAYMENT);if(o){try{yield this.updateStripePaymentIntent(e,t)}catch(e){return this.isMounted&&(o.unmount(),this.isMounted=!1),void(e instanceof Error&&(null===(r=i.onError)||void 0===r||r.call(i,e)))}this.isMounted||(yield null==n?void 0:n.fetchUpdates(),this.mountElement(o,i.containerId))}}),e=>{var t;return null===(t=e.getCheckout())||void 0===t?void 0:t.outstandingBalance},e=>{var t;return null===(t=e.getCheckout())||void 0===t?void 0:t.coupons})}mountElement(e,t){document.getElementById(t)&&(e.mount(`#${t}`),this.isMounted=!0)}mapAppearanceVariables(e){return{colorPrimary:e.fieldInnerShadow,colorBackground:e.fieldBackground,colorText:e.labelText,colorDanger:e.fieldErrorText,colorTextSecondary:e.labelText,colorTextPlaceholder:e.fieldPlaceholderText,colorIcon:e.fieldPlaceholderText}}mapInputAppearanceRules(e){return{borderColor:e.fieldBorder,color:e.fieldText,boxShadow:e.fieldInnerShadow}}throwStripeError(e){if(\"object\"==typeof(t=e)&&null!==t&&\"type\"in t&&(this.throwDisplayableStripeError(e),this.isCancellationError(e)))throw new P;var t;throw new b}throwDisplayableStripeError(e){if((0,lodash__WEBPACK_IMPORTED_MODULE_1__.includes)([\"card_error\",\"invalid_request_error\",\"validation_error\"],e.type))throw new Error(e.message)}isCancellationError(e){var t;const i=null===(t=null==e?void 0:e.payment_intent.last_payment_error)||void 0===t?void 0:t.message;return!!i&&-1!==i.indexOf(\"canceled\")}throwPaymentConfirmationProceedMessage(){throw new b(\"We've received your order and are processing your payment. Once the payment is verified, your order will be completed. We will send you an email when it's completed. Please note, this process may take a few minutes depending on the processing times of your chosen method.\")}isPaymentCompleted(e,t){return O(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState(),n=i.getPaymentMethodOrThrow(e),{features:r}=i.getStoreConfigOrThrow().checkoutSettings;if(!n.clientToken||!t||!r[\"PI-626.Block_unnecessary_payment_confirmation_for_StripeUPE\"])return!1;const{paymentIntent:o}=yield t.retrievePaymentIntent(n.clientToken);return(null==o?void 0:o.status)===p.SUCCEEDED})}mapStripePaymentData(e,t,i=!1){const n=this.paymentIntegrationService.getState().getBillingAddress(),{firstName:r=\"\",lastName:o=\"\",email:s=\"\"}=n||{},a=this._mapStripeAddress(n);if(!e)throw new w(f.PaymentNotInitialized);if(!(s&&a&&a.city&&a.country&&r&&o))throw new A(C.MissingBillingAddress);return{elements:e,redirect:c.IF_REQUIRED,confirmParams:Object.assign({payment_method_data:Object.assign(Object.assign({},i?{allow_redisplay:\"always\"}:{}),{billing_details:{email:s,address:a,name:`${r} ${o}`}})},t&&{return_url:t})}}isAdditionalActionError(e){return (0,lodash__WEBPACK_IMPORTED_MODULE_1__.some)(e,{code:\"additional_action_required\"})}isRedirectAction(e){const{type:t,data:{redirect_url:i}}=e;return\"redirect_to_url\"===t&&!!i}isOnPageAdditionalAction(e){const{type:t,data:{token:i}}=e;return\"additional_action_requires_payment_method\"===t&&!!i}updateStripePaymentIntent(e,t){return O(this,void 0,void 0,function*(){const i=yield this.paymentIntegrationService.loadPaymentMethod(e,{params:{method:t}}),{clientToken:n}=i.getPaymentMethodOrThrow(t);n&&this.scriptLoader.updateStripeElements({clientSecret:n})})}getStripeJsVersion(e){return e.useNewStripeJsVersion?u.CLOVER:u.V3}_mapStripeAddress(e){if(e){const{city:t,address1:i,address2:n,countryCode:r,postalCode:o,stateOrProvinceCode:s}=e;return Object.assign({city:t,country:r,postal_code:o,line1:i,line2:n},s?{state:s}:{})}throw new A(C.MissingBillingAddress)}}const k={size:70,color:\"#d9d9d9\",backgroundColor:\"#ffffff\"},T={position:\"fixed\",\"background-color\":\"rgba(0, 0, 0, 0.4)\",\"z-index\":\"1000\"},N=\"embedded-checkout-loading-indicator-rotation\";class R{constructor(e){this.styles=Object.assign(Object.assign({},k),e&&e.styles),this.containerStyles=Object.assign({},e&&e.containerStyles),this.defineAnimation(),this.container=this.buildContainer(),this.indicator=this.buildIndicator(),this.container.appendChild(this.indicator)}show(e){if(e){const t=document.getElementById(e);if(!t)throw new Error(\"Unable to attach the loading indicator because the parent ID is not valid.\");t.appendChild(this.container)}this.container.style.visibility=\"visible\",this.container.style.opacity=\"1\"}hide(){const e=()=>{this.container.style.visibility=\"hidden\",this.container.removeEventListener(\"transitionend\",e)};this.container.addEventListener(\"transitionend\",e),this.container.style.opacity=\"0\"}buildContainer(){const e=document.createElement(\"div\");return e.style.display=\"block\",e.style.bottom=\"0\",e.style.left=\"0\",e.style.height=\"100%\",e.style.width=\"100%\",e.style.position=\"absolute\",e.style.right=\"0\",e.style.top=\"0\",e.style.transition=\"all 250ms ease-out\",e.style.opacity=\"0\",this.setStyleAttribute(e,this.containerStyles),e}buildIndicator(){const e=document.createElement(\"div\");return e.style.display=\"block\",e.style.width=`${this.styles.size}px`,e.style.height=`${this.styles.size}px`,e.style.borderRadius=`${this.styles.size}px`,e.style.border=\"solid 1px\",e.style.borderColor=`${this.styles.backgroundColor} ${this.styles.backgroundColor} ${this.styles.color} ${this.styles.color}`,e.style.margin=\"0 auto\",e.style.position=\"absolute\",e.style.left=\"0\",e.style.right=\"0\",e.style.top=\"50%\",e.style.transform=\"translateY(-50%) rotate(0deg)\",e.style.transformStyle=\"preserve-3d\",e.style.animation=`${N} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`,e}setStyleAttribute(e,t){Object.keys(t).forEach(i=>{e.style.setProperty(i,t[i])})}defineAnimation(){var e;if(document.getElementById(N))return;const t=document.createElement(\"style\");t.id=N,null===(e=document.head)||void 0===e||e.appendChild(t),t.sheet instanceof CSSStyleSheet&&t.sheet.insertRule(`\\n                @keyframes ${N} {\\n                    0% { transform: translateY(-50%) rotate(0deg); }\\n                    100% { transform: translateY(-50%) rotate(360deg); }\\n                }\\n            `,0)}}const D=e=>\"object\"==typeof e&&null!==e&&\"body\"in e;class z{constructor(e){this._decimalPlaces=e}toInteger(e){return Math.round(e*Math.pow(10,this._decimalPlaces))}}function L(e){return\"object\"==typeof e&&null!==e&&\"initializationData\"in e&&void 0!==e.initializationData&&null!==e.initializationData&&\"object\"==typeof e.initializationData&&\"stripePublishableKey\"in e.initializationData&&\"stripeConnectedAccount\"in e.initializationData&&\"shopperLanguage\"in e.initializationData&&void 0!==e.initializationData.stripePublishableKey&&void 0!==e.initializationData.stripeConnectedAccount&&void 0!==e.initializationData.shopperLanguage}const U=[\"AC\",\"AD\",\"AE\",\"AF\",\"AG\",\"AI\",\"AL\",\"AM\",\"AO\",\"AQ\",\"AR\",\"AT\",\"AU\",\"AW\",\"AX\",\"AZ\",\"BA\",\"BB\",\"BD\",\"BE\",\"BF\",\"BG\",\"BH\",\"BI\",\"BJ\",\"BL\",\"BM\",\"BN\",\"BO\",\"BQ\",\"BR\",\"BS\",\"BT\",\"BV\",\"BW\",\"BY\",\"BZ\",\"CA\",\"CD\",\"CF\",\"CG\",\"CH\",\"CI\",\"CK\",\"CL\",\"CM\",\"CN\",\"CO\",\"CR\",\"CV\",\"CW\",\"CY\",\"CZ\",\"DE\",\"DJ\",\"DK\",\"DM\",\"DO\",\"DZ\",\"EC\",\"EE\",\"EG\",\"EH\",\"ER\",\"ES\",\"ET\",\"FI\",\"FJ\",\"FK\",\"FO\",\"FR\",\"GA\",\"GB\",\"GD\",\"GE\",\"GF\",\"GG\",\"GH\",\"GI\",\"GL\",\"GM\",\"GN\",\"GP\",\"GQ\",\"GR\",\"GS\",\"GT\",\"GU\",\"GW\",\"GY\",\"HK\",\"HN\",\"HR\",\"HT\",\"HU\",\"ID\",\"IE\",\"IL\",\"IM\",\"IN\",\"IO\",\"IQ\",\"IS\",\"IT\",\"JE\",\"JM\",\"JO\",\"JP\",\"KE\",\"KG\",\"KH\",\"KI\",\"KM\",\"KN\",\"KR\",\"KW\",\"KY\",\"KZ\",\"LA\",\"LB\",\"LC\",\"LI\",\"LK\",\"LR\",\"LS\",\"LT\",\"LU\",\"LV\",\"LY\",\"MA\",\"MC\",\"MD\",\"ME\",\"MF\",\"MG\",\"MK\",\"ML\",\"MM\",\"MN\",\"MO\",\"MQ\",\"MR\",\"MS\",\"MT\",\"MU\",\"MV\",\"MW\",\"MX\",\"MY\",\"MZ\",\"NA\",\"NC\",\"NE\",\"NG\",\"NI\",\"NL\",\"NO\",\"NP\",\"NR\",\"NU\",\"NZ\",\"OM\",\"PA\",\"PE\",\"PF\",\"PG\",\"PH\",\"PK\",\"PL\",\"PM\",\"PN\",\"PR\",\"PS\",\"PT\",\"PY\",\"QA\",\"RE\",\"RO\",\"RS\",\"RU\",\"RW\",\"SA\",\"SB\",\"SC\",\"SD\",\"SE\",\"SG\",\"SH\",\"SI\",\"SJ\",\"SK\",\"SL\",\"SM\",\"SN\",\"SO\",\"SR\",\"SS\",\"ST\",\"SV\",\"SX\",\"SZ\",\"TA\",\"TC\",\"TD\",\"TF\",\"TG\",\"TH\",\"TJ\",\"TK\",\"TL\",\"TM\",\"TN\",\"TO\",\"TR\",\"TT\",\"TV\",\"TW\",\"TZ\",\"UA\",\"UG\",\"US\",\"UY\",\"UZ\",\"VA\",\"VC\",\"VE\",\"VG\",\"VN\",\"VU\",\"WF\",\"WS\",\"XK\",\"YE\",\"YT\",\"ZA\",\"ZM\",\"ZW\",\"ZZ\"];var V=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{d(n.next(e))}catch(e){o(e)}}function a(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(s,a)}d((n=n.apply(e,t||[])).next())})};class x{constructor(e,t,i,n){this.paymentIntegrationService=e,this.scriptLoader=t,this.stripeIntegrationService=i,this.loadingIndicator=n}initialize(e){return V(this,void 0,void 0,function*(){const{stripeocs:t,containerId:i}=e||{};if(!t||!i)throw new w(f.PaymentNotInitialized);const{methodId:n,gatewayId:r}=t;if(!n||!r)throw new A(C.MissingPaymentMethod);const o=yield this.paymentIntegrationService.loadPaymentMethod(r,{params:{method:n}}),s=o.getPaymentMethodOrThrow(n,r),{loadingContainerId:a,buttonHeight:d,onComplete:l}=t;if(this._loadingIndicatorContainer=a,this._onComplete=l,!L(s))throw new A(C.MissingPaymentMethod);const{initializationData:c}=s,{captureMethod:u}=c,h=this.stripeIntegrationService.getStripeJsVersion(c);this._captureMethod=u,this._stripeClient=yield this.scriptLoader.getStripeClient(c,o.getCartLocale(),h),yield this.paymentIntegrationService.loadDefaultCheckout(),yield this._mountExpressCheckoutElement(i,this._stripeClient,d),this._initializeEvents(n)})}signIn(){return Promise.resolve()}signOut(){return Promise.resolve()}executePaymentMethodCheckout(){return Promise.resolve()}deinitialize(){return Promise.resolve()}_mountExpressCheckoutElement(e,t,i=40){return V(this,void 0,void 0,function*(){const n=this._shouldRequireShippingAddress(),r=Object.assign(Object.assign(Object.assign({shippingAddressRequired:n},n?{allowedShippingCountries:yield this._getAvailableCountries()}:{}),n?{shippingRates:[{id:\"_\",amount:0,displayName:\"Pending rates\"}]}:{}),{billingAddressRequired:!0,emailRequired:!0,phoneNumberRequired:!0,paymentMethods:{link:c.AUTO,applePay:c.NEVER,googlePay:c.NEVER,amazonPay:c.NEVER,paypal:c.NEVER,klarna:c.NEVER},buttonHeight:i}),{cartAmount:o=1}=this.paymentIntegrationService.getState().getCart()||{},s=Object.assign({mode:\"payment\",amount:this._toCents(o),currency:this._getCurrency()},this._captureMethod?{captureMethod:this._captureMethod}:{});this._stripeElements=t.elements(s),this._linkV2Element=this._stripeElements.create(h.EXPRESS_CHECKOUT,r),this._linkV2Element.mount(`#${e}`)})}_initializeEvents(e){this._linkV2Element&&(this._shouldRequireShippingAddress()&&(this._linkV2Element.on(m.SHIPPING_ADDRESS_CHANGE,e=>V(this,void 0,void 0,function*(){return this._onShippingAddressChange(e)})),this._linkV2Element.on(m.SHIPPING_RATE_CHANGE,e=>V(this,void 0,void 0,function*(){return this._onShippingRateChange(e)}))),this._linkV2Element.on(m.CONFIRM,t=>V(this,void 0,void 0,function*(){return this._onConfirm(t,e)})),this._linkV2Element.on(m.CANCEL,this._onCancel))}_onShippingAddressChange(e){return V(this,void 0,void 0,function*(){if(!(\"address\"in e))return;const t=e.address,i={firstName:\"\",lastName:\"\",phone:\"\",company:\"\",address1:\"\",address2:\"\",city:(null==t?void 0:t.city)||\"\",countryCode:(null==t?void 0:t.country)||\"\",postalCode:(null==t?void 0:t.postal_code)||\"\",stateOrProvince:(null==t?void 0:t.state)||\"\",stateOrProvinceCode:(null==t?void 0:t.state)||\"\",customFields:[]};yield this.paymentIntegrationService.updateShippingAddress(i);const n=yield this._getAvailableShippingOptions();yield this._updateDisplayedPrice(),(null==n?void 0:n.length)?e.resolve({shippingRates:n}):e.reject()})}_onCancel(){throw new P}_onShippingRateChange(e){return V(this,void 0,void 0,function*(){if(\"shippingRate\"in e){const{shippingRate:t}=e;yield this._handleShippingOptionChange(null==t?void 0:t.id),yield this._updateDisplayedPrice(),e.resolve({})}})}_onConfirm(e,t){return V(this,void 0,void 0,function*(){if(\"billingDetails\"in e&&\"shippingAddress\"in e&&this._stripeClient&&this._stripeElements){yield this._updateShippingAndBillingAddress(e),yield this.paymentIntegrationService.submitOrder();const i=this._getPaymentPayload(t);try{yield this.paymentIntegrationService.submitPayment(i)}catch(e){yield this._processAdditionalAction(e,t)}}return Promise.resolve()})}_updateShippingAndBillingAddress(e){var t,i,n,r,o,s,a,d;return V(this,void 0,void 0,function*(){const l=this._shouldRequireShippingAddress(),c=(null===(i=null===(t=e.shippingAddress)||void 0===t?void 0:t.name)||void 0===i?void 0:i.split(\" \")[0])||(null===(r=null===(n=e.billingDetails)||void 0===n?void 0:n.name)||void 0===r?void 0:r.split(\" \")[0])||\"\",u=(null===(s=null===(o=e.shippingAddress)||void 0===o?void 0:o.name)||void 0===s?void 0:s.split(\" \")[1])||(null===(d=null===(a=e.billingDetails)||void 0===a?void 0:a.name)||void 0===d?void 0:d.split(\" \")[1])||\"\";if(l){const t=this._mapShippingAddress(e.shippingAddress,e.billingDetails,c,u);yield this.paymentIntegrationService.updateShippingAddress(t)}const h=this._mapBillingAddress(e.shippingAddress,e.billingDetails,c,u);yield this.paymentIntegrationService.updateBillingAddress(h)})}_mapShippingAddress(e,t,i,n){var r,o,s,a,d,l,c;return{firstName:i,lastName:n,phone:(null==t?void 0:t.phone)||\"\",company:\"\",address1:(null===(r=null==e?void 0:e.address)||void 0===r?void 0:r.line1)||\"\",address2:(null===(o=null==e?void 0:e.address)||void 0===o?void 0:o.line2)||\"\",city:(null===(s=null==e?void 0:e.address)||void 0===s?void 0:s.city)||\"\",countryCode:(null===(a=null==e?void 0:e.address)||void 0===a?void 0:a.country)||\"\",postalCode:(null===(d=null==e?void 0:e.address)||void 0===d?void 0:d.postal_code)||\"\",stateOrProvince:(null===(l=null==e?void 0:e.address)||void 0===l?void 0:l.state)||\"\",stateOrProvinceCode:(null===(c=null==e?void 0:e.address)||void 0===c?void 0:c.state)||\"\",customFields:[]}}_mapBillingAddress(e,t,i,n){var r,o,s,a,d,l;return{email:(null==t?void 0:t.email)||\"\",firstName:i,lastName:n,phone:(null==t?void 0:t.phone)||\"\",company:\"\",address1:(null===(r=null==t?void 0:t.address)||void 0===r?void 0:r.line1)||\"\",address2:\"\",city:(null===(o=null==t?void 0:t.address)||void 0===o?void 0:o.city)||\"\",countryCode:(null===(s=null==t?void 0:t.address)||void 0===s?void 0:s.country)||\"\",postalCode:(null===(a=null==t?void 0:t.address)||void 0===a?void 0:a.postal_code)||\"\",stateOrProvince:(null===(d=null==t?void 0:t.address)||void 0===d?void 0:d.state)||\"\",stateOrProvinceCode:(null===(l=null==e?void 0:e.address)||void 0===l?void 0:l.state)||\"\",customFields:[]}}_processAdditionalAction(e,t){return V(this,void 0,void 0,function*(){if(!D(e)||!this.stripeIntegrationService.isAdditionalActionError(e.body.errors))throw e;if(!this._stripeClient||!this._stripeElements)throw new w(f.PaymentNotInitialized);const{data:i}=e.body.additional_action_required,{token:n}=i,{paymentIntent:r}=yield this._confirmStripePaymentOrThrow(i,t),o=this._getPaymentPayload(t,(null==r?void 0:r.id)||n);try{this._toggleLoadingIndicator(!0),yield this.paymentIntegrationService.submitPayment(o),yield this._completeCheckoutFlow()}catch(e){this.stripeIntegrationService.throwPaymentConfirmationProceedMessage()}finally{this._toggleLoadingIndicator(!1)}})}_confirmStripePaymentOrThrow(e,t){var i,n,r;return V(this,void 0,void 0,function*(){const{token:o,redirect_url:s}=e,a=this.stripeIntegrationService.mapStripePaymentData(this._stripeElements,s);let d;try{const e=(yield this.stripeIntegrationService.isPaymentCompleted(t,this._stripeClient))?yield null===(r=this._stripeClient)||void 0===r?void 0:r.retrievePaymentIntent(o||\"\"):yield null===(i=this._stripeClient)||void 0===i?void 0:i.confirmPayment({elements:a.elements,clientSecret:o,redirect:c.IF_REQUIRED,confirmParams:{return_url:null===(n=a.confirmParams)||void 0===n?void 0:n.return_url}});if(d=null==e?void 0:e.error,d||!(null==e?void 0:e.paymentIntent))throw new b;return e}catch(e){return this.stripeIntegrationService.throwStripeError(d)}})}_completeCheckoutFlow(){return V(this,void 0,void 0,function*(){return\"function\"==typeof this._onComplete?this._onComplete():(window.location.replace(\"/checkout/order-confirmation\"),Promise.resolve())})}_getPaymentPayload(e,t){var i;const n=(null===(i=this.paymentIntegrationService.getState().getCart())||void 0===i?void 0:i.id)||\"\";return{methodId:e,paymentData:{formattedPayload:Object.assign(Object.assign({cart_id:n},t?{credit_card_token:{token:t}}:{}),{confirm:!1,method:l.Link})}}}_shouldRequireShippingAddress(){const{getCart:e}=this.paymentIntegrationService.getState(),{lineItems:t}=e()||{};return!!(null==t?void 0:t.physicalItems.length)}_updateDisplayedPrice(){return V(this,void 0,void 0,function*(){this._stripeElements&&this._stripeElements.update({currency:this._getCurrency(),mode:\"payment\",amount:yield this._getTotalPrice()})})}_getCurrency(){var e;if(!this._currencyCode){const t=null===(e=this.paymentIntegrationService.getState().getCart())||void 0===e?void 0:e.currency;t&&(this._currencyCode=t.code.toLowerCase())}return this._currencyCode}_getTotalPrice(){var e;return V(this,void 0,void 0,function*(){yield this.paymentIntegrationService.loadCheckout();const{getCheckoutOrThrow:t,getCart:i}=this.paymentIntegrationService.getState(),{decimalPlaces:n}=(null===(e=i())||void 0===e?void 0:e.currency)||{},o=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.round)(t().outstandingBalance,n).toFixed(n);return this._toCents(+o)})}_getAvailableCountries(){var e;return V(this,void 0,void 0,function*(){const t=yield this.paymentIntegrationService.loadShippingCountries();return((null===(e=t.getShippingCountries())||void 0===e?void 0:e.map(e=>e.code))||[]).filter(e=>U.includes(e))})}_getAvailableShippingOptions(){var e,t,i;return V(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState().getConsignments();if(!(null==n?void 0:n[0]))return;const r=n[0],o=(r.availableShippingOptions||[]).map(this._getStripeShippingOption.bind(this)),s=null===(e=r.availableShippingOptions)||void 0===e?void 0:e.find(e=>e.isRecommended),a=null===(t=r.selectedShippingOption)||void 0===t?void 0:t.id,d=null==s?void 0:s.id;return a?o.sort(e=>e.id===a?-1:0):d?(o.sort(e=>e.id===d?-1:0),yield this._handleShippingOptionChange(d)):yield this._handleShippingOptionChange(null===(i=o[0])||void 0===i?void 0:i.id),o})}_getStripeShippingOption({id:e,cost:t,description:i}){return{id:e,displayName:i,amount:this._toCents(t)}}_handleShippingOptionChange(e){return V(this,void 0,void 0,function*(){if(e&&\"shipping_option_unselected\"!==e)return this.paymentIntegrationService.selectShippingOption(e)})}_getAmountTransformer(){if(this._amountTransformer)return this._amountTransformer;const{getCart:e}=this.paymentIntegrationService.getState(),{currency:t}=e()||{};return t?new z(t.decimalPlaces):void 0}_toCents(e){const t=Math.round(100*e),i=this._getAmountTransformer();return i?i.toInteger(e):t}_toggleLoadingIndicator(e){e&&this._loadingIndicatorContainer?this.loadingIndicator.show(this._loadingIndicatorContainer):this.loadingIndicator.hide()}}const j=v(t=>{const i=new I((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)()),n=new R({containerStyles:T});return new x(t,i,new M(t,i),n)},[{id:\"stripeocs\"}]);class B extends S{constructor(e){super(e||\"Invalid arguments have been provided.\"),this.name=\"InvalidArgumentError\",this.type=\"invalid_argument\"}}class F extends B{constructor(e){let t=\"Unable to submit payment for the order because the payload is invalid.\";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(\", \")}.`),super(t),this.name=\"PaymentArgumentInvalidError\"}}function G(e){return!(\"object\"!=typeof e||null===e||void 0!==e.shouldSaveInstrument&&\"boolean\"!=typeof e.shouldSaveInstrument||void 0!==e.shouldSetAsDefaultInstrument&&\"boolean\"!=typeof e.shouldSetAsDefaultInstrument)}function H(e){return Boolean(e.instrumentId)}class q extends S{constructor(){super(\"The current order does not need to be finalized at this stage.\"),this.name=\"OrderFinalizationNotRequiredError\",this.type=\"order_finalization_not_required\"}}function W(e){return null!==e&&\"object\"==typeof e&&\"cardNumberElementOptions\"in e&&\"cardCvcElementOptions\"in e&&\"cardExpiryElementOptions\"in e&&void 0!==e.cardNumberElementOptions&&void 0!==e.cardCvcElementOptions&&void 0!==e.cardExpiryElementOptions}var Y,$,J,K;!function(e){e.Solid=\"solid\",e.Default=\"default\"}(Y||(Y={})),function(e){e.Alipay=\"alipay\",e.CardCvc=\"cardCvc\",e.CardExpiry=\"cardExpiry\",e.CardNumber=\"cardNumber\",e.CreditCard=\"card\",e.IDEAL=\"idealBank\",e.Sepa=\"iban\"}($||($={})),function(e){e.Alipay=\"alipay\",e.CreditCard=\"card\",e.IDEAL=\"ideal\",e.Sepa=\"sepa_debit\"}(J||(J={})),function(e){e.AuthFailure=\"auth_failure\"}(K||(K={}));class Z extends S{constructor(e){super(e===K.AuthFailure?\"User did not authenticate\":\"There was an error while processing your payment. Please try again or contact us.\"),this.type=\"stripev3_error\",this.subtype=e}}var Q=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{d(n.next(e))}catch(e){o(e)}}function a(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(s,a)}d((n=n.apply(e,t||[])).next())})};const X=[$.Alipay,$.IDEAL];class ee{constructor(e,t){this.paymentIntegrationService=e,this.scriptLoader=t}initialize(e){return Q(this,void 0,void 0,function*(){const{stripev3:t,methodId:i,gatewayId:n}=e;if(!n)throw new B('Unable to initialize payment because \"gatewayId\" argument is not provided.');this.initializeOptions=t,this.isDeinitialize=!1;const r=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(i),{initializationData:{stripePublishableKey:o,stripeConnectedAccount:s,useIndividualCardFields:a,allowRedisplayForStoredInstruments:d}}=r;this._allowRedisplayForStoredInstruments=d;const l=this.getInitializeOptions().form;this.useIndividualCardFields=a,this.stripeV3Client=yield this.loadStripeJs(o,s),this.isCreditCard(i)&&this.shouldShowTSVHostedForm(i,n)&&l?this.hostedForm=yield this.mountCardVerificationFields(l):this.stripeElement=yield this.mountCardFields(i)})}execute(e,i){var n,r;return Q(this,void 0,void 0,function*(){const{payment:o}=e,s=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);let a,d;if(!o||!o.paymentData)throw new F([\"payment.paymentData\"]);const{paymentData:l,gatewayId:c,methodId:u}=o,{shouldSaveInstrument:h,shouldSetAsDefaultInstrument:p}=G(l)?l:{shouldSaveInstrument:!1,shouldSetAsDefaultInstrument:!1},m=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.includes)(X,u),{isStoreCreditApplied:y}=this.paymentIntegrationService.getState().getCheckoutOrThrow();y&&(yield this.paymentIntegrationService.applyStoreCredit(y));try{m&&(yield this.paymentIntegrationService.submitOrder(s,i)),c&&(yield this.paymentIntegrationService.loadPaymentMethod(c,{params:{method:u}}));const e=this.paymentIntegrationService.getState();if(H(l)){yield this.paymentIntegrationService.submitOrder(s,i);const{instrumentId:t}=l,n=e.getPaymentMethodOrThrow(o.methodId).clientToken;if(!n)throw new A(C.MissingPaymentMethod);return yield this.executeWithVaulted(o,t,p,n)}const t=e.getPaymentMethodOrThrow(u),y=yield this.confirmStripePayment(t),{clientToken:g,method:v}=t,{id:S}=null!==(r=null!==(n=y.paymentIntent)&&void 0!==n?n:y.paymentMethod)&&void 0!==r?r:{id:\"\"};d=y.error,a={credit_card_token:{token:S},vault_payment_instrument:h,confirm:!1,set_as_default_stored_instrument:p},v===$.CreditCard&&(a.client_token=g),m||(yield this.paymentIntegrationService.submitOrder(s,i));const _=this.buildPaymentPayload(u,a,p);yield this.paymentIntegrationService.submitPayment(_)}catch(e){yield this.processAdditionalAction(this.handleEmptyPaymentIntentError(e,d),u,h,p)}})}finalize(){return Promise.reject(new q)}deinitialize(){return this.hostedForm&&this.hostedForm.detach(),this.isDeinitialize=!0,this.unmountElement(),Promise.resolve()}buildPaymentPayload(e,t,i){return{methodId:e,paymentData:i?{formattedPayload:Object.assign(Object.assign({},t),{set_as_default_stored_instrument:i})}:{formattedPayload:t}}}isCancellationError(e){var t,i;return e&&-1!==(null===(i=null===(t=e.payment_intent.last_payment_error)||void 0===t?void 0:t.message)||void 0===i?void 0:i.indexOf(\"canceled\"))}isAuthError(e){return\"payment_intent_authentication_failure\"===(null==e?void 0:e.code)}isCreditCard(e){return e===J.CreditCard}isHostedFieldAvailable(){var e;const t=this.getInitializeOptions(),r=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)(null===(e=t.form)||void 0===e?void 0:e.fields,lodash__WEBPACK_IMPORTED_MODULE_1__.isEmpty);return!(0,lodash__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(r)}isHostedPaymentFormEnabled(e,t){const{getPaymentMethodOrThrow:i}=this.paymentIntegrationService.getState(),n=i(e,t);return Boolean(n.config.isHostedFormEnabled)}confirmStripePayment(e){return Q(this,void 0,void 0,function*(){const{clientToken:t,method:i,returnUrl:n}=e;if(!t)throw new A(C.MissingPaymentMethod);switch(i){case $.Alipay:return this.getStripeJs().confirmAlipayPayment(t,{return_url:n},{handleActions:!1});case $.IDEAL:{const e=this.mapStripePaymentData(J.IDEAL,n);return this.getStripeJs().confirmIdealPayment(t,e,{handleActions:!1})}case $.Sepa:{const e=this.mapStripePaymentData(J.Sepa);return this.getStripeJs().confirmSepaDebitPayment(t,e)}default:{const e=this.useIndividualCardFields?this.getStripeCardElements()[0]:this.getStripeElement(),t=this.mapStripeBillingDetails(this.paymentIntegrationService.getState().getBillingAddress(),this.paymentIntegrationService.getState().getCustomer()),i=this._allowRedisplayForStoredInstruments;return this.getStripeJs().createPaymentMethod(Object.assign({type:J.CreditCard,card:e,billing_details:t},i?{allow_redisplay:\"always\"}:{}))}}})}executeWithVaulted(e,t,i,n){var r;return Q(this,void 0,void 0,function*(){const o={bigpay_token:{token:t},confirm:!0,client_token:n,set_as_default_stored_instrument:i};if(this.isHostedPaymentFormEnabled(e.methodId,e.gatewayId)&&this.hostedForm){const t=this.hostedForm;return e.paymentData&&H(e.paymentData)&&(e.paymentData=Object.assign(Object.assign({},e.paymentData),{instrumentId:JSON.stringify({token:(null===(r=e.paymentData)||void 0===r?void 0:r.instrumentId)||\"\",client_token:n})})),yield t.validate(),yield t.submit(e),this.paymentIntegrationService.loadCurrentOrder()}const s=this.buildPaymentPayload(e.methodId,o,i);return this.paymentIntegrationService.submitPayment(s)})}getInitializeOptions(){if(!this.initializeOptions)throw new w(f.PaymentNotInitialized);return this.initializeOptions}getStripeCardElements(){if(!this.stripeCardElements)throw new w(f.PaymentNotInitialized);return this.stripeCardElements}getStripeElement(){if(!this.stripeElement)throw new w(f.PaymentNotInitialized);return this.stripeElement}getStripeJs(){if(!this.stripeV3Client)throw new w(f.PaymentNotInitialized);return this.stripeV3Client}handleEmptyPaymentIntentError(e,t){return D(e)&&(0,lodash__WEBPACK_IMPORTED_MODULE_1__.some)(e.body.errors,{code:\"required_field\"})&&t?new Error(t.message):e}loadStripeJs(e,t){return Q(this,void 0,void 0,function*(){return this.stripeV3Client?Promise.resolve(this.stripeV3Client):this.scriptLoader.load(e,t,this.paymentIntegrationService.getState().getLocale())})}mapStripeAddress(e){if(e){const{city:t,countryCode:i,address1:n,address2:r,postalCode:o,stateOrProvinceCode:s}=e;return{city:t,country:i,line1:n,line2:r,postal_code:o,state:s}}return{line1:\"\"}}mapStripeBillingDetails(e,t){const{firstName:i,lastName:n}=e||t||{firstName:\"Guest\",lastName:\"\"},r=`${i} ${n}`.trim(),{options:o}=this.getInitializeOptions();if(this.useIndividualCardFields&&W(o)){const{zipCodeElementOptions:t}=o;if(t){const i=document.getElementById(t.containerId)?document.getElementById(t.containerId).value:\"\";i&&e&&(e=Object.assign(Object.assign({},e),{postalCode:i}))}}const s={address:this.mapStripeAddress(e)};if(t&&t.addresses[0]&&function(e){return\"object\"==typeof e&&null!==e&&\"id\"in e&&void 0!==e.id}(t.addresses[0])){const e=t.addresses[0],{email:i}=t,{phone:n}=e;return n?Object.assign(Object.assign({},s),{email:i,name:r,phone:n}):Object.assign(Object.assign({},s),{email:i,name:r})}if(e){const{email:t,phone:i}=e;return i?Object.assign(Object.assign({},s),{email:t,name:r,phone:i}):Object.assign(Object.assign({},s),{email:t,name:r})}return Object.assign(Object.assign({},s),{name:r})}mapStripePaymentData(e,t){const i=this.paymentIntegrationService.getState().getCustomer(),n=this.paymentIntegrationService.getState().getBillingAddress(),r={payment_method:{[e]:this.getStripeElement(),billing_details:this.mapStripeBillingDetails(n,i)}};return e===J.IDEAL?Object.assign(Object.assign({},r),{return_url:t}):r}mountCardFields(e){const{options:t,containerId:i}=this.getInitializeOptions();let n;return new Promise((r,o)=>{switch(this.stripeElements||(this.stripeElements=this.getStripeJs().elements()),e){case $.CreditCard:if(this.useIndividualCardFields&&W(t)){const{cardNumberElementOptions:e,cardExpiryElementOptions:i,cardCvcElementOptions:r}=t,s=this.stripeElements.getElement($.CardNumber)||this.stripeElements.create($.CardNumber,e),a=this.stripeElements.getElement($.CardExpiry)||this.stripeElements.create($.CardExpiry,i),d=this.stripeElements.getElement($.CardCvc)||this.stripeElements.create($.CardCvc,r);this.stripeCardElements=[s,a,d],n=this.stripeCardElements[0];try{s.mount(`#${e.containerId}`),a.mount(`#${i.containerId}`),d.mount(`#${r.containerId}`)}catch(e){this.isDeinitialize||o(new B(\"Unable to mount Stripe component without valid container ID.\"))}}else{n=this.stripeElements.getElement(e)||this.stripeElements.create(e,t);try{n.mount(`#${i}`)}catch(e){this.isDeinitialize||o(new B(\"Unable to mount Stripe component without valid container ID.\"))}}break;case $.IDEAL:case $.Sepa:n=this.stripeElements.getElement(e)||this.stripeElements.create(e,t);try{n.mount(`#${i}`)}catch(e){this.isDeinitialize||o(new B(\"Unable to mount Stripe component without valid container ID.\"))}case $.Alipay:}r(n)})}mountCardVerificationFields(e){return Q(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState().getStoreConfig();if(!t)throw new A(C.MissingCheckoutConfig);const i=t.paymentSettings.bigpayBaseUrl,n=this.paymentIntegrationService.createHostedForm(i,e);return yield n.attach(),n})}processAdditionalAction(e,t,i=!1,n=!1){return Q(this,void 0,void 0,function*(){if(!D(e))throw e;const r=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.some)(e.body.errors,{code:\"additional_action_required\"}),s=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.some)(e.body.errors,{code:\"three_d_secure_required\"});if(r){const t=e.body.additional_action_required;if(t&&\"redirect_to_url\"===t.type)return new Promise(()=>{t.data.redirect_url&&window.location.replace(t.data.redirect_url)})}if(s){const r=e.body.three_ds_result.token,o=!1;let s,a=!1;try{s=yield this.getStripeJs().confirmCardPayment(r)}catch(e){a=!0}if(null==s?void 0:s.error){if(this.isCancellationError(s.error))throw new P;if(this.isAuthError(s.error))throw new Z(K.AuthFailure);throw new Error(s.error.message)}const d={credit_card_token:{token:this.getPaymentToken(null==s?void 0:s.paymentIntent,r,a)},vault_payment_instrument:i,confirm:o},l=this.buildPaymentPayload(t,d,n);try{return yield this.paymentIntegrationService.submitPayment(l)}catch(e){throw this.handleEmptyPaymentIntentError(e,null==s?void 0:s.error)}}throw e})}getPaymentToken(e,t,i){return!e||i?t:e.id}shouldShowTSVHostedForm(e,t){return this.isHostedFieldAvailable()&&this.isHostedPaymentFormEnabled(e,t)}unmountElement(){this.stripeElement&&(this.stripeElement.unmount(),this.stripeElement=void 0)}}class te{constructor(e,t=window){this.scriptLoader=e,this.stripeWindow=t}load(e,t,i){return this.scriptLoader.loadScript(\"https://js.stripe.com/v3/\").then(()=>{if(!this.stripeWindow.Stripe)throw new _;return this.stripeWindow.Stripe(e,{stripeAccount:t,locale:i,betas:[\"payment_intent_beta_3\",\"alipay_pm_beta_1\"],apiVersion:\"2020-03-02;alipay_beta=v1\"})})}}const ie=v(t=>new ee(t,new te((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)())),[{gateway:\"stripev3\"}]),ne={body:{},headers:{},status:0};class re extends S{constructor(e,{message:t,errors:i}={}){const{body:n,headers:r,status:o}=e||ne;super(t||\"An unexpected error has occurred.\"),this.name=\"RequestError\",this.type=\"request\",this.body=n,this.headers=r,this.status=o,this.errors=i||[]}}const oe={ar:[\"ar\"],bg:[\"bg\"],cs:[\"cs\"],da:[\"da\"],de:[\"de\"],el:[\"el\"],en:[\"en\",\"en-GB\"],es:[\"es\",\"es-419\"],et:[\"et\"],fi:[\"fi\"],fil:[\"fil\"],fr:[\"fr\",\"fr-CA\"],he:[\"he\"],hr:[\"hr\"],hu:[\"hu\"],id:[\"id\"],it:[\"it\"],ja:[\"ja\"],ko:[\"ko\"],lt:[\"lt\"],lv:[\"lv\"],ms:[\"ms\"],mt:[\"mt\"],nb:[\"nb\"],nl:[\"nl\"],pl:[\"pl\"],pt:[\"pt\",\"pt-BR\"],ro:[\"ro\"],ru:[\"ru\"],sk:[\"sk\"],sl:[\"sl\"],sv:[\"sv\"],th:[\"th\"],tr:[\"tr\"],vi:[\"vi\"],zh:[\"zh\",\"zh-HK\",\"zh-TW\"]};function se(e){const[t,i]=e.replace(/_/g,\"-\").toLowerCase().split(\"-\"),n=oe[t];if(!n)return\"auto\";const r=i?`${t}-${i.toUpperCase()}`:t;return n.indexOf(r)>-1?r:n[0]}const ae=[\"payment_element_beta_2\",\"alipay_pm_beta_1\",\"link_default_integration_beta_1\",\"shipping_address_element_beta_1\",\"address_element_beta_1\"],de=\"2020-03-02;alipay_beta=v1;link_beta=v1\";function le(e){return\"stripeLinkAuthenticationState\"in e}var ce=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{d(n.next(e))}catch(e){o(e)}}function a(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(s,a)}d((n=n.apply(e,t||[])).next())})};class ue{constructor(e,t,i){this.paymentIntegrationService=e,this.scriptLoader=t,this.stripeIntegrationService=i}initialize(e){return ce(this,void 0,void 0,function*(){const{stripeupe:t,methodId:i,gatewayId:n}=e;if(!(null==t?void 0:t.containerId))throw new w(f.PaymentNotInitialized);if(!n)throw new B('Unable to initialize payment because \"gatewayId\" argument is not provided.');return this._loadStripeElement(t,n,i).catch(e=>{var i;return null===(i=t.onError)||void 0===i?void 0:i.call(t,e)}),this.stripeIntegrationService.initCheckoutEventsSubscription(n,i,t,this._stripeElements),Promise.resolve()})}execute(e,t){return ce(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!i||!i.paymentData)throw new F([\"payment.paymentData\"]);if(!this._stripeUPEClient)throw new w(f.PaymentNotInitialized);const{paymentData:r,methodId:o,gatewayId:s}=i,{shouldSaveInstrument:a=!1,shouldSetAsDefaultInstrument:d=!1}=G(r)?r:{},l=this.paymentIntegrationService.getState(),{isStoreCreditApplied:c}=l.getCheckoutOrThrow(),u=l.getPaymentProviderCustomerOrThrow(),h=(le(u)?u:{}).stripeLinkAuthenticationState;if(c&&(yield this.paymentIntegrationService.applyStoreCredit(c)),s){yield this.stripeIntegrationService.updateStripePaymentIntent(s,o);const{email:e}=l.getCustomerOrThrow();if(void 0!==h&&!e){const e=l.getBillingAddressOrThrow();yield this.paymentIntegrationService.updateBillingAddress(e)}}if(yield this.paymentIntegrationService.submitOrder(n,t),H(r)){const{instrumentId:e}=r;return void(yield this._executeWithVaulted(i.methodId,e,d))}yield this._executeWithStripeConfirmation(i.methodId,!h&&a,d)})}finalize(){return Promise.reject(new q)}deinitialize(){var e,t;return null===(t=null===(e=this._stripeElements)||void 0===e?void 0:e.getElement(h.PAYMENT))||void 0===t||t.unmount(),this.stripeIntegrationService.deinitialize(),this._stripeElements=void 0,this._stripeUPEClient=void 0,Promise.resolve()}_executeWithStripeConfirmation(e,t,i){return ce(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState(),{clientToken:r}=n.getPaymentMethodOrThrow(e),o=this._getPaymentPayload(e,r||\"\",t,i);try{yield this.paymentIntegrationService.submitPayment(o)}catch(n){yield this._processAdditionalActionWithStripeConfirmation(n,e,t,i)}})}_executeWithVaulted(e,t,i){var n;return ce(this,void 0,void 0,function*(){const r=this.paymentIntegrationService.getState(),o=r.getPaymentMethodOrThrow(e),s=null===(n=r.getCart())||void 0===n?void 0:n.id;try{const n={methodId:e,paymentData:{formattedPayload:{cart_id:s,bigpay_token:{token:t},confirm:!1,client_token:o.clientToken,set_as_default_stored_instrument:i}}};return yield this.paymentIntegrationService.submitPayment(n)}catch(t){return this._processVaultedAdditionalAction(t,e,i)}})}_loadStripeElement(e,t,i){return ce(this,void 0,void 0,function*(){const{containerId:n,style:r,render:o,initStripeElementUpdateTrigger:s}=e,a=yield this.paymentIntegrationService.loadPaymentMethod(t,{params:{method:i}}),d=a.getPaymentMethodOrThrow(i);if(!L(d))throw new A(C.MissingPaymentMethod);const{clientToken:l,initializationData:u}=d,{shopperLanguage:p,allowRedisplayForStoredInstruments:y=!1,enableLink:g}=u;if(this._allowRedisplayForStoredInstruments=y,!l)throw new A(C.MissingPaymentMethod);let v;if(this._stripeUPEClient=yield this._loadStripeJs(u),this._isStripeElementUpdateEnabled=\"function\"==typeof s,r){const e=r;v={variables:this.stripeIntegrationService.mapAppearanceVariables(r),rules:{\".Input\":this.stripeIntegrationService.mapInputAppearanceRules(e)}}}this._stripeElements=yield this.scriptLoader.getElements(this._stripeUPEClient,{clientSecret:l,locale:se(p),appearance:v});const{getBillingAddress:S,getShippingAddress:_}=a,{postalCode:f}=_()||S()||{},E=this._stripeElements.getElement(h.PAYMENT)||this._stripeElements.create(h.PAYMENT,Object.assign({fields:{billingDetails:{email:c.NEVER,address:{country:c.NEVER,city:c.NEVER,postalCode:f?c.NEVER:c.AUTO}}},wallets:{applePay:c.NEVER,googlePay:c.NEVER,link:g?c.AUTO:c.NEVER}},this._getStripeElementTerms()));this.stripeIntegrationService.mountElement(E,n),E.on(m.READY,()=>{o()}),E.on(m.CHANGE,e=>{(null==e?void 0:e.value)&&\"type\"in e.value&&this._updateStripeLinkStateByElementType(e.value.type)}),this._isStripeElementUpdateEnabled&&(null==s||s(this._updateStripeElement.bind(this)))})}_processAdditionalActionWithStripeConfirmation(e,t,i=!1,n=!1){return ce(this,void 0,void 0,function*(){if(!D(e)||!this.stripeIntegrationService.isAdditionalActionError(e.body.errors))throw e;if(!this._stripeUPEClient||!this._stripeElements)throw new w(f.PaymentNotInitialized);const{data:r}=e.body.additional_action_required,{token:o}=r,{paymentIntent:s}=yield this._confirmStripePaymentOrThrow(t,r),a=this._getPaymentPayload(t,(null==s?void 0:s.id)||o,i,n);try{yield this.paymentIntegrationService.submitPayment(a)}catch(e){this.stripeIntegrationService.throwPaymentConfirmationProceedMessage()}})}_confirmStripePaymentOrThrow(e,t){var i,n;return ce(this,void 0,void 0,function*(){const{token:r,redirect_url:o}=t,s=this.stripeIntegrationService.mapStripePaymentData(this._stripeElements,o,!!this._allowRedisplayForStoredInstruments);let a;try{const t=(yield this.stripeIntegrationService.isPaymentCompleted(e,this._stripeUPEClient))?yield null===(n=this._stripeUPEClient)||void 0===n?void 0:n.retrievePaymentIntent(r||\"\"):yield null===(i=this._stripeUPEClient)||void 0===i?void 0:i.confirmPayment(s);if(a=null==t?void 0:t.error,a||!(null==t?void 0:t.paymentIntent))throw new b;return t}catch(e){this.stripeIntegrationService.throwStripeError(a)}})}_processVaultedAdditionalAction(e,t,i=!1){var n;return ce(this,void 0,void 0,function*(){if(!t||!D(e)||!(0,lodash__WEBPACK_IMPORTED_MODULE_1__.some)(e.body.errors,{code:\"three_d_secure_required\"}))throw e;if(!this._stripeUPEClient||!this._stripeElements)throw new w(f.PaymentNotInitialized);const r=e.body.three_ds_result.token;let s,a=!1;try{s=yield this._stripeUPEClient.confirmCardPayment(r)}catch(e){try{s=yield this._stripeUPEClient.retrievePaymentIntent(r)}catch(e){a=!0}}if((null==s?void 0:s.error)&&this.stripeIntegrationService.throwStripeError(s.error),!(null==s?void 0:s.paymentIntent)&&!a)throw new re;const d=this._getPaymentPayload(t,a?r:null===(n=null==s?void 0:s.paymentIntent)||void 0===n?void 0:n.id,!1,i);return this.paymentIntegrationService.submitPayment(d)})}_loadStripeJs(e){return ce(this,void 0,void 0,function*(){if(this._stripeUPEClient)return this._stripeUPEClient;const t=this.paymentIntegrationService.getState();return this.scriptLoader.getStripeClient(e,t.getCartLocale(),u.V3,ae,de)})}_getPaymentPayload(e,t,i=!1,n=!1){var r;return{methodId:e,paymentData:{formattedPayload:{cart_id:(null===(r=this.paymentIntegrationService.getState().getCart())||void 0===r?void 0:r.id)||\"\",credit_card_token:{token:t},confirm:!1,vault_payment_instrument:i,set_as_default_stored_instrument:n}}}}_updateStripeElement({shouldShowTerms:e}){var t;const i=null===(t=this._stripeElements)||void 0===t?void 0:t.getElement(h.PAYMENT);null==i||i.update(Object.assign({},this._getStripeElementTerms(e)))}_getStripeElementTerms(e){let t=c.AUTO;return this._isStripeElementUpdateEnabled&&(t=e?c.AUTO:c.NEVER),{terms:{card:t}}}_updateStripeLinkStateByElementType(e){const t=this.paymentIntegrationService.getState().getPaymentProviderCustomerOrThrow(),i=e===l.Link;!le(t)&&i&&this.paymentIntegrationService.updatePaymentProviderCustomer({stripeLinkAuthenticationState:i})}}const he=v(t=>{const i=new I((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)());return new ue(t,i,new M(t,i))},[{gateway:\"stripeupe\"},{gateway:\"stripeupe\",id:\"klarna\"}]),pe=e=>\"object\"==typeof e&&null!==e&&\"value\"in e&&\"collapsed\"in e;var me=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{d(n.next(e))}catch(e){o(e)}}function a(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(s,a)}d((n=n.apply(e,t||[])).next())})};class ye{constructor(e,t,i){this.paymentIntegrationService=e,this.scriptLoader=t,this.stripeIntegrationService=i}initialize(e){var t;return me(this,void 0,void 0,function*(){const{stripeocs:i,methodId:n,gatewayId:r}=e;if(!(null==i?void 0:i.containerId))throw new w(f.PaymentNotInitialized);if(!r)throw new B('Unable to initialize payment because \"gatewayId\" argument is not provided.');try{yield this._initializeStripeElement(i,r,n)}catch(e){e instanceof Error&&(null===(t=i.onError)||void 0===t||t.call(i,e))}this.stripeIntegrationService.initCheckoutEventsSubscription(r,n,i,this.stripeElements)})}execute(e,t){return me(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]),{methodId:r,gatewayId:o}=i||{};if(!this.stripeClient)throw new w(f.PaymentNotInitialized);if(!o||!r)throw new B('Unable to initialize payment because \"gatewayId\" or \"methodId\" argument is not provided.');const{isStoreCreditApplied:s}=this.paymentIntegrationService.getState().getCheckoutOrThrow();s&&(yield this.paymentIntegrationService.applyStoreCredit(s)),yield this.stripeIntegrationService.updateStripePaymentIntent(o,r),yield this.paymentIntegrationService.submitOrder(n,t);const{clientToken:a}=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(r,o),d=this._getPaymentPayload(r,a||\"\");try{yield this.paymentIntegrationService.submitPayment(d)}catch(e){yield this._processAdditionalAction(e,r)}})}finalize(){return Promise.reject(new q)}deinitialize(){var e;const t=null===(e=this.stripeElements)||void 0===e?void 0:e.getElement(h.PAYMENT);return null==t||t.unmount(),null==t||t.destroy(),this.stripeIntegrationService.deinitialize(),this.stripeElements=void 0,this.stripeClient=void 0,Promise.resolve()}_initializeStripeElement(e,t,i){return me(this,void 0,void 0,function*(){let n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(i,t);if((null==n?void 0:n.clientToken)||(n=(yield this.paymentIntegrationService.loadPaymentMethod(t,{params:{method:i}})).getPaymentMethodOrThrow(i,t)),!L(n))throw new A(C.MissingPaymentMethod);const{clientToken:r,initializationData:o}=n,{shopperLanguage:s,customerSessionToken:a,enableLink:d}=o;if(!r)throw new A(C.MissingPaymentMethod);this.stripeClient=yield this._loadStripeJs(o);const{appearance:l,containerId:u,fonts:p,layout:y,render:g,paymentMethodSelect:v,handleClosePaymentMethod:S,togglePreloader:_}=e;this.stripeElements=yield this.scriptLoader.getElements(this.stripeClient,{clientSecret:r,customerSessionClientSecret:a,locale:se(s),appearance:l,fonts:p});const{getBillingAddress:f,getShippingAddress:E}=this.paymentIntegrationService.getState(),I=f(),{postalCode:P}=E()||I||{},b=this.stripeElements.getElement(h.PAYMENT)||this.stripeElements.create(h.PAYMENT,{fields:{billingDetails:{email:c.NEVER,address:{country:c.NEVER,city:c.NEVER,postalCode:P?c.NEVER:c.AUTO}}},wallets:{applePay:c.NEVER,googlePay:c.NEVER,link:d?c.AUTO:c.NEVER},layout:y,savePaymentMethod:{maxVisiblePaymentMethods:20},defaultValues:{billingDetails:{email:(null==I?void 0:I.email)||\"\"}}});this.stripeIntegrationService.mountElement(b,u),b.on(m.LOADER_START,()=>{null==_||_(!1)}),b.on(m.READY,()=>{g()}),b.on(m.CHANGE,e=>{this._onStripeElementChange(e,t,i,v)}),null==S||S(this._collapseStripeElement.bind(this))})}_loadStripeJs(e){return me(this,void 0,void 0,function*(){if(this.stripeClient)return this.stripeClient;const t=this.paymentIntegrationService.getState(),i=this.stripeIntegrationService.getStripeJsVersion(e);return this.scriptLoader.getStripeClient(e,t.getCartLocale(),i)})}_collapseStripeElement(){var e;const t=null===(e=this.stripeElements)||void 0===e?void 0:e.getElement(h.PAYMENT);null==t||t.collapse()}_getPaymentPayload(e,t,i){var n;const r=(null===(n=this.paymentIntegrationService.getState().getCart())||void 0===n?void 0:n.id)||\"\",{card:o,us_bank_account:s}=i||{},a=this._shouldSaveInstrument(o)||this._shouldSaveInstrument(s),d=this._getTokenizedOptions(t,i);return{methodId:e,paymentData:{formattedPayload:Object.assign({cart_id:r,confirm:!1,method:this.selectedMethodId,vault_payment_instrument:a},d)}}}_processAdditionalAction(e,t){return me(this,void 0,void 0,function*(){if(!D(e)||!this.stripeIntegrationService.isAdditionalActionError(e.body.errors))throw e;if(!this.stripeClient||!this.stripeElements)throw new w(f.PaymentNotInitialized);const{data:i}=e.body.additional_action_required,{token:n}=i,{paymentIntent:r}=yield this._confirmStripePaymentOrThrow(t,i),{client_secret:o,payment_method_options:s}=r||{},a=this._getPaymentPayload(t,o||n,s);try{return yield this.paymentIntegrationService.submitPayment(a)}catch(e){this.stripeIntegrationService.throwPaymentConfirmationProceedMessage()}})}_confirmStripePaymentOrThrow(e,t){var i,n;return me(this,void 0,void 0,function*(){const{token:r,redirect_url:o}=t,s=this.stripeIntegrationService.mapStripePaymentData(this.stripeElements,o);let a;try{const t=(yield this.stripeIntegrationService.isPaymentCompleted(e,this.stripeClient))?yield null===(n=this.stripeClient)||void 0===n?void 0:n.retrievePaymentIntent(r||\"\"):yield null===(i=this.stripeClient)||void 0===i?void 0:i.confirmPayment(s);if(a=null==t?void 0:t.error,a||!(null==t?void 0:t.paymentIntent))throw new b;return t}catch(e){return this.stripeIntegrationService.throwStripeError(a)}})}_onStripeElementChange(e,t,i,n){pe(e)&&!e.collapsed&&(this.selectedMethodId=e.value.type,null==n||n(`${t}-${i}`))}_shouldSaveInstrument(e){const t=null==e?void 0:e.setup_future_usage;return t===y.ON_SESSION||t===y.OFF_SESSION}_getTokenizedOptions(e,t){return this._shouldSaveInstrument(null==t?void 0:t.us_bank_account)?{tokenized_ach:{token:e}}:{credit_card_token:{token:e}}}}const ge=v(t=>{const i=new I((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)());return new ye(t,i,new M(t,i))},[{gateway:\"stripeocs\",id:\"optimized_checkout\"}]);var ve=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{d(n.next(e))}catch(e){o(e)}}function a(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(s,a)}d((n=n.apply(e,t||[])).next())})};class Se{constructor(e,t,i){this.paymentIntegrationService=e,this.scriptLoader=t,this.stripeIntegrationService=i}initialize(e){var t;return ve(this,void 0,void 0,function*(){const{stripeocs:i,methodId:n,gatewayId:r}=e;if(!(null==i?void 0:i.containerId)||!r)throw new w(f.PaymentNotInitialized);try{yield this._initializeStripeElement(i,r,n)}catch(e){e instanceof Error&&(null===(t=i.onError)||void 0===t||t.call(i,e))}})}execute(){return ve(this,void 0,void 0,function*(){return Promise.resolve()})}finalize(){return Promise.reject(new q)}deinitialize(){var e;const t=null===(e=this.stripeCheckoutSession)||void 0===e?void 0:e.getPaymentElement();return null==t||t.unmount(),null==t||t.destroy(),this.stripeIntegrationService.deinitialize(),this.stripeCheckoutSession=void 0,this.stripeClient=void 0,Promise.resolve()}_initializeStripeElement(e,t,i){return ve(this,void 0,void 0,function*(){let n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(i,t);if((null==n?void 0:n.clientToken)||(n=(yield this.paymentIntegrationService.loadPaymentMethod(t,{params:{method:i}})).getPaymentMethodOrThrow(i,t)),!L(n))throw new A(C.MissingPaymentMethod);const{clientToken:r,initializationData:o}=n;if(!r)throw new A(C.MissingPaymentMethod);this.stripeClient=yield this._loadStripeJs(o);const{enableLink:s}=o,{appearance:a,containerId:d,fonts:l,layout:u,render:h,paymentMethodSelect:p,handleClosePaymentMethod:y,togglePreloader:g}=e,{getBillingAddress:v,getShippingAddress:S}=this.paymentIntegrationService.getState(),_=v(),{postalCode:E}=S()||_||{};this.stripeCheckoutSession=yield this.scriptLoader.getCheckoutSession(this.stripeClient,{clientSecret:r,elementsOptions:{appearance:a,fonts:l},adaptivePricing:{allowed:!1},defaultValues:{email:(null==_?void 0:_.email)||\"\"}});const I=this._createStripeElement({fields:{billingDetails:{email:c.NEVER,address:{country:c.NEVER,city:c.NEVER,postalCode:E?c.NEVER:c.AUTO}}},wallets:{applePay:c.NEVER,googlePay:c.NEVER,link:s?c.AUTO:c.NEVER},layout:u});if(!I)throw new w(f.PaymentNotInitialized);this.stripeIntegrationService.mountElement(I,d),I.on(m.LOADER_START,()=>{null==g||g(!1)}),I.on(m.READY,()=>{h()}),I.on(m.CHANGE,e=>{this._onStripeElementChange(e,t,i,p)}),null==y||y(this._collapseStripeElement.bind(this))})}_loadStripeJs(e){return ve(this,void 0,void 0,function*(){if(this.stripeClient)return this.stripeClient;const t=this.paymentIntegrationService.getState();return this.scriptLoader.getStripeClient(e,t.getCartLocale(),u.CLOVER)})}_createStripeElement(e){var t,i;return(null===(t=this.stripeCheckoutSession)||void 0===t?void 0:t.getPaymentElement())||(null===(i=this.stripeCheckoutSession)||void 0===i?void 0:i.createPaymentElement(e))}_onStripeElementChange(e,t,i,n){pe(e)&&!e.collapsed&&(null==n||n(`${t}-${i}`))}_collapseStripeElement(){var e;const t=null===(e=this.stripeCheckoutSession)||void 0===e?void 0:e.getPaymentElement();null==t||t.collapse()}}const _e=v(t=>{const i=new I((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)());return new Se(t,i,new M(t,i))},[{gateway:\"stripeocs\",id:\"checkout_session\"}]);class fe{constructor(e,t){this.paymentIntegrationService=e,this.scriptLoader=t}initialize(e){var t,i,n,r,o;return i=this,n=void 0,o=function*(){let i;if(!e.stripeupe)throw new B('Unable to proceed because \"options\" argument is not provided.');const{container:n,gatewayId:r,methodId:o,onEmailChange:a,getStyles:d,isLoading:l}=e.stripeupe;Object.entries(e.stripeupe).forEach(([e,t])=>{if(!t)throw new B(`Unable to proceed because \"${e}\" argument is not provided.`)}),yield this.paymentIntegrationService.loadPaymentMethod(r,{params:{method:o}});const c=this.paymentIntegrationService.getState(),p=c.getPaymentMethodOrThrow(o,r),{clientToken:y}=p;if(!L(p)||!y)throw new A(C.MissingPaymentToken);const{email:g}=c.getCustomerOrThrow(),v=c.getPaymentProviderCustomerOrThrow(),S=(le(v)?v:{}).stripeLinkAuthenticationState;if(!g){let e;const r=\"function\"==typeof d&&d();e=r?{variables:{colorPrimary:r.fieldInnerShadow,colorBackground:r.fieldBackground,colorText:r.labelText,colorDanger:r.fieldErrorText,colorTextSecondary:r.labelText,colorTextPlaceholder:r.fieldPlaceholderText},rules:{\".Input\":{borderColor:r.fieldBorder,color:r.fieldText,boxShadow:r.fieldInnerShadow}}}:{},i=yield this.scriptLoader.getStripeClient(p.initializationData,c.getCartLocale(),u.V3,ae,de),this._stripeElements=yield this.scriptLoader.getElements(i,{clientSecret:y,appearance:e});const{getBillingAddress:o,getConsignments:g}=this.paymentIntegrationService.getState(),v=g(),_=null===(t=null==v?void 0:v[0])||void 0===t?void 0:t.id,{email:f}=o()||{},E=f?{defaultValues:{mode:s.SHIPPING,email:f}}:{},I=this._stripeElements.getElement(h.AUTHENTICATION)||this._stripeElements.create(h.AUTHENTICATION,E);I.on(m.CHANGE,e=>{if(!(\"authenticated\"in e))throw new A(C.MissingCustomer);this.paymentIntegrationService.updatePaymentProviderCustomer({stripeLinkAuthenticationState:e.authenticated}),e.complete?a(e.authenticated,e.value.email):a(!1,\"\"),l&&l(!1),void 0===S&&e.authenticated&&_&&this.paymentIntegrationService.deleteConsignment(_)}),I.mount(`#${n}`)}},new((r=void 0)||(r=Promise))(function(e,t){function s(e){try{d(o.next(e))}catch(e){t(e)}}function a(e){try{d(o.throw(e))}catch(e){t(e)}}function d(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r(function(e){e(i)})).then(s,a)}d((o=o.apply(i,n||[])).next())})}deinitialize(){var e,t;return null===(t=null===(e=this._stripeElements)||void 0===e?void 0:e.getElement(h.AUTHENTICATION))||void 0===t||t.unmount(),Promise.resolve()}signIn(e,t){return this.paymentIntegrationService.signInCustomer(e,t),Promise.resolve()}signOut(e){return this.paymentIntegrationService.signOutCustomer(e),Promise.resolve()}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}}const Ce=v(t=>new fe(t,new I((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)())),[{id:\"stripeupe\"}]);var Ee=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function s(e){try{d(n.next(e))}catch(e){o(e)}}function a(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(s,a)}d((n=n.apply(e,t||[])).next())})};class Ie{constructor(e,t,i,n){this.paymentIntegrationService=e,this.scriptLoader=t,this.stripeIntegrationService=i,this.loadingIndicator=n}initialize(e){return Ee(this,void 0,void 0,function*(){const{stripeocs:t}=e||{};if(!t)throw new B('Unable to proceed because \"options\" argument is not provided.');const{methodId:i,gatewayId:n,container:r}=t;if(!r||!i||!n)throw new w(f.PaymentNotInitialized);const o=yield this.paymentIntegrationService.loadPaymentMethod(n,{params:{method:i}}),s=o.getPaymentMethodOrThrow(i,n),{loadingContainerId:a,buttonHeight:d,onComplete:l}=t;if(this._loadingIndicatorContainer=a,this._onComplete=l,!L(s))throw new A(C.MissingPaymentMethod);const{initializationData:c}=s,{captureMethod:u}=c,h=this.stripeIntegrationService.getStripeJsVersion(c);this._captureMethod=u,this._stripeClient=yield this.scriptLoader.getStripeClient(c,o.getCartLocale(),h),yield this._mountExpressCheckoutElement(r,this._stripeClient,d),this._initializeEvents(i)})}signIn(){return Promise.resolve()}signOut(){return Promise.resolve()}executePaymentMethodCheckout(){return Promise.resolve()}deinitialize(){return Promise.resolve()}_mountExpressCheckoutElement(e,t,i=40){return Ee(this,void 0,void 0,function*(){const n=this._shouldRequireShippingAddress(),r=Object.assign(Object.assign(Object.assign({shippingAddressRequired:n},n?{allowedShippingCountries:yield this._getAvailableCountries()}:{}),n?{shippingRates:[{id:\"_\",amount:0,displayName:\"Pending rates\"}]}:{}),{billingAddressRequired:!0,emailRequired:!0,phoneNumberRequired:!0,paymentMethods:{link:c.AUTO,applePay:c.NEVER,googlePay:c.NEVER,amazonPay:c.NEVER,paypal:c.NEVER,klarna:c.NEVER},buttonHeight:i}),{cartAmount:o}=this.paymentIntegrationService.getState().getCartOrThrow(),s=Object.assign({mode:\"payment\",amount:this._toCents(o),currency:this._getCurrency()},this._captureMethod?{captureMethod:this._captureMethod}:{});return this._stripeElements=t.elements(s),this._linkV2Element=this._stripeElements.create(h.EXPRESS_CHECKOUT,r),this._linkV2Element.mount(`#${e}`),this._linkV2Element})}_initializeEvents(e){this._linkV2Element&&(this._shouldRequireShippingAddress()&&(this._linkV2Element.on(m.SHIPPING_ADDRESS_CHANGE,e=>Ee(this,void 0,void 0,function*(){return this._onShippingAddressChange(e)})),this._linkV2Element.on(m.SHIPPING_RATE_CHANGE,e=>Ee(this,void 0,void 0,function*(){return this._onShippingRateChange(e)}))),this._linkV2Element.on(m.CONFIRM,t=>Ee(this,void 0,void 0,function*(){return this._onConfirm(t,e)})),this._linkV2Element.on(m.CANCEL,this._onCancel))}_onShippingAddressChange(e){return Ee(this,void 0,void 0,function*(){if(!(\"address\"in e))return;const t=e.address,i={firstName:\"\",lastName:\"\",phone:\"\",company:\"\",address1:\"\",address2:\"\",city:(null==t?void 0:t.city)||\"\",countryCode:(null==t?void 0:t.country)||\"\",postalCode:(null==t?void 0:t.postal_code)||\"\",stateOrProvince:(null==t?void 0:t.state)||\"\",stateOrProvinceCode:(null==t?void 0:t.state)||\"\",customFields:[]};yield this.paymentIntegrationService.updateShippingAddress(i);const n=yield this._getAvailableShippingOptions();yield this._updateDisplayedPrice(),(null==n?void 0:n.length)?e.resolve({shippingRates:n}):e.reject()})}_onCancel(){throw new P}_onShippingRateChange(e){return Ee(this,void 0,void 0,function*(){if(\"shippingRate\"in e){const{shippingRate:t}=e;yield this._handleShippingOptionChange(null==t?void 0:t.id),yield this._updateDisplayedPrice(),e.resolve({})}})}_onConfirm(e,t){return Ee(this,void 0,void 0,function*(){if(\"billingDetails\"in e&&\"shippingAddress\"in e&&this._stripeClient&&this._stripeElements){yield this._updateShippingAndBillingAddress(e),yield this.paymentIntegrationService.submitOrder();const i=this._getPaymentPayload(t);try{yield this.paymentIntegrationService.submitPayment(i)}catch(e){yield this._processAdditionalAction(e,t)}}return Promise.resolve()})}_updateShippingAndBillingAddress(e){var t,i,n,r,o,s,a,d;return Ee(this,void 0,void 0,function*(){const l=this._shouldRequireShippingAddress(),c=(null===(i=null===(t=e.shippingAddress)||void 0===t?void 0:t.name)||void 0===i?void 0:i.split(\" \")[0])||(null===(r=null===(n=e.billingDetails)||void 0===n?void 0:n.name)||void 0===r?void 0:r.split(\" \")[0])||\"\",u=(null===(s=null===(o=e.shippingAddress)||void 0===o?void 0:o.name)||void 0===s?void 0:s.split(\" \")[1])||(null===(d=null===(a=e.billingDetails)||void 0===a?void 0:a.name)||void 0===d?void 0:d.split(\" \")[1])||\"\";if(l){const t=this._mapShippingAddress(e.shippingAddress,e.billingDetails,c,u);yield this.paymentIntegrationService.updateShippingAddress(t)}const h=this._mapBillingAddress(e.shippingAddress,e.billingDetails,c,u);yield this.paymentIntegrationService.updateBillingAddress(h)})}_mapShippingAddress(e,t,i,n){var r,o,s,a,d,l,c;return{firstName:i,lastName:n,phone:(null==t?void 0:t.phone)||\"\",company:\"\",address1:(null===(r=null==e?void 0:e.address)||void 0===r?void 0:r.line1)||\"\",address2:(null===(o=null==e?void 0:e.address)||void 0===o?void 0:o.line2)||\"\",city:(null===(s=null==e?void 0:e.address)||void 0===s?void 0:s.city)||\"\",countryCode:(null===(a=null==e?void 0:e.address)||void 0===a?void 0:a.country)||\"\",postalCode:(null===(d=null==e?void 0:e.address)||void 0===d?void 0:d.postal_code)||\"\",stateOrProvince:(null===(l=null==e?void 0:e.address)||void 0===l?void 0:l.state)||\"\",stateOrProvinceCode:(null===(c=null==e?void 0:e.address)||void 0===c?void 0:c.state)||\"\",customFields:[]}}_mapBillingAddress(e,t,i,n){var r,o,s,a,d,l;return{email:(null==t?void 0:t.email)||\"\",firstName:i,lastName:n,phone:(null==t?void 0:t.phone)||\"\",company:\"\",address1:(null===(r=null==t?void 0:t.address)||void 0===r?void 0:r.line1)||\"\",address2:\"\",city:(null===(o=null==t?void 0:t.address)||void 0===o?void 0:o.city)||\"\",countryCode:(null===(s=null==t?void 0:t.address)||void 0===s?void 0:s.country)||\"\",postalCode:(null===(a=null==t?void 0:t.address)||void 0===a?void 0:a.postal_code)||\"\",stateOrProvince:(null===(d=null==t?void 0:t.address)||void 0===d?void 0:d.state)||\"\",stateOrProvinceCode:(null===(l=null==e?void 0:e.address)||void 0===l?void 0:l.state)||\"\",customFields:[]}}_processAdditionalAction(e,t){return Ee(this,void 0,void 0,function*(){if(!D(e)||!this.stripeIntegrationService.isAdditionalActionError(e.body.errors))throw e;if(!this._stripeClient||!this._stripeElements)throw new w(f.PaymentNotInitialized);const{data:i}=e.body.additional_action_required,{token:n}=i,{paymentIntent:r}=yield this._confirmStripePaymentOrThrow(i,t),o=this._getPaymentPayload(t,(null==r?void 0:r.id)||n);try{this._toggleLoadingIndicator(!0),yield this.paymentIntegrationService.submitPayment(o),yield this._completeCheckoutFlow()}catch(e){this.stripeIntegrationService.throwPaymentConfirmationProceedMessage()}finally{this._toggleLoadingIndicator(!1)}})}_confirmStripePaymentOrThrow(e,t){var i,n,r;return Ee(this,void 0,void 0,function*(){const{token:o,redirect_url:s}=e,a=this.stripeIntegrationService.mapStripePaymentData(this._stripeElements,s);let d;try{const e=(yield this.stripeIntegrationService.isPaymentCompleted(t,this._stripeClient))?yield null===(r=this._stripeClient)||void 0===r?void 0:r.retrievePaymentIntent(o||\"\"):yield null===(i=this._stripeClient)||void 0===i?void 0:i.confirmPayment({elements:a.elements,clientSecret:o,redirect:c.IF_REQUIRED,confirmParams:{return_url:null===(n=a.confirmParams)||void 0===n?void 0:n.return_url}});if(d=null==e?void 0:e.error,d||!(null==e?void 0:e.paymentIntent))throw new b;return e}catch(e){return this.stripeIntegrationService.throwStripeError(d)}})}_completeCheckoutFlow(){return Ee(this,void 0,void 0,function*(){return\"function\"==typeof this._onComplete?this._onComplete():(window.location.replace(\"/order-confirmation\"),Promise.resolve())})}_getPaymentPayload(e,t){var i;const n=(null===(i=this.paymentIntegrationService.getState().getCart())||void 0===i?void 0:i.id)||\"\";return{methodId:e,paymentData:{formattedPayload:Object.assign(Object.assign({cart_id:n},t?{credit_card_token:{token:t}}:{}),{confirm:!1,method:l.Link})}}}_shouldRequireShippingAddress(){const{getCartOrThrow:e}=this.paymentIntegrationService.getState(),{lineItems:t}=e();return!!t.physicalItems.length}_updateDisplayedPrice(){return Ee(this,void 0,void 0,function*(){this._stripeElements&&this._stripeElements.update({currency:this._getCurrency(),mode:\"payment\",amount:yield this._getTotalPrice()})})}_getCurrency(){if(!this._currencyCode){const{code:e}=this.paymentIntegrationService.getState().getCartOrThrow().currency;this._currencyCode=e.toLowerCase()}return this._currencyCode}_getTotalPrice(){return Ee(this,void 0,void 0,function*(){yield this.paymentIntegrationService.loadCheckout();const{getCheckoutOrThrow:e,getCartOrThrow:t}=this.paymentIntegrationService.getState(),{decimalPlaces:i}=t().currency,n=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.round)(e().outstandingBalance,i).toFixed(i);return this._toCents(+n)})}_getAvailableCountries(){var e;return Ee(this,void 0,void 0,function*(){const t=yield this.paymentIntegrationService.loadShippingCountries();return((null===(e=t.getShippingCountries())||void 0===e?void 0:e.map(e=>e.code))||[]).filter(e=>U.includes(e))})}_getAvailableShippingOptions(){var e,t,i;return Ee(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState().getConsignments();if(!(null==n?void 0:n[0]))return;const r=n[0],o=(r.availableShippingOptions||[]).map(this._getStripeShippingOption.bind(this)),s=null===(e=r.availableShippingOptions)||void 0===e?void 0:e.find(e=>e.isRecommended),a=null===(t=r.selectedShippingOption)||void 0===t?void 0:t.id,d=null==s?void 0:s.id;return a?o.sort(e=>e.id===a?-1:0):d?(o.sort(e=>e.id===d?-1:0),yield this._handleShippingOptionChange(d)):yield this._handleShippingOptionChange(null===(i=o[0])||void 0===i?void 0:i.id),o})}_getStripeShippingOption({id:e,cost:t,description:i}){return{id:e,displayName:i,amount:this._toCents(t)}}_handleShippingOptionChange(e){return Ee(this,void 0,void 0,function*(){if(e&&\"shipping_option_unselected\"!==e)return this.paymentIntegrationService.selectShippingOption(e)})}_getAmountTransformer(){if(this._amountTransformer)return this._amountTransformer;const{getCart:e}=this.paymentIntegrationService.getState(),{currency:t}=e()||{};return t?new z(t.decimalPlaces):void 0}_toCents(e){const t=Math.round(100*e),i=this._getAmountTransformer();return i?i.toInteger(e):t}_toggleLoadingIndicator(e){e&&this._loadingIndicatorContainer?this.loadingIndicator.show(this._loadingIndicatorContainer):this.loadingIndicator.hide()}}const Pe=v(t=>{const i=new I((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)()),n=new R({containerStyles:T});return new Ie(t,i,new M(t,i),n)},[{id:\"stripeocs\"}]);\n//# sourceMappingURL=stripe.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vY2hlY2tvdXQtc2RrLWpzL2Rpc3QvZXNtL2ludGVncmF0aW9ucy9zdHJpcGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUE2SSw2QkFBNkIsZ0JBQWdCLHdCQUF3QixhQUFhLEVBQUUsWUFBWSwrREFBK0QsdUJBQXVCLEVBQUUsc0RBQXNELHNCQUFzQixlQUFlLE1BQU0sdVRBQXVULGtCQUFrQixlQUFlLCtNQUErTSxhQUFhLDBDQUEwQyxTQUFTLGVBQWUsNERBQTRELFNBQVMsZUFBZSxvQ0FBb0MsU0FBUyxlQUFlLDJLQUEySyxTQUFTLGVBQWUsZ0dBQWdHLFNBQVMsZUFBZSw4REFBOEQsU0FBUyxlQUFlLG9IQUFvSCxTQUFTLGVBQWUsZ05BQWdOLFNBQVMsZUFBZSxtTkFBbU4sU0FBUyxlQUFlLHNEQUFzRCxTQUFTLEdBQUcsNEJBQTRCLHlDQUF5QyxjQUFjLElBQUksYUFBYSxTQUFTLE1BQU0sY0FBYyxJQUFJLGNBQWMsU0FBUyxNQUFNLGNBQWMsTUFBTSxnRUFBZ0UsS0FBSyxhQUFhLCtCQUErQixHQUFHLFFBQVEsd0JBQXdCLHdDQUF3QywyQkFBMkIsd0NBQXdDLDRFQUE0RSw0QkFBNEIsZ0RBQWdELG1FQUFtRSxJQUFJLGdCQUFnQixHQUFHLEtBQUssU0FBUyxHQUFHLEtBQUssUUFBUSxHQUFHLEtBQUssYUFBYSxHQUFHLEdBQUcsd0NBQXdDLGlCQUFpQixJQUFJLEVBQUUsaUJBQWlCLHdDQUF3Qyx5Q0FBeUMsOEZBQThGLG1CQUFtQixLQUFLLEVBQUUsd0JBQXdCLHdDQUF3QywyQ0FBMkMsd0NBQXdDLEVBQUUsd0JBQXdCLHdDQUF3QyxnREFBZ0Qsc0VBQXNFLDBCQUEwQixLQUFLLEVBQUUsUUFBUSx3Q0FBd0MsK0hBQStILGdDQUFnQyxFQUFFLGdCQUFnQiw0Q0FBNEMsRUFBRSx5Q0FBeUMsa0JBQWtCLGVBQWUsa0hBQWtILGtCQUFrQixlQUFlLDZMQUE2TCxhQUFhLHlTQUF5UyxTQUFTLEdBQUcsa0JBQWtCLGVBQWUsa0JBQWtCLFVB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RUFBRSw2RUFBNkUsU0FBUyxTQUFTLDBEQUEwRCxFQUFFLHdCQUF3Qix5Q0FBeUMsZ0lBQWdJLEVBQUUsd0JBQXdCLE1BQU0scUdBQXFHLE9BQU8sd0JBQXdCLDhDQUE4QyxVQUFVLElBQUksbUJBQW1CLFNBQVMsR0FBRyxHQUFHLHlCQUF5QixJQUFJLGdDQUFnQyxNQUFNLGlCQUFpQiw0Q0FBNEMsWUFBWSxLQUFLLCtCQUErQix3QkFBd0IseUNBQXlDLG1EQUFtRCwrRUFBK0UsRUFBRSxFQUFFLGVBQWUsd0JBQXdCLE1BQU0sT0FBTyxxRUFBcUUsbUNBQW1DLDBCQUEwQixpQkFBaUIseUNBQXlDLG9EQUFvRCxNQUFNLHNDQUFzQyw0Q0FBNEMsZ0JBQWdCLGdCQUFnQiw2Q0FBQyxzQ0FBc0MseUJBQXlCLEVBQUUseUJBQXlCLE1BQU0seUNBQXlDLHFFQUFxRSwrR0FBK0csRUFBRSwrQkFBK0IsVUFBVSx5Q0FBeUMsb0VBQW9FLGlDQUFpQyx3UUFBd1EsMkxBQTJMLEVBQUUsMEJBQTBCLDBCQUEwQixFQUFFLE9BQU8sNENBQTRDLCtCQUErQix5Q0FBeUMscUdBQXFHLEVBQUUsd0JBQXdCLDBEQUEwRCxNQUFNLFVBQVUsNENBQTRDLFdBQVcsU0FBUyx1Q0FBdUMsWUFBWSx5REFBeUQsMEJBQTBCLDJCQUEyQiw2SEFBNkgsZUFBZSxjQUFjLDJFQUFDLGFBQWEsa0JBQWtCLEVBQUUsZ0NBQWdDLEdBQUcsZUFBZSxHQUE0UTtBQUNuNXRFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2hlY2tvdXQvLi4vY2hlY2tvdXQtc2RrLWpzL2Rpc3QvZXNtL2ludGVncmF0aW9ucy9zdHJpcGUuanM/YTE3NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnR7Z2V0U2NyaXB0TG9hZGVyIGFzIGV9ZnJvbVwiQGJpZ2NvbW1lcmNlL3NjcmlwdC1sb2FkZXJcIjtpbXBvcnR7aW5jbHVkZXMgYXMgdCxpc0VtcHR5IGFzIGksb21pdEJ5IGFzIG4scm91bmQgYXMgcixzb21lIGFzIG99ZnJvbVwibG9kYXNoXCI7dmFyIHMsYSxkLGwsYyx1LGgscCxtLHksZz17fTtmdW5jdGlvbiB2KGUsdCl7cmV0dXJuIE9iamVjdC5hc3NpZ24oZSx7cmVzb2x2ZUlkczp0fSl9Zy5kPShlLHQpPT57Zm9yKHZhciBpIGluIHQpZy5vKHQsaSkmJiFnLm8oZSxpKSYmT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsaSx7ZW51bWVyYWJsZTohMCxnZXQ6dFtpXX0pfSxnLm89KGUsdCk9Pk9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLHQpO2NsYXNzIFMgZXh0ZW5kcyBFcnJvcntjb25zdHJ1Y3RvcihlKXt2YXIgdDtzdXBlcihlfHxcIkFuIHVuZXhwZWN0ZWQgZXJyb3IgaGFzIG9jY3VycmVkLlwiKSx0aGlzLm5hbWU9XCJTdGFuZGFyZEVycm9yXCIsdGhpcy50eXBlPVwic3RhbmRhcmRcIix0PW5ldy50YXJnZXQucHJvdG90eXBlLE9iamVjdC5zZXRQcm90b3R5cGVPZj9PYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyx0KTp0aGlzLl9fcHJvdG9fXz10LFwiZnVuY3Rpb25cIj09dHlwZW9mIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlP0Vycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsbmV3LnRhcmdldCk6dGhpcy5zdGFjaz1uZXcgRXJyb3IodGhpcy5tZXNzYWdlKS5zdGFja319Y2xhc3MgXyBleHRlbmRzIFN7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBjbGllbnQgbGlicmFyeSBvZiBhIHBheW1lbnQgbWV0aG9kIGlzIG5vdCBsb2FkZWQgb3IgcmVhZHkgdG8gYmUgdXNlZC5cIiksdGhpcy5uYW1lPVwiUGF5bWVudE1ldGhvZENsaWVudFVuYXZhaWxhYmxlRXJyb3JcIix0aGlzLnR5cGU9XCJwYXltZW50X21ldGhvZF9jbGllbnRfdW5hdmFpbGFibGVcIn19IWZ1bmN0aW9uKGUpe2UuU0hJUFBJTkc9XCJzaGlwcGluZ1wiLGUuQklMTElORz1cImJpbGxpbmdcIn0oc3x8KHM9e30pKSxmdW5jdGlvbihlKXtlLlNQTElUPVwic3BsaXRcIixlLkZVTEw9XCJmdWxsXCIsZS5PUkdBTklaQVRJT049XCJvcmdhbml6YXRpb25cIn0oYXx8KGE9e30pKSxmdW5jdGlvbihlKXtlLlNVQ0NFU1M9XCJzdWNjZXNzXCIsZS5FUlJPUj1cImVycm9yXCJ9KGR8fChkPXt9KSksZnVuY3Rpb24oZSl7ZS5DcmVkaXRDYXJkPVwiY2FyZFwiLGUuTGluaz1cImxpbmtcIixlLkVQUz1cImVwc1wiLGUuR1JBQlBBWT1cImdyYWJwYXlcIixlLkJBTkNPTlRBQ1Q9XCJiYW5jb250YWN0XCIsZS5JREVBTD1cImlkZWFsXCIsZS5BTElQQVk9XCJhbGlwYXlcIixlLktMQVJOQT1cImtsYXJuYVwiLGUuT0NTPVwib3B0aW1pemVkX2NoZWNrb3V0XCJ9KGx8fChsPXt9KSksZnVuY3Rpb24oZSl7ZS5ORVZFUj1cIm5ldmVyXCIsZS5BVVRPPVwiYXV0b1wiLGUuQUxXQVlTPVwiYWx3YXlzXCIsZS5QQVlNRU5UPVwicGF5bWVudFwiLGUuSUZfUkVRVUlSRUQ9XCJpZl9yZXF1aXJlZFwifShjfHwoYz17fSkpLGZ1bmN0aW9uKGUpe2UuVjM9XCJ2M1wiLGUuQUNBQ0lBPVwiYWNhY2lhXCIsZS5CQVNJTD1cImJhc2lsXCIsZS5DTE9WRVI9XCJjbG92ZXJcIn0odXx8KHU9e30pKSxmdW5jdGlvbihlKXtlLlBBWU1FTlQ9XCJwYXltZW50XCIsZS5BVVRIRU5USUNBVElPTj1cImxpbmtBdXRoZW50aWNhdGlvblwiLGUuU0hJUFBJTkc9XCJhZGRyZXNzXCIsZS5FWFBSRVNTX0NIRUNLT1VUPVwiZXhwcmVzc0NoZWNrb3V0XCJ9KGh8fChoPXt9KSksZnVuY3Rpb24oZSl7ZS5SRVFVSVJFU19QQVlNRU5UX01FVEhPRD1cInJlcXVpcmVzX3BheW1lbnRfbWV0aG9kXCIsZS5SRVFVSVJFU19DT05GSVJNQVRJT049XCJyZXF1aXJlc19jb25maXJtYXRpb25cIixlLlJFUVVJUkVTX0FDVElPTj1cInJlcXVpcmVzX2FjdGlvblwiLGUuUFJPQ0VTU0lORz1cInByb2Nlc3NpbmdcIixlLlNVQ0NFRURFRD1cInN1Y2NlZWRlZFwiLGUuQ0FOQ0VMRUQ9XCJjYW5jZWxlZFwifShwfHwocD17fSkpLGZ1bmN0aW9uKGUpe2UuQ0xJQ0s9XCJjbGlja1wiLGUuQ0hBTkdFPVwiY2hhbmdlXCIsZS5SRUFEWT1cInJlYWR5XCIsZS5TSElQUElOR19BRERSRVNTX0NIQU5HRT1cInNoaXBwaW5nYWRkcmVzc2NoYW5nZVwiLGUuU0hJUFBJTkdfUkFURV9DSEFOR0U9XCJzaGlwcGluZ3JhdGVjaGFuZ2VcIixlLkNPTkZJUk09XCJjb25maXJtXCIsZS5DQU5DRUw9XCJjYW5jZWxcIixlLkxPQURFUl9TVEFSVD1cImxvYWRlcnN0YXJ0XCJ9KG18fChtPXt9KSksZnVuY3Rpb24oZSl7ZS5PTl9TRVNTSU9OPVwib25fc2Vzc2lvblwiLGUuT0ZGX1NFU1NJT049XCJvZmZfc2Vzc2lvblwifSh5fHwoeT17fSkpO3ZhciBmLEMsRT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIHMoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBhKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihzLGEpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBJe2NvbnN0cnVjdG9yKGUsdD13aW5kb3cpe3RoaXMuc2NyaXB0TG9hZGVyPWUsdGhpcy5zdHJpcGVXaW5kb3c9dH1nZXRTdHJpcGVDbGllbnQoZSx0LGksbixyKXtyZXR1cm4gRSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYodGhpcy5zdHJpcGVXaW5kb3cuYmNTdHJpcGVDbGllbnQpcmV0dXJuIHRoaXMuc3RyaXBlV2luZG93LmJjU3RyaXBlQ2xpZW50O2NvbnN0IG89eWllbGQgdGhpcy5sb2FkKGkpLHtzdHJpcGVQdWJsaXNoYWJsZUtleTpzLHN0cmlwZUNvbm5lY3RlZEFjY291bnQ6YX09ZSxkPW8ocyxPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGE/e3N0cmlwZUFjY291bnQ6YX06e30pLHQ/e2xvY2FsZTp0fTp7fSksbj97YmV0YXM6bn06e30pLHI/e2FwaVZlcnNpb246cn06e30pKTtyZXR1cm4gT2JqZWN0LmFzc2lnbih0aGlzLnN0cmlwZVdpbmRvdyx7YmNTdHJpcGVDbGllbnQ6ZH0pLGR9KX1nZXRFbGVtZW50cyhlLHQpe3JldHVybiBFKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtsZXQgaT10aGlzLnN0cmlwZVdpbmRvdy5iY1N0cmlwZUVsZW1lbnRzO3JldHVybiBpP3lpZWxkIHRoaXMudXBkYXRlU3RyaXBlRWxlbWVudHModCk6KGk9ZS5lbGVtZW50cyh0KSxPYmplY3QuYXNzaWduKHRoaXMuc3RyaXBlV2luZG93LHtiY1N0cmlwZUVsZW1lbnRzOml9KSksaX0pfXVwZGF0ZVN0cmlwZUVsZW1lbnRzKGUpe3JldHVybiBFKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXRoaXMuc3RyaXBlV2luZG93LmJjU3RyaXBlRWxlbWVudHM7dCYmKHQudXBkYXRlKGUpLHlpZWxkIHQuZmV0Y2hVcGRhdGVzKCkpfSl9Z2V0Q2hlY2tvdXRTZXNzaW9uKGUsdCl7cmV0dXJuIEUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2xldCBpPXRoaXMuc3RyaXBlV2luZG93LmJjU3RyaXBlQ2hlY2tvdXRTZXNzaW9uO3JldHVybiBpfHwoaT15aWVsZCBlLmluaXRDaGVja291dCh0KSxPYmplY3QuYXNzaWduKHRoaXMuc3RyaXBlV2luZG93LHtiY1N0cmlwZUNoZWNrb3V0U2Vzc2lvbjppfSkpLGl9KX1sb2FkKGUpe3JldHVybiBFKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5zdHJpcGVXaW5kb3cuU3RyaXBlJiYoeWllbGQgdGhpcy5zY3JpcHRMb2FkZXIubG9hZFNjcmlwdCh0aGlzLmdldFNjcmlwdFVybChlKSksIXRoaXMuc3RyaXBlV2luZG93LlN0cmlwZSkpdGhyb3cgbmV3IF87cmV0dXJuIHRoaXMuc3RyaXBlV2luZG93LlN0cmlwZX0pfWdldFNjcmlwdFVybChlKXtyZXR1cm4gZSYmZSE9PXUuVjM/YGh0dHBzOi8vanMuc3RyaXBlLmNvbS8ke2V9L3N0cmlwZS5qc2A6XCJodHRwczovL2pzLnN0cmlwZS5jb20vdjMvXCJ9fWNsYXNzIFAgZXh0ZW5kcyBTe2NvbnN0cnVjdG9yKGUpe3N1cGVyKGV8fFwiUGF5bWVudCBwcm9jZXNzIHdhcyBjYW5jZWxsZWQuXCIpLHRoaXMubmFtZT1cIlBheW1lbnRNZXRob2RDYW5jZWxsZWRFcnJvclwiLHRoaXMudHlwZT1cInBheW1lbnRfY2FuY2VsbGVkXCJ9fWNsYXNzIGIgZXh0ZW5kcyBTe2NvbnN0cnVjdG9yKGUpe3N1cGVyKGV8fFwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgY2xpZW50IGxpYnJhcnkgb2YgYSBwYXltZW50IG1ldGhvZCBoYXMgdGhyb3duIGFuIHVuZXhwZWN0ZWQgZXJyb3IuXCIpLHRoaXMubmFtZT1cIlBheW1lbnRNZXRob2RGYWlsZWRFcnJvclwiLHRoaXMudHlwZT1cInBheW1lbnRfbWV0aG9kX2NsaWVudF9pbnZhbGlkXCJ9fSFmdW5jdGlvbihlKXtlW2UuQ2hlY2tvdXRCdXR0b25Ob3RJbml0aWFsaXplZD0wXT1cIkNoZWNrb3V0QnV0dG9uTm90SW5pdGlhbGl6ZWRcIixlW2UuQ3VzdG9tZXJOb3RJbml0aWFsaXplZD0xXT1cIkN1c3RvbWVyTm90SW5pdGlhbGl6ZWRcIixlW2UuUGF5bWVudE5vdEluaXRpYWxpemVkPTJdPVwiUGF5bWVudE5vdEluaXRpYWxpemVkXCIsZVtlLlNoaXBwaW5nTm90SW5pdGlhbGl6ZWQ9M109XCJTaGlwcGluZ05vdEluaXRpYWxpemVkXCIsZVtlLlNwYW1Qcm90ZWN0aW9uTm90SW5pdGlhbGl6ZWQ9NF09XCJTcGFtUHJvdGVjdGlvbk5vdEluaXRpYWxpemVkXCJ9KGZ8fChmPXt9KSk7Y2xhc3MgdyBleHRlbmRzIFN7Y29uc3RydWN0b3IoZSl7c3VwZXIoZnVuY3Rpb24oZSl7c3dpdGNoKGUpe2Nhc2UgZi5DdXN0b21lck5vdEluaXRpYWxpemVkOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgY3VzdG9tZXIgc3RlcCBvZiBjaGVja291dCBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCI7Y2FzZSBmLlBheW1lbnROb3RJbml0aWFsaXplZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHBheW1lbnQgc3RlcCBvZiBjaGVja291dCBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCI7Y2FzZSBmLlNoaXBwaW5nTm90SW5pdGlhbGl6ZWQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBzaGlwcGluZyBzdGVwIG9mIGNoZWNrb3V0IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIjtjYXNlIGYuU3BhbVByb3RlY3Rpb25Ob3RJbml0aWFsaXplZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIGNoZWNrb3V0IHNwYW0gcHJvdGVjdGlvbiBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCI7ZGVmYXVsdDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHJlcXVpcmVkIGNvbXBvbmVudCBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCJ9fShlKSksdGhpcy5zdWJ0eXBlPWUsdGhpcy5uYW1lPVwiTm90SW5pdGlhbGl6ZWRFcnJvclwiLHRoaXMudHlwZT1cIm5vdF9pbml0aWFsaXplZFwifX0hZnVuY3Rpb24oZSl7ZVtlLk1pc3NpbmdCaWxsaW5nQWRkcmVzcz0wXT1cIk1pc3NpbmdCaWxsaW5nQWRkcmVzc1wiLGVbZS5NaXNzaW5nQ2FydD0xXT1cIk1pc3NpbmdDYXJ0XCIsZVtlLk1pc3NpbmdDaGVja291dD0yXT1cIk1pc3NpbmdDaGVja291dFwiLGVbZS5NaXNzaW5nQ29uc2lnbm1lbnRzPTNdPVwiTWlzc2luZ0NvbnNpZ25tZW50c1wiLGVbZS5NaXNzaW5nQ3VzdG9tZXI9NF09XCJNaXNzaW5nQ3VzdG9tZXJcIixlW2UuTWlzc2luZ0NoZWNrb3V0Q29uZmlnPTVdPVwiTWlzc2luZ0NoZWNrb3V0Q29uZmlnXCIsZVtlLk1pc3NpbmdPcmRlcj02XT1cIk1pc3NpbmdPcmRlclwiLGVbZS5NaXNzaW5nT3JkZXJDb25maWc9N109XCJNaXNzaW5nT3JkZXJDb25maWdcIixlW2UuTWlzc2luZ09yZGVySWQ9OF09XCJNaXNzaW5nT3JkZXJJZFwiLGVbZS5NaXNzaW5nUGF5bWVudD05XT1cIk1pc3NpbmdQYXltZW50XCIsZVtlLk1pc3NpbmdQYXltZW50SWQ9MTBdPVwiTWlzc2luZ1BheW1lbnRJZFwiLGVbZS5NaXNzaW5nUGF5bWVudEluc3RydW1lbnQ9MTFdPVwiTWlzc2luZ1BheW1lbnRJbnN0cnVtZW50XCIsZVtlLk1pc3NpbmdQYXltZW50TWV0aG9kPTEyXT1cIk1pc3NpbmdQYXltZW50TWV0aG9kXCIsZVtlLk1pc3NpbmdQYXltZW50UmVkaXJlY3RVcmw9MTNdPVwiTWlzc2luZ1BheW1lbnRSZWRpcmVjdFVybFwiLGVbZS5NaXNzaW5nUGF5bWVudFN0YXR1cz0xNF09XCJNaXNzaW5nUGF5bWVudFN0YXR1c1wiLGVbZS5NaXNzaW5nUGF5bWVudFRva2VuPTE1XT1cIk1pc3NpbmdQYXltZW50VG9rZW5cIixlW2UuTWlzc2luZ1NoaXBwaW5nQWRkcmVzcz0xNl09XCJNaXNzaW5nU2hpcHBpbmdBZGRyZXNzXCJ9KEN8fChDPXt9KSk7Y2xhc3MgQSBleHRlbmRzIFN7Y29uc3RydWN0b3IoZSl7c3VwZXIoZnVuY3Rpb24oZSl7c3dpdGNoKGUpe2Nhc2UgQy5NaXNzaW5nQmlsbGluZ0FkZHJlc3M6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGJpbGxpbmcgYWRkcmVzcyBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgQy5NaXNzaW5nQ2FydDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgY2FydCBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgQy5NaXNzaW5nQ29uc2lnbm1lbnRzOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBjb25zaWdubWVudHMgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIEMuTWlzc2luZ0NoZWNrb3V0OnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBjaGVja291dCBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgQy5NaXNzaW5nQ3VzdG9tZXI6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGN1c3RvbWVyIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBDLk1pc3NpbmdDaGVja291dENvbmZpZzpjYXNlIEMuTWlzc2luZ09yZGVyQ29uZmlnOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBjb25maWd1cmF0aW9uIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBDLk1pc3NpbmdPcmRlcjpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2Ugb3JkZXIgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIEMuTWlzc2luZ09yZGVySWQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIG9yZGVyIElEIGlzIHVuYXZhaWxhYmxlIG9yIG5vdCBnZW5lcmF0ZWQgeWV0LlwiO2Nhc2UgQy5NaXNzaW5nUGF5bWVudDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgcGF5bWVudCBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgQy5NaXNzaW5nUGF5bWVudFRva2VuOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgdG9rZW4gcmVxdWlyZWQgdG8gc3VibWl0IGEgcGF5bWVudCBpcyBtaXNzaW5nLlwiO2Nhc2UgQy5NaXNzaW5nUGF5bWVudE1ldGhvZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgcGF5bWVudCBtZXRob2QgZGF0YSBpcyB1bmF2YWlsYWJsZSBvciBub3QgcHJvcGVybHkgY29uZmlndXJlZC5cIjtjYXNlIEMuTWlzc2luZ1NoaXBwaW5nQWRkcmVzczpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2Ugc2hpcHBpbmcgYWRkcmVzcyBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2RlZmF1bHQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSByZXF1aXJlZCBkYXRhIGlzIHVuYXZhaWxhYmxlLlwifX0oZSkpLHRoaXMuc3VidHlwZT1lLHRoaXMubmFtZT1cIk1pc3NpbmdEYXRhRXJyb3JcIix0aGlzLnR5cGU9XCJtaXNzaW5nX2RhdGFcIn19dmFyIE89ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBzKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gYShlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4ocyxhKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgTXtjb25zdHJ1Y3RvcihlLHQpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuc2NyaXB0TG9hZGVyPXQsdGhpcy5pc01vdW50ZWQ9ITF9ZGVpbml0aWFsaXplKCl7dmFyIGU7bnVsbD09PShlPXRoaXMuY2hlY2tvdXRFdmVudHNVbnN1YnNjcmliZSl8fHZvaWQgMD09PWV8fGUuY2FsbCh0aGlzKSx0aGlzLmlzTW91bnRlZD0hMX1pbml0Q2hlY2tvdXRFdmVudHNTdWJzY3JpcHRpb24oZSx0LGksbil7dGhpcy5jaGVja291dEV2ZW50c1Vuc3Vic2NyaWJlPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJzY3JpYmUoKCk9Pk8odGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3ZhciByO2NvbnN0IG89bnVsbD09bj92b2lkIDA6bi5nZXRFbGVtZW50KGguUEFZTUVOVCk7aWYobyl7dHJ5e3lpZWxkIHRoaXMudXBkYXRlU3RyaXBlUGF5bWVudEludGVudChlLHQpfWNhdGNoKGUpe3JldHVybiB0aGlzLmlzTW91bnRlZCYmKG8udW5tb3VudCgpLHRoaXMuaXNNb3VudGVkPSExKSx2b2lkKGUgaW5zdGFuY2VvZiBFcnJvciYmKG51bGw9PT0ocj1pLm9uRXJyb3IpfHx2b2lkIDA9PT1yfHxyLmNhbGwoaSxlKSkpfXRoaXMuaXNNb3VudGVkfHwoeWllbGQgbnVsbD09bj92b2lkIDA6bi5mZXRjaFVwZGF0ZXMoKSx0aGlzLm1vdW50RWxlbWVudChvLGkuY29udGFpbmVySWQpKX19KSxlPT57dmFyIHQ7cmV0dXJuIG51bGw9PT0odD1lLmdldENoZWNrb3V0KCkpfHx2b2lkIDA9PT10P3ZvaWQgMDp0Lm91dHN0YW5kaW5nQmFsYW5jZX0sZT0+e3ZhciB0O3JldHVybiBudWxsPT09KHQ9ZS5nZXRDaGVja291dCgpKXx8dm9pZCAwPT09dD92b2lkIDA6dC5jb3Vwb25zfSl9bW91bnRFbGVtZW50KGUsdCl7ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodCkmJihlLm1vdW50KGAjJHt0fWApLHRoaXMuaXNNb3VudGVkPSEwKX1tYXBBcHBlYXJhbmNlVmFyaWFibGVzKGUpe3JldHVybntjb2xvclByaW1hcnk6ZS5maWVsZElubmVyU2hhZG93LGNvbG9yQmFja2dyb3VuZDplLmZpZWxkQmFja2dyb3VuZCxjb2xvclRleHQ6ZS5sYWJlbFRleHQsY29sb3JEYW5nZXI6ZS5maWVsZEVycm9yVGV4dCxjb2xvclRleHRTZWNvbmRhcnk6ZS5sYWJlbFRleHQsY29sb3JUZXh0UGxhY2Vob2xkZXI6ZS5maWVsZFBsYWNlaG9sZGVyVGV4dCxjb2xvckljb246ZS5maWVsZFBsYWNlaG9sZGVyVGV4dH19bWFwSW5wdXRBcHBlYXJhbmNlUnVsZXMoZSl7cmV0dXJue2JvcmRlckNvbG9yOmUuZmllbGRCb3JkZXIsY29sb3I6ZS5maWVsZFRleHQsYm94U2hhZG93OmUuZmllbGRJbm5lclNoYWRvd319dGhyb3dTdHJpcGVFcnJvcihlKXtpZihcIm9iamVjdFwiPT10eXBlb2YodD1lKSYmbnVsbCE9PXQmJlwidHlwZVwiaW4gdCYmKHRoaXMudGhyb3dEaXNwbGF5YWJsZVN0cmlwZUVycm9yKGUpLHRoaXMuaXNDYW5jZWxsYXRpb25FcnJvcihlKSkpdGhyb3cgbmV3IFA7dmFyIHQ7dGhyb3cgbmV3IGJ9dGhyb3dEaXNwbGF5YWJsZVN0cmlwZUVycm9yKGUpe2lmKHQoW1wiY2FyZF9lcnJvclwiLFwiaW52YWxpZF9yZXF1ZXN0X2Vycm9yXCIsXCJ2YWxpZGF0aW9uX2Vycm9yXCJdLGUudHlwZSkpdGhyb3cgbmV3IEVycm9yKGUubWVzc2FnZSl9aXNDYW5jZWxsYXRpb25FcnJvcihlKXt2YXIgdDtjb25zdCBpPW51bGw9PT0odD1udWxsPT1lP3ZvaWQgMDplLnBheW1lbnRfaW50ZW50Lmxhc3RfcGF5bWVudF9lcnJvcil8fHZvaWQgMD09PXQ/dm9pZCAwOnQubWVzc2FnZTtyZXR1cm4hIWkmJi0xIT09aS5pbmRleE9mKFwiY2FuY2VsZWRcIil9dGhyb3dQYXltZW50Q29uZmlybWF0aW9uUHJvY2VlZE1lc3NhZ2UoKXt0aHJvdyBuZXcgYihcIldlJ3ZlIHJlY2VpdmVkIHlvdXIgb3JkZXIgYW5kIGFyZSBwcm9jZXNzaW5nIHlvdXIgcGF5bWVudC4gT25jZSB0aGUgcGF5bWVudCBpcyB2ZXJpZmllZCwgeW91ciBvcmRlciB3aWxsIGJlIGNvbXBsZXRlZC4gV2Ugd2lsbCBzZW5kIHlvdSBhbiBlbWFpbCB3aGVuIGl0J3MgY29tcGxldGVkLiBQbGVhc2Ugbm90ZSwgdGhpcyBwcm9jZXNzIG1heSB0YWtlIGEgZmV3IG1pbnV0ZXMgZGVwZW5kaW5nIG9uIHRoZSBwcm9jZXNzaW5nIHRpbWVzIG9mIHlvdXIgY2hvc2VuIG1ldGhvZC5cIil9aXNQYXltZW50Q29tcGxldGVkKGUsdCl7cmV0dXJuIE8odGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksbj1pLmdldFBheW1lbnRNZXRob2RPclRocm93KGUpLHtmZWF0dXJlczpyfT1pLmdldFN0b3JlQ29uZmlnT3JUaHJvdygpLmNoZWNrb3V0U2V0dGluZ3M7aWYoIW4uY2xpZW50VG9rZW58fCF0fHwhcltcIlBJLTYyNi5CbG9ja191bm5lY2Vzc2FyeV9wYXltZW50X2NvbmZpcm1hdGlvbl9mb3JfU3RyaXBlVVBFXCJdKXJldHVybiExO2NvbnN0e3BheW1lbnRJbnRlbnQ6b309eWllbGQgdC5yZXRyaWV2ZVBheW1lbnRJbnRlbnQobi5jbGllbnRUb2tlbik7cmV0dXJuKG51bGw9PW8/dm9pZCAwOm8uc3RhdHVzKT09PXAuU1VDQ0VFREVEfSl9bWFwU3RyaXBlUGF5bWVudERhdGEoZSx0LGk9ITEpe2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0QmlsbGluZ0FkZHJlc3MoKSx7Zmlyc3ROYW1lOnI9XCJcIixsYXN0TmFtZTpvPVwiXCIsZW1haWw6cz1cIlwifT1ufHx7fSxhPXRoaXMuX21hcFN0cmlwZUFkZHJlc3Mobik7aWYoIWUpdGhyb3cgbmV3IHcoZi5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO2lmKCEocyYmYSYmYS5jaXR5JiZhLmNvdW50cnkmJnImJm8pKXRocm93IG5ldyBBKEMuTWlzc2luZ0JpbGxpbmdBZGRyZXNzKTtyZXR1cm57ZWxlbWVudHM6ZSxyZWRpcmVjdDpjLklGX1JFUVVJUkVELGNvbmZpcm1QYXJhbXM6T2JqZWN0LmFzc2lnbih7cGF5bWVudF9tZXRob2RfZGF0YTpPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30saT97YWxsb3dfcmVkaXNwbGF5OlwiYWx3YXlzXCJ9Ont9KSx7YmlsbGluZ19kZXRhaWxzOntlbWFpbDpzLGFkZHJlc3M6YSxuYW1lOmAke3J9ICR7b31gfX0pfSx0JiZ7cmV0dXJuX3VybDp0fSl9fWlzQWRkaXRpb25hbEFjdGlvbkVycm9yKGUpe3JldHVybiBvKGUse2NvZGU6XCJhZGRpdGlvbmFsX2FjdGlvbl9yZXF1aXJlZFwifSl9aXNSZWRpcmVjdEFjdGlvbihlKXtjb25zdHt0eXBlOnQsZGF0YTp7cmVkaXJlY3RfdXJsOml9fT1lO3JldHVyblwicmVkaXJlY3RfdG9fdXJsXCI9PT10JiYhIWl9aXNPblBhZ2VBZGRpdGlvbmFsQWN0aW9uKGUpe2NvbnN0e3R5cGU6dCxkYXRhOnt0b2tlbjppfX09ZTtyZXR1cm5cImFkZGl0aW9uYWxfYWN0aW9uX3JlcXVpcmVzX3BheW1lbnRfbWV0aG9kXCI9PT10JiYhIWl9dXBkYXRlU3RyaXBlUGF5bWVudEludGVudChlLHQpe3JldHVybiBPKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPXlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChlLHtwYXJhbXM6e21ldGhvZDp0fX0pLHtjbGllbnRUb2tlbjpufT1pLmdldFBheW1lbnRNZXRob2RPclRocm93KHQpO24mJnRoaXMuc2NyaXB0TG9hZGVyLnVwZGF0ZVN0cmlwZUVsZW1lbnRzKHtjbGllbnRTZWNyZXQ6bn0pfSl9Z2V0U3RyaXBlSnNWZXJzaW9uKGUpe3JldHVybiBlLnVzZU5ld1N0cmlwZUpzVmVyc2lvbj91LkNMT1ZFUjp1LlYzfV9tYXBTdHJpcGVBZGRyZXNzKGUpe2lmKGUpe2NvbnN0e2NpdHk6dCxhZGRyZXNzMTppLGFkZHJlc3MyOm4sY291bnRyeUNvZGU6cixwb3N0YWxDb2RlOm8sc3RhdGVPclByb3ZpbmNlQ29kZTpzfT1lO3JldHVybiBPYmplY3QuYXNzaWduKHtjaXR5OnQsY291bnRyeTpyLHBvc3RhbF9jb2RlOm8sbGluZTE6aSxsaW5lMjpufSxzP3tzdGF0ZTpzfTp7fSl9dGhyb3cgbmV3IEEoQy5NaXNzaW5nQmlsbGluZ0FkZHJlc3MpfX1jb25zdCBrPXtzaXplOjcwLGNvbG9yOlwiI2Q5ZDlkOVwiLGJhY2tncm91bmRDb2xvcjpcIiNmZmZmZmZcIn0sVD17cG9zaXRpb246XCJmaXhlZFwiLFwiYmFja2dyb3VuZC1jb2xvclwiOlwicmdiYSgwLCAwLCAwLCAwLjQpXCIsXCJ6LWluZGV4XCI6XCIxMDAwXCJ9LE49XCJlbWJlZGRlZC1jaGVja291dC1sb2FkaW5nLWluZGljYXRvci1yb3RhdGlvblwiO2NsYXNzIFJ7Y29uc3RydWN0b3IoZSl7dGhpcy5zdHlsZXM9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGspLGUmJmUuc3R5bGVzKSx0aGlzLmNvbnRhaW5lclN0eWxlcz1PYmplY3QuYXNzaWduKHt9LGUmJmUuY29udGFpbmVyU3R5bGVzKSx0aGlzLmRlZmluZUFuaW1hdGlvbigpLHRoaXMuY29udGFpbmVyPXRoaXMuYnVpbGRDb250YWluZXIoKSx0aGlzLmluZGljYXRvcj10aGlzLmJ1aWxkSW5kaWNhdG9yKCksdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5pbmRpY2F0b3IpfXNob3coZSl7aWYoZSl7Y29uc3QgdD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChlKTtpZighdCl0aHJvdyBuZXcgRXJyb3IoXCJVbmFibGUgdG8gYXR0YWNoIHRoZSBsb2FkaW5nIGluZGljYXRvciBiZWNhdXNlIHRoZSBwYXJlbnQgSUQgaXMgbm90IHZhbGlkLlwiKTt0LmFwcGVuZENoaWxkKHRoaXMuY29udGFpbmVyKX10aGlzLmNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5PVwidmlzaWJsZVwiLHRoaXMuY29udGFpbmVyLnN0eWxlLm9wYWNpdHk9XCIxXCJ9aGlkZSgpe2NvbnN0IGU9KCk9Pnt0aGlzLmNvbnRhaW5lci5zdHlsZS52aXNpYmlsaXR5PVwiaGlkZGVuXCIsdGhpcy5jb250YWluZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIixlKX07dGhpcy5jb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIixlKSx0aGlzLmNvbnRhaW5lci5zdHlsZS5vcGFjaXR5PVwiMFwifWJ1aWxkQ29udGFpbmVyKCl7Y29uc3QgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3JldHVybiBlLnN0eWxlLmRpc3BsYXk9XCJibG9ja1wiLGUuc3R5bGUuYm90dG9tPVwiMFwiLGUuc3R5bGUubGVmdD1cIjBcIixlLnN0eWxlLmhlaWdodD1cIjEwMCVcIixlLnN0eWxlLndpZHRoPVwiMTAwJVwiLGUuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiLGUuc3R5bGUucmlnaHQ9XCIwXCIsZS5zdHlsZS50b3A9XCIwXCIsZS5zdHlsZS50cmFuc2l0aW9uPVwiYWxsIDI1MG1zIGVhc2Utb3V0XCIsZS5zdHlsZS5vcGFjaXR5PVwiMFwiLHRoaXMuc2V0U3R5bGVBdHRyaWJ1dGUoZSx0aGlzLmNvbnRhaW5lclN0eWxlcyksZX1idWlsZEluZGljYXRvcigpe2NvbnN0IGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtyZXR1cm4gZS5zdHlsZS5kaXNwbGF5PVwiYmxvY2tcIixlLnN0eWxlLndpZHRoPWAke3RoaXMuc3R5bGVzLnNpemV9cHhgLGUuc3R5bGUuaGVpZ2h0PWAke3RoaXMuc3R5bGVzLnNpemV9cHhgLGUuc3R5bGUuYm9yZGVyUmFkaXVzPWAke3RoaXMuc3R5bGVzLnNpemV9cHhgLGUuc3R5bGUuYm9yZGVyPVwic29saWQgMXB4XCIsZS5zdHlsZS5ib3JkZXJDb2xvcj1gJHt0aGlzLnN0eWxlcy5iYWNrZ3JvdW5kQ29sb3J9ICR7dGhpcy5zdHlsZXMuYmFja2dyb3VuZENvbG9yfSAke3RoaXMuc3R5bGVzLmNvbG9yfSAke3RoaXMuc3R5bGVzLmNvbG9yfWAsZS5zdHlsZS5tYXJnaW49XCIwIGF1dG9cIixlLnN0eWxlLnBvc2l0aW9uPVwiYWJzb2x1dGVcIixlLnN0eWxlLmxlZnQ9XCIwXCIsZS5zdHlsZS5yaWdodD1cIjBcIixlLnN0eWxlLnRvcD1cIjUwJVwiLGUuc3R5bGUudHJhbnNmb3JtPVwidHJhbnNsYXRlWSgtNTAlKSByb3RhdGUoMGRlZylcIixlLnN0eWxlLnRyYW5zZm9ybVN0eWxlPVwicHJlc2VydmUtM2RcIixlLnN0eWxlLmFuaW1hdGlvbj1gJHtOfSA1MDBtcyBpbmZpbml0ZSBjdWJpYy1iZXppZXIoMC42OSwgMC4zMSwgMC41NiwgMC44MylgLGV9c2V0U3R5bGVBdHRyaWJ1dGUoZSx0KXtPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGk9PntlLnN0eWxlLnNldFByb3BlcnR5KGksdFtpXSl9KX1kZWZpbmVBbmltYXRpb24oKXt2YXIgZTtpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChOKSlyZXR1cm47Y29uc3QgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7dC5pZD1OLG51bGw9PT0oZT1kb2N1bWVudC5oZWFkKXx8dm9pZCAwPT09ZXx8ZS5hcHBlbmRDaGlsZCh0KSx0LnNoZWV0IGluc3RhbmNlb2YgQ1NTU3R5bGVTaGVldCYmdC5zaGVldC5pbnNlcnRSdWxlKGBcXG4gICAgICAgICAgICAgICAgQGtleWZyYW1lcyAke059IHtcXG4gICAgICAgICAgICAgICAgICAgIDAlIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpIHJvdGF0ZSgwZGVnKTsgfVxcbiAgICAgICAgICAgICAgICAgICAgMTAwJSB7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKSByb3RhdGUoMzYwZGVnKTsgfVxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgYCwwKX19Y29uc3QgRD1lPT5cIm9iamVjdFwiPT10eXBlb2YgZSYmbnVsbCE9PWUmJlwiYm9keVwiaW4gZTtjbGFzcyB6e2NvbnN0cnVjdG9yKGUpe3RoaXMuX2RlY2ltYWxQbGFjZXM9ZX10b0ludGVnZXIoZSl7cmV0dXJuIE1hdGgucm91bmQoZSpNYXRoLnBvdygxMCx0aGlzLl9kZWNpbWFsUGxhY2VzKSl9fWZ1bmN0aW9uIEwoZSl7cmV0dXJuXCJvYmplY3RcIj09dHlwZW9mIGUmJm51bGwhPT1lJiZcImluaXRpYWxpemF0aW9uRGF0YVwiaW4gZSYmdm9pZCAwIT09ZS5pbml0aWFsaXphdGlvbkRhdGEmJm51bGwhPT1lLmluaXRpYWxpemF0aW9uRGF0YSYmXCJvYmplY3RcIj09dHlwZW9mIGUuaW5pdGlhbGl6YXRpb25EYXRhJiZcInN0cmlwZVB1Ymxpc2hhYmxlS2V5XCJpbiBlLmluaXRpYWxpemF0aW9uRGF0YSYmXCJzdHJpcGVDb25uZWN0ZWRBY2NvdW50XCJpbiBlLmluaXRpYWxpemF0aW9uRGF0YSYmXCJzaG9wcGVyTGFuZ3VhZ2VcImluIGUuaW5pdGlhbGl6YXRpb25EYXRhJiZ2b2lkIDAhPT1lLmluaXRpYWxpemF0aW9uRGF0YS5zdHJpcGVQdWJsaXNoYWJsZUtleSYmdm9pZCAwIT09ZS5pbml0aWFsaXphdGlvbkRhdGEuc3RyaXBlQ29ubmVjdGVkQWNjb3VudCYmdm9pZCAwIT09ZS5pbml0aWFsaXphdGlvbkRhdGEuc2hvcHBlckxhbmd1YWdlfWNvbnN0IFU9W1wiQUNcIixcIkFEXCIsXCJBRVwiLFwiQUZcIixcIkFHXCIsXCJBSVwiLFwiQUxcIixcIkFNXCIsXCJBT1wiLFwiQVFcIixcIkFSXCIsXCJBVFwiLFwiQVVcIixcIkFXXCIsXCJBWFwiLFwiQVpcIixcIkJBXCIsXCJCQlwiLFwiQkRcIixcIkJFXCIsXCJCRlwiLFwiQkdcIixcIkJIXCIsXCJCSVwiLFwiQkpcIixcIkJMXCIsXCJCTVwiLFwiQk5cIixcIkJPXCIsXCJCUVwiLFwiQlJcIixcIkJTXCIsXCJCVFwiLFwiQlZcIixcIkJXXCIsXCJCWVwiLFwiQlpcIixcIkNBXCIsXCJDRFwiLFwiQ0ZcIixcIkNHXCIsXCJDSFwiLFwiQ0lcIixcIkNLXCIsXCJDTFwiLFwiQ01cIixcIkNOXCIsXCJDT1wiLFwiQ1JcIixcIkNWXCIsXCJDV1wiLFwiQ1lcIixcIkNaXCIsXCJERVwiLFwiREpcIixcIkRLXCIsXCJETVwiLFwiRE9cIixcIkRaXCIsXCJFQ1wiLFwiRUVcIixcIkVHXCIsXCJFSFwiLFwiRVJcIixcIkVTXCIsXCJFVFwiLFwiRklcIixcIkZKXCIsXCJGS1wiLFwiRk9cIixcIkZSXCIsXCJHQVwiLFwiR0JcIixcIkdEXCIsXCJHRVwiLFwiR0ZcIixcIkdHXCIsXCJHSFwiLFwiR0lcIixcIkdMXCIsXCJHTVwiLFwiR05cIixcIkdQXCIsXCJHUVwiLFwiR1JcIixcIkdTXCIsXCJHVFwiLFwiR1VcIixcIkdXXCIsXCJHWVwiLFwiSEtcIixcIkhOXCIsXCJIUlwiLFwiSFRcIixcIkhVXCIsXCJJRFwiLFwiSUVcIixcIklMXCIsXCJJTVwiLFwiSU5cIixcIklPXCIsXCJJUVwiLFwiSVNcIixcIklUXCIsXCJKRVwiLFwiSk1cIixcIkpPXCIsXCJKUFwiLFwiS0VcIixcIktHXCIsXCJLSFwiLFwiS0lcIixcIktNXCIsXCJLTlwiLFwiS1JcIixcIktXXCIsXCJLWVwiLFwiS1pcIixcIkxBXCIsXCJMQlwiLFwiTENcIixcIkxJXCIsXCJMS1wiLFwiTFJcIixcIkxTXCIsXCJMVFwiLFwiTFVcIixcIkxWXCIsXCJMWVwiLFwiTUFcIixcIk1DXCIsXCJNRFwiLFwiTUVcIixcIk1GXCIsXCJNR1wiLFwiTUtcIixcIk1MXCIsXCJNTVwiLFwiTU5cIixcIk1PXCIsXCJNUVwiLFwiTVJcIixcIk1TXCIsXCJNVFwiLFwiTVVcIixcIk1WXCIsXCJNV1wiLFwiTVhcIixcIk1ZXCIsXCJNWlwiLFwiTkFcIixcIk5DXCIsXCJORVwiLFwiTkdcIixcIk5JXCIsXCJOTFwiLFwiTk9cIixcIk5QXCIsXCJOUlwiLFwiTlVcIixcIk5aXCIsXCJPTVwiLFwiUEFcIixcIlBFXCIsXCJQRlwiLFwiUEdcIixcIlBIXCIsXCJQS1wiLFwiUExcIixcIlBNXCIsXCJQTlwiLFwiUFJcIixcIlBTXCIsXCJQVFwiLFwiUFlcIixcIlFBXCIsXCJSRVwiLFwiUk9cIixcIlJTXCIsXCJSVVwiLFwiUldcIixcIlNBXCIsXCJTQlwiLFwiU0NcIixcIlNEXCIsXCJTRVwiLFwiU0dcIixcIlNIXCIsXCJTSVwiLFwiU0pcIixcIlNLXCIsXCJTTFwiLFwiU01cIixcIlNOXCIsXCJTT1wiLFwiU1JcIixcIlNTXCIsXCJTVFwiLFwiU1ZcIixcIlNYXCIsXCJTWlwiLFwiVEFcIixcIlRDXCIsXCJURFwiLFwiVEZcIixcIlRHXCIsXCJUSFwiLFwiVEpcIixcIlRLXCIsXCJUTFwiLFwiVE1cIixcIlROXCIsXCJUT1wiLFwiVFJcIixcIlRUXCIsXCJUVlwiLFwiVFdcIixcIlRaXCIsXCJVQVwiLFwiVUdcIixcIlVTXCIsXCJVWVwiLFwiVVpcIixcIlZBXCIsXCJWQ1wiLFwiVkVcIixcIlZHXCIsXCJWTlwiLFwiVlVcIixcIldGXCIsXCJXU1wiLFwiWEtcIixcIllFXCIsXCJZVFwiLFwiWkFcIixcIlpNXCIsXCJaV1wiLFwiWlpcIl07dmFyIFY9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBzKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gYShlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4ocyxhKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgeHtjb25zdHJ1Y3RvcihlLHQsaSxuKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLnNjcmlwdExvYWRlcj10LHRoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlPWksdGhpcy5sb2FkaW5nSW5kaWNhdG9yPW59aW5pdGlhbGl6ZShlKXtyZXR1cm4gVih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7c3RyaXBlb2NzOnQsY29udGFpbmVySWQ6aX09ZXx8e307aWYoIXR8fCFpKXRocm93IG5ldyB3KGYuUGF5bWVudE5vdEluaXRpYWxpemVkKTtjb25zdHttZXRob2RJZDpuLGdhdGV3YXlJZDpyfT10O2lmKCFufHwhcil0aHJvdyBuZXcgQShDLk1pc3NpbmdQYXltZW50TWV0aG9kKTtjb25zdCBvPXlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChyLHtwYXJhbXM6e21ldGhvZDpufX0pLHM9by5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhuLHIpLHtsb2FkaW5nQ29udGFpbmVySWQ6YSxidXR0b25IZWlnaHQ6ZCxvbkNvbXBsZXRlOmx9PXQ7aWYodGhpcy5fbG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj1hLHRoaXMuX29uQ29tcGxldGU9bCwhTChzKSl0aHJvdyBuZXcgQShDLk1pc3NpbmdQYXltZW50TWV0aG9kKTtjb25zdHtpbml0aWFsaXphdGlvbkRhdGE6Y309cyx7Y2FwdHVyZU1ldGhvZDp1fT1jLGg9dGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RyaXBlSnNWZXJzaW9uKGMpO3RoaXMuX2NhcHR1cmVNZXRob2Q9dSx0aGlzLl9zdHJpcGVDbGllbnQ9eWllbGQgdGhpcy5zY3JpcHRMb2FkZXIuZ2V0U3RyaXBlQ2xpZW50KGMsby5nZXRDYXJ0TG9jYWxlKCksaCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWREZWZhdWx0Q2hlY2tvdXQoKSx5aWVsZCB0aGlzLl9tb3VudEV4cHJlc3NDaGVja291dEVsZW1lbnQoaSx0aGlzLl9zdHJpcGVDbGllbnQsZCksdGhpcy5faW5pdGlhbGl6ZUV2ZW50cyhuKX0pfXNpZ25Jbigpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKX1zaWduT3V0KCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfWV4ZWN1dGVQYXltZW50TWV0aG9kQ2hlY2tvdXQoKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfV9tb3VudEV4cHJlc3NDaGVja291dEVsZW1lbnQoZSx0LGk9NDApe3JldHVybiBWKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBuPXRoaXMuX3Nob3VsZFJlcXVpcmVTaGlwcGluZ0FkZHJlc3MoKSxyPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHtzaGlwcGluZ0FkZHJlc3NSZXF1aXJlZDpufSxuP3thbGxvd2VkU2hpcHBpbmdDb3VudHJpZXM6eWllbGQgdGhpcy5fZ2V0QXZhaWxhYmxlQ291bnRyaWVzKCl9Ont9KSxuP3tzaGlwcGluZ1JhdGVzOlt7aWQ6XCJfXCIsYW1vdW50OjAsZGlzcGxheU5hbWU6XCJQZW5kaW5nIHJhdGVzXCJ9XX06e30pLHtiaWxsaW5nQWRkcmVzc1JlcXVpcmVkOiEwLGVtYWlsUmVxdWlyZWQ6ITAscGhvbmVOdW1iZXJSZXF1aXJlZDohMCxwYXltZW50TWV0aG9kczp7bGluazpjLkFVVE8sYXBwbGVQYXk6Yy5ORVZFUixnb29nbGVQYXk6Yy5ORVZFUixhbWF6b25QYXk6Yy5ORVZFUixwYXlwYWw6Yy5ORVZFUixrbGFybmE6Yy5ORVZFUn0sYnV0dG9uSGVpZ2h0Oml9KSx7Y2FydEFtb3VudDpvPTF9PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnQoKXx8e30scz1PYmplY3QuYXNzaWduKHttb2RlOlwicGF5bWVudFwiLGFtb3VudDp0aGlzLl90b0NlbnRzKG8pLGN1cnJlbmN5OnRoaXMuX2dldEN1cnJlbmN5KCl9LHRoaXMuX2NhcHR1cmVNZXRob2Q/e2NhcHR1cmVNZXRob2Q6dGhpcy5fY2FwdHVyZU1ldGhvZH06e30pO3RoaXMuX3N0cmlwZUVsZW1lbnRzPXQuZWxlbWVudHMocyksdGhpcy5fbGlua1YyRWxlbWVudD10aGlzLl9zdHJpcGVFbGVtZW50cy5jcmVhdGUoaC5FWFBSRVNTX0NIRUNLT1VULHIpLHRoaXMuX2xpbmtWMkVsZW1lbnQubW91bnQoYCMke2V9YCl9KX1faW5pdGlhbGl6ZUV2ZW50cyhlKXt0aGlzLl9saW5rVjJFbGVtZW50JiYodGhpcy5fc2hvdWxkUmVxdWlyZVNoaXBwaW5nQWRkcmVzcygpJiYodGhpcy5fbGlua1YyRWxlbWVudC5vbihtLlNISVBQSU5HX0FERFJFU1NfQ0hBTkdFLGU9PlYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLl9vblNoaXBwaW5nQWRkcmVzc0NoYW5nZShlKX0pKSx0aGlzLl9saW5rVjJFbGVtZW50Lm9uKG0uU0hJUFBJTkdfUkFURV9DSEFOR0UsZT0+Vih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMuX29uU2hpcHBpbmdSYXRlQ2hhbmdlKGUpfSkpKSx0aGlzLl9saW5rVjJFbGVtZW50Lm9uKG0uQ09ORklSTSx0PT5WKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5fb25Db25maXJtKHQsZSl9KSksdGhpcy5fbGlua1YyRWxlbWVudC5vbihtLkNBTkNFTCx0aGlzLl9vbkNhbmNlbCkpfV9vblNoaXBwaW5nQWRkcmVzc0NoYW5nZShlKXtyZXR1cm4gVih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIShcImFkZHJlc3NcImluIGUpKXJldHVybjtjb25zdCB0PWUuYWRkcmVzcyxpPXtmaXJzdE5hbWU6XCJcIixsYXN0TmFtZTpcIlwiLHBob25lOlwiXCIsY29tcGFueTpcIlwiLGFkZHJlc3MxOlwiXCIsYWRkcmVzczI6XCJcIixjaXR5OihudWxsPT10P3ZvaWQgMDp0LmNpdHkpfHxcIlwiLGNvdW50cnlDb2RlOihudWxsPT10P3ZvaWQgMDp0LmNvdW50cnkpfHxcIlwiLHBvc3RhbENvZGU6KG51bGw9PXQ/dm9pZCAwOnQucG9zdGFsX2NvZGUpfHxcIlwiLHN0YXRlT3JQcm92aW5jZToobnVsbD09dD92b2lkIDA6dC5zdGF0ZSl8fFwiXCIsc3RhdGVPclByb3ZpbmNlQ29kZToobnVsbD09dD92b2lkIDA6dC5zdGF0ZSl8fFwiXCIsY3VzdG9tRmllbGRzOltdfTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlU2hpcHBpbmdBZGRyZXNzKGkpO2NvbnN0IG49eWllbGQgdGhpcy5fZ2V0QXZhaWxhYmxlU2hpcHBpbmdPcHRpb25zKCk7eWllbGQgdGhpcy5fdXBkYXRlRGlzcGxheWVkUHJpY2UoKSwobnVsbD09bj92b2lkIDA6bi5sZW5ndGgpP2UucmVzb2x2ZSh7c2hpcHBpbmdSYXRlczpufSk6ZS5yZWplY3QoKX0pfV9vbkNhbmNlbCgpe3Rocm93IG5ldyBQfV9vblNoaXBwaW5nUmF0ZUNoYW5nZShlKXtyZXR1cm4gVih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoXCJzaGlwcGluZ1JhdGVcImluIGUpe2NvbnN0e3NoaXBwaW5nUmF0ZTp0fT1lO3lpZWxkIHRoaXMuX2hhbmRsZVNoaXBwaW5nT3B0aW9uQ2hhbmdlKG51bGw9PXQ/dm9pZCAwOnQuaWQpLHlpZWxkIHRoaXMuX3VwZGF0ZURpc3BsYXllZFByaWNlKCksZS5yZXNvbHZlKHt9KX19KX1fb25Db25maXJtKGUsdCl7cmV0dXJuIFYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKFwiYmlsbGluZ0RldGFpbHNcImluIGUmJlwic2hpcHBpbmdBZGRyZXNzXCJpbiBlJiZ0aGlzLl9zdHJpcGVDbGllbnQmJnRoaXMuX3N0cmlwZUVsZW1lbnRzKXt5aWVsZCB0aGlzLl91cGRhdGVTaGlwcGluZ0FuZEJpbGxpbmdBZGRyZXNzKGUpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcigpO2NvbnN0IGk9dGhpcy5fZ2V0UGF5bWVudFBheWxvYWQodCk7dHJ5e3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGkpfWNhdGNoKGUpe3lpZWxkIHRoaXMuX3Byb2Nlc3NBZGRpdGlvbmFsQWN0aW9uKGUsdCl9fXJldHVybiBQcm9taXNlLnJlc29sdmUoKX0pfV91cGRhdGVTaGlwcGluZ0FuZEJpbGxpbmdBZGRyZXNzKGUpe3ZhciB0LGksbixyLG8scyxhLGQ7cmV0dXJuIFYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGw9dGhpcy5fc2hvdWxkUmVxdWlyZVNoaXBwaW5nQWRkcmVzcygpLGM9KG51bGw9PT0oaT1udWxsPT09KHQ9ZS5zaGlwcGluZ0FkZHJlc3MpfHx2b2lkIDA9PT10P3ZvaWQgMDp0Lm5hbWUpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLnNwbGl0KFwiIFwiKVswXSl8fChudWxsPT09KHI9bnVsbD09PShuPWUuYmlsbGluZ0RldGFpbHMpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLm5hbWUpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLnNwbGl0KFwiIFwiKVswXSl8fFwiXCIsdT0obnVsbD09PShzPW51bGw9PT0obz1lLnNoaXBwaW5nQWRkcmVzcyl8fHZvaWQgMD09PW8/dm9pZCAwOm8ubmFtZSl8fHZvaWQgMD09PXM/dm9pZCAwOnMuc3BsaXQoXCIgXCIpWzFdKXx8KG51bGw9PT0oZD1udWxsPT09KGE9ZS5iaWxsaW5nRGV0YWlscyl8fHZvaWQgMD09PWE/dm9pZCAwOmEubmFtZSl8fHZvaWQgMD09PWQ/dm9pZCAwOmQuc3BsaXQoXCIgXCIpWzFdKXx8XCJcIjtpZihsKXtjb25zdCB0PXRoaXMuX21hcFNoaXBwaW5nQWRkcmVzcyhlLnNoaXBwaW5nQWRkcmVzcyxlLmJpbGxpbmdEZXRhaWxzLGMsdSk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVNoaXBwaW5nQWRkcmVzcyh0KX1jb25zdCBoPXRoaXMuX21hcEJpbGxpbmdBZGRyZXNzKGUuc2hpcHBpbmdBZGRyZXNzLGUuYmlsbGluZ0RldGFpbHMsYyx1KTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3MoaCl9KX1fbWFwU2hpcHBpbmdBZGRyZXNzKGUsdCxpLG4pe3ZhciByLG8scyxhLGQsbCxjO3JldHVybntmaXJzdE5hbWU6aSxsYXN0TmFtZTpuLHBob25lOihudWxsPT10P3ZvaWQgMDp0LnBob25lKXx8XCJcIixjb21wYW55OlwiXCIsYWRkcmVzczE6KG51bGw9PT0ocj1udWxsPT1lP3ZvaWQgMDplLmFkZHJlc3MpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLmxpbmUxKXx8XCJcIixhZGRyZXNzMjoobnVsbD09PShvPW51bGw9PWU/dm9pZCAwOmUuYWRkcmVzcyl8fHZvaWQgMD09PW8/dm9pZCAwOm8ubGluZTIpfHxcIlwiLGNpdHk6KG51bGw9PT0ocz1udWxsPT1lP3ZvaWQgMDplLmFkZHJlc3MpfHx2b2lkIDA9PT1zP3ZvaWQgMDpzLmNpdHkpfHxcIlwiLGNvdW50cnlDb2RlOihudWxsPT09KGE9bnVsbD09ZT92b2lkIDA6ZS5hZGRyZXNzKXx8dm9pZCAwPT09YT92b2lkIDA6YS5jb3VudHJ5KXx8XCJcIixwb3N0YWxDb2RlOihudWxsPT09KGQ9bnVsbD09ZT92b2lkIDA6ZS5hZGRyZXNzKXx8dm9pZCAwPT09ZD92b2lkIDA6ZC5wb3N0YWxfY29kZSl8fFwiXCIsc3RhdGVPclByb3ZpbmNlOihudWxsPT09KGw9bnVsbD09ZT92b2lkIDA6ZS5hZGRyZXNzKXx8dm9pZCAwPT09bD92b2lkIDA6bC5zdGF0ZSl8fFwiXCIsc3RhdGVPclByb3ZpbmNlQ29kZToobnVsbD09PShjPW51bGw9PWU/dm9pZCAwOmUuYWRkcmVzcyl8fHZvaWQgMD09PWM/dm9pZCAwOmMuc3RhdGUpfHxcIlwiLGN1c3RvbUZpZWxkczpbXX19X21hcEJpbGxpbmdBZGRyZXNzKGUsdCxpLG4pe3ZhciByLG8scyxhLGQsbDtyZXR1cm57ZW1haWw6KG51bGw9PXQ/dm9pZCAwOnQuZW1haWwpfHxcIlwiLGZpcnN0TmFtZTppLGxhc3ROYW1lOm4scGhvbmU6KG51bGw9PXQ/dm9pZCAwOnQucGhvbmUpfHxcIlwiLGNvbXBhbnk6XCJcIixhZGRyZXNzMToobnVsbD09PShyPW51bGw9PXQ/dm9pZCAwOnQuYWRkcmVzcyl8fHZvaWQgMD09PXI/dm9pZCAwOnIubGluZTEpfHxcIlwiLGFkZHJlc3MyOlwiXCIsY2l0eToobnVsbD09PShvPW51bGw9PXQ/dm9pZCAwOnQuYWRkcmVzcyl8fHZvaWQgMD09PW8/dm9pZCAwOm8uY2l0eSl8fFwiXCIsY291bnRyeUNvZGU6KG51bGw9PT0ocz1udWxsPT10P3ZvaWQgMDp0LmFkZHJlc3MpfHx2b2lkIDA9PT1zP3ZvaWQgMDpzLmNvdW50cnkpfHxcIlwiLHBvc3RhbENvZGU6KG51bGw9PT0oYT1udWxsPT10P3ZvaWQgMDp0LmFkZHJlc3MpfHx2b2lkIDA9PT1hP3ZvaWQgMDphLnBvc3RhbF9jb2RlKXx8XCJcIixzdGF0ZU9yUHJvdmluY2U6KG51bGw9PT0oZD1udWxsPT10P3ZvaWQgMDp0LmFkZHJlc3MpfHx2b2lkIDA9PT1kP3ZvaWQgMDpkLnN0YXRlKXx8XCJcIixzdGF0ZU9yUHJvdmluY2VDb2RlOihudWxsPT09KGw9bnVsbD09ZT92b2lkIDA6ZS5hZGRyZXNzKXx8dm9pZCAwPT09bD92b2lkIDA6bC5zdGF0ZSl8fFwiXCIsY3VzdG9tRmllbGRzOltdfX1fcHJvY2Vzc0FkZGl0aW9uYWxBY3Rpb24oZSx0KXtyZXR1cm4gVih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIUQoZSl8fCF0aGlzLnN0cmlwZUludGVncmF0aW9uU2VydmljZS5pc0FkZGl0aW9uYWxBY3Rpb25FcnJvcihlLmJvZHkuZXJyb3JzKSl0aHJvdyBlO2lmKCF0aGlzLl9zdHJpcGVDbGllbnR8fCF0aGlzLl9zdHJpcGVFbGVtZW50cyl0aHJvdyBuZXcgdyhmLlBheW1lbnROb3RJbml0aWFsaXplZCk7Y29uc3R7ZGF0YTppfT1lLmJvZHkuYWRkaXRpb25hbF9hY3Rpb25fcmVxdWlyZWQse3Rva2VuOm59PWkse3BheW1lbnRJbnRlbnQ6cn09eWllbGQgdGhpcy5fY29uZmlybVN0cmlwZVBheW1lbnRPclRocm93KGksdCksbz10aGlzLl9nZXRQYXltZW50UGF5bG9hZCh0LChudWxsPT1yP3ZvaWQgMDpyLmlkKXx8bik7dHJ5e3RoaXMuX3RvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITApLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KG8pLHlpZWxkIHRoaXMuX2NvbXBsZXRlQ2hlY2tvdXRGbG93KCl9Y2F0Y2goZSl7dGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2UudGhyb3dQYXltZW50Q29uZmlybWF0aW9uUHJvY2VlZE1lc3NhZ2UoKX1maW5hbGx5e3RoaXMuX3RvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpfX0pfV9jb25maXJtU3RyaXBlUGF5bWVudE9yVGhyb3coZSx0KXt2YXIgaSxuLHI7cmV0dXJuIFYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3Rva2VuOm8scmVkaXJlY3RfdXJsOnN9PWUsYT10aGlzLnN0cmlwZUludGVncmF0aW9uU2VydmljZS5tYXBTdHJpcGVQYXltZW50RGF0YSh0aGlzLl9zdHJpcGVFbGVtZW50cyxzKTtsZXQgZDt0cnl7Y29uc3QgZT0oeWllbGQgdGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2UuaXNQYXltZW50Q29tcGxldGVkKHQsdGhpcy5fc3RyaXBlQ2xpZW50KSk/eWllbGQgbnVsbD09PShyPXRoaXMuX3N0cmlwZUNsaWVudCl8fHZvaWQgMD09PXI/dm9pZCAwOnIucmV0cmlldmVQYXltZW50SW50ZW50KG98fFwiXCIpOnlpZWxkIG51bGw9PT0oaT10aGlzLl9zdHJpcGVDbGllbnQpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmNvbmZpcm1QYXltZW50KHtlbGVtZW50czphLmVsZW1lbnRzLGNsaWVudFNlY3JldDpvLHJlZGlyZWN0OmMuSUZfUkVRVUlSRUQsY29uZmlybVBhcmFtczp7cmV0dXJuX3VybDpudWxsPT09KG49YS5jb25maXJtUGFyYW1zKXx8dm9pZCAwPT09bj92b2lkIDA6bi5yZXR1cm5fdXJsfX0pO2lmKGQ9bnVsbD09ZT92b2lkIDA6ZS5lcnJvcixkfHwhKG51bGw9PWU/dm9pZCAwOmUucGF5bWVudEludGVudCkpdGhyb3cgbmV3IGI7cmV0dXJuIGV9Y2F0Y2goZSl7cmV0dXJuIHRoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlLnRocm93U3RyaXBlRXJyb3IoZCl9fSl9X2NvbXBsZXRlQ2hlY2tvdXRGbG93KCl7cmV0dXJuIFYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXMuX29uQ29tcGxldGU/dGhpcy5fb25Db21wbGV0ZSgpOih3aW5kb3cubG9jYXRpb24ucmVwbGFjZShcIi9jaGVja291dC9vcmRlci1jb25maXJtYXRpb25cIiksUHJvbWlzZS5yZXNvbHZlKCkpfSl9X2dldFBheW1lbnRQYXlsb2FkKGUsdCl7dmFyIGk7Y29uc3Qgbj0obnVsbD09PShpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnQoKSl8fHZvaWQgMD09PWk/dm9pZCAwOmkuaWQpfHxcIlwiO3JldHVybnttZXRob2RJZDplLHBheW1lbnREYXRhOntmb3JtYXR0ZWRQYXlsb2FkOk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7Y2FydF9pZDpufSx0P3tjcmVkaXRfY2FyZF90b2tlbjp7dG9rZW46dH19Ont9KSx7Y29uZmlybTohMSxtZXRob2Q6bC5MaW5rfSl9fX1fc2hvdWxkUmVxdWlyZVNoaXBwaW5nQWRkcmVzcygpe2NvbnN0e2dldENhcnQ6ZX09dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkse2xpbmVJdGVtczp0fT1lKCl8fHt9O3JldHVybiEhKG51bGw9PXQ/dm9pZCAwOnQucGh5c2ljYWxJdGVtcy5sZW5ndGgpfV91cGRhdGVEaXNwbGF5ZWRQcmljZSgpe3JldHVybiBWKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0aGlzLl9zdHJpcGVFbGVtZW50cyYmdGhpcy5fc3RyaXBlRWxlbWVudHMudXBkYXRlKHtjdXJyZW5jeTp0aGlzLl9nZXRDdXJyZW5jeSgpLG1vZGU6XCJwYXltZW50XCIsYW1vdW50OnlpZWxkIHRoaXMuX2dldFRvdGFsUHJpY2UoKX0pfSl9X2dldEN1cnJlbmN5KCl7dmFyIGU7aWYoIXRoaXMuX2N1cnJlbmN5Q29kZSl7Y29uc3QgdD1udWxsPT09KGU9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydCgpKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5jdXJyZW5jeTt0JiYodGhpcy5fY3VycmVuY3lDb2RlPXQuY29kZS50b0xvd2VyQ2FzZSgpKX1yZXR1cm4gdGhpcy5fY3VycmVuY3lDb2RlfV9nZXRUb3RhbFByaWNlKCl7dmFyIGU7cmV0dXJuIFYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkQ2hlY2tvdXQoKTtjb25zdHtnZXRDaGVja291dE9yVGhyb3c6dCxnZXRDYXJ0Oml9PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHtkZWNpbWFsUGxhY2VzOm59PShudWxsPT09KGU9aSgpKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5jdXJyZW5jeSl8fHt9LG89cih0KCkub3V0c3RhbmRpbmdCYWxhbmNlLG4pLnRvRml4ZWQobik7cmV0dXJuIHRoaXMuX3RvQ2VudHMoK28pfSl9X2dldEF2YWlsYWJsZUNvdW50cmllcygpe3ZhciBlO3JldHVybiBWKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkU2hpcHBpbmdDb3VudHJpZXMoKTtyZXR1cm4oKG51bGw9PT0oZT10LmdldFNoaXBwaW5nQ291bnRyaWVzKCkpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLm1hcChlPT5lLmNvZGUpKXx8W10pLmZpbHRlcihlPT5VLmluY2x1ZGVzKGUpKX0pfV9nZXRBdmFpbGFibGVTaGlwcGluZ09wdGlvbnMoKXt2YXIgZSx0LGk7cmV0dXJuIFYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q29uc2lnbm1lbnRzKCk7aWYoIShudWxsPT1uP3ZvaWQgMDpuWzBdKSlyZXR1cm47Y29uc3Qgcj1uWzBdLG89KHIuYXZhaWxhYmxlU2hpcHBpbmdPcHRpb25zfHxbXSkubWFwKHRoaXMuX2dldFN0cmlwZVNoaXBwaW5nT3B0aW9uLmJpbmQodGhpcykpLHM9bnVsbD09PShlPXIuYXZhaWxhYmxlU2hpcHBpbmdPcHRpb25zKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5maW5kKGU9PmUuaXNSZWNvbW1lbmRlZCksYT1udWxsPT09KHQ9ci5zZWxlY3RlZFNoaXBwaW5nT3B0aW9uKXx8dm9pZCAwPT09dD92b2lkIDA6dC5pZCxkPW51bGw9PXM/dm9pZCAwOnMuaWQ7cmV0dXJuIGE/by5zb3J0KGU9PmUuaWQ9PT1hPy0xOjApOmQ/KG8uc29ydChlPT5lLmlkPT09ZD8tMTowKSx5aWVsZCB0aGlzLl9oYW5kbGVTaGlwcGluZ09wdGlvbkNoYW5nZShkKSk6eWllbGQgdGhpcy5faGFuZGxlU2hpcHBpbmdPcHRpb25DaGFuZ2UobnVsbD09PShpPW9bMF0pfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmlkKSxvfSl9X2dldFN0cmlwZVNoaXBwaW5nT3B0aW9uKHtpZDplLGNvc3Q6dCxkZXNjcmlwdGlvbjppfSl7cmV0dXJue2lkOmUsZGlzcGxheU5hbWU6aSxhbW91bnQ6dGhpcy5fdG9DZW50cyh0KX19X2hhbmRsZVNoaXBwaW5nT3B0aW9uQ2hhbmdlKGUpe3JldHVybiBWKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZihlJiZcInNoaXBwaW5nX29wdGlvbl91bnNlbGVjdGVkXCIhPT1lKXJldHVybiB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2VsZWN0U2hpcHBpbmdPcHRpb24oZSl9KX1fZ2V0QW1vdW50VHJhbnNmb3JtZXIoKXtpZih0aGlzLl9hbW91bnRUcmFuc2Zvcm1lcilyZXR1cm4gdGhpcy5fYW1vdW50VHJhbnNmb3JtZXI7Y29uc3R7Z2V0Q2FydDplfT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSx7Y3VycmVuY3k6dH09ZSgpfHx7fTtyZXR1cm4gdD9uZXcgeih0LmRlY2ltYWxQbGFjZXMpOnZvaWQgMH1fdG9DZW50cyhlKXtjb25zdCB0PU1hdGgucm91bmQoMTAwKmUpLGk9dGhpcy5fZ2V0QW1vdW50VHJhbnNmb3JtZXIoKTtyZXR1cm4gaT9pLnRvSW50ZWdlcihlKTp0fV90b2dnbGVMb2FkaW5nSW5kaWNhdG9yKGUpe2UmJnRoaXMuX2xvYWRpbmdJbmRpY2F0b3JDb250YWluZXI/dGhpcy5sb2FkaW5nSW5kaWNhdG9yLnNob3codGhpcy5fbG9hZGluZ0luZGljYXRvckNvbnRhaW5lcik6dGhpcy5sb2FkaW5nSW5kaWNhdG9yLmhpZGUoKX19Y29uc3Qgaj12KHQ9Pntjb25zdCBpPW5ldyBJKGUoKSksbj1uZXcgUih7Y29udGFpbmVyU3R5bGVzOlR9KTtyZXR1cm4gbmV3IHgodCxpLG5ldyBNKHQsaSksbil9LFt7aWQ6XCJzdHJpcGVvY3NcIn1dKTtjbGFzcyBCIGV4dGVuZHMgU3tjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIkludmFsaWQgYXJndW1lbnRzIGhhdmUgYmVlbiBwcm92aWRlZC5cIiksdGhpcy5uYW1lPVwiSW52YWxpZEFyZ3VtZW50RXJyb3JcIix0aGlzLnR5cGU9XCJpbnZhbGlkX2FyZ3VtZW50XCJ9fWNsYXNzIEYgZXh0ZW5kcyBCe2NvbnN0cnVjdG9yKGUpe2xldCB0PVwiVW5hYmxlIHRvIHN1Ym1pdCBwYXltZW50IGZvciB0aGUgb3JkZXIgYmVjYXVzZSB0aGUgcGF5bG9hZCBpcyBpbnZhbGlkLlwiO2UmJih0PWAke3R9IE1ha2Ugc3VyZSB0aGUgZm9sbG93aW5nIGZpZWxkcyBhcmUgcHJvdmlkZWQgY29ycmVjdGx5OiAke2Uuam9pbihcIiwgXCIpfS5gKSxzdXBlcih0KSx0aGlzLm5hbWU9XCJQYXltZW50QXJndW1lbnRJbnZhbGlkRXJyb3JcIn19ZnVuY3Rpb24gRyhlKXtyZXR1cm4hKFwib2JqZWN0XCIhPXR5cGVvZiBlfHxudWxsPT09ZXx8dm9pZCAwIT09ZS5zaG91bGRTYXZlSW5zdHJ1bWVudCYmXCJib29sZWFuXCIhPXR5cGVvZiBlLnNob3VsZFNhdmVJbnN0cnVtZW50fHx2b2lkIDAhPT1lLnNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQmJlwiYm9vbGVhblwiIT10eXBlb2YgZS5zaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50KX1mdW5jdGlvbiBIKGUpe3JldHVybiBCb29sZWFuKGUuaW5zdHJ1bWVudElkKX1jbGFzcyBxIGV4dGVuZHMgU3tjb25zdHJ1Y3Rvcigpe3N1cGVyKFwiVGhlIGN1cnJlbnQgb3JkZXIgZG9lcyBub3QgbmVlZCB0byBiZSBmaW5hbGl6ZWQgYXQgdGhpcyBzdGFnZS5cIiksdGhpcy5uYW1lPVwiT3JkZXJGaW5hbGl6YXRpb25Ob3RSZXF1aXJlZEVycm9yXCIsdGhpcy50eXBlPVwib3JkZXJfZmluYWxpemF0aW9uX25vdF9yZXF1aXJlZFwifX1mdW5jdGlvbiBXKGUpe3JldHVybiBudWxsIT09ZSYmXCJvYmplY3RcIj09dHlwZW9mIGUmJlwiY2FyZE51bWJlckVsZW1lbnRPcHRpb25zXCJpbiBlJiZcImNhcmRDdmNFbGVtZW50T3B0aW9uc1wiaW4gZSYmXCJjYXJkRXhwaXJ5RWxlbWVudE9wdGlvbnNcImluIGUmJnZvaWQgMCE9PWUuY2FyZE51bWJlckVsZW1lbnRPcHRpb25zJiZ2b2lkIDAhPT1lLmNhcmRDdmNFbGVtZW50T3B0aW9ucyYmdm9pZCAwIT09ZS5jYXJkRXhwaXJ5RWxlbWVudE9wdGlvbnN9dmFyIFksJCxKLEs7IWZ1bmN0aW9uKGUpe2UuU29saWQ9XCJzb2xpZFwiLGUuRGVmYXVsdD1cImRlZmF1bHRcIn0oWXx8KFk9e30pKSxmdW5jdGlvbihlKXtlLkFsaXBheT1cImFsaXBheVwiLGUuQ2FyZEN2Yz1cImNhcmRDdmNcIixlLkNhcmRFeHBpcnk9XCJjYXJkRXhwaXJ5XCIsZS5DYXJkTnVtYmVyPVwiY2FyZE51bWJlclwiLGUuQ3JlZGl0Q2FyZD1cImNhcmRcIixlLklERUFMPVwiaWRlYWxCYW5rXCIsZS5TZXBhPVwiaWJhblwifSgkfHwoJD17fSkpLGZ1bmN0aW9uKGUpe2UuQWxpcGF5PVwiYWxpcGF5XCIsZS5DcmVkaXRDYXJkPVwiY2FyZFwiLGUuSURFQUw9XCJpZGVhbFwiLGUuU2VwYT1cInNlcGFfZGViaXRcIn0oSnx8KEo9e30pKSxmdW5jdGlvbihlKXtlLkF1dGhGYWlsdXJlPVwiYXV0aF9mYWlsdXJlXCJ9KEt8fChLPXt9KSk7Y2xhc3MgWiBleHRlbmRzIFN7Y29uc3RydWN0b3IoZSl7c3VwZXIoZT09PUsuQXV0aEZhaWx1cmU/XCJVc2VyIGRpZCBub3QgYXV0aGVudGljYXRlXCI6XCJUaGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgcHJvY2Vzc2luZyB5b3VyIHBheW1lbnQuIFBsZWFzZSB0cnkgYWdhaW4gb3IgY29udGFjdCB1cy5cIiksdGhpcy50eXBlPVwic3RyaXBldjNfZXJyb3JcIix0aGlzLnN1YnR5cGU9ZX19dmFyIFE9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBzKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gYShlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4ocyxhKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y29uc3QgWD1bJC5BbGlwYXksJC5JREVBTF07Y2xhc3MgZWV7Y29uc3RydWN0b3IoZSx0KXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLnNjcmlwdExvYWRlcj10fWluaXRpYWxpemUoZSl7cmV0dXJuIFEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3N0cmlwZXYzOnQsbWV0aG9kSWQ6aSxnYXRld2F5SWQ6bn09ZTtpZighbil0aHJvdyBuZXcgQignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwiZ2F0ZXdheUlkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3RoaXMuaW5pdGlhbGl6ZU9wdGlvbnM9dCx0aGlzLmlzRGVpbml0aWFsaXplPSExO2NvbnN0IHI9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSkse2luaXRpYWxpemF0aW9uRGF0YTp7c3RyaXBlUHVibGlzaGFibGVLZXk6byxzdHJpcGVDb25uZWN0ZWRBY2NvdW50OnMsdXNlSW5kaXZpZHVhbENhcmRGaWVsZHM6YSxhbGxvd1JlZGlzcGxheUZvclN0b3JlZEluc3RydW1lbnRzOmR9fT1yO3RoaXMuX2FsbG93UmVkaXNwbGF5Rm9yU3RvcmVkSW5zdHJ1bWVudHM9ZDtjb25zdCBsPXRoaXMuZ2V0SW5pdGlhbGl6ZU9wdGlvbnMoKS5mb3JtO3RoaXMudXNlSW5kaXZpZHVhbENhcmRGaWVsZHM9YSx0aGlzLnN0cmlwZVYzQ2xpZW50PXlpZWxkIHRoaXMubG9hZFN0cmlwZUpzKG8scyksdGhpcy5pc0NyZWRpdENhcmQoaSkmJnRoaXMuc2hvdWxkU2hvd1RTVkhvc3RlZEZvcm0oaSxuKSYmbD90aGlzLmhvc3RlZEZvcm09eWllbGQgdGhpcy5tb3VudENhcmRWZXJpZmljYXRpb25GaWVsZHMobCk6dGhpcy5zdHJpcGVFbGVtZW50PXlpZWxkIHRoaXMubW91bnRDYXJkRmllbGRzKGkpfSl9ZXhlY3V0ZShlLGkpe3ZhciBuLHI7cmV0dXJuIFEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6b309ZSxzPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7cjxuLmxlbmd0aDtyKyspdC5pbmRleE9mKG5bcl0pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bcl0pJiYoaVtuW3JdXT1lW25bcl1dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKTtsZXQgYSxkO2lmKCFvfHwhby5wYXltZW50RGF0YSl0aHJvdyBuZXcgRihbXCJwYXltZW50LnBheW1lbnREYXRhXCJdKTtjb25zdHtwYXltZW50RGF0YTpsLGdhdGV3YXlJZDpjLG1ldGhvZElkOnV9PW8se3Nob3VsZFNhdmVJbnN0cnVtZW50Omgsc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDpwfT1HKGwpP2w6e3Nob3VsZFNhdmVJbnN0cnVtZW50OiExLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6ITF9LG09dChYLHUpLHtpc1N0b3JlQ3JlZGl0QXBwbGllZDp5fT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDaGVja291dE9yVGhyb3coKTt5JiYoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmFwcGx5U3RvcmVDcmVkaXQoeSkpO3RyeXttJiYoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKHMsaSkpLGMmJih5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoYyx7cGFyYW1zOnttZXRob2Q6dX19KSk7Y29uc3QgZT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTtpZihIKGwpKXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIocyxpKTtjb25zdHtpbnN0cnVtZW50SWQ6dH09bCxuPWUuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coby5tZXRob2RJZCkuY2xpZW50VG9rZW47aWYoIW4pdGhyb3cgbmV3IEEoQy5NaXNzaW5nUGF5bWVudE1ldGhvZCk7cmV0dXJuIHlpZWxkIHRoaXMuZXhlY3V0ZVdpdGhWYXVsdGVkKG8sdCxwLG4pfWNvbnN0IHQ9ZS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyh1KSx5PXlpZWxkIHRoaXMuY29uZmlybVN0cmlwZVBheW1lbnQodCkse2NsaWVudFRva2VuOmcsbWV0aG9kOnZ9PXQse2lkOlN9PW51bGwhPT0ocj1udWxsIT09KG49eS5wYXltZW50SW50ZW50KSYmdm9pZCAwIT09bj9uOnkucGF5bWVudE1ldGhvZCkmJnZvaWQgMCE9PXI/cjp7aWQ6XCJcIn07ZD15LmVycm9yLGE9e2NyZWRpdF9jYXJkX3Rva2VuOnt0b2tlbjpTfSx2YXVsdF9wYXltZW50X2luc3RydW1lbnQ6aCxjb25maXJtOiExLHNldF9hc19kZWZhdWx0X3N0b3JlZF9pbnN0cnVtZW50OnB9LHY9PT0kLkNyZWRpdENhcmQmJihhLmNsaWVudF90b2tlbj1nKSxtfHwoeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKHMsaSkpO2NvbnN0IF89dGhpcy5idWlsZFBheW1lbnRQYXlsb2FkKHUsYSxwKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChfKX1jYXRjaChlKXt5aWVsZCB0aGlzLnByb2Nlc3NBZGRpdGlvbmFsQWN0aW9uKHRoaXMuaGFuZGxlRW1wdHlQYXltZW50SW50ZW50RXJyb3IoZSxkKSx1LGgscCl9fSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IHEpfWRlaW5pdGlhbGl6ZSgpe3JldHVybiB0aGlzLmhvc3RlZEZvcm0mJnRoaXMuaG9zdGVkRm9ybS5kZXRhY2goKSx0aGlzLmlzRGVpbml0aWFsaXplPSEwLHRoaXMudW5tb3VudEVsZW1lbnQoKSxQcm9taXNlLnJlc29sdmUoKX1idWlsZFBheW1lbnRQYXlsb2FkKGUsdCxpKXtyZXR1cm57bWV0aG9kSWQ6ZSxwYXltZW50RGF0YTppP3tmb3JtYXR0ZWRQYXlsb2FkOk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7c2V0X2FzX2RlZmF1bHRfc3RvcmVkX2luc3RydW1lbnQ6aX0pfTp7Zm9ybWF0dGVkUGF5bG9hZDp0fX19aXNDYW5jZWxsYXRpb25FcnJvcihlKXt2YXIgdCxpO3JldHVybiBlJiYtMSE9PShudWxsPT09KGk9bnVsbD09PSh0PWUucGF5bWVudF9pbnRlbnQubGFzdF9wYXltZW50X2Vycm9yKXx8dm9pZCAwPT09dD92b2lkIDA6dC5tZXNzYWdlKXx8dm9pZCAwPT09aT92b2lkIDA6aS5pbmRleE9mKFwiY2FuY2VsZWRcIikpfWlzQXV0aEVycm9yKGUpe3JldHVyblwicGF5bWVudF9pbnRlbnRfYXV0aGVudGljYXRpb25fZmFpbHVyZVwiPT09KG51bGw9PWU/dm9pZCAwOmUuY29kZSl9aXNDcmVkaXRDYXJkKGUpe3JldHVybiBlPT09Si5DcmVkaXRDYXJkfWlzSG9zdGVkRmllbGRBdmFpbGFibGUoKXt2YXIgZTtjb25zdCB0PXRoaXMuZ2V0SW5pdGlhbGl6ZU9wdGlvbnMoKSxyPW4obnVsbD09PShlPXQuZm9ybSl8fHZvaWQgMD09PWU/dm9pZCAwOmUuZmllbGRzLGkpO3JldHVybiFpKHIpfWlzSG9zdGVkUGF5bWVudEZvcm1FbmFibGVkKGUsdCl7Y29uc3R7Z2V0UGF5bWVudE1ldGhvZE9yVGhyb3c6aX09dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksbj1pKGUsdCk7cmV0dXJuIEJvb2xlYW4obi5jb25maWcuaXNIb3N0ZWRGb3JtRW5hYmxlZCl9Y29uZmlybVN0cmlwZVBheW1lbnQoZSl7cmV0dXJuIFEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2NsaWVudFRva2VuOnQsbWV0aG9kOmkscmV0dXJuVXJsOm59PWU7aWYoIXQpdGhyb3cgbmV3IEEoQy5NaXNzaW5nUGF5bWVudE1ldGhvZCk7c3dpdGNoKGkpe2Nhc2UgJC5BbGlwYXk6cmV0dXJuIHRoaXMuZ2V0U3RyaXBlSnMoKS5jb25maXJtQWxpcGF5UGF5bWVudCh0LHtyZXR1cm5fdXJsOm59LHtoYW5kbGVBY3Rpb25zOiExfSk7Y2FzZSAkLklERUFMOntjb25zdCBlPXRoaXMubWFwU3RyaXBlUGF5bWVudERhdGEoSi5JREVBTCxuKTtyZXR1cm4gdGhpcy5nZXRTdHJpcGVKcygpLmNvbmZpcm1JZGVhbFBheW1lbnQodCxlLHtoYW5kbGVBY3Rpb25zOiExfSl9Y2FzZSAkLlNlcGE6e2NvbnN0IGU9dGhpcy5tYXBTdHJpcGVQYXltZW50RGF0YShKLlNlcGEpO3JldHVybiB0aGlzLmdldFN0cmlwZUpzKCkuY29uZmlybVNlcGFEZWJpdFBheW1lbnQodCxlKX1kZWZhdWx0Ontjb25zdCBlPXRoaXMudXNlSW5kaXZpZHVhbENhcmRGaWVsZHM/dGhpcy5nZXRTdHJpcGVDYXJkRWxlbWVudHMoKVswXTp0aGlzLmdldFN0cmlwZUVsZW1lbnQoKSx0PXRoaXMubWFwU3RyaXBlQmlsbGluZ0RldGFpbHModGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0QmlsbGluZ0FkZHJlc3MoKSx0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDdXN0b21lcigpKSxpPXRoaXMuX2FsbG93UmVkaXNwbGF5Rm9yU3RvcmVkSW5zdHJ1bWVudHM7cmV0dXJuIHRoaXMuZ2V0U3RyaXBlSnMoKS5jcmVhdGVQYXltZW50TWV0aG9kKE9iamVjdC5hc3NpZ24oe3R5cGU6Si5DcmVkaXRDYXJkLGNhcmQ6ZSxiaWxsaW5nX2RldGFpbHM6dH0saT97YWxsb3dfcmVkaXNwbGF5OlwiYWx3YXlzXCJ9Ont9KSl9fX0pfWV4ZWN1dGVXaXRoVmF1bHRlZChlLHQsaSxuKXt2YXIgcjtyZXR1cm4gUSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgbz17YmlncGF5X3Rva2VuOnt0b2tlbjp0fSxjb25maXJtOiEwLGNsaWVudF90b2tlbjpuLHNldF9hc19kZWZhdWx0X3N0b3JlZF9pbnN0cnVtZW50Oml9O2lmKHRoaXMuaXNIb3N0ZWRQYXltZW50Rm9ybUVuYWJsZWQoZS5tZXRob2RJZCxlLmdhdGV3YXlJZCkmJnRoaXMuaG9zdGVkRm9ybSl7Y29uc3QgdD10aGlzLmhvc3RlZEZvcm07cmV0dXJuIGUucGF5bWVudERhdGEmJkgoZS5wYXltZW50RGF0YSkmJihlLnBheW1lbnREYXRhPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlLnBheW1lbnREYXRhKSx7aW5zdHJ1bWVudElkOkpTT04uc3RyaW5naWZ5KHt0b2tlbjoobnVsbD09PShyPWUucGF5bWVudERhdGEpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLmluc3RydW1lbnRJZCl8fFwiXCIsY2xpZW50X3Rva2VuOm59KX0pKSx5aWVsZCB0LnZhbGlkYXRlKCkseWllbGQgdC5zdWJtaXQoZSksdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRDdXJyZW50T3JkZXIoKX1jb25zdCBzPXRoaXMuYnVpbGRQYXltZW50UGF5bG9hZChlLm1ldGhvZElkLG8saSk7cmV0dXJuIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KHMpfSl9Z2V0SW5pdGlhbGl6ZU9wdGlvbnMoKXtpZighdGhpcy5pbml0aWFsaXplT3B0aW9ucyl0aHJvdyBuZXcgdyhmLlBheW1lbnROb3RJbml0aWFsaXplZCk7cmV0dXJuIHRoaXMuaW5pdGlhbGl6ZU9wdGlvbnN9Z2V0U3RyaXBlQ2FyZEVsZW1lbnRzKCl7aWYoIXRoaXMuc3RyaXBlQ2FyZEVsZW1lbnRzKXRocm93IG5ldyB3KGYuUGF5bWVudE5vdEluaXRpYWxpemVkKTtyZXR1cm4gdGhpcy5zdHJpcGVDYXJkRWxlbWVudHN9Z2V0U3RyaXBlRWxlbWVudCgpe2lmKCF0aGlzLnN0cmlwZUVsZW1lbnQpdGhyb3cgbmV3IHcoZi5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO3JldHVybiB0aGlzLnN0cmlwZUVsZW1lbnR9Z2V0U3RyaXBlSnMoKXtpZighdGhpcy5zdHJpcGVWM0NsaWVudCl0aHJvdyBuZXcgdyhmLlBheW1lbnROb3RJbml0aWFsaXplZCk7cmV0dXJuIHRoaXMuc3RyaXBlVjNDbGllbnR9aGFuZGxlRW1wdHlQYXltZW50SW50ZW50RXJyb3IoZSx0KXtyZXR1cm4gRChlKSYmbyhlLmJvZHkuZXJyb3JzLHtjb2RlOlwicmVxdWlyZWRfZmllbGRcIn0pJiZ0P25ldyBFcnJvcih0Lm1lc3NhZ2UpOmV9bG9hZFN0cmlwZUpzKGUsdCl7cmV0dXJuIFEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLnN0cmlwZVYzQ2xpZW50P1Byb21pc2UucmVzb2x2ZSh0aGlzLnN0cmlwZVYzQ2xpZW50KTp0aGlzLnNjcmlwdExvYWRlci5sb2FkKGUsdCx0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRMb2NhbGUoKSl9KX1tYXBTdHJpcGVBZGRyZXNzKGUpe2lmKGUpe2NvbnN0e2NpdHk6dCxjb3VudHJ5Q29kZTppLGFkZHJlc3MxOm4sYWRkcmVzczI6cixwb3N0YWxDb2RlOm8sc3RhdGVPclByb3ZpbmNlQ29kZTpzfT1lO3JldHVybntjaXR5OnQsY291bnRyeTppLGxpbmUxOm4sbGluZTI6cixwb3N0YWxfY29kZTpvLHN0YXRlOnN9fXJldHVybntsaW5lMTpcIlwifX1tYXBTdHJpcGVCaWxsaW5nRGV0YWlscyhlLHQpe2NvbnN0e2ZpcnN0TmFtZTppLGxhc3ROYW1lOm59PWV8fHR8fHtmaXJzdE5hbWU6XCJHdWVzdFwiLGxhc3ROYW1lOlwiXCJ9LHI9YCR7aX0gJHtufWAudHJpbSgpLHtvcHRpb25zOm99PXRoaXMuZ2V0SW5pdGlhbGl6ZU9wdGlvbnMoKTtpZih0aGlzLnVzZUluZGl2aWR1YWxDYXJkRmllbGRzJiZXKG8pKXtjb25zdHt6aXBDb2RlRWxlbWVudE9wdGlvbnM6dH09bztpZih0KXtjb25zdCBpPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHQuY29udGFpbmVySWQpP2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKHQuY29udGFpbmVySWQpLnZhbHVlOlwiXCI7aSYmZSYmKGU9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHtwb3N0YWxDb2RlOml9KSl9fWNvbnN0IHM9e2FkZHJlc3M6dGhpcy5tYXBTdHJpcGVBZGRyZXNzKGUpfTtpZih0JiZ0LmFkZHJlc3Nlc1swXSYmZnVuY3Rpb24oZSl7cmV0dXJuXCJvYmplY3RcIj09dHlwZW9mIGUmJm51bGwhPT1lJiZcImlkXCJpbiBlJiZ2b2lkIDAhPT1lLmlkfSh0LmFkZHJlc3Nlc1swXSkpe2NvbnN0IGU9dC5hZGRyZXNzZXNbMF0se2VtYWlsOml9PXQse3Bob25lOm59PWU7cmV0dXJuIG4/T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHMpLHtlbWFpbDppLG5hbWU6cixwaG9uZTpufSk6T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHMpLHtlbWFpbDppLG5hbWU6cn0pfWlmKGUpe2NvbnN0e2VtYWlsOnQscGhvbmU6aX09ZTtyZXR1cm4gaT9PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scykse2VtYWlsOnQsbmFtZTpyLHBob25lOml9KTpPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scykse2VtYWlsOnQsbmFtZTpyfSl9cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxzKSx7bmFtZTpyfSl9bWFwU3RyaXBlUGF5bWVudERhdGEoZSx0KXtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldEN1c3RvbWVyKCksbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRCaWxsaW5nQWRkcmVzcygpLHI9e3BheW1lbnRfbWV0aG9kOntbZV06dGhpcy5nZXRTdHJpcGVFbGVtZW50KCksYmlsbGluZ19kZXRhaWxzOnRoaXMubWFwU3RyaXBlQmlsbGluZ0RldGFpbHMobixpKX19O3JldHVybiBlPT09Si5JREVBTD9PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse3JldHVybl91cmw6dH0pOnJ9bW91bnRDYXJkRmllbGRzKGUpe2NvbnN0e29wdGlvbnM6dCxjb250YWluZXJJZDppfT10aGlzLmdldEluaXRpYWxpemVPcHRpb25zKCk7bGV0IG47cmV0dXJuIG5ldyBQcm9taXNlKChyLG8pPT57c3dpdGNoKHRoaXMuc3RyaXBlRWxlbWVudHN8fCh0aGlzLnN0cmlwZUVsZW1lbnRzPXRoaXMuZ2V0U3RyaXBlSnMoKS5lbGVtZW50cygpKSxlKXtjYXNlICQuQ3JlZGl0Q2FyZDppZih0aGlzLnVzZUluZGl2aWR1YWxDYXJkRmllbGRzJiZXKHQpKXtjb25zdHtjYXJkTnVtYmVyRWxlbWVudE9wdGlvbnM6ZSxjYXJkRXhwaXJ5RWxlbWVudE9wdGlvbnM6aSxjYXJkQ3ZjRWxlbWVudE9wdGlvbnM6cn09dCxzPXRoaXMuc3RyaXBlRWxlbWVudHMuZ2V0RWxlbWVudCgkLkNhcmROdW1iZXIpfHx0aGlzLnN0cmlwZUVsZW1lbnRzLmNyZWF0ZSgkLkNhcmROdW1iZXIsZSksYT10aGlzLnN0cmlwZUVsZW1lbnRzLmdldEVsZW1lbnQoJC5DYXJkRXhwaXJ5KXx8dGhpcy5zdHJpcGVFbGVtZW50cy5jcmVhdGUoJC5DYXJkRXhwaXJ5LGkpLGQ9dGhpcy5zdHJpcGVFbGVtZW50cy5nZXRFbGVtZW50KCQuQ2FyZEN2Yyl8fHRoaXMuc3RyaXBlRWxlbWVudHMuY3JlYXRlKCQuQ2FyZEN2YyxyKTt0aGlzLnN0cmlwZUNhcmRFbGVtZW50cz1bcyxhLGRdLG49dGhpcy5zdHJpcGVDYXJkRWxlbWVudHNbMF07dHJ5e3MubW91bnQoYCMke2UuY29udGFpbmVySWR9YCksYS5tb3VudChgIyR7aS5jb250YWluZXJJZH1gKSxkLm1vdW50KGAjJHtyLmNvbnRhaW5lcklkfWApfWNhdGNoKGUpe3RoaXMuaXNEZWluaXRpYWxpemV8fG8obmV3IEIoXCJVbmFibGUgdG8gbW91bnQgU3RyaXBlIGNvbXBvbmVudCB3aXRob3V0IHZhbGlkIGNvbnRhaW5lciBJRC5cIikpfX1lbHNle249dGhpcy5zdHJpcGVFbGVtZW50cy5nZXRFbGVtZW50KGUpfHx0aGlzLnN0cmlwZUVsZW1lbnRzLmNyZWF0ZShlLHQpO3RyeXtuLm1vdW50KGAjJHtpfWApfWNhdGNoKGUpe3RoaXMuaXNEZWluaXRpYWxpemV8fG8obmV3IEIoXCJVbmFibGUgdG8gbW91bnQgU3RyaXBlIGNvbXBvbmVudCB3aXRob3V0IHZhbGlkIGNvbnRhaW5lciBJRC5cIikpfX1icmVhaztjYXNlICQuSURFQUw6Y2FzZSAkLlNlcGE6bj10aGlzLnN0cmlwZUVsZW1lbnRzLmdldEVsZW1lbnQoZSl8fHRoaXMuc3RyaXBlRWxlbWVudHMuY3JlYXRlKGUsdCk7dHJ5e24ubW91bnQoYCMke2l9YCl9Y2F0Y2goZSl7dGhpcy5pc0RlaW5pdGlhbGl6ZXx8byhuZXcgQihcIlVuYWJsZSB0byBtb3VudCBTdHJpcGUgY29tcG9uZW50IHdpdGhvdXQgdmFsaWQgY29udGFpbmVyIElELlwiKSl9Y2FzZSAkLkFsaXBheTp9cihuKX0pfW1vdW50Q2FyZFZlcmlmaWNhdGlvbkZpZWxkcyhlKXtyZXR1cm4gUSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRTdG9yZUNvbmZpZygpO2lmKCF0KXRocm93IG5ldyBBKEMuTWlzc2luZ0NoZWNrb3V0Q29uZmlnKTtjb25zdCBpPXQucGF5bWVudFNldHRpbmdzLmJpZ3BheUJhc2VVcmwsbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlSG9zdGVkRm9ybShpLGUpO3JldHVybiB5aWVsZCBuLmF0dGFjaCgpLG59KX1wcm9jZXNzQWRkaXRpb25hbEFjdGlvbihlLHQsaT0hMSxuPSExKXtyZXR1cm4gUSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIUQoZSkpdGhyb3cgZTtjb25zdCByPW8oZS5ib2R5LmVycm9ycyx7Y29kZTpcImFkZGl0aW9uYWxfYWN0aW9uX3JlcXVpcmVkXCJ9KSxzPW8oZS5ib2R5LmVycm9ycyx7Y29kZTpcInRocmVlX2Rfc2VjdXJlX3JlcXVpcmVkXCJ9KTtpZihyKXtjb25zdCB0PWUuYm9keS5hZGRpdGlvbmFsX2FjdGlvbl9yZXF1aXJlZDtpZih0JiZcInJlZGlyZWN0X3RvX3VybFwiPT09dC50eXBlKXJldHVybiBuZXcgUHJvbWlzZSgoKT0+e3QuZGF0YS5yZWRpcmVjdF91cmwmJndpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHQuZGF0YS5yZWRpcmVjdF91cmwpfSl9aWYocyl7Y29uc3Qgcj1lLmJvZHkudGhyZWVfZHNfcmVzdWx0LnRva2VuLG89ITE7bGV0IHMsYT0hMTt0cnl7cz15aWVsZCB0aGlzLmdldFN0cmlwZUpzKCkuY29uZmlybUNhcmRQYXltZW50KHIpfWNhdGNoKGUpe2E9ITB9aWYobnVsbD09cz92b2lkIDA6cy5lcnJvcil7aWYodGhpcy5pc0NhbmNlbGxhdGlvbkVycm9yKHMuZXJyb3IpKXRocm93IG5ldyBQO2lmKHRoaXMuaXNBdXRoRXJyb3Iocy5lcnJvcikpdGhyb3cgbmV3IFooSy5BdXRoRmFpbHVyZSk7dGhyb3cgbmV3IEVycm9yKHMuZXJyb3IubWVzc2FnZSl9Y29uc3QgZD17Y3JlZGl0X2NhcmRfdG9rZW46e3Rva2VuOnRoaXMuZ2V0UGF5bWVudFRva2VuKG51bGw9PXM/dm9pZCAwOnMucGF5bWVudEludGVudCxyLGEpfSx2YXVsdF9wYXltZW50X2luc3RydW1lbnQ6aSxjb25maXJtOm99LGw9dGhpcy5idWlsZFBheW1lbnRQYXlsb2FkKHQsZCxuKTt0cnl7cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGwpfWNhdGNoKGUpe3Rocm93IHRoaXMuaGFuZGxlRW1wdHlQYXltZW50SW50ZW50RXJyb3IoZSxudWxsPT1zP3ZvaWQgMDpzLmVycm9yKX19dGhyb3cgZX0pfWdldFBheW1lbnRUb2tlbihlLHQsaSl7cmV0dXJuIWV8fGk/dDplLmlkfXNob3VsZFNob3dUU1ZIb3N0ZWRGb3JtKGUsdCl7cmV0dXJuIHRoaXMuaXNIb3N0ZWRGaWVsZEF2YWlsYWJsZSgpJiZ0aGlzLmlzSG9zdGVkUGF5bWVudEZvcm1FbmFibGVkKGUsdCl9dW5tb3VudEVsZW1lbnQoKXt0aGlzLnN0cmlwZUVsZW1lbnQmJih0aGlzLnN0cmlwZUVsZW1lbnQudW5tb3VudCgpLHRoaXMuc3RyaXBlRWxlbWVudD12b2lkIDApfX1jbGFzcyB0ZXtjb25zdHJ1Y3RvcihlLHQ9d2luZG93KXt0aGlzLnNjcmlwdExvYWRlcj1lLHRoaXMuc3RyaXBlV2luZG93PXR9bG9hZChlLHQsaSl7cmV0dXJuIHRoaXMuc2NyaXB0TG9hZGVyLmxvYWRTY3JpcHQoXCJodHRwczovL2pzLnN0cmlwZS5jb20vdjMvXCIpLnRoZW4oKCk9PntpZighdGhpcy5zdHJpcGVXaW5kb3cuU3RyaXBlKXRocm93IG5ldyBfO3JldHVybiB0aGlzLnN0cmlwZVdpbmRvdy5TdHJpcGUoZSx7c3RyaXBlQWNjb3VudDp0LGxvY2FsZTppLGJldGFzOltcInBheW1lbnRfaW50ZW50X2JldGFfM1wiLFwiYWxpcGF5X3BtX2JldGFfMVwiXSxhcGlWZXJzaW9uOlwiMjAyMC0wMy0wMjthbGlwYXlfYmV0YT12MVwifSl9KX19Y29uc3QgaWU9dih0PT5uZXcgZWUodCxuZXcgdGUoZSgpKSksW3tnYXRld2F5Olwic3RyaXBldjNcIn1dKSxuZT17Ym9keTp7fSxoZWFkZXJzOnt9LHN0YXR1czowfTtjbGFzcyByZSBleHRlbmRzIFN7Y29uc3RydWN0b3IoZSx7bWVzc2FnZTp0LGVycm9yczppfT17fSl7Y29uc3R7Ym9keTpuLGhlYWRlcnM6cixzdGF0dXM6b309ZXx8bmU7c3VwZXIodHx8XCJBbiB1bmV4cGVjdGVkIGVycm9yIGhhcyBvY2N1cnJlZC5cIiksdGhpcy5uYW1lPVwiUmVxdWVzdEVycm9yXCIsdGhpcy50eXBlPVwicmVxdWVzdFwiLHRoaXMuYm9keT1uLHRoaXMuaGVhZGVycz1yLHRoaXMuc3RhdHVzPW8sdGhpcy5lcnJvcnM9aXx8W119fWNvbnN0IG9lPXthcjpbXCJhclwiXSxiZzpbXCJiZ1wiXSxjczpbXCJjc1wiXSxkYTpbXCJkYVwiXSxkZTpbXCJkZVwiXSxlbDpbXCJlbFwiXSxlbjpbXCJlblwiLFwiZW4tR0JcIl0sZXM6W1wiZXNcIixcImVzLTQxOVwiXSxldDpbXCJldFwiXSxmaTpbXCJmaVwiXSxmaWw6W1wiZmlsXCJdLGZyOltcImZyXCIsXCJmci1DQVwiXSxoZTpbXCJoZVwiXSxocjpbXCJoclwiXSxodTpbXCJodVwiXSxpZDpbXCJpZFwiXSxpdDpbXCJpdFwiXSxqYTpbXCJqYVwiXSxrbzpbXCJrb1wiXSxsdDpbXCJsdFwiXSxsdjpbXCJsdlwiXSxtczpbXCJtc1wiXSxtdDpbXCJtdFwiXSxuYjpbXCJuYlwiXSxubDpbXCJubFwiXSxwbDpbXCJwbFwiXSxwdDpbXCJwdFwiLFwicHQtQlJcIl0scm86W1wicm9cIl0scnU6W1wicnVcIl0sc2s6W1wic2tcIl0sc2w6W1wic2xcIl0sc3Y6W1wic3ZcIl0sdGg6W1widGhcIl0sdHI6W1widHJcIl0sdmk6W1widmlcIl0semg6W1wiemhcIixcInpoLUhLXCIsXCJ6aC1UV1wiXX07ZnVuY3Rpb24gc2UoZSl7Y29uc3RbdCxpXT1lLnJlcGxhY2UoL18vZyxcIi1cIikudG9Mb3dlckNhc2UoKS5zcGxpdChcIi1cIiksbj1vZVt0XTtpZighbilyZXR1cm5cImF1dG9cIjtjb25zdCByPWk/YCR7dH0tJHtpLnRvVXBwZXJDYXNlKCl9YDp0O3JldHVybiBuLmluZGV4T2Yocik+LTE/cjpuWzBdfWNvbnN0IGFlPVtcInBheW1lbnRfZWxlbWVudF9iZXRhXzJcIixcImFsaXBheV9wbV9iZXRhXzFcIixcImxpbmtfZGVmYXVsdF9pbnRlZ3JhdGlvbl9iZXRhXzFcIixcInNoaXBwaW5nX2FkZHJlc3NfZWxlbWVudF9iZXRhXzFcIixcImFkZHJlc3NfZWxlbWVudF9iZXRhXzFcIl0sZGU9XCIyMDIwLTAzLTAyO2FsaXBheV9iZXRhPXYxO2xpbmtfYmV0YT12MVwiO2Z1bmN0aW9uIGxlKGUpe3JldHVyblwic3RyaXBlTGlua0F1dGhlbnRpY2F0aW9uU3RhdGVcImluIGV9dmFyIGNlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGEoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHMsYSl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIHVle2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLnNjcmlwdExvYWRlcj10LHRoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlPWl9aW5pdGlhbGl6ZShlKXtyZXR1cm4gY2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3N0cmlwZXVwZTp0LG1ldGhvZElkOmksZ2F0ZXdheUlkOm59PWU7aWYoIShudWxsPT10P3ZvaWQgMDp0LmNvbnRhaW5lcklkKSl0aHJvdyBuZXcgdyhmLlBheW1lbnROb3RJbml0aWFsaXplZCk7aWYoIW4pdGhyb3cgbmV3IEIoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcImdhdGV3YXlJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtyZXR1cm4gdGhpcy5fbG9hZFN0cmlwZUVsZW1lbnQodCxuLGkpLmNhdGNoKGU9Pnt2YXIgaTtyZXR1cm4gbnVsbD09PShpPXQub25FcnJvcil8fHZvaWQgMD09PWk/dm9pZCAwOmkuY2FsbCh0LGUpfSksdGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2UuaW5pdENoZWNrb3V0RXZlbnRzU3Vic2NyaXB0aW9uKG4saSx0LHRoaXMuX3N0cmlwZUVsZW1lbnRzKSxQcm9taXNlLnJlc29sdmUoKX0pfWV4ZWN1dGUoZSx0KXtyZXR1cm4gY2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6aX09ZSxuPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7cjxuLmxlbmd0aDtyKyspdC5pbmRleE9mKG5bcl0pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bcl0pJiYoaVtuW3JdXT1lW25bcl1dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKTtpZighaXx8IWkucGF5bWVudERhdGEpdGhyb3cgbmV3IEYoW1wicGF5bWVudC5wYXltZW50RGF0YVwiXSk7aWYoIXRoaXMuX3N0cmlwZVVQRUNsaWVudCl0aHJvdyBuZXcgdyhmLlBheW1lbnROb3RJbml0aWFsaXplZCk7Y29uc3R7cGF5bWVudERhdGE6cixtZXRob2RJZDpvLGdhdGV3YXlJZDpzfT1pLHtzaG91bGRTYXZlSW5zdHJ1bWVudDphPSExLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6ZD0hMX09RyhyKT9yOnt9LGw9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkse2lzU3RvcmVDcmVkaXRBcHBsaWVkOmN9PWwuZ2V0Q2hlY2tvdXRPclRocm93KCksdT1sLmdldFBheW1lbnRQcm92aWRlckN1c3RvbWVyT3JUaHJvdygpLGg9KGxlKHUpP3U6e30pLnN0cmlwZUxpbmtBdXRoZW50aWNhdGlvblN0YXRlO2lmKGMmJih5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuYXBwbHlTdG9yZUNyZWRpdChjKSkscyl7eWllbGQgdGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlU3RyaXBlUGF5bWVudEludGVudChzLG8pO2NvbnN0e2VtYWlsOmV9PWwuZ2V0Q3VzdG9tZXJPclRocm93KCk7aWYodm9pZCAwIT09aCYmIWUpe2NvbnN0IGU9bC5nZXRCaWxsaW5nQWRkcmVzc09yVGhyb3coKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3MoZSl9fWlmKHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihuLHQpLEgocikpe2NvbnN0e2luc3RydW1lbnRJZDplfT1yO3JldHVybiB2b2lkKHlpZWxkIHRoaXMuX2V4ZWN1dGVXaXRoVmF1bHRlZChpLm1ldGhvZElkLGUsZCkpfXlpZWxkIHRoaXMuX2V4ZWN1dGVXaXRoU3RyaXBlQ29uZmlybWF0aW9uKGkubWV0aG9kSWQsIWgmJmEsZCl9KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgcSl9ZGVpbml0aWFsaXplKCl7dmFyIGUsdDtyZXR1cm4gbnVsbD09PSh0PW51bGw9PT0oZT10aGlzLl9zdHJpcGVFbGVtZW50cyl8fHZvaWQgMD09PWU/dm9pZCAwOmUuZ2V0RWxlbWVudChoLlBBWU1FTlQpKXx8dm9pZCAwPT09dHx8dC51bm1vdW50KCksdGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2UuZGVpbml0aWFsaXplKCksdGhpcy5fc3RyaXBlRWxlbWVudHM9dm9pZCAwLHRoaXMuX3N0cmlwZVVQRUNsaWVudD12b2lkIDAsUHJvbWlzZS5yZXNvbHZlKCl9X2V4ZWN1dGVXaXRoU3RyaXBlQ29uZmlybWF0aW9uKGUsdCxpKXtyZXR1cm4gY2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkse2NsaWVudFRva2VuOnJ9PW4uZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSksbz10aGlzLl9nZXRQYXltZW50UGF5bG9hZChlLHJ8fFwiXCIsdCxpKTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQobyl9Y2F0Y2gobil7eWllbGQgdGhpcy5fcHJvY2Vzc0FkZGl0aW9uYWxBY3Rpb25XaXRoU3RyaXBlQ29uZmlybWF0aW9uKG4sZSx0LGkpfX0pfV9leGVjdXRlV2l0aFZhdWx0ZWQoZSx0LGkpe3ZhciBuO3JldHVybiBjZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgcj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxvPXIuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSkscz1udWxsPT09KG49ci5nZXRDYXJ0KCkpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmlkO3RyeXtjb25zdCBuPXttZXRob2RJZDplLHBheW1lbnREYXRhOntmb3JtYXR0ZWRQYXlsb2FkOntjYXJ0X2lkOnMsYmlncGF5X3Rva2VuOnt0b2tlbjp0fSxjb25maXJtOiExLGNsaWVudF90b2tlbjpvLmNsaWVudFRva2VuLHNldF9hc19kZWZhdWx0X3N0b3JlZF9pbnN0cnVtZW50Oml9fX07cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KG4pfWNhdGNoKHQpe3JldHVybiB0aGlzLl9wcm9jZXNzVmF1bHRlZEFkZGl0aW9uYWxBY3Rpb24odCxlLGkpfX0pfV9sb2FkU3RyaXBlRWxlbWVudChlLHQsaSl7cmV0dXJuIGNlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtjb250YWluZXJJZDpuLHN0eWxlOnIscmVuZGVyOm8saW5pdFN0cmlwZUVsZW1lbnRVcGRhdGVUcmlnZ2VyOnN9PWUsYT15aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QodCx7cGFyYW1zOnttZXRob2Q6aX19KSxkPWEuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSk7aWYoIUwoZCkpdGhyb3cgbmV3IEEoQy5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3R7Y2xpZW50VG9rZW46bCxpbml0aWFsaXphdGlvbkRhdGE6dX09ZCx7c2hvcHBlckxhbmd1YWdlOnAsYWxsb3dSZWRpc3BsYXlGb3JTdG9yZWRJbnN0cnVtZW50czp5PSExLGVuYWJsZUxpbms6Z309dTtpZih0aGlzLl9hbGxvd1JlZGlzcGxheUZvclN0b3JlZEluc3RydW1lbnRzPXksIWwpdGhyb3cgbmV3IEEoQy5NaXNzaW5nUGF5bWVudE1ldGhvZCk7bGV0IHY7aWYodGhpcy5fc3RyaXBlVVBFQ2xpZW50PXlpZWxkIHRoaXMuX2xvYWRTdHJpcGVKcyh1KSx0aGlzLl9pc1N0cmlwZUVsZW1lbnRVcGRhdGVFbmFibGVkPVwiZnVuY3Rpb25cIj09dHlwZW9mIHMscil7Y29uc3QgZT1yO3Y9e3ZhcmlhYmxlczp0aGlzLnN0cmlwZUludGVncmF0aW9uU2VydmljZS5tYXBBcHBlYXJhbmNlVmFyaWFibGVzKHIpLHJ1bGVzOntcIi5JbnB1dFwiOnRoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcElucHV0QXBwZWFyYW5jZVJ1bGVzKGUpfX19dGhpcy5fc3RyaXBlRWxlbWVudHM9eWllbGQgdGhpcy5zY3JpcHRMb2FkZXIuZ2V0RWxlbWVudHModGhpcy5fc3RyaXBlVVBFQ2xpZW50LHtjbGllbnRTZWNyZXQ6bCxsb2NhbGU6c2UocCksYXBwZWFyYW5jZTp2fSk7Y29uc3R7Z2V0QmlsbGluZ0FkZHJlc3M6UyxnZXRTaGlwcGluZ0FkZHJlc3M6X309YSx7cG9zdGFsQ29kZTpmfT1fKCl8fFMoKXx8e30sRT10aGlzLl9zdHJpcGVFbGVtZW50cy5nZXRFbGVtZW50KGguUEFZTUVOVCl8fHRoaXMuX3N0cmlwZUVsZW1lbnRzLmNyZWF0ZShoLlBBWU1FTlQsT2JqZWN0LmFzc2lnbih7ZmllbGRzOntiaWxsaW5nRGV0YWlsczp7ZW1haWw6Yy5ORVZFUixhZGRyZXNzOntjb3VudHJ5OmMuTkVWRVIsY2l0eTpjLk5FVkVSLHBvc3RhbENvZGU6Zj9jLk5FVkVSOmMuQVVUT319fSx3YWxsZXRzOnthcHBsZVBheTpjLk5FVkVSLGdvb2dsZVBheTpjLk5FVkVSLGxpbms6Zz9jLkFVVE86Yy5ORVZFUn19LHRoaXMuX2dldFN0cmlwZUVsZW1lbnRUZXJtcygpKSk7dGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2UubW91bnRFbGVtZW50KEUsbiksRS5vbihtLlJFQURZLCgpPT57bygpfSksRS5vbihtLkNIQU5HRSxlPT57KG51bGw9PWU/dm9pZCAwOmUudmFsdWUpJiZcInR5cGVcImluIGUudmFsdWUmJnRoaXMuX3VwZGF0ZVN0cmlwZUxpbmtTdGF0ZUJ5RWxlbWVudFR5cGUoZS52YWx1ZS50eXBlKX0pLHRoaXMuX2lzU3RyaXBlRWxlbWVudFVwZGF0ZUVuYWJsZWQmJihudWxsPT1zfHxzKHRoaXMuX3VwZGF0ZVN0cmlwZUVsZW1lbnQuYmluZCh0aGlzKSkpfSl9X3Byb2Nlc3NBZGRpdGlvbmFsQWN0aW9uV2l0aFN0cmlwZUNvbmZpcm1hdGlvbihlLHQsaT0hMSxuPSExKXtyZXR1cm4gY2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCFEKGUpfHwhdGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2UuaXNBZGRpdGlvbmFsQWN0aW9uRXJyb3IoZS5ib2R5LmVycm9ycykpdGhyb3cgZTtpZighdGhpcy5fc3RyaXBlVVBFQ2xpZW50fHwhdGhpcy5fc3RyaXBlRWxlbWVudHMpdGhyb3cgbmV3IHcoZi5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO2NvbnN0e2RhdGE6cn09ZS5ib2R5LmFkZGl0aW9uYWxfYWN0aW9uX3JlcXVpcmVkLHt0b2tlbjpvfT1yLHtwYXltZW50SW50ZW50OnN9PXlpZWxkIHRoaXMuX2NvbmZpcm1TdHJpcGVQYXltZW50T3JUaHJvdyh0LHIpLGE9dGhpcy5fZ2V0UGF5bWVudFBheWxvYWQodCwobnVsbD09cz92b2lkIDA6cy5pZCl8fG8saSxuKTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoYSl9Y2F0Y2goZSl7dGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2UudGhyb3dQYXltZW50Q29uZmlybWF0aW9uUHJvY2VlZE1lc3NhZ2UoKX19KX1fY29uZmlybVN0cmlwZVBheW1lbnRPclRocm93KGUsdCl7dmFyIGksbjtyZXR1cm4gY2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3Rva2VuOnIscmVkaXJlY3RfdXJsOm99PXQscz10aGlzLnN0cmlwZUludGVncmF0aW9uU2VydmljZS5tYXBTdHJpcGVQYXltZW50RGF0YSh0aGlzLl9zdHJpcGVFbGVtZW50cyxvLCEhdGhpcy5fYWxsb3dSZWRpc3BsYXlGb3JTdG9yZWRJbnN0cnVtZW50cyk7bGV0IGE7dHJ5e2NvbnN0IHQ9KHlpZWxkIHRoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlLmlzUGF5bWVudENvbXBsZXRlZChlLHRoaXMuX3N0cmlwZVVQRUNsaWVudCkpP3lpZWxkIG51bGw9PT0obj10aGlzLl9zdHJpcGVVUEVDbGllbnQpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLnJldHJpZXZlUGF5bWVudEludGVudChyfHxcIlwiKTp5aWVsZCBudWxsPT09KGk9dGhpcy5fc3RyaXBlVVBFQ2xpZW50KXx8dm9pZCAwPT09aT92b2lkIDA6aS5jb25maXJtUGF5bWVudChzKTtpZihhPW51bGw9PXQ/dm9pZCAwOnQuZXJyb3IsYXx8IShudWxsPT10P3ZvaWQgMDp0LnBheW1lbnRJbnRlbnQpKXRocm93IG5ldyBiO3JldHVybiB0fWNhdGNoKGUpe3RoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlLnRocm93U3RyaXBlRXJyb3IoYSl9fSl9X3Byb2Nlc3NWYXVsdGVkQWRkaXRpb25hbEFjdGlvbihlLHQsaT0hMSl7dmFyIG47cmV0dXJuIGNlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdHx8IUQoZSl8fCFvKGUuYm9keS5lcnJvcnMse2NvZGU6XCJ0aHJlZV9kX3NlY3VyZV9yZXF1aXJlZFwifSkpdGhyb3cgZTtpZighdGhpcy5fc3RyaXBlVVBFQ2xpZW50fHwhdGhpcy5fc3RyaXBlRWxlbWVudHMpdGhyb3cgbmV3IHcoZi5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO2NvbnN0IHI9ZS5ib2R5LnRocmVlX2RzX3Jlc3VsdC50b2tlbjtsZXQgcyxhPSExO3RyeXtzPXlpZWxkIHRoaXMuX3N0cmlwZVVQRUNsaWVudC5jb25maXJtQ2FyZFBheW1lbnQocil9Y2F0Y2goZSl7dHJ5e3M9eWllbGQgdGhpcy5fc3RyaXBlVVBFQ2xpZW50LnJldHJpZXZlUGF5bWVudEludGVudChyKX1jYXRjaChlKXthPSEwfX1pZigobnVsbD09cz92b2lkIDA6cy5lcnJvcikmJnRoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlLnRocm93U3RyaXBlRXJyb3Iocy5lcnJvciksIShudWxsPT1zP3ZvaWQgMDpzLnBheW1lbnRJbnRlbnQpJiYhYSl0aHJvdyBuZXcgcmU7Y29uc3QgZD10aGlzLl9nZXRQYXltZW50UGF5bG9hZCh0LGE/cjpudWxsPT09KG49bnVsbD09cz92b2lkIDA6cy5wYXltZW50SW50ZW50KXx8dm9pZCAwPT09bj92b2lkIDA6bi5pZCwhMSxpKTtyZXR1cm4gdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoZCl9KX1fbG9hZFN0cmlwZUpzKGUpe3JldHVybiBjZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYodGhpcy5fc3RyaXBlVVBFQ2xpZW50KXJldHVybiB0aGlzLl9zdHJpcGVVUEVDbGllbnQ7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTtyZXR1cm4gdGhpcy5zY3JpcHRMb2FkZXIuZ2V0U3RyaXBlQ2xpZW50KGUsdC5nZXRDYXJ0TG9jYWxlKCksdS5WMyxhZSxkZSl9KX1fZ2V0UGF5bWVudFBheWxvYWQoZSx0LGk9ITEsbj0hMSl7dmFyIHI7cmV0dXJue21ldGhvZElkOmUscGF5bWVudERhdGE6e2Zvcm1hdHRlZFBheWxvYWQ6e2NhcnRfaWQ6KG51bGw9PT0ocj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDYXJ0KCkpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLmlkKXx8XCJcIixjcmVkaXRfY2FyZF90b2tlbjp7dG9rZW46dH0sY29uZmlybTohMSx2YXVsdF9wYXltZW50X2luc3RydW1lbnQ6aSxzZXRfYXNfZGVmYXVsdF9zdG9yZWRfaW5zdHJ1bWVudDpufX19fV91cGRhdGVTdHJpcGVFbGVtZW50KHtzaG91bGRTaG93VGVybXM6ZX0pe3ZhciB0O2NvbnN0IGk9bnVsbD09PSh0PXRoaXMuX3N0cmlwZUVsZW1lbnRzKXx8dm9pZCAwPT09dD92b2lkIDA6dC5nZXRFbGVtZW50KGguUEFZTUVOVCk7bnVsbD09aXx8aS51cGRhdGUoT2JqZWN0LmFzc2lnbih7fSx0aGlzLl9nZXRTdHJpcGVFbGVtZW50VGVybXMoZSkpKX1fZ2V0U3RyaXBlRWxlbWVudFRlcm1zKGUpe2xldCB0PWMuQVVUTztyZXR1cm4gdGhpcy5faXNTdHJpcGVFbGVtZW50VXBkYXRlRW5hYmxlZCYmKHQ9ZT9jLkFVVE86Yy5ORVZFUikse3Rlcm1zOntjYXJkOnR9fX1fdXBkYXRlU3RyaXBlTGlua1N0YXRlQnlFbGVtZW50VHlwZShlKXtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRQcm92aWRlckN1c3RvbWVyT3JUaHJvdygpLGk9ZT09PWwuTGluazshbGUodCkmJmkmJnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVQYXltZW50UHJvdmlkZXJDdXN0b21lcih7c3RyaXBlTGlua0F1dGhlbnRpY2F0aW9uU3RhdGU6aX0pfX1jb25zdCBoZT12KHQ9Pntjb25zdCBpPW5ldyBJKGUoKSk7cmV0dXJuIG5ldyB1ZSh0LGksbmV3IE0odCxpKSl9LFt7Z2F0ZXdheTpcInN0cmlwZXVwZVwifSx7Z2F0ZXdheTpcInN0cmlwZXVwZVwiLGlkOlwia2xhcm5hXCJ9XSkscGU9ZT0+XCJvYmplY3RcIj09dHlwZW9mIGUmJm51bGwhPT1lJiZcInZhbHVlXCJpbiBlJiZcImNvbGxhcHNlZFwiaW4gZTt2YXIgbWU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBzKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gYShlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4ocyxhKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgeWV7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuc2NyaXB0TG9hZGVyPXQsdGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2U9aX1pbml0aWFsaXplKGUpe3ZhciB0O3JldHVybiBtZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7c3RyaXBlb2NzOmksbWV0aG9kSWQ6bixnYXRld2F5SWQ6cn09ZTtpZighKG51bGw9PWk/dm9pZCAwOmkuY29udGFpbmVySWQpKXRocm93IG5ldyB3KGYuUGF5bWVudE5vdEluaXRpYWxpemVkKTtpZighcil0aHJvdyBuZXcgQignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwiZ2F0ZXdheUlkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3RyeXt5aWVsZCB0aGlzLl9pbml0aWFsaXplU3RyaXBlRWxlbWVudChpLHIsbil9Y2F0Y2goZSl7ZSBpbnN0YW5jZW9mIEVycm9yJiYobnVsbD09PSh0PWkub25FcnJvcil8fHZvaWQgMD09PXR8fHQuY2FsbChpLGUpKX10aGlzLnN0cmlwZUludGVncmF0aW9uU2VydmljZS5pbml0Q2hlY2tvdXRFdmVudHNTdWJzY3JpcHRpb24ocixuLGksdGhpcy5zdHJpcGVFbGVtZW50cyl9KX1leGVjdXRlKGUsdCl7cmV0dXJuIG1lKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Oml9PWUsbj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSkse21ldGhvZElkOnIsZ2F0ZXdheUlkOm99PWl8fHt9O2lmKCF0aGlzLnN0cmlwZUNsaWVudCl0aHJvdyBuZXcgdyhmLlBheW1lbnROb3RJbml0aWFsaXplZCk7aWYoIW98fCFyKXRocm93IG5ldyBCKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJnYXRld2F5SWRcIiBvciBcIm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2NvbnN0e2lzU3RvcmVDcmVkaXRBcHBsaWVkOnN9PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENoZWNrb3V0T3JUaHJvdygpO3MmJih5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuYXBwbHlTdG9yZUNyZWRpdChzKSkseWllbGQgdGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlU3RyaXBlUGF5bWVudEludGVudChvLHIpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihuLHQpO2NvbnN0e2NsaWVudFRva2VuOmF9PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KHIsbyksZD10aGlzLl9nZXRQYXltZW50UGF5bG9hZChyLGF8fFwiXCIpO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChkKX1jYXRjaChlKXt5aWVsZCB0aGlzLl9wcm9jZXNzQWRkaXRpb25hbEFjdGlvbihlLHIpfX0pfWZpbmFsaXplKCl7cmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBxKX1kZWluaXRpYWxpemUoKXt2YXIgZTtjb25zdCB0PW51bGw9PT0oZT10aGlzLnN0cmlwZUVsZW1lbnRzKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5nZXRFbGVtZW50KGguUEFZTUVOVCk7cmV0dXJuIG51bGw9PXR8fHQudW5tb3VudCgpLG51bGw9PXR8fHQuZGVzdHJveSgpLHRoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlLmRlaW5pdGlhbGl6ZSgpLHRoaXMuc3RyaXBlRWxlbWVudHM9dm9pZCAwLHRoaXMuc3RyaXBlQ2xpZW50PXZvaWQgMCxQcm9taXNlLnJlc29sdmUoKX1faW5pdGlhbGl6ZVN0cmlwZUVsZW1lbnQoZSx0LGkpe3JldHVybiBtZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7bGV0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSx0KTtpZigobnVsbD09bj92b2lkIDA6bi5jbGllbnRUb2tlbil8fChuPSh5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QodCx7cGFyYW1zOnttZXRob2Q6aX19KSkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSx0KSksIUwobikpdGhyb3cgbmV3IEEoQy5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3R7Y2xpZW50VG9rZW46cixpbml0aWFsaXphdGlvbkRhdGE6b309bix7c2hvcHBlckxhbmd1YWdlOnMsY3VzdG9tZXJTZXNzaW9uVG9rZW46YSxlbmFibGVMaW5rOmR9PW87aWYoIXIpdGhyb3cgbmV3IEEoQy5NaXNzaW5nUGF5bWVudE1ldGhvZCk7dGhpcy5zdHJpcGVDbGllbnQ9eWllbGQgdGhpcy5fbG9hZFN0cmlwZUpzKG8pO2NvbnN0e2FwcGVhcmFuY2U6bCxjb250YWluZXJJZDp1LGZvbnRzOnAsbGF5b3V0OnkscmVuZGVyOmcscGF5bWVudE1ldGhvZFNlbGVjdDp2LGhhbmRsZUNsb3NlUGF5bWVudE1ldGhvZDpTLHRvZ2dsZVByZWxvYWRlcjpffT1lO3RoaXMuc3RyaXBlRWxlbWVudHM9eWllbGQgdGhpcy5zY3JpcHRMb2FkZXIuZ2V0RWxlbWVudHModGhpcy5zdHJpcGVDbGllbnQse2NsaWVudFNlY3JldDpyLGN1c3RvbWVyU2Vzc2lvbkNsaWVudFNlY3JldDphLGxvY2FsZTpzZShzKSxhcHBlYXJhbmNlOmwsZm9udHM6cH0pO2NvbnN0e2dldEJpbGxpbmdBZGRyZXNzOmYsZ2V0U2hpcHBpbmdBZGRyZXNzOkV9PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLEk9ZigpLHtwb3N0YWxDb2RlOlB9PUUoKXx8SXx8e30sYj10aGlzLnN0cmlwZUVsZW1lbnRzLmdldEVsZW1lbnQoaC5QQVlNRU5UKXx8dGhpcy5zdHJpcGVFbGVtZW50cy5jcmVhdGUoaC5QQVlNRU5ULHtmaWVsZHM6e2JpbGxpbmdEZXRhaWxzOntlbWFpbDpjLk5FVkVSLGFkZHJlc3M6e2NvdW50cnk6Yy5ORVZFUixjaXR5OmMuTkVWRVIscG9zdGFsQ29kZTpQP2MuTkVWRVI6Yy5BVVRPfX19LHdhbGxldHM6e2FwcGxlUGF5OmMuTkVWRVIsZ29vZ2xlUGF5OmMuTkVWRVIsbGluazpkP2MuQVVUTzpjLk5FVkVSfSxsYXlvdXQ6eSxzYXZlUGF5bWVudE1ldGhvZDp7bWF4VmlzaWJsZVBheW1lbnRNZXRob2RzOjIwfSxkZWZhdWx0VmFsdWVzOntiaWxsaW5nRGV0YWlsczp7ZW1haWw6KG51bGw9PUk/dm9pZCAwOkkuZW1haWwpfHxcIlwifX19KTt0aGlzLnN0cmlwZUludGVncmF0aW9uU2VydmljZS5tb3VudEVsZW1lbnQoYix1KSxiLm9uKG0uTE9BREVSX1NUQVJULCgpPT57bnVsbD09X3x8XyghMSl9KSxiLm9uKG0uUkVBRFksKCk9PntnKCl9KSxiLm9uKG0uQ0hBTkdFLGU9Pnt0aGlzLl9vblN0cmlwZUVsZW1lbnRDaGFuZ2UoZSx0LGksdil9KSxudWxsPT1TfHxTKHRoaXMuX2NvbGxhcHNlU3RyaXBlRWxlbWVudC5iaW5kKHRoaXMpKX0pfV9sb2FkU3RyaXBlSnMoZSl7cmV0dXJuIG1lKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZih0aGlzLnN0cmlwZUNsaWVudClyZXR1cm4gdGhpcy5zdHJpcGVDbGllbnQ7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxpPXRoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0cmlwZUpzVmVyc2lvbihlKTtyZXR1cm4gdGhpcy5zY3JpcHRMb2FkZXIuZ2V0U3RyaXBlQ2xpZW50KGUsdC5nZXRDYXJ0TG9jYWxlKCksaSl9KX1fY29sbGFwc2VTdHJpcGVFbGVtZW50KCl7dmFyIGU7Y29uc3QgdD1udWxsPT09KGU9dGhpcy5zdHJpcGVFbGVtZW50cyl8fHZvaWQgMD09PWU/dm9pZCAwOmUuZ2V0RWxlbWVudChoLlBBWU1FTlQpO251bGw9PXR8fHQuY29sbGFwc2UoKX1fZ2V0UGF5bWVudFBheWxvYWQoZSx0LGkpe3ZhciBuO2NvbnN0IHI9KG51bGw9PT0obj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDYXJ0KCkpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmlkKXx8XCJcIix7Y2FyZDpvLHVzX2JhbmtfYWNjb3VudDpzfT1pfHx7fSxhPXRoaXMuX3Nob3VsZFNhdmVJbnN0cnVtZW50KG8pfHx0aGlzLl9zaG91bGRTYXZlSW5zdHJ1bWVudChzKSxkPXRoaXMuX2dldFRva2VuaXplZE9wdGlvbnModCxpKTtyZXR1cm57bWV0aG9kSWQ6ZSxwYXltZW50RGF0YTp7Zm9ybWF0dGVkUGF5bG9hZDpPYmplY3QuYXNzaWduKHtjYXJ0X2lkOnIsY29uZmlybTohMSxtZXRob2Q6dGhpcy5zZWxlY3RlZE1ldGhvZElkLHZhdWx0X3BheW1lbnRfaW5zdHJ1bWVudDphfSxkKX19fV9wcm9jZXNzQWRkaXRpb25hbEFjdGlvbihlLHQpe3JldHVybiBtZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIUQoZSl8fCF0aGlzLnN0cmlwZUludGVncmF0aW9uU2VydmljZS5pc0FkZGl0aW9uYWxBY3Rpb25FcnJvcihlLmJvZHkuZXJyb3JzKSl0aHJvdyBlO2lmKCF0aGlzLnN0cmlwZUNsaWVudHx8IXRoaXMuc3RyaXBlRWxlbWVudHMpdGhyb3cgbmV3IHcoZi5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO2NvbnN0e2RhdGE6aX09ZS5ib2R5LmFkZGl0aW9uYWxfYWN0aW9uX3JlcXVpcmVkLHt0b2tlbjpufT1pLHtwYXltZW50SW50ZW50OnJ9PXlpZWxkIHRoaXMuX2NvbmZpcm1TdHJpcGVQYXltZW50T3JUaHJvdyh0LGkpLHtjbGllbnRfc2VjcmV0Om8scGF5bWVudF9tZXRob2Rfb3B0aW9uczpzfT1yfHx7fSxhPXRoaXMuX2dldFBheW1lbnRQYXlsb2FkKHQsb3x8bixzKTt0cnl7cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGEpfWNhdGNoKGUpe3RoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlLnRocm93UGF5bWVudENvbmZpcm1hdGlvblByb2NlZWRNZXNzYWdlKCl9fSl9X2NvbmZpcm1TdHJpcGVQYXltZW50T3JUaHJvdyhlLHQpe3ZhciBpLG47cmV0dXJuIG1lKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHt0b2tlbjpyLHJlZGlyZWN0X3VybDpvfT10LHM9dGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2UubWFwU3RyaXBlUGF5bWVudERhdGEodGhpcy5zdHJpcGVFbGVtZW50cyxvKTtsZXQgYTt0cnl7Y29uc3QgdD0oeWllbGQgdGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2UuaXNQYXltZW50Q29tcGxldGVkKGUsdGhpcy5zdHJpcGVDbGllbnQpKT95aWVsZCBudWxsPT09KG49dGhpcy5zdHJpcGVDbGllbnQpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLnJldHJpZXZlUGF5bWVudEludGVudChyfHxcIlwiKTp5aWVsZCBudWxsPT09KGk9dGhpcy5zdHJpcGVDbGllbnQpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmNvbmZpcm1QYXltZW50KHMpO2lmKGE9bnVsbD09dD92b2lkIDA6dC5lcnJvcixhfHwhKG51bGw9PXQ/dm9pZCAwOnQucGF5bWVudEludGVudCkpdGhyb3cgbmV3IGI7cmV0dXJuIHR9Y2F0Y2goZSl7cmV0dXJuIHRoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlLnRocm93U3RyaXBlRXJyb3IoYSl9fSl9X29uU3RyaXBlRWxlbWVudENoYW5nZShlLHQsaSxuKXtwZShlKSYmIWUuY29sbGFwc2VkJiYodGhpcy5zZWxlY3RlZE1ldGhvZElkPWUudmFsdWUudHlwZSxudWxsPT1ufHxuKGAke3R9LSR7aX1gKSl9X3Nob3VsZFNhdmVJbnN0cnVtZW50KGUpe2NvbnN0IHQ9bnVsbD09ZT92b2lkIDA6ZS5zZXR1cF9mdXR1cmVfdXNhZ2U7cmV0dXJuIHQ9PT15Lk9OX1NFU1NJT058fHQ9PT15Lk9GRl9TRVNTSU9OfV9nZXRUb2tlbml6ZWRPcHRpb25zKGUsdCl7cmV0dXJuIHRoaXMuX3Nob3VsZFNhdmVJbnN0cnVtZW50KG51bGw9PXQ/dm9pZCAwOnQudXNfYmFua19hY2NvdW50KT97dG9rZW5pemVkX2FjaDp7dG9rZW46ZX19OntjcmVkaXRfY2FyZF90b2tlbjp7dG9rZW46ZX19fX1jb25zdCBnZT12KHQ9Pntjb25zdCBpPW5ldyBJKGUoKSk7cmV0dXJuIG5ldyB5ZSh0LGksbmV3IE0odCxpKSl9LFt7Z2F0ZXdheTpcInN0cmlwZW9jc1wiLGlkOlwib3B0aW1pemVkX2NoZWNrb3V0XCJ9XSk7dmFyIHZlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGEoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHMsYSl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIFNle2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLnNjcmlwdExvYWRlcj10LHRoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlPWl9aW5pdGlhbGl6ZShlKXt2YXIgdDtyZXR1cm4gdmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3N0cmlwZW9jczppLG1ldGhvZElkOm4sZ2F0ZXdheUlkOnJ9PWU7aWYoIShudWxsPT1pP3ZvaWQgMDppLmNvbnRhaW5lcklkKXx8IXIpdGhyb3cgbmV3IHcoZi5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO3RyeXt5aWVsZCB0aGlzLl9pbml0aWFsaXplU3RyaXBlRWxlbWVudChpLHIsbil9Y2F0Y2goZSl7ZSBpbnN0YW5jZW9mIEVycm9yJiYobnVsbD09PSh0PWkub25FcnJvcil8fHZvaWQgMD09PXR8fHQuY2FsbChpLGUpKX19KX1leGVjdXRlKCl7cmV0dXJuIHZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgcSl9ZGVpbml0aWFsaXplKCl7dmFyIGU7Y29uc3QgdD1udWxsPT09KGU9dGhpcy5zdHJpcGVDaGVja291dFNlc3Npb24pfHx2b2lkIDA9PT1lP3ZvaWQgMDplLmdldFBheW1lbnRFbGVtZW50KCk7cmV0dXJuIG51bGw9PXR8fHQudW5tb3VudCgpLG51bGw9PXR8fHQuZGVzdHJveSgpLHRoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlLmRlaW5pdGlhbGl6ZSgpLHRoaXMuc3RyaXBlQ2hlY2tvdXRTZXNzaW9uPXZvaWQgMCx0aGlzLnN0cmlwZUNsaWVudD12b2lkIDAsUHJvbWlzZS5yZXNvbHZlKCl9X2luaXRpYWxpemVTdHJpcGVFbGVtZW50KGUsdCxpKXtyZXR1cm4gdmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2xldCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KGksdCk7aWYoKG51bGw9PW4/dm9pZCAwOm4uY2xpZW50VG9rZW4pfHwobj0oeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKHQse3BhcmFtczp7bWV0aG9kOml9fSkpLmdldFBheW1lbnRNZXRob2RPclRocm93KGksdCkpLCFMKG4pKXRocm93IG5ldyBBKEMuTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0e2NsaWVudFRva2VuOnIsaW5pdGlhbGl6YXRpb25EYXRhOm99PW47aWYoIXIpdGhyb3cgbmV3IEEoQy5NaXNzaW5nUGF5bWVudE1ldGhvZCk7dGhpcy5zdHJpcGVDbGllbnQ9eWllbGQgdGhpcy5fbG9hZFN0cmlwZUpzKG8pO2NvbnN0e2VuYWJsZUxpbms6c309byx7YXBwZWFyYW5jZTphLGNvbnRhaW5lcklkOmQsZm9udHM6bCxsYXlvdXQ6dSxyZW5kZXI6aCxwYXltZW50TWV0aG9kU2VsZWN0OnAsaGFuZGxlQ2xvc2VQYXltZW50TWV0aG9kOnksdG9nZ2xlUHJlbG9hZGVyOmd9PWUse2dldEJpbGxpbmdBZGRyZXNzOnYsZ2V0U2hpcHBpbmdBZGRyZXNzOlN9PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLF89digpLHtwb3N0YWxDb2RlOkV9PVMoKXx8X3x8e307dGhpcy5zdHJpcGVDaGVja291dFNlc3Npb249eWllbGQgdGhpcy5zY3JpcHRMb2FkZXIuZ2V0Q2hlY2tvdXRTZXNzaW9uKHRoaXMuc3RyaXBlQ2xpZW50LHtjbGllbnRTZWNyZXQ6cixlbGVtZW50c09wdGlvbnM6e2FwcGVhcmFuY2U6YSxmb250czpsfSxhZGFwdGl2ZVByaWNpbmc6e2FsbG93ZWQ6ITF9LGRlZmF1bHRWYWx1ZXM6e2VtYWlsOihudWxsPT1fP3ZvaWQgMDpfLmVtYWlsKXx8XCJcIn19KTtjb25zdCBJPXRoaXMuX2NyZWF0ZVN0cmlwZUVsZW1lbnQoe2ZpZWxkczp7YmlsbGluZ0RldGFpbHM6e2VtYWlsOmMuTkVWRVIsYWRkcmVzczp7Y291bnRyeTpjLk5FVkVSLGNpdHk6Yy5ORVZFUixwb3N0YWxDb2RlOkU/Yy5ORVZFUjpjLkFVVE99fX0sd2FsbGV0czp7YXBwbGVQYXk6Yy5ORVZFUixnb29nbGVQYXk6Yy5ORVZFUixsaW5rOnM/Yy5BVVRPOmMuTkVWRVJ9LGxheW91dDp1fSk7aWYoIUkpdGhyb3cgbmV3IHcoZi5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO3RoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlLm1vdW50RWxlbWVudChJLGQpLEkub24obS5MT0FERVJfU1RBUlQsKCk9PntudWxsPT1nfHxnKCExKX0pLEkub24obS5SRUFEWSwoKT0+e2goKX0pLEkub24obS5DSEFOR0UsZT0+e3RoaXMuX29uU3RyaXBlRWxlbWVudENoYW5nZShlLHQsaSxwKX0pLG51bGw9PXl8fHkodGhpcy5fY29sbGFwc2VTdHJpcGVFbGVtZW50LmJpbmQodGhpcykpfSl9X2xvYWRTdHJpcGVKcyhlKXtyZXR1cm4gdmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKHRoaXMuc3RyaXBlQ2xpZW50KXJldHVybiB0aGlzLnN0cmlwZUNsaWVudDtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO3JldHVybiB0aGlzLnNjcmlwdExvYWRlci5nZXRTdHJpcGVDbGllbnQoZSx0LmdldENhcnRMb2NhbGUoKSx1LkNMT1ZFUil9KX1fY3JlYXRlU3RyaXBlRWxlbWVudChlKXt2YXIgdCxpO3JldHVybihudWxsPT09KHQ9dGhpcy5zdHJpcGVDaGVja291dFNlc3Npb24pfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmdldFBheW1lbnRFbGVtZW50KCkpfHwobnVsbD09PShpPXRoaXMuc3RyaXBlQ2hlY2tvdXRTZXNzaW9uKXx8dm9pZCAwPT09aT92b2lkIDA6aS5jcmVhdGVQYXltZW50RWxlbWVudChlKSl9X29uU3RyaXBlRWxlbWVudENoYW5nZShlLHQsaSxuKXtwZShlKSYmIWUuY29sbGFwc2VkJiYobnVsbD09bnx8bihgJHt0fS0ke2l9YCkpfV9jb2xsYXBzZVN0cmlwZUVsZW1lbnQoKXt2YXIgZTtjb25zdCB0PW51bGw9PT0oZT10aGlzLnN0cmlwZUNoZWNrb3V0U2Vzc2lvbil8fHZvaWQgMD09PWU/dm9pZCAwOmUuZ2V0UGF5bWVudEVsZW1lbnQoKTtudWxsPT10fHx0LmNvbGxhcHNlKCl9fWNvbnN0IF9lPXYodD0+e2NvbnN0IGk9bmV3IEkoZSgpKTtyZXR1cm4gbmV3IFNlKHQsaSxuZXcgTSh0LGkpKX0sW3tnYXRld2F5Olwic3RyaXBlb2NzXCIsaWQ6XCJjaGVja291dF9zZXNzaW9uXCJ9XSk7Y2xhc3MgZmV7Y29uc3RydWN0b3IoZSx0KXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLnNjcmlwdExvYWRlcj10fWluaXRpYWxpemUoZSl7dmFyIHQsaSxuLHIsbztyZXR1cm4gaT10aGlzLG49dm9pZCAwLG89ZnVuY3Rpb24qKCl7bGV0IGk7aWYoIWUuc3RyaXBldXBlKXRocm93IG5ldyBCKCdVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIFwib3B0aW9uc1wiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtjb25zdHtjb250YWluZXI6bixnYXRld2F5SWQ6cixtZXRob2RJZDpvLG9uRW1haWxDaGFuZ2U6YSxnZXRTdHlsZXM6ZCxpc0xvYWRpbmc6bH09ZS5zdHJpcGV1cGU7T2JqZWN0LmVudHJpZXMoZS5zdHJpcGV1cGUpLmZvckVhY2goKFtlLHRdKT0+e2lmKCF0KXRocm93IG5ldyBCKGBVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIFwiJHtlfVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC5gKX0pLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChyLHtwYXJhbXM6e21ldGhvZDpvfX0pO2NvbnN0IGM9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkscD1jLmdldFBheW1lbnRNZXRob2RPclRocm93KG8scikse2NsaWVudFRva2VuOnl9PXA7aWYoIUwocCl8fCF5KXRocm93IG5ldyBBKEMuTWlzc2luZ1BheW1lbnRUb2tlbik7Y29uc3R7ZW1haWw6Z309Yy5nZXRDdXN0b21lck9yVGhyb3coKSx2PWMuZ2V0UGF5bWVudFByb3ZpZGVyQ3VzdG9tZXJPclRocm93KCksUz0obGUodik/djp7fSkuc3RyaXBlTGlua0F1dGhlbnRpY2F0aW9uU3RhdGU7aWYoIWcpe2xldCBlO2NvbnN0IHI9XCJmdW5jdGlvblwiPT10eXBlb2YgZCYmZCgpO2U9cj97dmFyaWFibGVzOntjb2xvclByaW1hcnk6ci5maWVsZElubmVyU2hhZG93LGNvbG9yQmFja2dyb3VuZDpyLmZpZWxkQmFja2dyb3VuZCxjb2xvclRleHQ6ci5sYWJlbFRleHQsY29sb3JEYW5nZXI6ci5maWVsZEVycm9yVGV4dCxjb2xvclRleHRTZWNvbmRhcnk6ci5sYWJlbFRleHQsY29sb3JUZXh0UGxhY2Vob2xkZXI6ci5maWVsZFBsYWNlaG9sZGVyVGV4dH0scnVsZXM6e1wiLklucHV0XCI6e2JvcmRlckNvbG9yOnIuZmllbGRCb3JkZXIsY29sb3I6ci5maWVsZFRleHQsYm94U2hhZG93OnIuZmllbGRJbm5lclNoYWRvd319fTp7fSxpPXlpZWxkIHRoaXMuc2NyaXB0TG9hZGVyLmdldFN0cmlwZUNsaWVudChwLmluaXRpYWxpemF0aW9uRGF0YSxjLmdldENhcnRMb2NhbGUoKSx1LlYzLGFlLGRlKSx0aGlzLl9zdHJpcGVFbGVtZW50cz15aWVsZCB0aGlzLnNjcmlwdExvYWRlci5nZXRFbGVtZW50cyhpLHtjbGllbnRTZWNyZXQ6eSxhcHBlYXJhbmNlOmV9KTtjb25zdHtnZXRCaWxsaW5nQWRkcmVzczpvLGdldENvbnNpZ25tZW50czpnfT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSx2PWcoKSxfPW51bGw9PT0odD1udWxsPT12P3ZvaWQgMDp2WzBdKXx8dm9pZCAwPT09dD92b2lkIDA6dC5pZCx7ZW1haWw6Zn09bygpfHx7fSxFPWY/e2RlZmF1bHRWYWx1ZXM6e21vZGU6cy5TSElQUElORyxlbWFpbDpmfX06e30sST10aGlzLl9zdHJpcGVFbGVtZW50cy5nZXRFbGVtZW50KGguQVVUSEVOVElDQVRJT04pfHx0aGlzLl9zdHJpcGVFbGVtZW50cy5jcmVhdGUoaC5BVVRIRU5USUNBVElPTixFKTtJLm9uKG0uQ0hBTkdFLGU9PntpZighKFwiYXV0aGVudGljYXRlZFwiaW4gZSkpdGhyb3cgbmV3IEEoQy5NaXNzaW5nQ3VzdG9tZXIpO3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVQYXltZW50UHJvdmlkZXJDdXN0b21lcih7c3RyaXBlTGlua0F1dGhlbnRpY2F0aW9uU3RhdGU6ZS5hdXRoZW50aWNhdGVkfSksZS5jb21wbGV0ZT9hKGUuYXV0aGVudGljYXRlZCxlLnZhbHVlLmVtYWlsKTphKCExLFwiXCIpLGwmJmwoITEpLHZvaWQgMD09PVMmJmUuYXV0aGVudGljYXRlZCYmXyYmdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmRlbGV0ZUNvbnNpZ25tZW50KF8pfSksSS5tb3VudChgIyR7bn1gKX19LG5ldygocj12b2lkIDApfHwocj1Qcm9taXNlKSkoZnVuY3Rpb24oZSx0KXtmdW5jdGlvbiBzKGUpe3RyeXtkKG8ubmV4dChlKSl9Y2F0Y2goZSl7dChlKX19ZnVuY3Rpb24gYShlKXt0cnl7ZChvLnRocm93KGUpKX1jYXRjaChlKXt0KGUpfX1mdW5jdGlvbiBkKHQpe3ZhciBpO3QuZG9uZT9lKHQudmFsdWUpOihpPXQudmFsdWUsaSBpbnN0YW5jZW9mIHI/aTpuZXcgcihmdW5jdGlvbihlKXtlKGkpfSkpLnRoZW4ocyxhKX1kKChvPW8uYXBwbHkoaSxufHxbXSkpLm5leHQoKSl9KX1kZWluaXRpYWxpemUoKXt2YXIgZSx0O3JldHVybiBudWxsPT09KHQ9bnVsbD09PShlPXRoaXMuX3N0cmlwZUVsZW1lbnRzKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5nZXRFbGVtZW50KGguQVVUSEVOVElDQVRJT04pKXx8dm9pZCAwPT09dHx8dC51bm1vdW50KCksUHJvbWlzZS5yZXNvbHZlKCl9c2lnbkluKGUsdCl7cmV0dXJuIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zaWduSW5DdXN0b21lcihlLHQpLFByb21pc2UucmVzb2x2ZSgpfXNpZ25PdXQoZSl7cmV0dXJuIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zaWduT3V0Q3VzdG9tZXIoZSksUHJvbWlzZS5yZXNvbHZlKCl9ZXhlY3V0ZVBheW1lbnRNZXRob2RDaGVja291dChlKXt2YXIgdDtyZXR1cm4gbnVsbD09PSh0PW51bGw9PWU/dm9pZCAwOmUuY29udGludWVXaXRoQ2hlY2tvdXRDYWxsYmFjayl8fHZvaWQgMD09PXR8fHQuY2FsbChlKSxQcm9taXNlLnJlc29sdmUoKX19Y29uc3QgQ2U9dih0PT5uZXcgZmUodCxuZXcgSShlKCkpKSxbe2lkOlwic3RyaXBldXBlXCJ9XSk7dmFyIEVlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGEoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKHMsYSl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIElle2NvbnN0cnVjdG9yKGUsdCxpLG4pe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuc2NyaXB0TG9hZGVyPXQsdGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2U9aSx0aGlzLmxvYWRpbmdJbmRpY2F0b3I9bn1pbml0aWFsaXplKGUpe3JldHVybiBFZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7c3RyaXBlb2NzOnR9PWV8fHt9O2lmKCF0KXRocm93IG5ldyBCKCdVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIFwib3B0aW9uc1wiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtjb25zdHttZXRob2RJZDppLGdhdGV3YXlJZDpuLGNvbnRhaW5lcjpyfT10O2lmKCFyfHwhaXx8IW4pdGhyb3cgbmV3IHcoZi5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO2NvbnN0IG89eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKG4se3BhcmFtczp7bWV0aG9kOml9fSkscz1vLmdldFBheW1lbnRNZXRob2RPclRocm93KGksbikse2xvYWRpbmdDb250YWluZXJJZDphLGJ1dHRvbkhlaWdodDpkLG9uQ29tcGxldGU6bH09dDtpZih0aGlzLl9sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyPWEsdGhpcy5fb25Db21wbGV0ZT1sLCFMKHMpKXRocm93IG5ldyBBKEMuTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0e2luaXRpYWxpemF0aW9uRGF0YTpjfT1zLHtjYXB0dXJlTWV0aG9kOnV9PWMsaD10aGlzLnN0cmlwZUludGVncmF0aW9uU2VydmljZS5nZXRTdHJpcGVKc1ZlcnNpb24oYyk7dGhpcy5fY2FwdHVyZU1ldGhvZD11LHRoaXMuX3N0cmlwZUNsaWVudD15aWVsZCB0aGlzLnNjcmlwdExvYWRlci5nZXRTdHJpcGVDbGllbnQoYyxvLmdldENhcnRMb2NhbGUoKSxoKSx5aWVsZCB0aGlzLl9tb3VudEV4cHJlc3NDaGVja291dEVsZW1lbnQocix0aGlzLl9zdHJpcGVDbGllbnQsZCksdGhpcy5faW5pdGlhbGl6ZUV2ZW50cyhpKX0pfXNpZ25Jbigpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKX1zaWduT3V0KCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfWV4ZWN1dGVQYXltZW50TWV0aG9kQ2hlY2tvdXQoKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfV9tb3VudEV4cHJlc3NDaGVja291dEVsZW1lbnQoZSx0LGk9NDApe3JldHVybiBFZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgbj10aGlzLl9zaG91bGRSZXF1aXJlU2hpcHBpbmdBZGRyZXNzKCkscj1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7c2hpcHBpbmdBZGRyZXNzUmVxdWlyZWQ6bn0sbj97YWxsb3dlZFNoaXBwaW5nQ291bnRyaWVzOnlpZWxkIHRoaXMuX2dldEF2YWlsYWJsZUNvdW50cmllcygpfTp7fSksbj97c2hpcHBpbmdSYXRlczpbe2lkOlwiX1wiLGFtb3VudDowLGRpc3BsYXlOYW1lOlwiUGVuZGluZyByYXRlc1wifV19Ont9KSx7YmlsbGluZ0FkZHJlc3NSZXF1aXJlZDohMCxlbWFpbFJlcXVpcmVkOiEwLHBob25lTnVtYmVyUmVxdWlyZWQ6ITAscGF5bWVudE1ldGhvZHM6e2xpbms6Yy5BVVRPLGFwcGxlUGF5OmMuTkVWRVIsZ29vZ2xlUGF5OmMuTkVWRVIsYW1hem9uUGF5OmMuTkVWRVIscGF5cGFsOmMuTkVWRVIsa2xhcm5hOmMuTkVWRVJ9LGJ1dHRvbkhlaWdodDppfSkse2NhcnRBbW91bnQ6b309dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKSxzPU9iamVjdC5hc3NpZ24oe21vZGU6XCJwYXltZW50XCIsYW1vdW50OnRoaXMuX3RvQ2VudHMobyksY3VycmVuY3k6dGhpcy5fZ2V0Q3VycmVuY3koKX0sdGhpcy5fY2FwdHVyZU1ldGhvZD97Y2FwdHVyZU1ldGhvZDp0aGlzLl9jYXB0dXJlTWV0aG9kfTp7fSk7cmV0dXJuIHRoaXMuX3N0cmlwZUVsZW1lbnRzPXQuZWxlbWVudHMocyksdGhpcy5fbGlua1YyRWxlbWVudD10aGlzLl9zdHJpcGVFbGVtZW50cy5jcmVhdGUoaC5FWFBSRVNTX0NIRUNLT1VULHIpLHRoaXMuX2xpbmtWMkVsZW1lbnQubW91bnQoYCMke2V9YCksdGhpcy5fbGlua1YyRWxlbWVudH0pfV9pbml0aWFsaXplRXZlbnRzKGUpe3RoaXMuX2xpbmtWMkVsZW1lbnQmJih0aGlzLl9zaG91bGRSZXF1aXJlU2hpcHBpbmdBZGRyZXNzKCkmJih0aGlzLl9saW5rVjJFbGVtZW50Lm9uKG0uU0hJUFBJTkdfQUREUkVTU19DSEFOR0UsZT0+RWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLl9vblNoaXBwaW5nQWRkcmVzc0NoYW5nZShlKX0pKSx0aGlzLl9saW5rVjJFbGVtZW50Lm9uKG0uU0hJUFBJTkdfUkFURV9DSEFOR0UsZT0+RWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLl9vblNoaXBwaW5nUmF0ZUNoYW5nZShlKX0pKSksdGhpcy5fbGlua1YyRWxlbWVudC5vbihtLkNPTkZJUk0sdD0+RWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLl9vbkNvbmZpcm0odCxlKX0pKSx0aGlzLl9saW5rVjJFbGVtZW50Lm9uKG0uQ0FOQ0VMLHRoaXMuX29uQ2FuY2VsKSl9X29uU2hpcHBpbmdBZGRyZXNzQ2hhbmdlKGUpe3JldHVybiBFZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIShcImFkZHJlc3NcImluIGUpKXJldHVybjtjb25zdCB0PWUuYWRkcmVzcyxpPXtmaXJzdE5hbWU6XCJcIixsYXN0TmFtZTpcIlwiLHBob25lOlwiXCIsY29tcGFueTpcIlwiLGFkZHJlc3MxOlwiXCIsYWRkcmVzczI6XCJcIixjaXR5OihudWxsPT10P3ZvaWQgMDp0LmNpdHkpfHxcIlwiLGNvdW50cnlDb2RlOihudWxsPT10P3ZvaWQgMDp0LmNvdW50cnkpfHxcIlwiLHBvc3RhbENvZGU6KG51bGw9PXQ/dm9pZCAwOnQucG9zdGFsX2NvZGUpfHxcIlwiLHN0YXRlT3JQcm92aW5jZToobnVsbD09dD92b2lkIDA6dC5zdGF0ZSl8fFwiXCIsc3RhdGVPclByb3ZpbmNlQ29kZToobnVsbD09dD92b2lkIDA6dC5zdGF0ZSl8fFwiXCIsY3VzdG9tRmllbGRzOltdfTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlU2hpcHBpbmdBZGRyZXNzKGkpO2NvbnN0IG49eWllbGQgdGhpcy5fZ2V0QXZhaWxhYmxlU2hpcHBpbmdPcHRpb25zKCk7eWllbGQgdGhpcy5fdXBkYXRlRGlzcGxheWVkUHJpY2UoKSwobnVsbD09bj92b2lkIDA6bi5sZW5ndGgpP2UucmVzb2x2ZSh7c2hpcHBpbmdSYXRlczpufSk6ZS5yZWplY3QoKX0pfV9vbkNhbmNlbCgpe3Rocm93IG5ldyBQfV9vblNoaXBwaW5nUmF0ZUNoYW5nZShlKXtyZXR1cm4gRWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKFwic2hpcHBpbmdSYXRlXCJpbiBlKXtjb25zdHtzaGlwcGluZ1JhdGU6dH09ZTt5aWVsZCB0aGlzLl9oYW5kbGVTaGlwcGluZ09wdGlvbkNoYW5nZShudWxsPT10P3ZvaWQgMDp0LmlkKSx5aWVsZCB0aGlzLl91cGRhdGVEaXNwbGF5ZWRQcmljZSgpLGUucmVzb2x2ZSh7fSl9fSl9X29uQ29uZmlybShlLHQpe3JldHVybiBFZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoXCJiaWxsaW5nRGV0YWlsc1wiaW4gZSYmXCJzaGlwcGluZ0FkZHJlc3NcImluIGUmJnRoaXMuX3N0cmlwZUNsaWVudCYmdGhpcy5fc3RyaXBlRWxlbWVudHMpe3lpZWxkIHRoaXMuX3VwZGF0ZVNoaXBwaW5nQW5kQmlsbGluZ0FkZHJlc3MoZSkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKCk7Y29uc3QgaT10aGlzLl9nZXRQYXltZW50UGF5bG9hZCh0KTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoaSl9Y2F0Y2goZSl7eWllbGQgdGhpcy5fcHJvY2Vzc0FkZGl0aW9uYWxBY3Rpb24oZSx0KX19cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfSl9X3VwZGF0ZVNoaXBwaW5nQW5kQmlsbGluZ0FkZHJlc3MoZSl7dmFyIHQsaSxuLHIsbyxzLGEsZDtyZXR1cm4gRWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGw9dGhpcy5fc2hvdWxkUmVxdWlyZVNoaXBwaW5nQWRkcmVzcygpLGM9KG51bGw9PT0oaT1udWxsPT09KHQ9ZS5zaGlwcGluZ0FkZHJlc3MpfHx2b2lkIDA9PT10P3ZvaWQgMDp0Lm5hbWUpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLnNwbGl0KFwiIFwiKVswXSl8fChudWxsPT09KHI9bnVsbD09PShuPWUuYmlsbGluZ0RldGFpbHMpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLm5hbWUpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLnNwbGl0KFwiIFwiKVswXSl8fFwiXCIsdT0obnVsbD09PShzPW51bGw9PT0obz1lLnNoaXBwaW5nQWRkcmVzcyl8fHZvaWQgMD09PW8/dm9pZCAwOm8ubmFtZSl8fHZvaWQgMD09PXM/dm9pZCAwOnMuc3BsaXQoXCIgXCIpWzFdKXx8KG51bGw9PT0oZD1udWxsPT09KGE9ZS5iaWxsaW5nRGV0YWlscyl8fHZvaWQgMD09PWE/dm9pZCAwOmEubmFtZSl8fHZvaWQgMD09PWQ/dm9pZCAwOmQuc3BsaXQoXCIgXCIpWzFdKXx8XCJcIjtpZihsKXtjb25zdCB0PXRoaXMuX21hcFNoaXBwaW5nQWRkcmVzcyhlLnNoaXBwaW5nQWRkcmVzcyxlLmJpbGxpbmdEZXRhaWxzLGMsdSk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVNoaXBwaW5nQWRkcmVzcyh0KX1jb25zdCBoPXRoaXMuX21hcEJpbGxpbmdBZGRyZXNzKGUuc2hpcHBpbmdBZGRyZXNzLGUuYmlsbGluZ0RldGFpbHMsYyx1KTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3MoaCl9KX1fbWFwU2hpcHBpbmdBZGRyZXNzKGUsdCxpLG4pe3ZhciByLG8scyxhLGQsbCxjO3JldHVybntmaXJzdE5hbWU6aSxsYXN0TmFtZTpuLHBob25lOihudWxsPT10P3ZvaWQgMDp0LnBob25lKXx8XCJcIixjb21wYW55OlwiXCIsYWRkcmVzczE6KG51bGw9PT0ocj1udWxsPT1lP3ZvaWQgMDplLmFkZHJlc3MpfHx2b2lkIDA9PT1yP3ZvaWQgMDpyLmxpbmUxKXx8XCJcIixhZGRyZXNzMjoobnVsbD09PShvPW51bGw9PWU/dm9pZCAwOmUuYWRkcmVzcyl8fHZvaWQgMD09PW8/dm9pZCAwOm8ubGluZTIpfHxcIlwiLGNpdHk6KG51bGw9PT0ocz1udWxsPT1lP3ZvaWQgMDplLmFkZHJlc3MpfHx2b2lkIDA9PT1zP3ZvaWQgMDpzLmNpdHkpfHxcIlwiLGNvdW50cnlDb2RlOihudWxsPT09KGE9bnVsbD09ZT92b2lkIDA6ZS5hZGRyZXNzKXx8dm9pZCAwPT09YT92b2lkIDA6YS5jb3VudHJ5KXx8XCJcIixwb3N0YWxDb2RlOihudWxsPT09KGQ9bnVsbD09ZT92b2lkIDA6ZS5hZGRyZXNzKXx8dm9pZCAwPT09ZD92b2lkIDA6ZC5wb3N0YWxfY29kZSl8fFwiXCIsc3RhdGVPclByb3ZpbmNlOihudWxsPT09KGw9bnVsbD09ZT92b2lkIDA6ZS5hZGRyZXNzKXx8dm9pZCAwPT09bD92b2lkIDA6bC5zdGF0ZSl8fFwiXCIsc3RhdGVPclByb3ZpbmNlQ29kZToobnVsbD09PShjPW51bGw9PWU/dm9pZCAwOmUuYWRkcmVzcyl8fHZvaWQgMD09PWM/dm9pZCAwOmMuc3RhdGUpfHxcIlwiLGN1c3RvbUZpZWxkczpbXX19X21hcEJpbGxpbmdBZGRyZXNzKGUsdCxpLG4pe3ZhciByLG8scyxhLGQsbDtyZXR1cm57ZW1haWw6KG51bGw9PXQ/dm9pZCAwOnQuZW1haWwpfHxcIlwiLGZpcnN0TmFtZTppLGxhc3ROYW1lOm4scGhvbmU6KG51bGw9PXQ/dm9pZCAwOnQucGhvbmUpfHxcIlwiLGNvbXBhbnk6XCJcIixhZGRyZXNzMToobnVsbD09PShyPW51bGw9PXQ/dm9pZCAwOnQuYWRkcmVzcyl8fHZvaWQgMD09PXI/dm9pZCAwOnIubGluZTEpfHxcIlwiLGFkZHJlc3MyOlwiXCIsY2l0eToobnVsbD09PShvPW51bGw9PXQ/dm9pZCAwOnQuYWRkcmVzcyl8fHZvaWQgMD09PW8/dm9pZCAwOm8uY2l0eSl8fFwiXCIsY291bnRyeUNvZGU6KG51bGw9PT0ocz1udWxsPT10P3ZvaWQgMDp0LmFkZHJlc3MpfHx2b2lkIDA9PT1zP3ZvaWQgMDpzLmNvdW50cnkpfHxcIlwiLHBvc3RhbENvZGU6KG51bGw9PT0oYT1udWxsPT10P3ZvaWQgMDp0LmFkZHJlc3MpfHx2b2lkIDA9PT1hP3ZvaWQgMDphLnBvc3RhbF9jb2RlKXx8XCJcIixzdGF0ZU9yUHJvdmluY2U6KG51bGw9PT0oZD1udWxsPT10P3ZvaWQgMDp0LmFkZHJlc3MpfHx2b2lkIDA9PT1kP3ZvaWQgMDpkLnN0YXRlKXx8XCJcIixzdGF0ZU9yUHJvdmluY2VDb2RlOihudWxsPT09KGw9bnVsbD09ZT92b2lkIDA6ZS5hZGRyZXNzKXx8dm9pZCAwPT09bD92b2lkIDA6bC5zdGF0ZSl8fFwiXCIsY3VzdG9tRmllbGRzOltdfX1fcHJvY2Vzc0FkZGl0aW9uYWxBY3Rpb24oZSx0KXtyZXR1cm4gRWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCFEKGUpfHwhdGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2UuaXNBZGRpdGlvbmFsQWN0aW9uRXJyb3IoZS5ib2R5LmVycm9ycykpdGhyb3cgZTtpZighdGhpcy5fc3RyaXBlQ2xpZW50fHwhdGhpcy5fc3RyaXBlRWxlbWVudHMpdGhyb3cgbmV3IHcoZi5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO2NvbnN0e2RhdGE6aX09ZS5ib2R5LmFkZGl0aW9uYWxfYWN0aW9uX3JlcXVpcmVkLHt0b2tlbjpufT1pLHtwYXltZW50SW50ZW50OnJ9PXlpZWxkIHRoaXMuX2NvbmZpcm1TdHJpcGVQYXltZW50T3JUaHJvdyhpLHQpLG89dGhpcy5fZ2V0UGF5bWVudFBheWxvYWQodCwobnVsbD09cj92b2lkIDA6ci5pZCl8fG4pO3RyeXt0aGlzLl90b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCEwKSx5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudChvKSx5aWVsZCB0aGlzLl9jb21wbGV0ZUNoZWNrb3V0RmxvdygpfWNhdGNoKGUpe3RoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlLnRocm93UGF5bWVudENvbmZpcm1hdGlvblByb2NlZWRNZXNzYWdlKCl9ZmluYWxseXt0aGlzLl90b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKX19KX1fY29uZmlybVN0cmlwZVBheW1lbnRPclRocm93KGUsdCl7dmFyIGksbixyO3JldHVybiBFZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7dG9rZW46byxyZWRpcmVjdF91cmw6c309ZSxhPXRoaXMuc3RyaXBlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFN0cmlwZVBheW1lbnREYXRhKHRoaXMuX3N0cmlwZUVsZW1lbnRzLHMpO2xldCBkO3RyeXtjb25zdCBlPSh5aWVsZCB0aGlzLnN0cmlwZUludGVncmF0aW9uU2VydmljZS5pc1BheW1lbnRDb21wbGV0ZWQodCx0aGlzLl9zdHJpcGVDbGllbnQpKT95aWVsZCBudWxsPT09KHI9dGhpcy5fc3RyaXBlQ2xpZW50KXx8dm9pZCAwPT09cj92b2lkIDA6ci5yZXRyaWV2ZVBheW1lbnRJbnRlbnQob3x8XCJcIik6eWllbGQgbnVsbD09PShpPXRoaXMuX3N0cmlwZUNsaWVudCl8fHZvaWQgMD09PWk/dm9pZCAwOmkuY29uZmlybVBheW1lbnQoe2VsZW1lbnRzOmEuZWxlbWVudHMsY2xpZW50U2VjcmV0Om8scmVkaXJlY3Q6Yy5JRl9SRVFVSVJFRCxjb25maXJtUGFyYW1zOntyZXR1cm5fdXJsOm51bGw9PT0obj1hLmNvbmZpcm1QYXJhbXMpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLnJldHVybl91cmx9fSk7aWYoZD1udWxsPT1lP3ZvaWQgMDplLmVycm9yLGR8fCEobnVsbD09ZT92b2lkIDA6ZS5wYXltZW50SW50ZW50KSl0aHJvdyBuZXcgYjtyZXR1cm4gZX1jYXRjaChlKXtyZXR1cm4gdGhpcy5zdHJpcGVJbnRlZ3JhdGlvblNlcnZpY2UudGhyb3dTdHJpcGVFcnJvcihkKX19KX1fY29tcGxldGVDaGVja291dEZsb3coKXtyZXR1cm4gRWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVyblwiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXMuX29uQ29tcGxldGU/dGhpcy5fb25Db21wbGV0ZSgpOih3aW5kb3cubG9jYXRpb24ucmVwbGFjZShcIi9vcmRlci1jb25maXJtYXRpb25cIiksUHJvbWlzZS5yZXNvbHZlKCkpfSl9X2dldFBheW1lbnRQYXlsb2FkKGUsdCl7dmFyIGk7Y29uc3Qgbj0obnVsbD09PShpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnQoKSl8fHZvaWQgMD09PWk/dm9pZCAwOmkuaWQpfHxcIlwiO3JldHVybnttZXRob2RJZDplLHBheW1lbnREYXRhOntmb3JtYXR0ZWRQYXlsb2FkOk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7Y2FydF9pZDpufSx0P3tjcmVkaXRfY2FyZF90b2tlbjp7dG9rZW46dH19Ont9KSx7Y29uZmlybTohMSxtZXRob2Q6bC5MaW5rfSl9fX1fc2hvdWxkUmVxdWlyZVNoaXBwaW5nQWRkcmVzcygpe2NvbnN0e2dldENhcnRPclRocm93OmV9PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHtsaW5lSXRlbXM6dH09ZSgpO3JldHVybiEhdC5waHlzaWNhbEl0ZW1zLmxlbmd0aH1fdXBkYXRlRGlzcGxheWVkUHJpY2UoKXtyZXR1cm4gRWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RoaXMuX3N0cmlwZUVsZW1lbnRzJiZ0aGlzLl9zdHJpcGVFbGVtZW50cy51cGRhdGUoe2N1cnJlbmN5OnRoaXMuX2dldEN1cnJlbmN5KCksbW9kZTpcInBheW1lbnRcIixhbW91bnQ6eWllbGQgdGhpcy5fZ2V0VG90YWxQcmljZSgpfSl9KX1fZ2V0Q3VycmVuY3koKXtpZighdGhpcy5fY3VycmVuY3lDb2RlKXtjb25zdHtjb2RlOmV9PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnRPclRocm93KCkuY3VycmVuY3k7dGhpcy5fY3VycmVuY3lDb2RlPWUudG9Mb3dlckNhc2UoKX1yZXR1cm4gdGhpcy5fY3VycmVuY3lDb2RlfV9nZXRUb3RhbFByaWNlKCl7cmV0dXJuIEVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZENoZWNrb3V0KCk7Y29uc3R7Z2V0Q2hlY2tvdXRPclRocm93OmUsZ2V0Q2FydE9yVGhyb3c6dH09dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkse2RlY2ltYWxQbGFjZXM6aX09dCgpLmN1cnJlbmN5LG49cihlKCkub3V0c3RhbmRpbmdCYWxhbmNlLGkpLnRvRml4ZWQoaSk7cmV0dXJuIHRoaXMuX3RvQ2VudHMoK24pfSl9X2dldEF2YWlsYWJsZUNvdW50cmllcygpe3ZhciBlO3JldHVybiBFZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD15aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFNoaXBwaW5nQ291bnRyaWVzKCk7cmV0dXJuKChudWxsPT09KGU9dC5nZXRTaGlwcGluZ0NvdW50cmllcygpKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5tYXAoZT0+ZS5jb2RlKSl8fFtdKS5maWx0ZXIoZT0+VS5pbmNsdWRlcyhlKSl9KX1fZ2V0QXZhaWxhYmxlU2hpcHBpbmdPcHRpb25zKCl7dmFyIGUsdCxpO3JldHVybiBFZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDb25zaWdubWVudHMoKTtpZighKG51bGw9PW4/dm9pZCAwOm5bMF0pKXJldHVybjtjb25zdCByPW5bMF0sbz0oci5hdmFpbGFibGVTaGlwcGluZ09wdGlvbnN8fFtdKS5tYXAodGhpcy5fZ2V0U3RyaXBlU2hpcHBpbmdPcHRpb24uYmluZCh0aGlzKSkscz1udWxsPT09KGU9ci5hdmFpbGFibGVTaGlwcGluZ09wdGlvbnMpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLmZpbmQoZT0+ZS5pc1JlY29tbWVuZGVkKSxhPW51bGw9PT0odD1yLnNlbGVjdGVkU2hpcHBpbmdPcHRpb24pfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmlkLGQ9bnVsbD09cz92b2lkIDA6cy5pZDtyZXR1cm4gYT9vLnNvcnQoZT0+ZS5pZD09PWE/LTE6MCk6ZD8oby5zb3J0KGU9PmUuaWQ9PT1kPy0xOjApLHlpZWxkIHRoaXMuX2hhbmRsZVNoaXBwaW5nT3B0aW9uQ2hhbmdlKGQpKTp5aWVsZCB0aGlzLl9oYW5kbGVTaGlwcGluZ09wdGlvbkNoYW5nZShudWxsPT09KGk9b1swXSl8fHZvaWQgMD09PWk/dm9pZCAwOmkuaWQpLG99KX1fZ2V0U3RyaXBlU2hpcHBpbmdPcHRpb24oe2lkOmUsY29zdDp0LGRlc2NyaXB0aW9uOml9KXtyZXR1cm57aWQ6ZSxkaXNwbGF5TmFtZTppLGFtb3VudDp0aGlzLl90b0NlbnRzKHQpfX1faGFuZGxlU2hpcHBpbmdPcHRpb25DaGFuZ2UoZSl7cmV0dXJuIEVlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZihlJiZcInNoaXBwaW5nX29wdGlvbl91bnNlbGVjdGVkXCIhPT1lKXJldHVybiB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2VsZWN0U2hpcHBpbmdPcHRpb24oZSl9KX1fZ2V0QW1vdW50VHJhbnNmb3JtZXIoKXtpZih0aGlzLl9hbW91bnRUcmFuc2Zvcm1lcilyZXR1cm4gdGhpcy5fYW1vdW50VHJhbnNmb3JtZXI7Y29uc3R7Z2V0Q2FydDplfT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSx7Y3VycmVuY3k6dH09ZSgpfHx7fTtyZXR1cm4gdD9uZXcgeih0LmRlY2ltYWxQbGFjZXMpOnZvaWQgMH1fdG9DZW50cyhlKXtjb25zdCB0PU1hdGgucm91bmQoMTAwKmUpLGk9dGhpcy5fZ2V0QW1vdW50VHJhbnNmb3JtZXIoKTtyZXR1cm4gaT9pLnRvSW50ZWdlcihlKTp0fV90b2dnbGVMb2FkaW5nSW5kaWNhdG9yKGUpe2UmJnRoaXMuX2xvYWRpbmdJbmRpY2F0b3JDb250YWluZXI/dGhpcy5sb2FkaW5nSW5kaWNhdG9yLnNob3codGhpcy5fbG9hZGluZ0luZGljYXRvckNvbnRhaW5lcik6dGhpcy5sb2FkaW5nSW5kaWNhdG9yLmhpZGUoKX19Y29uc3QgUGU9dih0PT57Y29uc3QgaT1uZXcgSShlKCkpLG49bmV3IFIoe2NvbnRhaW5lclN0eWxlczpUfSk7cmV0dXJuIG5ldyBJZSh0LGksbmV3IE0odCxpKSxuKX0sW3tpZDpcInN0cmlwZW9jc1wifV0pO2V4cG9ydHtqIGFzIGNyZWF0ZUxpbmtWMkJ1dHRvblN0cmF0ZWd5LF9lIGFzIGNyZWF0ZVN0cmlwZUNTUGF5bWVudFN0cmF0ZWd5LFBlIGFzIGNyZWF0ZVN0cmlwZUxpbmtWMkN1c3RvbWVyU3RyYXRlZ3ksZ2UgYXMgY3JlYXRlU3RyaXBlT0NTUGF5bWVudFN0cmF0ZWd5LENlIGFzIGNyZWF0ZVN0cmlwZVVQRUN1c3RvbWVyU3RyYXRlZ3ksaGUgYXMgY3JlYXRlU3RyaXBlVVBFUGF5bWVudFN0cmF0ZWd5LGllIGFzIGNyZWF0ZVN0cmlwZVYzUGF5bWVudFN0cmF0ZWd5fTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXN0cmlwZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///../checkout-sdk-js/dist/esm/integrations/stripe.js\n\n}");

/***/ })

}]);