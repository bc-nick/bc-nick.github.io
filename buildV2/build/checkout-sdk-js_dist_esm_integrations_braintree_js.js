"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonpCheckout"] = self["webpackJsonpCheckout"] || []).push([["checkout-sdk-js_dist_esm_integrations_braintree_js"],{

/***/ "../checkout-sdk-js/dist/esm/integrations/braintree.js":
/*!*************************************************************!*\
  !*** ../checkout-sdk-js/dist/esm/integrations/braintree.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createBraintreeAchPaymentStrategy: () => (/* binding */ K),\n/* harmony export */   createBraintreeCreditCardPaymentStrategy: () => (/* binding */ tt),\n/* harmony export */   createBraintreeFastlaneCustomerStrategy: () => (/* binding */ ct),\n/* harmony export */   createBraintreeFastlanePaymentStrategy: () => (/* binding */ Ue),\n/* harmony export */   createBraintreeLocalMethodsPaymentStrategy: () => (/* binding */ Ne),\n/* harmony export */   createBraintreePaypalButtonStrategy: () => (/* binding */ wt),\n/* harmony export */   createBraintreePaypalCreditButtonStrategy: () => (/* binding */ Pt),\n/* harmony export */   createBraintreePaypalCreditCustomerStrategy: () => (/* binding */ st),\n/* harmony export */   createBraintreePaypalCustomerStrategy: () => (/* binding */ rt),\n/* harmony export */   createBraintreePaypalPaymentStrategy: () => (/* binding */ we),\n/* harmony export */   createBraintreeVenmoButtonStrategy: () => (/* binding */ Dt),\n/* harmony export */   createBraintreeVenmoPaymentStrategy: () => (/* binding */ Ge),\n/* harmony export */   createBraintreeVisaCheckoutButtonStrategy: () => (/* binding */ kt),\n/* harmony export */   createBraintreeVisaCheckoutCustomerStrategy: () => (/* binding */ mt),\n/* harmony export */   createBraintreeVisaCheckoutPaymentStrategy: () => (/* binding */ We)\n/* harmony export */ });\n/* harmony import */ var _bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @bigcommerce/script-loader */ \"../checkout-sdk-js/node_modules/@bigcommerce/script-loader/lib/index.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! lodash */ \"../checkout-sdk-js/node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _braintree_browser_detection__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @braintree/browser-detection */ \"../checkout-sdk-js/node_modules/@braintree/browser-detection/dist/browser-detection.js\");\n/* harmony import */ var _bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @bigcommerce/request-sender */ \"../checkout-sdk-js/node_modules/@bigcommerce/request-sender/esm/index.js\");\n/* harmony import */ var _bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @bigcommerce/form-poster */ \"../checkout-sdk-js/node_modules/@bigcommerce/form-poster/lib/index.js\");\nvar h,y,m;class p extends Error{constructor(e){var t;super(e||\"An unexpected error has occurred.\"),this.name=\"StandardError\",this.type=\"standard\",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,\"function\"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class g extends p{constructor(e){super(e||\"Unable to proceed because the client library of a payment method is not loaded or ready to be used.\"),this.name=\"PaymentMethodClientUnavailableError\",this.type=\"payment_method_client_unavailable\"}}!function(e){e.Sandbox=\"sandbox\",e.Production=\"production\"}(h||(h={})),function(e){e.Client=\"client\",e.DataCollector=\"dataCollector\",e.Fastlane=\"fastlane\",e.GooglePayment=\"googlePayment\",e.HostedFields=\"hostedFields\",e.LocalPayment=\"localPayment\",e.Paypal=\"paypal\",e.PaypalCheckout=\"paypalCheckout\",e.ThreeDSecure=\"threeDSecure\",e.UsBankAccount=\"usBankAccount\",e.Venmo=\"venmo\",e.VisaCheckout=\"visaCheckout\"}(y||(y={})),function(e){e.CardCode=\"cardCode\",e.CardCodeVerification=\"cardCodeVerification\",e.CardExpiry=\"cardExpiry\",e.CardName=\"cardName\",e.CardNumber=\"cardNumber\",e.CardNumberVerification=\"cardNumberVerification\"}(m||(m={}));const v=\"3.128.0\",f=\"3.123.2\",b=\"3.106.0\",w={[b]:{[y.Client]:\"sha384-26BXDNnJI23JYRyFBj4xe4sVNrUSSiSSu11kxVXNM/vEPONm4LuL00w6ZaTgQewt\",[y.PaypalCheckout]:\"sha384-B+vzbZwnQtzWBthpkT4TXKUibO65tyeK7eCxSvpblgprTep2+IAXB2Cxxjrn710O\",[y.Paypal]:\"sha384-uyAGL1/3+XJAHnGoNy4eCoXdzJ4f7Ilzp+6w9PNnEjs6DCCz9WMyJjMN1gzc78U+\",[y.LocalPayment]:\"sha384-LIvOEMkIVEwVuYBdVOQc1AC5YbGGlwyfUheS0ACK218D2STuVYQlZ4FyEPowAEfT\",[y.DataCollector]:\"sha384-1bo9JDz+Kscthc085cCKWur8CLwUoBpoNyxsDi7932mCl0zFq3A5mv+FQLw9GHpV\",[y.UsBankAccount]:\"sha384-xmHBVaU+w74V+OebD3AaPONFxHUGMf+QRs8G/JxVPXNNP7MDa2jL0ICWHIe2tTfJ\",[y.GooglePayment]:\"sha384-WKDJl8mqoP82qZpMGH6AbZxnvXnSW8ILV4M64CyMLiugGMwu7LyP89wjCkHqsiBe\",[y.ThreeDSecure]:\"sha384-VQUlpGHzsGvs5XeiGFip7EXRsvoHWEXDVmgCacfbyieZI9mdBOqq3NSoyo28OCOB\",[y.VisaCheckout]:\"sha384-yx7mADfzTN0T43Q6rlH49LIg1EJ0iUZgBp/EczX9LXsUGkySgxrD+nWHQRBkyfoT\",[y.Venmo]:\"sha384-QX4rPjoj1ZDhuG0aSyKs56lEKDqTMTcjYxUHY1SzO5VZDsqIE2NTkqot7KNSCyov\",[y.HostedFields]:\"sha384-VvYBACfSu0Cr/J32uKmxG7AXcNOJE1AzIIL3kbikyS7YKp5fz5Is+NzNP/lyauNy\",[y.Fastlane]:\"sha384-9oGsZMRZwpGtDEDYa/dFt76dECqj1xAni9gIKgc3KfMIiRnR73nEeeUDLiBzxhFa\"},[f]:{[y.Client]:\"sha384-o+nbQGcwNNxIBeXeu3+XmbSq+Cg8R3EN3N0l5hXCgMMU2RGY0t1z0LroSEIAbfAO\",[y.PaypalCheckout]:\"sha384-WrfbWPBS4mH86GAoycPSgiH8hQ8KH7A67C93Hjhunv/xhNk2YpBn3wbFA4Fhg9U/\",[y.Paypal]:\"sha384-VF389nvvrRUgDsTXMxTYORDtVegB9IQa3Cxr//DyJnLYnz8/X8VCzEvck2c+Megt\",[y.LocalPayment]:\"sha384-tZKx2rEQbfmZpoPSY5VPmJEhaq4X75dLvwHMs3VE9U+C8lPyw+hWTIL1+GPvWCIH\",[y.DataCollector]:\"sha384-E6k3wOpP7syCDDwaRDLF06942Y00NkbwJvWi2OQXwwKzGwG5fd3E7RFUvCCecfvO\",[y.UsBankAccount]:\"sha384-258FON8LZGG0W9Qaz4Jij83pZHu30YnKjJA7gNulLBh6CclkucgF+tHDQuYFRYfW\",[y.GooglePayment]:\"sha384-taJ2p/0+n0VH328POAoBiuEbL3tnHUTE9S42hK1V+Txs3X+QYjZOyKW35JgHRFfO\",[y.ThreeDSecure]:\"sha384-+NSZH4Zj3sO5bdWvPKhU5N16QDxeueTVTnUVeleeESkhLSaz4Ob1hh/5myecc9Ym\",[y.VisaCheckout]:\"sha384-66DiBjghxk1OmBj8aksN8gbQ+CwoQcx1vPfiXUN08g1iQVM+BwewF0p7toM3i7SS\",[y.Venmo]:\"sha384-B5UwY42kE4RoLoWbQ7YpqosUlUad2/DlGWiw0HhoZbSPk30CQAaSA10ohyLDTkDU\",[y.HostedFields]:\"sha384-Aw9EesSaUeWxe36PqEHiOyOyOq8M6CIb1gw7/yHNVPRzGtFXXcd2OQ8qXrIlOj2P\",[y.Fastlane]:\"sha384-rhBL1hpZ71JqG+2TsT0Dih47mbjx8cjJCpeZjk9tw3df1gFMKfCTmMyZunhr7H4Y\"},[v]:{[y.Client]:\"sha384-0WNxksIpRP+fYZiIdr12g6DBUQfLDzYCQJZtR/C8KkcwSGhPHfcFp3tTaGcMyFTq\",[y.PaypalCheckout]:\"sha384-lWM1jk4BOxoDNV6Kop7tVNvQgINlmEVz0c/OwM+HNHK3QC8xqwd54Ovrt2QRDTjh\",[y.Paypal]:\"sha384-fXUmVxC2EMZBDXZ7eTHSTL/LFBrHej/MSXT/vTBXvra4lzgLNGvREAp+x0GYObuH\",[y.LocalPayment]:\"sha384-pha1xGuGSkmZH5x9aqHvRaO4xLea7rmQ/79PFj9zxNzxuFcOWZg7gOP7FibygOEC\",[y.DataCollector]:\"sha384-Q6PI2F9eekWbAxhroybl+aEcvqhdowN/EQlGwBUyJOzPFn9982u9xl6SU6XfGKzc\",[y.UsBankAccount]:\"sha384-W3RLQSKJL1tQ3+Y7mP6tmkamtZ8bV4Yw/XxL9Jj5JtXHraD8loMF8hAIG5m2zK7F\",[y.GooglePayment]:\"sha384-TITQMsFWA3elDNGP2mWz2oKBo4qjt+TlqzovcaPoeBiAh/wPBi6nae50ADdgU1/i\",[y.ThreeDSecure]:\"sha384-YiycYN89ZlL/Evcaq4y1ajW1mhd7JYfZBDuOwHtIn4/Jnm20GL+/XCM+zYAwWD8D\",[y.VisaCheckout]:\"sha384-/OdaTv9qrkKzjObtUe6yzfDhHozFW/+uXlrSl736sOZRJpjGQETvpYXqMFFg69xv\",[y.Venmo]:\"sha384-dA+ojdW9vbJS4JavcXyOs9d5uZHJg5dNtYupoPSH2zsXIiYDVS5amLb/u8qmQ6oz\",[y.HostedFields]:\"sha384-31ZkS58+iaWsW06ftW52zzVZFp43WPd7pNYRiddYynSNg6Oh7WGbSFGorAUH6T1z\",[y.Fastlane]:\"sha384-jlbrwNvL3HvLAUCtLSmrnQ2GH1udCUrRS/bVmReAS5fuIVvcW8Pko/Gkg82tlgtr\"}};var C,S,P,I,O,k,E,T,A=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class z{constructor(e,t,i){this.scriptLoader=e,this.braintreeHostWindow=t,this.braintreeSDKVersionManager=i}loadClient(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.Client,\"client.min.js\")})}loadFastlane(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.Fastlane,\"fastlane.min.js\")})}loadPaypalCheckout(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.PaypalCheckout,\"paypal-checkout.min.js\")})}loadPaypal(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.Paypal,\"paypal.min.js\")})}loadLocalPayment(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.LocalPayment,\"local-payment.min.js\")})}loadDataCollector(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.DataCollector,\"data-collector.min.js\")})}loadUsBankAccount(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.UsBankAccount,\"us-bank-account.min.js\")})}loadGooglePayment(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.GooglePayment,\"google-payment.min.js\")})}load3DS(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.ThreeDSecure,\"three-d-secure.min.js\")})}loadVisaCheckout(){return this.loadBraintreeModuleOrThrow(y.VisaCheckout,\"visa-checkout.min.js\")}loadVenmoCheckout(){return this.loadBraintreeModuleOrThrow(y.Venmo,\"venmo.min.js\")}loadHostedFields(){return A(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(y.HostedFields,\"hosted-fields.min.js\")})}loadVisaCheckoutSdk(e){return A(this,void 0,void 0,function*(){if(this.braintreeHostWindow.V)return this.braintreeHostWindow.V;const t=e?\"sha384-0eu1s1GtqzXlL9DtLgmwzC5WWlEH/ADRM0n38cVQkvtT+W/gey96rcb1LwuUOPDm\":\"sha384-1f1csvP3ZFxg4dILH1GaY4LHlZ0oX7Rk83rxmLlwbnIi4TM0NYzXoev1VoEiVDS6\";return this.scriptLoader.loadScript(`//${e?\"sandbox-\":\"\"}assets.secure.checkout.visa.com/checkout-widget/resources/js/integration/v1/sdk.js`,{async:!0,attributes:{integrity:t,crossorigin:\"anonymous\"}}).then(()=>{if(!this.braintreeHostWindow.V)throw new g;return this.braintreeHostWindow.V})})}loadBraintreeModuleOrThrow(e,t){return A(this,void 0,void 0,function*(){let i=this.getBraintreeModule(e);if(i)return i;const n=this.braintreeSDKVersionManager.getSDKVersion(),r=`//js.braintreegateway.com/web/${n}/js/${t}`,o=n in w?this.getIntegrityValuesByModuleName(e,n):void 0;if(yield this.scriptLoader.loadScript(r,o?{async:!0,attributes:{integrity:o,crossorigin:\"anonymous\"}}:void 0),i=this.getBraintreeModule(e),!i)throw new g;return i})}getBraintreeModule(e){var t;return null===(t=this.braintreeHostWindow.braintree)||void 0===t?void 0:t[e]}getIntegrityValuesByModuleName(e,t){const i=w[t][e];if(!i)throw new Error(\"Unexpected fileName value\");return i}}class N extends p{constructor(e){super(e||\"Unsupported browser error\"),this.name=\"UnsupportedBrowserError\",this.type=\"unsupported_browser\"}}!function(e){e[e.CheckoutButtonNotInitialized=0]=\"CheckoutButtonNotInitialized\",e[e.CustomerNotInitialized=1]=\"CustomerNotInitialized\",e[e.PaymentNotInitialized=2]=\"PaymentNotInitialized\",e[e.ShippingNotInitialized=3]=\"ShippingNotInitialized\",e[e.SpamProtectionNotInitialized=4]=\"SpamProtectionNotInitialized\"}(C||(C={}));class D extends p{constructor(e){super(function(e){switch(e){case C.CustomerNotInitialized:return\"Unable to proceed because the customer step of checkout has not been initialized.\";case C.PaymentNotInitialized:return\"Unable to proceed because the payment step of checkout has not been initialized.\";case C.ShippingNotInitialized:return\"Unable to proceed because the shipping step of checkout has not been initialized.\";case C.SpamProtectionNotInitialized:return\"Unable to proceed because the checkout spam protection has not been initialized.\";default:return\"Unable to proceed because the required component has not been initialized.\"}}(e)),this.subtype=e,this.name=\"NotInitializedError\",this.type=\"not_initialized\"}}function M(e){return Boolean(\"object\"==typeof e&&null!==e&&(\"type\"in e||\"message\"in e||\"code\"in e))}!function(e){e.ESTIMATED=\"ESTIMATED\",e.FINAL=\"FINAL\",e.NOT_CURRENTLY_KNOWN=\"NOT_CURRENTLY_KNOWN\"}(S||(S={})),function(e){e.Completed=\"COMPLETED\",e.Pending=\"PENDING\",e.Failed=\"FAILED\"}(P||(P={})),function(e){e.TRUSTLY=\"trustly\"}(I||(I={})),function(e){e.SUCCEEDED=\"succeeded\",e.FAILED=\"failed\",e.CANCELED=\"cancelled\",e.UNRECOGNIZED=\"unrecognized\"}(O||(O={})),function(e){e.Customer=\"CUSTOMER\",e.Merchant=\"MERCHANT\",e.Network=\"NETWORK\",e.Internal=\"INTERNAL\",e.Unknown=\"UNKNOWN\"}(k||(k={})),function(e){e.KountNotEnabled=\"DATA_COLLECTOR_KOUNT_NOT_ENABLED\"}(E||(E={})),function(e){e.Visa=\"visa\",e.Mastercard=\"mastercard\",e.AmericanExpress=\"american-express\",e.DinersClub=\"diners-club\",e.Discover=\"discover\",e.Jcb=\"jcb\",e.UnionPay=\"union-pay\",e.Maestro=\"maestro\",e.Elo=\"elo\",e.Mir=\"mir\",e.Hiper=\"hiper\",e.Hipercard=\"hipercard\"}(T||(T={}));var _=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class B{constructor(e){this.braintreeScriptLoader=e}initialize(e){this.setClientToken(e)}deinitialize(){return _(this,void 0,void 0,function*(){yield this.teardownModule(this.dataCollector),this.dataCollector=void 0})}getClient(){return _(this,void 0,void 0,function*(){if(!this.client){const e=this.getClientTokenOrThrow(),t=yield this.braintreeScriptLoader.loadClient();this.client=yield t.create({authorization:e})}return this.client})}getDataCollectorOrThrow(e){return _(this,void 0,void 0,function*(){const t={deviceData:void 0,teardown:()=>Promise.resolve()};if(!this.dataCollector)try{const t=yield this.getClient(),i=yield this.braintreeScriptLoader.loadDataCollector(),n=Object.assign({client:t,kount:!0},e);this.dataCollector=yield i.create(n)}catch(e){if(M(e)&&e.code===E.KountNotEnabled)return t;throw e}return this.dataCollector})}getBraintreeGooglePayment(){return _(this,void 0,void 0,function*(){if(!this.googlePayment){const[e,t]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.loadGooglePayment()]);this.googlePayment=yield t.create({client:e})}return this.googlePayment})}getBraintreeThreeDS(){return _(this,void 0,void 0,function*(){if(!this.threeDS){const[e,t]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.load3DS()]);this.threeDS=yield t.create({client:e,version:2})}return this.threeDS})}getBraintreeLocalPayment(e){return _(this,void 0,void 0,function*(){if(!this.braintreeLocalPayment){const[t,i]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.loadLocalPayment()]);this.braintreeLocalPayment=yield new Promise((n,r)=>{i.create({client:t,merchantAccountId:e},(e,t)=>{e&&r(e),n(t)})})}return this.braintreeLocalPayment})}getUsBankAccount(){return _(this,void 0,void 0,function*(){if(!this.usBankAccount){const e=yield this.getClient(),t=yield this.braintreeScriptLoader.loadUsBankAccount();this.usBankAccount=yield t.create({client:e})}return this.usBankAccount})}getBraintreeVisaCheckout(){return this.visaCheckout||(this.visaCheckout=Promise.all([this.getClient(),this.braintreeScriptLoader.loadVisaCheckout()]).then(([e,t])=>t.create({client:e}))),this.visaCheckout}getVisaCheckoutSdk(e){return _(this,void 0,void 0,function*(){return this.visaCheckoutSDK||(this.visaCheckoutSDK=yield this.braintreeScriptLoader.loadVisaCheckoutSdk(e)),this.visaCheckoutSDK})}getVenmoCheckoutOrThrow(){return _(this,void 0,void 0,function*(){if(!this.braintreeVenmo){const e=yield this.getClient(),t=yield this.braintreeScriptLoader.loadVenmoCheckout(),i={client:e,allowDesktop:!0,paymentMethodUsage:\"multi_use\"},n=yield t.create(i);if(!n.isBrowserSupported())throw new N;this.braintreeVenmo=n}return this.braintreeVenmo})}setClientToken(e){this.clientToken=e}getClientTokenOrThrow(){if(!this.clientToken)throw new D(C.PaymentNotInitialized);return this.clientToken}teardownModule(e){return e?e.teardown():Promise.resolve()}}function x(e,t,i=!0){var n;return null!==(n=e[t])&&void 0!==n?n:i}class F{constructor(e){this.paymentIntegrationService=e,this.braintreeWindow=window}getSDKVersion(){const e=this.paymentIntegrationService.getState().getStoreConfig(),t=(null==e?void 0:e.checkoutSettings.features)||{};return this.getPreloadedSDKVersion()||(x(t,\"PAYPAL-5809.braintree_hosted_fields_fix_version\")?v:x(t,\"PAYPAL-5636.update_braintree_sdk_version\")?f:b)}getPreloadedSDKVersion(){const e=this.braintreeWindow.braintree;if(e){const i=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.find)(Object.values(e),e=>!!e.VERSION);return null==i?void 0:i.VERSION}}}function L(e,t){return Object.assign(e,{resolveIds:t})}class V extends p{constructor(e){super(e||\"Invalid arguments have been provided.\"),this.name=\"InvalidArgumentError\",this.type=\"invalid_argument\"}}var j;!function(e){e[e.MissingBillingAddress=0]=\"MissingBillingAddress\",e[e.MissingCart=1]=\"MissingCart\",e[e.MissingCheckout=2]=\"MissingCheckout\",e[e.MissingConsignments=3]=\"MissingConsignments\",e[e.MissingCustomer=4]=\"MissingCustomer\",e[e.MissingCheckoutConfig=5]=\"MissingCheckoutConfig\",e[e.MissingOrder=6]=\"MissingOrder\",e[e.MissingOrderConfig=7]=\"MissingOrderConfig\",e[e.MissingOrderId=8]=\"MissingOrderId\",e[e.MissingPayment=9]=\"MissingPayment\",e[e.MissingPaymentId=10]=\"MissingPaymentId\",e[e.MissingPaymentInstrument=11]=\"MissingPaymentInstrument\",e[e.MissingPaymentMethod=12]=\"MissingPaymentMethod\",e[e.MissingPaymentRedirectUrl=13]=\"MissingPaymentRedirectUrl\",e[e.MissingPaymentStatus=14]=\"MissingPaymentStatus\",e[e.MissingPaymentToken=15]=\"MissingPaymentToken\",e[e.MissingShippingAddress=16]=\"MissingShippingAddress\"}(j||(j={}));class U extends p{constructor(e){super(function(e){switch(e){case j.MissingBillingAddress:return\"Unable to proceed because billing address data is unavailable.\";case j.MissingCart:return\"Unable to proceed because cart data is unavailable.\";case j.MissingConsignments:return\"Unable to proceed because consignments data is unavailable.\";case j.MissingCheckout:return\"Unable to proceed because checkout data is unavailable.\";case j.MissingCustomer:return\"Unable to proceed because customer data is unavailable.\";case j.MissingCheckoutConfig:case j.MissingOrderConfig:return\"Unable to proceed because configuration data is unavailable.\";case j.MissingOrder:return\"Unable to proceed because order data is unavailable.\";case j.MissingOrderId:return\"Unable to proceed because order ID is unavailable or not generated yet.\";case j.MissingPayment:return\"Unable to proceed because payment data is unavailable.\";case j.MissingPaymentToken:return\"Unable to proceed because the token required to submit a payment is missing.\";case j.MissingPaymentMethod:return\"Unable to proceed because payment method data is unavailable or not properly configured.\";case j.MissingShippingAddress:return\"Unable to proceed because shipping address data is unavailable.\";default:return\"Unable to proceed because the required data is unavailable.\"}}(e)),this.subtype=e,this.name=\"MissingDataError\",this.type=\"missing_data\"}}class R extends V{constructor(e){let t=\"Unable to submit payment for the order because the payload is invalid.\";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(\", \")}.`),super(t),this.name=\"PaymentArgumentInvalidError\"}}function H(e){return Boolean(e.instrumentId)}class W extends p{constructor(){super(\"The current order does not need to be finalized at this stage.\"),this.name=\"OrderFinalizationNotRequiredError\",this.type=\"order_finalization_not_required\"}}function q(e){return!(\"object\"!=typeof e||null===e||void 0!==e.shouldSaveInstrument&&\"boolean\"!=typeof e.shouldSaveInstrument||void 0!==e.shouldSetAsDefaultInstrument&&\"boolean\"!=typeof e.shouldSetAsDefaultInstrument)}class $ extends p{constructor(e){super(e||\"Unable to proceed because the client library of a payment method has thrown an unexpected error.\"),this.name=\"PaymentMethodFailedError\",this.type=\"payment_method_client_invalid\"}}function G(e){return!!e&&\"accountNumber\"in e&&\"routingNumber\"in e&&\"ownershipType\"in e&&\"accountType\"in e}var Y=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class J{constructor(e,t){this.paymentIntegrationService=e,this.braintreeSdk=t}initialize(e){return Y(this,void 0,void 0,function*(){const{methodId:t,braintreeach:i}=e||{};if(!t)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');this.getMandateText=null==i?void 0:i.getMandateText,yield this.paymentIntegrationService.loadPaymentMethod(t);const n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t),{clientToken:r,initializationData:o}=n;if(!r||!o)throw new U(j.MissingPaymentMethod);this.braintreeSdk.initialize(r);try{this.usBankAccount=yield this.braintreeSdk.getUsBankAccount()}catch(e){this.handleBraintreeError(e)}})}execute(e,t){return Y(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!i)throw new R([\"payment\"]);const r=H(i.paymentData||{}),o=r?yield this.tokenizePaymentForVaultedInstrument(i):yield this.tokenizePayment(i),a=r?yield this.preparePaymentDataForVaultedInstrument(o,i):yield this.preparePaymentData(o,i);yield this.paymentIntegrationService.submitOrder(n,t),yield this.paymentIntegrationService.submitPayment(a)})}finalize(){return Promise.reject(new W)}deinitialize(){return Y(this,void 0,void 0,function*(){return yield this.braintreeSdk.deinitialize(),Promise.resolve()})}tokenizePayment({paymentData:e}){return Y(this,void 0,void 0,function*(){const t=this.getUsBankAccountOrThrow();if(!G(e))throw new R([\"payment.paymentData\"]);const i=H(e)?\"The data are used for stored instrument verification\":\"function\"==typeof this.getMandateText&&this.getMandateText();if(!i)throw new V(\"Unable to proceed because getMandateText is not provided or returned undefined value.\");try{const{nonce:n}=yield t.tokenize({bankDetails:this.getBankDetails(e),mandateText:i});return n}catch(e){this.handleBraintreeError(e)}})}tokenizePaymentForVaultedInstrument(e){return Y(this,void 0,void 0,function*(){const{methodId:t,paymentData:i={}}=e,n=this.paymentIntegrationService.getState(),{config:r}=n.getPaymentMethodOrThrow(t);if(!r.isVaultingEnabled)throw new V(\"Vaulting is disabled but a vaulted instrument was being used for this transaction\");return G(i)?this.tokenizePayment(e):null})}preparePaymentData(e,t){return Y(this,void 0,void 0,function*(){const{methodId:i,paymentData:n={}}=t;if(!G(n))throw new R([\"payment.paymentData\"]);const{deviceData:r}=yield this.braintreeSdk.getDataCollectorOrThrow(),{shouldSaveInstrument:o,shouldSetAsDefaultInstrument:a,routingNumber:s,accountNumber:d}=n;return{methodId:i,paymentData:{deviceSessionId:r,shouldSetAsDefaultInstrument:a,shouldSaveInstrument:o,formattedPayload:{tokenized_bank_account:{issuer:s,masked_account_number:d.substr(-4),token:e}}}}})}preparePaymentDataForVaultedInstrument(e,t){return Y(this,void 0,void 0,function*(){const{methodId:i,paymentData:n={}}=t;if(!H(n)||!q(n))throw new R([\"payment.paymentData\"]);const{deviceData:r}=yield this.braintreeSdk.getDataCollectorOrThrow(),{instrumentId:o,shouldSetAsDefaultInstrument:a}=n;return{methodId:i,paymentData:Object.assign({deviceSessionId:r,instrumentId:o,shouldSetAsDefaultInstrument:a},e&&{nonce:e})}})}getBankDetails(e){const t=this.paymentIntegrationService.getState().getBillingAddressOrThrow(),i=e.ownershipType.toLowerCase(),n=e.accountType.toLowerCase();return Object.assign(Object.assign({accountNumber:e.accountNumber,routingNumber:e.routingNumber,ownershipType:i},\"personal\"===i?{firstName:e.firstName,lastName:e.lastName}:{businessName:e.businessName}),{accountType:n,billingAddress:{streetAddress:t.address1,extendedAddress:t.address2,locality:t.city,region:t.stateOrProvinceCode,postalCode:t.postalCode}})}getUsBankAccountOrThrow(){if(!this.usBankAccount)throw new D(C.PaymentNotInitialized);return this.usBankAccount}handleBraintreeError(e){if(!M(e))throw e;throw new $(e.message)}}const K=L(t=>new J(t,(t=>{const i=new F(t),n=new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),window,i);return new B(n)})(t)),[{id:\"braintreeach\"}]);class X extends p{constructor(e,t){super(t||\"Unable to proceed because the payment form contains invalid data.\"),this.details=e,this.name=\"PaymentInvalidFormError\",this.type=\"payment_invalid_form\"}}class Q extends p{constructor(e){super(e||\"Payment process was cancelled.\"),this.name=\"PaymentMethodCancelledError\",this.type=\"payment_cancelled\"}}class Z{constructor(e){const t=new Promise((e,t)=>{this.cancel=t});this.promise=Promise.race([e,t])}}let ee=null;const te=[\"buttons\",\"messages\"];var ie,ne,re,oe,ae,se;!function(e){e.HORIZONTAL=\"horizontal\",e.VERTICAL=\"vertical\"}(ie||(ie={})),function(e){e.SMALL=\"small\",e.MEDIUM=\"medium\",e.LARGE=\"large\",e.RESPONSIVE=\"responsive\"}(ne||(ne={})),function(e){e.GOLD=\"gold\",e.BLUE=\"blue\",e.SIlVER=\"silver\",e.BLACK=\"black\",e.WHITE=\"white\"}(re||(re={})),function(e){e.CHECKOUT=\"checkout\",e.PAY=\"pay\",e.BUYNOW=\"buynow\",e.PAYPAL=\"paypal\",e.CREDIT=\"credit\"}(oe||(oe={})),function(e){e.PILL=\"pill\",e.RECT=\"rect\"}(ae||(ae={})),function(e){e.CART=\"cart\",e.HOME=\"homepage\",e.PAYMENT=\"payment\",e.PRODUCT=\"product\"}(se||(se={}));var de=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class le{constructor(e,t,i){this.braintreeScriptLoader=e,this.braintreeHostWindow=t,this.overlay=i,this.dataCollectors={}}initialize(e,t){this.clientToken=e,this.threeDSecureOptions=t}getBraintreeFastlane(e,t,i){return de(this,void 0,void 0,function*(){if(t&&(window.localStorage.setItem(\"axoEnv\",\"sandbox\"),window.localStorage.setItem(\"fastlaneEnv\",\"sandbox\")),!this.braintreeHostWindow.braintreeFastlane){const t=this.getClientTokenOrThrow(),n=yield this.getClient(),r=yield this.getSessionId(e),o=yield this.braintreeScriptLoader.loadFastlane(),a={root:{backgroundColorPrimary:\"transparent\"}};this.braintreeHostWindow.braintreeFastlane=yield o.create({authorization:t,client:n,deviceData:r,styles:i||a})}return this.braintreeHostWindow.braintreeFastlane})}getClient(){return de(this,void 0,void 0,function*(){if(!this.client){const e=this.getClientTokenOrThrow(),t=yield this.braintreeScriptLoader.loadClient();this.client=t.create({authorization:e})}return this.client})}getPaypal(){return this.braintreePaypal||(this.braintreePaypal=Promise.all([this.getClient(),this.braintreeScriptLoader.loadPaypal()]).then(([e,t])=>t.create({client:e}))),this.braintreePaypal}paypal(e){var{shouldSaveInstrument:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"shouldSaveInstrument\"]);const n=(0,_braintree_browser_detection__WEBPACK_IMPORTED_MODULE_2__.supportsPopups)();return this.getPaypal().then(e=>{var r;return n&&(null===(r=this.overlay)||void 0===r||r.show({onClick:()=>e.focusWindow()})),e.tokenize(Object.assign({enableShippingAddress:!0,flow:t?\"vault\":\"checkout\",useraction:\"commit\"},i))}).then(e=>{var t;return null===(t=this.overlay)||void 0===t||t.remove(),e}).catch(e=>{var t;throw null===(t=this.overlay)||void 0===t||t.remove(),e})}getPaypalCheckout(e,t,i){return de(this,void 0,void 0,function*(){const n=yield this.getClient(),r=yield this.braintreeScriptLoader.loadPaypalCheckout(),o={client:n};return this.paypalCheckout=yield r.create(o,(n,r)=>{var o;if(n)return i(n);const a=Object.assign(Object.assign({currency:e.currency},e.isCreditEnabled&&{\"enable-funding\":\"paylater\"}),{components:te.toString(),intent:e.intent,commit:null===(o=e.commit)||void 0===o||o});this.braintreeHostWindow.paypal?t(r):function(e,t){return ee||(ee=new Promise((i,n)=>{e.loadPayPalSDK(t,t=>{t?(ee=null,n(t)):i(e)})})),ee}(r,a).then(()=>t(r))}),this.paypalCheckout})}getDataCollector(e){return de(this,void 0,void 0,function*(){const t=(null==e?void 0:e.paypal)?\"paypal\":\"default\";let i=this.dataCollectors[t];if(!i){try{const t=yield this.getClient(),n=yield this.braintreeScriptLoader.loadDataCollector(),r=Object.assign({client:t,kount:!0},e);i=yield n.create(r)}catch(e){if(!M(e)||\"DATA_COLLECTOR_KOUNT_NOT_ENABLED\"!==e.code)throw e;i={deviceData:void 0,teardown:()=>Promise.resolve()}}this.dataCollectors[t]=i}return i})}getBraintreeEnv(e=!1){return e?h.Sandbox:h.Production}mapToBraintreeShippingAddressOverride(e){return{recipientName:`${e.firstName} ${e.lastName}`,line1:e.address1,line2:e.address2,city:e.city,state:e.stateOrProvinceCode,postalCode:e.postalCode,countryCode:e.countryCode,phone:e.phone}}mapToLegacyShippingAddress(e){const{email:t,phone:i,shippingAddress:n}=e,r=(null==n?void 0:n.recipientName)||\"\",[o,a]=r.split(\" \");return{email:t,first_name:o||\"\",last_name:a||\"\",phone_number:i,address_line_1:null==n?void 0:n.line1,address_line_2:null==n?void 0:n.line2,city:null==n?void 0:n.city,state:null==n?void 0:n.state,country_code:null==n?void 0:n.countryCode,postal_code:null==n?void 0:n.postalCode}}mapToLegacyBillingAddress(e){const{billingAddress:t,email:i,firstName:n,lastName:r,phone:o,shippingAddress:a}=e,s=t||a;return{email:i,first_name:n,last_name:r,phone_number:o,address_line_1:null==s?void 0:s.line1,address_line_2:null==s?void 0:s.line2,city:null==s?void 0:s.city,state:null==s?void 0:s.state,country_code:null==s?void 0:s.countryCode,postal_code:null==s?void 0:s.postalCode}}removeElement(e){const t=e&&document.getElementById(e);t&&t.remove()}getSessionId(e){return de(this,void 0,void 0,function*(){const{deviceData:t}=yield this.getDataCollector({riskCorrelationId:e});return t})}teardown(){return de(this,void 0,void 0,function*(){yield this.teardownModule(this.dataCollectors.default),yield this.teardownModule(this.dataCollectors.paypal),this.dataCollectors={},yield this.teardownModule(this.paypalCheckout),this.paypalCheckout=void 0})}get3DS(){return de(this,void 0,void 0,function*(){return this.threeDS||(this.threeDS=Promise.all([this.getClient(),this.braintreeScriptLoader.load3DS()]).then(([e,t])=>t.create({client:e,version:2}))),this.threeDS})}getVenmoCheckout(e){return de(this,void 0,void 0,function*(){if(!this.venmoCheckout){const t=yield this.getClient(),i=yield this.braintreeScriptLoader.loadVenmoCheckout(),n=Object.assign({client:t,allowDesktop:!0,paymentMethodUsage:\"multi_use\"},e||{});this.venmoCheckout=yield new Promise((e,t)=>{i.create(n,(i,n)=>i?t(i):n.isBrowserSupported()?void e(n):t(new N))})}return this.venmoCheckout})}verifyCard(e,t,i){return de(this,void 0,void 0,function*(){const n=yield this.tokenizeCard(e,t);return this.challenge3DSVerification(n,i)})}tokenizeCard(e,t){return de(this,void 0,void 0,function*(){const{paymentData:n}=e;if(!function(e){if(\"object\"!=typeof e||null===e)return!1;const t=e;return\"object\"==typeof t.ccExpiry&&null!==t.ccExpiry&&\"string\"==typeof t.ccNumber&&\"string\"==typeof t.ccName}(n))throw new R([\"payment.paymentData\"]);const r=this.getErrorsRequiredFields(n);if(!(0,lodash__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(r))throw new X(r);const o=this.mapToCreditCard(n,t),a=yield this.getClient(),{creditCards:s}=yield a.request(o);return{nonce:s[0].nonce,bin:s[0].details.bin}})}challenge3DSVerification(e,t){return de(this,void 0,void 0,function*(){const i=yield this.get3DS();return this.present3DSChallenge(i,t,e)})}teardownModule(e){return e?e.teardown():Promise.resolve()}getClientTokenOrThrow(){if(!this.clientToken)throw new D(C.PaymentNotInitialized);return this.clientToken}getErrorsRequiredFields(e){const{ccNumber:t,ccExpiry:i}=e,n={};return t||(n.ccNumber=[{message:\"Credit card number is required\",type:\"required\"}]),i||(n.ccExpiry=[{message:\"Expiration date is required\",type:\"required\"}]),n}mapToCreditCard(e,t){return{data:{creditCard:{cardholderName:e.ccName,number:e.ccNumber,cvv:e.ccCvv,expirationDate:`${e.ccExpiry.month}/${e.ccExpiry.year}`,options:{validate:!1},billingAddress:t&&{countryCodeAlpha2:t.countryCode,locality:t.city,countryName:t.country,postalCode:t.postalCode,streetAddress:t.address2?`${t.address1} ${t.address2}`:t.address1}}},endpoint:\"payment_methods/credit_cards\",method:\"post\"}}present3DSChallenge(e,t,i){const{nonce:n,bin:r}=i;if(!this.threeDSecureOptions||!n)throw new D(C.PaymentNotInitialized);const{addFrame:o,removeFrame:a,challengeRequested:s=!0,additionalInformation:d}=this.threeDSecureOptions,l=()=>de(this,void 0,void 0,function*(){const t=yield e.cancelVerifyCard();return u.cancel(new Q),t}),c=t.toFixed(2),u=new Z(e.verifyCard({addFrame:(e,t)=>{o&&o(e,t,l)},amount:Number(c),bin:r,challengeRequested:s,nonce:n,removeFrame:a,onLookupComplete:(e,t)=>{t()},collectDeviceData:!0,additionalInformation:d}));return u.promise}}class ce{constructor(e){this.paymentIntegrationService=e,this.braintreeHostWindow=window}render(e,t,i){const n=t&&document.getElementById(t);if(this.braintreeHostWindow.paypal&&n){const r=this.paymentIntegrationService.getState(),o=r.getCartOrThrow(),a=r.getBillingAddressOrThrow(),s=r.getPaymentMethodOrThrow(e);if(!s.initializationData)return;const{paypalBNPLConfiguration:d=[]}=s.initializationData,l=i===se.PAYMENT?\"checkout\":i,c=d&&d.find(({id:e})=>e===l);if(!c||!c.status)return;i===se.CART&&(n.removeAttribute(\"data-pp-style-logo-type\"),n.removeAttribute(\"data-pp-style-logo-position\"),n.removeAttribute(\"data-pp-style-text-color\"),n.removeAttribute(\"data-pp-style-text-size\")),this.braintreeHostWindow.paypal.Messages({amount:o.cartAmount,buyerCountry:a.countryCode,placement:i,style:this.getPaypalMessagesStylesFromBNPLConfig(c)}).render(`#${t}`)}}getPaypalMessagesStylesFromBNPLConfig({styles:e}){const t={};return e.color&&(t.color=e.color),e.layout&&(t.layout=e.layout),(e[\"logo-type\"]||e[\"logo-position\"])&&(t.logo={},e[\"logo-type\"]&&(t.logo.type=e[\"logo-type\"]),e[\"logo-position\"]&&(t.logo.position=e[\"logo-position\"])),e.ratio&&(t.ratio=e.ratio),(e[\"text-color\"]||e[\"text-size\"])&&(t.text={},e[\"text-color\"]&&(t.text.color=e[\"text-color\"]),e[\"text-size\"]&&(t.text.size=+e[\"text-size\"])),t}}class ue{constructor(e){const{element:t,closeElement:i,mainElement:n}=this._createElements(e);this._element=t,this._closeElement=i,this._mainElement=n}show(e){this._mainElement.parentElement||(this._registerClick(e),document.body.appendChild(this._mainElement),setTimeout(()=>this._element.style.opacity=\"1\"))}remove(){this._mainElement.parentElement&&(this._unregisterClick&&this._unregisterClick(),this._removeAfterTransition(),setTimeout(()=>this._element.style.opacity=\"0\"))}_createElements(e){const t=document.createElement(\"div\"),{background:i=\"rgba(0, 0, 0, 0.8)\",id:n=\"checkoutOverlay\",transitionDuration:r=400,hasCloseButton:o=!1,innerHtml:a=null}=e||{};let s,d,l,c,u=t;if(n&&(t.id=n),a){const e=document.createElement(\"div\");c=`${n}--overlayText`,e.className=c,e.appendChild(a),t.appendChild(e)}return o&&(l=`${n}--close`,s=document.createElement(\"div\"),s.className=l,d=`${n}--layout`,u=document.createElement(\"div\"),u.className=d,u.appendChild(t),u.appendChild(s)),u.appendChild(function(e){const{id:t,background:i,transitionDuration:n,classLayout:r,classOverlayText:o,classClose:a}=e,s=document.createElement(\"style\"),d=r?`, .${r}`:\"\";return s.id=`${t}--styles`,s.type=\"text/css\",s.innerText=`\\n        #${t}${d} {\\n            display: block;\\n            height: 100%;\\n            width: 100%;\\n            left: 0;\\n            top: 0;\\n            position: fixed;\\n            z-index: 2147483647;\\n        }\\n        #${t} {\\n            transition: opacity ${n}ms ease-out;\\n            background: ${i};\\n            opacity: 0;\\n        }\\n    `,o&&(s.innerText+=`\\n             #${t} {\\n                display: flex;\\n                align-items: center;\\n                justify-content: center;\\n             }\\n             #${t} .${o} {\\n                color: white;\\n                max-width: 330px;\\n                font-size: 1.2em;\\n                text-align: center;\\n             }\\n        `),a&&(s.innerText+=`\\n            #${t} {\\n                opacity: 1;\\n            }\\n            .${r} .${a} {\\n                position: fixed;\\n                right: 16px;\\n                top: 16px;\\n                width: 16px;\\n                height: 16px;\\n                opacity: 0.6;\\n                cursor: pointer;\\n                z-index: 3147483647;\\n            }\\n            .${r} .${a}::after, .${r} .${a}::before {\\n                position: absolute;\\n                left: 8px;\\n                content: '';\\n                height: 16px;\\n                width: 2px;\\n                background-color: #fff;\\n            }\\n            .${r} .${a}::after {\\n                transform: rotate(-45deg);\\n            }\\n            .${r} .${a}::before {\\n                transform: rotate(45deg);\\n            }\\n        `),s}({id:n,background:i,transitionDuration:r,classLayout:d,classOverlayText:c,classClose:l})),{element:t,closeElement:s,mainElement:u}}_addEventListener(e,t){e&&t&&e.addEventListener(\"click\",t)}_removeEventListener(e,t){e&&t&&e.removeEventListener(\"click\",t)}_registerClick(e){if(this._unregisterClick&&this._unregisterClick(),e){const{onClick:t,onClickClose:i}=e;this._addEventListener(this._element,t),this._addEventListener(this._closeElement,i),this._unregisterClick=()=>{this._removeEventListener(this._element,t),this._removeEventListener(this._closeElement,i),this._unregisterClick=void 0}}}_removeAfterTransition(){const e=t=>{\"opacity\"===t.propertyName&&(this._mainElement.parentElement&&this._mainElement.remove(),this._element.removeEventListener(\"transitionend\",e))};this._element.addEventListener(\"transitionend\",e)}}const he={size:70,color:\"#d9d9d9\",backgroundColor:\"#ffffff\"},ye=\"embedded-checkout-loading-indicator-rotation\";class me{constructor(e){this.styles=Object.assign(Object.assign({},he),e&&e.styles),this.containerStyles=Object.assign({},e&&e.containerStyles),this.defineAnimation(),this.container=this.buildContainer(),this.indicator=this.buildIndicator(),this.container.appendChild(this.indicator)}show(e){if(e){const t=document.getElementById(e);if(!t)throw new Error(\"Unable to attach the loading indicator because the parent ID is not valid.\");t.appendChild(this.container)}this.container.style.visibility=\"visible\",this.container.style.opacity=\"1\"}hide(){const e=()=>{this.container.style.visibility=\"hidden\",this.container.removeEventListener(\"transitionend\",e)};this.container.addEventListener(\"transitionend\",e),this.container.style.opacity=\"0\"}buildContainer(){const e=document.createElement(\"div\");return e.style.display=\"block\",e.style.bottom=\"0\",e.style.left=\"0\",e.style.height=\"100%\",e.style.width=\"100%\",e.style.position=\"absolute\",e.style.right=\"0\",e.style.top=\"0\",e.style.transition=\"all 250ms ease-out\",e.style.opacity=\"0\",this.setStyleAttribute(e,this.containerStyles),e}buildIndicator(){const e=document.createElement(\"div\");return e.style.display=\"block\",e.style.width=`${this.styles.size}px`,e.style.height=`${this.styles.size}px`,e.style.borderRadius=`${this.styles.size}px`,e.style.border=\"solid 1px\",e.style.borderColor=`${this.styles.backgroundColor} ${this.styles.backgroundColor} ${this.styles.color} ${this.styles.color}`,e.style.margin=\"0 auto\",e.style.position=\"absolute\",e.style.left=\"0\",e.style.right=\"0\",e.style.top=\"50%\",e.style.transform=\"translateY(-50%) rotate(0deg)\",e.style.transformStyle=\"preserve-3d\",e.style.animation=`${ye} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`,e}setStyleAttribute(e,t){Object.keys(t).forEach(i=>{e.style.setProperty(i,t[i])})}defineAnimation(){var e;if(document.getElementById(ye))return;const t=document.createElement(\"style\");t.id=ye,null===(e=document.head)||void 0===e||e.appendChild(t),t.sheet instanceof CSSStyleSheet&&t.sheet.insertRule(`\\n                @keyframes ${ye} {\\n                    0% { transform: translateY(-50%) rotate(0deg); }\\n                    100% { transform: translateY(-50%) rotate(360deg); }\\n                }\\n            `,0)}}const pe={\"background-color\":\"rgba(0, 0, 0, 0.4)\",\"z-index\":\"1000\"};function ge(e){return\"object\"==typeof e&&null!==e&&\"name\"in e&&\"BraintreeError\"===e.name}function ve(e){return{recipientName:`${e.firstName} ${e.lastName}`,line1:e.address1,line2:e.address2,city:e.city,state:e.stateOrProvinceCode,postalCode:e.postalCode,countryCode:e.countryCode,phone:e.phone}}var fe=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class be{constructor(e,t,i,n){this.paymentIntegrationService=e,this.braintreeIntegrationService=t,this.braintreeMessages=i,this.loadingIndicator=n,this.braintreeHostWindow=window}initialize(e){return fe(this,void 0,void 0,function*(){const{braintree:t,methodId:i}=e;if(this.braintree=t,this.paymentMethod&&this.paymentMethod.nonce||(this.paymentMethod=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(i)),this.paymentMethod.clientToken&&(null==t?void 0:t.bannerContainerId))return yield this.loadPaypal(),this.loadPaypalCheckoutInstance();if(this.paymentMethod.clientToken)return this.loadPaypal();const n=yield this.paymentIntegrationService.loadPaymentMethod(i);if(this.paymentMethod=n.getPaymentMethodOrThrow(i),null==t?void 0:t.bannerContainerId)return this.loadPaypalCheckoutInstance();if(!this.paymentMethod.clientToken)throw new U(j.MissingPaymentMethod);return this.loadPaypal()})}execute(e,t){var i;return fe(this,void 0,void 0,function*(){const{payment:n}=e,r=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]),{onError:o}=this.braintree||{};if(!n)throw new R([\"payment\"]);try{const e=yield this.preparePaymentData(n,r.useStoreCredit);yield this.paymentIntegrationService.submitOrder(r,t),yield this.paymentIntegrationService.submitPayment(e)}catch(e){this.isProviderError(e)&&(yield this.loadPaypal(),null===(i=this.paypalButtonRender)||void 0===i||i.close(),yield this.loadPaypalCheckoutInstance(),yield new Promise((e,t)=>{o&&\"function\"==typeof o&&o(new Error(\"INSTRUMENT_DECLINED\")),t()})),this.handleError(e)}})}finalize(){return Promise.reject(new W)}deinitialize(){var e;return this.braintreeTokenizePayload=void 0,null===(e=this.paypalButtonRender)||void 0===e||e.close(),this.braintreeIntegrationService.teardown()}preparePaymentData(e,t){var i;return fe(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState(),r=n.getOutstandingBalance(t),o=n.getStoreConfig();if(!r)throw new U(j.MissingCheckout);if(!o)throw new U(j.MissingCheckoutConfig);if(!this.paymentMethod)throw new D(C.PaymentNotInitialized);const{currency:a,storeProfile:{storeLanguage:s}}=o,{nonce:d,config:{isVaultingEnabled:l}}=this.paymentMethod,{methodId:c,paymentData:u={}}=e,h=(null===(i=this.braintreeTokenizePayload)||void 0===i?void 0:i.nonce)||d;if(h){const t=yield this.paymentIntegrationService.loadPaymentMethod(c);return this.paymentMethod=t.getPaymentMethod(c),Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(h)})}if(H(u)||(y=u,Boolean(y.instrumentId)&&!Object.prototype.hasOwnProperty.call(y,\"ccNumber\")&&!Object.prototype.hasOwnProperty.call(y,\"ccCvv\"))){if(!l)throw new V(\"Vaulting is disabled but a vaulted instrument was being used for this transaction\");return Promise.resolve(e)}var y;if(!q(u))throw new U(j.MissingPayment);const{shouldSaveInstrument:m,shouldSetAsDefaultInstrument:p}=u;if(m&&!l)throw new V(\"Vaulting is disabled but shouldSaveInstrument is set to true\");const g=n.getShippingAddress(),v=g?ve(g):void 0;return Promise.all([this.braintreeIntegrationService.paypal({amount:r,locale:s,currency:a.code,offerCredit:\"braintreepaypalcredit\"===this.paymentMethod.id,shippingAddressOverride:v,shouldSaveInstrument:m||!1,shippingAddressEditable:!1}),this.braintreeIntegrationService.getSessionId()]).then(([{nonce:t,details:i}={},n])=>Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(t,i&&i.email,n,m,p)}))})}formattedPayload(e,t,i,n,r){return{formattedPayload:{vault_payment_instrument:n||null,set_as_default_stored_instrument:r||null,device_info:i||null,paypal_account:{token:e,email:t||null}}}}loadPaypalCheckoutInstance(){return fe(this,void 0,void 0,function*(){const{clientToken:e,initializationData:t,id:i}=this.paymentMethod||{};if(!e)throw new U(j.MissingPaymentMethod);try{this.braintreeIntegrationService.initialize(e);const n={currency:this.paymentIntegrationService.getState().getCartOrThrow().currency.code,intent:null==t?void 0:t.intent,isCreditEnabled:null==t?void 0:t.isCreditEnabled},r=\"braintreepaypalcredit\"===i||!(null==t?void 0:t.isCreditEnabled);yield this.braintreeIntegrationService.getPaypalCheckout(n,e=>{var t;r&&i&&(null===(t=this.braintree)||void 0===t?void 0:t.bannerContainerId)&&this.renderPayPalMessages(i,this.braintree.bannerContainerId),this.renderPayPalButton(e)},this.handleError)}catch(e){this.handleError(e)}})}renderPayPalMessages(e,t){this.braintreeMessages.render(e,t,se.PAYMENT)}renderPayPalButton(e){const{onPaymentError:t,submitForm:i,onRenderButton:n,containerId:r,onError:o}=this.braintree||{};if(!r)return;if(!this.paymentMethod)throw new D(C.PaymentNotInitialized);this.loadingIndicatorContainer=r.split(\"#\")[1];const{id:a,config:{testMode:s}}=this.paymentMethod,{paypal:d}=this.braintreeHostWindow,l=null==d?void 0:d.FUNDING.PAYPAL;d&&l?(this.paypalButtonRender=d.Buttons({env:s?\"sandbox\":\"production\",commit:!1,fundingSource:l,onClick:()=>{this.toggleLoadingIndicator(!0)},createOrder:()=>this.setupPayment(e,a,t),onApprove:t=>fe(this,void 0,void 0,function*(){this.braintreeTokenizePayload=yield this.tokenizePaymentOrThrow(t,e),i&&\"function\"==typeof i&&i()}),onCancel:()=>{this.toggleLoadingIndicator(!1)},onError:e=>{this.toggleLoadingIndicator(!1),null==o||o(e)}}),n&&\"function\"==typeof n&&n(),this.paypalButtonRender.isEligible()&&this.paypalButtonRender.render(`${r}`)):this.removeElement(r.split(\"#\")[1])}setupPayment(e,t,i){return fe(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState();try{const i=n.getCustomer(),r=n.getPaymentMethodOrThrow(t),o=n.getCheckoutOrThrow().outstandingBalance,a=n.getStoreConfigOrThrow().currency.code,s=n.getShippingAddress()||(null==i?void 0:i.addresses[0]),d=s?ve(s):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:d,amount:o,currency:a,offerCredit:!1,intent:r.initializationData.intent})}catch(e){throw i&&(ge(e)||e instanceof p)&&i(e),e}})}tokenizePaymentOrThrow(e,t,i){return fe(this,void 0,void 0,function*(){try{return yield t.tokenizePayment(e)}catch(e){throw i&&(ge(e)||e instanceof p)&&i(e),e}})}loadPaypal(){return fe(this,void 0,void 0,function*(){const{clientToken:e,initializationData:t}=this.paymentMethod||{};if(!e||!t)throw new U(j.MissingPaymentMethod);try{this.braintreeIntegrationService.initialize(e),yield this.braintreeIntegrationService.getPaypal()}catch(e){this.handleError(e)}return Promise.resolve()})}handleError(e){if(!ge(e))throw e;if(\"PAYPAL_POPUP_CLOSED\"===e.code)throw new Q(e.message);throw new $(e.message)}isProviderError(e){var t,i,n;return!!function(e){return\"object\"==typeof e&&null!==e&&\"errors\"in e}(e)&&\"2046\"===(null===(n=null===(i=((null===(t=null==e?void 0:e.errors)||void 0===t?void 0:t.filter(e=>e.provider_error))||[])[0])||void 0===i?void 0:i.provider_error)||void 0===n?void 0:n.code)}removeElement(e){const t=e&&document.getElementById(e);t&&t.remove()}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}}const we=L(t=>{const i=window,n=new ue,r=new F(t),o=new le(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,r),i,n),a=new ce(t);return new be(t,o,a,new me({containerStyles:pe}))},[{id:\"braintreepaypal\"},{id:\"braintreepaypalcredit\"}]);var Ce;!function(e){e.Json=\"application/json\",e.JsonV1=\"application/vnd.bc.v1+json\"}(Ce||(Ce={}));const Se=Ce,Pe={\"X-Checkout-SDK-Version\":\"1.867.0\"};class Ie{constructor(e){this.requestSender=e}getOrderStatus(e=\"braintreelocalmethods\",t){return i=this,n=void 0,o=function*(){const i=`/api/storefront/initialization/${e}`,n=Object.assign({\"X-API-INTERNAL\":\"This API endpoint is for internal use only and may change in the future\",\"Content-Type\":Se.Json},Pe);return(yield this.requestSender.get(i,Object.assign({headers:n},t))).body},new((r=void 0)||(r=Promise))(function(e,t){function a(e){try{d(o.next(e))}catch(e){t(e)}}function s(e){try{d(o.throw(e))}catch(e){t(e)}}function d(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r(function(e){e(i)})).then(a,s)}d((o=o.apply(i,n||[])).next())});// removed by dead control flow\n var i, n, r, o; }}const Oe={body:{},headers:{},status:0};class ke extends p{constructor(e,{message:t,errors:i}={}){const{body:n,headers:r,status:o}=e||Oe;super(t||\"An unexpected error has occurred.\"),this.name=\"RequestError\",this.type=\"request\",this.body=n,this.headers=r,this.status=o,this.errors=i||[]}}class Ee extends ke{constructor(e){super(e,{message:\"There is a problem processing your payment. Please try again later.\"}),this.name=\"PaymentMethodInvalidError\",this.type=\"payment_method_invalid\"}}class Te extends ke{constructor(e){super(e,{message:\"The request has timed out or aborted.\"}),this.name=\"TimeoutError\",this.type=\"timeout\"}}var Ae=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ze{constructor(e,t,i,n,r=3e3,a=3e5){this.paymentIntegrationService=e,this.braintreeSdk=t,this.braintreeRequestSender=i,this.loadingIndicator=n,this.pollingInterval=r,this.maxPollingIntervalTime=a,this.isLPMsUpdateExperimentEnabled=!1,this.pollingTimer=0,this.stopPolling=lodash__WEBPACK_IMPORTED_MODULE_1__.noop,this.isPollingEnabled=!1}initialize(e){return Ae(this,void 0,void 0,function*(){const{gatewayId:t,methodId:i,braintreelocalmethods:n}=e;if(this.gatewayId=t,!i)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new V('Unable to initialize payment because \"options.gatewayId\" argument is not provided.');if(!n)throw new V('Unable to initialize payment because \"options.braintreelocalmethods\" argument is not provided.');this.braintreelocalmethods=n,this.loadingIndicatorContainer=n.container.split(\"#\")[1],yield this.paymentIntegrationService.loadPaymentMethod(t);const r=this.paymentIntegrationService.getState(),o=r.getPaymentMethodOrThrow(t),{clientToken:a,config:s,initializationData:d}=o,l=r.getStoreConfigOrThrow().checkoutSettings.features;if(this.isPollingEnabled=x(l,\"PAYPAL-5258.braintree_local_methods_polling\"),this.isLPMsUpdateExperimentEnabled=x(l,\"PAYPAL-4853.add_new_payment_flow_for_braintree_lpms\"),!a||!d||!s.merchantId)throw new U(j.MissingPaymentMethod);try{this.braintreeSdk.initialize(a),this.isNonInstantPaymentMethod(i)||(this.braintreeLocalPayment=yield this.braintreeSdk.getBraintreeLocalPayment(s.merchantId))}catch(e){this.handleError(e)}})}finalize(){return Promise.reject(new W)}deinitialize(){return Ae(this,void 0,void 0,function*(){return this.toggleLoadingIndicator(!1),Promise.resolve()})}execute(e,t){return Ae(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!i)throw new R([\"payment\"]);const{methodId:r}=i;this.toggleLoadingIndicator(!0),this.isNonInstantPaymentMethod(r)?yield this.executeWithNotInstantLPM(r):yield this.executeWithInstantLPM(r,n,t)})}executeWithNotInstantLPM(e){return Ae(this,void 0,void 0,function*(){try{const t=yield this.getLPMsBasicPaymentData();yield this.paymentIntegrationService.submitOrder(),yield this.paymentIntegrationService.submitPayment({methodId:e,paymentData:Object.assign(Object.assign({},t),{formattedPayload:{method:e}})})}catch(e){if(this.isBraintreeRedirectError(e)){const t=e.body.additional_action_required.data.redirect_url;return new Promise((e,i)=>{window.location.replace(t),this.toggleLoadingIndicator(!1),i()})}return this.handleError(e),Promise.reject(e)}})}executeWithInstantLPM(e,t,i){return Ae(this,void 0,void 0,function*(){if(!this.braintreeLocalPayment)throw new Ee;yield new Promise((n,r)=>{var o;null===(o=this.braintreeLocalPayment)||void 0===o||o.startPayment(this.getInstantLPMConfig(e,t,i),this.getInstantLPMCallback(n,r,e,t,i))})})}getLPMsBasicPaymentData(){return Ae(this,void 0,void 0,function*(){const{deviceData:e}=yield this.braintreeSdk.getDataCollectorOrThrow();return{deviceSessionId:e}})}getInstantLPMConfig(e,t,i){const n=this.paymentIntegrationService.getState(),r=n.getCartOrThrow(),o=n.getBillingAddressOrThrow(),{firstName:a,lastName:s,countryCode:d}=o,{currency:l,email:c,lineItems:u}=r,h=u.physicalItems.length>0,y=n.getCheckoutOrThrow().outstandingBalance,m=n.getStoreConfigOrThrow().links.checkoutLink;return{paymentType:e,amount:y,fallback:{url:m,buttonText:\"Complete Payment\"},currencyCode:l.code,shippingAddressRequired:h,email:c,givenName:a,surname:s,address:{countryCode:d},onPaymentStart:(n,r)=>Ae(this,void 0,void 0,function*(){if(!this.isLPMsUpdateExperimentEnabled)return this.orderId=n.paymentId,void r();const o=yield this.getLPMsBasicPaymentData(),a=Object.assign(Object.assign({},o),{formattedPayload:{method:e,[`${e}_account`]:{order_id:n.paymentId}}});try{yield this.paymentIntegrationService.submitOrder(t,i),yield this.paymentIntegrationService.submitPayment({methodId:e,paymentData:a})}catch(t){if(this.isBraintreeOrderSavedResponse(t)&&t.body.additional_action_required.data.order_id_saved_successfully)return r(),this.isPollingEnabled?new Promise((t,i)=>{this.initializePollingMechanism(e,t,i,this.gatewayId)}):void 0;throw t}})}}getInstantLPMCallback(e,t,i,n,r){const o=this.paymentIntegrationService.getState().getCartOrThrow();return(a,s)=>Ae(this,void 0,void 0,function*(){if(a)return\"LOCAL_PAYMENT_WINDOW_CLOSED\"===a.code?(this.toggleLoadingIndicator(!1),this.resetPollingMechanism(),t()):(this.isPollingEnabled&&this.resetPollingMechanism(),this.toggleLoadingIndicator(!1),t(new Ee));const d=yield this.getLPMsBasicPaymentData(),l=Object.assign(Object.assign({},d),{formattedPayload:{method:i,[`${i}_account`]:Object.assign({email:o.email,token:s.nonce},this.isLPMsUpdateExperimentEnabled?{}:{order_id:this.orderId})}});try{return this.isLPMsUpdateExperimentEnabled||(yield this.paymentIntegrationService.submitOrder(n,r)),yield this.paymentIntegrationService.submitPayment({methodId:i,paymentData:l}),e(void 0)}catch(e){return this.handleError(e),t(e)}})}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}handleError(e){const{onError:t}=this.braintreelocalmethods||{};this.isPollingEnabled&&this.resetPollingMechanism(),this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}isNonInstantPaymentMethod(e){return e.toUpperCase()in I}isBraintreeRedirectError(e){var t;if(\"object\"!=typeof e||null===e)return!1;const{body:i}=e;return!!i&&!!(null===(t=i.additional_action_required)||void 0===t?void 0:t.data.redirect_url)}isBraintreeOrderSavedResponse(e){var t;if(\"object\"!=typeof e||null===e)return!1;const{body:i}=e;return!!i&&(null===(t=i.additional_action_required)||void 0===t?void 0:t.data.hasOwnProperty(\"order_id_saved_successfully\"))}initializePollingMechanism(e,t,i,n){return Ae(this,void 0,void 0,function*(){yield new Promise((e,t)=>{const i=setTimeout(e,this.pollingInterval);this.stopPolling=()=>(clearTimeout(i),this.toggleLoadingIndicator(!1),t())});try{this.pollingTimer+=this.pollingInterval;const r=yield this.braintreeRequestSender.getOrderStatus(n,{params:{useMetadata:!1}}),o=r.status===P.Pending,a=r.status===P.Completed,s=r.status===P.Failed;if(a)return this.deinitializePollingMechanism(),t();if(s)return i();if(!a&&o&&this.pollingTimer<this.maxPollingIntervalTime)return yield this.initializePollingMechanism(e,t,i,n);yield this.reinitializeStrategy({methodId:e,gatewayId:n,braintreelocalmethods:this.braintreelocalmethods}),this.handleError(new Te)}catch(e){i()}})}deinitializePollingMechanism(){this.stopPolling(),this.pollingTimer=0}resetPollingMechanism(){this.deinitializePollingMechanism()}reinitializeStrategy(e){return Ae(this,void 0,void 0,function*(){yield this.deinitialize(),yield this.initialize(e)})}}const Ne=L(t=>{const i=window,n=new F(t),r=new B(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n)),o=(0,_bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_3__.createRequestSender)(),a=new Ie(o);return new ze(t,r,a,new me({styles:{backgroundColor:\"black\"}}))},[{gateway:\"braintreelocalmethods\"}]);function De(e){return\"string\"!=typeof e}function Me(e,t){if(t||e)return function(e){var t,i;const n={},r=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)(e.root,De),o=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)(e.input,De),a=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)(e.toggle,De),d=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)(null===(t=e.text)||void 0===t?void 0:t.body,De),l=(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)(null===(i=e.text)||void 0===i?void 0:i.caption,De),c=e.branding;return Object.keys(r).length&&(n.root=r),Object.keys(o).length&&(n.input=o),Object.keys(a).length&&(n.toggle=a),Object.keys(d).length&&(n.text={},n.text.body=d),Object.keys(l).length&&(n.text=Object.assign({},n.text),n.text.caption=l),c&&(n.branding=c),n}(function(e,t){var i,n,r,o,a,s,d,l,c,u,h,y,m,p,g,v,f,b,w,C,S,P;return{root:{backgroundColorPrimary:(null==e?void 0:e.fastlaneRootSettingsBackgroundColor)||(null===(i=null==t?void 0:t.root)||void 0===i?void 0:i.backgroundColorPrimary),errorColor:(null==e?void 0:e.fastlaneRootSettingsErrorColor)||(null===(n=null==t?void 0:t.root)||void 0===n?void 0:n.errorColor),fontFamily:(null==e?void 0:e.fastlaneRootSettingsFontFamily)||(null===(r=null==t?void 0:t.root)||void 0===r?void 0:r.fontFamily),fontSizeBase:(null==e?void 0:e.fastlaneRootSettingsFontSize)||(null===(o=null==t?void 0:t.root)||void 0===o?void 0:o.fontSizeBase),padding:(null==e?void 0:e.fastlaneRootSettingsPadding)||(null===(a=null==t?void 0:t.root)||void 0===a?void 0:a.padding),primaryColor:(null==e?void 0:e.fastlaneRootSettingsPrimaryColor)||(null===(s=null==t?void 0:t.root)||void 0===s?void 0:s.primaryColor)},input:{borderRadius:(null==e?void 0:e.fastlaneInputSettingsBorderRadius)||(null===(d=null==t?void 0:t.input)||void 0===d?void 0:d.borderRadius),borderColor:(null==e?void 0:e.fastlaneInputSettingsBorderColor)||(null===(l=null==t?void 0:t.input)||void 0===l?void 0:l.borderColor),focusBorderColor:(null==e?void 0:e.fastlaneInputSettingsFocusBorderBase)||(null===(c=null==t?void 0:t.input)||void 0===c?void 0:c.focusBorderColor),backgroundColor:(null==e?void 0:e.fastlaneInputSettingsBackgroundColor)||(null===(u=null==t?void 0:t.input)||void 0===u?void 0:u.backgroundColor),borderWidth:(null==e?void 0:e.fastlaneInputSettingsBorderWidth)||(null===(h=null==t?void 0:t.input)||void 0===h?void 0:h.borderWidth),textColorBase:(null==e?void 0:e.fastlaneInputSettingsTextColorBase)||(null===(y=null==t?void 0:t.input)||void 0===y?void 0:y.textColorBase)},toggle:{colorPrimary:(null==e?void 0:e.fastlaneToggleSettingsColorPrimary)||(null===(m=null==t?void 0:t.toggle)||void 0===m?void 0:m.colorPrimary),colorSecondary:(null==e?void 0:e.fastlaneToggleSettingsColorSecondary)||(null===(p=null==t?void 0:t.toggle)||void 0===p?void 0:p.colorSecondary)},text:{body:{color:(null==e?void 0:e.fastlaneTextBodySettingsColor)||(null===(v=null===(g=null==t?void 0:t.text)||void 0===g?void 0:g.body)||void 0===v?void 0:v.color),fontSize:(null==e?void 0:e.fastlaneTextBodySettingsFontSize)||(null===(b=null===(f=null==t?void 0:t.text)||void 0===f?void 0:f.body)||void 0===b?void 0:b.fontSize)},caption:{color:(null==e?void 0:e.fastlaneTextCaptionSettingsColor)||(null===(C=null===(w=null==t?void 0:t.text)||void 0===w?void 0:w.caption)||void 0===C?void 0:C.color),fontSize:(null==e?void 0:e.fastlaneTextCaptionSettingsFontSize)||(null===(P=null===(S=null==t?void 0:t.text)||void 0===S?void 0:S.caption)||void 0===P?void 0:P.fontSize)}},branding:(null==e?void 0:e.fastlaneBrandingSettings)||(null==t?void 0:t.branding)}}(e,t))}function _e(e){return!!e&&(\"authenticationState\"in e||\"addresses\"in e||\"instruments\"in e)}var Be,xe=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Fe{constructor(e,t,i){this.paymentIntegrationService=e,this.braintreeFastlaneUtils=t,this.braintreeSdk=i}initialize(e){var t;return xe(this,void 0,void 0,function*(){const{methodId:i,braintreefastlane:n}=e;if(!i)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!n)throw new V('Unable to initialize payment because \"options.braintreefastlane\" argument is not provided.');if(!n.onInit||\"function\"!=typeof n.onInit)throw new V('Unable to initialize payment because \"options.braintreefastlane.onInit\" argument is not provided or it is not a function.');if(!n.onChange||\"function\"!=typeof n.onChange)throw new V('Unable to initialize payment because \"options.braintreefastlane.onChange\" argument is not provided or it is not a function.');yield this.paymentIntegrationService.loadPaymentMethod(i);const r=this.paymentIntegrationService.getState(),o=r.getPaymentMethodOrThrow(i),{initializationData:a,clientToken:s}=o||{},{isFastlaneStylingEnabled:d}=a||{},l=x(r.getStoreConfigOrThrow().checkoutSettings.features,\"PROJECT-7080.braintree_fastlane_three_ds\");this.is3DSEnabled=o.config.is3dsEnabled,s&&l&&this.braintreeSdk.initialize(s);const c=Me(d?null===(t=o.initializationData)||void 0===t?void 0:t.fastlaneStyles:void 0,n.styles);yield this.braintreeFastlaneUtils.initializeBraintreeFastlaneOrThrow(i,c),this.shouldRunAuthenticationFlow()&&(yield this.braintreeFastlaneUtils.runPayPalAuthenticationFlowOrThrow()),yield this.initializeCardComponent(),this.onError=n.onError,n.onInit(e=>this.renderBraintreeCardComponent(e)),n.onChange(()=>this.handleBraintreeStoredInstrumentChange(i))})}execute(e,t){return xe(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!i)throw new R([\"payment\"]);yield this.paymentIntegrationService.submitOrder(n,t);const r=yield this.preparePaymentPayload(i.methodId);yield this.paymentIntegrationService.submitPayment(r),this.braintreeFastlaneUtils.removeSessionIdFromCookies()})}finalize(){return Promise.reject(new W)}deinitialize(){return xe(this,void 0,void 0,function*(){return this.braintreeCardComponent=void 0,Promise.resolve()})}initializeCardComponent(){return xe(this,void 0,void 0,function*(){const e=this.paymentIntegrationService.getState(),{phone:t,firstName:i,lastName:n}=e.getBillingAddressOrThrow(),r=`${i} ${n}`,o={styles:{},fields:Object.assign({cardholderName:{prefill:r,enabled:!0}},t&&{phoneNumber:{prefill:t}})},a=this.braintreeFastlaneUtils.getBraintreeFastlaneComponentOrThrow();this.braintreeCardComponent=yield a(o)})}renderBraintreeCardComponent(e){const t=this.getBraintreeCardComponentOrThrow();if(!e)throw new V('Unable to initialize payment because \"container\" argument is not provided.');t.render(e)}preparePaymentPayload(e){var t,i;return xe(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState(),r=n.getBillingAddressOrThrow(),o=`${r.firstName} ${r.lastName}`,a=this.getPayPalInstruments()[0],s=yield this.braintreeFastlaneUtils.getDeviceSessionId(),d=x(n.getStoreConfigOrThrow().checkoutSettings.features,\"PROJECT-7080.braintree_fastlane_three_ds\");if(a){const t=this.is3DSEnabled&&d?yield this.get3DS(a.bigpayToken,(null==a?void 0:a.iin)||\"\"):void 0;return{methodId:e,paymentData:{deviceSessionId:s,formattedPayload:{paypal_fastlane_token:{token:t||a.bigpayToken}}}}}const{getPaymentToken:l}=this.getBraintreeCardComponentOrThrow(),c=yield l({name:{fullName:o},billingAddress:this.mapToPayPalAddress(r)}),u=(null===(i=null===(t=c.paymentSource.card)||void 0===t?void 0:t.binDetails)||void 0===i?void 0:i.bin)||\"\",h=this.is3DSEnabled&&d?yield this.get3DS(c.id,u):void 0;return{methodId:e,paymentData:{deviceSessionId:s,nonce:h||c.id}}})}get3DS(e,t){return xe(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState(),n=yield this.braintreeSdk.getBraintreeThreeDS(),r=i.getOrderOrThrow();return new Promise((i,o)=>{n.verifyCard({amount:null==r?void 0:r.orderAmount,nonce:e,bin:t,onLookupComplete:(e,t)=>{n.on(\"customer-canceled\",()=>{\"function\"==typeof this.onError&&this.onError(new Q),o(new Q)}),t()}},(e,t)=>(e&&\"THREEDS_VERIFY_CARD_CANCELED_BY_MERCHANT\"===e.code&&(\"function\"==typeof this.onError&&this.onError(new Q),o(new Q)),i(t.nonce)))})})}mapToPayPalAddress(e){return{streetAddress:(null==e?void 0:e.address1)||\"\",locality:(null==e?void 0:e.city)||\"\",region:(null==e?void 0:e.stateOrProvinceCode)||(null==e?void 0:e.stateOrProvince)||\"\",postalCode:(null==e?void 0:e.postalCode)||\"\",countryCodeAlpha2:(null==e?void 0:e.countryCode)||\"\"}}shouldRunAuthenticationFlow(){const e=this.paymentIntegrationService.getState(),t=e.getCartOrThrow(),i=e.getCustomerOrThrow(),n=e.getPaymentProviderCustomer(),r=_e(n)?n:{},o=this.braintreeFastlaneUtils.getSessionIdFromCookies();return!(!i.isGuest||(null==r?void 0:r.authenticationState)===O.CANCELED||(null==r?void 0:r.authenticationState)||o!==t.id)}getBraintreeCardComponentOrThrow(){if(!this.braintreeCardComponent)throw new g;return this.braintreeCardComponent}getPayPalInstruments(){const e=this.paymentIntegrationService.getState().getPaymentProviderCustomerOrThrow();return(_e(e)?e:{}).instruments||[]}handleBraintreeStoredInstrumentChange(e){return xe(this,void 0,void 0,function*(){const t=this.braintreeFastlaneUtils.getBraintreeFastlaneOrThrow(),{selectionChanged:i,selectedCard:n}=yield t.profile.showCardSelector();if(i){const t=this.paymentIntegrationService.getState().getPaymentProviderCustomer(),i=_e(t)?t:{},r=this.braintreeFastlaneUtils.mapPayPalToBcInstrument(e,[n]);if(r&&r.length>0)return yield this.paymentIntegrationService.updatePaymentProviderCustomer(Object.assign(Object.assign({},i),{instruments:[...r]})),r[0]}})}}!function(e){e.CVV=\"cvv\",e.PAN=\"pan\"}(Be||(Be={}));class Le{static get(e){const t=`${encodeURIComponent(`${e}`)}=`,i=document.cookie;let n=null;const r=i.indexOf(t);if(r>-1){let e=i.indexOf(\";\",r);-1===e&&(e=i.length),n=decodeURIComponent(i.substring(r+t.length,e))}return n}static set(e,t,i={secure:!0}){let n=`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;const{expires:r,path:o,domain:a,secure:s}=i;if(r)n+=`; expires=${r.toUTCString()}`;else{const e=new Date,t=60;e.setTime(e.getTime()+60*t*1e3),n+=`; expires=${e.toUTCString()}`}o&&(n+=`; path=${o}`),a&&(n+=`; domain=${a}`),s&&(n+=\"; secure\"),document.cookie=n}static remove(e,t){Le.set(e,\"\",Object.assign({expires:new Date(0)},t))}}var Ve=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class je{constructor(e,t){this.paymentIntegrationService=e,this.braintreeIntegrationService=t}getDeviceSessionId(){return Ve(this,void 0,void 0,function*(){const e=this.paymentIntegrationService.getState().getCart();return this.braintreeIntegrationService.getSessionId(null==e?void 0:e.id)})}initializeBraintreeFastlaneOrThrow(e,t){return Ve(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState(),n=i.getCart(),{clientToken:r,config:o}=i.getPaymentMethodOrThrow(e);if(!r)throw new U(j.MissingPaymentMethod);this.methodId=e,this.braintreeIntegrationService.initialize(r),this.braintreeFastlane=yield this.braintreeIntegrationService.getBraintreeFastlane(null==n?void 0:n.id,o.testMode,t)})}getBraintreeFastlaneOrThrow(){if(!this.braintreeFastlane)throw new g;return this.braintreeFastlane}getBraintreeFastlaneComponentOrThrow(){return this.getBraintreeFastlaneOrThrow().FastlaneCardComponent}runPayPalAuthenticationFlowOrThrow(e,t){var i;return Ve(this,void 0,void 0,function*(){try{const n=this.getMethodIdOrThrow(),r=this.getBraintreeFastlaneOrThrow(),{lookupCustomerByEmail:o,triggerAuthenticationFlow:a}=r.identity,s=this.paymentIntegrationService.getState(),d=s.getCartOrThrow(),l=s.getCustomer(),c=s.getBillingAddress(),{isFastlaneShippingOptionAutoSelectEnabled:u}=s.getPaymentMethodOrThrow(n).initializationData||{},h=e||(null==l?void 0:l.email)||(null==c?void 0:c.email)||\"\",{customerContextId:y}=yield o(h);if(!y)return yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:O.UNRECOGNIZED,addresses:[],instruments:[]}),void this.saveSessionIdToCookies(d.id);const{authenticationState:m,profileData:p}=yield a(y),g=(null===(i=null==p?void 0:p.shippingAddress)||void 0===i?void 0:i.phoneNumber)||\"\";if(m===O.CANCELED)return yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:m,addresses:[],instruments:[]}),void this.removeSessionIdFromCookies();const v=this.mapPayPalToBcAddress([p.shippingAddress],[g])||[],f=this.getPayPalBillingAddresses(p),b=f?this.mapPayPalToBcAddress([f],[g]):[],w=p.card?this.mapPayPalToBcInstrument(n,[p.card]):[],C=this.mergeShippingAndBillingAddresses(v,b);if(this.saveSessionIdToCookies(d.id),yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:m,addresses:C,instruments:w}),b.length>0&&d.lineItems.physicalItems.length>0&&(yield this.paymentIntegrationService.updateBillingAddress(b[0])),b.length>0&&d.lineItems.digitalItems.length>0&&0===d.lineItems.physicalItems.length){const{firstName:e,lastName:t}=C[0],i=Object.assign(Object.assign({},b[0]),{firstName:e,lastName:t});yield this.paymentIntegrationService.updateBillingAddress(i)}v.length>0&&d.lineItems.physicalItems.length>0&&(yield this.paymentIntegrationService.updateShippingAddress(v[0]),t&&u&&(yield this.setShippingOption()))}catch(e){}})}getSessionIdFromCookies(){return Le.get(\"bc-fastlane-sessionId\")||\"\"}saveSessionIdToCookies(e){const t=new Date;t.setDate(t.getDate()+14),Le.set(\"bc-fastlane-sessionId\",e,{expires:t,secure:!0})}removeSessionIdFromCookies(){Le.remove(\"bc-fastlane-sessionId\")}mapPayPalToBcInstrument(e,t){if(t)return t.map(t=>{const{id:i,paymentSource:n}=t,{brand:r,expiry:o,lastDigits:a,binDetails:s}=n.card,[d,l]=o.split(\"-\");return{bigpayToken:i,brand:r,defaultInstrument:!1,expiryMonth:l,expiryYear:d,iin:(null==s?void 0:s.bin)||\"\",last4:a,method:e,provider:e,trustedShippingAddress:!1,type:\"card\",untrustedShippingCardVerificationMode:Be.PAN}})}mapPayPalToBcAddress(e,t){if(!e)return[];const i=this.paymentIntegrationService.getState().getCountries()||[],n=e=>{const t=i.find(t=>t.code===e);return(null==t?void 0:t.name)||\"\"};return e.map(e=>({id:Date.now(),type:\"paypal-address\",firstName:e.firstName||\"\",lastName:e.lastName||\"\",company:e.company||\"\",address1:e.streetAddress,address2:e.extendedAddress||\"\",city:e.locality,stateOrProvince:e.region,stateOrProvinceCode:e.region,country:n(e.countryCodeAlpha2),countryCode:e.countryCodeAlpha2,postalCode:e.postalCode,phone:t&&t[0]||\"\",customFields:[]}))}getPayPalBillingAddresses(e){const{card:t,name:i}=e||{};if(!t)return;const{firstName:r,lastName:o}=t.paymentSource.card.billingAddress,{firstName:a,lastName:s}=i||{},{shippingAddress:d}=e||{},l=Object.assign(Object.assign({},t.paymentSource.card.billingAddress),{firstName:r||a,lastName:o||s});return d&&(0,lodash__WEBPACK_IMPORTED_MODULE_1__.isEqual)(this.normalizeAddress(l),this.normalizeAddress(d))?d:l}normalizeAddress(e){return (0,lodash__WEBPACK_IMPORTED_MODULE_1__.omit)(e,[\"id\"])}mergeShippingAndBillingAddresses(e,t){const i=t.filter(t=>!e.some(e=>(0,lodash__WEBPACK_IMPORTED_MODULE_1__.isEqual)(this.normalizeAddress(e),this.normalizeAddress(t))));return[...e,...i]}getMethodIdOrThrow(){if(!this.methodId)throw new V('Unable to proceed because \"methodId\" argument is not provided.');return this.methodId}setShippingOption(){var e;return Ve(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState().getConsignments()||[],i=(null===(e=t[0])||void 0===e?void 0:e.availableShippingOptions)||[],n=i.find(e=>e.isRecommended);if(n||i.length){const e=n||i[0];yield this.paymentIntegrationService.selectShippingOption(e.id)}})}}const Ue=L(t=>{const i=window,n=new F(t),r=new le(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),i),o=new je(t,r),a=new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),s=new B(a);return new Fe(t,o,s)},[{id:\"braintreeacceleratedcheckout\"}]);var Re=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class He{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i}initialize(e){return Re(this,void 0,void 0,function*(){const{braintreevisacheckout:t,methodId:i}=e;if(!t)throw new V('Unable to initialize payment because \"options.braintreevisacheckout\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(i);const n=this.paymentIntegrationService.getState();this.paymentMethod=n.getPaymentMethodOrThrow(i);const r=n.getCheckoutOrThrow(),a=n.getStoreConfigOrThrow(),{clientToken:s,config:d}=this.paymentMethod||{};if(!s)throw new U(j.MissingPaymentMethod);const{onError:l=lodash__WEBPACK_IMPORTED_MODULE_1__.noop,onPaymentSelect:c=lodash__WEBPACK_IMPORTED_MODULE_1__.noop}=t;this.braintreeSdk.initialize(s);const u=yield this.braintreeSdk.getBraintreeVisaCheckout(),h=yield this.braintreeSdk.getVisaCheckoutSdk(null==d?void 0:d.testMode),y=u.createInitOptions({settings:{locale:a.storeProfile.storeLanguage,shipping:{collectShipping:!1}},paymentRequest:{currencyCode:a.currency.code,subtotal:String(r.subtotal)}});yield h.init(y),h.on(\"payment.success\",e=>this.tokenizePayment(u,e).then(()=>Promise.all([this.paymentIntegrationService.loadCheckout(),this.paymentIntegrationService.loadPaymentMethod(i)])).then(()=>c()).catch(e=>l(e))),h.on(\"payment.error\",(e,t)=>l(t))})}execute(e,t){var i,n;return Re(this,void 0,void 0,function*(){const{payment:r}=e,o=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!r)throw new V('Unable to submit payment because \"payload.payment\" argument is not provided.');if(!(null===(n=null===(i=this.paymentMethod)||void 0===i?void 0:i.initializationData)||void 0===n?void 0:n.nonce))throw new U(j.MissingPaymentMethod);const{nonce:a}=this.paymentMethod.initializationData;try{yield this.paymentIntegrationService.submitOrder(o,t),yield this.paymentIntegrationService.submitPayment(Object.assign(Object.assign({},r),{paymentData:{nonce:a}}))}catch(e){this.handleError(e)}})}finalize(){return Promise.reject(new W)}deinitialize(){return Re(this,void 0,void 0,function*(){yield this.braintreeSdk.deinitialize()})}tokenizePayment(e,t){return Re(this,void 0,void 0,function*(){return Promise.all([e.tokenize(t),this.braintreeSdk.getDataCollectorOrThrow()]).then(([e,t])=>{const i=this.paymentIntegrationService.getState(),n=i.getShippingAddress(),r=i.getBillingAddress(),{shippingAddress:o=this.mapToVisaCheckoutAddress(n),billingAddress:a=this.mapToVisaCheckoutAddress(r)}=e;return this.postForm(Object.assign(Object.assign({},e),{shippingAddress:o,billingAddress:a}),t)})})}mapToVisaCheckoutAddress(e){return e?{firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phone,streetAddress:e.address1,extendedAddress:e.address2,locality:e.city,region:e.stateOrProvinceCode,countryCode:e.countryCode,postalCode:e.postalCode}:{}}postForm(e,t){const{userData:i,billingAddress:n,shippingAddress:r,details:o}=e,{userEmail:a}=i,{deviceData:s}=t;return this.formPoster.postForm(\"/checkout.php\",{payment_type:e.type,nonce:e.nonce,provider:\"braintreevisacheckout\",action:\"set_external_checkout\",device_data:s,card_information:JSON.stringify({type:o.cardType,number:o.lastTwo}),billing_address:JSON.stringify(this.getAddress(a,n)),shipping_address:JSON.stringify(this.getAddress(a,r))})}getAddress(e,t={}){return{email:e,first_name:t.firstName,last_name:t.lastName,phone_number:t.phoneNumber,address_line_1:t.streetAddress,address_line_2:t.extendedAddress,city:t.locality,state:t.region,country_code:t.countryCode,postal_code:t.postalCode}}handleError(e){if(e instanceof Error&&\"BraintreeError\"===e.name)throw new $(e.message);throw e}}const We=L(t=>{const i=window,n=new F(t),r=new B(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n));return new He(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),r)},[{id:\"braintreevisacheckout\"}]);var qe=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class $e{constructor(e,t){this.paymentIntegrationService=e,this.braintreeIntegrationService=t}initialize(e){return qe(this,void 0,void 0,function*(){const{methodId:t}=e;yield this.paymentIntegrationService.loadPaymentMethod(t);const i=this.paymentIntegrationService.getState();this.venmoOptions=e.braintreevenmo;const n=i.getPaymentMethodOrThrow(t);yield this.initializeBraintreeVenmo(n)})}execute(e){return qe(this,void 0,void 0,function*(){const{payment:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!t)throw new R([\"payment\"]);try{const e=yield this.preparePaymentData(t);yield this.paymentIntegrationService.submitOrder(i),yield this.paymentIntegrationService.submitPayment(e)}catch(e){this.handleError(e)}})}finalize(){return Promise.reject(new W)}deinitialize(){return qe(this,void 0,void 0,function*(){return yield this.braintreeIntegrationService.teardown(),Promise.resolve()})}handleError(e){if(!M(e))throw e;if(\"PAYPAL_POPUP_CLOSED\"===e.code)throw new Q(e.message);throw new $(e.message)}initializeBraintreeVenmo(e){var t;return qe(this,void 0,void 0,function*(){const{clientToken:i}=e;if(!i)throw new U(j.MissingPaymentMethod);const n=x(this.paymentIntegrationService.getState().getStoreConfigOrThrow().checkoutSettings.features,\"PAYPAL-5406.braintree_venmo_web_fallback_support\");try{this.braintreeIntegrationService.initialize(i),this.braintreeVenmoCheckout=yield this.braintreeIntegrationService.getVenmoCheckout(Object.assign(Object.assign({},void 0!==(null===(t=this.venmoOptions)||void 0===t?void 0:t.allowDesktop)?{allowDesktop:this.venmoOptions.allowDesktop}:{}),n?{mobileWebFallBack:n}:{}))}catch(e){this.handleError(e)}})}preparePaymentData(e){return qe(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState(),{nonce:i}=t.getPaymentMethodOrThrow(e.methodId);if(i)return Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(i)});const n=yield this.braintreeVenmoTokenize(),r=yield this.braintreeIntegrationService.getSessionId();return Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(n.nonce,n.details.email,r)})})}formattedPayload(e,t,i){return{formattedPayload:{vault_payment_instrument:null,set_as_default_stored_instrument:null,device_info:i||null,paypal_account:{token:e,email:t||null}}}}braintreeVenmoTokenize(){return new Promise((e,t)=>{var i;null===(i=this.braintreeVenmoCheckout)||void 0===i||i.tokenize((i,n)=>{if(i)return t(i);e(n)})})}}const Ge=L(t=>{const i=window,n=(0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),r=new F(t),o=new z(n,i,r),a=new le(o,i);return new $e(t,a)},[{id:\"braintreevenmo\"}]);var Ye=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Je{constructor(e,t,i){this.paymentIntegrationService=e,this.braintreeIntegrationService=t,this.braintreeHostedForm=i}initialize(e){return Ye(this,void 0,void 0,function*(){const{methodId:t,gatewayId:i,braintree:n}=e;yield this.paymentIntegrationService.loadPaymentMethod(t);const r=this.paymentIntegrationService.getState();this.paymentMethod=r.getPaymentMethodOrThrow(t);const{clientToken:o}=this.paymentMethod;if(!o)throw new U(j.MissingPaymentMethod);this.threeDSecure=null==n?void 0:n.threeDSecure,this.onPaymentError=null==n?void 0:n.onPaymentError;try{this.braintreeIntegrationService.initialize(o,this.threeDSecure),this.isHostedPaymentFormEnabled(t,i)&&(null==n?void 0:n.form)&&(yield this.braintreeHostedForm.initialize(n.form,n.unsupportedCardBrands,o),this.isHostedFormInitialized=this.braintreeHostedForm.isInitialized()),this.is3dsEnabled=this.paymentMethod.config.is3dsEnabled,this.deviceSessionId=yield this.braintreeIntegrationService.getSessionId(),this.shouldInitializeBraintreeFastlane()&&(yield this.initializeBraintreeFastlaneOrThrow(t))}catch(e){return this.handleError(e,t)}})}execute(e){return Ye(this,void 0,void 0,function*(){const{payment:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!t)throw new R([\"payment\"]);this.isHostedFormInitialized&&this.braintreeHostedForm.validate(),yield this.paymentIntegrationService.submitOrder(i);const n=this.paymentIntegrationService.getState(),r=n.getBillingAddressOrThrow(),o=n.getOrderOrThrow().orderAmount;try{const e=this.isHostedFormInitialized?yield this.prepareHostedPaymentData(t,r,o):yield this.preparePaymentData(t,r,o);yield this.paymentIntegrationService.submitPayment(Object.assign(Object.assign({},t),{paymentData:e}))}catch(e){return this.processAdditionalAction(e,t,o)}})}finalize(){return Promise.reject(new W)}deinitialize(){return Ye(this,void 0,void 0,function*(){return this.isHostedFormInitialized=!1,yield Promise.all([this.braintreeIntegrationService.teardown(),this.braintreeHostedForm.deinitialize()]),Promise.resolve()})}handleError(e,t){var i;if(ge(e)){if(!(t&&this.paymentIntegrationService.getState().isPaymentMethodInitialized({methodId:t})||\"HOSTED_FIELDS_INVALID_FIELD_SELECTOR\"!==e.code))return;if(e.code.startsWith(\"THREEDS_\"))return null===(i=this.onPaymentError)||void 0===i||i.call(this,new $(\"THREEDS_VERIFICATION_FAILED\")),Promise.reject();throw new $(e.message)}throw e}preparePaymentData(e,t,i){return Ye(this,void 0,void 0,function*(){const{paymentData:n}=e,r={deviceSessionId:this.deviceSessionId};if(this.isSubmittingWithStoredCard(e))return Object.assign(Object.assign({},r),n);const{shouldSaveInstrument:o=!1,shouldSetAsDefaultInstrument:a=!1}=q(n)?n:{},{nonce:s}=this.shouldPerform3DSVerification(e)?yield this.braintreeIntegrationService.verifyCard(e,t,i):yield this.braintreeIntegrationService.tokenizeCard(e,t);return Object.assign(Object.assign({},r),{nonce:s,shouldSaveInstrument:o,shouldSetAsDefaultInstrument:a})})}prepareHostedPaymentData(e,t,i){return Ye(this,void 0,void 0,function*(){const{paymentData:n}=e,r={deviceSessionId:this.deviceSessionId};if(this.isSubmittingWithStoredCard(e)){const{nonce:e}=yield this.braintreeHostedForm.tokenizeForStoredCardVerification();return Object.assign(Object.assign(Object.assign({},r),n),{nonce:e})}const{shouldSaveInstrument:o=!1,shouldSetAsDefaultInstrument:a=!1}=q(n)?n:{},{nonce:s}=this.shouldPerform3DSVerification(e)?yield this.verifyCardWithHostedForm(t,i):yield this.braintreeHostedForm.tokenize(t);return Object.assign(Object.assign({},r),{shouldSaveInstrument:o,shouldSetAsDefaultInstrument:a,nonce:s})})}prepareAdditionalActionPaymentData(e,t){const{paymentData:i}=e,n={deviceSessionId:this.deviceSessionId,nonce:t},{shouldSaveInstrument:r=!1,shouldSetAsDefaultInstrument:o=!1}=q(i)?i:{};return this.isSubmittingWithStoredCard(e)&&(r||o)?Object.assign(Object.assign({},i),n):Object.assign({},n)}verifyCardWithHostedForm(e,t){return Ye(this,void 0,void 0,function*(){const i=yield this.braintreeHostedForm.tokenize(e);return this.braintreeIntegrationService.challenge3DSVerification(i,t)})}processAdditionalAction(e,t,i){return Ye(this,void 0,void 0,function*(){if(!(e=>\"object\"==typeof e&&null!==e&&\"body\"in e)(e)||!(0,lodash__WEBPACK_IMPORTED_MODULE_1__.some)(e.body.errors,{code:\"three_d_secure_required\"}))return this.handleError(e);try{const{payer_auth_request:n}=function(e){return\"object\"==typeof e&&null!==e&&\"name\"in e&&\"body\"in e&&\"status\"in e.body&&\"three_ds_result\"in e.body&&\"payer_auth_request\"in e.body.three_ds_result&&\"errors\"in e.body}(e)&&e.body.three_ds_result||{},{paymentData:r}=t,o=this.paymentIntegrationService.getState();if(!r||!H(r))throw new R([\"instrumentId\"]);const a=o.getCardInstrumentOrThrow(r.instrumentId),{nonce:s}=yield this.braintreeIntegrationService.challenge3DSVerification({nonce:n||\"\",bin:a.iin},i),d=this.prepareAdditionalActionPaymentData(t,s);yield this.paymentIntegrationService.submitPayment(Object.assign(Object.assign({},t),{paymentData:d}))}catch(e){return this.handleError(e)}})}isHostedPaymentFormEnabled(e,t){return!!e&&!0===this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e,t).config.isHostedFormEnabled}isSubmittingWithStoredCard(e){return!(!e.paymentData||!H(e.paymentData))}shouldPerform3DSVerification(e){return!(!this.is3dsEnabled||this.isSubmittingWithStoredCard(e))}shouldInitializeBraintreeFastlane(){var e;const t=this.paymentIntegrationService.getState().getPaymentProviderCustomerOrThrow(),i=_e(t)?t:{};return(null===(e=this.paymentMethod)||void 0===e?void 0:e.initializationData.isAcceleratedCheckoutEnabled)&&!(null==i?void 0:i.authenticationState)}initializeBraintreeFastlaneOrThrow(e){return Ye(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState(),i=t.getCartOrThrow(),n=t.getPaymentMethodOrThrow(e),{clientToken:r,config:o}=n;if(!r)throw new U(j.MissingPaymentMethod);this.braintreeIntegrationService.initialize(r,this.threeDSecure),yield this.braintreeIntegrationService.getBraintreeFastlane(i.id,o.testMode)})}}function Ke(e){return\"cardNumber\"in e}function Xe(e){if(!M(e))return!1;const{details:t}=e;return void 0===t||\"object\"==typeof t&&null!==t&&void 0===t.invalidFieldKeys||(i=t,Array.isArray(i)&&i.every(e=>\"string\"==typeof e));// removed by dead control flow\n var i; }var Qe,Ze=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};!function(e){e[e.CreditCard=0]=\"CreditCard\",e[e.StoredCardVerification=1]=\"StoredCardVerification\"}(Qe||(Qe={}));class et{constructor(e,t){this.braintreeScriptLoader=e,this.braintreeSDKVersionManager=t,this.isInitializedHostedForm=!1,this.handleBlur=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onBlur)||void 0===i||i.call(t,{fieldType:this.mapFieldType(e.emittedBy),errors:this.mapErrors(e.fields)})},this.handleFocus=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onFocus)||void 0===i||i.call(t,{fieldType:this.mapFieldType(e.emittedBy)})},this.handleCardTypeChange=e=>{var t,i;const n=1===e.cards.length?e.cards[0].type.replace(/^master-card$/,\"mastercard\"):void 0;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onCardTypeChange)||void 0===i||i.call(t,{cardType:n})},this.handleInputSubmitRequest=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onEnter)||void 0===i||i.call(t,{fieldType:this.mapFieldType(e.emittedBy)})},this.handleValidityChange=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onValidate)||void 0===i||i.call(t,{isValid:this.isValidForm(e),errors:this.mapValidationErrors(e.fields)})}}initialize(e,t,n){var r,o,a,s,d;return Ze(this,void 0,void 0,function*(){this.clientToken=n,this.formOptions=e,this.type=Ke(e.fields)?Qe.CreditCard:Qe.StoredCardVerification;const l=this.mapFieldOptions(e.fields,t);(0,lodash__WEBPACK_IMPORTED_MODULE_1__.isEmpty)(l)?this.isInitializedHostedForm=!1:(this.cardFields=yield this.createHostedFields({fields:l,styles:e.styles&&this.mapStyleOptions(e.styles)}),null===(r=this.cardFields)||void 0===r||r.on(\"blur\",this.handleBlur),null===(o=this.cardFields)||void 0===o||o.on(\"focus\",this.handleFocus),null===(a=this.cardFields)||void 0===a||a.on(\"cardTypeChange\",this.handleCardTypeChange),null===(s=this.cardFields)||void 0===s||s.on(\"validityChange\",this.handleValidityChange),null===(d=this.cardFields)||void 0===d||d.on(\"inputSubmitRequest\",this.handleInputSubmitRequest),this.isInitializedHostedForm=!0)})}isInitialized(){return!!this.isInitializedHostedForm}deinitialize(){var e;return Ze(this,void 0,void 0,function*(){this.isInitializedHostedForm&&(this.isInitializedHostedForm=!1,yield null===(e=this.cardFields)||void 0===e?void 0:e.teardown())})}validate(){if(!this.cardFields)throw new D(C.PaymentNotInitialized);const e=this.cardFields.getState();if(!this.isValidForm(e)){this.handleValidityChange(e);const t=this.mapValidationErrors(e.fields);throw new X(t)}}tokenize(e){var t,i,n,o,a;return Ze(this,void 0,void 0,function*(){if(!this.cardFields)throw new D(C.PaymentNotInitialized);try{const o=yield this.cardFields.tokenize((0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)({billingAddress:e&&this.mapBillingAddress(e)},lodash__WEBPACK_IMPORTED_MODULE_1__.isNil));return null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onValidate)||void 0===i||i.call(t,{isValid:!0,errors:{}}),{nonce:o.nonce,bin:null===(n=o.details)||void 0===n?void 0:n.bin}}catch(e){if(Xe(e)){const t=this.mapTokenizeError(e);if(t)throw null===(a=null===(o=this.formOptions)||void 0===o?void 0:o.onValidate)||void 0===a||a.call(o,{isValid:!1,errors:t}),new X(t)}throw e}})}tokenizeForStoredCardVerification(){var e,t,i,n,r;return Ze(this,void 0,void 0,function*(){if(!this.cardFields)throw new D(C.PaymentNotInitialized);try{const n=yield this.cardFields.tokenize();return null===(t=null===(e=this.formOptions)||void 0===e?void 0:e.onValidate)||void 0===t||t.call(e,{isValid:!0,errors:{}}),{nonce:n.nonce,bin:null===(i=n.details)||void 0===i?void 0:i.bin}}catch(e){if(Xe(e)){const t=this.mapTokenizeError(e,!0);if(t)throw null===(r=null===(n=this.formOptions)||void 0===n?void 0:n.onValidate)||void 0===r||r.call(n,{isValid:!1,errors:t}),new X(t)}throw e}})}createHostedFields(e){return Ze(this,void 0,void 0,function*(){const t=yield this.getClient(),i=yield this.braintreeScriptLoader.loadHostedFields(),n=this.braintreeSDKVersionManager.getSDKVersion()===v?Object.assign(Object.assign({},e),{preventCursorJumps:!0}):e;return i.create(Object.assign(Object.assign({},n),{client:t}))})}getClient(){return Ze(this,void 0,void 0,function*(){if(!this.clientToken)throw new D(C.PaymentNotInitialized);if(!this.client){const e=yield this.braintreeScriptLoader.loadClient();this.client=e.create({authorization:this.clientToken})}return this.client})}mapBillingAddress(e){return{countryName:e.country,postalCode:e.postalCode,streetAddress:e.address2?`${e.address1} ${e.address2}`:e.address1}}mapFieldOptions(e,t){if(Ke(e)){const i={};return null==t||t.forEach(e=>{(e=>Object.values(T).includes(e))(e)&&(i[e]=!1)}),(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)({number:Object.assign({container:`#${e.cardNumber.containerId}`,placeholder:e.cardNumber.placeholder,internalLabel:e.cardNumber.accessibilityLabel},Object.keys(i).length>0?{supportedCardBrands:i}:{}),expirationDate:{container:`#${e.cardExpiry.containerId}`,placeholder:e.cardExpiry.placeholder,internalLabel:e.cardExpiry.accessibilityLabel},cvv:e.cardCode&&{container:`#${e.cardCode.containerId}`,placeholder:e.cardCode.placeholder,internalLabel:e.cardCode.accessibilityLabel},cardholderName:{container:`#${e.cardName.containerId}`,placeholder:e.cardName.placeholder,internalLabel:e.cardName.accessibilityLabel}},lodash__WEBPACK_IMPORTED_MODULE_1__.isNil)}return (0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)({number:e.cardNumberVerification&&{container:`#${e.cardNumberVerification.containerId}`,placeholder:e.cardNumberVerification.placeholder},cvv:e.cardCodeVerification&&{container:`#${e.cardCodeVerification.containerId}`,placeholder:e.cardCodeVerification.placeholder}},lodash__WEBPACK_IMPORTED_MODULE_1__.isNil)}mapStyleOptions(e){const t=(e={})=>(0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)({color:e.color,\"font-family\":e.fontFamily,\"font-size\":e.fontSize,\"font-weight\":e.fontWeight},lodash__WEBPACK_IMPORTED_MODULE_1__.isNil);return{input:t(e.default),\".invalid\":t(e.error),\":focus\":t(e.focus)}}mapFieldType(e){switch(e){case\"number\":return this.type===Qe.StoredCardVerification?m.CardNumberVerification:m.CardNumber;case\"expirationDate\":return m.CardExpiry;case\"cvv\":return this.type===Qe.StoredCardVerification?m.CardCodeVerification:m.CardCode;case\"cardholderName\":return m.CardName;default:throw new Error(\"Unexpected field type\")}}mapErrors(e){const t={};if(e)for(const[i,n]of Object.entries(e))if(n&&this.isValidParam(i)){const{isValid:e,isEmpty:r,isPotentiallyValid:o}=n;t[i]={isValid:e,isEmpty:r,isPotentiallyValid:o}}return t}mapValidationErrors(e){return Object.keys(e).reduce((t,i)=>{var n;return Object.assign(Object.assign({},t),{[this.mapFieldType(i)]:(null===(n=e[i])||void 0===n?void 0:n.isValid)?void 0:[this.createInvalidError(this.mapFieldType(i))]})},{})}mapTokenizeError(e,t=!1){var i,n;if(\"HOSTED_FIELDS_FIELDS_EMPTY\"===e.code){const e=[this.createRequiredError(this.mapFieldType(\"cvv\"))];return t?{[this.mapFieldType(\"cvv\")]:e}:{[this.mapFieldType(\"cvv\")]:e,[this.mapFieldType(\"expirationDate\")]:[this.createRequiredError(this.mapFieldType(\"expirationDate\"))],[this.mapFieldType(\"number\")]:[this.createRequiredError(this.mapFieldType(\"number\"))],[this.mapFieldType(\"cardholderName\")]:[this.createRequiredError(this.mapFieldType(\"cardholderName\"))]}}return null===(n=null===(i=e.details)||void 0===i?void 0:i.invalidFieldKeys)||void 0===n?void 0:n.reduce((e,t)=>{const i=this.mapFieldType(t);return Object.assign(Object.assign({},e),{[i]:[this.createInvalidError(i)]})},{})}createRequiredError(e){var t;return{fieldType:e,message:null!==(t={[m.CardCode]:\"CVV is required\",[m.CardCodeVerification]:\"CVV is required\",[m.CardNumber]:\"Credit card number is required\",[m.CardNumberVerification]:\"Credit card number is required\",[m.CardExpiry]:\"Expiration date is required\",[m.CardName]:\"Full name is required\"}[e])&&void 0!==t?t:\"Field is required\",type:\"required\"}}createInvalidError(e){var t,i,n,r;const o={[m.CardCode]:{message:\"Invalid card code\",type:\"invalid_card_code\"},[m.CardCodeVerification]:{message:\"Invalid card code\",type:\"invalid_card_code\"},[m.CardNumber]:{message:\"Invalid card number\",type:\"invalid_card_number\"},[m.CardNumberVerification]:{message:\"Invalid card number\",type:\"invalid_card_number\"},[m.CardExpiry]:{message:\"Invalid card expiry\",type:\"invalid_card_expiry\"},[m.CardName]:{message:\"Invalid card name\",type:\"invalid_card_name\"}};return{fieldType:e,message:null!==(i=null===(t=o[e])||void 0===t?void 0:t.message)&&void 0!==i?i:\"Invalid field\",type:null!==(r=null===(n=o[e])||void 0===n?void 0:n.type)&&void 0!==r?r:\"invalid\"}}isValidForm(e){return Object.keys(e.fields).every(t=>{var i;return null===(i=e.fields[t])||void 0===i?void 0:i.isValid})}isValidParam(e){return[\"number\",\"cvv\",\"expirationDate\",\"postalCode\",\"cardholderName\",\"cardType\"].includes(e)}}const tt=L(t=>{const i=window,n=new F(t),r=new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),o=new le(r,i),a=new et(r,n);return new Je(t,o,a)},[{id:\"braintree\"}]);var it=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class nt{constructor(e,t,i,n){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeHostWindow=n}initialize(e){return it(this,void 0,void 0,function*(){const{braintreepaypal:t,methodId:i}=e,{container:n,onError:r}=t||{};if(!i)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new V('Unable to initialize payment because \"options.braintreepaypal\" argument is not provided.');if(!n)throw new V('Unable to initialize payment because \"options.braintreepaypal.container\" argument is not provided.');let o,a=this.paymentIntegrationService.getState();try{if(o=a.getPaymentMethodOrThrow(i),!o.clientToken)throw new U(j.MissingPaymentToken)}catch(e){a=yield this.paymentIntegrationService.loadPaymentMethod(i),o=a.getPaymentMethodOrThrow(i)}const{clientToken:s,config:d,initializationData:l}=o,{paymentButtonStyles:c}=l||{},{checkoutTopButtonStyles:u}=c||{};if(!s||!l)throw new U(j.MissingPaymentMethod);const h={currency:a.getCartOrThrow().currency.code,intent:l.intent,isCreditEnabled:l.isCreditEnabled,commit:!1};this.braintreeIntegrationService.initialize(s),yield this.braintreeIntegrationService.getPaypalCheckout(h,e=>{this.renderPayPalButton(e,t,i,Boolean(d.testMode),u)},e=>this.handleError(e,n,r))})}deinitialize(){return it(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}signIn(e,t){return it(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return it(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}renderPayPalButton(e,t,i,n,r){const{container:a,onClick:s=lodash__WEBPACK_IMPORTED_MODULE_1__.noop}=t,{paypal:d}=this.braintreeHostWindow,l=null==d?void 0:d.FUNDING.PAYPAL;if(d&&l){const o=d.Buttons({env:this.braintreeIntegrationService.getBraintreeEnv(n),fundingSource:l,style:Object.assign(Object.assign({},r),{height:40}),createOrder:()=>this.setupPayment(e,t,i),onApprove:n=>this.tokenizePayment(n,e,i,t),onClick:s});o.isEligible()&&o.render(`#${a}`)}else this.braintreeIntegrationService.removeElement(a)}setupPayment(e,t,i){var n;return it(this,void 0,void 0,function*(){try{yield this.paymentIntegrationService.loadDefaultCheckout();const t=this.paymentIntegrationService.getState(),r=t.getCheckoutOrThrow().outstandingBalance,o=t.getCartOrThrow().currency.code,a=t.getCustomer(),s=t.getPaymentMethodOrThrow(i),d=null==a?void 0:a.addresses[0],l=d?this.braintreeIntegrationService.mapToBraintreeShippingAddressOverride(d):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:l,amount:r,currency:o,offerCredit:!1,intent:null===(n=s.initializationData)||void 0===n?void 0:n.intent})}catch(e){const{container:i,onError:n}=t;this.handleError(e,i,n)}})}tokenizePayment(e,t,i,n){return it(this,void 0,void 0,function*(){try{const{deviceData:n}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),r=yield t.tokenizePayment(e),{details:o,nonce:a}=r,s=this.braintreeIntegrationService.mapToLegacyBillingAddress(o),d=this.braintreeIntegrationService.mapToLegacyShippingAddress(o);return this.formPoster.postForm(\"/checkout.php\",{payment_type:\"paypal\",provider:i,action:\"set_external_checkout\",nonce:a,device_data:n,billing_address:JSON.stringify(s),shipping_address:JSON.stringify(d)}),r}catch(e){const{container:t,onError:i}=n;this.handleError(e,t,i)}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!M(e))throw e;i(e)}}const rt=L(t=>{const i=window,n=new F(t),r=new le(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),i);return new nt(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),r,i)},[{id:\"braintreepaypal\"}]);var ot=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class at{constructor(e,t,i,n){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeHostWindow=n}initialize(e){return ot(this,void 0,void 0,function*(){const{braintreepaypalcredit:t,methodId:i}=e,{container:n,onError:r}=t||{};if(!i)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new V('Unable to initialize payment because \"options.braintreepaypalcredit\" argument is not provided.');if(!n)throw new V('Unable to initialize payment because \"options.braintreepaypalcredit.container\" argument is not provided.');let o,a=this.paymentIntegrationService.getState();try{if(o=a.getPaymentMethodOrThrow(i),!o.clientToken)throw new U(j.MissingPaymentToken)}catch(e){a=yield this.paymentIntegrationService.loadPaymentMethod(i),o=a.getPaymentMethodOrThrow(i)}const{clientToken:s,config:d,initializationData:l}=o,{paymentButtonStyles:c}=l||{},{checkoutTopButtonStyles:u}=c||{};if(!s||!l)throw new U(j.MissingPaymentMethod);const h={currency:a.getCartOrThrow().currency.code,intent:l.intent,isCreditEnabled:l.isCreditEnabled,commit:!1};this.braintreeIntegrationService.initialize(s),yield this.braintreeIntegrationService.getPaypalCheckout(h,e=>{this.renderPayPalButton(e,t,i,Boolean(d.testMode),Object.assign(Object.assign({},u),{height:40}))},e=>this.handleError(e,n,r))})}deinitialize(){return ot(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}signIn(e,t){return ot(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return ot(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}renderPayPalButton(e,t,i,n,r){const{container:a,onClick:s=lodash__WEBPACK_IMPORTED_MODULE_1__.noop}=t,{paypal:d}=this.braintreeHostWindow;let l=!1;d&&[d.FUNDING.PAYLATER,d.FUNDING.CREDIT].forEach(o=>{if(!l){const c=d.Buttons({env:n?\"sandbox\":\"production\",fundingSource:o,style:r,createOrder:()=>this.setupPayment(e,t,i),onApprove:n=>this.tokenizePayment(n,e,i,t),onClick:s});c.isEligible()&&(c.render(`#${a}`),l=!0)}}),d&&l||this.braintreeIntegrationService.removeElement(a)}setupPayment(e,t,i){var n;return ot(this,void 0,void 0,function*(){try{yield this.paymentIntegrationService.loadDefaultCheckout();const t=this.paymentIntegrationService.getState(),r=t.getCheckoutOrThrow().outstandingBalance,o=t.getCartOrThrow().currency.code,a=t.getCustomer(),s=t.getPaymentMethodOrThrow(i),d=null==a?void 0:a.addresses[0],l=d?this.braintreeIntegrationService.mapToBraintreeShippingAddressOverride(d):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:l,amount:r,currency:o,offerCredit:!0,intent:null===(n=s.initializationData)||void 0===n?void 0:n.intent})}catch(e){const{container:i,onError:n}=t;this.handleError(e,i,n)}})}tokenizePayment(e,t,i,n){return ot(this,void 0,void 0,function*(){try{const{deviceData:n}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),r=yield t.tokenizePayment(e),{details:o,nonce:a}=r,s=this.braintreeIntegrationService.mapToLegacyBillingAddress(o),d=this.braintreeIntegrationService.mapToLegacyShippingAddress(o);return this.formPoster.postForm(\"/checkout.php\",{payment_type:\"paypal\",provider:i,action:\"set_external_checkout\",nonce:a,device_data:n,billing_address:JSON.stringify(s),shipping_address:JSON.stringify(d)}),r}catch(e){const{container:t,onError:i}=n;this.handleError(e,t,i)}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!M(e))throw e;i(e)}}const st=L(t=>{const i=window,n=new F(t),r=new le(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),i);return new at(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),r,i)},[{id:\"braintreepaypalcredit\"}]);var dt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class lt{constructor(e,t){this.paymentIntegrationService=e,this.braintreeFastlaneUtils=t,this.isAcceleratedCheckoutEnabled=!1}initialize({methodId:e,braintreefastlane:t}){var i;return dt(this,void 0,void 0,function*(){if(!e)throw new V('Unable to proceed because \"methodId\" argument is not provided.');const n=yield this.getValidPaymentMethodOrThrow(e),{isAcceleratedCheckoutEnabled:r,isFastlaneStylingEnabled:o}=n.initializationData||{},a=o?null===(i=n.initializationData)||void 0===i?void 0:i.fastlaneStyles:void 0;this.isAcceleratedCheckoutEnabled=!!r;try{if(this.isAcceleratedCheckoutEnabled){const e=Me(a,null==t?void 0:t.styles);yield this.braintreeFastlaneUtils.initializeBraintreeFastlaneOrThrow(n.id,e)}}catch(e){}return Promise.resolve()})}deinitialize(){return dt(this,void 0,void 0,function*(){return Promise.resolve()})}signIn(e,t){return dt(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return dt(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){return dt(this,void 0,void 0,function*(){const{checkoutPaymentMethodExecuted:t,continueWithCheckoutCallback:i}=e||{};if(\"function\"!=typeof i)throw new V('Unable to proceed because \"continueWithCheckoutCallback\" argument is not provided and it must be a function.');const n=this.paymentIntegrationService.getState().getCustomerOrThrow();if(this.isAcceleratedCheckoutEnabled&&n.isGuest){const e=yield this.shouldRunAuthenticationFlow();t&&\"function\"==typeof t&&t(),e&&(yield this.braintreeFastlaneUtils.runPayPalAuthenticationFlowOrThrow(void 0,!0))}i()})}shouldRunAuthenticationFlow(){var e;return dt(this,void 0,void 0,function*(){const t=\"braintreeacceleratedcheckout\";try{yield this.paymentIntegrationService.loadPaymentMethod(t);const i=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t);return(null===(e=i.initializationData)||void 0===e?void 0:e.shouldRunAcceleratedCheckout)||!1}catch(e){return!1}})}getValidPaymentMethodOrThrow(e){return dt(this,void 0,void 0,function*(){let t=e;try{yield this.paymentIntegrationService.loadPaymentMethod(t)}catch(i){t=\"braintree\"===e?\"braintreeacceleratedcheckout\":\"braintree\",yield this.paymentIntegrationService.loadPaymentMethod(t)}return this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t)})}}const ct=L(t=>{const i=window,n=new F(t),r=new le(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),i),o=new je(t,r);return new lt(t,o)},[{id:\"braintreeacceleratedcheckout\"},{id:\"braintree\"}]);class ut extends p{constructor(e){super(e||\"Not implemented.\"),this.name=\"NotImplementedError\",this.type=\"not_implemented\"}}var ht=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class yt{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i,this.buttonClassName=\"visa-checkout-wrapper\",this.onError=lodash__WEBPACK_IMPORTED_MODULE_1__.noop}initialize(e){return ht(this,void 0,void 0,function*(){const{braintreevisacheckout:t,methodId:i}=e;if(!i)throw new V('Unable to proceed because \"methodId\" argument is not provided.');if(!t)throw new V('Unable to proceed because \"options.braintreevisacheckout\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(i);const n=this.paymentIntegrationService.getState(),r=n.getCheckoutOrThrow(),{clientToken:a,config:s}=n.getPaymentMethodOrThrow(i),d=n.getStoreConfigOrThrow();if(!a)throw new U(j.MissingPaymentMethod);this.braintreeSdk.initialize(a);const l=yield this.braintreeSdk.getBraintreeVisaCheckout(),c=yield this.braintreeSdk.getVisaCheckoutSdk(s.testMode),{container:u,onError:h}=t;this.onError=h||lodash__WEBPACK_IMPORTED_MODULE_1__.noop;const y=l.createInitOptions({paymentRequest:{currencyCode:d.currency.code,subtotal:String(r.subtotal)},settings:{locale:d.storeProfile.storeLanguage,shipping:{collectShipping:!0}}}),m=this.createSignInButton(u,this.buttonClassName);yield c.init(y),c.on(\"payment.success\",e=>this.tokenizePayment(l,e).then(()=>this.paymentIntegrationService.loadCheckout()).catch(e=>this.handleError(e))),c.on(\"payment.error\",(e,t)=>this.handleError(t)),m.style.visibility=\"visible\"})}deinitialize(){return ht(this,void 0,void 0,function*(){yield this.braintreeSdk.deinitialize()})}signIn(){throw new ut('In order to sign in via VisaCheckout, the shopper must click on \"Visa Checkout\" button.')}signOut(e){return ht(this,void 0,void 0,function*(){return yield this.paymentIntegrationService.signOutCustomer(e),Promise.resolve()})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}tokenizePayment(e,t){return ht(this,void 0,void 0,function*(){return Promise.all([e.tokenize(t),this.braintreeSdk.getDataCollectorOrThrow()]).then(([e,t])=>{const i=this.paymentIntegrationService.getState(),n=i.getShippingAddress(),r=i.getBillingAddress(),{shippingAddress:o=this.mapToVisaCheckoutAddress(n),billingAddress:a=this.mapToVisaCheckoutAddress(r)}=e;return this.postForm(Object.assign(Object.assign({},e),{shippingAddress:o,billingAddress:a}),t)})})}postForm(e,t){const{userData:i,billingAddress:n,shippingAddress:r,details:o}=e,{userEmail:a}=i,{deviceData:s}=t;return this.formPoster.postForm(\"/checkout.php\",{payment_type:e.type,nonce:e.nonce,provider:\"braintreevisacheckout\",action:\"set_external_checkout\",device_data:s,card_information:JSON.stringify({type:o.cardType,number:o.lastTwo}),billing_address:JSON.stringify(this.getAddress(a,n)),shipping_address:JSON.stringify(this.getAddress(a,r))})}mapToVisaCheckoutAddress(e){return e?{firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phone,streetAddress:e.address1,extendedAddress:e.address2,locality:e.city,region:e.stateOrProvinceCode,countryCode:e.countryCode,postalCode:e.postalCode}:{}}getAddress(e,t={}){return{email:e,first_name:t.firstName,last_name:t.lastName,phone_number:t.phoneNumber,address_line_1:t.streetAddress,address_line_2:t.extendedAddress,city:t.locality,state:t.region,country_code:t.countryCode,postal_code:t.postalCode}}createSignInButton(e,t){const i=document.querySelector(`#${e}`);if(!i)throw new Error(\"Unable to proceed because the provided container ID is not valid.\");return this.insertVisaCheckoutButton(i,t)}insertVisaCheckoutButton(e,t){const i=document.createElement(\"div\");return i.style.display=\"flex\",i.style.flexDirection=\"column\",i.style.visibility=\"hidden\",i.style.width=\"max-content\",i.className=t,i.innerHTML='\\n            <img\\n                alt=\"Visa Checkout\"\\n                class=\"v-button\"\\n                role=\"button\"\\n                src=\"https://secure.checkout.visa.com/wallet-services-web/xo/button.png?acceptCanadianVisaDebit=false&cobrand=true&height=34&width=178\"\\n                />\\n            <a class=\"v-learn v-learn-default\" style=\"text-align: right; display: block; font-size: 10px; color: #003366;\" href=\"#\" data-locale=\"en_US\">Tell Me More</a>',e.appendChild(i),i}handleError(e){if(\"function\"!=typeof this.onError)throw e;this.onError(e)}}const mt=L(t=>{const i=window,n=new F(t),r=new B(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n));return new yt(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),r)},[{id:\"braintreevisacheckout\"}]);class pt extends p{constructor(e){super(e||\"An unexpected error has occurred during buy now cart creation process. Please try again later.\"),this.name=\"BuyNowCartCreationError\",this.type=\"buy_now_cart_creation_error\"}}function gt(e){const{color:t,fundingicons:i,height:n=40,layout:o,shape:a,size:d,tagline:l}=e||{},c={color:t,fundingicons:i,height:vt(n),layout:o,shape:a||\"rect\",size:d,tagline:l};return (0,lodash__WEBPACK_IMPORTED_MODULE_1__.omitBy)(c,lodash__WEBPACK_IMPORTED_MODULE_1__.isNil)}function vt(e){const t=Number(e);return!t||Number.isNaN(t)?40:t>55?55:t<25?25:t}var ft=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class bt{constructor(e,t,i,n){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeHostWindow=n}initialize(e){return ft(this,void 0,void 0,function*(){const{braintreepaypal:t,containerId:i,methodId:n}=e;if(!n)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!i)throw new V('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!t)throw new V('Unable to initialize payment because \"options.braintreepaypal\" argument is not provided.');let r,o=this.paymentIntegrationService.getState();if(t.buyNowInitializeOptions){if(!t.currencyCode)throw new V('Unable to initialize payment because \"options.braintreepaypalcredit.currencyCode\" argument is not provided.');r=t.currencyCode}else yield this.paymentIntegrationService.loadDefaultCheckout(),o=this.paymentIntegrationService.getState(),r=o.getCartOrThrow().currency.code;const a=o.getPaymentMethodOrThrow(n),{clientToken:s,config:d,initializationData:l}=a;if(!s||!l)throw new U(j.MissingPaymentMethod);const c={currency:r,intent:l.intent,isCreditEnabled:l.isCreditEnabled,commit:!1};this.braintreeIntegrationService.initialize(s),yield this.braintreeIntegrationService.getPaypalCheckout(c,e=>{this.renderPayPalButton(e,t,i,n,!!d.testMode)},e=>this.handleError(e,i,t.onError))})}deinitialize(){return ft(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}renderPayPalButton(e,t,i,n,r){const{style:o,shouldProcessPayment:a,onAuthorizeError:s,onEligibilityFailure:d}=t,{paypal:l}=this.braintreeHostWindow;if(l){const c=l.Buttons({env:r?\"sandbox\":\"production\",fundingSource:l.FUNDING.PAYPAL,style:gt(o),createOrder:()=>this.setupPayment(e,t,n),onApprove:t=>this.tokenizePayment(t,e,n,a,s)});c.isEligible()?c.render(`#${i}`):d&&\"function\"==typeof d&&d()}else this.braintreeIntegrationService.removeElement(i)}setupPayment(e,t,i){var n;return ft(this,void 0,void 0,function*(){const{onPaymentError:r,shippingAddress:o,buyNowInitializeOptions:a}=t;try{const r=\"function\"==typeof(null==a?void 0:a.getBuyNowCartRequestBody)?yield this.createBuyNowCart(a.getBuyNowCartRequestBody()):void 0;this.buyNowCartId=null==r?void 0:r.id;const s=this.paymentIntegrationService.getState(),d=s.getCustomer(),l=s.getPaymentMethodOrThrow(i),c=r?r.cartAmount:s.getCartOrThrow().cartAmount,u=r?t.currencyCode:s.getCartOrThrow().currency.code,h=o||(null==d?void 0:d.addresses[0]),y=h?ve(h):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:y,amount:c,currency:u,offerCredit:!1,intent:null===(n=l.initializationData)||void 0===n?void 0:n.intent})}catch(e){throw r&&(M(e)||e instanceof p)&&r(e),e}})}tokenizePayment(e,t,i,n,r){return ft(this,void 0,void 0,function*(){try{const{deviceData:r}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),o=yield t.tokenizePayment(e),{details:a,nonce:s}=o,d=this.braintreeIntegrationService.mapToLegacyBillingAddress(a),l=this.braintreeIntegrationService.mapToLegacyShippingAddress(a);return this.formPoster.postForm(\"/checkout.php\",Object.assign({payment_type:\"paypal\",provider:i,action:n?\"process_payment\":\"set_external_checkout\",nonce:s,device_data:r,billing_address:JSON.stringify(d),shipping_address:JSON.stringify(l)},this.buyNowCartId&&{cart_id:this.buyNowCartId})),o}catch(e){throw r&&(M(e)||e instanceof p)&&r(e),e}})}createBuyNowCart(e){return ft(this,void 0,void 0,function*(){if(!e)throw new U(j.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(e)}catch(e){throw new pt}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!M(e))throw e;i(e)}}const wt=L(t=>{const i=window,n=new F(t),r=new le(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),i);return new bt(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),r,i)},[{id:\"braintreepaypal\"}]);var Ct=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class St{constructor(e,t,i,n,r){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeMessages=n,this.braintreeHostWindow=r}initialize(e){var t,i;return Ct(this,void 0,void 0,function*(){const{braintreepaypalcredit:n,containerId:r,methodId:o}=e;if(!o)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!r)throw new V('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!n)throw new V('Unable to initialize payment because \"options.braintreepaypalcredit\" argument is not provided.');let a,s=this.paymentIntegrationService.getState();if(n.buyNowInitializeOptions){if(!n.currencyCode)throw new V('Unable to initialize payment because \"options.braintreepaypalcredit.currencyCode\" argument is not provided.');a=n.currencyCode}else yield this.paymentIntegrationService.loadDefaultCheckout(),s=this.paymentIntegrationService.getState(),a=s.getCartOrThrow().currency.code;const d=s.getPaymentMethodOrThrow(o),{clientToken:l,config:c,initializationData:u}=d;if(!l||!u)throw new U(j.MissingPaymentMethod);const h={currency:a,intent:u.intent,isCreditEnabled:u.isCreditEnabled,commit:!1},y=x(null!==(i=null===(t=s.getStoreConfig())||void 0===t?void 0:t.checkoutSettings.features)&&void 0!==i?i:{},\"PAYPAL-5663.hide_braintree_card_banner_implementation_in_checkout_sdk\");this.braintreeIntegrationService.initialize(l),yield this.braintreeIntegrationService.getPaypalCheckout(h,e=>{!y&&n.messagingContainerId&&this.renderPayPalMessages(o,n.messagingContainerId),this.renderPayPalButton(e,n,r,o,!!c.testMode)},e=>this.handleError(e,r,n.onError))})}deinitialize(){return Ct(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}renderPayPalMessages(e,t){this.braintreeMessages.render(e,t,se.CART)}renderPayPalButton(e,t,i,n,r){const{style:o,shouldProcessPayment:a,onAuthorizeError:s,onEligibilityFailure:d}=t,{paypal:l}=this.braintreeHostWindow;let c=!1;l&&[l.FUNDING.PAYLATER,l.FUNDING.CREDIT].forEach(u=>{const h=u===l.FUNDING.CREDIT?Object.assign({label:oe.CREDIT},gt(o)):gt(o);if(!c){const o=l.Buttons({env:r?\"sandbox\":\"production\",fundingSource:u,style:h,createOrder:()=>this.setupPayment(e,t,n),onApprove:t=>this.tokenizePayment(t,e,n,a,s)});o.isEligible()?(o.render(`#${i}`),c=!0):l.FUNDING.CREDIT&&d&&\"function\"==typeof d&&d()}}),l&&c||this.braintreeIntegrationService.removeElement(i)}setupPayment(e,t,i){var n;return Ct(this,void 0,void 0,function*(){const{onPaymentError:r,shippingAddress:o,buyNowInitializeOptions:a}=t;try{const r=\"function\"==typeof(null==a?void 0:a.getBuyNowCartRequestBody)?yield this.createBuyNowCart(a.getBuyNowCartRequestBody()):void 0;this.buyNowCartId=null==r?void 0:r.id;const s=this.paymentIntegrationService.getState(),d=s.getCustomer(),l=s.getPaymentMethodOrThrow(i),c=r?r.cartAmount:s.getCartOrThrow().cartAmount,u=r?t.currencyCode:s.getCartOrThrow().currency.code,h=o||(null==d?void 0:d.addresses[0]),y=h?ve(h):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:y,amount:c,currency:u,offerCredit:!0,intent:null===(n=l.initializationData)||void 0===n?void 0:n.intent})}catch(e){throw r&&(M(e)||e instanceof p)&&r(e),e}})}tokenizePayment(e,t,i,n,r){return Ct(this,void 0,void 0,function*(){try{const{deviceData:r}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),o=yield t.tokenizePayment(e),{details:a,nonce:s}=o,d=this.braintreeIntegrationService.mapToLegacyBillingAddress(a),l=this.braintreeIntegrationService.mapToLegacyShippingAddress(a);return this.formPoster.postForm(\"/checkout.php\",Object.assign({payment_type:\"paypal\",provider:i,action:n?\"process_payment\":\"set_external_checkout\",nonce:s,device_data:r,billing_address:JSON.stringify(d),shipping_address:JSON.stringify(l)},this.buyNowCartId&&{cart_id:this.buyNowCartId})),o}catch(e){throw r&&(M(e)||e instanceof p)&&r(e),e}})}createBuyNowCart(e){return Ct(this,void 0,void 0,function*(){if(!e)throw new U(j.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(e)}catch(e){throw new pt}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!M(e))throw e;i(e)}}const Pt=L(t=>{const i=window,n=new F(t),r=new le(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n),i),o=new ce(t);return new St(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),r,o,i)},[{id:\"braintreepaypalcredit\"}]);var It=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Ot{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i}initialize(e){return It(this,void 0,void 0,function*(){const{containerId:t,methodId:i}=e;if(!i)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new V('Unable to initialize payment because \"options.containerId\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(i);const n=this.paymentIntegrationService.getState(),{clientToken:r,initializationData:o,config:a}=n.getPaymentMethodOrThrow(i);if(!r||!o)throw new U(j.MissingPaymentMethod);this.braintreeSdk.initialize(r);const s=yield this.braintreeSdk.getBraintreeVisaCheckout(),{currency:{code:d},cartAmount:l}=n.getCartOrThrow(),c=yield this.braintreeSdk.getVisaCheckoutSdk(a.testMode),u=s.createInitOptions({paymentRequest:{currencyCode:d,subtotal:String(l)},settings:{shipping:{collectShipping:!0}}});this.createSignInButton(t),yield c.init(u),c.on(\"payment.success\",e=>It(this,void 0,void 0,function*(){yield this.paymentSuccess(s,e)}))})}deinitialize(){return Promise.resolve()}paymentSuccess(e,t){return It(this,void 0,void 0,function*(){return Promise.all([e.tokenize(t),this.braintreeSdk.getDataCollectorOrThrow()]).then(([e,t])=>{const i=this.paymentIntegrationService.getState(),n=i.getShippingAddress(),r=i.getBillingAddress(),{shippingAddress:o=this.toVisaCheckoutAddress(n),billingAddress:a=this.toVisaCheckoutAddress(r)}=e;return this.postForm(Object.assign(Object.assign({},e),{shippingAddress:o,billingAddress:a}),t)})})}postForm(e,t){const{userData:i,billingAddress:n,shippingAddress:r,details:o}=e,{userEmail:a}=i,{deviceData:s}=t;return this.formPoster.postForm(\"/checkout.php\",{payment_type:e.type,nonce:e.nonce,provider:\"braintreevisacheckout\",action:\"set_external_checkout\",device_data:s,card_information:JSON.stringify({type:o.cardType,number:o.lastTwo}),billing_address:JSON.stringify(this.getAddress(a,n)),shipping_address:JSON.stringify(this.getAddress(a,r))})}toVisaCheckoutAddress(e){return e?{firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phone,streetAddress:e.address1,extendedAddress:e.address2,locality:e.city,region:e.stateOrProvinceCode,countryCode:e.countryCode,postalCode:e.postalCode}:{}}getAddress(e,t={}){return{email:e,first_name:t.firstName,last_name:t.lastName,phone_number:t.phoneNumber,address_line_1:t.streetAddress,address_line_2:t.extendedAddress,city:t.locality,state:t.region,country_code:t.countryCode,postal_code:t.postalCode}}createSignInButton(e){const t=document.querySelector(`#${e}`);if(!t)throw new Error(\"Need a container to place the button\");return this.insertVisaCheckoutButton(t)}insertVisaCheckoutButton(e){const t=document.createElement(\"div\");return t.style.display=\"flex\",t.style.flexDirection=\"column\",t.style.alignItems=\"flex-end\",t.innerHTML='\\n            <img\\n                alt=\"Visa Checkout\"\\n                class=\"v-button\"\\n                role=\"button\"\\n                src=\"https://secure.checkout.visa.com/wallet-services-web/xo/button.png?acceptCanadianVisaDebit=false&cobrand=true&height=34&width=178\"\\n                />\\n            <a class=\"v-learn v-learn-default\" style=\"text-align: right; display: block; font-size: 10px; color: #003366;\" href=\"#\" data-locale=\"en_US\">Tell Me More</a>',e.appendChild(t),t}}const kt=L(t=>{const i=window,n=new F(t),r=new B(new z((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),i,n));return new Ot(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),r)},[{id:\"braintreevisacheckout\"}]);function Et(e){const{billingAddress:t,email:i,firstName:n,lastName:r,phone:o,shippingAddress:a}=e,s=t||a;return{email:i,first_name:n,last_name:r,phone_number:o,address_line_1:null==s?void 0:s.line1,address_line_2:null==s?void 0:s.line2,city:null==s?void 0:s.city,state:null==s?void 0:s.state,country_code:null==s?void 0:s.countryCode,postal_code:null==s?void 0:s.postalCode}}function Tt(e){const{email:t,phone:i,shippingAddress:n}=e,r=(null==n?void 0:n.recipientName)||\"\",[o,a]=r.split(\" \");return{email:t,first_name:o||\"\",last_name:a||\"\",phone_number:i,address_line_1:null==n?void 0:n.line1,address_line_2:null==n?void 0:n.line2,city:null==n?void 0:n.city,state:null==n?void 0:n.state,country_code:null==n?void 0:n.countryCode,postal_code:null==n?void 0:n.postalCode}}var At=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};const zt=e=>{const{color:t,height:i}=e;return{backgroundColor:(n=t||\"\",n===re.WHITE?\"#FFFFFF\":\"#3D95CE\"),backgroundPosition:\"50% 50%\",backgroundSize:\"80px auto\",backgroundImage:`url(\"/app/assets/img/payment-providers/venmo-logo-${t===re.WHITE?re.BLUE:re.WHITE}.svg\")`,backgroundRepeat:\"no-repeat\",borderRadius:\"4px\",cursor:\"pointer\",transition:\"0.2s ease\",minHeight:`${i||40}px`,minWidth:\"150px\",height:\"100%\",width:\"100%\",border:t===re.WHITE?\"1px solid black\":\"none\"};// removed by dead control flow\n var n; };class Nt{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i,this.onError=lodash__WEBPACK_IMPORTED_MODULE_1__.noop}initialize(e){return At(this,void 0,void 0,function*(){const{braintreevenmo:t,containerId:i,methodId:n}=e;if(!n)throw new V('Unable to initialize payment because \"options.methodId\" argument is not provided.');const r=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(n),{clientToken:o,initializationData:a}=r,{paymentButtonStyles:s}=a,{cartButtonStyles:d}=s||{},l=(null==t?void 0:t.style)||d;if(!o||!a)throw new U(j.MissingPaymentMethod);if(!i)throw new V('Unable to initialize payment because \"options.containerId\" argument is not provided.');yield this.paymentIntegrationService.loadDefaultCheckout(),this.onError=(null==t?void 0:t.onError)||this.handleError,this.braintreeSdk.initialize(o);try{const e=yield this.braintreeSdk.getVenmoCheckoutOrThrow();this.renderVenmoButton(e,i,null==t?void 0:t.buyNowInitializeOptions,l)}catch(e){(ge(e)||function(e){return e instanceof N}(e))&&this.handleInitializationVenmoError(e,i)}})}deinitialize(){return At(this,void 0,void 0,function*(){return yield this.braintreeSdk.deinitialize(),Promise.resolve()})}handleError(e){throw new Error(e.message)}createBuyNowCart(e){return At(this,void 0,void 0,function*(){if(\"function\"==typeof(null==e?void 0:e.getBuyNowCartRequestBody)){const t=null==e?void 0:e.getBuyNowCartRequestBody();if(!t)throw new U(j.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(t)}catch(e){throw new pt}}})}handleInitializationVenmoError(e,t){return this.removeVenmoContainer(t),this.onError(e)}removeVenmoContainer(e){const t=document.getElementById(e);t&&t.remove()}renderVenmoButton(e,t,i,n){const r=document.getElementById(t),{color:o}=n||{};if(!r)throw new V(\"Unable to create wallet button without valid container ID.\");r.setAttribute(\"aria-label\",\"Venmo\"),Object.assign(r.style,zt(n||{})),r.addEventListener(\"click\",()=>At(this,void 0,void 0,function*(){r.setAttribute(\"disabled\",\"true\");const t=yield this.createBuyNowCart(i);e.tokenize&&e.tokenize((e,i)=>At(this,void 0,void 0,function*(){r.removeAttribute(\"disabled\"),e&&this.onError(e),yield this.handlePostForm(i,null==t?void 0:t.id)}))})),o===re.BLUE&&(r.addEventListener(\"mouseenter\",()=>{r.style.backgroundColor=\"#0a7fc2\"}),r.addEventListener(\"mouseleave\",()=>{r.style.backgroundColor=zt(n||{}).backgroundColor}))}handlePostForm(e,t){return At(this,void 0,void 0,function*(){const{deviceData:i}=yield this.braintreeSdk.getDataCollectorOrThrow(),{nonce:n,details:r}=e;this.formPoster.postForm(\"/checkout.php\",Object.assign({nonce:n,provider:\"braintreevenmo\",payment_type:\"paypal\",device_data:i,action:\"set_external_checkout\",billing_address:JSON.stringify(Et(r)),shipping_address:JSON.stringify(Tt(r))},t&&{cart_id:t}))})}}const Dt=L(t=>{const i=window,n=(0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_0__.getScriptLoader)(),r=new F(t),o=new z(n,i,r),a=new B(o);return new Nt(t,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_4__.createFormPoster)(),a)},[{id:\"braintreevenmo\"}]);\n//# sourceMappingURL=braintree.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vY2hlY2tvdXQtc2RrLWpzL2Rpc3QvZXNtL2ludGVncmF0aW9ucy9icmFpbnRyZWUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNXLFVBQVUsc0JBQXNCLGVBQWUsTUFBTSx1VEFBdVQsa0JBQWtCLGVBQWUsK01BQStNLGFBQWEsOENBQThDLFNBQVMsZUFBZSxvVUFBb1UsU0FBUyxlQUFlLGdNQUFnTSxTQUFTLEdBQUcsNkNBQTZDLEtBQUssa2pDQUFrakMsTUFBTSxrakNBQWtqQyxNQUFNLG9qQ0FBb2pDLHdDQUF3Qyx5Q0FBeUMsY0FBYyxJQUFJLGFBQWEsU0FBUyxNQUFNLGNBQWMsSUFBSSxjQUFjLFNBQVMsTUFBTSxjQUFjLE1BQU0sZ0VBQWdFLEtBQUssYUFBYSwrQkFBK0IsR0FBRyxRQUFRLG1CQUFtQixpRkFBaUYsYUFBYSx3Q0FBd0MsaUVBQWlFLEVBQUUsZUFBZSx3Q0FBd0MscUVBQXFFLEVBQUUscUJBQXFCLHdDQUF3QyxrRkFBa0YsRUFBRSxhQUFhLHdDQUF3QyxpRUFBaUUsRUFBRSxtQkFBbUIsd0NBQXdDLDhFQUE4RSxFQUFFLG9CQUFvQix3Q0FBd0MsZ0ZBQWdGLEVBQUUsb0JBQW9CLHdDQUF3QyxpRkFBaUYsRUFBRSxvQkFBb0Isd0NBQXdDLGdGQUFnRixFQUFFLFVBQVUsd0NBQXdDLCtFQUErRSxFQUFFLG1CQUFtQiw4RUFBOEUsb0JBQW9CLCtEQUErRCxtQkFBbUIsd0NBQXdDLDhFQUE4RSxFQUFFLHVCQUF1Qix3Q0FBd0MsZ0VBQWdFLDhKQUE4Six5Q0FBeUMsZ0JBQWdCLHFGQUFxRixxQkFBcUIscUNBQXFDLFlBQVksMkNBQTJDLGtDQUFrQyxFQUFFLEVBQUUsZ0NBQWdDLHdDQUF3QyxpQ0FBaUMsY0FBYywyRkFBMkYsRUFBRSxNQUFNLEVBQUUsMkRBQTJELDJDQUEyQyxxQkFBcUIscUNBQXFDLHFEQUFxRCxTQUFTLEVBQUUsc0JBQXNCLE1BQU0sNkVBQTZFLG9DQUFvQyxnQkFBZ0IsbURBQW1ELFVB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QUssYUFBYSwrQkFBK0IsR0FBRyxhQUFhLE1BQU0saUJBQWlCLEdBQUcsT0FBTyx3TEFBd0wsOEJBQThCLDZHQUE2RyxNQUFNLDhGQUE4RjtBQUFBLFFBQUssRUFBRSxTQUFTLG1CQUFtQixvRkFBb0Ysd0NBQUMsQ0FBQyxjQUFjLHlDQUF5QyxNQUFNLDBDQUEwQyxHQUFHLHVHQUF1Ryw4RUFBOEUsbUNBQW1DLElBQUksc0JBQXNCLElBQUksbUJBQW1CLE1BQU0sK0JBQStCLDhDQUE4QywwR0FBMEcscUpBQXFKLElBQUksMERBQTBELHVFQUF1RSxTQUFTLG9CQUFvQixzQkFBc0IsZ0RBQWdELEVBQUUsZUFBZSx5Q0FBeUMsZ0VBQWdFLEVBQUUsZUFBZSwyQkFBMkIsb0JBQW9CLHlDQUF5QyxrRUFBa0Usb0RBQW9ELGlDQUFpQyxJQUFJLGdFQUFnRSxTQUFTLGVBQWUsRUFBRSxvQ0FBb0Msb0RBQW9ELHdCQUF3QixtQ0FBbUMsY0FBYywyQkFBMkIsb0NBQW9DLFFBQVEsT0FBTyxnRkFBZ0YsbUVBQW1FLG9FQUFvRSxrQ0FBa0MsdUNBQXVDLGdFQUFnRSxrR0FBa0csR0FBRyxzREFBc0Qsa0NBQWtDLHVDQUF1QyxnQ0FBZ0Msa0JBQWtCLEdBQUcsb0JBQW9CLHlDQUF5QyxNQUFNLGFBQWEsb0RBQW9ELGtCQUFrQixHQUFHLHdEQUF3RCxrTEFBa0wsS0FBSyxVQUFVLEdBQUcsR0FBRyxlQUFlLGlCQUFpQiwyRUFBQyx3Q0FBd0MsZ0JBQWdCLDBFQUFDLE1BQU0sR0FBRyxvQkFBb0IsR0FBc3JCO0FBQ3ZvNkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jaGVja291dC8uLi9jaGVja291dC1zZGstanMvZGlzdC9lc20vaW50ZWdyYXRpb25zL2JyYWludHJlZS5qcz9iOTM1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydHtnZXRTY3JpcHRMb2FkZXIgYXMgZX1mcm9tXCJAYmlnY29tbWVyY2Uvc2NyaXB0LWxvYWRlclwiO2ltcG9ydHtmaW5kIGFzIHQsaXNFbXB0eSBhcyBpLGlzRXF1YWwgYXMgbixpc05pbCBhcyByLG5vb3AgYXMgbyxvbWl0IGFzIGEsb21pdEJ5IGFzIHMsc29tZSBhcyBkfWZyb21cImxvZGFzaFwiO2ltcG9ydHtzdXBwb3J0c1BvcHVwcyBhcyBsfWZyb21cIkBicmFpbnRyZWUvYnJvd3Nlci1kZXRlY3Rpb25cIjtpbXBvcnR7Y3JlYXRlUmVxdWVzdFNlbmRlciBhcyBjfWZyb21cIkBiaWdjb21tZXJjZS9yZXF1ZXN0LXNlbmRlclwiO2ltcG9ydHtjcmVhdGVGb3JtUG9zdGVyIGFzIHV9ZnJvbVwiQGJpZ2NvbW1lcmNlL2Zvcm0tcG9zdGVyXCI7dmFyIGgseSxtO2NsYXNzIHAgZXh0ZW5kcyBFcnJvcntjb25zdHJ1Y3RvcihlKXt2YXIgdDtzdXBlcihlfHxcIkFuIHVuZXhwZWN0ZWQgZXJyb3IgaGFzIG9jY3VycmVkLlwiKSx0aGlzLm5hbWU9XCJTdGFuZGFyZEVycm9yXCIsdGhpcy50eXBlPVwic3RhbmRhcmRcIix0PW5ldy50YXJnZXQucHJvdG90eXBlLE9iamVjdC5zZXRQcm90b3R5cGVPZj9PYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyx0KTp0aGlzLl9fcHJvdG9fXz10LFwiZnVuY3Rpb25cIj09dHlwZW9mIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlP0Vycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsbmV3LnRhcmdldCk6dGhpcy5zdGFjaz1uZXcgRXJyb3IodGhpcy5tZXNzYWdlKS5zdGFja319Y2xhc3MgZyBleHRlbmRzIHB7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBjbGllbnQgbGlicmFyeSBvZiBhIHBheW1lbnQgbWV0aG9kIGlzIG5vdCBsb2FkZWQgb3IgcmVhZHkgdG8gYmUgdXNlZC5cIiksdGhpcy5uYW1lPVwiUGF5bWVudE1ldGhvZENsaWVudFVuYXZhaWxhYmxlRXJyb3JcIix0aGlzLnR5cGU9XCJwYXltZW50X21ldGhvZF9jbGllbnRfdW5hdmFpbGFibGVcIn19IWZ1bmN0aW9uKGUpe2UuU2FuZGJveD1cInNhbmRib3hcIixlLlByb2R1Y3Rpb249XCJwcm9kdWN0aW9uXCJ9KGh8fChoPXt9KSksZnVuY3Rpb24oZSl7ZS5DbGllbnQ9XCJjbGllbnRcIixlLkRhdGFDb2xsZWN0b3I9XCJkYXRhQ29sbGVjdG9yXCIsZS5GYXN0bGFuZT1cImZhc3RsYW5lXCIsZS5Hb29nbGVQYXltZW50PVwiZ29vZ2xlUGF5bWVudFwiLGUuSG9zdGVkRmllbGRzPVwiaG9zdGVkRmllbGRzXCIsZS5Mb2NhbFBheW1lbnQ9XCJsb2NhbFBheW1lbnRcIixlLlBheXBhbD1cInBheXBhbFwiLGUuUGF5cGFsQ2hlY2tvdXQ9XCJwYXlwYWxDaGVja291dFwiLGUuVGhyZWVEU2VjdXJlPVwidGhyZWVEU2VjdXJlXCIsZS5Vc0JhbmtBY2NvdW50PVwidXNCYW5rQWNjb3VudFwiLGUuVmVubW89XCJ2ZW5tb1wiLGUuVmlzYUNoZWNrb3V0PVwidmlzYUNoZWNrb3V0XCJ9KHl8fCh5PXt9KSksZnVuY3Rpb24oZSl7ZS5DYXJkQ29kZT1cImNhcmRDb2RlXCIsZS5DYXJkQ29kZVZlcmlmaWNhdGlvbj1cImNhcmRDb2RlVmVyaWZpY2F0aW9uXCIsZS5DYXJkRXhwaXJ5PVwiY2FyZEV4cGlyeVwiLGUuQ2FyZE5hbWU9XCJjYXJkTmFtZVwiLGUuQ2FyZE51bWJlcj1cImNhcmROdW1iZXJcIixlLkNhcmROdW1iZXJWZXJpZmljYXRpb249XCJjYXJkTnVtYmVyVmVyaWZpY2F0aW9uXCJ9KG18fChtPXt9KSk7Y29uc3Qgdj1cIjMuMTI4LjBcIixmPVwiMy4xMjMuMlwiLGI9XCIzLjEwNi4wXCIsdz17W2JdOntbeS5DbGllbnRdOlwic2hhMzg0LTI2QlhETm5KSTIzSllSeUZCajR4ZTRzVk5yVVNTaVNTdTExa3hWWE5NL3ZFUE9ObTRMdUwwMHc2WmFUZ1Fld3RcIixbeS5QYXlwYWxDaGVja291dF06XCJzaGEzODQtQit2emJad25RdHpXQnRocGtUNFRYS1VpYk82NXR5ZUs3ZUN4U3ZwYmxncHJUZXAyK0lBWEIyQ3h4anJuNzEwT1wiLFt5LlBheXBhbF06XCJzaGEzODQtdXlBR0wxLzMrWEpBSG5Hb055NGVDb1hkeko0ZjdJbHpwKzZ3OVBObkVqczZEQ0N6OVdNeUpqTU4xZ3pjNzhVK1wiLFt5LkxvY2FsUGF5bWVudF06XCJzaGEzODQtTEl2T0VNa0lWRXdWdVlCZFZPUWMxQUM1WWJHR2x3eWZVaGVTMEFDSzIxOEQyU1R1VllRbFo0RnlFUG93QUVmVFwiLFt5LkRhdGFDb2xsZWN0b3JdOlwic2hhMzg0LTFibzlKRHorS3NjdGhjMDg1Y0NLV3VyOENMd1VvQnBvTnl4c0RpNzkzMm1DbDB6RnEzQTVtditGUUx3OUdIcFZcIixbeS5Vc0JhbmtBY2NvdW50XTpcInNoYTM4NC14bUhCVmFVK3c3NFYrT2ViRDNBYVBPTkZ4SFVHTWYrUVJzOEcvSnhWUFhOTlA3TURhMmpMMElDV0hJZTJ0VGZKXCIsW3kuR29vZ2xlUGF5bWVudF06XCJzaGEzODQtV0tESmw4bXFvUDgycVpwTUdINkFiWnhudlhuU1c4SUxWNE02NEN5TUxpdWdHTXd1N0x5UDg5d2pDa0hxc2lCZVwiLFt5LlRocmVlRFNlY3VyZV06XCJzaGEzODQtVlFVbHBHSHpzR3ZzNVhlaUdGaXA3RVhSc3ZvSFdFWERWbWdDYWNmYnlpZVpJOW1kQk9xcTNOU295bzI4T0NPQlwiLFt5LlZpc2FDaGVja291dF06XCJzaGEzODQteXg3bUFEZnpUTjBUNDNRNnJsSDQ5TElnMUVKMGlVWmdCcC9FY3pYOUxYc1VHa3lTZ3hyRCtuV0hRUkJreWZvVFwiLFt5LlZlbm1vXTpcInNoYTM4NC1RWDRyUGpvajFaRGh1RzBhU3lLczU2bEVLRHFUTVRjall4VUhZMVN6TzVWWkRzcUlFMk5Ua3FvdDdLTlNDeW92XCIsW3kuSG9zdGVkRmllbGRzXTpcInNoYTM4NC1WdllCQUNmU3UwQ3IvSjMydUtteEc3QVhjTk9KRTFBeklJTDNrYmlreVM3WUtwNWZ6NUlzK056TlAvbHlhdU55XCIsW3kuRmFzdGxhbmVdOlwic2hhMzg0LTlvR3NaTVJad3BHdERFRFlhL2RGdDc2ZEVDcWoxeEFuaTlnSUtnYzNLZk1JaVJuUjczbkVlZVVETGlCenhoRmFcIn0sW2ZdOntbeS5DbGllbnRdOlwic2hhMzg0LW8rbmJRR2N3Tk54SUJlWGV1MytYbWJTcStDZzhSM0VOM04wbDVoWENnTU1VMlJHWTB0MXowTHJvU0VJQWJmQU9cIixbeS5QYXlwYWxDaGVja291dF06XCJzaGEzODQtV3JmYldQQlM0bUg4NkdBb3ljUFNnaUg4aFE4S0g3QTY3QzkzSGpodW52L3hoTmsyWXBCbjN3YkZBNEZoZzlVL1wiLFt5LlBheXBhbF06XCJzaGEzODQtVkYzODludnZyUlVnRHNUWE14VFlPUkR0VmVnQjlJUWEzQ3hyLy9EeUpuTFluejgvWDhWQ3pFdmNrMmMrTWVndFwiLFt5LkxvY2FsUGF5bWVudF06XCJzaGEzODQtdFpLeDJyRVFiZm1acG9QU1k1VlBtSkVoYXE0WDc1ZEx2d0hNczNWRTlVK0M4bFB5dytoV1RJTDErR1B2V0NJSFwiLFt5LkRhdGFDb2xsZWN0b3JdOlwic2hhMzg0LUU2azN3T3BQN3N5Q0REd2FSRExGMDY5NDJZMDBOa2J3SnZXaTJPUVh3d0t6R3dHNWZkM0U3UkZVdkNDZWNmdk9cIixbeS5Vc0JhbmtBY2NvdW50XTpcInNoYTM4NC0yNThGT044TFpHRzBXOVFhejRKaWo4M3BaSHUzMFluS2pKQTdnTnVsTEJoNkNjbGt1Y2dGK3RIRFF1WUZSWWZXXCIsW3kuR29vZ2xlUGF5bWVudF06XCJzaGEzODQtdGFKMnAvMCtuMFZIMzI4UE9Bb0JpdUViTDN0bkhVVEU5UzQyaEsxVitUeHMzWCtRWWpaT3lLVzM1SmdIUkZmT1wiLFt5LlRocmVlRFNlY3VyZV06XCJzaGEzODQtK05TWkg0Wmozc081YmRXdlBLaFU1TjE2UUR4ZXVlVFZUblVWZWxlZUVTa2hMU2F6NE9iMWhoLzVteWVjYzlZbVwiLFt5LlZpc2FDaGVja291dF06XCJzaGEzODQtNjZEaUJqZ2h4azFPbUJqOGFrc044Z2JRK0N3b1FjeDF2UGZpWFVOMDhnMWlRVk0rQndld0YwcDd0b00zaTdTU1wiLFt5LlZlbm1vXTpcInNoYTM4NC1CNVV3WTQya0U0Um9Mb1diUTdZcHFvc1VsVWFkMi9EbEdXaXcwSGhvWmJTUGszMENRQWFTQTEwb2h5TERUa0RVXCIsW3kuSG9zdGVkRmllbGRzXTpcInNoYTM4NC1BdzlFZXNTYVVlV3hlMzZQcUVIaU95T3lPcThNNkNJYjFndzcveUhOVlBSekd0RlhYY2QyT1E4cVhySWxPajJQXCIsW3kuRmFzdGxhbmVdOlwic2hhMzg0LXJoQkwxaHBaNzFKcUcrMlRzVDBEaWg0N21iang4Y2pKQ3BlWmprOXR3M2RmMWdGTUtmQ1RtTXladW5ocjdINFlcIn0sW3ZdOntbeS5DbGllbnRdOlwic2hhMzg0LTBXTnhrc0lwUlArZllaaUlkcjEyZzZEQlVRZkxEellDUUpadFIvQzhLa2N3U0doUEhmY0ZwM3RUYUdjTXlGVHFcIixbeS5QYXlwYWxDaGVja291dF06XCJzaGEzODQtbFdNMWprNEJPeG9ETlY2S29wN3RWTnZRZ0lObG1FVnowYy9Pd00rSE5ISzNRQzh4cXdkNTRPdnJ0MlFSRFRqaFwiLFt5LlBheXBhbF06XCJzaGEzODQtZlhVbVZ4QzJFTVpCRFhaN2VUSFNUTC9MRkJySGVqL01TWFQvdlRCWHZyYTRsemdMTkd2UkVBcCt4MEdZT2J1SFwiLFt5LkxvY2FsUGF5bWVudF06XCJzaGEzODQtcGhhMXhHdUdTa21aSDV4OWFxSHZSYU80eExlYTdybVEvNzlQRmo5enhOenh1RmNPV1pnN2dPUDdGaWJ5Z09FQ1wiLFt5LkRhdGFDb2xsZWN0b3JdOlwic2hhMzg0LVE2UEkyRjllZWtXYkF4aHJveWJsK2FFY3ZxaGRvd04vRVFsR3dCVXlKT3pQRm45OTgydTl4bDZTVTZYZkdLemNcIixbeS5Vc0JhbmtBY2NvdW50XTpcInNoYTM4NC1XM1JMUVNLSkwxdFEzK1k3bVA2dG1rYW10WjhiVjRZdy9YeEw5Smo1SnRYSHJhRDhsb01GOGhBSUc1bTJ6SzdGXCIsW3kuR29vZ2xlUGF5bWVudF06XCJzaGEzODQtVElUUU1zRldBM2VsRE5HUDJtV3oyb0tCbzRxanQrVGxxem92Y2FQb2VCaUFoL3dQQmk2bmFlNTBBRGRnVTEvaVwiLFt5LlRocmVlRFNlY3VyZV06XCJzaGEzODQtWWl5Y1lOODlabEwvRXZjYXE0eTFhalcxbWhkN0pZZlpCRHVPd0h0SW40L0pubTIwR0wrL1hDTSt6WUF3V0Q4RFwiLFt5LlZpc2FDaGVja291dF06XCJzaGEzODQtL09kYVR2OXFya0t6ak9idFVlNnl6ZkRoSG96RlcvK3VYbHJTbDczNnNPWlJKcGpHUUVUdnBZWHFNRkZnNjl4dlwiLFt5LlZlbm1vXTpcInNoYTM4NC1kQStvamRXOXZiSlM0SmF2Y1h5T3M5ZDV1WkhKZzVkTnRZdXBvUFNIMnpzWElpWURWUzVhbUxiL3U4cW1RNm96XCIsW3kuSG9zdGVkRmllbGRzXTpcInNoYTM4NC0zMVprUzU4K2lhV3NXMDZmdFc1Mnp6VlpGcDQzV1BkN3BOWVJpZGRZeW5TTmc2T2g3V0diU0ZHb3JBVUg2VDF6XCIsW3kuRmFzdGxhbmVdOlwic2hhMzg0LWpsYnJ3TnZMM0h2TEFVQ3RMU21yblEyR0gxdWRDVXJSUy9iVm1SZUFTNWZ1SVZ2Y1c4UGtvL0drZzgydGxndHJcIn19O3ZhciBDLFMsUCxJLE8sayxFLFQsQT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyB6e2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnNjcmlwdExvYWRlcj1lLHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdz10LHRoaXMuYnJhaW50cmVlU0RLVmVyc2lvbk1hbmFnZXI9aX1sb2FkQ2xpZW50KCl7cmV0dXJuIEEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHkuQ2xpZW50LFwiY2xpZW50Lm1pbi5qc1wiKX0pfWxvYWRGYXN0bGFuZSgpe3JldHVybiBBKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyh5LkZhc3RsYW5lLFwiZmFzdGxhbmUubWluLmpzXCIpfSl9bG9hZFBheXBhbENoZWNrb3V0KCl7cmV0dXJuIEEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHkuUGF5cGFsQ2hlY2tvdXQsXCJwYXlwYWwtY2hlY2tvdXQubWluLmpzXCIpfSl9bG9hZFBheXBhbCgpe3JldHVybiBBKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyh5LlBheXBhbCxcInBheXBhbC5taW4uanNcIil9KX1sb2FkTG9jYWxQYXltZW50KCl7cmV0dXJuIEEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHkuTG9jYWxQYXltZW50LFwibG9jYWwtcGF5bWVudC5taW4uanNcIil9KX1sb2FkRGF0YUNvbGxlY3Rvcigpe3JldHVybiBBKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyh5LkRhdGFDb2xsZWN0b3IsXCJkYXRhLWNvbGxlY3Rvci5taW4uanNcIil9KX1sb2FkVXNCYW5rQWNjb3VudCgpe3JldHVybiBBKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyh5LlVzQmFua0FjY291bnQsXCJ1cy1iYW5rLWFjY291bnQubWluLmpzXCIpfSl9bG9hZEdvb2dsZVBheW1lbnQoKXtyZXR1cm4gQSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coeS5Hb29nbGVQYXltZW50LFwiZ29vZ2xlLXBheW1lbnQubWluLmpzXCIpfSl9bG9hZDNEUygpe3JldHVybiBBKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyh5LlRocmVlRFNlY3VyZSxcInRocmVlLWQtc2VjdXJlLm1pbi5qc1wiKX0pfWxvYWRWaXNhQ2hlY2tvdXQoKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyh5LlZpc2FDaGVja291dCxcInZpc2EtY2hlY2tvdXQubWluLmpzXCIpfWxvYWRWZW5tb0NoZWNrb3V0KCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coeS5WZW5tbyxcInZlbm1vLm1pbi5qc1wiKX1sb2FkSG9zdGVkRmllbGRzKCl7cmV0dXJuIEEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHkuSG9zdGVkRmllbGRzLFwiaG9zdGVkLWZpZWxkcy5taW4uanNcIil9KX1sb2FkVmlzYUNoZWNrb3V0U2RrKGUpe3JldHVybiBBKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZih0aGlzLmJyYWludHJlZUhvc3RXaW5kb3cuVilyZXR1cm4gdGhpcy5icmFpbnRyZWVIb3N0V2luZG93LlY7Y29uc3QgdD1lP1wic2hhMzg0LTBldTFzMUd0cXpYbEw5RHRMZ213ekM1V1dsRUgvQURSTTBuMzhjVlFrdnRUK1cvZ2V5OTZyY2IxTHd1VU9QRG1cIjpcInNoYTM4NC0xZjFjc3ZQM1pGeGc0ZElMSDFHYVk0TEhsWjBvWDdSazgzcnhtTGx3Ym5JaTRUTTBOWXpYb2V2MVZvRWlWRFM2XCI7cmV0dXJuIHRoaXMuc2NyaXB0TG9hZGVyLmxvYWRTY3JpcHQoYC8vJHtlP1wic2FuZGJveC1cIjpcIlwifWFzc2V0cy5zZWN1cmUuY2hlY2tvdXQudmlzYS5jb20vY2hlY2tvdXQtd2lkZ2V0L3Jlc291cmNlcy9qcy9pbnRlZ3JhdGlvbi92MS9zZGsuanNgLHthc3luYzohMCxhdHRyaWJ1dGVzOntpbnRlZ3JpdHk6dCxjcm9zc29yaWdpbjpcImFub255bW91c1wifX0pLnRoZW4oKCk9PntpZighdGhpcy5icmFpbnRyZWVIb3N0V2luZG93LlYpdGhyb3cgbmV3IGc7cmV0dXJuIHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5WfSl9KX1sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyhlLHQpe3JldHVybiBBKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtsZXQgaT10aGlzLmdldEJyYWludHJlZU1vZHVsZShlKTtpZihpKXJldHVybiBpO2NvbnN0IG49dGhpcy5icmFpbnRyZWVTREtWZXJzaW9uTWFuYWdlci5nZXRTREtWZXJzaW9uKCkscj1gLy9qcy5icmFpbnRyZWVnYXRld2F5LmNvbS93ZWIvJHtufS9qcy8ke3R9YCxvPW4gaW4gdz90aGlzLmdldEludGVncml0eVZhbHVlc0J5TW9kdWxlTmFtZShlLG4pOnZvaWQgMDtpZih5aWVsZCB0aGlzLnNjcmlwdExvYWRlci5sb2FkU2NyaXB0KHIsbz97YXN5bmM6ITAsYXR0cmlidXRlczp7aW50ZWdyaXR5Om8sY3Jvc3NvcmlnaW46XCJhbm9ueW1vdXNcIn19OnZvaWQgMCksaT10aGlzLmdldEJyYWludHJlZU1vZHVsZShlKSwhaSl0aHJvdyBuZXcgZztyZXR1cm4gaX0pfWdldEJyYWludHJlZU1vZHVsZShlKXt2YXIgdDtyZXR1cm4gbnVsbD09PSh0PXRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5icmFpbnRyZWUpfHx2b2lkIDA9PT10P3ZvaWQgMDp0W2VdfWdldEludGVncml0eVZhbHVlc0J5TW9kdWxlTmFtZShlLHQpe2NvbnN0IGk9d1t0XVtlXTtpZighaSl0aHJvdyBuZXcgRXJyb3IoXCJVbmV4cGVjdGVkIGZpbGVOYW1lIHZhbHVlXCIpO3JldHVybiBpfX1jbGFzcyBOIGV4dGVuZHMgcHtjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIlVuc3VwcG9ydGVkIGJyb3dzZXIgZXJyb3JcIiksdGhpcy5uYW1lPVwiVW5zdXBwb3J0ZWRCcm93c2VyRXJyb3JcIix0aGlzLnR5cGU9XCJ1bnN1cHBvcnRlZF9icm93c2VyXCJ9fSFmdW5jdGlvbihlKXtlW2UuQ2hlY2tvdXRCdXR0b25Ob3RJbml0aWFsaXplZD0wXT1cIkNoZWNrb3V0QnV0dG9uTm90SW5pdGlhbGl6ZWRcIixlW2UuQ3VzdG9tZXJOb3RJbml0aWFsaXplZD0xXT1cIkN1c3RvbWVyTm90SW5pdGlhbGl6ZWRcIixlW2UuUGF5bWVudE5vdEluaXRpYWxpemVkPTJdPVwiUGF5bWVudE5vdEluaXRpYWxpemVkXCIsZVtlLlNoaXBwaW5nTm90SW5pdGlhbGl6ZWQ9M109XCJTaGlwcGluZ05vdEluaXRpYWxpemVkXCIsZVtlLlNwYW1Qcm90ZWN0aW9uTm90SW5pdGlhbGl6ZWQ9NF09XCJTcGFtUHJvdGVjdGlvbk5vdEluaXRpYWxpemVkXCJ9KEN8fChDPXt9KSk7Y2xhc3MgRCBleHRlbmRzIHB7Y29uc3RydWN0b3IoZSl7c3VwZXIoZnVuY3Rpb24oZSl7c3dpdGNoKGUpe2Nhc2UgQy5DdXN0b21lck5vdEluaXRpYWxpemVkOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgY3VzdG9tZXIgc3RlcCBvZiBjaGVja291dCBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCI7Y2FzZSBDLlBheW1lbnROb3RJbml0aWFsaXplZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHBheW1lbnQgc3RlcCBvZiBjaGVja291dCBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCI7Y2FzZSBDLlNoaXBwaW5nTm90SW5pdGlhbGl6ZWQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBzaGlwcGluZyBzdGVwIG9mIGNoZWNrb3V0IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIjtjYXNlIEMuU3BhbVByb3RlY3Rpb25Ob3RJbml0aWFsaXplZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIGNoZWNrb3V0IHNwYW0gcHJvdGVjdGlvbiBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCI7ZGVmYXVsdDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHJlcXVpcmVkIGNvbXBvbmVudCBoYXMgbm90IGJlZW4gaW5pdGlhbGl6ZWQuXCJ9fShlKSksdGhpcy5zdWJ0eXBlPWUsdGhpcy5uYW1lPVwiTm90SW5pdGlhbGl6ZWRFcnJvclwiLHRoaXMudHlwZT1cIm5vdF9pbml0aWFsaXplZFwifX1mdW5jdGlvbiBNKGUpe3JldHVybiBCb29sZWFuKFwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmKFwidHlwZVwiaW4gZXx8XCJtZXNzYWdlXCJpbiBlfHxcImNvZGVcImluIGUpKX0hZnVuY3Rpb24oZSl7ZS5FU1RJTUFURUQ9XCJFU1RJTUFURURcIixlLkZJTkFMPVwiRklOQUxcIixlLk5PVF9DVVJSRU5UTFlfS05PV049XCJOT1RfQ1VSUkVOVExZX0tOT1dOXCJ9KFN8fChTPXt9KSksZnVuY3Rpb24oZSl7ZS5Db21wbGV0ZWQ9XCJDT01QTEVURURcIixlLlBlbmRpbmc9XCJQRU5ESU5HXCIsZS5GYWlsZWQ9XCJGQUlMRURcIn0oUHx8KFA9e30pKSxmdW5jdGlvbihlKXtlLlRSVVNUTFk9XCJ0cnVzdGx5XCJ9KEl8fChJPXt9KSksZnVuY3Rpb24oZSl7ZS5TVUNDRUVERUQ9XCJzdWNjZWVkZWRcIixlLkZBSUxFRD1cImZhaWxlZFwiLGUuQ0FOQ0VMRUQ9XCJjYW5jZWxsZWRcIixlLlVOUkVDT0dOSVpFRD1cInVucmVjb2duaXplZFwifShPfHwoTz17fSkpLGZ1bmN0aW9uKGUpe2UuQ3VzdG9tZXI9XCJDVVNUT01FUlwiLGUuTWVyY2hhbnQ9XCJNRVJDSEFOVFwiLGUuTmV0d29yaz1cIk5FVFdPUktcIixlLkludGVybmFsPVwiSU5URVJOQUxcIixlLlVua25vd249XCJVTktOT1dOXCJ9KGt8fChrPXt9KSksZnVuY3Rpb24oZSl7ZS5Lb3VudE5vdEVuYWJsZWQ9XCJEQVRBX0NPTExFQ1RPUl9LT1VOVF9OT1RfRU5BQkxFRFwifShFfHwoRT17fSkpLGZ1bmN0aW9uKGUpe2UuVmlzYT1cInZpc2FcIixlLk1hc3RlcmNhcmQ9XCJtYXN0ZXJjYXJkXCIsZS5BbWVyaWNhbkV4cHJlc3M9XCJhbWVyaWNhbi1leHByZXNzXCIsZS5EaW5lcnNDbHViPVwiZGluZXJzLWNsdWJcIixlLkRpc2NvdmVyPVwiZGlzY292ZXJcIixlLkpjYj1cImpjYlwiLGUuVW5pb25QYXk9XCJ1bmlvbi1wYXlcIixlLk1hZXN0cm89XCJtYWVzdHJvXCIsZS5FbG89XCJlbG9cIixlLk1pcj1cIm1pclwiLGUuSGlwZXI9XCJoaXBlclwiLGUuSGlwZXJjYXJkPVwiaGlwZXJjYXJkXCJ9KFR8fChUPXt9KSk7dmFyIF89ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgQntjb25zdHJ1Y3RvcihlKXt0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlcj1lfWluaXRpYWxpemUoZSl7dGhpcy5zZXRDbGllbnRUb2tlbihlKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gXyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy50ZWFyZG93bk1vZHVsZSh0aGlzLmRhdGFDb2xsZWN0b3IpLHRoaXMuZGF0YUNvbGxlY3Rvcj12b2lkIDB9KX1nZXRDbGllbnQoKXtyZXR1cm4gXyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuY2xpZW50KXtjb25zdCBlPXRoaXMuZ2V0Q2xpZW50VG9rZW5PclRocm93KCksdD15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkQ2xpZW50KCk7dGhpcy5jbGllbnQ9eWllbGQgdC5jcmVhdGUoe2F1dGhvcml6YXRpb246ZX0pfXJldHVybiB0aGlzLmNsaWVudH0pfWdldERhdGFDb2xsZWN0b3JPclRocm93KGUpe3JldHVybiBfKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXtkZXZpY2VEYXRhOnZvaWQgMCx0ZWFyZG93bjooKT0+UHJvbWlzZS5yZXNvbHZlKCl9O2lmKCF0aGlzLmRhdGFDb2xsZWN0b3IpdHJ5e2NvbnN0IHQ9eWllbGQgdGhpcy5nZXRDbGllbnQoKSxpPXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWREYXRhQ29sbGVjdG9yKCksbj1PYmplY3QuYXNzaWduKHtjbGllbnQ6dCxrb3VudDohMH0sZSk7dGhpcy5kYXRhQ29sbGVjdG9yPXlpZWxkIGkuY3JlYXRlKG4pfWNhdGNoKGUpe2lmKE0oZSkmJmUuY29kZT09PUUuS291bnROb3RFbmFibGVkKXJldHVybiB0O3Rocm93IGV9cmV0dXJuIHRoaXMuZGF0YUNvbGxlY3Rvcn0pfWdldEJyYWludHJlZUdvb2dsZVBheW1lbnQoKXtyZXR1cm4gXyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuZ29vZ2xlUGF5bWVudCl7Y29uc3RbZSx0XT15aWVsZCBQcm9taXNlLmFsbChbdGhpcy5nZXRDbGllbnQoKSx0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkR29vZ2xlUGF5bWVudCgpXSk7dGhpcy5nb29nbGVQYXltZW50PXlpZWxkIHQuY3JlYXRlKHtjbGllbnQ6ZX0pfXJldHVybiB0aGlzLmdvb2dsZVBheW1lbnR9KX1nZXRCcmFpbnRyZWVUaHJlZURTKCl7cmV0dXJuIF8odGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLnRocmVlRFMpe2NvbnN0W2UsdF09eWllbGQgUHJvbWlzZS5hbGwoW3RoaXMuZ2V0Q2xpZW50KCksdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZDNEUygpXSk7dGhpcy50aHJlZURTPXlpZWxkIHQuY3JlYXRlKHtjbGllbnQ6ZSx2ZXJzaW9uOjJ9KX1yZXR1cm4gdGhpcy50aHJlZURTfSl9Z2V0QnJhaW50cmVlTG9jYWxQYXltZW50KGUpe3JldHVybiBfKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5icmFpbnRyZWVMb2NhbFBheW1lbnQpe2NvbnN0W3QsaV09eWllbGQgUHJvbWlzZS5hbGwoW3RoaXMuZ2V0Q2xpZW50KCksdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZExvY2FsUGF5bWVudCgpXSk7dGhpcy5icmFpbnRyZWVMb2NhbFBheW1lbnQ9eWllbGQgbmV3IFByb21pc2UoKG4scik9PntpLmNyZWF0ZSh7Y2xpZW50OnQsbWVyY2hhbnRBY2NvdW50SWQ6ZX0sKGUsdCk9PntlJiZyKGUpLG4odCl9KX0pfXJldHVybiB0aGlzLmJyYWludHJlZUxvY2FsUGF5bWVudH0pfWdldFVzQmFua0FjY291bnQoKXtyZXR1cm4gXyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMudXNCYW5rQWNjb3VudCl7Y29uc3QgZT15aWVsZCB0aGlzLmdldENsaWVudCgpLHQ9eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZFVzQmFua0FjY291bnQoKTt0aGlzLnVzQmFua0FjY291bnQ9eWllbGQgdC5jcmVhdGUoe2NsaWVudDplfSl9cmV0dXJuIHRoaXMudXNCYW5rQWNjb3VudH0pfWdldEJyYWludHJlZVZpc2FDaGVja291dCgpe3JldHVybiB0aGlzLnZpc2FDaGVja291dHx8KHRoaXMudmlzYUNoZWNrb3V0PVByb21pc2UuYWxsKFt0aGlzLmdldENsaWVudCgpLHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRWaXNhQ2hlY2tvdXQoKV0pLnRoZW4oKFtlLHRdKT0+dC5jcmVhdGUoe2NsaWVudDplfSkpKSx0aGlzLnZpc2FDaGVja291dH1nZXRWaXNhQ2hlY2tvdXRTZGsoZSl7cmV0dXJuIF8odGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLnZpc2FDaGVja291dFNES3x8KHRoaXMudmlzYUNoZWNrb3V0U0RLPXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRWaXNhQ2hlY2tvdXRTZGsoZSkpLHRoaXMudmlzYUNoZWNrb3V0U0RLfSl9Z2V0VmVubW9DaGVja291dE9yVGhyb3coKXtyZXR1cm4gXyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuYnJhaW50cmVlVmVubW8pe2NvbnN0IGU9eWllbGQgdGhpcy5nZXRDbGllbnQoKSx0PXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRWZW5tb0NoZWNrb3V0KCksaT17Y2xpZW50OmUsYWxsb3dEZXNrdG9wOiEwLHBheW1lbnRNZXRob2RVc2FnZTpcIm11bHRpX3VzZVwifSxuPXlpZWxkIHQuY3JlYXRlKGkpO2lmKCFuLmlzQnJvd3NlclN1cHBvcnRlZCgpKXRocm93IG5ldyBOO3RoaXMuYnJhaW50cmVlVmVubW89bn1yZXR1cm4gdGhpcy5icmFpbnRyZWVWZW5tb30pfXNldENsaWVudFRva2VuKGUpe3RoaXMuY2xpZW50VG9rZW49ZX1nZXRDbGllbnRUb2tlbk9yVGhyb3coKXtpZighdGhpcy5jbGllbnRUb2tlbil0aHJvdyBuZXcgRChDLlBheW1lbnROb3RJbml0aWFsaXplZCk7cmV0dXJuIHRoaXMuY2xpZW50VG9rZW59dGVhcmRvd25Nb2R1bGUoZSl7cmV0dXJuIGU/ZS50ZWFyZG93bigpOlByb21pc2UucmVzb2x2ZSgpfX1mdW5jdGlvbiB4KGUsdCxpPSEwKXt2YXIgbjtyZXR1cm4gbnVsbCE9PShuPWVbdF0pJiZ2b2lkIDAhPT1uP246aX1jbGFzcyBGe2NvbnN0cnVjdG9yKGUpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYnJhaW50cmVlV2luZG93PXdpbmRvd31nZXRTREtWZXJzaW9uKCl7Y29uc3QgZT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRTdG9yZUNvbmZpZygpLHQ9KG51bGw9PWU/dm9pZCAwOmUuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlcyl8fHt9O3JldHVybiB0aGlzLmdldFByZWxvYWRlZFNES1ZlcnNpb24oKXx8KHgodCxcIlBBWVBBTC01ODA5LmJyYWludHJlZV9ob3N0ZWRfZmllbGRzX2ZpeF92ZXJzaW9uXCIpP3Y6eCh0LFwiUEFZUEFMLTU2MzYudXBkYXRlX2JyYWludHJlZV9zZGtfdmVyc2lvblwiKT9mOmIpfWdldFByZWxvYWRlZFNES1ZlcnNpb24oKXtjb25zdCBlPXRoaXMuYnJhaW50cmVlV2luZG93LmJyYWludHJlZTtpZihlKXtjb25zdCBpPXQoT2JqZWN0LnZhbHVlcyhlKSxlPT4hIWUuVkVSU0lPTik7cmV0dXJuIG51bGw9PWk/dm9pZCAwOmkuVkVSU0lPTn19fWZ1bmN0aW9uIEwoZSx0KXtyZXR1cm4gT2JqZWN0LmFzc2lnbihlLHtyZXNvbHZlSWRzOnR9KX1jbGFzcyBWIGV4dGVuZHMgcHtjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIkludmFsaWQgYXJndW1lbnRzIGhhdmUgYmVlbiBwcm92aWRlZC5cIiksdGhpcy5uYW1lPVwiSW52YWxpZEFyZ3VtZW50RXJyb3JcIix0aGlzLnR5cGU9XCJpbnZhbGlkX2FyZ3VtZW50XCJ9fXZhciBqOyFmdW5jdGlvbihlKXtlW2UuTWlzc2luZ0JpbGxpbmdBZGRyZXNzPTBdPVwiTWlzc2luZ0JpbGxpbmdBZGRyZXNzXCIsZVtlLk1pc3NpbmdDYXJ0PTFdPVwiTWlzc2luZ0NhcnRcIixlW2UuTWlzc2luZ0NoZWNrb3V0PTJdPVwiTWlzc2luZ0NoZWNrb3V0XCIsZVtlLk1pc3NpbmdDb25zaWdubWVudHM9M109XCJNaXNzaW5nQ29uc2lnbm1lbnRzXCIsZVtlLk1pc3NpbmdDdXN0b21lcj00XT1cIk1pc3NpbmdDdXN0b21lclwiLGVbZS5NaXNzaW5nQ2hlY2tvdXRDb25maWc9NV09XCJNaXNzaW5nQ2hlY2tvdXRDb25maWdcIixlW2UuTWlzc2luZ09yZGVyPTZdPVwiTWlzc2luZ09yZGVyXCIsZVtlLk1pc3NpbmdPcmRlckNvbmZpZz03XT1cIk1pc3NpbmdPcmRlckNvbmZpZ1wiLGVbZS5NaXNzaW5nT3JkZXJJZD04XT1cIk1pc3NpbmdPcmRlcklkXCIsZVtlLk1pc3NpbmdQYXltZW50PTldPVwiTWlzc2luZ1BheW1lbnRcIixlW2UuTWlzc2luZ1BheW1lbnRJZD0xMF09XCJNaXNzaW5nUGF5bWVudElkXCIsZVtlLk1pc3NpbmdQYXltZW50SW5zdHJ1bWVudD0xMV09XCJNaXNzaW5nUGF5bWVudEluc3RydW1lbnRcIixlW2UuTWlzc2luZ1BheW1lbnRNZXRob2Q9MTJdPVwiTWlzc2luZ1BheW1lbnRNZXRob2RcIixlW2UuTWlzc2luZ1BheW1lbnRSZWRpcmVjdFVybD0xM109XCJNaXNzaW5nUGF5bWVudFJlZGlyZWN0VXJsXCIsZVtlLk1pc3NpbmdQYXltZW50U3RhdHVzPTE0XT1cIk1pc3NpbmdQYXltZW50U3RhdHVzXCIsZVtlLk1pc3NpbmdQYXltZW50VG9rZW49MTVdPVwiTWlzc2luZ1BheW1lbnRUb2tlblwiLGVbZS5NaXNzaW5nU2hpcHBpbmdBZGRyZXNzPTE2XT1cIk1pc3NpbmdTaGlwcGluZ0FkZHJlc3NcIn0oanx8KGo9e30pKTtjbGFzcyBVIGV4dGVuZHMgcHtjb25zdHJ1Y3RvcihlKXtzdXBlcihmdW5jdGlvbihlKXtzd2l0Y2goZSl7Y2FzZSBqLk1pc3NpbmdCaWxsaW5nQWRkcmVzczpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgYmlsbGluZyBhZGRyZXNzIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBqLk1pc3NpbmdDYXJ0OnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBjYXJ0IGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBqLk1pc3NpbmdDb25zaWdubWVudHM6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGNvbnNpZ25tZW50cyBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2Ugai5NaXNzaW5nQ2hlY2tvdXQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGNoZWNrb3V0IGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBqLk1pc3NpbmdDdXN0b21lcjpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgY3VzdG9tZXIgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIGouTWlzc2luZ0NoZWNrb3V0Q29uZmlnOmNhc2Ugai5NaXNzaW5nT3JkZXJDb25maWc6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGNvbmZpZ3VyYXRpb24gZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIGouTWlzc2luZ09yZGVyOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBvcmRlciBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2Ugai5NaXNzaW5nT3JkZXJJZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2Ugb3JkZXIgSUQgaXMgdW5hdmFpbGFibGUgb3Igbm90IGdlbmVyYXRlZCB5ZXQuXCI7Y2FzZSBqLk1pc3NpbmdQYXltZW50OnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBwYXltZW50IGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBqLk1pc3NpbmdQYXltZW50VG9rZW46cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSB0b2tlbiByZXF1aXJlZCB0byBzdWJtaXQgYSBwYXltZW50IGlzIG1pc3NpbmcuXCI7Y2FzZSBqLk1pc3NpbmdQYXltZW50TWV0aG9kOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBwYXltZW50IG1ldGhvZCBkYXRhIGlzIHVuYXZhaWxhYmxlIG9yIG5vdCBwcm9wZXJseSBjb25maWd1cmVkLlwiO2Nhc2Ugai5NaXNzaW5nU2hpcHBpbmdBZGRyZXNzOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBzaGlwcGluZyBhZGRyZXNzIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7ZGVmYXVsdDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHJlcXVpcmVkIGRhdGEgaXMgdW5hdmFpbGFibGUuXCJ9fShlKSksdGhpcy5zdWJ0eXBlPWUsdGhpcy5uYW1lPVwiTWlzc2luZ0RhdGFFcnJvclwiLHRoaXMudHlwZT1cIm1pc3NpbmdfZGF0YVwifX1jbGFzcyBSIGV4dGVuZHMgVntjb25zdHJ1Y3RvcihlKXtsZXQgdD1cIlVuYWJsZSB0byBzdWJtaXQgcGF5bWVudCBmb3IgdGhlIG9yZGVyIGJlY2F1c2UgdGhlIHBheWxvYWQgaXMgaW52YWxpZC5cIjtlJiYodD1gJHt0fSBNYWtlIHN1cmUgdGhlIGZvbGxvd2luZyBmaWVsZHMgYXJlIHByb3ZpZGVkIGNvcnJlY3RseTogJHtlLmpvaW4oXCIsIFwiKX0uYCksc3VwZXIodCksdGhpcy5uYW1lPVwiUGF5bWVudEFyZ3VtZW50SW52YWxpZEVycm9yXCJ9fWZ1bmN0aW9uIEgoZSl7cmV0dXJuIEJvb2xlYW4oZS5pbnN0cnVtZW50SWQpfWNsYXNzIFcgZXh0ZW5kcyBwe2NvbnN0cnVjdG9yKCl7c3VwZXIoXCJUaGUgY3VycmVudCBvcmRlciBkb2VzIG5vdCBuZWVkIHRvIGJlIGZpbmFsaXplZCBhdCB0aGlzIHN0YWdlLlwiKSx0aGlzLm5hbWU9XCJPcmRlckZpbmFsaXphdGlvbk5vdFJlcXVpcmVkRXJyb3JcIix0aGlzLnR5cGU9XCJvcmRlcl9maW5hbGl6YXRpb25fbm90X3JlcXVpcmVkXCJ9fWZ1bmN0aW9uIHEoZSl7cmV0dXJuIShcIm9iamVjdFwiIT10eXBlb2YgZXx8bnVsbD09PWV8fHZvaWQgMCE9PWUuc2hvdWxkU2F2ZUluc3RydW1lbnQmJlwiYm9vbGVhblwiIT10eXBlb2YgZS5zaG91bGRTYXZlSW5zdHJ1bWVudHx8dm9pZCAwIT09ZS5zaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50JiZcImJvb2xlYW5cIiE9dHlwZW9mIGUuc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudCl9Y2xhc3MgJCBleHRlbmRzIHB7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBjbGllbnQgbGlicmFyeSBvZiBhIHBheW1lbnQgbWV0aG9kIGhhcyB0aHJvd24gYW4gdW5leHBlY3RlZCBlcnJvci5cIiksdGhpcy5uYW1lPVwiUGF5bWVudE1ldGhvZEZhaWxlZEVycm9yXCIsdGhpcy50eXBlPVwicGF5bWVudF9tZXRob2RfY2xpZW50X2ludmFsaWRcIn19ZnVuY3Rpb24gRyhlKXtyZXR1cm4hIWUmJlwiYWNjb3VudE51bWJlclwiaW4gZSYmXCJyb3V0aW5nTnVtYmVyXCJpbiBlJiZcIm93bmVyc2hpcFR5cGVcImluIGUmJlwiYWNjb3VudFR5cGVcImluIGV9dmFyIFk9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgSntjb25zdHJ1Y3RvcihlLHQpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYnJhaW50cmVlU2RrPXR9aW5pdGlhbGl6ZShlKXtyZXR1cm4gWSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6dCxicmFpbnRyZWVhY2g6aX09ZXx8e307aWYoIXQpdGhyb3cgbmV3IFYoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMubWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7dGhpcy5nZXRNYW5kYXRlVGV4dD1udWxsPT1pP3ZvaWQgMDppLmdldE1hbmRhdGVUZXh0LHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZCh0KTtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KHQpLHtjbGllbnRUb2tlbjpyLGluaXRpYWxpemF0aW9uRGF0YTpvfT1uO2lmKCFyfHwhbyl0aHJvdyBuZXcgVShqLk1pc3NpbmdQYXltZW50TWV0aG9kKTt0aGlzLmJyYWludHJlZVNkay5pbml0aWFsaXplKHIpO3RyeXt0aGlzLnVzQmFua0FjY291bnQ9eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0VXNCYW5rQWNjb3VudCgpfWNhdGNoKGUpe3RoaXMuaGFuZGxlQnJhaW50cmVlRXJyb3IoZSl9fSl9ZXhlY3V0ZShlLHQpe3JldHVybiBZKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Oml9PWUsbj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSk7aWYoIWkpdGhyb3cgbmV3IFIoW1wicGF5bWVudFwiXSk7Y29uc3Qgcj1IKGkucGF5bWVudERhdGF8fHt9KSxvPXI/eWllbGQgdGhpcy50b2tlbml6ZVBheW1lbnRGb3JWYXVsdGVkSW5zdHJ1bWVudChpKTp5aWVsZCB0aGlzLnRva2VuaXplUGF5bWVudChpKSxhPXI/eWllbGQgdGhpcy5wcmVwYXJlUGF5bWVudERhdGFGb3JWYXVsdGVkSW5zdHJ1bWVudChvLGkpOnlpZWxkIHRoaXMucHJlcGFyZVBheW1lbnREYXRhKG8saSk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKG4sdCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoYSl9KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgVyl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFkodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB5aWVsZCB0aGlzLmJyYWludHJlZVNkay5kZWluaXRpYWxpemUoKSxQcm9taXNlLnJlc29sdmUoKX0pfXRva2VuaXplUGF5bWVudCh7cGF5bWVudERhdGE6ZX0pe3JldHVybiBZKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXRoaXMuZ2V0VXNCYW5rQWNjb3VudE9yVGhyb3coKTtpZighRyhlKSl0aHJvdyBuZXcgUihbXCJwYXltZW50LnBheW1lbnREYXRhXCJdKTtjb25zdCBpPUgoZSk/XCJUaGUgZGF0YSBhcmUgdXNlZCBmb3Igc3RvcmVkIGluc3RydW1lbnQgdmVyaWZpY2F0aW9uXCI6XCJmdW5jdGlvblwiPT10eXBlb2YgdGhpcy5nZXRNYW5kYXRlVGV4dCYmdGhpcy5nZXRNYW5kYXRlVGV4dCgpO2lmKCFpKXRocm93IG5ldyBWKFwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBnZXRNYW5kYXRlVGV4dCBpcyBub3QgcHJvdmlkZWQgb3IgcmV0dXJuZWQgdW5kZWZpbmVkIHZhbHVlLlwiKTt0cnl7Y29uc3R7bm9uY2U6bn09eWllbGQgdC50b2tlbml6ZSh7YmFua0RldGFpbHM6dGhpcy5nZXRCYW5rRGV0YWlscyhlKSxtYW5kYXRlVGV4dDppfSk7cmV0dXJuIG59Y2F0Y2goZSl7dGhpcy5oYW5kbGVCcmFpbnRyZWVFcnJvcihlKX19KX10b2tlbml6ZVBheW1lbnRGb3JWYXVsdGVkSW5zdHJ1bWVudChlKXtyZXR1cm4gWSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6dCxwYXltZW50RGF0YTppPXt9fT1lLG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkse2NvbmZpZzpyfT1uLmdldFBheW1lbnRNZXRob2RPclRocm93KHQpO2lmKCFyLmlzVmF1bHRpbmdFbmFibGVkKXRocm93IG5ldyBWKFwiVmF1bHRpbmcgaXMgZGlzYWJsZWQgYnV0IGEgdmF1bHRlZCBpbnN0cnVtZW50IHdhcyBiZWluZyB1c2VkIGZvciB0aGlzIHRyYW5zYWN0aW9uXCIpO3JldHVybiBHKGkpP3RoaXMudG9rZW5pemVQYXltZW50KGUpOm51bGx9KX1wcmVwYXJlUGF5bWVudERhdGEoZSx0KXtyZXR1cm4gWSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6aSxwYXltZW50RGF0YTpuPXt9fT10O2lmKCFHKG4pKXRocm93IG5ldyBSKFtcInBheW1lbnQucGF5bWVudERhdGFcIl0pO2NvbnN0e2RldmljZURhdGE6cn09eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0RGF0YUNvbGxlY3Rvck9yVGhyb3coKSx7c2hvdWxkU2F2ZUluc3RydW1lbnQ6byxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OmEscm91dGluZ051bWJlcjpzLGFjY291bnROdW1iZXI6ZH09bjtyZXR1cm57bWV0aG9kSWQ6aSxwYXltZW50RGF0YTp7ZGV2aWNlU2Vzc2lvbklkOnIsc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDphLHNob3VsZFNhdmVJbnN0cnVtZW50Om8sZm9ybWF0dGVkUGF5bG9hZDp7dG9rZW5pemVkX2JhbmtfYWNjb3VudDp7aXNzdWVyOnMsbWFza2VkX2FjY291bnRfbnVtYmVyOmQuc3Vic3RyKC00KSx0b2tlbjplfX19fX0pfXByZXBhcmVQYXltZW50RGF0YUZvclZhdWx0ZWRJbnN0cnVtZW50KGUsdCl7cmV0dXJuIFkodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e21ldGhvZElkOmkscGF5bWVudERhdGE6bj17fX09dDtpZighSChuKXx8IXEobikpdGhyb3cgbmV3IFIoW1wicGF5bWVudC5wYXltZW50RGF0YVwiXSk7Y29uc3R7ZGV2aWNlRGF0YTpyfT15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXREYXRhQ29sbGVjdG9yT3JUaHJvdygpLHtpbnN0cnVtZW50SWQ6byxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OmF9PW47cmV0dXJue21ldGhvZElkOmkscGF5bWVudERhdGE6T2JqZWN0LmFzc2lnbih7ZGV2aWNlU2Vzc2lvbklkOnIsaW5zdHJ1bWVudElkOm8sc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDphfSxlJiZ7bm9uY2U6ZX0pfX0pfWdldEJhbmtEZXRhaWxzKGUpe2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0QmlsbGluZ0FkZHJlc3NPclRocm93KCksaT1lLm93bmVyc2hpcFR5cGUudG9Mb3dlckNhc2UoKSxuPWUuYWNjb3VudFR5cGUudG9Mb3dlckNhc2UoKTtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHthY2NvdW50TnVtYmVyOmUuYWNjb3VudE51bWJlcixyb3V0aW5nTnVtYmVyOmUucm91dGluZ051bWJlcixvd25lcnNoaXBUeXBlOml9LFwicGVyc29uYWxcIj09PWk/e2ZpcnN0TmFtZTplLmZpcnN0TmFtZSxsYXN0TmFtZTplLmxhc3ROYW1lfTp7YnVzaW5lc3NOYW1lOmUuYnVzaW5lc3NOYW1lfSkse2FjY291bnRUeXBlOm4sYmlsbGluZ0FkZHJlc3M6e3N0cmVldEFkZHJlc3M6dC5hZGRyZXNzMSxleHRlbmRlZEFkZHJlc3M6dC5hZGRyZXNzMixsb2NhbGl0eTp0LmNpdHkscmVnaW9uOnQuc3RhdGVPclByb3ZpbmNlQ29kZSxwb3N0YWxDb2RlOnQucG9zdGFsQ29kZX19KX1nZXRVc0JhbmtBY2NvdW50T3JUaHJvdygpe2lmKCF0aGlzLnVzQmFua0FjY291bnQpdGhyb3cgbmV3IEQoQy5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO3JldHVybiB0aGlzLnVzQmFua0FjY291bnR9aGFuZGxlQnJhaW50cmVlRXJyb3IoZSl7aWYoIU0oZSkpdGhyb3cgZTt0aHJvdyBuZXcgJChlLm1lc3NhZ2UpfX1jb25zdCBLPUwodD0+bmV3IEoodCwodD0+e2NvbnN0IGk9bmV3IEYodCksbj1uZXcgeihlKCksd2luZG93LGkpO3JldHVybiBuZXcgQihuKX0pKHQpKSxbe2lkOlwiYnJhaW50cmVlYWNoXCJ9XSk7Y2xhc3MgWCBleHRlbmRzIHB7Y29uc3RydWN0b3IoZSx0KXtzdXBlcih0fHxcIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHBheW1lbnQgZm9ybSBjb250YWlucyBpbnZhbGlkIGRhdGEuXCIpLHRoaXMuZGV0YWlscz1lLHRoaXMubmFtZT1cIlBheW1lbnRJbnZhbGlkRm9ybUVycm9yXCIsdGhpcy50eXBlPVwicGF5bWVudF9pbnZhbGlkX2Zvcm1cIn19Y2xhc3MgUSBleHRlbmRzIHB7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJQYXltZW50IHByb2Nlc3Mgd2FzIGNhbmNlbGxlZC5cIiksdGhpcy5uYW1lPVwiUGF5bWVudE1ldGhvZENhbmNlbGxlZEVycm9yXCIsdGhpcy50eXBlPVwicGF5bWVudF9jYW5jZWxsZWRcIn19Y2xhc3MgWntjb25zdHJ1Y3RvcihlKXtjb25zdCB0PW5ldyBQcm9taXNlKChlLHQpPT57dGhpcy5jYW5jZWw9dH0pO3RoaXMucHJvbWlzZT1Qcm9taXNlLnJhY2UoW2UsdF0pfX1sZXQgZWU9bnVsbDtjb25zdCB0ZT1bXCJidXR0b25zXCIsXCJtZXNzYWdlc1wiXTt2YXIgaWUsbmUscmUsb2UsYWUsc2U7IWZ1bmN0aW9uKGUpe2UuSE9SSVpPTlRBTD1cImhvcml6b250YWxcIixlLlZFUlRJQ0FMPVwidmVydGljYWxcIn0oaWV8fChpZT17fSkpLGZ1bmN0aW9uKGUpe2UuU01BTEw9XCJzbWFsbFwiLGUuTUVESVVNPVwibWVkaXVtXCIsZS5MQVJHRT1cImxhcmdlXCIsZS5SRVNQT05TSVZFPVwicmVzcG9uc2l2ZVwifShuZXx8KG5lPXt9KSksZnVuY3Rpb24oZSl7ZS5HT0xEPVwiZ29sZFwiLGUuQkxVRT1cImJsdWVcIixlLlNJbFZFUj1cInNpbHZlclwiLGUuQkxBQ0s9XCJibGFja1wiLGUuV0hJVEU9XCJ3aGl0ZVwifShyZXx8KHJlPXt9KSksZnVuY3Rpb24oZSl7ZS5DSEVDS09VVD1cImNoZWNrb3V0XCIsZS5QQVk9XCJwYXlcIixlLkJVWU5PVz1cImJ1eW5vd1wiLGUuUEFZUEFMPVwicGF5cGFsXCIsZS5DUkVESVQ9XCJjcmVkaXRcIn0ob2V8fChvZT17fSkpLGZ1bmN0aW9uKGUpe2UuUElMTD1cInBpbGxcIixlLlJFQ1Q9XCJyZWN0XCJ9KGFlfHwoYWU9e30pKSxmdW5jdGlvbihlKXtlLkNBUlQ9XCJjYXJ0XCIsZS5IT01FPVwiaG9tZXBhZ2VcIixlLlBBWU1FTlQ9XCJwYXltZW50XCIsZS5QUk9EVUNUPVwicHJvZHVjdFwifShzZXx8KHNlPXt9KSk7dmFyIGRlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIGxle2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlcj1lLHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdz10LHRoaXMub3ZlcmxheT1pLHRoaXMuZGF0YUNvbGxlY3RvcnM9e319aW5pdGlhbGl6ZShlLHQpe3RoaXMuY2xpZW50VG9rZW49ZSx0aGlzLnRocmVlRFNlY3VyZU9wdGlvbnM9dH1nZXRCcmFpbnRyZWVGYXN0bGFuZShlLHQsaSl7cmV0dXJuIGRlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZih0JiYod2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKFwiYXhvRW52XCIsXCJzYW5kYm94XCIpLHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImZhc3RsYW5lRW52XCIsXCJzYW5kYm94XCIpKSwhdGhpcy5icmFpbnRyZWVIb3N0V2luZG93LmJyYWludHJlZUZhc3RsYW5lKXtjb25zdCB0PXRoaXMuZ2V0Q2xpZW50VG9rZW5PclRocm93KCksbj15aWVsZCB0aGlzLmdldENsaWVudCgpLHI9eWllbGQgdGhpcy5nZXRTZXNzaW9uSWQoZSksbz15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkRmFzdGxhbmUoKSxhPXtyb290OntiYWNrZ3JvdW5kQ29sb3JQcmltYXJ5OlwidHJhbnNwYXJlbnRcIn19O3RoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5icmFpbnRyZWVGYXN0bGFuZT15aWVsZCBvLmNyZWF0ZSh7YXV0aG9yaXphdGlvbjp0LGNsaWVudDpuLGRldmljZURhdGE6cixzdHlsZXM6aXx8YX0pfXJldHVybiB0aGlzLmJyYWludHJlZUhvc3RXaW5kb3cuYnJhaW50cmVlRmFzdGxhbmV9KX1nZXRDbGllbnQoKXtyZXR1cm4gZGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLmNsaWVudCl7Y29uc3QgZT10aGlzLmdldENsaWVudFRva2VuT3JUaHJvdygpLHQ9eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZENsaWVudCgpO3RoaXMuY2xpZW50PXQuY3JlYXRlKHthdXRob3JpemF0aW9uOmV9KX1yZXR1cm4gdGhpcy5jbGllbnR9KX1nZXRQYXlwYWwoKXtyZXR1cm4gdGhpcy5icmFpbnRyZWVQYXlwYWx8fCh0aGlzLmJyYWludHJlZVBheXBhbD1Qcm9taXNlLmFsbChbdGhpcy5nZXRDbGllbnQoKSx0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkUGF5cGFsKCldKS50aGVuKChbZSx0XSk9PnQuY3JlYXRlKHtjbGllbnQ6ZX0pKSksdGhpcy5icmFpbnRyZWVQYXlwYWx9cGF5cGFsKGUpe3ZhcntzaG91bGRTYXZlSW5zdHJ1bWVudDp0fT1lLGk9ZnVuY3Rpb24oZSx0KXt2YXIgaT17fTtmb3IodmFyIG4gaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxuKSYmdC5pbmRleE9mKG4pPDAmJihpW25dPWVbbl0pO2lmKG51bGwhPWUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPTA7Zm9yKG49T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtyPG4ubGVuZ3RoO3IrKyl0LmluZGV4T2YobltyXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsbltyXSkmJihpW25bcl1dPWVbbltyXV0pfXJldHVybiBpfShlLFtcInNob3VsZFNhdmVJbnN0cnVtZW50XCJdKTtjb25zdCBuPWwoKTtyZXR1cm4gdGhpcy5nZXRQYXlwYWwoKS50aGVuKGU9Pnt2YXIgcjtyZXR1cm4gbiYmKG51bGw9PT0ocj10aGlzLm92ZXJsYXkpfHx2b2lkIDA9PT1yfHxyLnNob3coe29uQ2xpY2s6KCk9PmUuZm9jdXNXaW5kb3coKX0pKSxlLnRva2VuaXplKE9iamVjdC5hc3NpZ24oe2VuYWJsZVNoaXBwaW5nQWRkcmVzczohMCxmbG93OnQ/XCJ2YXVsdFwiOlwiY2hlY2tvdXRcIix1c2VyYWN0aW9uOlwiY29tbWl0XCJ9LGkpKX0pLnRoZW4oZT0+e3ZhciB0O3JldHVybiBudWxsPT09KHQ9dGhpcy5vdmVybGF5KXx8dm9pZCAwPT09dHx8dC5yZW1vdmUoKSxlfSkuY2F0Y2goZT0+e3ZhciB0O3Rocm93IG51bGw9PT0odD10aGlzLm92ZXJsYXkpfHx2b2lkIDA9PT10fHx0LnJlbW92ZSgpLGV9KX1nZXRQYXlwYWxDaGVja291dChlLHQsaSl7cmV0dXJuIGRlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBuPXlpZWxkIHRoaXMuZ2V0Q2xpZW50KCkscj15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkUGF5cGFsQ2hlY2tvdXQoKSxvPXtjbGllbnQ6bn07cmV0dXJuIHRoaXMucGF5cGFsQ2hlY2tvdXQ9eWllbGQgci5jcmVhdGUobywobixyKT0+e3ZhciBvO2lmKG4pcmV0dXJuIGkobik7Y29uc3QgYT1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe2N1cnJlbmN5OmUuY3VycmVuY3l9LGUuaXNDcmVkaXRFbmFibGVkJiZ7XCJlbmFibGUtZnVuZGluZ1wiOlwicGF5bGF0ZXJcIn0pLHtjb21wb25lbnRzOnRlLnRvU3RyaW5nKCksaW50ZW50OmUuaW50ZW50LGNvbW1pdDpudWxsPT09KG89ZS5jb21taXQpfHx2b2lkIDA9PT1vfHxvfSk7dGhpcy5icmFpbnRyZWVIb3N0V2luZG93LnBheXBhbD90KHIpOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGVlfHwoZWU9bmV3IFByb21pc2UoKGksbik9PntlLmxvYWRQYXlQYWxTREsodCx0PT57dD8oZWU9bnVsbCxuKHQpKTppKGUpfSl9KSksZWV9KHIsYSkudGhlbigoKT0+dChyKSl9KSx0aGlzLnBheXBhbENoZWNrb3V0fSl9Z2V0RGF0YUNvbGxlY3RvcihlKXtyZXR1cm4gZGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9KG51bGw9PWU/dm9pZCAwOmUucGF5cGFsKT9cInBheXBhbFwiOlwiZGVmYXVsdFwiO2xldCBpPXRoaXMuZGF0YUNvbGxlY3RvcnNbdF07aWYoIWkpe3RyeXtjb25zdCB0PXlpZWxkIHRoaXMuZ2V0Q2xpZW50KCksbj15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkRGF0YUNvbGxlY3RvcigpLHI9T2JqZWN0LmFzc2lnbih7Y2xpZW50OnQsa291bnQ6ITB9LGUpO2k9eWllbGQgbi5jcmVhdGUocil9Y2F0Y2goZSl7aWYoIU0oZSl8fFwiREFUQV9DT0xMRUNUT1JfS09VTlRfTk9UX0VOQUJMRURcIiE9PWUuY29kZSl0aHJvdyBlO2k9e2RldmljZURhdGE6dm9pZCAwLHRlYXJkb3duOigpPT5Qcm9taXNlLnJlc29sdmUoKX19dGhpcy5kYXRhQ29sbGVjdG9yc1t0XT1pfXJldHVybiBpfSl9Z2V0QnJhaW50cmVlRW52KGU9ITEpe3JldHVybiBlP2guU2FuZGJveDpoLlByb2R1Y3Rpb259bWFwVG9CcmFpbnRyZWVTaGlwcGluZ0FkZHJlc3NPdmVycmlkZShlKXtyZXR1cm57cmVjaXBpZW50TmFtZTpgJHtlLmZpcnN0TmFtZX0gJHtlLmxhc3ROYW1lfWAsbGluZTE6ZS5hZGRyZXNzMSxsaW5lMjplLmFkZHJlc3MyLGNpdHk6ZS5jaXR5LHN0YXRlOmUuc3RhdGVPclByb3ZpbmNlQ29kZSxwb3N0YWxDb2RlOmUucG9zdGFsQ29kZSxjb3VudHJ5Q29kZTplLmNvdW50cnlDb2RlLHBob25lOmUucGhvbmV9fW1hcFRvTGVnYWN5U2hpcHBpbmdBZGRyZXNzKGUpe2NvbnN0e2VtYWlsOnQscGhvbmU6aSxzaGlwcGluZ0FkZHJlc3M6bn09ZSxyPShudWxsPT1uP3ZvaWQgMDpuLnJlY2lwaWVudE5hbWUpfHxcIlwiLFtvLGFdPXIuc3BsaXQoXCIgXCIpO3JldHVybntlbWFpbDp0LGZpcnN0X25hbWU6b3x8XCJcIixsYXN0X25hbWU6YXx8XCJcIixwaG9uZV9udW1iZXI6aSxhZGRyZXNzX2xpbmVfMTpudWxsPT1uP3ZvaWQgMDpuLmxpbmUxLGFkZHJlc3NfbGluZV8yOm51bGw9PW4/dm9pZCAwOm4ubGluZTIsY2l0eTpudWxsPT1uP3ZvaWQgMDpuLmNpdHksc3RhdGU6bnVsbD09bj92b2lkIDA6bi5zdGF0ZSxjb3VudHJ5X2NvZGU6bnVsbD09bj92b2lkIDA6bi5jb3VudHJ5Q29kZSxwb3N0YWxfY29kZTpudWxsPT1uP3ZvaWQgMDpuLnBvc3RhbENvZGV9fW1hcFRvTGVnYWN5QmlsbGluZ0FkZHJlc3MoZSl7Y29uc3R7YmlsbGluZ0FkZHJlc3M6dCxlbWFpbDppLGZpcnN0TmFtZTpuLGxhc3ROYW1lOnIscGhvbmU6byxzaGlwcGluZ0FkZHJlc3M6YX09ZSxzPXR8fGE7cmV0dXJue2VtYWlsOmksZmlyc3RfbmFtZTpuLGxhc3RfbmFtZTpyLHBob25lX251bWJlcjpvLGFkZHJlc3NfbGluZV8xOm51bGw9PXM/dm9pZCAwOnMubGluZTEsYWRkcmVzc19saW5lXzI6bnVsbD09cz92b2lkIDA6cy5saW5lMixjaXR5Om51bGw9PXM/dm9pZCAwOnMuY2l0eSxzdGF0ZTpudWxsPT1zP3ZvaWQgMDpzLnN0YXRlLGNvdW50cnlfY29kZTpudWxsPT1zP3ZvaWQgMDpzLmNvdW50cnlDb2RlLHBvc3RhbF9jb2RlOm51bGw9PXM/dm9pZCAwOnMucG9zdGFsQ29kZX19cmVtb3ZlRWxlbWVudChlKXtjb25zdCB0PWUmJmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGUpO3QmJnQucmVtb3ZlKCl9Z2V0U2Vzc2lvbklkKGUpe3JldHVybiBkZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7ZGV2aWNlRGF0YTp0fT15aWVsZCB0aGlzLmdldERhdGFDb2xsZWN0b3Ioe3Jpc2tDb3JyZWxhdGlvbklkOmV9KTtyZXR1cm4gdH0pfXRlYXJkb3duKCl7cmV0dXJuIGRlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnRlYXJkb3duTW9kdWxlKHRoaXMuZGF0YUNvbGxlY3RvcnMuZGVmYXVsdCkseWllbGQgdGhpcy50ZWFyZG93bk1vZHVsZSh0aGlzLmRhdGFDb2xsZWN0b3JzLnBheXBhbCksdGhpcy5kYXRhQ29sbGVjdG9ycz17fSx5aWVsZCB0aGlzLnRlYXJkb3duTW9kdWxlKHRoaXMucGF5cGFsQ2hlY2tvdXQpLHRoaXMucGF5cGFsQ2hlY2tvdXQ9dm9pZCAwfSl9Z2V0M0RTKCl7cmV0dXJuIGRlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy50aHJlZURTfHwodGhpcy50aHJlZURTPVByb21pc2UuYWxsKFt0aGlzLmdldENsaWVudCgpLHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWQzRFMoKV0pLnRoZW4oKFtlLHRdKT0+dC5jcmVhdGUoe2NsaWVudDplLHZlcnNpb246Mn0pKSksdGhpcy50aHJlZURTfSl9Z2V0VmVubW9DaGVja291dChlKXtyZXR1cm4gZGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLnZlbm1vQ2hlY2tvdXQpe2NvbnN0IHQ9eWllbGQgdGhpcy5nZXRDbGllbnQoKSxpPXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRWZW5tb0NoZWNrb3V0KCksbj1PYmplY3QuYXNzaWduKHtjbGllbnQ6dCxhbGxvd0Rlc2t0b3A6ITAscGF5bWVudE1ldGhvZFVzYWdlOlwibXVsdGlfdXNlXCJ9LGV8fHt9KTt0aGlzLnZlbm1vQ2hlY2tvdXQ9eWllbGQgbmV3IFByb21pc2UoKGUsdCk9PntpLmNyZWF0ZShuLChpLG4pPT5pP3QoaSk6bi5pc0Jyb3dzZXJTdXBwb3J0ZWQoKT92b2lkIGUobik6dChuZXcgTikpfSl9cmV0dXJuIHRoaXMudmVubW9DaGVja291dH0pfXZlcmlmeUNhcmQoZSx0LGkpe3JldHVybiBkZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgbj15aWVsZCB0aGlzLnRva2VuaXplQ2FyZChlLHQpO3JldHVybiB0aGlzLmNoYWxsZW5nZTNEU1ZlcmlmaWNhdGlvbihuLGkpfSl9dG9rZW5pemVDYXJkKGUsdCl7cmV0dXJuIGRlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50RGF0YTpufT1lO2lmKCFmdW5jdGlvbihlKXtpZihcIm9iamVjdFwiIT10eXBlb2YgZXx8bnVsbD09PWUpcmV0dXJuITE7Y29uc3QgdD1lO3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiB0LmNjRXhwaXJ5JiZudWxsIT09dC5jY0V4cGlyeSYmXCJzdHJpbmdcIj09dHlwZW9mIHQuY2NOdW1iZXImJlwic3RyaW5nXCI9PXR5cGVvZiB0LmNjTmFtZX0obikpdGhyb3cgbmV3IFIoW1wicGF5bWVudC5wYXltZW50RGF0YVwiXSk7Y29uc3Qgcj10aGlzLmdldEVycm9yc1JlcXVpcmVkRmllbGRzKG4pO2lmKCFpKHIpKXRocm93IG5ldyBYKHIpO2NvbnN0IG89dGhpcy5tYXBUb0NyZWRpdENhcmQobix0KSxhPXlpZWxkIHRoaXMuZ2V0Q2xpZW50KCkse2NyZWRpdENhcmRzOnN9PXlpZWxkIGEucmVxdWVzdChvKTtyZXR1cm57bm9uY2U6c1swXS5ub25jZSxiaW46c1swXS5kZXRhaWxzLmJpbn19KX1jaGFsbGVuZ2UzRFNWZXJpZmljYXRpb24oZSx0KXtyZXR1cm4gZGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9eWllbGQgdGhpcy5nZXQzRFMoKTtyZXR1cm4gdGhpcy5wcmVzZW50M0RTQ2hhbGxlbmdlKGksdCxlKX0pfXRlYXJkb3duTW9kdWxlKGUpe3JldHVybiBlP2UudGVhcmRvd24oKTpQcm9taXNlLnJlc29sdmUoKX1nZXRDbGllbnRUb2tlbk9yVGhyb3coKXtpZighdGhpcy5jbGllbnRUb2tlbil0aHJvdyBuZXcgRChDLlBheW1lbnROb3RJbml0aWFsaXplZCk7cmV0dXJuIHRoaXMuY2xpZW50VG9rZW59Z2V0RXJyb3JzUmVxdWlyZWRGaWVsZHMoZSl7Y29uc3R7Y2NOdW1iZXI6dCxjY0V4cGlyeTppfT1lLG49e307cmV0dXJuIHR8fChuLmNjTnVtYmVyPVt7bWVzc2FnZTpcIkNyZWRpdCBjYXJkIG51bWJlciBpcyByZXF1aXJlZFwiLHR5cGU6XCJyZXF1aXJlZFwifV0pLGl8fChuLmNjRXhwaXJ5PVt7bWVzc2FnZTpcIkV4cGlyYXRpb24gZGF0ZSBpcyByZXF1aXJlZFwiLHR5cGU6XCJyZXF1aXJlZFwifV0pLG59bWFwVG9DcmVkaXRDYXJkKGUsdCl7cmV0dXJue2RhdGE6e2NyZWRpdENhcmQ6e2NhcmRob2xkZXJOYW1lOmUuY2NOYW1lLG51bWJlcjplLmNjTnVtYmVyLGN2djplLmNjQ3Z2LGV4cGlyYXRpb25EYXRlOmAke2UuY2NFeHBpcnkubW9udGh9LyR7ZS5jY0V4cGlyeS55ZWFyfWAsb3B0aW9uczp7dmFsaWRhdGU6ITF9LGJpbGxpbmdBZGRyZXNzOnQmJntjb3VudHJ5Q29kZUFscGhhMjp0LmNvdW50cnlDb2RlLGxvY2FsaXR5OnQuY2l0eSxjb3VudHJ5TmFtZTp0LmNvdW50cnkscG9zdGFsQ29kZTp0LnBvc3RhbENvZGUsc3RyZWV0QWRkcmVzczp0LmFkZHJlc3MyP2Ake3QuYWRkcmVzczF9ICR7dC5hZGRyZXNzMn1gOnQuYWRkcmVzczF9fX0sZW5kcG9pbnQ6XCJwYXltZW50X21ldGhvZHMvY3JlZGl0X2NhcmRzXCIsbWV0aG9kOlwicG9zdFwifX1wcmVzZW50M0RTQ2hhbGxlbmdlKGUsdCxpKXtjb25zdHtub25jZTpuLGJpbjpyfT1pO2lmKCF0aGlzLnRocmVlRFNlY3VyZU9wdGlvbnN8fCFuKXRocm93IG5ldyBEKEMuUGF5bWVudE5vdEluaXRpYWxpemVkKTtjb25zdHthZGRGcmFtZTpvLHJlbW92ZUZyYW1lOmEsY2hhbGxlbmdlUmVxdWVzdGVkOnM9ITAsYWRkaXRpb25hbEluZm9ybWF0aW9uOmR9PXRoaXMudGhyZWVEU2VjdXJlT3B0aW9ucyxsPSgpPT5kZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD15aWVsZCBlLmNhbmNlbFZlcmlmeUNhcmQoKTtyZXR1cm4gdS5jYW5jZWwobmV3IFEpLHR9KSxjPXQudG9GaXhlZCgyKSx1PW5ldyBaKGUudmVyaWZ5Q2FyZCh7YWRkRnJhbWU6KGUsdCk9PntvJiZvKGUsdCxsKX0sYW1vdW50Ok51bWJlcihjKSxiaW46cixjaGFsbGVuZ2VSZXF1ZXN0ZWQ6cyxub25jZTpuLHJlbW92ZUZyYW1lOmEsb25Mb29rdXBDb21wbGV0ZTooZSx0KT0+e3QoKX0sY29sbGVjdERldmljZURhdGE6ITAsYWRkaXRpb25hbEluZm9ybWF0aW9uOmR9KSk7cmV0dXJuIHUucHJvbWlzZX19Y2xhc3MgY2V7Y29uc3RydWN0b3IoZSl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVIb3N0V2luZG93PXdpbmRvd31yZW5kZXIoZSx0LGkpe2NvbnN0IG49dCYmZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodCk7aWYodGhpcy5icmFpbnRyZWVIb3N0V2luZG93LnBheXBhbCYmbil7Y29uc3Qgcj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxvPXIuZ2V0Q2FydE9yVGhyb3coKSxhPXIuZ2V0QmlsbGluZ0FkZHJlc3NPclRocm93KCkscz1yLmdldFBheW1lbnRNZXRob2RPclRocm93KGUpO2lmKCFzLmluaXRpYWxpemF0aW9uRGF0YSlyZXR1cm47Y29uc3R7cGF5cGFsQk5QTENvbmZpZ3VyYXRpb246ZD1bXX09cy5pbml0aWFsaXphdGlvbkRhdGEsbD1pPT09c2UuUEFZTUVOVD9cImNoZWNrb3V0XCI6aSxjPWQmJmQuZmluZCgoe2lkOmV9KT0+ZT09PWwpO2lmKCFjfHwhYy5zdGF0dXMpcmV0dXJuO2k9PT1zZS5DQVJUJiYobi5yZW1vdmVBdHRyaWJ1dGUoXCJkYXRhLXBwLXN0eWxlLWxvZ28tdHlwZVwiKSxuLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcHAtc3R5bGUtbG9nby1wb3NpdGlvblwiKSxuLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcHAtc3R5bGUtdGV4dC1jb2xvclwiKSxuLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcHAtc3R5bGUtdGV4dC1zaXplXCIpKSx0aGlzLmJyYWludHJlZUhvc3RXaW5kb3cucGF5cGFsLk1lc3NhZ2VzKHthbW91bnQ6by5jYXJ0QW1vdW50LGJ1eWVyQ291bnRyeTphLmNvdW50cnlDb2RlLHBsYWNlbWVudDppLHN0eWxlOnRoaXMuZ2V0UGF5cGFsTWVzc2FnZXNTdHlsZXNGcm9tQk5QTENvbmZpZyhjKX0pLnJlbmRlcihgIyR7dH1gKX19Z2V0UGF5cGFsTWVzc2FnZXNTdHlsZXNGcm9tQk5QTENvbmZpZyh7c3R5bGVzOmV9KXtjb25zdCB0PXt9O3JldHVybiBlLmNvbG9yJiYodC5jb2xvcj1lLmNvbG9yKSxlLmxheW91dCYmKHQubGF5b3V0PWUubGF5b3V0KSwoZVtcImxvZ28tdHlwZVwiXXx8ZVtcImxvZ28tcG9zaXRpb25cIl0pJiYodC5sb2dvPXt9LGVbXCJsb2dvLXR5cGVcIl0mJih0LmxvZ28udHlwZT1lW1wibG9nby10eXBlXCJdKSxlW1wibG9nby1wb3NpdGlvblwiXSYmKHQubG9nby5wb3NpdGlvbj1lW1wibG9nby1wb3NpdGlvblwiXSkpLGUucmF0aW8mJih0LnJhdGlvPWUucmF0aW8pLChlW1widGV4dC1jb2xvclwiXXx8ZVtcInRleHQtc2l6ZVwiXSkmJih0LnRleHQ9e30sZVtcInRleHQtY29sb3JcIl0mJih0LnRleHQuY29sb3I9ZVtcInRleHQtY29sb3JcIl0pLGVbXCJ0ZXh0LXNpemVcIl0mJih0LnRleHQuc2l6ZT0rZVtcInRleHQtc2l6ZVwiXSkpLHR9fWNsYXNzIHVle2NvbnN0cnVjdG9yKGUpe2NvbnN0e2VsZW1lbnQ6dCxjbG9zZUVsZW1lbnQ6aSxtYWluRWxlbWVudDpufT10aGlzLl9jcmVhdGVFbGVtZW50cyhlKTt0aGlzLl9lbGVtZW50PXQsdGhpcy5fY2xvc2VFbGVtZW50PWksdGhpcy5fbWFpbkVsZW1lbnQ9bn1zaG93KGUpe3RoaXMuX21haW5FbGVtZW50LnBhcmVudEVsZW1lbnR8fCh0aGlzLl9yZWdpc3RlckNsaWNrKGUpLGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGhpcy5fbWFpbkVsZW1lbnQpLHNldFRpbWVvdXQoKCk9PnRoaXMuX2VsZW1lbnQuc3R5bGUub3BhY2l0eT1cIjFcIikpfXJlbW92ZSgpe3RoaXMuX21haW5FbGVtZW50LnBhcmVudEVsZW1lbnQmJih0aGlzLl91bnJlZ2lzdGVyQ2xpY2smJnRoaXMuX3VucmVnaXN0ZXJDbGljaygpLHRoaXMuX3JlbW92ZUFmdGVyVHJhbnNpdGlvbigpLHNldFRpbWVvdXQoKCk9PnRoaXMuX2VsZW1lbnQuc3R5bGUub3BhY2l0eT1cIjBcIikpfV9jcmVhdGVFbGVtZW50cyhlKXtjb25zdCB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikse2JhY2tncm91bmQ6aT1cInJnYmEoMCwgMCwgMCwgMC44KVwiLGlkOm49XCJjaGVja291dE92ZXJsYXlcIix0cmFuc2l0aW9uRHVyYXRpb246cj00MDAsaGFzQ2xvc2VCdXR0b246bz0hMSxpbm5lckh0bWw6YT1udWxsfT1lfHx7fTtsZXQgcyxkLGwsYyx1PXQ7aWYobiYmKHQuaWQ9biksYSl7Y29uc3QgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO2M9YCR7bn0tLW92ZXJsYXlUZXh0YCxlLmNsYXNzTmFtZT1jLGUuYXBwZW5kQ2hpbGQoYSksdC5hcHBlbmRDaGlsZChlKX1yZXR1cm4gbyYmKGw9YCR7bn0tLWNsb3NlYCxzPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikscy5jbGFzc05hbWU9bCxkPWAke259LS1sYXlvdXRgLHU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSx1LmNsYXNzTmFtZT1kLHUuYXBwZW5kQ2hpbGQodCksdS5hcHBlbmRDaGlsZChzKSksdS5hcHBlbmRDaGlsZChmdW5jdGlvbihlKXtjb25zdHtpZDp0LGJhY2tncm91bmQ6aSx0cmFuc2l0aW9uRHVyYXRpb246bixjbGFzc0xheW91dDpyLGNsYXNzT3ZlcmxheVRleHQ6byxjbGFzc0Nsb3NlOmF9PWUscz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIiksZD1yP2AsIC4ke3J9YDpcIlwiO3JldHVybiBzLmlkPWAke3R9LS1zdHlsZXNgLHMudHlwZT1cInRleHQvY3NzXCIscy5pbm5lclRleHQ9YFxcbiAgICAgICAgIyR7dH0ke2R9IHtcXG4gICAgICAgICAgICBkaXNwbGF5OiBibG9jaztcXG4gICAgICAgICAgICBoZWlnaHQ6IDEwMCU7XFxuICAgICAgICAgICAgd2lkdGg6IDEwMCU7XFxuICAgICAgICAgICAgbGVmdDogMDtcXG4gICAgICAgICAgICB0b3A6IDA7XFxuICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkO1xcbiAgICAgICAgICAgIHotaW5kZXg6IDIxNDc0ODM2NDc7XFxuICAgICAgICB9XFxuICAgICAgICAjJHt0fSB7XFxuICAgICAgICAgICAgdHJhbnNpdGlvbjogb3BhY2l0eSAke259bXMgZWFzZS1vdXQ7XFxuICAgICAgICAgICAgYmFja2dyb3VuZDogJHtpfTtcXG4gICAgICAgICAgICBvcGFjaXR5OiAwO1xcbiAgICAgICAgfVxcbiAgICBgLG8mJihzLmlubmVyVGV4dCs9YFxcbiAgICAgICAgICAgICAjJHt0fSB7XFxuICAgICAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XFxuICAgICAgICAgICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XFxuICAgICAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xcbiAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgICMke3R9IC4ke299IHtcXG4gICAgICAgICAgICAgICAgY29sb3I6IHdoaXRlO1xcbiAgICAgICAgICAgICAgICBtYXgtd2lkdGg6IDMzMHB4O1xcbiAgICAgICAgICAgICAgICBmb250LXNpemU6IDEuMmVtO1xcbiAgICAgICAgICAgICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7XFxuICAgICAgICAgICAgIH1cXG4gICAgICAgIGApLGEmJihzLmlubmVyVGV4dCs9YFxcbiAgICAgICAgICAgICMke3R9IHtcXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgLiR7cn0gLiR7YX0ge1xcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogZml4ZWQ7XFxuICAgICAgICAgICAgICAgIHJpZ2h0OiAxNnB4O1xcbiAgICAgICAgICAgICAgICB0b3A6IDE2cHg7XFxuICAgICAgICAgICAgICAgIHdpZHRoOiAxNnB4O1xcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDE2cHg7XFxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAuNjtcXG4gICAgICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xcbiAgICAgICAgICAgICAgICB6LWluZGV4OiAzMTQ3NDgzNjQ3O1xcbiAgICAgICAgICAgIH1cXG4gICAgICAgICAgICAuJHtyfSAuJHthfTo6YWZ0ZXIsIC4ke3J9IC4ke2F9OjpiZWZvcmUge1xcbiAgICAgICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XFxuICAgICAgICAgICAgICAgIGxlZnQ6IDhweDtcXG4gICAgICAgICAgICAgICAgY29udGVudDogJyc7XFxuICAgICAgICAgICAgICAgIGhlaWdodDogMTZweDtcXG4gICAgICAgICAgICAgICAgd2lkdGg6IDJweDtcXG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgLiR7cn0gLiR7YX06OmFmdGVyIHtcXG4gICAgICAgICAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoLTQ1ZGVnKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgLiR7cn0gLiR7YX06OmJlZm9yZSB7XFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKDQ1ZGVnKTtcXG4gICAgICAgICAgICB9XFxuICAgICAgICBgKSxzfSh7aWQ6bixiYWNrZ3JvdW5kOmksdHJhbnNpdGlvbkR1cmF0aW9uOnIsY2xhc3NMYXlvdXQ6ZCxjbGFzc092ZXJsYXlUZXh0OmMsY2xhc3NDbG9zZTpsfSkpLHtlbGVtZW50OnQsY2xvc2VFbGVtZW50OnMsbWFpbkVsZW1lbnQ6dX19X2FkZEV2ZW50TGlzdGVuZXIoZSx0KXtlJiZ0JiZlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLHQpfV9yZW1vdmVFdmVudExpc3RlbmVyKGUsdCl7ZSYmdCYmZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIix0KX1fcmVnaXN0ZXJDbGljayhlKXtpZih0aGlzLl91bnJlZ2lzdGVyQ2xpY2smJnRoaXMuX3VucmVnaXN0ZXJDbGljaygpLGUpe2NvbnN0e29uQ2xpY2s6dCxvbkNsaWNrQ2xvc2U6aX09ZTt0aGlzLl9hZGRFdmVudExpc3RlbmVyKHRoaXMuX2VsZW1lbnQsdCksdGhpcy5fYWRkRXZlbnRMaXN0ZW5lcih0aGlzLl9jbG9zZUVsZW1lbnQsaSksdGhpcy5fdW5yZWdpc3RlckNsaWNrPSgpPT57dGhpcy5fcmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLl9lbGVtZW50LHQpLHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5fY2xvc2VFbGVtZW50LGkpLHRoaXMuX3VucmVnaXN0ZXJDbGljaz12b2lkIDB9fX1fcmVtb3ZlQWZ0ZXJUcmFuc2l0aW9uKCl7Y29uc3QgZT10PT57XCJvcGFjaXR5XCI9PT10LnByb3BlcnR5TmFtZSYmKHRoaXMuX21haW5FbGVtZW50LnBhcmVudEVsZW1lbnQmJnRoaXMuX21haW5FbGVtZW50LnJlbW92ZSgpLHRoaXMuX2VsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIixlKSl9O3RoaXMuX2VsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRyYW5zaXRpb25lbmRcIixlKX19Y29uc3QgaGU9e3NpemU6NzAsY29sb3I6XCIjZDlkOWQ5XCIsYmFja2dyb3VuZENvbG9yOlwiI2ZmZmZmZlwifSx5ZT1cImVtYmVkZGVkLWNoZWNrb3V0LWxvYWRpbmctaW5kaWNhdG9yLXJvdGF0aW9uXCI7Y2xhc3MgbWV7Y29uc3RydWN0b3IoZSl7dGhpcy5zdHlsZXM9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGhlKSxlJiZlLnN0eWxlcyksdGhpcy5jb250YWluZXJTdHlsZXM9T2JqZWN0LmFzc2lnbih7fSxlJiZlLmNvbnRhaW5lclN0eWxlcyksdGhpcy5kZWZpbmVBbmltYXRpb24oKSx0aGlzLmNvbnRhaW5lcj10aGlzLmJ1aWxkQ29udGFpbmVyKCksdGhpcy5pbmRpY2F0b3I9dGhpcy5idWlsZEluZGljYXRvcigpLHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuaW5kaWNhdG9yKX1zaG93KGUpe2lmKGUpe2NvbnN0IHQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSk7aWYoIXQpdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIGF0dGFjaCB0aGUgbG9hZGluZyBpbmRpY2F0b3IgYmVjYXVzZSB0aGUgcGFyZW50IElEIGlzIG5vdCB2YWxpZC5cIik7dC5hcHBlbmRDaGlsZCh0aGlzLmNvbnRhaW5lcil9dGhpcy5jb250YWluZXIuc3R5bGUudmlzaWJpbGl0eT1cInZpc2libGVcIix0aGlzLmNvbnRhaW5lci5zdHlsZS5vcGFjaXR5PVwiMVwifWhpZGUoKXtjb25zdCBlPSgpPT57dGhpcy5jb250YWluZXIuc3R5bGUudmlzaWJpbGl0eT1cImhpZGRlblwiLHRoaXMuY29udGFpbmVyLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsZSl9O3RoaXMuY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsZSksdGhpcy5jb250YWluZXIuc3R5bGUub3BhY2l0eT1cIjBcIn1idWlsZENvbnRhaW5lcigpe2NvbnN0IGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtyZXR1cm4gZS5zdHlsZS5kaXNwbGF5PVwiYmxvY2tcIixlLnN0eWxlLmJvdHRvbT1cIjBcIixlLnN0eWxlLmxlZnQ9XCIwXCIsZS5zdHlsZS5oZWlnaHQ9XCIxMDAlXCIsZS5zdHlsZS53aWR0aD1cIjEwMCVcIixlLnN0eWxlLnBvc2l0aW9uPVwiYWJzb2x1dGVcIixlLnN0eWxlLnJpZ2h0PVwiMFwiLGUuc3R5bGUudG9wPVwiMFwiLGUuc3R5bGUudHJhbnNpdGlvbj1cImFsbCAyNTBtcyBlYXNlLW91dFwiLGUuc3R5bGUub3BhY2l0eT1cIjBcIix0aGlzLnNldFN0eWxlQXR0cmlidXRlKGUsdGhpcy5jb250YWluZXJTdHlsZXMpLGV9YnVpbGRJbmRpY2F0b3IoKXtjb25zdCBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7cmV0dXJuIGUuc3R5bGUuZGlzcGxheT1cImJsb2NrXCIsZS5zdHlsZS53aWR0aD1gJHt0aGlzLnN0eWxlcy5zaXplfXB4YCxlLnN0eWxlLmhlaWdodD1gJHt0aGlzLnN0eWxlcy5zaXplfXB4YCxlLnN0eWxlLmJvcmRlclJhZGl1cz1gJHt0aGlzLnN0eWxlcy5zaXplfXB4YCxlLnN0eWxlLmJvcmRlcj1cInNvbGlkIDFweFwiLGUuc3R5bGUuYm9yZGVyQ29sb3I9YCR7dGhpcy5zdHlsZXMuYmFja2dyb3VuZENvbG9yfSAke3RoaXMuc3R5bGVzLmJhY2tncm91bmRDb2xvcn0gJHt0aGlzLnN0eWxlcy5jb2xvcn0gJHt0aGlzLnN0eWxlcy5jb2xvcn1gLGUuc3R5bGUubWFyZ2luPVwiMCBhdXRvXCIsZS5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCIsZS5zdHlsZS5sZWZ0PVwiMFwiLGUuc3R5bGUucmlnaHQ9XCIwXCIsZS5zdHlsZS50b3A9XCI1MCVcIixlLnN0eWxlLnRyYW5zZm9ybT1cInRyYW5zbGF0ZVkoLTUwJSkgcm90YXRlKDBkZWcpXCIsZS5zdHlsZS50cmFuc2Zvcm1TdHlsZT1cInByZXNlcnZlLTNkXCIsZS5zdHlsZS5hbmltYXRpb249YCR7eWV9IDUwMG1zIGluZmluaXRlIGN1YmljLWJlemllcigwLjY5LCAwLjMxLCAwLjU2LCAwLjgzKWAsZX1zZXRTdHlsZUF0dHJpYnV0ZShlLHQpe09iamVjdC5rZXlzKHQpLmZvckVhY2goaT0+e2Uuc3R5bGUuc2V0UHJvcGVydHkoaSx0W2ldKX0pfWRlZmluZUFuaW1hdGlvbigpe3ZhciBlO2lmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHllKSlyZXR1cm47Y29uc3QgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7dC5pZD15ZSxudWxsPT09KGU9ZG9jdW1lbnQuaGVhZCl8fHZvaWQgMD09PWV8fGUuYXBwZW5kQ2hpbGQodCksdC5zaGVldCBpbnN0YW5jZW9mIENTU1N0eWxlU2hlZXQmJnQuc2hlZXQuaW5zZXJ0UnVsZShgXFxuICAgICAgICAgICAgICAgIEBrZXlmcmFtZXMgJHt5ZX0ge1xcbiAgICAgICAgICAgICAgICAgICAgMCUgeyB0cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLTUwJSkgcm90YXRlKDBkZWcpOyB9XFxuICAgICAgICAgICAgICAgICAgICAxMDAlIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpIHJvdGF0ZSgzNjBkZWcpOyB9XFxuICAgICAgICAgICAgICAgIH1cXG4gICAgICAgICAgICBgLDApfX1jb25zdCBwZT17XCJiYWNrZ3JvdW5kLWNvbG9yXCI6XCJyZ2JhKDAsIDAsIDAsIDAuNClcIixcInotaW5kZXhcIjpcIjEwMDBcIn07ZnVuY3Rpb24gZ2UoZSl7cmV0dXJuXCJvYmplY3RcIj09dHlwZW9mIGUmJm51bGwhPT1lJiZcIm5hbWVcImluIGUmJlwiQnJhaW50cmVlRXJyb3JcIj09PWUubmFtZX1mdW5jdGlvbiB2ZShlKXtyZXR1cm57cmVjaXBpZW50TmFtZTpgJHtlLmZpcnN0TmFtZX0gJHtlLmxhc3ROYW1lfWAsbGluZTE6ZS5hZGRyZXNzMSxsaW5lMjplLmFkZHJlc3MyLGNpdHk6ZS5jaXR5LHN0YXRlOmUuc3RhdGVPclByb3ZpbmNlQ29kZSxwb3N0YWxDb2RlOmUucG9zdGFsQ29kZSxjb3VudHJ5Q29kZTplLmNvdW50cnlDb2RlLHBob25lOmUucGhvbmV9fXZhciBmZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBiZXtjb25zdHJ1Y3RvcihlLHQsaSxuKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT10LHRoaXMuYnJhaW50cmVlTWVzc2FnZXM9aSx0aGlzLmxvYWRpbmdJbmRpY2F0b3I9bix0aGlzLmJyYWludHJlZUhvc3RXaW5kb3c9d2luZG93fWluaXRpYWxpemUoZSl7cmV0dXJuIGZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWU6dCxtZXRob2RJZDppfT1lO2lmKHRoaXMuYnJhaW50cmVlPXQsdGhpcy5wYXltZW50TWV0aG9kJiZ0aGlzLnBheW1lbnRNZXRob2Qubm9uY2V8fCh0aGlzLnBheW1lbnRNZXRob2Q9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSkpLHRoaXMucGF5bWVudE1ldGhvZC5jbGllbnRUb2tlbiYmKG51bGw9PXQ/dm9pZCAwOnQuYmFubmVyQ29udGFpbmVySWQpKXJldHVybiB5aWVsZCB0aGlzLmxvYWRQYXlwYWwoKSx0aGlzLmxvYWRQYXlwYWxDaGVja291dEluc3RhbmNlKCk7aWYodGhpcy5wYXltZW50TWV0aG9kLmNsaWVudFRva2VuKXJldHVybiB0aGlzLmxvYWRQYXlwYWwoKTtjb25zdCBuPXlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKTtpZih0aGlzLnBheW1lbnRNZXRob2Q9bi5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSxudWxsPT10P3ZvaWQgMDp0LmJhbm5lckNvbnRhaW5lcklkKXJldHVybiB0aGlzLmxvYWRQYXlwYWxDaGVja291dEluc3RhbmNlKCk7aWYoIXRoaXMucGF5bWVudE1ldGhvZC5jbGllbnRUb2tlbil0aHJvdyBuZXcgVShqLk1pc3NpbmdQYXltZW50TWV0aG9kKTtyZXR1cm4gdGhpcy5sb2FkUGF5cGFsKCl9KX1leGVjdXRlKGUsdCl7dmFyIGk7cmV0dXJuIGZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Om59PWUscj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSkse29uRXJyb3I6b309dGhpcy5icmFpbnRyZWV8fHt9O2lmKCFuKXRocm93IG5ldyBSKFtcInBheW1lbnRcIl0pO3RyeXtjb25zdCBlPXlpZWxkIHRoaXMucHJlcGFyZVBheW1lbnREYXRhKG4sci51c2VTdG9yZUNyZWRpdCk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKHIsdCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoZSl9Y2F0Y2goZSl7dGhpcy5pc1Byb3ZpZGVyRXJyb3IoZSkmJih5aWVsZCB0aGlzLmxvYWRQYXlwYWwoKSxudWxsPT09KGk9dGhpcy5wYXlwYWxCdXR0b25SZW5kZXIpfHx2b2lkIDA9PT1pfHxpLmNsb3NlKCkseWllbGQgdGhpcy5sb2FkUGF5cGFsQ2hlY2tvdXRJbnN0YW5jZSgpLHlpZWxkIG5ldyBQcm9taXNlKChlLHQpPT57byYmXCJmdW5jdGlvblwiPT10eXBlb2YgbyYmbyhuZXcgRXJyb3IoXCJJTlNUUlVNRU5UX0RFQ0xJTkVEXCIpKSx0KCl9KSksdGhpcy5oYW5kbGVFcnJvcihlKX19KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgVyl9ZGVpbml0aWFsaXplKCl7dmFyIGU7cmV0dXJuIHRoaXMuYnJhaW50cmVlVG9rZW5pemVQYXlsb2FkPXZvaWQgMCxudWxsPT09KGU9dGhpcy5wYXlwYWxCdXR0b25SZW5kZXIpfHx2b2lkIDA9PT1lfHxlLmNsb3NlKCksdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudGVhcmRvd24oKX1wcmVwYXJlUGF5bWVudERhdGEoZSx0KXt2YXIgaTtyZXR1cm4gZmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkscj1uLmdldE91dHN0YW5kaW5nQmFsYW5jZSh0KSxvPW4uZ2V0U3RvcmVDb25maWcoKTtpZighcil0aHJvdyBuZXcgVShqLk1pc3NpbmdDaGVja291dCk7aWYoIW8pdGhyb3cgbmV3IFUoai5NaXNzaW5nQ2hlY2tvdXRDb25maWcpO2lmKCF0aGlzLnBheW1lbnRNZXRob2QpdGhyb3cgbmV3IEQoQy5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO2NvbnN0e2N1cnJlbmN5OmEsc3RvcmVQcm9maWxlOntzdG9yZUxhbmd1YWdlOnN9fT1vLHtub25jZTpkLGNvbmZpZzp7aXNWYXVsdGluZ0VuYWJsZWQ6bH19PXRoaXMucGF5bWVudE1ldGhvZCx7bWV0aG9kSWQ6YyxwYXltZW50RGF0YTp1PXt9fT1lLGg9KG51bGw9PT0oaT10aGlzLmJyYWludHJlZVRva2VuaXplUGF5bG9hZCl8fHZvaWQgMD09PWk/dm9pZCAwOmkubm9uY2UpfHxkO2lmKGgpe2NvbnN0IHQ9eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKGMpO3JldHVybiB0aGlzLnBheW1lbnRNZXRob2Q9dC5nZXRQYXltZW50TWV0aG9kKGMpLE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7cGF5bWVudERhdGE6dGhpcy5mb3JtYXR0ZWRQYXlsb2FkKGgpfSl9aWYoSCh1KXx8KHk9dSxCb29sZWFuKHkuaW5zdHJ1bWVudElkKSYmIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh5LFwiY2NOdW1iZXJcIikmJiFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoeSxcImNjQ3Z2XCIpKSl7aWYoIWwpdGhyb3cgbmV3IFYoXCJWYXVsdGluZyBpcyBkaXNhYmxlZCBidXQgYSB2YXVsdGVkIGluc3RydW1lbnQgd2FzIGJlaW5nIHVzZWQgZm9yIHRoaXMgdHJhbnNhY3Rpb25cIik7cmV0dXJuIFByb21pc2UucmVzb2x2ZShlKX12YXIgeTtpZighcSh1KSl0aHJvdyBuZXcgVShqLk1pc3NpbmdQYXltZW50KTtjb25zdHtzaG91bGRTYXZlSW5zdHJ1bWVudDptLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6cH09dTtpZihtJiYhbCl0aHJvdyBuZXcgVihcIlZhdWx0aW5nIGlzIGRpc2FibGVkIGJ1dCBzaG91bGRTYXZlSW5zdHJ1bWVudCBpcyBzZXQgdG8gdHJ1ZVwiKTtjb25zdCBnPW4uZ2V0U2hpcHBpbmdBZGRyZXNzKCksdj1nP3ZlKGcpOnZvaWQgMDtyZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnBheXBhbCh7YW1vdW50OnIsbG9jYWxlOnMsY3VycmVuY3k6YS5jb2RlLG9mZmVyQ3JlZGl0OlwiYnJhaW50cmVlcGF5cGFsY3JlZGl0XCI9PT10aGlzLnBheW1lbnRNZXRob2QuaWQsc2hpcHBpbmdBZGRyZXNzT3ZlcnJpZGU6dixzaG91bGRTYXZlSW5zdHJ1bWVudDptfHwhMSxzaGlwcGluZ0FkZHJlc3NFZGl0YWJsZTohMX0pLHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFNlc3Npb25JZCgpXSkudGhlbigoW3tub25jZTp0LGRldGFpbHM6aX09e30sbl0pPT5PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3BheW1lbnREYXRhOnRoaXMuZm9ybWF0dGVkUGF5bG9hZCh0LGkmJmkuZW1haWwsbixtLHApfSkpfSl9Zm9ybWF0dGVkUGF5bG9hZChlLHQsaSxuLHIpe3JldHVybntmb3JtYXR0ZWRQYXlsb2FkOnt2YXVsdF9wYXltZW50X2luc3RydW1lbnQ6bnx8bnVsbCxzZXRfYXNfZGVmYXVsdF9zdG9yZWRfaW5zdHJ1bWVudDpyfHxudWxsLGRldmljZV9pbmZvOml8fG51bGwscGF5cGFsX2FjY291bnQ6e3Rva2VuOmUsZW1haWw6dHx8bnVsbH19fX1sb2FkUGF5cGFsQ2hlY2tvdXRJbnN0YW5jZSgpe3JldHVybiBmZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7Y2xpZW50VG9rZW46ZSxpbml0aWFsaXphdGlvbkRhdGE6dCxpZDppfT10aGlzLnBheW1lbnRNZXRob2R8fHt9O2lmKCFlKXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRNZXRob2QpO3RyeXt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKGUpO2NvbnN0IG49e2N1cnJlbmN5OnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZSxpbnRlbnQ6bnVsbD09dD92b2lkIDA6dC5pbnRlbnQsaXNDcmVkaXRFbmFibGVkOm51bGw9PXQ/dm9pZCAwOnQuaXNDcmVkaXRFbmFibGVkfSxyPVwiYnJhaW50cmVlcGF5cGFsY3JlZGl0XCI9PT1pfHwhKG51bGw9PXQ/dm9pZCAwOnQuaXNDcmVkaXRFbmFibGVkKTt5aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRQYXlwYWxDaGVja291dChuLGU9Pnt2YXIgdDtyJiZpJiYobnVsbD09PSh0PXRoaXMuYnJhaW50cmVlKXx8dm9pZCAwPT09dD92b2lkIDA6dC5iYW5uZXJDb250YWluZXJJZCkmJnRoaXMucmVuZGVyUGF5UGFsTWVzc2FnZXMoaSx0aGlzLmJyYWludHJlZS5iYW5uZXJDb250YWluZXJJZCksdGhpcy5yZW5kZXJQYXlQYWxCdXR0b24oZSl9LHRoaXMuaGFuZGxlRXJyb3IpfWNhdGNoKGUpe3RoaXMuaGFuZGxlRXJyb3IoZSl9fSl9cmVuZGVyUGF5UGFsTWVzc2FnZXMoZSx0KXt0aGlzLmJyYWludHJlZU1lc3NhZ2VzLnJlbmRlcihlLHQsc2UuUEFZTUVOVCl9cmVuZGVyUGF5UGFsQnV0dG9uKGUpe2NvbnN0e29uUGF5bWVudEVycm9yOnQsc3VibWl0Rm9ybTppLG9uUmVuZGVyQnV0dG9uOm4sY29udGFpbmVySWQ6cixvbkVycm9yOm99PXRoaXMuYnJhaW50cmVlfHx7fTtpZighcilyZXR1cm47aWYoIXRoaXMucGF5bWVudE1ldGhvZCl0aHJvdyBuZXcgRChDLlBheW1lbnROb3RJbml0aWFsaXplZCk7dGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyPXIuc3BsaXQoXCIjXCIpWzFdO2NvbnN0e2lkOmEsY29uZmlnOnt0ZXN0TW9kZTpzfX09dGhpcy5wYXltZW50TWV0aG9kLHtwYXlwYWw6ZH09dGhpcy5icmFpbnRyZWVIb3N0V2luZG93LGw9bnVsbD09ZD92b2lkIDA6ZC5GVU5ESU5HLlBBWVBBTDtkJiZsPyh0aGlzLnBheXBhbEJ1dHRvblJlbmRlcj1kLkJ1dHRvbnMoe2VudjpzP1wic2FuZGJveFwiOlwicHJvZHVjdGlvblwiLGNvbW1pdDohMSxmdW5kaW5nU291cmNlOmwsb25DbGljazooKT0+e3RoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMCl9LGNyZWF0ZU9yZGVyOigpPT50aGlzLnNldHVwUGF5bWVudChlLGEsdCksb25BcHByb3ZlOnQ9PmZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0aGlzLmJyYWludHJlZVRva2VuaXplUGF5bG9hZD15aWVsZCB0aGlzLnRva2VuaXplUGF5bWVudE9yVGhyb3codCxlKSxpJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBpJiZpKCl9KSxvbkNhbmNlbDooKT0+e3RoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSl9LG9uRXJyb3I6ZT0+e3RoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksbnVsbD09b3x8byhlKX19KSxuJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuJiZuKCksdGhpcy5wYXlwYWxCdXR0b25SZW5kZXIuaXNFbGlnaWJsZSgpJiZ0aGlzLnBheXBhbEJ1dHRvblJlbmRlci5yZW5kZXIoYCR7cn1gKSk6dGhpcy5yZW1vdmVFbGVtZW50KHIuc3BsaXQoXCIjXCIpWzFdKX1zZXR1cFBheW1lbnQoZSx0LGkpe3JldHVybiBmZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTt0cnl7Y29uc3QgaT1uLmdldEN1c3RvbWVyKCkscj1uLmdldFBheW1lbnRNZXRob2RPclRocm93KHQpLG89bi5nZXRDaGVja291dE9yVGhyb3coKS5vdXRzdGFuZGluZ0JhbGFuY2UsYT1uLmdldFN0b3JlQ29uZmlnT3JUaHJvdygpLmN1cnJlbmN5LmNvZGUscz1uLmdldFNoaXBwaW5nQWRkcmVzcygpfHwobnVsbD09aT92b2lkIDA6aS5hZGRyZXNzZXNbMF0pLGQ9cz92ZShzKTp2b2lkIDA7cmV0dXJuIHlpZWxkIGUuY3JlYXRlUGF5bWVudCh7ZmxvdzpcImNoZWNrb3V0XCIsZW5hYmxlU2hpcHBpbmdBZGRyZXNzOiEwLHNoaXBwaW5nQWRkcmVzc0VkaXRhYmxlOiExLHNoaXBwaW5nQWRkcmVzc092ZXJyaWRlOmQsYW1vdW50Om8sY3VycmVuY3k6YSxvZmZlckNyZWRpdDohMSxpbnRlbnQ6ci5pbml0aWFsaXphdGlvbkRhdGEuaW50ZW50fSl9Y2F0Y2goZSl7dGhyb3cgaSYmKGdlKGUpfHxlIGluc3RhbmNlb2YgcCkmJmkoZSksZX19KX10b2tlbml6ZVBheW1lbnRPclRocm93KGUsdCxpKXtyZXR1cm4gZmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtyZXR1cm4geWllbGQgdC50b2tlbml6ZVBheW1lbnQoZSl9Y2F0Y2goZSl7dGhyb3cgaSYmKGdlKGUpfHxlIGluc3RhbmNlb2YgcCkmJmkoZSksZX19KX1sb2FkUGF5cGFsKCl7cmV0dXJuIGZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtjbGllbnRUb2tlbjplLGluaXRpYWxpemF0aW9uRGF0YTp0fT10aGlzLnBheW1lbnRNZXRob2R8fHt9O2lmKCFlfHwhdCl0aHJvdyBuZXcgVShqLk1pc3NpbmdQYXltZW50TWV0aG9kKTt0cnl7dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuaW5pdGlhbGl6ZShlKSx5aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRQYXlwYWwoKX1jYXRjaChlKXt0aGlzLmhhbmRsZUVycm9yKGUpfXJldHVybiBQcm9taXNlLnJlc29sdmUoKX0pfWhhbmRsZUVycm9yKGUpe2lmKCFnZShlKSl0aHJvdyBlO2lmKFwiUEFZUEFMX1BPUFVQX0NMT1NFRFwiPT09ZS5jb2RlKXRocm93IG5ldyBRKGUubWVzc2FnZSk7dGhyb3cgbmV3ICQoZS5tZXNzYWdlKX1pc1Byb3ZpZGVyRXJyb3IoZSl7dmFyIHQsaSxuO3JldHVybiEhZnVuY3Rpb24oZSl7cmV0dXJuXCJvYmplY3RcIj09dHlwZW9mIGUmJm51bGwhPT1lJiZcImVycm9yc1wiaW4gZX0oZSkmJlwiMjA0NlwiPT09KG51bGw9PT0obj1udWxsPT09KGk9KChudWxsPT09KHQ9bnVsbD09ZT92b2lkIDA6ZS5lcnJvcnMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmZpbHRlcihlPT5lLnByb3ZpZGVyX2Vycm9yKSl8fFtdKVswXSl8fHZvaWQgMD09PWk/dm9pZCAwOmkucHJvdmlkZXJfZXJyb3IpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmNvZGUpfXJlbW92ZUVsZW1lbnQoZSl7Y29uc3QgdD1lJiZkb2N1bWVudC5nZXRFbGVtZW50QnlJZChlKTt0JiZ0LnJlbW92ZSgpfXRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoZSl7ZSYmdGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyP3RoaXMubG9hZGluZ0luZGljYXRvci5zaG93KHRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcik6dGhpcy5sb2FkaW5nSW5kaWNhdG9yLmhpZGUoKX19Y29uc3Qgd2U9TCh0PT57Y29uc3QgaT13aW5kb3csbj1uZXcgdWUscj1uZXcgRih0KSxvPW5ldyBsZShuZXcgeihlKCksaSxyKSxpLG4pLGE9bmV3IGNlKHQpO3JldHVybiBuZXcgYmUodCxvLGEsbmV3IG1lKHtjb250YWluZXJTdHlsZXM6cGV9KSl9LFt7aWQ6XCJicmFpbnRyZWVwYXlwYWxcIn0se2lkOlwiYnJhaW50cmVlcGF5cGFsY3JlZGl0XCJ9XSk7dmFyIENlOyFmdW5jdGlvbihlKXtlLkpzb249XCJhcHBsaWNhdGlvbi9qc29uXCIsZS5Kc29uVjE9XCJhcHBsaWNhdGlvbi92bmQuYmMudjEranNvblwifShDZXx8KENlPXt9KSk7Y29uc3QgU2U9Q2UsUGU9e1wiWC1DaGVja291dC1TREstVmVyc2lvblwiOlwiMS44NjcuMFwifTtjbGFzcyBJZXtjb25zdHJ1Y3RvcihlKXt0aGlzLnJlcXVlc3RTZW5kZXI9ZX1nZXRPcmRlclN0YXR1cyhlPVwiYnJhaW50cmVlbG9jYWxtZXRob2RzXCIsdCl7cmV0dXJuIGk9dGhpcyxuPXZvaWQgMCxvPWZ1bmN0aW9uKigpe2NvbnN0IGk9YC9hcGkvc3RvcmVmcm9udC9pbml0aWFsaXphdGlvbi8ke2V9YCxuPU9iamVjdC5hc3NpZ24oe1wiWC1BUEktSU5URVJOQUxcIjpcIlRoaXMgQVBJIGVuZHBvaW50IGlzIGZvciBpbnRlcm5hbCB1c2Ugb25seSBhbmQgbWF5IGNoYW5nZSBpbiB0aGUgZnV0dXJlXCIsXCJDb250ZW50LVR5cGVcIjpTZS5Kc29ufSxQZSk7cmV0dXJuKHlpZWxkIHRoaXMucmVxdWVzdFNlbmRlci5nZXQoaSxPYmplY3QuYXNzaWduKHtoZWFkZXJzOm59LHQpKSkuYm9keX0sbmV3KChyPXZvaWQgMCl8fChyPVByb21pc2UpKShmdW5jdGlvbihlLHQpe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qoby5uZXh0KGUpKX1jYXRjaChlKXt0KGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG8udGhyb3coZSkpfWNhdGNoKGUpe3QoZSl9fWZ1bmN0aW9uIGQodCl7dmFyIGk7dC5kb25lP2UodC52YWx1ZSk6KGk9dC52YWx1ZSxpIGluc3RhbmNlb2Ygcj9pOm5ldyByKGZ1bmN0aW9uKGUpe2UoaSl9KSkudGhlbihhLHMpfWQoKG89by5hcHBseShpLG58fFtdKSkubmV4dCgpKX0pO3ZhciBpLG4scixvfX1jb25zdCBPZT17Ym9keTp7fSxoZWFkZXJzOnt9LHN0YXR1czowfTtjbGFzcyBrZSBleHRlbmRzIHB7Y29uc3RydWN0b3IoZSx7bWVzc2FnZTp0LGVycm9yczppfT17fSl7Y29uc3R7Ym9keTpuLGhlYWRlcnM6cixzdGF0dXM6b309ZXx8T2U7c3VwZXIodHx8XCJBbiB1bmV4cGVjdGVkIGVycm9yIGhhcyBvY2N1cnJlZC5cIiksdGhpcy5uYW1lPVwiUmVxdWVzdEVycm9yXCIsdGhpcy50eXBlPVwicmVxdWVzdFwiLHRoaXMuYm9keT1uLHRoaXMuaGVhZGVycz1yLHRoaXMuc3RhdHVzPW8sdGhpcy5lcnJvcnM9aXx8W119fWNsYXNzIEVlIGV4dGVuZHMga2V7Y29uc3RydWN0b3IoZSl7c3VwZXIoZSx7bWVzc2FnZTpcIlRoZXJlIGlzIGEgcHJvYmxlbSBwcm9jZXNzaW5nIHlvdXIgcGF5bWVudC4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIn0pLHRoaXMubmFtZT1cIlBheW1lbnRNZXRob2RJbnZhbGlkRXJyb3JcIix0aGlzLnR5cGU9XCJwYXltZW50X21ldGhvZF9pbnZhbGlkXCJ9fWNsYXNzIFRlIGV4dGVuZHMga2V7Y29uc3RydWN0b3IoZSl7c3VwZXIoZSx7bWVzc2FnZTpcIlRoZSByZXF1ZXN0IGhhcyB0aW1lZCBvdXQgb3IgYWJvcnRlZC5cIn0pLHRoaXMubmFtZT1cIlRpbWVvdXRFcnJvclwiLHRoaXMudHlwZT1cInRpbWVvdXRcIn19dmFyIEFlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIHple2NvbnN0cnVjdG9yKGUsdCxpLG4scj0zZTMsYT0zZTUpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYnJhaW50cmVlU2RrPXQsdGhpcy5icmFpbnRyZWVSZXF1ZXN0U2VuZGVyPWksdGhpcy5sb2FkaW5nSW5kaWNhdG9yPW4sdGhpcy5wb2xsaW5nSW50ZXJ2YWw9cix0aGlzLm1heFBvbGxpbmdJbnRlcnZhbFRpbWU9YSx0aGlzLmlzTFBNc1VwZGF0ZUV4cGVyaW1lbnRFbmFibGVkPSExLHRoaXMucG9sbGluZ1RpbWVyPTAsdGhpcy5zdG9wUG9sbGluZz1vLHRoaXMuaXNQb2xsaW5nRW5hYmxlZD0hMX1pbml0aWFsaXplKGUpe3JldHVybiBBZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7Z2F0ZXdheUlkOnQsbWV0aG9kSWQ6aSxicmFpbnRyZWVsb2NhbG1ldGhvZHM6bn09ZTtpZih0aGlzLmdhdGV3YXlJZD10LCFpKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCF0KXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmdhdGV3YXlJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighbil0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVsb2NhbG1ldGhvZHNcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7dGhpcy5icmFpbnRyZWVsb2NhbG1ldGhvZHM9bix0aGlzLmxvYWRpbmdJbmRpY2F0b3JDb250YWluZXI9bi5jb250YWluZXIuc3BsaXQoXCIjXCIpWzFdLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZCh0KTtjb25zdCByPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG89ci5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyh0KSx7Y2xpZW50VG9rZW46YSxjb25maWc6cyxpbml0aWFsaXphdGlvbkRhdGE6ZH09byxsPXIuZ2V0U3RvcmVDb25maWdPclRocm93KCkuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlcztpZih0aGlzLmlzUG9sbGluZ0VuYWJsZWQ9eChsLFwiUEFZUEFMLTUyNTguYnJhaW50cmVlX2xvY2FsX21ldGhvZHNfcG9sbGluZ1wiKSx0aGlzLmlzTFBNc1VwZGF0ZUV4cGVyaW1lbnRFbmFibGVkPXgobCxcIlBBWVBBTC00ODUzLmFkZF9uZXdfcGF5bWVudF9mbG93X2Zvcl9icmFpbnRyZWVfbHBtc1wiKSwhYXx8IWR8fCFzLm1lcmNoYW50SWQpdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudE1ldGhvZCk7dHJ5e3RoaXMuYnJhaW50cmVlU2RrLmluaXRpYWxpemUoYSksdGhpcy5pc05vbkluc3RhbnRQYXltZW50TWV0aG9kKGkpfHwodGhpcy5icmFpbnRyZWVMb2NhbFBheW1lbnQ9eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0QnJhaW50cmVlTG9jYWxQYXltZW50KHMubWVyY2hhbnRJZCkpfWNhdGNoKGUpe3RoaXMuaGFuZGxlRXJyb3IoZSl9fSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFcpfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBBZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksUHJvbWlzZS5yZXNvbHZlKCl9KX1leGVjdXRlKGUsdCl7cmV0dXJuIEFlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Oml9PWUsbj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSk7aWYoIWkpdGhyb3cgbmV3IFIoW1wicGF5bWVudFwiXSk7Y29uc3R7bWV0aG9kSWQ6cn09aTt0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITApLHRoaXMuaXNOb25JbnN0YW50UGF5bWVudE1ldGhvZChyKT95aWVsZCB0aGlzLmV4ZWN1dGVXaXRoTm90SW5zdGFudExQTShyKTp5aWVsZCB0aGlzLmV4ZWN1dGVXaXRoSW5zdGFudExQTShyLG4sdCl9KX1leGVjdXRlV2l0aE5vdEluc3RhbnRMUE0oZSl7cmV0dXJuIEFlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7Y29uc3QgdD15aWVsZCB0aGlzLmdldExQTXNCYXNpY1BheW1lbnREYXRhKCk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoe21ldGhvZElkOmUscGF5bWVudERhdGE6T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHQpLHtmb3JtYXR0ZWRQYXlsb2FkOnttZXRob2Q6ZX19KX0pfWNhdGNoKGUpe2lmKHRoaXMuaXNCcmFpbnRyZWVSZWRpcmVjdEVycm9yKGUpKXtjb25zdCB0PWUuYm9keS5hZGRpdGlvbmFsX2FjdGlvbl9yZXF1aXJlZC5kYXRhLnJlZGlyZWN0X3VybDtyZXR1cm4gbmV3IFByb21pc2UoKGUsaSk9Pnt3aW5kb3cubG9jYXRpb24ucmVwbGFjZSh0KSx0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLGkoKX0pfXJldHVybiB0aGlzLmhhbmRsZUVycm9yKGUpLFByb21pc2UucmVqZWN0KGUpfX0pfWV4ZWN1dGVXaXRoSW5zdGFudExQTShlLHQsaSl7cmV0dXJuIEFlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5icmFpbnRyZWVMb2NhbFBheW1lbnQpdGhyb3cgbmV3IEVlO3lpZWxkIG5ldyBQcm9taXNlKChuLHIpPT57dmFyIG87bnVsbD09PShvPXRoaXMuYnJhaW50cmVlTG9jYWxQYXltZW50KXx8dm9pZCAwPT09b3x8by5zdGFydFBheW1lbnQodGhpcy5nZXRJbnN0YW50TFBNQ29uZmlnKGUsdCxpKSx0aGlzLmdldEluc3RhbnRMUE1DYWxsYmFjayhuLHIsZSx0LGkpKX0pfSl9Z2V0TFBNc0Jhc2ljUGF5bWVudERhdGEoKXtyZXR1cm4gQWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2RldmljZURhdGE6ZX09eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0RGF0YUNvbGxlY3Rvck9yVGhyb3coKTtyZXR1cm57ZGV2aWNlU2Vzc2lvbklkOmV9fSl9Z2V0SW5zdGFudExQTUNvbmZpZyhlLHQsaSl7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPW4uZ2V0Q2FydE9yVGhyb3coKSxvPW4uZ2V0QmlsbGluZ0FkZHJlc3NPclRocm93KCkse2ZpcnN0TmFtZTphLGxhc3ROYW1lOnMsY291bnRyeUNvZGU6ZH09byx7Y3VycmVuY3k6bCxlbWFpbDpjLGxpbmVJdGVtczp1fT1yLGg9dS5waHlzaWNhbEl0ZW1zLmxlbmd0aD4wLHk9bi5nZXRDaGVja291dE9yVGhyb3coKS5vdXRzdGFuZGluZ0JhbGFuY2UsbT1uLmdldFN0b3JlQ29uZmlnT3JUaHJvdygpLmxpbmtzLmNoZWNrb3V0TGluaztyZXR1cm57cGF5bWVudFR5cGU6ZSxhbW91bnQ6eSxmYWxsYmFjazp7dXJsOm0sYnV0dG9uVGV4dDpcIkNvbXBsZXRlIFBheW1lbnRcIn0sY3VycmVuY3lDb2RlOmwuY29kZSxzaGlwcGluZ0FkZHJlc3NSZXF1aXJlZDpoLGVtYWlsOmMsZ2l2ZW5OYW1lOmEsc3VybmFtZTpzLGFkZHJlc3M6e2NvdW50cnlDb2RlOmR9LG9uUGF5bWVudFN0YXJ0OihuLHIpPT5BZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuaXNMUE1zVXBkYXRlRXhwZXJpbWVudEVuYWJsZWQpcmV0dXJuIHRoaXMub3JkZXJJZD1uLnBheW1lbnRJZCx2b2lkIHIoKTtjb25zdCBvPXlpZWxkIHRoaXMuZ2V0TFBNc0Jhc2ljUGF5bWVudERhdGEoKSxhPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxvKSx7Zm9ybWF0dGVkUGF5bG9hZDp7bWV0aG9kOmUsW2Ake2V9X2FjY291bnRgXTp7b3JkZXJfaWQ6bi5wYXltZW50SWR9fX0pO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIodCxpKSx5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudCh7bWV0aG9kSWQ6ZSxwYXltZW50RGF0YTphfSl9Y2F0Y2godCl7aWYodGhpcy5pc0JyYWludHJlZU9yZGVyU2F2ZWRSZXNwb25zZSh0KSYmdC5ib2R5LmFkZGl0aW9uYWxfYWN0aW9uX3JlcXVpcmVkLmRhdGEub3JkZXJfaWRfc2F2ZWRfc3VjY2Vzc2Z1bGx5KXJldHVybiByKCksdGhpcy5pc1BvbGxpbmdFbmFibGVkP25ldyBQcm9taXNlKCh0LGkpPT57dGhpcy5pbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbShlLHQsaSx0aGlzLmdhdGV3YXlJZCl9KTp2b2lkIDA7dGhyb3cgdH19KX19Z2V0SW5zdGFudExQTUNhbGxiYWNrKGUsdCxpLG4scil7Y29uc3Qgbz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDYXJ0T3JUaHJvdygpO3JldHVybihhLHMpPT5BZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoYSlyZXR1cm5cIkxPQ0FMX1BBWU1FTlRfV0lORE9XX0NMT1NFRFwiPT09YS5jb2RlPyh0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLHRoaXMucmVzZXRQb2xsaW5nTWVjaGFuaXNtKCksdCgpKToodGhpcy5pc1BvbGxpbmdFbmFibGVkJiZ0aGlzLnJlc2V0UG9sbGluZ01lY2hhbmlzbSgpLHRoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksdChuZXcgRWUpKTtjb25zdCBkPXlpZWxkIHRoaXMuZ2V0TFBNc0Jhc2ljUGF5bWVudERhdGEoKSxsPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxkKSx7Zm9ybWF0dGVkUGF5bG9hZDp7bWV0aG9kOmksW2Ake2l9X2FjY291bnRgXTpPYmplY3QuYXNzaWduKHtlbWFpbDpvLmVtYWlsLHRva2VuOnMubm9uY2V9LHRoaXMuaXNMUE1zVXBkYXRlRXhwZXJpbWVudEVuYWJsZWQ/e306e29yZGVyX2lkOnRoaXMub3JkZXJJZH0pfX0pO3RyeXtyZXR1cm4gdGhpcy5pc0xQTXNVcGRhdGVFeHBlcmltZW50RW5hYmxlZHx8KHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihuLHIpKSx5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0UGF5bWVudCh7bWV0aG9kSWQ6aSxwYXltZW50RGF0YTpsfSksZSh2b2lkIDApfWNhdGNoKGUpe3JldHVybiB0aGlzLmhhbmRsZUVycm9yKGUpLHQoZSl9fSl9dG9nZ2xlTG9hZGluZ0luZGljYXRvcihlKXtlJiZ0aGlzLmxvYWRpbmdJbmRpY2F0b3JDb250YWluZXI/dGhpcy5sb2FkaW5nSW5kaWNhdG9yLnNob3codGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyKTp0aGlzLmxvYWRpbmdJbmRpY2F0b3IuaGlkZSgpfWhhbmRsZUVycm9yKGUpe2NvbnN0e29uRXJyb3I6dH09dGhpcy5icmFpbnRyZWVsb2NhbG1ldGhvZHN8fHt9O3RoaXMuaXNQb2xsaW5nRW5hYmxlZCYmdGhpcy5yZXNldFBvbGxpbmdNZWNoYW5pc20oKSx0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLHQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIHQmJnQoZSl9aXNOb25JbnN0YW50UGF5bWVudE1ldGhvZChlKXtyZXR1cm4gZS50b1VwcGVyQ2FzZSgpaW4gSX1pc0JyYWludHJlZVJlZGlyZWN0RXJyb3IoZSl7dmFyIHQ7aWYoXCJvYmplY3RcIiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiExO2NvbnN0e2JvZHk6aX09ZTtyZXR1cm4hIWkmJiEhKG51bGw9PT0odD1pLmFkZGl0aW9uYWxfYWN0aW9uX3JlcXVpcmVkKXx8dm9pZCAwPT09dD92b2lkIDA6dC5kYXRhLnJlZGlyZWN0X3VybCl9aXNCcmFpbnRyZWVPcmRlclNhdmVkUmVzcG9uc2UoZSl7dmFyIHQ7aWYoXCJvYmplY3RcIiE9dHlwZW9mIGV8fG51bGw9PT1lKXJldHVybiExO2NvbnN0e2JvZHk6aX09ZTtyZXR1cm4hIWkmJihudWxsPT09KHQ9aS5hZGRpdGlvbmFsX2FjdGlvbl9yZXF1aXJlZCl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuZGF0YS5oYXNPd25Qcm9wZXJ0eShcIm9yZGVyX2lkX3NhdmVkX3N1Y2Nlc3NmdWxseVwiKSl9aW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oZSx0LGksbil7cmV0dXJuIEFlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCBuZXcgUHJvbWlzZSgoZSx0KT0+e2NvbnN0IGk9c2V0VGltZW91dChlLHRoaXMucG9sbGluZ0ludGVydmFsKTt0aGlzLnN0b3BQb2xsaW5nPSgpPT4oY2xlYXJUaW1lb3V0KGkpLHRoaXMudG9nZ2xlTG9hZGluZ0luZGljYXRvcighMSksdCgpKX0pO3RyeXt0aGlzLnBvbGxpbmdUaW1lcis9dGhpcy5wb2xsaW5nSW50ZXJ2YWw7Y29uc3Qgcj15aWVsZCB0aGlzLmJyYWludHJlZVJlcXVlc3RTZW5kZXIuZ2V0T3JkZXJTdGF0dXMobix7cGFyYW1zOnt1c2VNZXRhZGF0YTohMX19KSxvPXIuc3RhdHVzPT09UC5QZW5kaW5nLGE9ci5zdGF0dXM9PT1QLkNvbXBsZXRlZCxzPXIuc3RhdHVzPT09UC5GYWlsZWQ7aWYoYSlyZXR1cm4gdGhpcy5kZWluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKCksdCgpO2lmKHMpcmV0dXJuIGkoKTtpZighYSYmbyYmdGhpcy5wb2xsaW5nVGltZXI8dGhpcy5tYXhQb2xsaW5nSW50ZXJ2YWxUaW1lKXJldHVybiB5aWVsZCB0aGlzLmluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKGUsdCxpLG4pO3lpZWxkIHRoaXMucmVpbml0aWFsaXplU3RyYXRlZ3koe21ldGhvZElkOmUsZ2F0ZXdheUlkOm4sYnJhaW50cmVlbG9jYWxtZXRob2RzOnRoaXMuYnJhaW50cmVlbG9jYWxtZXRob2RzfSksdGhpcy5oYW5kbGVFcnJvcihuZXcgVGUpfWNhdGNoKGUpe2koKX19KX1kZWluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKCl7dGhpcy5zdG9wUG9sbGluZygpLHRoaXMucG9sbGluZ1RpbWVyPTB9cmVzZXRQb2xsaW5nTWVjaGFuaXNtKCl7dGhpcy5kZWluaXRpYWxpemVQb2xsaW5nTWVjaGFuaXNtKCl9cmVpbml0aWFsaXplU3RyYXRlZ3koZSl7cmV0dXJuIEFlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLmRlaW5pdGlhbGl6ZSgpLHlpZWxkIHRoaXMuaW5pdGlhbGl6ZShlKX0pfX1jb25zdCBOZT1MKHQ9Pntjb25zdCBpPXdpbmRvdyxuPW5ldyBGKHQpLHI9bmV3IEIobmV3IHooZSgpLGksbikpLG89YygpLGE9bmV3IEllKG8pO3JldHVybiBuZXcgemUodCxyLGEsbmV3IG1lKHtzdHlsZXM6e2JhY2tncm91bmRDb2xvcjpcImJsYWNrXCJ9fSkpfSxbe2dhdGV3YXk6XCJicmFpbnRyZWVsb2NhbG1ldGhvZHNcIn1dKTtmdW5jdGlvbiBEZShlKXtyZXR1cm5cInN0cmluZ1wiIT10eXBlb2YgZX1mdW5jdGlvbiBNZShlLHQpe2lmKHR8fGUpcmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciB0LGk7Y29uc3Qgbj17fSxyPXMoZS5yb290LERlKSxvPXMoZS5pbnB1dCxEZSksYT1zKGUudG9nZ2xlLERlKSxkPXMobnVsbD09PSh0PWUudGV4dCl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuYm9keSxEZSksbD1zKG51bGw9PT0oaT1lLnRleHQpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmNhcHRpb24sRGUpLGM9ZS5icmFuZGluZztyZXR1cm4gT2JqZWN0LmtleXMocikubGVuZ3RoJiYobi5yb290PXIpLE9iamVjdC5rZXlzKG8pLmxlbmd0aCYmKG4uaW5wdXQ9byksT2JqZWN0LmtleXMoYSkubGVuZ3RoJiYobi50b2dnbGU9YSksT2JqZWN0LmtleXMoZCkubGVuZ3RoJiYobi50ZXh0PXt9LG4udGV4dC5ib2R5PWQpLE9iamVjdC5rZXlzKGwpLmxlbmd0aCYmKG4udGV4dD1PYmplY3QuYXNzaWduKHt9LG4udGV4dCksbi50ZXh0LmNhcHRpb249bCksYyYmKG4uYnJhbmRpbmc9Yyksbn0oZnVuY3Rpb24oZSx0KXt2YXIgaSxuLHIsbyxhLHMsZCxsLGMsdSxoLHksbSxwLGcsdixmLGIsdyxDLFMsUDtyZXR1cm57cm9vdDp7YmFja2dyb3VuZENvbG9yUHJpbWFyeToobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVJvb3RTZXR0aW5nc0JhY2tncm91bmRDb2xvcil8fChudWxsPT09KGk9bnVsbD09dD92b2lkIDA6dC5yb290KXx8dm9pZCAwPT09aT92b2lkIDA6aS5iYWNrZ3JvdW5kQ29sb3JQcmltYXJ5KSxlcnJvckNvbG9yOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lUm9vdFNldHRpbmdzRXJyb3JDb2xvcil8fChudWxsPT09KG49bnVsbD09dD92b2lkIDA6dC5yb290KXx8dm9pZCAwPT09bj92b2lkIDA6bi5lcnJvckNvbG9yKSxmb250RmFtaWx5OihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lUm9vdFNldHRpbmdzRm9udEZhbWlseSl8fChudWxsPT09KHI9bnVsbD09dD92b2lkIDA6dC5yb290KXx8dm9pZCAwPT09cj92b2lkIDA6ci5mb250RmFtaWx5KSxmb250U2l6ZUJhc2U6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVSb290U2V0dGluZ3NGb250U2l6ZSl8fChudWxsPT09KG89bnVsbD09dD92b2lkIDA6dC5yb290KXx8dm9pZCAwPT09bz92b2lkIDA6by5mb250U2l6ZUJhc2UpLHBhZGRpbmc6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVSb290U2V0dGluZ3NQYWRkaW5nKXx8KG51bGw9PT0oYT1udWxsPT10P3ZvaWQgMDp0LnJvb3QpfHx2b2lkIDA9PT1hP3ZvaWQgMDphLnBhZGRpbmcpLHByaW1hcnlDb2xvcjoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVJvb3RTZXR0aW5nc1ByaW1hcnlDb2xvcil8fChudWxsPT09KHM9bnVsbD09dD92b2lkIDA6dC5yb290KXx8dm9pZCAwPT09cz92b2lkIDA6cy5wcmltYXJ5Q29sb3IpfSxpbnB1dDp7Ym9yZGVyUmFkaXVzOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lSW5wdXRTZXR0aW5nc0JvcmRlclJhZGl1cyl8fChudWxsPT09KGQ9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PWQ/dm9pZCAwOmQuYm9yZGVyUmFkaXVzKSxib3JkZXJDb2xvcjoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUlucHV0U2V0dGluZ3NCb3JkZXJDb2xvcil8fChudWxsPT09KGw9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PWw/dm9pZCAwOmwuYm9yZGVyQ29sb3IpLGZvY3VzQm9yZGVyQ29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVJbnB1dFNldHRpbmdzRm9jdXNCb3JkZXJCYXNlKXx8KG51bGw9PT0oYz1udWxsPT10P3ZvaWQgMDp0LmlucHV0KXx8dm9pZCAwPT09Yz92b2lkIDA6Yy5mb2N1c0JvcmRlckNvbG9yKSxiYWNrZ3JvdW5kQ29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVJbnB1dFNldHRpbmdzQmFja2dyb3VuZENvbG9yKXx8KG51bGw9PT0odT1udWxsPT10P3ZvaWQgMDp0LmlucHV0KXx8dm9pZCAwPT09dT92b2lkIDA6dS5iYWNrZ3JvdW5kQ29sb3IpLGJvcmRlcldpZHRoOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lSW5wdXRTZXR0aW5nc0JvcmRlcldpZHRoKXx8KG51bGw9PT0oaD1udWxsPT10P3ZvaWQgMDp0LmlucHV0KXx8dm9pZCAwPT09aD92b2lkIDA6aC5ib3JkZXJXaWR0aCksdGV4dENvbG9yQmFzZToobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUlucHV0U2V0dGluZ3NUZXh0Q29sb3JCYXNlKXx8KG51bGw9PT0oeT1udWxsPT10P3ZvaWQgMDp0LmlucHV0KXx8dm9pZCAwPT09eT92b2lkIDA6eS50ZXh0Q29sb3JCYXNlKX0sdG9nZ2xlOntjb2xvclByaW1hcnk6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVUb2dnbGVTZXR0aW5nc0NvbG9yUHJpbWFyeSl8fChudWxsPT09KG09bnVsbD09dD92b2lkIDA6dC50b2dnbGUpfHx2b2lkIDA9PT1tP3ZvaWQgMDptLmNvbG9yUHJpbWFyeSksY29sb3JTZWNvbmRhcnk6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVUb2dnbGVTZXR0aW5nc0NvbG9yU2Vjb25kYXJ5KXx8KG51bGw9PT0ocD1udWxsPT10P3ZvaWQgMDp0LnRvZ2dsZSl8fHZvaWQgMD09PXA/dm9pZCAwOnAuY29sb3JTZWNvbmRhcnkpfSx0ZXh0Ontib2R5Ontjb2xvcjoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVRleHRCb2R5U2V0dGluZ3NDb2xvcil8fChudWxsPT09KHY9bnVsbD09PShnPW51bGw9PXQ/dm9pZCAwOnQudGV4dCl8fHZvaWQgMD09PWc/dm9pZCAwOmcuYm9keSl8fHZvaWQgMD09PXY/dm9pZCAwOnYuY29sb3IpLGZvbnRTaXplOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lVGV4dEJvZHlTZXR0aW5nc0ZvbnRTaXplKXx8KG51bGw9PT0oYj1udWxsPT09KGY9bnVsbD09dD92b2lkIDA6dC50ZXh0KXx8dm9pZCAwPT09Zj92b2lkIDA6Zi5ib2R5KXx8dm9pZCAwPT09Yj92b2lkIDA6Yi5mb250U2l6ZSl9LGNhcHRpb246e2NvbG9yOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lVGV4dENhcHRpb25TZXR0aW5nc0NvbG9yKXx8KG51bGw9PT0oQz1udWxsPT09KHc9bnVsbD09dD92b2lkIDA6dC50ZXh0KXx8dm9pZCAwPT09dz92b2lkIDA6dy5jYXB0aW9uKXx8dm9pZCAwPT09Qz92b2lkIDA6Qy5jb2xvciksZm9udFNpemU6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVUZXh0Q2FwdGlvblNldHRpbmdzRm9udFNpemUpfHwobnVsbD09PShQPW51bGw9PT0oUz1udWxsPT10P3ZvaWQgMDp0LnRleHQpfHx2b2lkIDA9PT1TP3ZvaWQgMDpTLmNhcHRpb24pfHx2b2lkIDA9PT1QP3ZvaWQgMDpQLmZvbnRTaXplKX19LGJyYW5kaW5nOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lQnJhbmRpbmdTZXR0aW5ncyl8fChudWxsPT10P3ZvaWQgMDp0LmJyYW5kaW5nKX19KGUsdCkpfWZ1bmN0aW9uIF9lKGUpe3JldHVybiEhZSYmKFwiYXV0aGVudGljYXRpb25TdGF0ZVwiaW4gZXx8XCJhZGRyZXNzZXNcImluIGV8fFwiaW5zdHJ1bWVudHNcImluIGUpfXZhciBCZSx4ZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBGZXtjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVGYXN0bGFuZVV0aWxzPXQsdGhpcy5icmFpbnRyZWVTZGs9aX1pbml0aWFsaXplKGUpe3ZhciB0O3JldHVybiB4ZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6aSxicmFpbnRyZWVmYXN0bGFuZTpufT1lO2lmKCFpKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZWZhc3RsYW5lXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuLm9uSW5pdHx8XCJmdW5jdGlvblwiIT10eXBlb2Ygbi5vbkluaXQpdGhyb3cgbmV3IFYoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVlZmFzdGxhbmUub25Jbml0XCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkIG9yIGl0IGlzIG5vdCBhIGZ1bmN0aW9uLicpO2lmKCFuLm9uQ2hhbmdlfHxcImZ1bmN0aW9uXCIhPXR5cGVvZiBuLm9uQ2hhbmdlKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZWZhc3RsYW5lLm9uQ2hhbmdlXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkIG9yIGl0IGlzIG5vdCBhIGZ1bmN0aW9uLicpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKTtjb25zdCByPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG89ci5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSx7aW5pdGlhbGl6YXRpb25EYXRhOmEsY2xpZW50VG9rZW46c309b3x8e30se2lzRmFzdGxhbmVTdHlsaW5nRW5hYmxlZDpkfT1hfHx7fSxsPXgoci5nZXRTdG9yZUNvbmZpZ09yVGhyb3coKS5jaGVja291dFNldHRpbmdzLmZlYXR1cmVzLFwiUFJPSkVDVC03MDgwLmJyYWludHJlZV9mYXN0bGFuZV90aHJlZV9kc1wiKTt0aGlzLmlzM0RTRW5hYmxlZD1vLmNvbmZpZy5pczNkc0VuYWJsZWQscyYmbCYmdGhpcy5icmFpbnRyZWVTZGsuaW5pdGlhbGl6ZShzKTtjb25zdCBjPU1lKGQ/bnVsbD09PSh0PW8uaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09dD92b2lkIDA6dC5mYXN0bGFuZVN0eWxlczp2b2lkIDAsbi5zdHlsZXMpO3lpZWxkIHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5pbml0aWFsaXplQnJhaW50cmVlRmFzdGxhbmVPclRocm93KGksYyksdGhpcy5zaG91bGRSdW5BdXRoZW50aWNhdGlvbkZsb3coKSYmKHlpZWxkIHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5ydW5QYXlQYWxBdXRoZW50aWNhdGlvbkZsb3dPclRocm93KCkpLHlpZWxkIHRoaXMuaW5pdGlhbGl6ZUNhcmRDb21wb25lbnQoKSx0aGlzLm9uRXJyb3I9bi5vbkVycm9yLG4ub25Jbml0KGU9PnRoaXMucmVuZGVyQnJhaW50cmVlQ2FyZENvbXBvbmVudChlKSksbi5vbkNoYW5nZSgoKT0+dGhpcy5oYW5kbGVCcmFpbnRyZWVTdG9yZWRJbnN0cnVtZW50Q2hhbmdlKGkpKX0pfWV4ZWN1dGUoZSx0KXtyZXR1cm4geGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6aX09ZSxuPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7cjxuLmxlbmd0aDtyKyspdC5pbmRleE9mKG5bcl0pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bcl0pJiYoaVtuW3JdXT1lW25bcl1dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKTtpZighaSl0aHJvdyBuZXcgUihbXCJwYXltZW50XCJdKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIobix0KTtjb25zdCByPXlpZWxkIHRoaXMucHJlcGFyZVBheW1lbnRQYXlsb2FkKGkubWV0aG9kSWQpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KHIpLHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5yZW1vdmVTZXNzaW9uSWRGcm9tQ29va2llcygpfSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFcpfWRlaW5pdGlhbGl6ZSgpe3JldHVybiB4ZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMuYnJhaW50cmVlQ2FyZENvbXBvbmVudD12b2lkIDAsUHJvbWlzZS5yZXNvbHZlKCl9KX1pbml0aWFsaXplQ2FyZENvbXBvbmVudCgpe3JldHVybiB4ZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgZT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSx7cGhvbmU6dCxmaXJzdE5hbWU6aSxsYXN0TmFtZTpufT1lLmdldEJpbGxpbmdBZGRyZXNzT3JUaHJvdygpLHI9YCR7aX0gJHtufWAsbz17c3R5bGVzOnt9LGZpZWxkczpPYmplY3QuYXNzaWduKHtjYXJkaG9sZGVyTmFtZTp7cHJlZmlsbDpyLGVuYWJsZWQ6ITB9fSx0JiZ7cGhvbmVOdW1iZXI6e3ByZWZpbGw6dH19KX0sYT10aGlzLmJyYWludHJlZUZhc3RsYW5lVXRpbHMuZ2V0QnJhaW50cmVlRmFzdGxhbmVDb21wb25lbnRPclRocm93KCk7dGhpcy5icmFpbnRyZWVDYXJkQ29tcG9uZW50PXlpZWxkIGEobyl9KX1yZW5kZXJCcmFpbnRyZWVDYXJkQ29tcG9uZW50KGUpe2NvbnN0IHQ9dGhpcy5nZXRCcmFpbnRyZWVDYXJkQ29tcG9uZW50T3JUaHJvdygpO2lmKCFlKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJjb250YWluZXJcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7dC5yZW5kZXIoZSl9cHJlcGFyZVBheW1lbnRQYXlsb2FkKGUpe3ZhciB0LGk7cmV0dXJuIHhlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHI9bi5nZXRCaWxsaW5nQWRkcmVzc09yVGhyb3coKSxvPWAke3IuZmlyc3ROYW1lfSAke3IubGFzdE5hbWV9YCxhPXRoaXMuZ2V0UGF5UGFsSW5zdHJ1bWVudHMoKVswXSxzPXlpZWxkIHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5nZXREZXZpY2VTZXNzaW9uSWQoKSxkPXgobi5nZXRTdG9yZUNvbmZpZ09yVGhyb3coKS5jaGVja291dFNldHRpbmdzLmZlYXR1cmVzLFwiUFJPSkVDVC03MDgwLmJyYWludHJlZV9mYXN0bGFuZV90aHJlZV9kc1wiKTtpZihhKXtjb25zdCB0PXRoaXMuaXMzRFNFbmFibGVkJiZkP3lpZWxkIHRoaXMuZ2V0M0RTKGEuYmlncGF5VG9rZW4sKG51bGw9PWE/dm9pZCAwOmEuaWluKXx8XCJcIik6dm9pZCAwO3JldHVybnttZXRob2RJZDplLHBheW1lbnREYXRhOntkZXZpY2VTZXNzaW9uSWQ6cyxmb3JtYXR0ZWRQYXlsb2FkOntwYXlwYWxfZmFzdGxhbmVfdG9rZW46e3Rva2VuOnR8fGEuYmlncGF5VG9rZW59fX19fWNvbnN0e2dldFBheW1lbnRUb2tlbjpsfT10aGlzLmdldEJyYWludHJlZUNhcmRDb21wb25lbnRPclRocm93KCksYz15aWVsZCBsKHtuYW1lOntmdWxsTmFtZTpvfSxiaWxsaW5nQWRkcmVzczp0aGlzLm1hcFRvUGF5UGFsQWRkcmVzcyhyKX0pLHU9KG51bGw9PT0oaT1udWxsPT09KHQ9Yy5wYXltZW50U291cmNlLmNhcmQpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmJpbkRldGFpbHMpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmJpbil8fFwiXCIsaD10aGlzLmlzM0RTRW5hYmxlZCYmZD95aWVsZCB0aGlzLmdldDNEUyhjLmlkLHUpOnZvaWQgMDtyZXR1cm57bWV0aG9kSWQ6ZSxwYXltZW50RGF0YTp7ZGV2aWNlU2Vzc2lvbklkOnMsbm9uY2U6aHx8Yy5pZH19fSl9Z2V0M0RTKGUsdCl7cmV0dXJuIHhlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG49eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0QnJhaW50cmVlVGhyZWVEUygpLHI9aS5nZXRPcmRlck9yVGhyb3coKTtyZXR1cm4gbmV3IFByb21pc2UoKGksbyk9PntuLnZlcmlmeUNhcmQoe2Ftb3VudDpudWxsPT1yP3ZvaWQgMDpyLm9yZGVyQW1vdW50LG5vbmNlOmUsYmluOnQsb25Mb29rdXBDb21wbGV0ZTooZSx0KT0+e24ub24oXCJjdXN0b21lci1jYW5jZWxlZFwiLCgpPT57XCJmdW5jdGlvblwiPT10eXBlb2YgdGhpcy5vbkVycm9yJiZ0aGlzLm9uRXJyb3IobmV3IFEpLG8obmV3IFEpfSksdCgpfX0sKGUsdCk9PihlJiZcIlRIUkVFRFNfVkVSSUZZX0NBUkRfQ0FOQ0VMRURfQllfTUVSQ0hBTlRcIj09PWUuY29kZSYmKFwiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXMub25FcnJvciYmdGhpcy5vbkVycm9yKG5ldyBRKSxvKG5ldyBRKSksaSh0Lm5vbmNlKSkpfSl9KX1tYXBUb1BheVBhbEFkZHJlc3MoZSl7cmV0dXJue3N0cmVldEFkZHJlc3M6KG51bGw9PWU/dm9pZCAwOmUuYWRkcmVzczEpfHxcIlwiLGxvY2FsaXR5OihudWxsPT1lP3ZvaWQgMDplLmNpdHkpfHxcIlwiLHJlZ2lvbjoobnVsbD09ZT92b2lkIDA6ZS5zdGF0ZU9yUHJvdmluY2VDb2RlKXx8KG51bGw9PWU/dm9pZCAwOmUuc3RhdGVPclByb3ZpbmNlKXx8XCJcIixwb3N0YWxDb2RlOihudWxsPT1lP3ZvaWQgMDplLnBvc3RhbENvZGUpfHxcIlwiLGNvdW50cnlDb2RlQWxwaGEyOihudWxsPT1lP3ZvaWQgMDplLmNvdW50cnlDb2RlKXx8XCJcIn19c2hvdWxkUnVuQXV0aGVudGljYXRpb25GbG93KCl7Y29uc3QgZT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSx0PWUuZ2V0Q2FydE9yVGhyb3coKSxpPWUuZ2V0Q3VzdG9tZXJPclRocm93KCksbj1lLmdldFBheW1lbnRQcm92aWRlckN1c3RvbWVyKCkscj1fZShuKT9uOnt9LG89dGhpcy5icmFpbnRyZWVGYXN0bGFuZVV0aWxzLmdldFNlc3Npb25JZEZyb21Db29raWVzKCk7cmV0dXJuISghaS5pc0d1ZXN0fHwobnVsbD09cj92b2lkIDA6ci5hdXRoZW50aWNhdGlvblN0YXRlKT09PU8uQ0FOQ0VMRUR8fChudWxsPT1yP3ZvaWQgMDpyLmF1dGhlbnRpY2F0aW9uU3RhdGUpfHxvIT09dC5pZCl9Z2V0QnJhaW50cmVlQ2FyZENvbXBvbmVudE9yVGhyb3coKXtpZighdGhpcy5icmFpbnRyZWVDYXJkQ29tcG9uZW50KXRocm93IG5ldyBnO3JldHVybiB0aGlzLmJyYWludHJlZUNhcmRDb21wb25lbnR9Z2V0UGF5UGFsSW5zdHJ1bWVudHMoKXtjb25zdCBlPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRQcm92aWRlckN1c3RvbWVyT3JUaHJvdygpO3JldHVybihfZShlKT9lOnt9KS5pbnN0cnVtZW50c3x8W119aGFuZGxlQnJhaW50cmVlU3RvcmVkSW5zdHJ1bWVudENoYW5nZShlKXtyZXR1cm4geGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5icmFpbnRyZWVGYXN0bGFuZVV0aWxzLmdldEJyYWludHJlZUZhc3RsYW5lT3JUaHJvdygpLHtzZWxlY3Rpb25DaGFuZ2VkOmksc2VsZWN0ZWRDYXJkOm59PXlpZWxkIHQucHJvZmlsZS5zaG93Q2FyZFNlbGVjdG9yKCk7aWYoaSl7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRQYXltZW50UHJvdmlkZXJDdXN0b21lcigpLGk9X2UodCk/dDp7fSxyPXRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5tYXBQYXlQYWxUb0JjSW5zdHJ1bWVudChlLFtuXSk7aWYociYmci5sZW5ndGg+MClyZXR1cm4geWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVBheW1lbnRQcm92aWRlckN1c3RvbWVyKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxpKSx7aW5zdHJ1bWVudHM6Wy4uLnJdfSkpLHJbMF19fSl9fSFmdW5jdGlvbihlKXtlLkNWVj1cImN2dlwiLGUuUEFOPVwicGFuXCJ9KEJlfHwoQmU9e30pKTtjbGFzcyBMZXtzdGF0aWMgZ2V0KGUpe2NvbnN0IHQ9YCR7ZW5jb2RlVVJJQ29tcG9uZW50KGAke2V9YCl9PWAsaT1kb2N1bWVudC5jb29raWU7bGV0IG49bnVsbDtjb25zdCByPWkuaW5kZXhPZih0KTtpZihyPi0xKXtsZXQgZT1pLmluZGV4T2YoXCI7XCIscik7LTE9PT1lJiYoZT1pLmxlbmd0aCksbj1kZWNvZGVVUklDb21wb25lbnQoaS5zdWJzdHJpbmcocit0Lmxlbmd0aCxlKSl9cmV0dXJuIG59c3RhdGljIHNldChlLHQsaT17c2VjdXJlOiEwfSl7bGV0IG49YCR7ZW5jb2RlVVJJQ29tcG9uZW50KGUpfT0ke2VuY29kZVVSSUNvbXBvbmVudCh0KX1gO2NvbnN0e2V4cGlyZXM6cixwYXRoOm8sZG9tYWluOmEsc2VjdXJlOnN9PWk7aWYociluKz1gOyBleHBpcmVzPSR7ci50b1VUQ1N0cmluZygpfWA7ZWxzZXtjb25zdCBlPW5ldyBEYXRlLHQ9NjA7ZS5zZXRUaW1lKGUuZ2V0VGltZSgpKzYwKnQqMWUzKSxuKz1gOyBleHBpcmVzPSR7ZS50b1VUQ1N0cmluZygpfWB9byYmKG4rPWA7IHBhdGg9JHtvfWApLGEmJihuKz1gOyBkb21haW49JHthfWApLHMmJihuKz1cIjsgc2VjdXJlXCIpLGRvY3VtZW50LmNvb2tpZT1ufXN0YXRpYyByZW1vdmUoZSx0KXtMZS5zZXQoZSxcIlwiLE9iamVjdC5hc3NpZ24oe2V4cGlyZXM6bmV3IERhdGUoMCl9LHQpKX19dmFyIFZlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIGple2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2U9dH1nZXREZXZpY2VTZXNzaW9uSWQoKXtyZXR1cm4gVmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGU9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydCgpO3JldHVybiB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRTZXNzaW9uSWQobnVsbD09ZT92b2lkIDA6ZS5pZCl9KX1pbml0aWFsaXplQnJhaW50cmVlRmFzdGxhbmVPclRocm93KGUsdCl7cmV0dXJuIFZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG49aS5nZXRDYXJ0KCkse2NsaWVudFRva2VuOnIsY29uZmlnOm99PWkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSk7aWYoIXIpdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudE1ldGhvZCk7dGhpcy5tZXRob2RJZD1lLHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmluaXRpYWxpemUociksdGhpcy5icmFpbnRyZWVGYXN0bGFuZT15aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRCcmFpbnRyZWVGYXN0bGFuZShudWxsPT1uP3ZvaWQgMDpuLmlkLG8udGVzdE1vZGUsdCl9KX1nZXRCcmFpbnRyZWVGYXN0bGFuZU9yVGhyb3coKXtpZighdGhpcy5icmFpbnRyZWVGYXN0bGFuZSl0aHJvdyBuZXcgZztyZXR1cm4gdGhpcy5icmFpbnRyZWVGYXN0bGFuZX1nZXRCcmFpbnRyZWVGYXN0bGFuZUNvbXBvbmVudE9yVGhyb3coKXtyZXR1cm4gdGhpcy5nZXRCcmFpbnRyZWVGYXN0bGFuZU9yVGhyb3coKS5GYXN0bGFuZUNhcmRDb21wb25lbnR9cnVuUGF5UGFsQXV0aGVudGljYXRpb25GbG93T3JUaHJvdyhlLHQpe3ZhciBpO3JldHVybiBWZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e2NvbnN0IG49dGhpcy5nZXRNZXRob2RJZE9yVGhyb3coKSxyPXRoaXMuZ2V0QnJhaW50cmVlRmFzdGxhbmVPclRocm93KCkse2xvb2t1cEN1c3RvbWVyQnlFbWFpbDpvLHRyaWdnZXJBdXRoZW50aWNhdGlvbkZsb3c6YX09ci5pZGVudGl0eSxzPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLGQ9cy5nZXRDYXJ0T3JUaHJvdygpLGw9cy5nZXRDdXN0b21lcigpLGM9cy5nZXRCaWxsaW5nQWRkcmVzcygpLHtpc0Zhc3RsYW5lU2hpcHBpbmdPcHRpb25BdXRvU2VsZWN0RW5hYmxlZDp1fT1zLmdldFBheW1lbnRNZXRob2RPclRocm93KG4pLmluaXRpYWxpemF0aW9uRGF0YXx8e30saD1lfHwobnVsbD09bD92b2lkIDA6bC5lbWFpbCl8fChudWxsPT1jP3ZvaWQgMDpjLmVtYWlsKXx8XCJcIix7Y3VzdG9tZXJDb250ZXh0SWQ6eX09eWllbGQgbyhoKTtpZigheSlyZXR1cm4geWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVBheW1lbnRQcm92aWRlckN1c3RvbWVyKHthdXRoZW50aWNhdGlvblN0YXRlOk8uVU5SRUNPR05JWkVELGFkZHJlc3NlczpbXSxpbnN0cnVtZW50czpbXX0pLHZvaWQgdGhpcy5zYXZlU2Vzc2lvbklkVG9Db29raWVzKGQuaWQpO2NvbnN0e2F1dGhlbnRpY2F0aW9uU3RhdGU6bSxwcm9maWxlRGF0YTpwfT15aWVsZCBhKHkpLGc9KG51bGw9PT0oaT1udWxsPT1wP3ZvaWQgMDpwLnNoaXBwaW5nQWRkcmVzcyl8fHZvaWQgMD09PWk/dm9pZCAwOmkucGhvbmVOdW1iZXIpfHxcIlwiO2lmKG09PT1PLkNBTkNFTEVEKXJldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlUGF5bWVudFByb3ZpZGVyQ3VzdG9tZXIoe2F1dGhlbnRpY2F0aW9uU3RhdGU6bSxhZGRyZXNzZXM6W10saW5zdHJ1bWVudHM6W119KSx2b2lkIHRoaXMucmVtb3ZlU2Vzc2lvbklkRnJvbUNvb2tpZXMoKTtjb25zdCB2PXRoaXMubWFwUGF5UGFsVG9CY0FkZHJlc3MoW3Auc2hpcHBpbmdBZGRyZXNzXSxbZ10pfHxbXSxmPXRoaXMuZ2V0UGF5UGFsQmlsbGluZ0FkZHJlc3NlcyhwKSxiPWY/dGhpcy5tYXBQYXlQYWxUb0JjQWRkcmVzcyhbZl0sW2ddKTpbXSx3PXAuY2FyZD90aGlzLm1hcFBheVBhbFRvQmNJbnN0cnVtZW50KG4sW3AuY2FyZF0pOltdLEM9dGhpcy5tZXJnZVNoaXBwaW5nQW5kQmlsbGluZ0FkZHJlc3Nlcyh2LGIpO2lmKHRoaXMuc2F2ZVNlc3Npb25JZFRvQ29va2llcyhkLmlkKSx5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlUGF5bWVudFByb3ZpZGVyQ3VzdG9tZXIoe2F1dGhlbnRpY2F0aW9uU3RhdGU6bSxhZGRyZXNzZXM6QyxpbnN0cnVtZW50czp3fSksYi5sZW5ndGg+MCYmZC5saW5lSXRlbXMucGh5c2ljYWxJdGVtcy5sZW5ndGg+MCYmKHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVCaWxsaW5nQWRkcmVzcyhiWzBdKSksYi5sZW5ndGg+MCYmZC5saW5lSXRlbXMuZGlnaXRhbEl0ZW1zLmxlbmd0aD4wJiYwPT09ZC5saW5lSXRlbXMucGh5c2ljYWxJdGVtcy5sZW5ndGgpe2NvbnN0e2ZpcnN0TmFtZTplLGxhc3ROYW1lOnR9PUNbMF0saT1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sYlswXSkse2ZpcnN0TmFtZTplLGxhc3ROYW1lOnR9KTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3MoaSl9di5sZW5ndGg+MCYmZC5saW5lSXRlbXMucGh5c2ljYWxJdGVtcy5sZW5ndGg+MCYmKHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS51cGRhdGVTaGlwcGluZ0FkZHJlc3ModlswXSksdCYmdSYmKHlpZWxkIHRoaXMuc2V0U2hpcHBpbmdPcHRpb24oKSkpfWNhdGNoKGUpe319KX1nZXRTZXNzaW9uSWRGcm9tQ29va2llcygpe3JldHVybiBMZS5nZXQoXCJiYy1mYXN0bGFuZS1zZXNzaW9uSWRcIil8fFwiXCJ9c2F2ZVNlc3Npb25JZFRvQ29va2llcyhlKXtjb25zdCB0PW5ldyBEYXRlO3Quc2V0RGF0ZSh0LmdldERhdGUoKSsxNCksTGUuc2V0KFwiYmMtZmFzdGxhbmUtc2Vzc2lvbklkXCIsZSx7ZXhwaXJlczp0LHNlY3VyZTohMH0pfXJlbW92ZVNlc3Npb25JZEZyb21Db29raWVzKCl7TGUucmVtb3ZlKFwiYmMtZmFzdGxhbmUtc2Vzc2lvbklkXCIpfW1hcFBheVBhbFRvQmNJbnN0cnVtZW50KGUsdCl7aWYodClyZXR1cm4gdC5tYXAodD0+e2NvbnN0e2lkOmkscGF5bWVudFNvdXJjZTpufT10LHticmFuZDpyLGV4cGlyeTpvLGxhc3REaWdpdHM6YSxiaW5EZXRhaWxzOnN9PW4uY2FyZCxbZCxsXT1vLnNwbGl0KFwiLVwiKTtyZXR1cm57YmlncGF5VG9rZW46aSxicmFuZDpyLGRlZmF1bHRJbnN0cnVtZW50OiExLGV4cGlyeU1vbnRoOmwsZXhwaXJ5WWVhcjpkLGlpbjoobnVsbD09cz92b2lkIDA6cy5iaW4pfHxcIlwiLGxhc3Q0OmEsbWV0aG9kOmUscHJvdmlkZXI6ZSx0cnVzdGVkU2hpcHBpbmdBZGRyZXNzOiExLHR5cGU6XCJjYXJkXCIsdW50cnVzdGVkU2hpcHBpbmdDYXJkVmVyaWZpY2F0aW9uTW9kZTpCZS5QQU59fSl9bWFwUGF5UGFsVG9CY0FkZHJlc3MoZSx0KXtpZighZSlyZXR1cm5bXTtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENvdW50cmllcygpfHxbXSxuPWU9Pntjb25zdCB0PWkuZmluZCh0PT50LmNvZGU9PT1lKTtyZXR1cm4obnVsbD09dD92b2lkIDA6dC5uYW1lKXx8XCJcIn07cmV0dXJuIGUubWFwKGU9Pih7aWQ6RGF0ZS5ub3coKSx0eXBlOlwicGF5cGFsLWFkZHJlc3NcIixmaXJzdE5hbWU6ZS5maXJzdE5hbWV8fFwiXCIsbGFzdE5hbWU6ZS5sYXN0TmFtZXx8XCJcIixjb21wYW55OmUuY29tcGFueXx8XCJcIixhZGRyZXNzMTplLnN0cmVldEFkZHJlc3MsYWRkcmVzczI6ZS5leHRlbmRlZEFkZHJlc3N8fFwiXCIsY2l0eTplLmxvY2FsaXR5LHN0YXRlT3JQcm92aW5jZTplLnJlZ2lvbixzdGF0ZU9yUHJvdmluY2VDb2RlOmUucmVnaW9uLGNvdW50cnk6bihlLmNvdW50cnlDb2RlQWxwaGEyKSxjb3VudHJ5Q29kZTplLmNvdW50cnlDb2RlQWxwaGEyLHBvc3RhbENvZGU6ZS5wb3N0YWxDb2RlLHBob25lOnQmJnRbMF18fFwiXCIsY3VzdG9tRmllbGRzOltdfSkpfWdldFBheVBhbEJpbGxpbmdBZGRyZXNzZXMoZSl7Y29uc3R7Y2FyZDp0LG5hbWU6aX09ZXx8e307aWYoIXQpcmV0dXJuO2NvbnN0e2ZpcnN0TmFtZTpyLGxhc3ROYW1lOm99PXQucGF5bWVudFNvdXJjZS5jYXJkLmJpbGxpbmdBZGRyZXNzLHtmaXJzdE5hbWU6YSxsYXN0TmFtZTpzfT1pfHx7fSx7c2hpcHBpbmdBZGRyZXNzOmR9PWV8fHt9LGw9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHQucGF5bWVudFNvdXJjZS5jYXJkLmJpbGxpbmdBZGRyZXNzKSx7Zmlyc3ROYW1lOnJ8fGEsbGFzdE5hbWU6b3x8c30pO3JldHVybiBkJiZuKHRoaXMubm9ybWFsaXplQWRkcmVzcyhsKSx0aGlzLm5vcm1hbGl6ZUFkZHJlc3MoZCkpP2Q6bH1ub3JtYWxpemVBZGRyZXNzKGUpe3JldHVybiBhKGUsW1wiaWRcIl0pfW1lcmdlU2hpcHBpbmdBbmRCaWxsaW5nQWRkcmVzc2VzKGUsdCl7Y29uc3QgaT10LmZpbHRlcih0PT4hZS5zb21lKGU9Pm4odGhpcy5ub3JtYWxpemVBZGRyZXNzKGUpLHRoaXMubm9ybWFsaXplQWRkcmVzcyh0KSkpKTtyZXR1cm5bLi4uZSwuLi5pXX1nZXRNZXRob2RJZE9yVGhyb3coKXtpZighdGhpcy5tZXRob2RJZCl0aHJvdyBuZXcgVignVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBcIm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3JldHVybiB0aGlzLm1ldGhvZElkfXNldFNoaXBwaW5nT3B0aW9uKCl7dmFyIGU7cmV0dXJuIFZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldENvbnNpZ25tZW50cygpfHxbXSxpPShudWxsPT09KGU9dFswXSl8fHZvaWQgMD09PWU/dm9pZCAwOmUuYXZhaWxhYmxlU2hpcHBpbmdPcHRpb25zKXx8W10sbj1pLmZpbmQoZT0+ZS5pc1JlY29tbWVuZGVkKTtpZihufHxpLmxlbmd0aCl7Y29uc3QgZT1ufHxpWzBdO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zZWxlY3RTaGlwcGluZ09wdGlvbihlLmlkKX19KX19Y29uc3QgVWU9TCh0PT57Y29uc3QgaT13aW5kb3csbj1uZXcgRih0KSxyPW5ldyBsZShuZXcgeihlKCksaSxuKSxpKSxvPW5ldyBqZSh0LHIpLGE9bmV3IHooZSgpLGksbikscz1uZXcgQihhKTtyZXR1cm4gbmV3IEZlKHQsbyxzKX0sW3tpZDpcImJyYWludHJlZWFjY2VsZXJhdGVkY2hlY2tvdXRcIn1dKTt2YXIgUmU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgSGV7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuZm9ybVBvc3Rlcj10LHRoaXMuYnJhaW50cmVlU2RrPWl9aW5pdGlhbGl6ZShlKXtyZXR1cm4gUmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2JyYWludHJlZXZpc2FjaGVja291dDp0LG1ldGhvZElkOml9PWU7aWYoIXQpdGhyb3cgbmV3IFYoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVldmlzYWNoZWNrb3V0XCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKTtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO3RoaXMucGF5bWVudE1ldGhvZD1uLmdldFBheW1lbnRNZXRob2RPclRocm93KGkpO2NvbnN0IHI9bi5nZXRDaGVja291dE9yVGhyb3coKSxhPW4uZ2V0U3RvcmVDb25maWdPclRocm93KCkse2NsaWVudFRva2VuOnMsY29uZmlnOmR9PXRoaXMucGF5bWVudE1ldGhvZHx8e307aWYoIXMpdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3R7b25FcnJvcjpsPW8sb25QYXltZW50U2VsZWN0OmM9b309dDt0aGlzLmJyYWludHJlZVNkay5pbml0aWFsaXplKHMpO2NvbnN0IHU9eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0QnJhaW50cmVlVmlzYUNoZWNrb3V0KCksaD15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXRWaXNhQ2hlY2tvdXRTZGsobnVsbD09ZD92b2lkIDA6ZC50ZXN0TW9kZSkseT11LmNyZWF0ZUluaXRPcHRpb25zKHtzZXR0aW5nczp7bG9jYWxlOmEuc3RvcmVQcm9maWxlLnN0b3JlTGFuZ3VhZ2Usc2hpcHBpbmc6e2NvbGxlY3RTaGlwcGluZzohMX19LHBheW1lbnRSZXF1ZXN0OntjdXJyZW5jeUNvZGU6YS5jdXJyZW5jeS5jb2RlLHN1YnRvdGFsOlN0cmluZyhyLnN1YnRvdGFsKX19KTt5aWVsZCBoLmluaXQoeSksaC5vbihcInBheW1lbnQuc3VjY2Vzc1wiLGU9PnRoaXMudG9rZW5pemVQYXltZW50KHUsZSkudGhlbigoKT0+UHJvbWlzZS5hbGwoW3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkQ2hlY2tvdXQoKSx0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSldKSkudGhlbigoKT0+YygpKS5jYXRjaChlPT5sKGUpKSksaC5vbihcInBheW1lbnQuZXJyb3JcIiwoZSx0KT0+bCh0KSl9KX1leGVjdXRlKGUsdCl7dmFyIGksbjtyZXR1cm4gUmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6cn09ZSxvPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7cjxuLmxlbmd0aDtyKyspdC5pbmRleE9mKG5bcl0pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bcl0pJiYoaVtuW3JdXT1lW25bcl1dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKTtpZighcil0aHJvdyBuZXcgVignVW5hYmxlIHRvIHN1Ym1pdCBwYXltZW50IGJlY2F1c2UgXCJwYXlsb2FkLnBheW1lbnRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIShudWxsPT09KG49bnVsbD09PShpPXRoaXMucGF5bWVudE1ldGhvZCl8fHZvaWQgMD09PWk/dm9pZCAwOmkuaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09bj92b2lkIDA6bi5ub25jZSkpdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3R7bm9uY2U6YX09dGhpcy5wYXltZW50TWV0aG9kLmluaXRpYWxpemF0aW9uRGF0YTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKG8sdCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHIpLHtwYXltZW50RGF0YTp7bm9uY2U6YX19KSl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX19KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgVyl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIFJlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLmJyYWludHJlZVNkay5kZWluaXRpYWxpemUoKX0pfXRva2VuaXplUGF5bWVudChlLHQpe3JldHVybiBSZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIFByb21pc2UuYWxsKFtlLnRva2VuaXplKHQpLHRoaXMuYnJhaW50cmVlU2RrLmdldERhdGFDb2xsZWN0b3JPclRocm93KCldKS50aGVuKChbZSx0XSk9Pntjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG49aS5nZXRTaGlwcGluZ0FkZHJlc3MoKSxyPWkuZ2V0QmlsbGluZ0FkZHJlc3MoKSx7c2hpcHBpbmdBZGRyZXNzOm89dGhpcy5tYXBUb1Zpc2FDaGVja291dEFkZHJlc3MobiksYmlsbGluZ0FkZHJlc3M6YT10aGlzLm1hcFRvVmlzYUNoZWNrb3V0QWRkcmVzcyhyKX09ZTtyZXR1cm4gdGhpcy5wb3N0Rm9ybShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3NoaXBwaW5nQWRkcmVzczpvLGJpbGxpbmdBZGRyZXNzOmF9KSx0KX0pfSl9bWFwVG9WaXNhQ2hlY2tvdXRBZGRyZXNzKGUpe3JldHVybiBlP3tmaXJzdE5hbWU6ZS5maXJzdE5hbWUsbGFzdE5hbWU6ZS5sYXN0TmFtZSxwaG9uZU51bWJlcjplLnBob25lLHN0cmVldEFkZHJlc3M6ZS5hZGRyZXNzMSxleHRlbmRlZEFkZHJlc3M6ZS5hZGRyZXNzMixsb2NhbGl0eTplLmNpdHkscmVnaW9uOmUuc3RhdGVPclByb3ZpbmNlQ29kZSxjb3VudHJ5Q29kZTplLmNvdW50cnlDb2RlLHBvc3RhbENvZGU6ZS5wb3N0YWxDb2RlfTp7fX1wb3N0Rm9ybShlLHQpe2NvbnN0e3VzZXJEYXRhOmksYmlsbGluZ0FkZHJlc3M6bixzaGlwcGluZ0FkZHJlc3M6cixkZXRhaWxzOm99PWUse3VzZXJFbWFpbDphfT1pLHtkZXZpY2VEYXRhOnN9PXQ7cmV0dXJuIHRoaXMuZm9ybVBvc3Rlci5wb3N0Rm9ybShcIi9jaGVja291dC5waHBcIix7cGF5bWVudF90eXBlOmUudHlwZSxub25jZTplLm5vbmNlLHByb3ZpZGVyOlwiYnJhaW50cmVldmlzYWNoZWNrb3V0XCIsYWN0aW9uOlwic2V0X2V4dGVybmFsX2NoZWNrb3V0XCIsZGV2aWNlX2RhdGE6cyxjYXJkX2luZm9ybWF0aW9uOkpTT04uc3RyaW5naWZ5KHt0eXBlOm8uY2FyZFR5cGUsbnVtYmVyOm8ubGFzdFR3b30pLGJpbGxpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeSh0aGlzLmdldEFkZHJlc3MoYSxuKSksc2hpcHBpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeSh0aGlzLmdldEFkZHJlc3MoYSxyKSl9KX1nZXRBZGRyZXNzKGUsdD17fSl7cmV0dXJue2VtYWlsOmUsZmlyc3RfbmFtZTp0LmZpcnN0TmFtZSxsYXN0X25hbWU6dC5sYXN0TmFtZSxwaG9uZV9udW1iZXI6dC5waG9uZU51bWJlcixhZGRyZXNzX2xpbmVfMTp0LnN0cmVldEFkZHJlc3MsYWRkcmVzc19saW5lXzI6dC5leHRlbmRlZEFkZHJlc3MsY2l0eTp0LmxvY2FsaXR5LHN0YXRlOnQucmVnaW9uLGNvdW50cnlfY29kZTp0LmNvdW50cnlDb2RlLHBvc3RhbF9jb2RlOnQucG9zdGFsQ29kZX19aGFuZGxlRXJyb3IoZSl7aWYoZSBpbnN0YW5jZW9mIEVycm9yJiZcIkJyYWludHJlZUVycm9yXCI9PT1lLm5hbWUpdGhyb3cgbmV3ICQoZS5tZXNzYWdlKTt0aHJvdyBlfX1jb25zdCBXZT1MKHQ9Pntjb25zdCBpPXdpbmRvdyxuPW5ldyBGKHQpLHI9bmV3IEIobmV3IHooZSgpLGksbikpO3JldHVybiBuZXcgSGUodCx1KCkscil9LFt7aWQ6XCJicmFpbnRyZWV2aXNhY2hlY2tvdXRcIn1dKTt2YXIgcWU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgJGV7Y29uc3RydWN0b3IoZSx0KXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT10fWluaXRpYWxpemUoZSl7cmV0dXJuIHFlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHttZXRob2RJZDp0fT1lO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZCh0KTtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO3RoaXMudmVubW9PcHRpb25zPWUuYnJhaW50cmVldmVubW87Y29uc3Qgbj1pLmdldFBheW1lbnRNZXRob2RPclRocm93KHQpO3lpZWxkIHRoaXMuaW5pdGlhbGl6ZUJyYWludHJlZVZlbm1vKG4pfSl9ZXhlY3V0ZShlKXtyZXR1cm4gcWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6dH09ZSxpPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7cjxuLmxlbmd0aDtyKyspdC5pbmRleE9mKG5bcl0pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bcl0pJiYoaVtuW3JdXT1lW25bcl1dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKTtpZighdCl0aHJvdyBuZXcgUihbXCJwYXltZW50XCJdKTt0cnl7Y29uc3QgZT15aWVsZCB0aGlzLnByZXBhcmVQYXltZW50RGF0YSh0KTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIoaSkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoZSl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX19KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgVyl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIHFlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4geWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudGVhcmRvd24oKSxQcm9taXNlLnJlc29sdmUoKX0pfWhhbmRsZUVycm9yKGUpe2lmKCFNKGUpKXRocm93IGU7aWYoXCJQQVlQQUxfUE9QVVBfQ0xPU0VEXCI9PT1lLmNvZGUpdGhyb3cgbmV3IFEoZS5tZXNzYWdlKTt0aHJvdyBuZXcgJChlLm1lc3NhZ2UpfWluaXRpYWxpemVCcmFpbnRyZWVWZW5tbyhlKXt2YXIgdDtyZXR1cm4gcWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2NsaWVudFRva2VuOml9PWU7aWYoIWkpdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3Qgbj14KHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFN0b3JlQ29uZmlnT3JUaHJvdygpLmNoZWNrb3V0U2V0dGluZ3MuZmVhdHVyZXMsXCJQQVlQQUwtNTQwNi5icmFpbnRyZWVfdmVubW9fd2ViX2ZhbGxiYWNrX3N1cHBvcnRcIik7dHJ5e3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmluaXRpYWxpemUoaSksdGhpcy5icmFpbnRyZWVWZW5tb0NoZWNrb3V0PXlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFZlbm1vQ2hlY2tvdXQoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHZvaWQgMCE9PShudWxsPT09KHQ9dGhpcy52ZW5tb09wdGlvbnMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmFsbG93RGVza3RvcCk/e2FsbG93RGVza3RvcDp0aGlzLnZlbm1vT3B0aW9ucy5hbGxvd0Rlc2t0b3B9Ont9KSxuP3ttb2JpbGVXZWJGYWxsQmFjazpufTp7fSkpfWNhdGNoKGUpe3RoaXMuaGFuZGxlRXJyb3IoZSl9fSl9cHJlcGFyZVBheW1lbnREYXRhKGUpe3JldHVybiBxZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSx7bm9uY2U6aX09dC5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlLm1ldGhvZElkKTtpZihpKXJldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3BheW1lbnREYXRhOnRoaXMuZm9ybWF0dGVkUGF5bG9hZChpKX0pO2NvbnN0IG49eWllbGQgdGhpcy5icmFpbnRyZWVWZW5tb1Rva2VuaXplKCkscj15aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRTZXNzaW9uSWQoKTtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHtwYXltZW50RGF0YTp0aGlzLmZvcm1hdHRlZFBheWxvYWQobi5ub25jZSxuLmRldGFpbHMuZW1haWwscil9KX0pfWZvcm1hdHRlZFBheWxvYWQoZSx0LGkpe3JldHVybntmb3JtYXR0ZWRQYXlsb2FkOnt2YXVsdF9wYXltZW50X2luc3RydW1lbnQ6bnVsbCxzZXRfYXNfZGVmYXVsdF9zdG9yZWRfaW5zdHJ1bWVudDpudWxsLGRldmljZV9pbmZvOml8fG51bGwscGF5cGFsX2FjY291bnQ6e3Rva2VuOmUsZW1haWw6dHx8bnVsbH19fX1icmFpbnRyZWVWZW5tb1Rva2VuaXplKCl7cmV0dXJuIG5ldyBQcm9taXNlKChlLHQpPT57dmFyIGk7bnVsbD09PShpPXRoaXMuYnJhaW50cmVlVmVubW9DaGVja291dCl8fHZvaWQgMD09PWl8fGkudG9rZW5pemUoKGksbik9PntpZihpKXJldHVybiB0KGkpO2Uobil9KX0pfX1jb25zdCBHZT1MKHQ9Pntjb25zdCBpPXdpbmRvdyxuPWUoKSxyPW5ldyBGKHQpLG89bmV3IHoobixpLHIpLGE9bmV3IGxlKG8saSk7cmV0dXJuIG5ldyAkZSh0LGEpfSxbe2lkOlwiYnJhaW50cmVldmVubW9cIn1dKTt2YXIgWWU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgSmV7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlPXQsdGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtPWl9aW5pdGlhbGl6ZShlKXtyZXR1cm4gWWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e21ldGhvZElkOnQsZ2F0ZXdheUlkOmksYnJhaW50cmVlOm59PWU7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKHQpO2NvbnN0IHI9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCk7dGhpcy5wYXltZW50TWV0aG9kPXIuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCk7Y29uc3R7Y2xpZW50VG9rZW46b309dGhpcy5wYXltZW50TWV0aG9kO2lmKCFvKXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRNZXRob2QpO3RoaXMudGhyZWVEU2VjdXJlPW51bGw9PW4/dm9pZCAwOm4udGhyZWVEU2VjdXJlLHRoaXMub25QYXltZW50RXJyb3I9bnVsbD09bj92b2lkIDA6bi5vblBheW1lbnRFcnJvcjt0cnl7dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuaW5pdGlhbGl6ZShvLHRoaXMudGhyZWVEU2VjdXJlKSx0aGlzLmlzSG9zdGVkUGF5bWVudEZvcm1FbmFibGVkKHQsaSkmJihudWxsPT1uP3ZvaWQgMDpuLmZvcm0pJiYoeWllbGQgdGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtLmluaXRpYWxpemUobi5mb3JtLG4udW5zdXBwb3J0ZWRDYXJkQnJhbmRzLG8pLHRoaXMuaXNIb3N0ZWRGb3JtSW5pdGlhbGl6ZWQ9dGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtLmlzSW5pdGlhbGl6ZWQoKSksdGhpcy5pczNkc0VuYWJsZWQ9dGhpcy5wYXltZW50TWV0aG9kLmNvbmZpZy5pczNkc0VuYWJsZWQsdGhpcy5kZXZpY2VTZXNzaW9uSWQ9eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U2Vzc2lvbklkKCksdGhpcy5zaG91bGRJbml0aWFsaXplQnJhaW50cmVlRmFzdGxhbmUoKSYmKHlpZWxkIHRoaXMuaW5pdGlhbGl6ZUJyYWludHJlZUZhc3RsYW5lT3JUaHJvdyh0KSl9Y2F0Y2goZSl7cmV0dXJuIHRoaXMuaGFuZGxlRXJyb3IoZSx0KX19KX1leGVjdXRlKGUpe3JldHVybiBZZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cGF5bWVudDp0fT1lLGk9ZnVuY3Rpb24oZSx0KXt2YXIgaT17fTtmb3IodmFyIG4gaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxuKSYmdC5pbmRleE9mKG4pPDAmJihpW25dPWVbbl0pO2lmKG51bGwhPWUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPTA7Zm9yKG49T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtyPG4ubGVuZ3RoO3IrKyl0LmluZGV4T2YobltyXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsbltyXSkmJihpW25bcl1dPWVbbltyXV0pfXJldHVybiBpfShlLFtcInBheW1lbnRcIl0pO2lmKCF0KXRocm93IG5ldyBSKFtcInBheW1lbnRcIl0pO3RoaXMuaXNIb3N0ZWRGb3JtSW5pdGlhbGl6ZWQmJnRoaXMuYnJhaW50cmVlSG9zdGVkRm9ybS52YWxpZGF0ZSgpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihpKTtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHI9bi5nZXRCaWxsaW5nQWRkcmVzc09yVGhyb3coKSxvPW4uZ2V0T3JkZXJPclRocm93KCkub3JkZXJBbW91bnQ7dHJ5e2NvbnN0IGU9dGhpcy5pc0hvc3RlZEZvcm1Jbml0aWFsaXplZD95aWVsZCB0aGlzLnByZXBhcmVIb3N0ZWRQYXltZW50RGF0YSh0LHIsbyk6eWllbGQgdGhpcy5wcmVwYXJlUGF5bWVudERhdGEodCxyLG8pO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7cGF5bWVudERhdGE6ZX0pKX1jYXRjaChlKXtyZXR1cm4gdGhpcy5wcm9jZXNzQWRkaXRpb25hbEFjdGlvbihlLHQsbyl9fSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IFcpfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBZZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMuaXNIb3N0ZWRGb3JtSW5pdGlhbGl6ZWQ9ITEseWllbGQgUHJvbWlzZS5hbGwoW3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRlYXJkb3duKCksdGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtLmRlaW5pdGlhbGl6ZSgpXSksUHJvbWlzZS5yZXNvbHZlKCl9KX1oYW5kbGVFcnJvcihlLHQpe3ZhciBpO2lmKGdlKGUpKXtpZighKHQmJnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmlzUGF5bWVudE1ldGhvZEluaXRpYWxpemVkKHttZXRob2RJZDp0fSl8fFwiSE9TVEVEX0ZJRUxEU19JTlZBTElEX0ZJRUxEX1NFTEVDVE9SXCIhPT1lLmNvZGUpKXJldHVybjtpZihlLmNvZGUuc3RhcnRzV2l0aChcIlRIUkVFRFNfXCIpKXJldHVybiBudWxsPT09KGk9dGhpcy5vblBheW1lbnRFcnJvcil8fHZvaWQgMD09PWl8fGkuY2FsbCh0aGlzLG5ldyAkKFwiVEhSRUVEU19WRVJJRklDQVRJT05fRkFJTEVEXCIpKSxQcm9taXNlLnJlamVjdCgpO3Rocm93IG5ldyAkKGUubWVzc2FnZSl9dGhyb3cgZX1wcmVwYXJlUGF5bWVudERhdGEoZSx0LGkpe3JldHVybiBZZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cGF5bWVudERhdGE6bn09ZSxyPXtkZXZpY2VTZXNzaW9uSWQ6dGhpcy5kZXZpY2VTZXNzaW9uSWR9O2lmKHRoaXMuaXNTdWJtaXR0aW5nV2l0aFN0b3JlZENhcmQoZSkpcmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSxuKTtjb25zdHtzaG91bGRTYXZlSW5zdHJ1bWVudDpvPSExLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6YT0hMX09cShuKT9uOnt9LHtub25jZTpzfT10aGlzLnNob3VsZFBlcmZvcm0zRFNWZXJpZmljYXRpb24oZSk/eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudmVyaWZ5Q2FyZChlLHQsaSk6eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudG9rZW5pemVDYXJkKGUsdCk7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7bm9uY2U6cyxzaG91bGRTYXZlSW5zdHJ1bWVudDpvLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6YX0pfSl9cHJlcGFyZUhvc3RlZFBheW1lbnREYXRhKGUsdCxpKXtyZXR1cm4gWWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnREYXRhOm59PWUscj17ZGV2aWNlU2Vzc2lvbklkOnRoaXMuZGV2aWNlU2Vzc2lvbklkfTtpZih0aGlzLmlzU3VibWl0dGluZ1dpdGhTdG9yZWRDYXJkKGUpKXtjb25zdHtub25jZTplfT15aWVsZCB0aGlzLmJyYWludHJlZUhvc3RlZEZvcm0udG9rZW5pemVGb3JTdG9yZWRDYXJkVmVyaWZpY2F0aW9uKCk7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHIpLG4pLHtub25jZTplfSl9Y29uc3R7c2hvdWxkU2F2ZUluc3RydW1lbnQ6bz0hMSxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OmE9ITF9PXEobik/bjp7fSx7bm9uY2U6c309dGhpcy5zaG91bGRQZXJmb3JtM0RTVmVyaWZpY2F0aW9uKGUpP3lpZWxkIHRoaXMudmVyaWZ5Q2FyZFdpdGhIb3N0ZWRGb3JtKHQsaSk6eWllbGQgdGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtLnRva2VuaXplKHQpO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse3Nob3VsZFNhdmVJbnN0cnVtZW50Om8sc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDphLG5vbmNlOnN9KX0pfXByZXBhcmVBZGRpdGlvbmFsQWN0aW9uUGF5bWVudERhdGEoZSx0KXtjb25zdHtwYXltZW50RGF0YTppfT1lLG49e2RldmljZVNlc3Npb25JZDp0aGlzLmRldmljZVNlc3Npb25JZCxub25jZTp0fSx7c2hvdWxkU2F2ZUluc3RydW1lbnQ6cj0hMSxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50Om89ITF9PXEoaSk/aTp7fTtyZXR1cm4gdGhpcy5pc1N1Ym1pdHRpbmdXaXRoU3RvcmVkQ2FyZChlKSYmKHJ8fG8pP09iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxpKSxuKTpPYmplY3QuYXNzaWduKHt9LG4pfXZlcmlmeUNhcmRXaXRoSG9zdGVkRm9ybShlLHQpe3JldHVybiBZZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgaT15aWVsZCB0aGlzLmJyYWludHJlZUhvc3RlZEZvcm0udG9rZW5pemUoZSk7cmV0dXJuIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmNoYWxsZW5nZTNEU1ZlcmlmaWNhdGlvbihpLHQpfSl9cHJvY2Vzc0FkZGl0aW9uYWxBY3Rpb24oZSx0LGkpe3JldHVybiBZZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIShlPT5cIm9iamVjdFwiPT10eXBlb2YgZSYmbnVsbCE9PWUmJlwiYm9keVwiaW4gZSkoZSl8fCFkKGUuYm9keS5lcnJvcnMse2NvZGU6XCJ0aHJlZV9kX3NlY3VyZV9yZXF1aXJlZFwifSkpcmV0dXJuIHRoaXMuaGFuZGxlRXJyb3IoZSk7dHJ5e2NvbnN0e3BheWVyX2F1dGhfcmVxdWVzdDpufT1mdW5jdGlvbihlKXtyZXR1cm5cIm9iamVjdFwiPT10eXBlb2YgZSYmbnVsbCE9PWUmJlwibmFtZVwiaW4gZSYmXCJib2R5XCJpbiBlJiZcInN0YXR1c1wiaW4gZS5ib2R5JiZcInRocmVlX2RzX3Jlc3VsdFwiaW4gZS5ib2R5JiZcInBheWVyX2F1dGhfcmVxdWVzdFwiaW4gZS5ib2R5LnRocmVlX2RzX3Jlc3VsdCYmXCJlcnJvcnNcImluIGUuYm9keX0oZSkmJmUuYm9keS50aHJlZV9kc19yZXN1bHR8fHt9LHtwYXltZW50RGF0YTpyfT10LG89dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCk7aWYoIXJ8fCFIKHIpKXRocm93IG5ldyBSKFtcImluc3RydW1lbnRJZFwiXSk7Y29uc3QgYT1vLmdldENhcmRJbnN0cnVtZW50T3JUaHJvdyhyLmluc3RydW1lbnRJZCkse25vbmNlOnN9PXlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmNoYWxsZW5nZTNEU1ZlcmlmaWNhdGlvbih7bm9uY2U6bnx8XCJcIixiaW46YS5paW59LGkpLGQ9dGhpcy5wcmVwYXJlQWRkaXRpb25hbEFjdGlvblBheW1lbnREYXRhKHQscyk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHQpLHtwYXltZW50RGF0YTpkfSkpfWNhdGNoKGUpe3JldHVybiB0aGlzLmhhbmRsZUVycm9yKGUpfX0pfWlzSG9zdGVkUGF5bWVudEZvcm1FbmFibGVkKGUsdCl7cmV0dXJuISFlJiYhMD09PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KGUsdCkuY29uZmlnLmlzSG9zdGVkRm9ybUVuYWJsZWR9aXNTdWJtaXR0aW5nV2l0aFN0b3JlZENhcmQoZSl7cmV0dXJuISghZS5wYXltZW50RGF0YXx8IUgoZS5wYXltZW50RGF0YSkpfXNob3VsZFBlcmZvcm0zRFNWZXJpZmljYXRpb24oZSl7cmV0dXJuISghdGhpcy5pczNkc0VuYWJsZWR8fHRoaXMuaXNTdWJtaXR0aW5nV2l0aFN0b3JlZENhcmQoZSkpfXNob3VsZEluaXRpYWxpemVCcmFpbnRyZWVGYXN0bGFuZSgpe3ZhciBlO2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudFByb3ZpZGVyQ3VzdG9tZXJPclRocm93KCksaT1fZSh0KT90Ont9O3JldHVybihudWxsPT09KGU9dGhpcy5wYXltZW50TWV0aG9kKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5pbml0aWFsaXphdGlvbkRhdGEuaXNBY2NlbGVyYXRlZENoZWNrb3V0RW5hYmxlZCkmJiEobnVsbD09aT92b2lkIDA6aS5hdXRoZW50aWNhdGlvblN0YXRlKX1pbml0aWFsaXplQnJhaW50cmVlRmFzdGxhbmVPclRocm93KGUpe3JldHVybiBZZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxpPXQuZ2V0Q2FydE9yVGhyb3coKSxuPXQuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coZSkse2NsaWVudFRva2VuOnIsY29uZmlnOm99PW47aWYoIXIpdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudE1ldGhvZCk7dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuaW5pdGlhbGl6ZShyLHRoaXMudGhyZWVEU2VjdXJlKSx5aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRCcmFpbnRyZWVGYXN0bGFuZShpLmlkLG8udGVzdE1vZGUpfSl9fWZ1bmN0aW9uIEtlKGUpe3JldHVyblwiY2FyZE51bWJlclwiaW4gZX1mdW5jdGlvbiBYZShlKXtpZighTShlKSlyZXR1cm4hMTtjb25zdHtkZXRhaWxzOnR9PWU7cmV0dXJuIHZvaWQgMD09PXR8fFwib2JqZWN0XCI9PXR5cGVvZiB0JiZudWxsIT09dCYmdm9pZCAwPT09dC5pbnZhbGlkRmllbGRLZXlzfHwoaT10LEFycmF5LmlzQXJyYXkoaSkmJmkuZXZlcnkoZT0+XCJzdHJpbmdcIj09dHlwZW9mIGUpKTt2YXIgaX12YXIgUWUsWmU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07IWZ1bmN0aW9uKGUpe2VbZS5DcmVkaXRDYXJkPTBdPVwiQ3JlZGl0Q2FyZFwiLGVbZS5TdG9yZWRDYXJkVmVyaWZpY2F0aW9uPTFdPVwiU3RvcmVkQ2FyZFZlcmlmaWNhdGlvblwifShRZXx8KFFlPXt9KSk7Y2xhc3MgZXR7Y29uc3RydWN0b3IoZSx0KXt0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlcj1lLHRoaXMuYnJhaW50cmVlU0RLVmVyc2lvbk1hbmFnZXI9dCx0aGlzLmlzSW5pdGlhbGl6ZWRIb3N0ZWRGb3JtPSExLHRoaXMuaGFuZGxlQmx1cj1lPT57dmFyIHQsaTtudWxsPT09KGk9bnVsbD09PSh0PXRoaXMuZm9ybU9wdGlvbnMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0Lm9uQmx1cil8fHZvaWQgMD09PWl8fGkuY2FsbCh0LHtmaWVsZFR5cGU6dGhpcy5tYXBGaWVsZFR5cGUoZS5lbWl0dGVkQnkpLGVycm9yczp0aGlzLm1hcEVycm9ycyhlLmZpZWxkcyl9KX0sdGhpcy5oYW5kbGVGb2N1cz1lPT57dmFyIHQsaTtudWxsPT09KGk9bnVsbD09PSh0PXRoaXMuZm9ybU9wdGlvbnMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0Lm9uRm9jdXMpfHx2b2lkIDA9PT1pfHxpLmNhbGwodCx7ZmllbGRUeXBlOnRoaXMubWFwRmllbGRUeXBlKGUuZW1pdHRlZEJ5KX0pfSx0aGlzLmhhbmRsZUNhcmRUeXBlQ2hhbmdlPWU9Pnt2YXIgdCxpO2NvbnN0IG49MT09PWUuY2FyZHMubGVuZ3RoP2UuY2FyZHNbMF0udHlwZS5yZXBsYWNlKC9ebWFzdGVyLWNhcmQkLyxcIm1hc3RlcmNhcmRcIik6dm9pZCAwO251bGw9PT0oaT1udWxsPT09KHQ9dGhpcy5mb3JtT3B0aW9ucyl8fHZvaWQgMD09PXQ/dm9pZCAwOnQub25DYXJkVHlwZUNoYW5nZSl8fHZvaWQgMD09PWl8fGkuY2FsbCh0LHtjYXJkVHlwZTpufSl9LHRoaXMuaGFuZGxlSW5wdXRTdWJtaXRSZXF1ZXN0PWU9Pnt2YXIgdCxpO251bGw9PT0oaT1udWxsPT09KHQ9dGhpcy5mb3JtT3B0aW9ucyl8fHZvaWQgMD09PXQ/dm9pZCAwOnQub25FbnRlcil8fHZvaWQgMD09PWl8fGkuY2FsbCh0LHtmaWVsZFR5cGU6dGhpcy5tYXBGaWVsZFR5cGUoZS5lbWl0dGVkQnkpfSl9LHRoaXMuaGFuZGxlVmFsaWRpdHlDaGFuZ2U9ZT0+e3ZhciB0LGk7bnVsbD09PShpPW51bGw9PT0odD10aGlzLmZvcm1PcHRpb25zKXx8dm9pZCAwPT09dD92b2lkIDA6dC5vblZhbGlkYXRlKXx8dm9pZCAwPT09aXx8aS5jYWxsKHQse2lzVmFsaWQ6dGhpcy5pc1ZhbGlkRm9ybShlKSxlcnJvcnM6dGhpcy5tYXBWYWxpZGF0aW9uRXJyb3JzKGUuZmllbGRzKX0pfX1pbml0aWFsaXplKGUsdCxuKXt2YXIgcixvLGEscyxkO3JldHVybiBaZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dGhpcy5jbGllbnRUb2tlbj1uLHRoaXMuZm9ybU9wdGlvbnM9ZSx0aGlzLnR5cGU9S2UoZS5maWVsZHMpP1FlLkNyZWRpdENhcmQ6UWUuU3RvcmVkQ2FyZFZlcmlmaWNhdGlvbjtjb25zdCBsPXRoaXMubWFwRmllbGRPcHRpb25zKGUuZmllbGRzLHQpO2kobCk/dGhpcy5pc0luaXRpYWxpemVkSG9zdGVkRm9ybT0hMToodGhpcy5jYXJkRmllbGRzPXlpZWxkIHRoaXMuY3JlYXRlSG9zdGVkRmllbGRzKHtmaWVsZHM6bCxzdHlsZXM6ZS5zdHlsZXMmJnRoaXMubWFwU3R5bGVPcHRpb25zKGUuc3R5bGVzKX0pLG51bGw9PT0ocj10aGlzLmNhcmRGaWVsZHMpfHx2b2lkIDA9PT1yfHxyLm9uKFwiYmx1clwiLHRoaXMuaGFuZGxlQmx1ciksbnVsbD09PShvPXRoaXMuY2FyZEZpZWxkcyl8fHZvaWQgMD09PW98fG8ub24oXCJmb2N1c1wiLHRoaXMuaGFuZGxlRm9jdXMpLG51bGw9PT0oYT10aGlzLmNhcmRGaWVsZHMpfHx2b2lkIDA9PT1hfHxhLm9uKFwiY2FyZFR5cGVDaGFuZ2VcIix0aGlzLmhhbmRsZUNhcmRUeXBlQ2hhbmdlKSxudWxsPT09KHM9dGhpcy5jYXJkRmllbGRzKXx8dm9pZCAwPT09c3x8cy5vbihcInZhbGlkaXR5Q2hhbmdlXCIsdGhpcy5oYW5kbGVWYWxpZGl0eUNoYW5nZSksbnVsbD09PShkPXRoaXMuY2FyZEZpZWxkcyl8fHZvaWQgMD09PWR8fGQub24oXCJpbnB1dFN1Ym1pdFJlcXVlc3RcIix0aGlzLmhhbmRsZUlucHV0U3VibWl0UmVxdWVzdCksdGhpcy5pc0luaXRpYWxpemVkSG9zdGVkRm9ybT0hMCl9KX1pc0luaXRpYWxpemVkKCl7cmV0dXJuISF0aGlzLmlzSW5pdGlhbGl6ZWRIb3N0ZWRGb3JtfWRlaW5pdGlhbGl6ZSgpe3ZhciBlO3JldHVybiBaZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dGhpcy5pc0luaXRpYWxpemVkSG9zdGVkRm9ybSYmKHRoaXMuaXNJbml0aWFsaXplZEhvc3RlZEZvcm09ITEseWllbGQgbnVsbD09PShlPXRoaXMuY2FyZEZpZWxkcyl8fHZvaWQgMD09PWU/dm9pZCAwOmUudGVhcmRvd24oKSl9KX12YWxpZGF0ZSgpe2lmKCF0aGlzLmNhcmRGaWVsZHMpdGhyb3cgbmV3IEQoQy5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO2NvbnN0IGU9dGhpcy5jYXJkRmllbGRzLmdldFN0YXRlKCk7aWYoIXRoaXMuaXNWYWxpZEZvcm0oZSkpe3RoaXMuaGFuZGxlVmFsaWRpdHlDaGFuZ2UoZSk7Y29uc3QgdD10aGlzLm1hcFZhbGlkYXRpb25FcnJvcnMoZS5maWVsZHMpO3Rocm93IG5ldyBYKHQpfX10b2tlbml6ZShlKXt2YXIgdCxpLG4sbyxhO3JldHVybiBaZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuY2FyZEZpZWxkcyl0aHJvdyBuZXcgRChDLlBheW1lbnROb3RJbml0aWFsaXplZCk7dHJ5e2NvbnN0IG89eWllbGQgdGhpcy5jYXJkRmllbGRzLnRva2VuaXplKHMoe2JpbGxpbmdBZGRyZXNzOmUmJnRoaXMubWFwQmlsbGluZ0FkZHJlc3MoZSl9LHIpKTtyZXR1cm4gbnVsbD09PShpPW51bGw9PT0odD10aGlzLmZvcm1PcHRpb25zKXx8dm9pZCAwPT09dD92b2lkIDA6dC5vblZhbGlkYXRlKXx8dm9pZCAwPT09aXx8aS5jYWxsKHQse2lzVmFsaWQ6ITAsZXJyb3JzOnt9fSkse25vbmNlOm8ubm9uY2UsYmluOm51bGw9PT0obj1vLmRldGFpbHMpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmJpbn19Y2F0Y2goZSl7aWYoWGUoZSkpe2NvbnN0IHQ9dGhpcy5tYXBUb2tlbml6ZUVycm9yKGUpO2lmKHQpdGhyb3cgbnVsbD09PShhPW51bGw9PT0obz10aGlzLmZvcm1PcHRpb25zKXx8dm9pZCAwPT09bz92b2lkIDA6by5vblZhbGlkYXRlKXx8dm9pZCAwPT09YXx8YS5jYWxsKG8se2lzVmFsaWQ6ITEsZXJyb3JzOnR9KSxuZXcgWCh0KX10aHJvdyBlfX0pfXRva2VuaXplRm9yU3RvcmVkQ2FyZFZlcmlmaWNhdGlvbigpe3ZhciBlLHQsaSxuLHI7cmV0dXJuIFplKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5jYXJkRmllbGRzKXRocm93IG5ldyBEKEMuUGF5bWVudE5vdEluaXRpYWxpemVkKTt0cnl7Y29uc3Qgbj15aWVsZCB0aGlzLmNhcmRGaWVsZHMudG9rZW5pemUoKTtyZXR1cm4gbnVsbD09PSh0PW51bGw9PT0oZT10aGlzLmZvcm1PcHRpb25zKXx8dm9pZCAwPT09ZT92b2lkIDA6ZS5vblZhbGlkYXRlKXx8dm9pZCAwPT09dHx8dC5jYWxsKGUse2lzVmFsaWQ6ITAsZXJyb3JzOnt9fSkse25vbmNlOm4ubm9uY2UsYmluOm51bGw9PT0oaT1uLmRldGFpbHMpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmJpbn19Y2F0Y2goZSl7aWYoWGUoZSkpe2NvbnN0IHQ9dGhpcy5tYXBUb2tlbml6ZUVycm9yKGUsITApO2lmKHQpdGhyb3cgbnVsbD09PShyPW51bGw9PT0obj10aGlzLmZvcm1PcHRpb25zKXx8dm9pZCAwPT09bj92b2lkIDA6bi5vblZhbGlkYXRlKXx8dm9pZCAwPT09cnx8ci5jYWxsKG4se2lzVmFsaWQ6ITEsZXJyb3JzOnR9KSxuZXcgWCh0KX10aHJvdyBlfX0pfWNyZWF0ZUhvc3RlZEZpZWxkcyhlKXtyZXR1cm4gWmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9eWllbGQgdGhpcy5nZXRDbGllbnQoKSxpPXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRIb3N0ZWRGaWVsZHMoKSxuPXRoaXMuYnJhaW50cmVlU0RLVmVyc2lvbk1hbmFnZXIuZ2V0U0RLVmVyc2lvbigpPT09dj9PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3ByZXZlbnRDdXJzb3JKdW1wczohMH0pOmU7cmV0dXJuIGkuY3JlYXRlKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxuKSx7Y2xpZW50OnR9KSl9KX1nZXRDbGllbnQoKXtyZXR1cm4gWmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLmNsaWVudFRva2VuKXRocm93IG5ldyBEKEMuUGF5bWVudE5vdEluaXRpYWxpemVkKTtpZighdGhpcy5jbGllbnQpe2NvbnN0IGU9eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZENsaWVudCgpO3RoaXMuY2xpZW50PWUuY3JlYXRlKHthdXRob3JpemF0aW9uOnRoaXMuY2xpZW50VG9rZW59KX1yZXR1cm4gdGhpcy5jbGllbnR9KX1tYXBCaWxsaW5nQWRkcmVzcyhlKXtyZXR1cm57Y291bnRyeU5hbWU6ZS5jb3VudHJ5LHBvc3RhbENvZGU6ZS5wb3N0YWxDb2RlLHN0cmVldEFkZHJlc3M6ZS5hZGRyZXNzMj9gJHtlLmFkZHJlc3MxfSAke2UuYWRkcmVzczJ9YDplLmFkZHJlc3MxfX1tYXBGaWVsZE9wdGlvbnMoZSx0KXtpZihLZShlKSl7Y29uc3QgaT17fTtyZXR1cm4gbnVsbD09dHx8dC5mb3JFYWNoKGU9PnsoZT0+T2JqZWN0LnZhbHVlcyhUKS5pbmNsdWRlcyhlKSkoZSkmJihpW2VdPSExKX0pLHMoe251bWJlcjpPYmplY3QuYXNzaWduKHtjb250YWluZXI6YCMke2UuY2FyZE51bWJlci5jb250YWluZXJJZH1gLHBsYWNlaG9sZGVyOmUuY2FyZE51bWJlci5wbGFjZWhvbGRlcixpbnRlcm5hbExhYmVsOmUuY2FyZE51bWJlci5hY2Nlc3NpYmlsaXR5TGFiZWx9LE9iamVjdC5rZXlzKGkpLmxlbmd0aD4wP3tzdXBwb3J0ZWRDYXJkQnJhbmRzOml9Ont9KSxleHBpcmF0aW9uRGF0ZTp7Y29udGFpbmVyOmAjJHtlLmNhcmRFeHBpcnkuY29udGFpbmVySWR9YCxwbGFjZWhvbGRlcjplLmNhcmRFeHBpcnkucGxhY2Vob2xkZXIsaW50ZXJuYWxMYWJlbDplLmNhcmRFeHBpcnkuYWNjZXNzaWJpbGl0eUxhYmVsfSxjdnY6ZS5jYXJkQ29kZSYme2NvbnRhaW5lcjpgIyR7ZS5jYXJkQ29kZS5jb250YWluZXJJZH1gLHBsYWNlaG9sZGVyOmUuY2FyZENvZGUucGxhY2Vob2xkZXIsaW50ZXJuYWxMYWJlbDplLmNhcmRDb2RlLmFjY2Vzc2liaWxpdHlMYWJlbH0sY2FyZGhvbGRlck5hbWU6e2NvbnRhaW5lcjpgIyR7ZS5jYXJkTmFtZS5jb250YWluZXJJZH1gLHBsYWNlaG9sZGVyOmUuY2FyZE5hbWUucGxhY2Vob2xkZXIsaW50ZXJuYWxMYWJlbDplLmNhcmROYW1lLmFjY2Vzc2liaWxpdHlMYWJlbH19LHIpfXJldHVybiBzKHtudW1iZXI6ZS5jYXJkTnVtYmVyVmVyaWZpY2F0aW9uJiZ7Y29udGFpbmVyOmAjJHtlLmNhcmROdW1iZXJWZXJpZmljYXRpb24uY29udGFpbmVySWR9YCxwbGFjZWhvbGRlcjplLmNhcmROdW1iZXJWZXJpZmljYXRpb24ucGxhY2Vob2xkZXJ9LGN2djplLmNhcmRDb2RlVmVyaWZpY2F0aW9uJiZ7Y29udGFpbmVyOmAjJHtlLmNhcmRDb2RlVmVyaWZpY2F0aW9uLmNvbnRhaW5lcklkfWAscGxhY2Vob2xkZXI6ZS5jYXJkQ29kZVZlcmlmaWNhdGlvbi5wbGFjZWhvbGRlcn19LHIpfW1hcFN0eWxlT3B0aW9ucyhlKXtjb25zdCB0PShlPXt9KT0+cyh7Y29sb3I6ZS5jb2xvcixcImZvbnQtZmFtaWx5XCI6ZS5mb250RmFtaWx5LFwiZm9udC1zaXplXCI6ZS5mb250U2l6ZSxcImZvbnQtd2VpZ2h0XCI6ZS5mb250V2VpZ2h0fSxyKTtyZXR1cm57aW5wdXQ6dChlLmRlZmF1bHQpLFwiLmludmFsaWRcIjp0KGUuZXJyb3IpLFwiOmZvY3VzXCI6dChlLmZvY3VzKX19bWFwRmllbGRUeXBlKGUpe3N3aXRjaChlKXtjYXNlXCJudW1iZXJcIjpyZXR1cm4gdGhpcy50eXBlPT09UWUuU3RvcmVkQ2FyZFZlcmlmaWNhdGlvbj9tLkNhcmROdW1iZXJWZXJpZmljYXRpb246bS5DYXJkTnVtYmVyO2Nhc2VcImV4cGlyYXRpb25EYXRlXCI6cmV0dXJuIG0uQ2FyZEV4cGlyeTtjYXNlXCJjdnZcIjpyZXR1cm4gdGhpcy50eXBlPT09UWUuU3RvcmVkQ2FyZFZlcmlmaWNhdGlvbj9tLkNhcmRDb2RlVmVyaWZpY2F0aW9uOm0uQ2FyZENvZGU7Y2FzZVwiY2FyZGhvbGRlck5hbWVcIjpyZXR1cm4gbS5DYXJkTmFtZTtkZWZhdWx0OnRocm93IG5ldyBFcnJvcihcIlVuZXhwZWN0ZWQgZmllbGQgdHlwZVwiKX19bWFwRXJyb3JzKGUpe2NvbnN0IHQ9e307aWYoZSlmb3IoY29uc3RbaSxuXW9mIE9iamVjdC5lbnRyaWVzKGUpKWlmKG4mJnRoaXMuaXNWYWxpZFBhcmFtKGkpKXtjb25zdHtpc1ZhbGlkOmUsaXNFbXB0eTpyLGlzUG90ZW50aWFsbHlWYWxpZDpvfT1uO3RbaV09e2lzVmFsaWQ6ZSxpc0VtcHR5OnIsaXNQb3RlbnRpYWxseVZhbGlkOm99fXJldHVybiB0fW1hcFZhbGlkYXRpb25FcnJvcnMoZSl7cmV0dXJuIE9iamVjdC5rZXlzKGUpLnJlZHVjZSgodCxpKT0+e3ZhciBuO3JldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sdCkse1t0aGlzLm1hcEZpZWxkVHlwZShpKV06KG51bGw9PT0obj1lW2ldKXx8dm9pZCAwPT09bj92b2lkIDA6bi5pc1ZhbGlkKT92b2lkIDA6W3RoaXMuY3JlYXRlSW52YWxpZEVycm9yKHRoaXMubWFwRmllbGRUeXBlKGkpKV19KX0se30pfW1hcFRva2VuaXplRXJyb3IoZSx0PSExKXt2YXIgaSxuO2lmKFwiSE9TVEVEX0ZJRUxEU19GSUVMRFNfRU1QVFlcIj09PWUuY29kZSl7Y29uc3QgZT1bdGhpcy5jcmVhdGVSZXF1aXJlZEVycm9yKHRoaXMubWFwRmllbGRUeXBlKFwiY3Z2XCIpKV07cmV0dXJuIHQ/e1t0aGlzLm1hcEZpZWxkVHlwZShcImN2dlwiKV06ZX06e1t0aGlzLm1hcEZpZWxkVHlwZShcImN2dlwiKV06ZSxbdGhpcy5tYXBGaWVsZFR5cGUoXCJleHBpcmF0aW9uRGF0ZVwiKV06W3RoaXMuY3JlYXRlUmVxdWlyZWRFcnJvcih0aGlzLm1hcEZpZWxkVHlwZShcImV4cGlyYXRpb25EYXRlXCIpKV0sW3RoaXMubWFwRmllbGRUeXBlKFwibnVtYmVyXCIpXTpbdGhpcy5jcmVhdGVSZXF1aXJlZEVycm9yKHRoaXMubWFwRmllbGRUeXBlKFwibnVtYmVyXCIpKV0sW3RoaXMubWFwRmllbGRUeXBlKFwiY2FyZGhvbGRlck5hbWVcIildOlt0aGlzLmNyZWF0ZVJlcXVpcmVkRXJyb3IodGhpcy5tYXBGaWVsZFR5cGUoXCJjYXJkaG9sZGVyTmFtZVwiKSldfX1yZXR1cm4gbnVsbD09PShuPW51bGw9PT0oaT1lLmRldGFpbHMpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmludmFsaWRGaWVsZEtleXMpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLnJlZHVjZSgoZSx0KT0+e2NvbnN0IGk9dGhpcy5tYXBGaWVsZFR5cGUodCk7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7W2ldOlt0aGlzLmNyZWF0ZUludmFsaWRFcnJvcihpKV19KX0se30pfWNyZWF0ZVJlcXVpcmVkRXJyb3IoZSl7dmFyIHQ7cmV0dXJue2ZpZWxkVHlwZTplLG1lc3NhZ2U6bnVsbCE9PSh0PXtbbS5DYXJkQ29kZV06XCJDVlYgaXMgcmVxdWlyZWRcIixbbS5DYXJkQ29kZVZlcmlmaWNhdGlvbl06XCJDVlYgaXMgcmVxdWlyZWRcIixbbS5DYXJkTnVtYmVyXTpcIkNyZWRpdCBjYXJkIG51bWJlciBpcyByZXF1aXJlZFwiLFttLkNhcmROdW1iZXJWZXJpZmljYXRpb25dOlwiQ3JlZGl0IGNhcmQgbnVtYmVyIGlzIHJlcXVpcmVkXCIsW20uQ2FyZEV4cGlyeV06XCJFeHBpcmF0aW9uIGRhdGUgaXMgcmVxdWlyZWRcIixbbS5DYXJkTmFtZV06XCJGdWxsIG5hbWUgaXMgcmVxdWlyZWRcIn1bZV0pJiZ2b2lkIDAhPT10P3Q6XCJGaWVsZCBpcyByZXF1aXJlZFwiLHR5cGU6XCJyZXF1aXJlZFwifX1jcmVhdGVJbnZhbGlkRXJyb3IoZSl7dmFyIHQsaSxuLHI7Y29uc3Qgbz17W20uQ2FyZENvZGVdOnttZXNzYWdlOlwiSW52YWxpZCBjYXJkIGNvZGVcIix0eXBlOlwiaW52YWxpZF9jYXJkX2NvZGVcIn0sW20uQ2FyZENvZGVWZXJpZmljYXRpb25dOnttZXNzYWdlOlwiSW52YWxpZCBjYXJkIGNvZGVcIix0eXBlOlwiaW52YWxpZF9jYXJkX2NvZGVcIn0sW20uQ2FyZE51bWJlcl06e21lc3NhZ2U6XCJJbnZhbGlkIGNhcmQgbnVtYmVyXCIsdHlwZTpcImludmFsaWRfY2FyZF9udW1iZXJcIn0sW20uQ2FyZE51bWJlclZlcmlmaWNhdGlvbl06e21lc3NhZ2U6XCJJbnZhbGlkIGNhcmQgbnVtYmVyXCIsdHlwZTpcImludmFsaWRfY2FyZF9udW1iZXJcIn0sW20uQ2FyZEV4cGlyeV06e21lc3NhZ2U6XCJJbnZhbGlkIGNhcmQgZXhwaXJ5XCIsdHlwZTpcImludmFsaWRfY2FyZF9leHBpcnlcIn0sW20uQ2FyZE5hbWVdOnttZXNzYWdlOlwiSW52YWxpZCBjYXJkIG5hbWVcIix0eXBlOlwiaW52YWxpZF9jYXJkX25hbWVcIn19O3JldHVybntmaWVsZFR5cGU6ZSxtZXNzYWdlOm51bGwhPT0oaT1udWxsPT09KHQ9b1tlXSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQubWVzc2FnZSkmJnZvaWQgMCE9PWk/aTpcIkludmFsaWQgZmllbGRcIix0eXBlOm51bGwhPT0ocj1udWxsPT09KG49b1tlXSl8fHZvaWQgMD09PW4/dm9pZCAwOm4udHlwZSkmJnZvaWQgMCE9PXI/cjpcImludmFsaWRcIn19aXNWYWxpZEZvcm0oZSl7cmV0dXJuIE9iamVjdC5rZXlzKGUuZmllbGRzKS5ldmVyeSh0PT57dmFyIGk7cmV0dXJuIG51bGw9PT0oaT1lLmZpZWxkc1t0XSl8fHZvaWQgMD09PWk/dm9pZCAwOmkuaXNWYWxpZH0pfWlzVmFsaWRQYXJhbShlKXtyZXR1cm5bXCJudW1iZXJcIixcImN2dlwiLFwiZXhwaXJhdGlvbkRhdGVcIixcInBvc3RhbENvZGVcIixcImNhcmRob2xkZXJOYW1lXCIsXCJjYXJkVHlwZVwiXS5pbmNsdWRlcyhlKX19Y29uc3QgdHQ9TCh0PT57Y29uc3QgaT13aW5kb3csbj1uZXcgRih0KSxyPW5ldyB6KGUoKSxpLG4pLG89bmV3IGxlKHIsaSksYT1uZXcgZXQocixuKTtyZXR1cm4gbmV3IEplKHQsbyxhKX0sW3tpZDpcImJyYWludHJlZVwifV0pO3ZhciBpdD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBudHtjb25zdHJ1Y3RvcihlLHQsaSxuKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmZvcm1Qb3N0ZXI9dCx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT1pLHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdz1ufWluaXRpYWxpemUoZSl7cmV0dXJuIGl0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWVwYXlwYWw6dCxtZXRob2RJZDppfT1lLHtjb250YWluZXI6bixvbkVycm9yOnJ9PXR8fHt9O2lmKCFpKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCF0KXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXBheXBhbFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighbil0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVwYXlwYWwuY29udGFpbmVyXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2xldCBvLGE9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCk7dHJ5e2lmKG89YS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSwhby5jbGllbnRUb2tlbil0aHJvdyBuZXcgVShqLk1pc3NpbmdQYXltZW50VG9rZW4pfWNhdGNoKGUpe2E9eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKGkpLG89YS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKX1jb25zdHtjbGllbnRUb2tlbjpzLGNvbmZpZzpkLGluaXRpYWxpemF0aW9uRGF0YTpsfT1vLHtwYXltZW50QnV0dG9uU3R5bGVzOmN9PWx8fHt9LHtjaGVja291dFRvcEJ1dHRvblN0eWxlczp1fT1jfHx7fTtpZighc3x8IWwpdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3QgaD17Y3VycmVuY3k6YS5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGUsaW50ZW50OmwuaW50ZW50LGlzQ3JlZGl0RW5hYmxlZDpsLmlzQ3JlZGl0RW5hYmxlZCxjb21taXQ6ITF9O3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmluaXRpYWxpemUocykseWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5cGFsQ2hlY2tvdXQoaCxlPT57dGhpcy5yZW5kZXJQYXlQYWxCdXR0b24oZSx0LGksQm9vbGVhbihkLnRlc3RNb2RlKSx1KX0sZT0+dGhpcy5oYW5kbGVFcnJvcihlLG4scikpfSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIGl0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS50ZWFyZG93bigpfSl9c2lnbkluKGUsdCl7cmV0dXJuIGl0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbkluQ3VzdG9tZXIoZSx0KX0pfXNpZ25PdXQoZSl7cmV0dXJuIGl0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbk91dEN1c3RvbWVyKGUpfSl9ZXhlY3V0ZVBheW1lbnRNZXRob2RDaGVja291dChlKXt2YXIgdDtyZXR1cm4gbnVsbD09PSh0PW51bGw9PWU/dm9pZCAwOmUuY29udGludWVXaXRoQ2hlY2tvdXRDYWxsYmFjayl8fHZvaWQgMD09PXR8fHQuY2FsbChlKSxQcm9taXNlLnJlc29sdmUoKX1yZW5kZXJQYXlQYWxCdXR0b24oZSx0LGksbixyKXtjb25zdHtjb250YWluZXI6YSxvbkNsaWNrOnM9b309dCx7cGF5cGFsOmR9PXRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdyxsPW51bGw9PWQ/dm9pZCAwOmQuRlVORElORy5QQVlQQUw7aWYoZCYmbCl7Y29uc3Qgbz1kLkJ1dHRvbnMoe2Vudjp0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRCcmFpbnRyZWVFbnYobiksZnVuZGluZ1NvdXJjZTpsLHN0eWxlOk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7aGVpZ2h0OjQwfSksY3JlYXRlT3JkZXI6KCk9PnRoaXMuc2V0dXBQYXltZW50KGUsdCxpKSxvbkFwcHJvdmU6bj0+dGhpcy50b2tlbml6ZVBheW1lbnQobixlLGksdCksb25DbGljazpzfSk7by5pc0VsaWdpYmxlKCkmJm8ucmVuZGVyKGAjJHthfWApfWVsc2UgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UucmVtb3ZlRWxlbWVudChhKX1zZXR1cFBheW1lbnQoZSx0LGkpe3ZhciBuO3JldHVybiBpdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCk7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPXQuZ2V0Q2hlY2tvdXRPclRocm93KCkub3V0c3RhbmRpbmdCYWxhbmNlLG89dC5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGUsYT10LmdldEN1c3RvbWVyKCkscz10LmdldFBheW1lbnRNZXRob2RPclRocm93KGkpLGQ9bnVsbD09YT92b2lkIDA6YS5hZGRyZXNzZXNbMF0sbD1kP3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvQnJhaW50cmVlU2hpcHBpbmdBZGRyZXNzT3ZlcnJpZGUoZCk6dm9pZCAwO3JldHVybiB5aWVsZCBlLmNyZWF0ZVBheW1lbnQoe2Zsb3c6XCJjaGVja291dFwiLGVuYWJsZVNoaXBwaW5nQWRkcmVzczohMCxzaGlwcGluZ0FkZHJlc3NFZGl0YWJsZTohMSxzaGlwcGluZ0FkZHJlc3NPdmVycmlkZTpsLGFtb3VudDpyLGN1cnJlbmN5Om8sb2ZmZXJDcmVkaXQ6ITEsaW50ZW50Om51bGw9PT0obj1zLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PW4/dm9pZCAwOm4uaW50ZW50fSl9Y2F0Y2goZSl7Y29uc3R7Y29udGFpbmVyOmksb25FcnJvcjpufT10O3RoaXMuaGFuZGxlRXJyb3IoZSxpLG4pfX0pfXRva2VuaXplUGF5bWVudChlLHQsaSxuKXtyZXR1cm4gaXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtjb25zdHtkZXZpY2VEYXRhOm59PXlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldERhdGFDb2xsZWN0b3Ioe3BheXBhbDohMH0pLHI9eWllbGQgdC50b2tlbml6ZVBheW1lbnQoZSkse2RldGFpbHM6byxub25jZTphfT1yLHM9dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UubWFwVG9MZWdhY3lCaWxsaW5nQWRkcmVzcyhvKSxkPXRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvTGVnYWN5U2hpcHBpbmdBZGRyZXNzKG8pO3JldHVybiB0aGlzLmZvcm1Qb3N0ZXIucG9zdEZvcm0oXCIvY2hlY2tvdXQucGhwXCIse3BheW1lbnRfdHlwZTpcInBheXBhbFwiLHByb3ZpZGVyOmksYWN0aW9uOlwic2V0X2V4dGVybmFsX2NoZWNrb3V0XCIsbm9uY2U6YSxkZXZpY2VfZGF0YTpuLGJpbGxpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeShzKSxzaGlwcGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KGQpfSkscn1jYXRjaChlKXtjb25zdHtjb250YWluZXI6dCxvbkVycm9yOml9PW47dGhpcy5oYW5kbGVFcnJvcihlLHQsaSl9fSl9aGFuZGxlRXJyb3IoZSx0LGkpe2lmKHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQodCksIWl8fCFNKGUpKXRocm93IGU7aShlKX19Y29uc3QgcnQ9TCh0PT57Y29uc3QgaT13aW5kb3csbj1uZXcgRih0KSxyPW5ldyBsZShuZXcgeihlKCksaSxuKSxpKTtyZXR1cm4gbmV3IG50KHQsdSgpLHIsaSl9LFt7aWQ6XCJicmFpbnRyZWVwYXlwYWxcIn1dKTt2YXIgb3Q9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgYXR7Y29uc3RydWN0b3IoZSx0LGksbil7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5mb3JtUG9zdGVyPXQsdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2U9aSx0aGlzLmJyYWludHJlZUhvc3RXaW5kb3c9bn1pbml0aWFsaXplKGUpe3JldHVybiBvdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7YnJhaW50cmVlcGF5cGFsY3JlZGl0OnQsbWV0aG9kSWQ6aX09ZSx7Y29udGFpbmVyOm4sb25FcnJvcjpyfT10fHx7fTtpZighaSl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdCl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVwYXlwYWxjcmVkaXRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIW4pdGhyb3cgbmV3IFYoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVlcGF5cGFsY3JlZGl0LmNvbnRhaW5lclwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtsZXQgbyxhPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO3RyeXtpZihvPWEuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSksIW8uY2xpZW50VG9rZW4pdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudFRva2VuKX1jYXRjaChlKXthPXlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKSxvPWEuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSl9Y29uc3R7Y2xpZW50VG9rZW46cyxjb25maWc6ZCxpbml0aWFsaXphdGlvbkRhdGE6bH09byx7cGF5bWVudEJ1dHRvblN0eWxlczpjfT1sfHx7fSx7Y2hlY2tvdXRUb3BCdXR0b25TdHlsZXM6dX09Y3x8e307aWYoIXN8fCFsKXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0IGg9e2N1cnJlbmN5OmEuZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlLGludGVudDpsLmludGVudCxpc0NyZWRpdEVuYWJsZWQ6bC5pc0NyZWRpdEVuYWJsZWQsY29tbWl0OiExfTt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKHMpLHlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheXBhbENoZWNrb3V0KGgsZT0+e3RoaXMucmVuZGVyUGF5UGFsQnV0dG9uKGUsdCxpLEJvb2xlYW4oZC50ZXN0TW9kZSksT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHUpLHtoZWlnaHQ6NDB9KSl9LGU9PnRoaXMuaGFuZGxlRXJyb3IoZSxuLHIpKX0pfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBvdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudGVhcmRvd24oKX0pfXNpZ25JbihlLHQpe3JldHVybiBvdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25JbkN1c3RvbWVyKGUsdCl9KX1zaWduT3V0KGUpe3JldHVybiBvdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25PdXRDdXN0b21lcihlKX0pfWV4ZWN1dGVQYXltZW50TWV0aG9kQ2hlY2tvdXQoZSl7dmFyIHQ7cmV0dXJuIG51bGw9PT0odD1udWxsPT1lP3ZvaWQgMDplLmNvbnRpbnVlV2l0aENoZWNrb3V0Q2FsbGJhY2spfHx2b2lkIDA9PT10fHx0LmNhbGwoZSksUHJvbWlzZS5yZXNvbHZlKCl9cmVuZGVyUGF5UGFsQnV0dG9uKGUsdCxpLG4scil7Y29uc3R7Y29udGFpbmVyOmEsb25DbGljazpzPW99PXQse3BheXBhbDpkfT10aGlzLmJyYWludHJlZUhvc3RXaW5kb3c7bGV0IGw9ITE7ZCYmW2QuRlVORElORy5QQVlMQVRFUixkLkZVTkRJTkcuQ1JFRElUXS5mb3JFYWNoKG89PntpZighbCl7Y29uc3QgYz1kLkJ1dHRvbnMoe2VudjpuP1wic2FuZGJveFwiOlwicHJvZHVjdGlvblwiLGZ1bmRpbmdTb3VyY2U6byxzdHlsZTpyLGNyZWF0ZU9yZGVyOigpPT50aGlzLnNldHVwUGF5bWVudChlLHQsaSksb25BcHByb3ZlOm49PnRoaXMudG9rZW5pemVQYXltZW50KG4sZSxpLHQpLG9uQ2xpY2s6c30pO2MuaXNFbGlnaWJsZSgpJiYoYy5yZW5kZXIoYCMke2F9YCksbD0hMCl9fSksZCYmbHx8dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UucmVtb3ZlRWxlbWVudChhKX1zZXR1cFBheW1lbnQoZSx0LGkpe3ZhciBuO3JldHVybiBvdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCk7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPXQuZ2V0Q2hlY2tvdXRPclRocm93KCkub3V0c3RhbmRpbmdCYWxhbmNlLG89dC5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGUsYT10LmdldEN1c3RvbWVyKCkscz10LmdldFBheW1lbnRNZXRob2RPclRocm93KGkpLGQ9bnVsbD09YT92b2lkIDA6YS5hZGRyZXNzZXNbMF0sbD1kP3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvQnJhaW50cmVlU2hpcHBpbmdBZGRyZXNzT3ZlcnJpZGUoZCk6dm9pZCAwO3JldHVybiB5aWVsZCBlLmNyZWF0ZVBheW1lbnQoe2Zsb3c6XCJjaGVja291dFwiLGVuYWJsZVNoaXBwaW5nQWRkcmVzczohMCxzaGlwcGluZ0FkZHJlc3NFZGl0YWJsZTohMSxzaGlwcGluZ0FkZHJlc3NPdmVycmlkZTpsLGFtb3VudDpyLGN1cnJlbmN5Om8sb2ZmZXJDcmVkaXQ6ITAsaW50ZW50Om51bGw9PT0obj1zLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PW4/dm9pZCAwOm4uaW50ZW50fSl9Y2F0Y2goZSl7Y29uc3R7Y29udGFpbmVyOmksb25FcnJvcjpufT10O3RoaXMuaGFuZGxlRXJyb3IoZSxpLG4pfX0pfXRva2VuaXplUGF5bWVudChlLHQsaSxuKXtyZXR1cm4gb3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtjb25zdHtkZXZpY2VEYXRhOm59PXlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldERhdGFDb2xsZWN0b3Ioe3BheXBhbDohMH0pLHI9eWllbGQgdC50b2tlbml6ZVBheW1lbnQoZSkse2RldGFpbHM6byxub25jZTphfT1yLHM9dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UubWFwVG9MZWdhY3lCaWxsaW5nQWRkcmVzcyhvKSxkPXRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvTGVnYWN5U2hpcHBpbmdBZGRyZXNzKG8pO3JldHVybiB0aGlzLmZvcm1Qb3N0ZXIucG9zdEZvcm0oXCIvY2hlY2tvdXQucGhwXCIse3BheW1lbnRfdHlwZTpcInBheXBhbFwiLHByb3ZpZGVyOmksYWN0aW9uOlwic2V0X2V4dGVybmFsX2NoZWNrb3V0XCIsbm9uY2U6YSxkZXZpY2VfZGF0YTpuLGJpbGxpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeShzKSxzaGlwcGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KGQpfSkscn1jYXRjaChlKXtjb25zdHtjb250YWluZXI6dCxvbkVycm9yOml9PW47dGhpcy5oYW5kbGVFcnJvcihlLHQsaSl9fSl9aGFuZGxlRXJyb3IoZSx0LGkpe2lmKHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQodCksIWl8fCFNKGUpKXRocm93IGU7aShlKX19Y29uc3Qgc3Q9TCh0PT57Y29uc3QgaT13aW5kb3csbj1uZXcgRih0KSxyPW5ldyBsZShuZXcgeihlKCksaSxuKSxpKTtyZXR1cm4gbmV3IGF0KHQsdSgpLHIsaSl9LFt7aWQ6XCJicmFpbnRyZWVwYXlwYWxjcmVkaXRcIn1dKTt2YXIgZHQ9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgbHR7Y29uc3RydWN0b3IoZSx0KXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJyYWludHJlZUZhc3RsYW5lVXRpbHM9dCx0aGlzLmlzQWNjZWxlcmF0ZWRDaGVja291dEVuYWJsZWQ9ITF9aW5pdGlhbGl6ZSh7bWV0aG9kSWQ6ZSxicmFpbnRyZWVmYXN0bGFuZTp0fSl7dmFyIGk7cmV0dXJuIGR0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighZSl0aHJvdyBuZXcgVignVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBcIm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2NvbnN0IG49eWllbGQgdGhpcy5nZXRWYWxpZFBheW1lbnRNZXRob2RPclRocm93KGUpLHtpc0FjY2VsZXJhdGVkQ2hlY2tvdXRFbmFibGVkOnIsaXNGYXN0bGFuZVN0eWxpbmdFbmFibGVkOm99PW4uaW5pdGlhbGl6YXRpb25EYXRhfHx7fSxhPW8/bnVsbD09PShpPW4uaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09aT92b2lkIDA6aS5mYXN0bGFuZVN0eWxlczp2b2lkIDA7dGhpcy5pc0FjY2VsZXJhdGVkQ2hlY2tvdXRFbmFibGVkPSEhcjt0cnl7aWYodGhpcy5pc0FjY2VsZXJhdGVkQ2hlY2tvdXRFbmFibGVkKXtjb25zdCBlPU1lKGEsbnVsbD09dD92b2lkIDA6dC5zdHlsZXMpO3lpZWxkIHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5pbml0aWFsaXplQnJhaW50cmVlRmFzdGxhbmVPclRocm93KG4uaWQsZSl9fWNhdGNoKGUpe31yZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gZHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKX0pfXNpZ25JbihlLHQpe3JldHVybiBkdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25JbkN1c3RvbWVyKGUsdCl9KX1zaWduT3V0KGUpe3JldHVybiBkdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25PdXRDdXN0b21lcihlKX0pfWV4ZWN1dGVQYXltZW50TWV0aG9kQ2hlY2tvdXQoZSl7cmV0dXJuIGR0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtjaGVja291dFBheW1lbnRNZXRob2RFeGVjdXRlZDp0LGNvbnRpbnVlV2l0aENoZWNrb3V0Q2FsbGJhY2s6aX09ZXx8e307aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgaSl0aHJvdyBuZXcgVignVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBcImNvbnRpbnVlV2l0aENoZWNrb3V0Q2FsbGJhY2tcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQgYW5kIGl0IG11c3QgYmUgYSBmdW5jdGlvbi4nKTtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldEN1c3RvbWVyT3JUaHJvdygpO2lmKHRoaXMuaXNBY2NlbGVyYXRlZENoZWNrb3V0RW5hYmxlZCYmbi5pc0d1ZXN0KXtjb25zdCBlPXlpZWxkIHRoaXMuc2hvdWxkUnVuQXV0aGVudGljYXRpb25GbG93KCk7dCYmXCJmdW5jdGlvblwiPT10eXBlb2YgdCYmdCgpLGUmJih5aWVsZCB0aGlzLmJyYWludHJlZUZhc3RsYW5lVXRpbHMucnVuUGF5UGFsQXV0aGVudGljYXRpb25GbG93T3JUaHJvdyh2b2lkIDAsITApKX1pKCl9KX1zaG91bGRSdW5BdXRoZW50aWNhdGlvbkZsb3coKXt2YXIgZTtyZXR1cm4gZHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9XCJicmFpbnRyZWVhY2NlbGVyYXRlZGNoZWNrb3V0XCI7dHJ5e3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZCh0KTtjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KHQpO3JldHVybihudWxsPT09KGU9aS5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLnNob3VsZFJ1bkFjY2VsZXJhdGVkQ2hlY2tvdXQpfHwhMX1jYXRjaChlKXtyZXR1cm4hMX19KX1nZXRWYWxpZFBheW1lbnRNZXRob2RPclRocm93KGUpe3JldHVybiBkdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7bGV0IHQ9ZTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKHQpfWNhdGNoKGkpe3Q9XCJicmFpbnRyZWVcIj09PWU/XCJicmFpbnRyZWVhY2NlbGVyYXRlZGNoZWNrb3V0XCI6XCJicmFpbnRyZWVcIix5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QodCl9cmV0dXJuIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KHQpfSl9fWNvbnN0IGN0PUwodD0+e2NvbnN0IGk9d2luZG93LG49bmV3IEYodCkscj1uZXcgbGUobmV3IHooZSgpLGksbiksaSksbz1uZXcgamUodCxyKTtyZXR1cm4gbmV3IGx0KHQsbyl9LFt7aWQ6XCJicmFpbnRyZWVhY2NlbGVyYXRlZGNoZWNrb3V0XCJ9LHtpZDpcImJyYWludHJlZVwifV0pO2NsYXNzIHV0IGV4dGVuZHMgcHtjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIk5vdCBpbXBsZW1lbnRlZC5cIiksdGhpcy5uYW1lPVwiTm90SW1wbGVtZW50ZWRFcnJvclwiLHRoaXMudHlwZT1cIm5vdF9pbXBsZW1lbnRlZFwifX12YXIgaHQ9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgeXR7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuZm9ybVBvc3Rlcj10LHRoaXMuYnJhaW50cmVlU2RrPWksdGhpcy5idXR0b25DbGFzc05hbWU9XCJ2aXNhLWNoZWNrb3V0LXdyYXBwZXJcIix0aGlzLm9uRXJyb3I9b31pbml0aWFsaXplKGUpe3JldHVybiBodCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7YnJhaW50cmVldmlzYWNoZWNrb3V0OnQsbWV0aG9kSWQ6aX09ZTtpZighaSl0aHJvdyBuZXcgVignVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBcIm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCF0KXRocm93IG5ldyBWKCdVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWV2aXNhY2hlY2tvdXRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKGkpO2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkscj1uLmdldENoZWNrb3V0T3JUaHJvdygpLHtjbGllbnRUb2tlbjphLGNvbmZpZzpzfT1uLmdldFBheW1lbnRNZXRob2RPclRocm93KGkpLGQ9bi5nZXRTdG9yZUNvbmZpZ09yVGhyb3coKTtpZighYSl0aHJvdyBuZXcgVShqLk1pc3NpbmdQYXltZW50TWV0aG9kKTt0aGlzLmJyYWludHJlZVNkay5pbml0aWFsaXplKGEpO2NvbnN0IGw9eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0QnJhaW50cmVlVmlzYUNoZWNrb3V0KCksYz15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXRWaXNhQ2hlY2tvdXRTZGsocy50ZXN0TW9kZSkse2NvbnRhaW5lcjp1LG9uRXJyb3I6aH09dDt0aGlzLm9uRXJyb3I9aHx8bztjb25zdCB5PWwuY3JlYXRlSW5pdE9wdGlvbnMoe3BheW1lbnRSZXF1ZXN0OntjdXJyZW5jeUNvZGU6ZC5jdXJyZW5jeS5jb2RlLHN1YnRvdGFsOlN0cmluZyhyLnN1YnRvdGFsKX0sc2V0dGluZ3M6e2xvY2FsZTpkLnN0b3JlUHJvZmlsZS5zdG9yZUxhbmd1YWdlLHNoaXBwaW5nOntjb2xsZWN0U2hpcHBpbmc6ITB9fX0pLG09dGhpcy5jcmVhdGVTaWduSW5CdXR0b24odSx0aGlzLmJ1dHRvbkNsYXNzTmFtZSk7eWllbGQgYy5pbml0KHkpLGMub24oXCJwYXltZW50LnN1Y2Nlc3NcIixlPT50aGlzLnRva2VuaXplUGF5bWVudChsLGUpLnRoZW4oKCk9PnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkQ2hlY2tvdXQoKSkuY2F0Y2goZT0+dGhpcy5oYW5kbGVFcnJvcihlKSkpLGMub24oXCJwYXltZW50LmVycm9yXCIsKGUsdCk9PnRoaXMuaGFuZGxlRXJyb3IodCkpLG0uc3R5bGUudmlzaWJpbGl0eT1cInZpc2libGVcIn0pfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBodCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZGVpbml0aWFsaXplKCl9KX1zaWduSW4oKXt0aHJvdyBuZXcgdXQoJ0luIG9yZGVyIHRvIHNpZ24gaW4gdmlhIFZpc2FDaGVja291dCwgdGhlIHNob3BwZXIgbXVzdCBjbGljayBvbiBcIlZpc2EgQ2hlY2tvdXRcIiBidXR0b24uJyl9c2lnbk91dChlKXtyZXR1cm4gaHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbk91dEN1c3RvbWVyKGUpLFByb21pc2UucmVzb2x2ZSgpfSl9ZXhlY3V0ZVBheW1lbnRNZXRob2RDaGVja291dChlKXt2YXIgdDtyZXR1cm4gbnVsbD09PSh0PW51bGw9PWU/dm9pZCAwOmUuY29udGludWVXaXRoQ2hlY2tvdXRDYWxsYmFjayl8fHZvaWQgMD09PXR8fHQuY2FsbChlKSxQcm9taXNlLnJlc29sdmUoKX10b2tlbml6ZVBheW1lbnQoZSx0KXtyZXR1cm4gaHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiBQcm9taXNlLmFsbChbZS50b2tlbml6ZSh0KSx0aGlzLmJyYWludHJlZVNkay5nZXREYXRhQ29sbGVjdG9yT3JUaHJvdygpXSkudGhlbigoW2UsdF0pPT57Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxuPWkuZ2V0U2hpcHBpbmdBZGRyZXNzKCkscj1pLmdldEJpbGxpbmdBZGRyZXNzKCkse3NoaXBwaW5nQWRkcmVzczpvPXRoaXMubWFwVG9WaXNhQ2hlY2tvdXRBZGRyZXNzKG4pLGJpbGxpbmdBZGRyZXNzOmE9dGhpcy5tYXBUb1Zpc2FDaGVja291dEFkZHJlc3Mocil9PWU7cmV0dXJuIHRoaXMucG9zdEZvcm0oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHtzaGlwcGluZ0FkZHJlc3M6byxiaWxsaW5nQWRkcmVzczphfSksdCl9KX0pfXBvc3RGb3JtKGUsdCl7Y29uc3R7dXNlckRhdGE6aSxiaWxsaW5nQWRkcmVzczpuLHNoaXBwaW5nQWRkcmVzczpyLGRldGFpbHM6b309ZSx7dXNlckVtYWlsOmF9PWkse2RldmljZURhdGE6c309dDtyZXR1cm4gdGhpcy5mb3JtUG9zdGVyLnBvc3RGb3JtKFwiL2NoZWNrb3V0LnBocFwiLHtwYXltZW50X3R5cGU6ZS50eXBlLG5vbmNlOmUubm9uY2UscHJvdmlkZXI6XCJicmFpbnRyZWV2aXNhY2hlY2tvdXRcIixhY3Rpb246XCJzZXRfZXh0ZXJuYWxfY2hlY2tvdXRcIixkZXZpY2VfZGF0YTpzLGNhcmRfaW5mb3JtYXRpb246SlNPTi5zdHJpbmdpZnkoe3R5cGU6by5jYXJkVHlwZSxudW1iZXI6by5sYXN0VHdvfSksYmlsbGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0QWRkcmVzcyhhLG4pKSxzaGlwcGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0QWRkcmVzcyhhLHIpKX0pfW1hcFRvVmlzYUNoZWNrb3V0QWRkcmVzcyhlKXtyZXR1cm4gZT97Zmlyc3ROYW1lOmUuZmlyc3ROYW1lLGxhc3ROYW1lOmUubGFzdE5hbWUscGhvbmVOdW1iZXI6ZS5waG9uZSxzdHJlZXRBZGRyZXNzOmUuYWRkcmVzczEsZXh0ZW5kZWRBZGRyZXNzOmUuYWRkcmVzczIsbG9jYWxpdHk6ZS5jaXR5LHJlZ2lvbjplLnN0YXRlT3JQcm92aW5jZUNvZGUsY291bnRyeUNvZGU6ZS5jb3VudHJ5Q29kZSxwb3N0YWxDb2RlOmUucG9zdGFsQ29kZX06e319Z2V0QWRkcmVzcyhlLHQ9e30pe3JldHVybntlbWFpbDplLGZpcnN0X25hbWU6dC5maXJzdE5hbWUsbGFzdF9uYW1lOnQubGFzdE5hbWUscGhvbmVfbnVtYmVyOnQucGhvbmVOdW1iZXIsYWRkcmVzc19saW5lXzE6dC5zdHJlZXRBZGRyZXNzLGFkZHJlc3NfbGluZV8yOnQuZXh0ZW5kZWRBZGRyZXNzLGNpdHk6dC5sb2NhbGl0eSxzdGF0ZTp0LnJlZ2lvbixjb3VudHJ5X2NvZGU6dC5jb3VudHJ5Q29kZSxwb3N0YWxfY29kZTp0LnBvc3RhbENvZGV9fWNyZWF0ZVNpZ25JbkJ1dHRvbihlLHQpe2NvbnN0IGk9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7ZX1gKTtpZighaSl0aHJvdyBuZXcgRXJyb3IoXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBwcm92aWRlZCBjb250YWluZXIgSUQgaXMgbm90IHZhbGlkLlwiKTtyZXR1cm4gdGhpcy5pbnNlcnRWaXNhQ2hlY2tvdXRCdXR0b24oaSx0KX1pbnNlcnRWaXNhQ2hlY2tvdXRCdXR0b24oZSx0KXtjb25zdCBpPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7cmV0dXJuIGkuc3R5bGUuZGlzcGxheT1cImZsZXhcIixpLnN0eWxlLmZsZXhEaXJlY3Rpb249XCJjb2x1bW5cIixpLnN0eWxlLnZpc2liaWxpdHk9XCJoaWRkZW5cIixpLnN0eWxlLndpZHRoPVwibWF4LWNvbnRlbnRcIixpLmNsYXNzTmFtZT10LGkuaW5uZXJIVE1MPSdcXG4gICAgICAgICAgICA8aW1nXFxuICAgICAgICAgICAgICAgIGFsdD1cIlZpc2EgQ2hlY2tvdXRcIlxcbiAgICAgICAgICAgICAgICBjbGFzcz1cInYtYnV0dG9uXCJcXG4gICAgICAgICAgICAgICAgcm9sZT1cImJ1dHRvblwiXFxuICAgICAgICAgICAgICAgIHNyYz1cImh0dHBzOi8vc2VjdXJlLmNoZWNrb3V0LnZpc2EuY29tL3dhbGxldC1zZXJ2aWNlcy13ZWIveG8vYnV0dG9uLnBuZz9hY2NlcHRDYW5hZGlhblZpc2FEZWJpdD1mYWxzZSZjb2JyYW5kPXRydWUmaGVpZ2h0PTM0JndpZHRoPTE3OFwiXFxuICAgICAgICAgICAgICAgIC8+XFxuICAgICAgICAgICAgPGEgY2xhc3M9XCJ2LWxlYXJuIHYtbGVhcm4tZGVmYXVsdFwiIHN0eWxlPVwidGV4dC1hbGlnbjogcmlnaHQ7IGRpc3BsYXk6IGJsb2NrOyBmb250LXNpemU6IDEwcHg7IGNvbG9yOiAjMDAzMzY2O1wiIGhyZWY9XCIjXCIgZGF0YS1sb2NhbGU9XCJlbl9VU1wiPlRlbGwgTWUgTW9yZTwvYT4nLGUuYXBwZW5kQ2hpbGQoaSksaX1oYW5kbGVFcnJvcihlKXtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiB0aGlzLm9uRXJyb3IpdGhyb3cgZTt0aGlzLm9uRXJyb3IoZSl9fWNvbnN0IG10PUwodD0+e2NvbnN0IGk9d2luZG93LG49bmV3IEYodCkscj1uZXcgQihuZXcgeihlKCksaSxuKSk7cmV0dXJuIG5ldyB5dCh0LHUoKSxyKX0sW3tpZDpcImJyYWludHJlZXZpc2FjaGVja291dFwifV0pO2NsYXNzIHB0IGV4dGVuZHMgcHtjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIkFuIHVuZXhwZWN0ZWQgZXJyb3IgaGFzIG9jY3VycmVkIGR1cmluZyBidXkgbm93IGNhcnQgY3JlYXRpb24gcHJvY2Vzcy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiksdGhpcy5uYW1lPVwiQnV5Tm93Q2FydENyZWF0aW9uRXJyb3JcIix0aGlzLnR5cGU9XCJidXlfbm93X2NhcnRfY3JlYXRpb25fZXJyb3JcIn19ZnVuY3Rpb24gZ3QoZSl7Y29uc3R7Y29sb3I6dCxmdW5kaW5naWNvbnM6aSxoZWlnaHQ6bj00MCxsYXlvdXQ6byxzaGFwZTphLHNpemU6ZCx0YWdsaW5lOmx9PWV8fHt9LGM9e2NvbG9yOnQsZnVuZGluZ2ljb25zOmksaGVpZ2h0OnZ0KG4pLGxheW91dDpvLHNoYXBlOmF8fFwicmVjdFwiLHNpemU6ZCx0YWdsaW5lOmx9O3JldHVybiBzKGMscil9ZnVuY3Rpb24gdnQoZSl7Y29uc3QgdD1OdW1iZXIoZSk7cmV0dXJuIXR8fE51bWJlci5pc05hTih0KT80MDp0PjU1PzU1OnQ8MjU/MjU6dH12YXIgZnQ9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgYnR7Y29uc3RydWN0b3IoZSx0LGksbil7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5mb3JtUG9zdGVyPXQsdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2U9aSx0aGlzLmJyYWludHJlZUhvc3RXaW5kb3c9bn1pbml0aWFsaXplKGUpe3JldHVybiBmdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7YnJhaW50cmVlcGF5cGFsOnQsY29udGFpbmVySWQ6aSxtZXRob2RJZDpufT1lO2lmKCFuKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFpKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmNvbnRhaW5lcklkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCF0KXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXBheXBhbFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtsZXQgcixvPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO2lmKHQuYnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnMpe2lmKCF0LmN1cnJlbmN5Q29kZSl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVwYXlwYWxjcmVkaXQuY3VycmVuY3lDb2RlXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3I9dC5jdXJyZW5jeUNvZGV9ZWxzZSB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZERlZmF1bHRDaGVja291dCgpLG89dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkscj1vLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZTtjb25zdCBhPW8uZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3cobikse2NsaWVudFRva2VuOnMsY29uZmlnOmQsaW5pdGlhbGl6YXRpb25EYXRhOmx9PWE7aWYoIXN8fCFsKXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0IGM9e2N1cnJlbmN5OnIsaW50ZW50OmwuaW50ZW50LGlzQ3JlZGl0RW5hYmxlZDpsLmlzQ3JlZGl0RW5hYmxlZCxjb21taXQ6ITF9O3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmluaXRpYWxpemUocykseWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0UGF5cGFsQ2hlY2tvdXQoYyxlPT57dGhpcy5yZW5kZXJQYXlQYWxCdXR0b24oZSx0LGksbiwhIWQudGVzdE1vZGUpfSxlPT50aGlzLmhhbmRsZUVycm9yKGUsaSx0Lm9uRXJyb3IpKX0pfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBmdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudGVhcmRvd24oKX0pfXJlbmRlclBheVBhbEJ1dHRvbihlLHQsaSxuLHIpe2NvbnN0e3N0eWxlOm8sc2hvdWxkUHJvY2Vzc1BheW1lbnQ6YSxvbkF1dGhvcml6ZUVycm9yOnMsb25FbGlnaWJpbGl0eUZhaWx1cmU6ZH09dCx7cGF5cGFsOmx9PXRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdztpZihsKXtjb25zdCBjPWwuQnV0dG9ucyh7ZW52OnI/XCJzYW5kYm94XCI6XCJwcm9kdWN0aW9uXCIsZnVuZGluZ1NvdXJjZTpsLkZVTkRJTkcuUEFZUEFMLHN0eWxlOmd0KG8pLGNyZWF0ZU9yZGVyOigpPT50aGlzLnNldHVwUGF5bWVudChlLHQsbiksb25BcHByb3ZlOnQ9PnRoaXMudG9rZW5pemVQYXltZW50KHQsZSxuLGEscyl9KTtjLmlzRWxpZ2libGUoKT9jLnJlbmRlcihgIyR7aX1gKTpkJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBkJiZkKCl9ZWxzZSB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KGkpfXNldHVwUGF5bWVudChlLHQsaSl7dmFyIG47cmV0dXJuIGZ0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtvblBheW1lbnRFcnJvcjpyLHNoaXBwaW5nQWRkcmVzczpvLGJ1eU5vd0luaXRpYWxpemVPcHRpb25zOmF9PXQ7dHJ5e2NvbnN0IHI9XCJmdW5jdGlvblwiPT10eXBlb2YobnVsbD09YT92b2lkIDA6YS5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkpP3lpZWxkIHRoaXMuY3JlYXRlQnV5Tm93Q2FydChhLmdldEJ1eU5vd0NhcnRSZXF1ZXN0Qm9keSgpKTp2b2lkIDA7dGhpcy5idXlOb3dDYXJ0SWQ9bnVsbD09cj92b2lkIDA6ci5pZDtjb25zdCBzPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLGQ9cy5nZXRDdXN0b21lcigpLGw9cy5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSxjPXI/ci5jYXJ0QW1vdW50OnMuZ2V0Q2FydE9yVGhyb3coKS5jYXJ0QW1vdW50LHU9cj90LmN1cnJlbmN5Q29kZTpzLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZSxoPW98fChudWxsPT1kP3ZvaWQgMDpkLmFkZHJlc3Nlc1swXSkseT1oP3ZlKGgpOnZvaWQgMDtyZXR1cm4geWllbGQgZS5jcmVhdGVQYXltZW50KHtmbG93OlwiY2hlY2tvdXRcIixlbmFibGVTaGlwcGluZ0FkZHJlc3M6ITAsc2hpcHBpbmdBZGRyZXNzRWRpdGFibGU6ITEsc2hpcHBpbmdBZGRyZXNzT3ZlcnJpZGU6eSxhbW91bnQ6YyxjdXJyZW5jeTp1LG9mZmVyQ3JlZGl0OiExLGludGVudDpudWxsPT09KG49bC5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmludGVudH0pfWNhdGNoKGUpe3Rocm93IHImJihNKGUpfHxlIGluc3RhbmNlb2YgcCkmJnIoZSksZX19KX10b2tlbml6ZVBheW1lbnQoZSx0LGksbixyKXtyZXR1cm4gZnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtjb25zdHtkZXZpY2VEYXRhOnJ9PXlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldERhdGFDb2xsZWN0b3Ioe3BheXBhbDohMH0pLG89eWllbGQgdC50b2tlbml6ZVBheW1lbnQoZSkse2RldGFpbHM6YSxub25jZTpzfT1vLGQ9dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UubWFwVG9MZWdhY3lCaWxsaW5nQWRkcmVzcyhhKSxsPXRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvTGVnYWN5U2hpcHBpbmdBZGRyZXNzKGEpO3JldHVybiB0aGlzLmZvcm1Qb3N0ZXIucG9zdEZvcm0oXCIvY2hlY2tvdXQucGhwXCIsT2JqZWN0LmFzc2lnbih7cGF5bWVudF90eXBlOlwicGF5cGFsXCIscHJvdmlkZXI6aSxhY3Rpb246bj9cInByb2Nlc3NfcGF5bWVudFwiOlwic2V0X2V4dGVybmFsX2NoZWNrb3V0XCIsbm9uY2U6cyxkZXZpY2VfZGF0YTpyLGJpbGxpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeShkKSxzaGlwcGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KGwpfSx0aGlzLmJ1eU5vd0NhcnRJZCYme2NhcnRfaWQ6dGhpcy5idXlOb3dDYXJ0SWR9KSksb31jYXRjaChlKXt0aHJvdyByJiYoTShlKXx8ZSBpbnN0YW5jZW9mIHApJiZyKGUpLGV9fSl9Y3JlYXRlQnV5Tm93Q2FydChlKXtyZXR1cm4gZnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCFlKXRocm93IG5ldyBVKGouTWlzc2luZ0NhcnQpO3RyeXtyZXR1cm4geWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZUJ1eU5vd0NhcnQoZSl9Y2F0Y2goZSl7dGhyb3cgbmV3IHB0fX0pfWhhbmRsZUVycm9yKGUsdCxpKXtpZih0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KHQpLCFpfHwhTShlKSl0aHJvdyBlO2koZSl9fWNvbnN0IHd0PUwodD0+e2NvbnN0IGk9d2luZG93LG49bmV3IEYodCkscj1uZXcgbGUobmV3IHooZSgpLGksbiksaSk7cmV0dXJuIG5ldyBidCh0LHUoKSxyLGkpfSxbe2lkOlwiYnJhaW50cmVlcGF5cGFsXCJ9XSk7dmFyIEN0PWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIFN0e2NvbnN0cnVjdG9yKGUsdCxpLG4scil7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5mb3JtUG9zdGVyPXQsdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2U9aSx0aGlzLmJyYWludHJlZU1lc3NhZ2VzPW4sdGhpcy5icmFpbnRyZWVIb3N0V2luZG93PXJ9aW5pdGlhbGl6ZShlKXt2YXIgdCxpO3JldHVybiBDdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7YnJhaW50cmVlcGF5cGFsY3JlZGl0Om4sY29udGFpbmVySWQ6cixtZXRob2RJZDpvfT1lO2lmKCFvKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFyKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmNvbnRhaW5lcklkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXBheXBhbGNyZWRpdFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtsZXQgYSxzPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO2lmKG4uYnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnMpe2lmKCFuLmN1cnJlbmN5Q29kZSl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVwYXlwYWxjcmVkaXQuY3VycmVuY3lDb2RlXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2E9bi5jdXJyZW5jeUNvZGV9ZWxzZSB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZERlZmF1bHRDaGVja291dCgpLHM9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksYT1zLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZTtjb25zdCBkPXMuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3cobykse2NsaWVudFRva2VuOmwsY29uZmlnOmMsaW5pdGlhbGl6YXRpb25EYXRhOnV9PWQ7aWYoIWx8fCF1KXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0IGg9e2N1cnJlbmN5OmEsaW50ZW50OnUuaW50ZW50LGlzQ3JlZGl0RW5hYmxlZDp1LmlzQ3JlZGl0RW5hYmxlZCxjb21taXQ6ITF9LHk9eChudWxsIT09KGk9bnVsbD09PSh0PXMuZ2V0U3RvcmVDb25maWcoKSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlcykmJnZvaWQgMCE9PWk/aTp7fSxcIlBBWVBBTC01NjYzLmhpZGVfYnJhaW50cmVlX2NhcmRfYmFubmVyX2ltcGxlbWVudGF0aW9uX2luX2NoZWNrb3V0X3Nka1wiKTt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKGwpLHlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheXBhbENoZWNrb3V0KGgsZT0+eyF5JiZuLm1lc3NhZ2luZ0NvbnRhaW5lcklkJiZ0aGlzLnJlbmRlclBheVBhbE1lc3NhZ2VzKG8sbi5tZXNzYWdpbmdDb250YWluZXJJZCksdGhpcy5yZW5kZXJQYXlQYWxCdXR0b24oZSxuLHIsbywhIWMudGVzdE1vZGUpfSxlPT50aGlzLmhhbmRsZUVycm9yKGUscixuLm9uRXJyb3IpKX0pfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBDdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudGVhcmRvd24oKX0pfXJlbmRlclBheVBhbE1lc3NhZ2VzKGUsdCl7dGhpcy5icmFpbnRyZWVNZXNzYWdlcy5yZW5kZXIoZSx0LHNlLkNBUlQpfXJlbmRlclBheVBhbEJ1dHRvbihlLHQsaSxuLHIpe2NvbnN0e3N0eWxlOm8sc2hvdWxkUHJvY2Vzc1BheW1lbnQ6YSxvbkF1dGhvcml6ZUVycm9yOnMsb25FbGlnaWJpbGl0eUZhaWx1cmU6ZH09dCx7cGF5cGFsOmx9PXRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdztsZXQgYz0hMTtsJiZbbC5GVU5ESU5HLlBBWUxBVEVSLGwuRlVORElORy5DUkVESVRdLmZvckVhY2godT0+e2NvbnN0IGg9dT09PWwuRlVORElORy5DUkVESVQ/T2JqZWN0LmFzc2lnbih7bGFiZWw6b2UuQ1JFRElUfSxndChvKSk6Z3Qobyk7aWYoIWMpe2NvbnN0IG89bC5CdXR0b25zKHtlbnY6cj9cInNhbmRib3hcIjpcInByb2R1Y3Rpb25cIixmdW5kaW5nU291cmNlOnUsc3R5bGU6aCxjcmVhdGVPcmRlcjooKT0+dGhpcy5zZXR1cFBheW1lbnQoZSx0LG4pLG9uQXBwcm92ZTp0PT50aGlzLnRva2VuaXplUGF5bWVudCh0LGUsbixhLHMpfSk7by5pc0VsaWdpYmxlKCk/KG8ucmVuZGVyKGAjJHtpfWApLGM9ITApOmwuRlVORElORy5DUkVESVQmJmQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGQmJmQoKX19KSxsJiZjfHx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KGkpfXNldHVwUGF5bWVudChlLHQsaSl7dmFyIG47cmV0dXJuIEN0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtvblBheW1lbnRFcnJvcjpyLHNoaXBwaW5nQWRkcmVzczpvLGJ1eU5vd0luaXRpYWxpemVPcHRpb25zOmF9PXQ7dHJ5e2NvbnN0IHI9XCJmdW5jdGlvblwiPT10eXBlb2YobnVsbD09YT92b2lkIDA6YS5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkpP3lpZWxkIHRoaXMuY3JlYXRlQnV5Tm93Q2FydChhLmdldEJ1eU5vd0NhcnRSZXF1ZXN0Qm9keSgpKTp2b2lkIDA7dGhpcy5idXlOb3dDYXJ0SWQ9bnVsbD09cj92b2lkIDA6ci5pZDtjb25zdCBzPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLGQ9cy5nZXRDdXN0b21lcigpLGw9cy5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSxjPXI/ci5jYXJ0QW1vdW50OnMuZ2V0Q2FydE9yVGhyb3coKS5jYXJ0QW1vdW50LHU9cj90LmN1cnJlbmN5Q29kZTpzLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZSxoPW98fChudWxsPT1kP3ZvaWQgMDpkLmFkZHJlc3Nlc1swXSkseT1oP3ZlKGgpOnZvaWQgMDtyZXR1cm4geWllbGQgZS5jcmVhdGVQYXltZW50KHtmbG93OlwiY2hlY2tvdXRcIixlbmFibGVTaGlwcGluZ0FkZHJlc3M6ITAsc2hpcHBpbmdBZGRyZXNzRWRpdGFibGU6ITEsc2hpcHBpbmdBZGRyZXNzT3ZlcnJpZGU6eSxhbW91bnQ6YyxjdXJyZW5jeTp1LG9mZmVyQ3JlZGl0OiEwLGludGVudDpudWxsPT09KG49bC5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmludGVudH0pfWNhdGNoKGUpe3Rocm93IHImJihNKGUpfHxlIGluc3RhbmNlb2YgcCkmJnIoZSksZX19KX10b2tlbml6ZVBheW1lbnQoZSx0LGksbixyKXtyZXR1cm4gQ3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtjb25zdHtkZXZpY2VEYXRhOnJ9PXlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldERhdGFDb2xsZWN0b3Ioe3BheXBhbDohMH0pLG89eWllbGQgdC50b2tlbml6ZVBheW1lbnQoZSkse2RldGFpbHM6YSxub25jZTpzfT1vLGQ9dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UubWFwVG9MZWdhY3lCaWxsaW5nQWRkcmVzcyhhKSxsPXRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvTGVnYWN5U2hpcHBpbmdBZGRyZXNzKGEpO3JldHVybiB0aGlzLmZvcm1Qb3N0ZXIucG9zdEZvcm0oXCIvY2hlY2tvdXQucGhwXCIsT2JqZWN0LmFzc2lnbih7cGF5bWVudF90eXBlOlwicGF5cGFsXCIscHJvdmlkZXI6aSxhY3Rpb246bj9cInByb2Nlc3NfcGF5bWVudFwiOlwic2V0X2V4dGVybmFsX2NoZWNrb3V0XCIsbm9uY2U6cyxkZXZpY2VfZGF0YTpyLGJpbGxpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeShkKSxzaGlwcGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KGwpfSx0aGlzLmJ1eU5vd0NhcnRJZCYme2NhcnRfaWQ6dGhpcy5idXlOb3dDYXJ0SWR9KSksb31jYXRjaChlKXt0aHJvdyByJiYoTShlKXx8ZSBpbnN0YW5jZW9mIHApJiZyKGUpLGV9fSl9Y3JlYXRlQnV5Tm93Q2FydChlKXtyZXR1cm4gQ3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCFlKXRocm93IG5ldyBVKGouTWlzc2luZ0NhcnQpO3RyeXtyZXR1cm4geWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmNyZWF0ZUJ1eU5vd0NhcnQoZSl9Y2F0Y2goZSl7dGhyb3cgbmV3IHB0fX0pfWhhbmRsZUVycm9yKGUsdCxpKXtpZih0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KHQpLCFpfHwhTShlKSl0aHJvdyBlO2koZSl9fWNvbnN0IFB0PUwodD0+e2NvbnN0IGk9d2luZG93LG49bmV3IEYodCkscj1uZXcgbGUobmV3IHooZSgpLGksbiksaSksbz1uZXcgY2UodCk7cmV0dXJuIG5ldyBTdCh0LHUoKSxyLG8saSl9LFt7aWQ6XCJicmFpbnRyZWVwYXlwYWxjcmVkaXRcIn1dKTt2YXIgSXQ9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgT3R7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuZm9ybVBvc3Rlcj10LHRoaXMuYnJhaW50cmVlU2RrPWl9aW5pdGlhbGl6ZShlKXtyZXR1cm4gSXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2NvbnRhaW5lcklkOnQsbWV0aG9kSWQ6aX09ZTtpZighaSl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdCl0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5jb250YWluZXJJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSk7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSx7Y2xpZW50VG9rZW46cixpbml0aWFsaXphdGlvbkRhdGE6byxjb25maWc6YX09bi5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKTtpZighcnx8IW8pdGhyb3cgbmV3IFUoai5NaXNzaW5nUGF5bWVudE1ldGhvZCk7dGhpcy5icmFpbnRyZWVTZGsuaW5pdGlhbGl6ZShyKTtjb25zdCBzPXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldEJyYWludHJlZVZpc2FDaGVja291dCgpLHtjdXJyZW5jeTp7Y29kZTpkfSxjYXJ0QW1vdW50Omx9PW4uZ2V0Q2FydE9yVGhyb3coKSxjPXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldFZpc2FDaGVja291dFNkayhhLnRlc3RNb2RlKSx1PXMuY3JlYXRlSW5pdE9wdGlvbnMoe3BheW1lbnRSZXF1ZXN0OntjdXJyZW5jeUNvZGU6ZCxzdWJ0b3RhbDpTdHJpbmcobCl9LHNldHRpbmdzOntzaGlwcGluZzp7Y29sbGVjdFNoaXBwaW5nOiEwfX19KTt0aGlzLmNyZWF0ZVNpZ25JbkJ1dHRvbih0KSx5aWVsZCBjLmluaXQodSksYy5vbihcInBheW1lbnQuc3VjY2Vzc1wiLGU9Pkl0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRTdWNjZXNzKHMsZSl9KSl9KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCl9cGF5bWVudFN1Y2Nlc3MoZSx0KXtyZXR1cm4gSXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiBQcm9taXNlLmFsbChbZS50b2tlbml6ZSh0KSx0aGlzLmJyYWludHJlZVNkay5nZXREYXRhQ29sbGVjdG9yT3JUaHJvdygpXSkudGhlbigoW2UsdF0pPT57Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxuPWkuZ2V0U2hpcHBpbmdBZGRyZXNzKCkscj1pLmdldEJpbGxpbmdBZGRyZXNzKCkse3NoaXBwaW5nQWRkcmVzczpvPXRoaXMudG9WaXNhQ2hlY2tvdXRBZGRyZXNzKG4pLGJpbGxpbmdBZGRyZXNzOmE9dGhpcy50b1Zpc2FDaGVja291dEFkZHJlc3Mocil9PWU7cmV0dXJuIHRoaXMucG9zdEZvcm0oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHtzaGlwcGluZ0FkZHJlc3M6byxiaWxsaW5nQWRkcmVzczphfSksdCl9KX0pfXBvc3RGb3JtKGUsdCl7Y29uc3R7dXNlckRhdGE6aSxiaWxsaW5nQWRkcmVzczpuLHNoaXBwaW5nQWRkcmVzczpyLGRldGFpbHM6b309ZSx7dXNlckVtYWlsOmF9PWkse2RldmljZURhdGE6c309dDtyZXR1cm4gdGhpcy5mb3JtUG9zdGVyLnBvc3RGb3JtKFwiL2NoZWNrb3V0LnBocFwiLHtwYXltZW50X3R5cGU6ZS50eXBlLG5vbmNlOmUubm9uY2UscHJvdmlkZXI6XCJicmFpbnRyZWV2aXNhY2hlY2tvdXRcIixhY3Rpb246XCJzZXRfZXh0ZXJuYWxfY2hlY2tvdXRcIixkZXZpY2VfZGF0YTpzLGNhcmRfaW5mb3JtYXRpb246SlNPTi5zdHJpbmdpZnkoe3R5cGU6by5jYXJkVHlwZSxudW1iZXI6by5sYXN0VHdvfSksYmlsbGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0QWRkcmVzcyhhLG4pKSxzaGlwcGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0QWRkcmVzcyhhLHIpKX0pfXRvVmlzYUNoZWNrb3V0QWRkcmVzcyhlKXtyZXR1cm4gZT97Zmlyc3ROYW1lOmUuZmlyc3ROYW1lLGxhc3ROYW1lOmUubGFzdE5hbWUscGhvbmVOdW1iZXI6ZS5waG9uZSxzdHJlZXRBZGRyZXNzOmUuYWRkcmVzczEsZXh0ZW5kZWRBZGRyZXNzOmUuYWRkcmVzczIsbG9jYWxpdHk6ZS5jaXR5LHJlZ2lvbjplLnN0YXRlT3JQcm92aW5jZUNvZGUsY291bnRyeUNvZGU6ZS5jb3VudHJ5Q29kZSxwb3N0YWxDb2RlOmUucG9zdGFsQ29kZX06e319Z2V0QWRkcmVzcyhlLHQ9e30pe3JldHVybntlbWFpbDplLGZpcnN0X25hbWU6dC5maXJzdE5hbWUsbGFzdF9uYW1lOnQubGFzdE5hbWUscGhvbmVfbnVtYmVyOnQucGhvbmVOdW1iZXIsYWRkcmVzc19saW5lXzE6dC5zdHJlZXRBZGRyZXNzLGFkZHJlc3NfbGluZV8yOnQuZXh0ZW5kZWRBZGRyZXNzLGNpdHk6dC5sb2NhbGl0eSxzdGF0ZTp0LnJlZ2lvbixjb3VudHJ5X2NvZGU6dC5jb3VudHJ5Q29kZSxwb3N0YWxfY29kZTp0LnBvc3RhbENvZGV9fWNyZWF0ZVNpZ25JbkJ1dHRvbihlKXtjb25zdCB0PWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2V9YCk7aWYoIXQpdGhyb3cgbmV3IEVycm9yKFwiTmVlZCBhIGNvbnRhaW5lciB0byBwbGFjZSB0aGUgYnV0dG9uXCIpO3JldHVybiB0aGlzLmluc2VydFZpc2FDaGVja291dEJ1dHRvbih0KX1pbnNlcnRWaXNhQ2hlY2tvdXRCdXR0b24oZSl7Y29uc3QgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3JldHVybiB0LnN0eWxlLmRpc3BsYXk9XCJmbGV4XCIsdC5zdHlsZS5mbGV4RGlyZWN0aW9uPVwiY29sdW1uXCIsdC5zdHlsZS5hbGlnbkl0ZW1zPVwiZmxleC1lbmRcIix0LmlubmVySFRNTD0nXFxuICAgICAgICAgICAgPGltZ1xcbiAgICAgICAgICAgICAgICBhbHQ9XCJWaXNhIENoZWNrb3V0XCJcXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJ2LWJ1dHRvblwiXFxuICAgICAgICAgICAgICAgIHJvbGU9XCJidXR0b25cIlxcbiAgICAgICAgICAgICAgICBzcmM9XCJodHRwczovL3NlY3VyZS5jaGVja291dC52aXNhLmNvbS93YWxsZXQtc2VydmljZXMtd2ViL3hvL2J1dHRvbi5wbmc/YWNjZXB0Q2FuYWRpYW5WaXNhRGViaXQ9ZmFsc2UmY29icmFuZD10cnVlJmhlaWdodD0zNCZ3aWR0aD0xNzhcIlxcbiAgICAgICAgICAgICAgICAvPlxcbiAgICAgICAgICAgIDxhIGNsYXNzPVwidi1sZWFybiB2LWxlYXJuLWRlZmF1bHRcIiBzdHlsZT1cInRleHQtYWxpZ246IHJpZ2h0OyBkaXNwbGF5OiBibG9jazsgZm9udC1zaXplOiAxMHB4OyBjb2xvcjogIzAwMzM2NjtcIiBocmVmPVwiI1wiIGRhdGEtbG9jYWxlPVwiZW5fVVNcIj5UZWxsIE1lIE1vcmU8L2E+JyxlLmFwcGVuZENoaWxkKHQpLHR9fWNvbnN0IGt0PUwodD0+e2NvbnN0IGk9d2luZG93LG49bmV3IEYodCkscj1uZXcgQihuZXcgeihlKCksaSxuKSk7cmV0dXJuIG5ldyBPdCh0LHUoKSxyKX0sW3tpZDpcImJyYWludHJlZXZpc2FjaGVja291dFwifV0pO2Z1bmN0aW9uIEV0KGUpe2NvbnN0e2JpbGxpbmdBZGRyZXNzOnQsZW1haWw6aSxmaXJzdE5hbWU6bixsYXN0TmFtZTpyLHBob25lOm8sc2hpcHBpbmdBZGRyZXNzOmF9PWUscz10fHxhO3JldHVybntlbWFpbDppLGZpcnN0X25hbWU6bixsYXN0X25hbWU6cixwaG9uZV9udW1iZXI6byxhZGRyZXNzX2xpbmVfMTpudWxsPT1zP3ZvaWQgMDpzLmxpbmUxLGFkZHJlc3NfbGluZV8yOm51bGw9PXM/dm9pZCAwOnMubGluZTIsY2l0eTpudWxsPT1zP3ZvaWQgMDpzLmNpdHksc3RhdGU6bnVsbD09cz92b2lkIDA6cy5zdGF0ZSxjb3VudHJ5X2NvZGU6bnVsbD09cz92b2lkIDA6cy5jb3VudHJ5Q29kZSxwb3N0YWxfY29kZTpudWxsPT1zP3ZvaWQgMDpzLnBvc3RhbENvZGV9fWZ1bmN0aW9uIFR0KGUpe2NvbnN0e2VtYWlsOnQscGhvbmU6aSxzaGlwcGluZ0FkZHJlc3M6bn09ZSxyPShudWxsPT1uP3ZvaWQgMDpuLnJlY2lwaWVudE5hbWUpfHxcIlwiLFtvLGFdPXIuc3BsaXQoXCIgXCIpO3JldHVybntlbWFpbDp0LGZpcnN0X25hbWU6b3x8XCJcIixsYXN0X25hbWU6YXx8XCJcIixwaG9uZV9udW1iZXI6aSxhZGRyZXNzX2xpbmVfMTpudWxsPT1uP3ZvaWQgMDpuLmxpbmUxLGFkZHJlc3NfbGluZV8yOm51bGw9PW4/dm9pZCAwOm4ubGluZTIsY2l0eTpudWxsPT1uP3ZvaWQgMDpuLmNpdHksc3RhdGU6bnVsbD09bj92b2lkIDA6bi5zdGF0ZSxjb3VudHJ5X2NvZGU6bnVsbD09bj92b2lkIDA6bi5jb3VudHJ5Q29kZSxwb3N0YWxfY29kZTpudWxsPT1uP3ZvaWQgMDpuLnBvc3RhbENvZGV9fXZhciBBdD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjb25zdCB6dD1lPT57Y29uc3R7Y29sb3I6dCxoZWlnaHQ6aX09ZTtyZXR1cm57YmFja2dyb3VuZENvbG9yOihuPXR8fFwiXCIsbj09PXJlLldISVRFP1wiI0ZGRkZGRlwiOlwiIzNEOTVDRVwiKSxiYWNrZ3JvdW5kUG9zaXRpb246XCI1MCUgNTAlXCIsYmFja2dyb3VuZFNpemU6XCI4MHB4IGF1dG9cIixiYWNrZ3JvdW5kSW1hZ2U6YHVybChcIi9hcHAvYXNzZXRzL2ltZy9wYXltZW50LXByb3ZpZGVycy92ZW5tby1sb2dvLSR7dD09PXJlLldISVRFP3JlLkJMVUU6cmUuV0hJVEV9LnN2Z1wiKWAsYmFja2dyb3VuZFJlcGVhdDpcIm5vLXJlcGVhdFwiLGJvcmRlclJhZGl1czpcIjRweFwiLGN1cnNvcjpcInBvaW50ZXJcIix0cmFuc2l0aW9uOlwiMC4ycyBlYXNlXCIsbWluSGVpZ2h0OmAke2l8fDQwfXB4YCxtaW5XaWR0aDpcIjE1MHB4XCIsaGVpZ2h0OlwiMTAwJVwiLHdpZHRoOlwiMTAwJVwiLGJvcmRlcjp0PT09cmUuV0hJVEU/XCIxcHggc29saWQgYmxhY2tcIjpcIm5vbmVcIn07dmFyIG59O2NsYXNzIE50e2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmZvcm1Qb3N0ZXI9dCx0aGlzLmJyYWludHJlZVNkaz1pLHRoaXMub25FcnJvcj1vfWluaXRpYWxpemUoZSl7cmV0dXJuIEF0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWV2ZW5tbzp0LGNvbnRhaW5lcklkOmksbWV0aG9kSWQ6bn09ZTtpZighbil0aHJvdyBuZXcgVignVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtjb25zdCByPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KG4pLHtjbGllbnRUb2tlbjpvLGluaXRpYWxpemF0aW9uRGF0YTphfT1yLHtwYXltZW50QnV0dG9uU3R5bGVzOnN9PWEse2NhcnRCdXR0b25TdHlsZXM6ZH09c3x8e30sbD0obnVsbD09dD92b2lkIDA6dC5zdHlsZSl8fGQ7aWYoIW98fCFhKXRocm93IG5ldyBVKGouTWlzc2luZ1BheW1lbnRNZXRob2QpO2lmKCFpKXRocm93IG5ldyBWKCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmNvbnRhaW5lcklkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCksdGhpcy5vbkVycm9yPShudWxsPT10P3ZvaWQgMDp0Lm9uRXJyb3IpfHx0aGlzLmhhbmRsZUVycm9yLHRoaXMuYnJhaW50cmVlU2RrLmluaXRpYWxpemUobyk7dHJ5e2NvbnN0IGU9eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0VmVubW9DaGVja291dE9yVGhyb3coKTt0aGlzLnJlbmRlclZlbm1vQnV0dG9uKGUsaSxudWxsPT10P3ZvaWQgMDp0LmJ1eU5vd0luaXRpYWxpemVPcHRpb25zLGwpfWNhdGNoKGUpeyhnZShlKXx8ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBOfShlKSkmJnRoaXMuaGFuZGxlSW5pdGlhbGl6YXRpb25WZW5tb0Vycm9yKGUsaSl9fSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIEF0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4geWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZGVpbml0aWFsaXplKCksUHJvbWlzZS5yZXNvbHZlKCl9KX1oYW5kbGVFcnJvcihlKXt0aHJvdyBuZXcgRXJyb3IoZS5tZXNzYWdlKX1jcmVhdGVCdXlOb3dDYXJ0KGUpe3JldHVybiBBdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YobnVsbD09ZT92b2lkIDA6ZS5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkpKXtjb25zdCB0PW51bGw9PWU/dm9pZCAwOmUuZ2V0QnV5Tm93Q2FydFJlcXVlc3RCb2R5KCk7aWYoIXQpdGhyb3cgbmV3IFUoai5NaXNzaW5nQ2FydCk7dHJ5e3JldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlQnV5Tm93Q2FydCh0KX1jYXRjaChlKXt0aHJvdyBuZXcgcHR9fX0pfWhhbmRsZUluaXRpYWxpemF0aW9uVmVubW9FcnJvcihlLHQpe3JldHVybiB0aGlzLnJlbW92ZVZlbm1vQ29udGFpbmVyKHQpLHRoaXMub25FcnJvcihlKX1yZW1vdmVWZW5tb0NvbnRhaW5lcihlKXtjb25zdCB0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGUpO3QmJnQucmVtb3ZlKCl9cmVuZGVyVmVubW9CdXR0b24oZSx0LGksbil7Y29uc3Qgcj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0KSx7Y29sb3I6b309bnx8e307aWYoIXIpdGhyb3cgbmV3IFYoXCJVbmFibGUgdG8gY3JlYXRlIHdhbGxldCBidXR0b24gd2l0aG91dCB2YWxpZCBjb250YWluZXIgSUQuXCIpO3Iuc2V0QXR0cmlidXRlKFwiYXJpYS1sYWJlbFwiLFwiVmVubW9cIiksT2JqZWN0LmFzc2lnbihyLnN0eWxlLHp0KG58fHt9KSksci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwoKT0+QXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3Iuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIixcInRydWVcIik7Y29uc3QgdD15aWVsZCB0aGlzLmNyZWF0ZUJ1eU5vd0NhcnQoaSk7ZS50b2tlbml6ZSYmZS50b2tlbml6ZSgoZSxpKT0+QXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3IucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIiksZSYmdGhpcy5vbkVycm9yKGUpLHlpZWxkIHRoaXMuaGFuZGxlUG9zdEZvcm0oaSxudWxsPT10P3ZvaWQgMDp0LmlkKX0pKX0pKSxvPT09cmUuQkxVRSYmKHIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZW50ZXJcIiwoKT0+e3Iuc3R5bGUuYmFja2dyb3VuZENvbG9yPVwiIzBhN2ZjMlwifSksci5hZGRFdmVudExpc3RlbmVyKFwibW91c2VsZWF2ZVwiLCgpPT57ci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3I9enQobnx8e30pLmJhY2tncm91bmRDb2xvcn0pKX1oYW5kbGVQb3N0Rm9ybShlLHQpe3JldHVybiBBdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7ZGV2aWNlRGF0YTppfT15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXREYXRhQ29sbGVjdG9yT3JUaHJvdygpLHtub25jZTpuLGRldGFpbHM6cn09ZTt0aGlzLmZvcm1Qb3N0ZXIucG9zdEZvcm0oXCIvY2hlY2tvdXQucGhwXCIsT2JqZWN0LmFzc2lnbih7bm9uY2U6bixwcm92aWRlcjpcImJyYWludHJlZXZlbm1vXCIscGF5bWVudF90eXBlOlwicGF5cGFsXCIsZGV2aWNlX2RhdGE6aSxhY3Rpb246XCJzZXRfZXh0ZXJuYWxfY2hlY2tvdXRcIixiaWxsaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkoRXQocikpLHNoaXBwaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkoVHQocikpfSx0JiZ7Y2FydF9pZDp0fSkpfSl9fWNvbnN0IER0PUwodD0+e2NvbnN0IGk9d2luZG93LG49ZSgpLHI9bmV3IEYodCksbz1uZXcgeihuLGksciksYT1uZXcgQihvKTtyZXR1cm4gbmV3IE50KHQsdSgpLGEpfSxbe2lkOlwiYnJhaW50cmVldmVubW9cIn1dKTtleHBvcnR7SyBhcyBjcmVhdGVCcmFpbnRyZWVBY2hQYXltZW50U3RyYXRlZ3ksdHQgYXMgY3JlYXRlQnJhaW50cmVlQ3JlZGl0Q2FyZFBheW1lbnRTdHJhdGVneSxjdCBhcyBjcmVhdGVCcmFpbnRyZWVGYXN0bGFuZUN1c3RvbWVyU3RyYXRlZ3ksVWUgYXMgY3JlYXRlQnJhaW50cmVlRmFzdGxhbmVQYXltZW50U3RyYXRlZ3ksTmUgYXMgY3JlYXRlQnJhaW50cmVlTG9jYWxNZXRob2RzUGF5bWVudFN0cmF0ZWd5LHd0IGFzIGNyZWF0ZUJyYWludHJlZVBheXBhbEJ1dHRvblN0cmF0ZWd5LFB0IGFzIGNyZWF0ZUJyYWludHJlZVBheXBhbENyZWRpdEJ1dHRvblN0cmF0ZWd5LHN0IGFzIGNyZWF0ZUJyYWludHJlZVBheXBhbENyZWRpdEN1c3RvbWVyU3RyYXRlZ3kscnQgYXMgY3JlYXRlQnJhaW50cmVlUGF5cGFsQ3VzdG9tZXJTdHJhdGVneSx3ZSBhcyBjcmVhdGVCcmFpbnRyZWVQYXlwYWxQYXltZW50U3RyYXRlZ3ksRHQgYXMgY3JlYXRlQnJhaW50cmVlVmVubW9CdXR0b25TdHJhdGVneSxHZSBhcyBjcmVhdGVCcmFpbnRyZWVWZW5tb1BheW1lbnRTdHJhdGVneSxrdCBhcyBjcmVhdGVCcmFpbnRyZWVWaXNhQ2hlY2tvdXRCdXR0b25TdHJhdGVneSxtdCBhcyBjcmVhdGVCcmFpbnRyZWVWaXNhQ2hlY2tvdXRDdXN0b21lclN0cmF0ZWd5LFdlIGFzIGNyZWF0ZUJyYWludHJlZVZpc2FDaGVja291dFBheW1lbnRTdHJhdGVneX07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1icmFpbnRyZWUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///../checkout-sdk-js/dist/esm/integrations/braintree.js\n\n}");

/***/ })

}]);