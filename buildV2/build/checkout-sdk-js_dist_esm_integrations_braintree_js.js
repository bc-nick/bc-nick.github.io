"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackJsonpCheckout"] = self["webpackJsonpCheckout"] || []).push([["checkout-sdk-js_dist_esm_integrations_braintree_js"],{

/***/ "../checkout-sdk-js/dist/esm/integrations/braintree.js":
/*!*************************************************************!*\
  !*** ../checkout-sdk-js/dist/esm/integrations/braintree.js ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("{__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createBraintreeAchPaymentStrategy: () => (/* binding */ Ne),\n/* harmony export */   createBraintreeCreditCardPaymentStrategy: () => (/* binding */ wt),\n/* harmony export */   createBraintreeFastlaneCustomerStrategy: () => (/* binding */ At),\n/* harmony export */   createBraintreeFastlanePaymentStrategy: () => (/* binding */ at),\n/* harmony export */   createBraintreeLocalMethodsPaymentStrategy: () => (/* binding */ Ke),\n/* harmony export */   createBraintreePaypalButtonStrategy: () => (/* binding */ ee),\n/* harmony export */   createBraintreePaypalCreditButtonStrategy: () => (/* binding */ re),\n/* harmony export */   createBraintreePaypalCreditCustomerStrategy: () => (/* binding */ kt),\n/* harmony export */   createBraintreePaypalCustomerStrategy: () => (/* binding */ Pt),\n/* harmony export */   createBraintreePaypalPaymentStrategy: () => (/* binding */ Ve),\n/* harmony export */   createBraintreeVenmoButtonStrategy: () => (/* binding */ Pe),\n/* harmony export */   createBraintreeVenmoPaymentStrategy: () => (/* binding */ ht),\n/* harmony export */   createBraintreeVisaCheckoutButtonStrategy: () => (/* binding */ ge),\n/* harmony export */   createBraintreeVisaCheckoutCustomerStrategy: () => (/* binding */ Mt),\n/* harmony export */   createBraintreeVisaCheckoutPaymentStrategy: () => (/* binding */ lt)\n/* harmony export */ });\n/* harmony import */ var _bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @bigcommerce/form-poster */ \"../checkout-sdk-js/node_modules/@bigcommerce/form-poster/lib/index.js\");\n/* harmony import */ var _bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @bigcommerce/script-loader */ \"../checkout-sdk-js/node_modules/@bigcommerce/script-loader/lib/index.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! lodash */ \"../checkout-sdk-js/node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _braintree_browser_detection__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @braintree/browser-detection */ \"../checkout-sdk-js/node_modules/@braintree/browser-detection/dist/browser-detection.js\");\n/* harmony import */ var _bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @bigcommerce/request-sender */ \"../checkout-sdk-js/node_modules/@bigcommerce/request-sender/esm/index.js\");\nvar h={};function y(e,t,i=!0){var n;return null!==(n=e[t])&&void 0!==n?n:i}h.d=(e,t)=>{for(var i in t)h.o(t,i)&&!h.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},h.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const m=\"3.128.0\",p=\"3.123.2\",g=\"3.106.0\";class v{constructor(e){this.paymentIntegrationService=e,this.braintreeWindow=window}getSDKVersion(){const e=this.paymentIntegrationService.getState().getStoreConfig(),t=(null==e?void 0:e.checkoutSettings.features)||{};return this.getPreloadedSDKVersion()||(y(t,\"PAYPAL-5809.braintree_hosted_fields_fix_version\")?m:y(t,\"PAYPAL-5636.update_braintree_sdk_version\")?p:g)}getPreloadedSDKVersion(){const e=this.braintreeWindow.braintree;if(e){const t=(0,lodash__WEBPACK_IMPORTED_MODULE_2__.find)(Object.values(e),e=>!!e.VERSION);return null==t?void 0:t.VERSION}}}class f extends Error{constructor(e){var t;super(e||\"An unexpected error has occurred.\"),this.name=\"StandardError\",this.type=\"standard\",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,\"function\"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class b extends f{constructor(e){super(e||\"Unsupported browser error\"),this.name=\"UnsupportedBrowserError\",this.type=\"unsupported_browser\"}}class w extends f{constructor(e){super(e||\"Invalid arguments have been provided.\"),this.name=\"InvalidArgumentError\",this.type=\"invalid_argument\"}}class C extends w{constructor(e){let t=\"Unable to submit payment for the order because the payload is invalid.\";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(\", \")}.`),super(t),this.name=\"PaymentArgumentInvalidError\"}}class S extends f{constructor(e,t){super(t||\"Unable to proceed because the payment form contains invalid data.\"),this.details=e,this.name=\"PaymentInvalidFormError\",this.type=\"payment_invalid_form\"}}var P;!function(e){e[e.CheckoutButtonNotInitialized=0]=\"CheckoutButtonNotInitialized\",e[e.CustomerNotInitialized=1]=\"CustomerNotInitialized\",e[e.PaymentNotInitialized=2]=\"PaymentNotInitialized\",e[e.ShippingNotInitialized=3]=\"ShippingNotInitialized\",e[e.SpamProtectionNotInitialized=4]=\"SpamProtectionNotInitialized\"}(P||(P={}));class I extends f{constructor(e){super(function(e){switch(e){case P.CustomerNotInitialized:return\"Unable to proceed because the customer step of checkout has not been initialized.\";case P.PaymentNotInitialized:return\"Unable to proceed because the payment step of checkout has not been initialized.\";case P.ShippingNotInitialized:return\"Unable to proceed because the shipping step of checkout has not been initialized.\";case P.SpamProtectionNotInitialized:return\"Unable to proceed because the checkout spam protection has not been initialized.\";default:return\"Unable to proceed because the required component has not been initialized.\"}}(e)),this.subtype=e,this.name=\"NotInitializedError\",this.type=\"not_initialized\"}}class O extends f{constructor(e){super(e||\"Payment process was cancelled.\"),this.name=\"PaymentMethodCancelledError\",this.type=\"payment_cancelled\"}}class k{constructor(e){const t=new Promise((e,t)=>{this.cancel=t});this.promise=Promise.race([e,t])}}let E=null;const T=[\"buttons\",\"messages\"];var A,z,N,D,M,_,B,x,F;function L(e){return Boolean(\"object\"==typeof e&&null!==e&&(\"type\"in e||\"message\"in e||\"code\"in e))}!function(e){e.HORIZONTAL=\"horizontal\",e.VERTICAL=\"vertical\"}(A||(A={})),function(e){e.SMALL=\"small\",e.MEDIUM=\"medium\",e.LARGE=\"large\",e.RESPONSIVE=\"responsive\"}(z||(z={})),function(e){e.GOLD=\"gold\",e.BLUE=\"blue\",e.SIlVER=\"silver\",e.BLACK=\"black\",e.WHITE=\"white\"}(N||(N={})),function(e){e.CHECKOUT=\"checkout\",e.PAY=\"pay\",e.BUYNOW=\"buynow\",e.PAYPAL=\"paypal\",e.CREDIT=\"credit\"}(D||(D={})),function(e){e.PILL=\"pill\",e.RECT=\"rect\"}(M||(M={})),function(e){e.CART=\"cart\",e.HOME=\"homepage\",e.PAYMENT=\"payment\",e.PRODUCT=\"product\"}(_||(_={})),function(e){e.Sandbox=\"sandbox\",e.Production=\"production\"}(B||(B={})),function(e){e.Client=\"client\",e.DataCollector=\"dataCollector\",e.Fastlane=\"fastlane\",e.GooglePayment=\"googlePayment\",e.HostedFields=\"hostedFields\",e.LocalPayment=\"localPayment\",e.Paypal=\"paypal\",e.PaypalCheckout=\"paypalCheckout\",e.ThreeDSecure=\"threeDSecure\",e.UsBankAccount=\"usBankAccount\",e.Venmo=\"venmo\",e.VisaCheckout=\"visaCheckout\"}(x||(x={})),function(e){e.CardCode=\"cardCode\",e.CardCodeVerification=\"cardCodeVerification\",e.CardExpiry=\"cardExpiry\",e.CardName=\"cardName\",e.CardNumber=\"cardNumber\",e.CardNumberVerification=\"cardNumberVerification\"}(F||(F={}));var V=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class j{constructor(e,t,i){this.braintreeScriptLoader=e,this.braintreeHostWindow=t,this.overlay=i,this.dataCollectors={}}initialize(e,t){this.clientToken=e,this.threeDSecureOptions=t}getBraintreeFastlane(e,t,i){return V(this,void 0,void 0,function*(){if(t&&(window.localStorage.setItem(\"axoEnv\",\"sandbox\"),window.localStorage.setItem(\"fastlaneEnv\",\"sandbox\")),!this.braintreeHostWindow.braintreeFastlane){const t=this.getClientTokenOrThrow(),n=yield this.getClient(),r=yield this.getSessionId(e),o=yield this.braintreeScriptLoader.loadFastlane(),a={root:{backgroundColorPrimary:\"transparent\"}};this.braintreeHostWindow.braintreeFastlane=yield o.create({authorization:t,client:n,deviceData:r,styles:i||a})}return this.braintreeHostWindow.braintreeFastlane})}getClient(){return V(this,void 0,void 0,function*(){if(!this.client){const e=this.getClientTokenOrThrow(),t=yield this.braintreeScriptLoader.loadClient();this.client=t.create({authorization:e})}return this.client})}getPaypal(){return this.braintreePaypal||(this.braintreePaypal=Promise.all([this.getClient(),this.braintreeScriptLoader.loadPaypal()]).then(([e,t])=>t.create({client:e}))),this.braintreePaypal}paypal(e){var{shouldSaveInstrument:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"shouldSaveInstrument\"]);const n=(0,_braintree_browser_detection__WEBPACK_IMPORTED_MODULE_3__.supportsPopups)();return this.getPaypal().then(e=>{var r;return n&&(null===(r=this.overlay)||void 0===r||r.show({onClick:()=>e.focusWindow()})),e.tokenize(Object.assign({enableShippingAddress:!0,flow:t?\"vault\":\"checkout\",useraction:\"commit\"},i))}).then(e=>{var t;return null===(t=this.overlay)||void 0===t||t.remove(),e}).catch(e=>{var t;throw null===(t=this.overlay)||void 0===t||t.remove(),e})}getPaypalCheckout(e,t,i){return V(this,void 0,void 0,function*(){const n=yield this.getClient(),r=yield this.braintreeScriptLoader.loadPaypalCheckout(),o={client:n};return this.paypalCheckout=yield r.create(o,(n,r)=>{var o;if(n)return i(n);const a=Object.assign(Object.assign({currency:e.currency},e.isCreditEnabled&&{\"enable-funding\":\"paylater\"}),{components:T.toString(),intent:e.intent,commit:null===(o=e.commit)||void 0===o||o});this.braintreeHostWindow.paypal?t(r):function(e,t){return E||(E=new Promise((i,n)=>{e.loadPayPalSDK(t,t=>{t?(E=null,n(t)):i(e)})})),E}(r,a).then(()=>t(r))}),this.paypalCheckout})}getDataCollector(e){return V(this,void 0,void 0,function*(){const t=(null==e?void 0:e.paypal)?\"paypal\":\"default\";let i=this.dataCollectors[t];if(!i){try{const t=yield this.getClient(),n=yield this.braintreeScriptLoader.loadDataCollector(),r=Object.assign({client:t,kount:!0},e);i=yield n.create(r)}catch(e){if(!L(e)||\"DATA_COLLECTOR_KOUNT_NOT_ENABLED\"!==e.code)throw e;i={deviceData:void 0,teardown:()=>Promise.resolve()}}this.dataCollectors[t]=i}return i})}getBraintreeEnv(e=!1){return e?B.Sandbox:B.Production}mapToBraintreeShippingAddressOverride(e){return{recipientName:`${e.firstName} ${e.lastName}`,line1:e.address1,line2:e.address2,city:e.city,state:e.stateOrProvinceCode,postalCode:e.postalCode,countryCode:e.countryCode,phone:e.phone}}mapToLegacyShippingAddress(e){const{email:t,phone:i,shippingAddress:n}=e,r=(null==n?void 0:n.recipientName)||\"\",[o,a]=r.split(\" \");return{email:t,first_name:o||\"\",last_name:a||\"\",phone_number:i,address_line_1:null==n?void 0:n.line1,address_line_2:null==n?void 0:n.line2,city:null==n?void 0:n.city,state:null==n?void 0:n.state,country_code:null==n?void 0:n.countryCode,postal_code:null==n?void 0:n.postalCode}}mapToLegacyBillingAddress(e){const{billingAddress:t,email:i,firstName:n,lastName:r,phone:o,shippingAddress:a}=e,s=t||a;return{email:i,first_name:n,last_name:r,phone_number:o,address_line_1:null==s?void 0:s.line1,address_line_2:null==s?void 0:s.line2,city:null==s?void 0:s.city,state:null==s?void 0:s.state,country_code:null==s?void 0:s.countryCode,postal_code:null==s?void 0:s.postalCode}}removeElement(e){const t=e&&document.getElementById(e);t&&t.remove()}getSessionId(e){return V(this,void 0,void 0,function*(){const{deviceData:t}=yield this.getDataCollector({riskCorrelationId:e});return t})}teardown(){return V(this,void 0,void 0,function*(){yield this.teardownModule(this.dataCollectors.default),yield this.teardownModule(this.dataCollectors.paypal),this.dataCollectors={},yield this.teardownModule(this.paypalCheckout),this.paypalCheckout=void 0})}get3DS(){return V(this,void 0,void 0,function*(){return this.threeDS||(this.threeDS=Promise.all([this.getClient(),this.braintreeScriptLoader.load3DS()]).then(([e,t])=>t.create({client:e,version:2}))),this.threeDS})}getVenmoCheckout(e){return V(this,void 0,void 0,function*(){if(!this.venmoCheckout){const t=yield this.getClient(),i=yield this.braintreeScriptLoader.loadVenmoCheckout(),n=Object.assign({client:t,allowDesktop:!0,paymentMethodUsage:\"multi_use\"},e||{});this.venmoCheckout=yield new Promise((e,t)=>{i.create(n,(i,n)=>i?t(i):n.isBrowserSupported()?void e(n):t(new b))})}return this.venmoCheckout})}verifyCard(e,t,i){return V(this,void 0,void 0,function*(){const n=yield this.tokenizeCard(e,t);return this.challenge3DSVerification(n,i)})}tokenizeCard(e,t){return V(this,void 0,void 0,function*(){const{paymentData:i}=e;if(!function(e){if(\"object\"!=typeof e||null===e)return!1;const t=e;return\"object\"==typeof t.ccExpiry&&null!==t.ccExpiry&&\"string\"==typeof t.ccNumber&&\"string\"==typeof t.ccName}(i))throw new C([\"payment.paymentData\"]);const r=this.getErrorsRequiredFields(i);if(!(0,lodash__WEBPACK_IMPORTED_MODULE_2__.isEmpty)(r))throw new S(r);const o=this.mapToCreditCard(i,t),a=yield this.getClient(),{creditCards:s}=yield a.request(o);return{nonce:s[0].nonce,bin:s[0].details.bin}})}challenge3DSVerification(e,t){return V(this,void 0,void 0,function*(){const i=yield this.get3DS();return this.present3DSChallenge(i,t,e)})}teardownModule(e){return e?e.teardown():Promise.resolve()}getClientTokenOrThrow(){if(!this.clientToken)throw new I(P.PaymentNotInitialized);return this.clientToken}getErrorsRequiredFields(e){const{ccNumber:t,ccExpiry:i}=e,n={};return t||(n.ccNumber=[{message:\"Credit card number is required\",type:\"required\"}]),i||(n.ccExpiry=[{message:\"Expiration date is required\",type:\"required\"}]),n}mapToCreditCard(e,t){return{data:{creditCard:{cardholderName:e.ccName,number:e.ccNumber,cvv:e.ccCvv,expirationDate:`${e.ccExpiry.month}/${e.ccExpiry.year}`,options:{validate:!1},billingAddress:t&&{countryCodeAlpha2:t.countryCode,locality:t.city,countryName:t.country,postalCode:t.postalCode,streetAddress:t.address2?`${t.address1} ${t.address2}`:t.address1}}},endpoint:\"payment_methods/credit_cards\",method:\"post\"}}present3DSChallenge(e,t,i){const{nonce:n,bin:r}=i;if(!this.threeDSecureOptions||!n)throw new I(P.PaymentNotInitialized);const{addFrame:o,removeFrame:a,challengeRequested:s=!0,additionalInformation:d}=this.threeDSecureOptions,l=()=>V(this,void 0,void 0,function*(){const t=yield e.cancelVerifyCard();return u.cancel(new O),t}),c=t.toFixed(2),u=new k(e.verifyCard({addFrame:(e,t)=>{o&&o(e,t,l)},amount:Number(c),bin:r,challengeRequested:s,nonce:n,removeFrame:a,onLookupComplete:(e,t)=>{t()},collectDeviceData:!0,additionalInformation:d}));return u.promise}}class U extends f{constructor(e){super(e||\"Unable to proceed because the client library of a payment method is not loaded or ready to be used.\"),this.name=\"PaymentMethodClientUnavailableError\",this.type=\"payment_method_client_unavailable\"}}const R={[g]:{[x.Client]:\"sha384-26BXDNnJI23JYRyFBj4xe4sVNrUSSiSSu11kxVXNM/vEPONm4LuL00w6ZaTgQewt\",[x.PaypalCheckout]:\"sha384-B+vzbZwnQtzWBthpkT4TXKUibO65tyeK7eCxSvpblgprTep2+IAXB2Cxxjrn710O\",[x.Paypal]:\"sha384-uyAGL1/3+XJAHnGoNy4eCoXdzJ4f7Ilzp+6w9PNnEjs6DCCz9WMyJjMN1gzc78U+\",[x.LocalPayment]:\"sha384-LIvOEMkIVEwVuYBdVOQc1AC5YbGGlwyfUheS0ACK218D2STuVYQlZ4FyEPowAEfT\",[x.DataCollector]:\"sha384-1bo9JDz+Kscthc085cCKWur8CLwUoBpoNyxsDi7932mCl0zFq3A5mv+FQLw9GHpV\",[x.UsBankAccount]:\"sha384-xmHBVaU+w74V+OebD3AaPONFxHUGMf+QRs8G/JxVPXNNP7MDa2jL0ICWHIe2tTfJ\",[x.GooglePayment]:\"sha384-WKDJl8mqoP82qZpMGH6AbZxnvXnSW8ILV4M64CyMLiugGMwu7LyP89wjCkHqsiBe\",[x.ThreeDSecure]:\"sha384-VQUlpGHzsGvs5XeiGFip7EXRsvoHWEXDVmgCacfbyieZI9mdBOqq3NSoyo28OCOB\",[x.VisaCheckout]:\"sha384-yx7mADfzTN0T43Q6rlH49LIg1EJ0iUZgBp/EczX9LXsUGkySgxrD+nWHQRBkyfoT\",[x.Venmo]:\"sha384-QX4rPjoj1ZDhuG0aSyKs56lEKDqTMTcjYxUHY1SzO5VZDsqIE2NTkqot7KNSCyov\",[x.HostedFields]:\"sha384-VvYBACfSu0Cr/J32uKmxG7AXcNOJE1AzIIL3kbikyS7YKp5fz5Is+NzNP/lyauNy\",[x.Fastlane]:\"sha384-9oGsZMRZwpGtDEDYa/dFt76dECqj1xAni9gIKgc3KfMIiRnR73nEeeUDLiBzxhFa\"},[p]:{[x.Client]:\"sha384-o+nbQGcwNNxIBeXeu3+XmbSq+Cg8R3EN3N0l5hXCgMMU2RGY0t1z0LroSEIAbfAO\",[x.PaypalCheckout]:\"sha384-WrfbWPBS4mH86GAoycPSgiH8hQ8KH7A67C93Hjhunv/xhNk2YpBn3wbFA4Fhg9U/\",[x.Paypal]:\"sha384-VF389nvvrRUgDsTXMxTYORDtVegB9IQa3Cxr//DyJnLYnz8/X8VCzEvck2c+Megt\",[x.LocalPayment]:\"sha384-tZKx2rEQbfmZpoPSY5VPmJEhaq4X75dLvwHMs3VE9U+C8lPyw+hWTIL1+GPvWCIH\",[x.DataCollector]:\"sha384-E6k3wOpP7syCDDwaRDLF06942Y00NkbwJvWi2OQXwwKzGwG5fd3E7RFUvCCecfvO\",[x.UsBankAccount]:\"sha384-258FON8LZGG0W9Qaz4Jij83pZHu30YnKjJA7gNulLBh6CclkucgF+tHDQuYFRYfW\",[x.GooglePayment]:\"sha384-taJ2p/0+n0VH328POAoBiuEbL3tnHUTE9S42hK1V+Txs3X+QYjZOyKW35JgHRFfO\",[x.ThreeDSecure]:\"sha384-+NSZH4Zj3sO5bdWvPKhU5N16QDxeueTVTnUVeleeESkhLSaz4Ob1hh/5myecc9Ym\",[x.VisaCheckout]:\"sha384-66DiBjghxk1OmBj8aksN8gbQ+CwoQcx1vPfiXUN08g1iQVM+BwewF0p7toM3i7SS\",[x.Venmo]:\"sha384-B5UwY42kE4RoLoWbQ7YpqosUlUad2/DlGWiw0HhoZbSPk30CQAaSA10ohyLDTkDU\",[x.HostedFields]:\"sha384-Aw9EesSaUeWxe36PqEHiOyOyOq8M6CIb1gw7/yHNVPRzGtFXXcd2OQ8qXrIlOj2P\",[x.Fastlane]:\"sha384-rhBL1hpZ71JqG+2TsT0Dih47mbjx8cjJCpeZjk9tw3df1gFMKfCTmMyZunhr7H4Y\"},[m]:{[x.Client]:\"sha384-0WNxksIpRP+fYZiIdr12g6DBUQfLDzYCQJZtR/C8KkcwSGhPHfcFp3tTaGcMyFTq\",[x.PaypalCheckout]:\"sha384-lWM1jk4BOxoDNV6Kop7tVNvQgINlmEVz0c/OwM+HNHK3QC8xqwd54Ovrt2QRDTjh\",[x.Paypal]:\"sha384-fXUmVxC2EMZBDXZ7eTHSTL/LFBrHej/MSXT/vTBXvra4lzgLNGvREAp+x0GYObuH\",[x.LocalPayment]:\"sha384-pha1xGuGSkmZH5x9aqHvRaO4xLea7rmQ/79PFj9zxNzxuFcOWZg7gOP7FibygOEC\",[x.DataCollector]:\"sha384-Q6PI2F9eekWbAxhroybl+aEcvqhdowN/EQlGwBUyJOzPFn9982u9xl6SU6XfGKzc\",[x.UsBankAccount]:\"sha384-W3RLQSKJL1tQ3+Y7mP6tmkamtZ8bV4Yw/XxL9Jj5JtXHraD8loMF8hAIG5m2zK7F\",[x.GooglePayment]:\"sha384-TITQMsFWA3elDNGP2mWz2oKBo4qjt+TlqzovcaPoeBiAh/wPBi6nae50ADdgU1/i\",[x.ThreeDSecure]:\"sha384-YiycYN89ZlL/Evcaq4y1ajW1mhd7JYfZBDuOwHtIn4/Jnm20GL+/XCM+zYAwWD8D\",[x.VisaCheckout]:\"sha384-/OdaTv9qrkKzjObtUe6yzfDhHozFW/+uXlrSl736sOZRJpjGQETvpYXqMFFg69xv\",[x.Venmo]:\"sha384-dA+ojdW9vbJS4JavcXyOs9d5uZHJg5dNtYupoPSH2zsXIiYDVS5amLb/u8qmQ6oz\",[x.HostedFields]:\"sha384-31ZkS58+iaWsW06ftW52zzVZFp43WPd7pNYRiddYynSNg6Oh7WGbSFGorAUH6T1z\",[x.Fastlane]:\"sha384-jlbrwNvL3HvLAUCtLSmrnQ2GH1udCUrRS/bVmReAS5fuIVvcW8Pko/Gkg82tlgtr\"}};var H,W=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class q{constructor(e,t,i){this.scriptLoader=e,this.braintreeHostWindow=t,this.braintreeSDKVersionManager=i}loadClient(){return W(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(x.Client,\"client.min.js\")})}loadFastlane(){return W(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(x.Fastlane,\"fastlane.min.js\")})}loadPaypalCheckout(){return W(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(x.PaypalCheckout,\"paypal-checkout.min.js\")})}loadPaypal(){return W(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(x.Paypal,\"paypal.min.js\")})}loadLocalPayment(){return W(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(x.LocalPayment,\"local-payment.min.js\")})}loadDataCollector(){return W(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(x.DataCollector,\"data-collector.min.js\")})}loadUsBankAccount(){return W(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(x.UsBankAccount,\"us-bank-account.min.js\")})}loadGooglePayment(){return W(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(x.GooglePayment,\"google-payment.min.js\")})}load3DS(){return W(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(x.ThreeDSecure,\"three-d-secure.min.js\")})}loadVisaCheckout(){return this.loadBraintreeModuleOrThrow(x.VisaCheckout,\"visa-checkout.min.js\")}loadVenmoCheckout(){return this.loadBraintreeModuleOrThrow(x.Venmo,\"venmo.min.js\")}loadHostedFields(){return W(this,void 0,void 0,function*(){return this.loadBraintreeModuleOrThrow(x.HostedFields,\"hosted-fields.min.js\")})}loadVisaCheckoutSdk(e){return W(this,void 0,void 0,function*(){if(this.braintreeHostWindow.V)return this.braintreeHostWindow.V;const t=e?\"sha384-0eu1s1GtqzXlL9DtLgmwzC5WWlEH/ADRM0n38cVQkvtT+W/gey96rcb1LwuUOPDm\":\"sha384-1f1csvP3ZFxg4dILH1GaY4LHlZ0oX7Rk83rxmLlwbnIi4TM0NYzXoev1VoEiVDS6\";return this.scriptLoader.loadScript(`//${e?\"sandbox-\":\"\"}assets.secure.checkout.visa.com/checkout-widget/resources/js/integration/v1/sdk.js`,{async:!0,attributes:{integrity:t,crossorigin:\"anonymous\"}}).then(()=>{if(!this.braintreeHostWindow.V)throw new U;return this.braintreeHostWindow.V})})}loadBraintreeModuleOrThrow(e,t){return W(this,void 0,void 0,function*(){let i=this.getBraintreeModule(e);if(i)return i;const n=this.braintreeSDKVersionManager.getSDKVersion(),r=`//js.braintreegateway.com/web/${n}/js/${t}`,o=n in R?this.getIntegrityValuesByModuleName(e,n):void 0;if(yield this.scriptLoader.loadScript(r,o?{async:!0,attributes:{integrity:o,crossorigin:\"anonymous\"}}:void 0),i=this.getBraintreeModule(e),!i)throw new U;return i})}getBraintreeModule(e){var t;return null===(t=this.braintreeHostWindow.braintree)||void 0===t?void 0:t[e]}getIntegrityValuesByModuleName(e,t){const i=R[t][e];if(!i)throw new Error(\"Unexpected fileName value\");return i}}function $(e,t){return Object.assign(e,{resolveIds:t})}!function(e){e[e.MissingBillingAddress=0]=\"MissingBillingAddress\",e[e.MissingCart=1]=\"MissingCart\",e[e.MissingCheckout=2]=\"MissingCheckout\",e[e.MissingConsignments=3]=\"MissingConsignments\",e[e.MissingCustomer=4]=\"MissingCustomer\",e[e.MissingCheckoutConfig=5]=\"MissingCheckoutConfig\",e[e.MissingOrder=6]=\"MissingOrder\",e[e.MissingOrderConfig=7]=\"MissingOrderConfig\",e[e.MissingOrderId=8]=\"MissingOrderId\",e[e.MissingPayment=9]=\"MissingPayment\",e[e.MissingPaymentId=10]=\"MissingPaymentId\",e[e.MissingPaymentInstrument=11]=\"MissingPaymentInstrument\",e[e.MissingPaymentMethod=12]=\"MissingPaymentMethod\",e[e.MissingPaymentRedirectUrl=13]=\"MissingPaymentRedirectUrl\",e[e.MissingPaymentStatus=14]=\"MissingPaymentStatus\",e[e.MissingPaymentToken=15]=\"MissingPaymentToken\",e[e.MissingShippingAddress=16]=\"MissingShippingAddress\"}(H||(H={}));class G extends f{constructor(e){super(function(e){switch(e){case H.MissingBillingAddress:return\"Unable to proceed because billing address data is unavailable.\";case H.MissingCart:return\"Unable to proceed because cart data is unavailable.\";case H.MissingConsignments:return\"Unable to proceed because consignments data is unavailable.\";case H.MissingCheckout:return\"Unable to proceed because checkout data is unavailable.\";case H.MissingCustomer:return\"Unable to proceed because customer data is unavailable.\";case H.MissingCheckoutConfig:case H.MissingOrderConfig:return\"Unable to proceed because configuration data is unavailable.\";case H.MissingOrder:return\"Unable to proceed because order data is unavailable.\";case H.MissingOrderId:return\"Unable to proceed because order ID is unavailable or not generated yet.\";case H.MissingPayment:return\"Unable to proceed because payment data is unavailable.\";case H.MissingPaymentToken:return\"Unable to proceed because the token required to submit a payment is missing.\";case H.MissingPaymentMethod:return\"Unable to proceed because payment method data is unavailable or not properly configured.\";case H.MissingShippingAddress:return\"Unable to proceed because shipping address data is unavailable.\";default:return\"Unable to proceed because the required data is unavailable.\"}}(e)),this.subtype=e,this.name=\"MissingDataError\",this.type=\"missing_data\"}}class Y extends f{constructor(e){super(e||\"An unexpected error has occurred during buy now cart creation process. Please try again later.\"),this.name=\"BuyNowCartCreationError\",this.type=\"buy_now_cart_creation_error\"}}function J(e){const{color:t,fundingicons:i,height:n=40,layout:r,shape:a,size:s,tagline:l}=e||{},c={color:t,fundingicons:i,height:K(n),layout:r,shape:a||\"rect\",size:s,tagline:l};return (0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)(c,lodash__WEBPACK_IMPORTED_MODULE_2__.isNil)}function K(e){const t=Number(e);return!t||Number.isNaN(t)?40:t>55?55:t<25?25:t}function X(e){return{recipientName:`${e.firstName} ${e.lastName}`,line1:e.address1,line2:e.address2,city:e.city,state:e.stateOrProvinceCode,postalCode:e.postalCode,countryCode:e.countryCode,phone:e.phone}}var Q=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Z{constructor(e,t,i,n){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeHostWindow=n}initialize(e){return Q(this,void 0,void 0,function*(){const{braintreepaypal:t,containerId:i,methodId:n}=e;if(!n)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!i)throw new w('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!t)throw new w('Unable to initialize payment because \"options.braintreepaypal\" argument is not provided.');let r,o=this.paymentIntegrationService.getState();if(t.buyNowInitializeOptions){if(!t.currencyCode)throw new w('Unable to initialize payment because \"options.braintreepaypalcredit.currencyCode\" argument is not provided.');r=t.currencyCode}else yield this.paymentIntegrationService.loadDefaultCheckout(),o=this.paymentIntegrationService.getState(),r=o.getCartOrThrow().currency.code;const a=o.getPaymentMethodOrThrow(n),{clientToken:s,config:d,initializationData:l}=a;if(!s||!l)throw new G(H.MissingPaymentMethod);const c={currency:r,intent:l.intent,isCreditEnabled:l.isCreditEnabled,commit:!1};this.braintreeIntegrationService.initialize(s),yield this.braintreeIntegrationService.getPaypalCheckout(c,e=>{this.renderPayPalButton(e,t,i,n,!!d.testMode)},e=>this.handleError(e,i,t.onError))})}deinitialize(){return Q(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}renderPayPalButton(e,t,i,n,r){const{style:o,shouldProcessPayment:a,onAuthorizeError:s,onEligibilityFailure:d}=t,{paypal:l}=this.braintreeHostWindow;if(l){const c=l.Buttons({env:r?\"sandbox\":\"production\",fundingSource:l.FUNDING.PAYPAL,style:J(o),createOrder:()=>this.setupPayment(e,t,n),onApprove:t=>this.tokenizePayment(t,e,n,a,s)});c.isEligible()?c.render(`#${i}`):d&&\"function\"==typeof d&&d()}else this.braintreeIntegrationService.removeElement(i)}setupPayment(e,t,i){var n;return Q(this,void 0,void 0,function*(){const{onPaymentError:r,shippingAddress:o,buyNowInitializeOptions:a}=t;try{const r=\"function\"==typeof(null==a?void 0:a.getBuyNowCartRequestBody)?yield this.createBuyNowCart(a.getBuyNowCartRequestBody()):void 0;this.buyNowCartId=null==r?void 0:r.id;const s=this.paymentIntegrationService.getState(),d=s.getCustomer(),l=s.getPaymentMethodOrThrow(i),c=r?r.cartAmount:s.getCartOrThrow().cartAmount,u=r?t.currencyCode:s.getCartOrThrow().currency.code,h=o||(null==d?void 0:d.addresses[0]),y=h?X(h):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:y,amount:c,currency:u,offerCredit:!1,intent:null===(n=l.initializationData)||void 0===n?void 0:n.intent})}catch(e){throw r&&(L(e)||e instanceof f)&&r(e),e}})}tokenizePayment(e,t,i,n,r){return Q(this,void 0,void 0,function*(){try{const{deviceData:r}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),o=yield t.tokenizePayment(e),{details:a,nonce:s}=o,d=this.braintreeIntegrationService.mapToLegacyBillingAddress(a),l=this.braintreeIntegrationService.mapToLegacyShippingAddress(a);return this.formPoster.postForm(\"/checkout.php\",Object.assign({payment_type:\"paypal\",provider:i,action:n?\"process_payment\":\"set_external_checkout\",nonce:s,device_data:r,billing_address:JSON.stringify(d),shipping_address:JSON.stringify(l)},this.buyNowCartId&&{cart_id:this.buyNowCartId})),o}catch(e){throw r&&(L(e)||e instanceof f)&&r(e),e}})}createBuyNowCart(e){return Q(this,void 0,void 0,function*(){if(!e)throw new G(H.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(e)}catch(e){throw new Y}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!L(e))throw e;i(e)}}const ee=$(i=>{const n=window,r=new v(i),o=new j(new q((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),n,r),n);return new Z(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),o,n)},[{id:\"braintreepaypal\"}]);class te{constructor(e){this.paymentIntegrationService=e,this.braintreeHostWindow=window}render(e,t,i){const n=t&&document.getElementById(t);if(this.braintreeHostWindow.paypal&&n){const r=this.paymentIntegrationService.getState(),o=r.getCartOrThrow(),a=r.getBillingAddressOrThrow(),s=r.getPaymentMethodOrThrow(e);if(!s.initializationData)return;const{paypalBNPLConfiguration:d=[]}=s.initializationData,l=i===_.PAYMENT?\"checkout\":i,c=d&&d.find(({id:e})=>e===l);if(!c||!c.status)return;i===_.CART&&(n.removeAttribute(\"data-pp-style-logo-type\"),n.removeAttribute(\"data-pp-style-logo-position\"),n.removeAttribute(\"data-pp-style-text-color\"),n.removeAttribute(\"data-pp-style-text-size\")),this.braintreeHostWindow.paypal.Messages({amount:o.cartAmount,buyerCountry:a.countryCode,placement:i,style:this.getPaypalMessagesStylesFromBNPLConfig(c)}).render(`#${t}`)}}getPaypalMessagesStylesFromBNPLConfig({styles:e}){const t={};return e.color&&(t.color=e.color),e.layout&&(t.layout=e.layout),(e[\"logo-type\"]||e[\"logo-position\"])&&(t.logo={},e[\"logo-type\"]&&(t.logo.type=e[\"logo-type\"]),e[\"logo-position\"]&&(t.logo.position=e[\"logo-position\"])),e.ratio&&(t.ratio=e.ratio),(e[\"text-color\"]||e[\"text-size\"])&&(t.text={},e[\"text-color\"]&&(t.text.color=e[\"text-color\"]),e[\"text-size\"]&&(t.text.size=+e[\"text-size\"])),t}}var ie=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ne{constructor(e,t,i,n,r){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeMessages=n,this.braintreeHostWindow=r}initialize(e){var t,i;return ie(this,void 0,void 0,function*(){const{braintreepaypalcredit:n,containerId:r,methodId:o}=e;if(!o)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!r)throw new w('Unable to initialize payment because \"options.containerId\" argument is not provided.');if(!n)throw new w('Unable to initialize payment because \"options.braintreepaypalcredit\" argument is not provided.');let a,s=this.paymentIntegrationService.getState();if(n.buyNowInitializeOptions){if(!n.currencyCode)throw new w('Unable to initialize payment because \"options.braintreepaypalcredit.currencyCode\" argument is not provided.');a=n.currencyCode}else yield this.paymentIntegrationService.loadDefaultCheckout(),s=this.paymentIntegrationService.getState(),a=s.getCartOrThrow().currency.code;const d=s.getPaymentMethodOrThrow(o),{clientToken:l,config:c,initializationData:u}=d;if(!l||!u)throw new G(H.MissingPaymentMethod);const h={currency:a,intent:u.intent,isCreditEnabled:u.isCreditEnabled,commit:!1},m=y(null!==(i=null===(t=s.getStoreConfig())||void 0===t?void 0:t.checkoutSettings.features)&&void 0!==i?i:{},\"PAYPAL-5663.hide_braintree_card_banner_implementation_in_checkout_sdk\");this.braintreeIntegrationService.initialize(l),yield this.braintreeIntegrationService.getPaypalCheckout(h,e=>{!m&&n.messagingContainerId&&this.renderPayPalMessages(o,n.messagingContainerId),this.renderPayPalButton(e,n,r,o,!!c.testMode)},e=>this.handleError(e,r,n.onError))})}deinitialize(){return ie(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}renderPayPalMessages(e,t){this.braintreeMessages.render(e,t,_.CART)}renderPayPalButton(e,t,i,n,r){const{style:o,shouldProcessPayment:a,onAuthorizeError:s,onEligibilityFailure:d}=t,{paypal:l}=this.braintreeHostWindow;let c=!1;l&&[l.FUNDING.PAYLATER,l.FUNDING.CREDIT].forEach(u=>{const h=u===l.FUNDING.CREDIT?Object.assign({label:D.CREDIT},J(o)):J(o);if(!c){const o=l.Buttons({env:r?\"sandbox\":\"production\",fundingSource:u,style:h,createOrder:()=>this.setupPayment(e,t,n),onApprove:t=>this.tokenizePayment(t,e,n,a,s)});o.isEligible()?(o.render(`#${i}`),c=!0):l.FUNDING.CREDIT&&d&&\"function\"==typeof d&&d()}}),l&&c||this.braintreeIntegrationService.removeElement(i)}setupPayment(e,t,i){var n;return ie(this,void 0,void 0,function*(){const{onPaymentError:r,shippingAddress:o,buyNowInitializeOptions:a}=t;try{const r=\"function\"==typeof(null==a?void 0:a.getBuyNowCartRequestBody)?yield this.createBuyNowCart(a.getBuyNowCartRequestBody()):void 0;this.buyNowCartId=null==r?void 0:r.id;const s=this.paymentIntegrationService.getState(),d=s.getCustomer(),l=s.getPaymentMethodOrThrow(i),c=r?r.cartAmount:s.getCartOrThrow().cartAmount,u=r?t.currencyCode:s.getCartOrThrow().currency.code,h=o||(null==d?void 0:d.addresses[0]),y=h?X(h):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:y,amount:c,currency:u,offerCredit:!0,intent:null===(n=l.initializationData)||void 0===n?void 0:n.intent})}catch(e){throw r&&(L(e)||e instanceof f)&&r(e),e}})}tokenizePayment(e,t,i,n,r){return ie(this,void 0,void 0,function*(){try{const{deviceData:r}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),o=yield t.tokenizePayment(e),{details:a,nonce:s}=o,d=this.braintreeIntegrationService.mapToLegacyBillingAddress(a),l=this.braintreeIntegrationService.mapToLegacyShippingAddress(a);return this.formPoster.postForm(\"/checkout.php\",Object.assign({payment_type:\"paypal\",provider:i,action:n?\"process_payment\":\"set_external_checkout\",nonce:s,device_data:r,billing_address:JSON.stringify(d),shipping_address:JSON.stringify(l)},this.buyNowCartId&&{cart_id:this.buyNowCartId})),o}catch(e){throw r&&(L(e)||e instanceof f)&&r(e),e}})}createBuyNowCart(e){return ie(this,void 0,void 0,function*(){if(!e)throw new G(H.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(e)}catch(e){throw new Y}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!L(e))throw e;i(e)}}const re=$(i=>{const n=window,r=new v(i),o=new j(new q((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),n,r),n),a=new te(i);return new ne(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),o,a,n)},[{id:\"braintreepaypalcredit\"}]);var oe,ae,se,de,le,ce,ue;!function(e){e.ESTIMATED=\"ESTIMATED\",e.FINAL=\"FINAL\",e.NOT_CURRENTLY_KNOWN=\"NOT_CURRENTLY_KNOWN\"}(oe||(oe={})),function(e){e.Completed=\"COMPLETED\",e.Pending=\"PENDING\",e.Failed=\"FAILED\"}(ae||(ae={})),function(e){e.TRUSTLY=\"trustly\"}(se||(se={})),function(e){e.SUCCEEDED=\"succeeded\",e.FAILED=\"failed\",e.CANCELED=\"cancelled\",e.UNRECOGNIZED=\"unrecognized\"}(de||(de={})),function(e){e.Customer=\"CUSTOMER\",e.Merchant=\"MERCHANT\",e.Network=\"NETWORK\",e.Internal=\"INTERNAL\",e.Unknown=\"UNKNOWN\"}(le||(le={})),function(e){e.KountNotEnabled=\"DATA_COLLECTOR_KOUNT_NOT_ENABLED\"}(ce||(ce={})),function(e){e.Visa=\"visa\",e.Mastercard=\"mastercard\",e.AmericanExpress=\"american-express\",e.DinersClub=\"diners-club\",e.Discover=\"discover\",e.Jcb=\"jcb\",e.UnionPay=\"union-pay\",e.Maestro=\"maestro\",e.Elo=\"elo\",e.Mir=\"mir\",e.Hiper=\"hiper\",e.Hipercard=\"hipercard\"}(ue||(ue={}));var he=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ye{constructor(e){this.braintreeScriptLoader=e}initialize(e){this.setClientToken(e)}deinitialize(){return he(this,void 0,void 0,function*(){yield this.teardownModule(this.dataCollector),this.dataCollector=void 0})}getClient(){return he(this,void 0,void 0,function*(){if(!this.client){const e=this.getClientTokenOrThrow(),t=yield this.braintreeScriptLoader.loadClient();this.client=yield t.create({authorization:e})}return this.client})}getDataCollectorOrThrow(e){return he(this,void 0,void 0,function*(){const t={deviceData:void 0,teardown:()=>Promise.resolve()};if(!this.dataCollector)try{const t=yield this.getClient(),i=yield this.braintreeScriptLoader.loadDataCollector(),n=Object.assign({client:t,kount:!0},e);this.dataCollector=yield i.create(n)}catch(e){if(L(e)&&e.code===ce.KountNotEnabled)return t;throw e}return this.dataCollector})}getBraintreeGooglePayment(){return he(this,void 0,void 0,function*(){if(!this.googlePayment){const[e,t]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.loadGooglePayment()]);this.googlePayment=yield t.create({client:e})}return this.googlePayment})}getBraintreeThreeDS(){return he(this,void 0,void 0,function*(){if(!this.threeDS){const[e,t]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.load3DS()]);this.threeDS=yield t.create({client:e,version:2})}return this.threeDS})}getBraintreeLocalPayment(e){return he(this,void 0,void 0,function*(){if(!this.braintreeLocalPayment){const[t,i]=yield Promise.all([this.getClient(),this.braintreeScriptLoader.loadLocalPayment()]);this.braintreeLocalPayment=yield new Promise((n,r)=>{i.create({client:t,merchantAccountId:e},(e,t)=>{e&&r(e),n(t)})})}return this.braintreeLocalPayment})}getUsBankAccount(){return he(this,void 0,void 0,function*(){if(!this.usBankAccount){const e=yield this.getClient(),t=yield this.braintreeScriptLoader.loadUsBankAccount();this.usBankAccount=yield t.create({client:e})}return this.usBankAccount})}getBraintreeVisaCheckout(){return this.visaCheckout||(this.visaCheckout=Promise.all([this.getClient(),this.braintreeScriptLoader.loadVisaCheckout()]).then(([e,t])=>t.create({client:e}))),this.visaCheckout}getVisaCheckoutSdk(e){return he(this,void 0,void 0,function*(){return this.visaCheckoutSDK||(this.visaCheckoutSDK=yield this.braintreeScriptLoader.loadVisaCheckoutSdk(e)),this.visaCheckoutSDK})}getVenmoCheckoutOrThrow(){return he(this,void 0,void 0,function*(){if(!this.braintreeVenmo){const e=yield this.getClient(),t=yield this.braintreeScriptLoader.loadVenmoCheckout(),i={client:e,allowDesktop:!0,paymentMethodUsage:\"multi_use\"},n=yield t.create(i);if(!n.isBrowserSupported())throw new b;this.braintreeVenmo=n}return this.braintreeVenmo})}setClientToken(e){this.clientToken=e}getClientTokenOrThrow(){if(!this.clientToken)throw new I(P.PaymentNotInitialized);return this.clientToken}teardownModule(e){return e?e.teardown():Promise.resolve()}}var me=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class pe{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i}initialize(e){return me(this,void 0,void 0,function*(){const{containerId:t,methodId:i}=e;if(!i)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new w('Unable to initialize payment because \"options.containerId\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(i);const n=this.paymentIntegrationService.getState(),{clientToken:r,initializationData:o,config:a}=n.getPaymentMethodOrThrow(i);if(!r||!o)throw new G(H.MissingPaymentMethod);this.braintreeSdk.initialize(r);const s=yield this.braintreeSdk.getBraintreeVisaCheckout(),{currency:{code:d},cartAmount:l}=n.getCartOrThrow(),c=yield this.braintreeSdk.getVisaCheckoutSdk(a.testMode),u=s.createInitOptions({paymentRequest:{currencyCode:d,subtotal:String(l)},settings:{shipping:{collectShipping:!0}}});this.createSignInButton(t),yield c.init(u),c.on(\"payment.success\",e=>me(this,void 0,void 0,function*(){yield this.paymentSuccess(s,e)}))})}deinitialize(){return Promise.resolve()}paymentSuccess(e,t){return me(this,void 0,void 0,function*(){return Promise.all([e.tokenize(t),this.braintreeSdk.getDataCollectorOrThrow()]).then(([e,t])=>{const i=this.paymentIntegrationService.getState(),n=i.getShippingAddress(),r=i.getBillingAddress(),{shippingAddress:o=this.toVisaCheckoutAddress(n),billingAddress:a=this.toVisaCheckoutAddress(r)}=e;return this.postForm(Object.assign(Object.assign({},e),{shippingAddress:o,billingAddress:a}),t)})})}postForm(e,t){const{userData:i,billingAddress:n,shippingAddress:r,details:o}=e,{userEmail:a}=i,{deviceData:s}=t;return this.formPoster.postForm(\"/checkout.php\",{payment_type:e.type,nonce:e.nonce,provider:\"braintreevisacheckout\",action:\"set_external_checkout\",device_data:s,card_information:JSON.stringify({type:o.cardType,number:o.lastTwo}),billing_address:JSON.stringify(this.getAddress(a,n)),shipping_address:JSON.stringify(this.getAddress(a,r))})}toVisaCheckoutAddress(e){return e?{firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phone,streetAddress:e.address1,extendedAddress:e.address2,locality:e.city,region:e.stateOrProvinceCode,countryCode:e.countryCode,postalCode:e.postalCode}:{}}getAddress(e,t={}){return{email:e,first_name:t.firstName,last_name:t.lastName,phone_number:t.phoneNumber,address_line_1:t.streetAddress,address_line_2:t.extendedAddress,city:t.locality,state:t.region,country_code:t.countryCode,postal_code:t.postalCode}}createSignInButton(e){const t=document.querySelector(`#${e}`);if(!t)throw new Error(\"Need a container to place the button\");return this.insertVisaCheckoutButton(t)}insertVisaCheckoutButton(e){const t=document.createElement(\"div\");return t.style.display=\"flex\",t.style.flexDirection=\"column\",t.style.alignItems=\"flex-end\",t.innerHTML='\\n            <img\\n                alt=\"Visa Checkout\"\\n                class=\"v-button\"\\n                role=\"button\"\\n                src=\"https://secure.checkout.visa.com/wallet-services-web/xo/button.png?acceptCanadianVisaDebit=false&cobrand=true&height=34&width=178\"\\n                />\\n            <a class=\"v-learn v-learn-default\" style=\"text-align: right; display: block; font-size: 10px; color: #003366;\" href=\"#\" data-locale=\"en_US\">Tell Me More</a>',e.appendChild(t),t}}const ge=$(i=>{const n=window,r=new v(i),o=new ye(new q((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),n,r));return new pe(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),o)},[{id:\"braintreevisacheckout\"}]);function ve(e){const{billingAddress:t,email:i,firstName:n,lastName:r,phone:o,shippingAddress:a}=e,s=t||a;return{email:i,first_name:n,last_name:r,phone_number:o,address_line_1:null==s?void 0:s.line1,address_line_2:null==s?void 0:s.line2,city:null==s?void 0:s.city,state:null==s?void 0:s.state,country_code:null==s?void 0:s.countryCode,postal_code:null==s?void 0:s.postalCode}}function fe(e){const{email:t,phone:i,shippingAddress:n}=e,r=(null==n?void 0:n.recipientName)||\"\",[o,a]=r.split(\" \");return{email:t,first_name:o||\"\",last_name:a||\"\",phone_number:i,address_line_1:null==n?void 0:n.line1,address_line_2:null==n?void 0:n.line2,city:null==n?void 0:n.city,state:null==n?void 0:n.state,country_code:null==n?void 0:n.countryCode,postal_code:null==n?void 0:n.postalCode}}function be(e){return\"object\"==typeof e&&null!==e&&\"name\"in e&&\"BraintreeError\"===e.name}var we=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};const Ce=e=>{const{color:t,height:i}=e;return{backgroundColor:(n=t||\"\",n===N.WHITE?\"#FFFFFF\":\"#3D95CE\"),backgroundPosition:\"50% 50%\",backgroundSize:\"80px auto\",backgroundImage:`url(\"/app/assets/img/payment-providers/venmo-logo-${t===N.WHITE?N.BLUE:N.WHITE}.svg\")`,backgroundRepeat:\"no-repeat\",borderRadius:\"4px\",cursor:\"pointer\",transition:\"0.2s ease\",minHeight:`${i||40}px`,minWidth:\"150px\",height:\"100%\",width:\"100%\",border:t===N.WHITE?\"1px solid black\":\"none\"};// removed by dead control flow\n var n; };class Se{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i,this.onError=lodash__WEBPACK_IMPORTED_MODULE_2__.noop}initialize(e){return we(this,void 0,void 0,function*(){const{braintreevenmo:t,containerId:i,methodId:n}=e;if(!n)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');const r=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(n),{clientToken:o,initializationData:a}=r,{paymentButtonStyles:s}=a,{cartButtonStyles:d}=s||{},l=(null==t?void 0:t.style)||d;if(!o||!a)throw new G(H.MissingPaymentMethod);if(!i)throw new w('Unable to initialize payment because \"options.containerId\" argument is not provided.');yield this.paymentIntegrationService.loadDefaultCheckout(),this.onError=(null==t?void 0:t.onError)||this.handleError,this.braintreeSdk.initialize(o);try{const e=yield this.braintreeSdk.getVenmoCheckoutOrThrow();this.renderVenmoButton(e,i,null==t?void 0:t.buyNowInitializeOptions,l)}catch(e){(be(e)||function(e){return e instanceof b}(e))&&this.handleInitializationVenmoError(e,i)}})}deinitialize(){return we(this,void 0,void 0,function*(){return yield this.braintreeSdk.deinitialize(),Promise.resolve()})}handleError(e){throw new Error(e.message)}createBuyNowCart(e){return we(this,void 0,void 0,function*(){if(\"function\"==typeof(null==e?void 0:e.getBuyNowCartRequestBody)){const t=null==e?void 0:e.getBuyNowCartRequestBody();if(!t)throw new G(H.MissingCart);try{return yield this.paymentIntegrationService.createBuyNowCart(t)}catch(e){throw new Y}}})}handleInitializationVenmoError(e,t){return this.removeVenmoContainer(t),this.onError(e)}removeVenmoContainer(e){const t=document.getElementById(e);t&&t.remove()}renderVenmoButton(e,t,i,n){const r=document.getElementById(t),{color:o}=n||{};if(!r)throw new w(\"Unable to create wallet button without valid container ID.\");r.setAttribute(\"aria-label\",\"Venmo\"),Object.assign(r.style,Ce(n||{})),r.addEventListener(\"click\",()=>we(this,void 0,void 0,function*(){r.setAttribute(\"disabled\",\"true\");const t=yield this.createBuyNowCart(i);e.tokenize&&e.tokenize((e,i)=>we(this,void 0,void 0,function*(){r.removeAttribute(\"disabled\"),e&&this.onError(e),yield this.handlePostForm(i,null==t?void 0:t.id)}))})),o===N.BLUE&&(r.addEventListener(\"mouseenter\",()=>{r.style.backgroundColor=\"#0a7fc2\"}),r.addEventListener(\"mouseleave\",()=>{r.style.backgroundColor=Ce(n||{}).backgroundColor}))}handlePostForm(e,t){return we(this,void 0,void 0,function*(){const{deviceData:i}=yield this.braintreeSdk.getDataCollectorOrThrow(),{nonce:n,details:r}=e;this.formPoster.postForm(\"/checkout.php\",Object.assign({nonce:n,provider:\"braintreevenmo\",payment_type:\"paypal\",device_data:i,action:\"set_external_checkout\",billing_address:JSON.stringify(ve(r)),shipping_address:JSON.stringify(fe(r))},t&&{cart_id:t}))})}}const Pe=$(i=>{const n=window,r=(0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),o=new v(i),a=new q(r,n,o),s=new ye(a);return new Se(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),s)},[{id:\"braintreevenmo\"}]);function Ie(e){return Boolean(e.instrumentId)}class Oe extends f{constructor(){super(\"The current order does not need to be finalized at this stage.\"),this.name=\"OrderFinalizationNotRequiredError\",this.type=\"order_finalization_not_required\"}}function ke(e){return!(\"object\"!=typeof e||null===e||void 0!==e.shouldSaveInstrument&&\"boolean\"!=typeof e.shouldSaveInstrument||void 0!==e.shouldSetAsDefaultInstrument&&\"boolean\"!=typeof e.shouldSetAsDefaultInstrument)}class Ee extends f{constructor(e){super(e||\"Unable to proceed because the client library of a payment method has thrown an unexpected error.\"),this.name=\"PaymentMethodFailedError\",this.type=\"payment_method_client_invalid\"}}function Te(e){return!!e&&\"accountNumber\"in e&&\"routingNumber\"in e&&\"ownershipType\"in e&&\"accountType\"in e}var Ae=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ze{constructor(e,t){this.paymentIntegrationService=e,this.braintreeSdk=t}initialize(e){return Ae(this,void 0,void 0,function*(){const{methodId:t,braintreeach:i}=e||{};if(!t)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');this.getMandateText=null==i?void 0:i.getMandateText,yield this.paymentIntegrationService.loadPaymentMethod(t);const n=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t),{clientToken:r,initializationData:o}=n;if(!r||!o)throw new G(H.MissingPaymentMethod);this.braintreeSdk.initialize(r);try{this.usBankAccount=yield this.braintreeSdk.getUsBankAccount()}catch(e){this.handleBraintreeError(e)}})}execute(e,t){return Ae(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!i)throw new C([\"payment\"]);const r=Ie(i.paymentData||{}),o=r?yield this.tokenizePaymentForVaultedInstrument(i):yield this.tokenizePayment(i),a=r?yield this.preparePaymentDataForVaultedInstrument(o,i):yield this.preparePaymentData(o,i);yield this.paymentIntegrationService.submitOrder(n,t),yield this.paymentIntegrationService.submitPayment(a)})}finalize(){return Promise.reject(new Oe)}deinitialize(){return Ae(this,void 0,void 0,function*(){return yield this.braintreeSdk.deinitialize(),Promise.resolve()})}tokenizePayment({paymentData:e}){return Ae(this,void 0,void 0,function*(){const t=this.getUsBankAccountOrThrow();if(!Te(e))throw new C([\"payment.paymentData\"]);const i=Ie(e)?\"The data are used for stored instrument verification\":\"function\"==typeof this.getMandateText&&this.getMandateText();if(!i)throw new w(\"Unable to proceed because getMandateText is not provided or returned undefined value.\");try{const{nonce:n}=yield t.tokenize({bankDetails:this.getBankDetails(e),mandateText:i});return n}catch(e){this.handleBraintreeError(e)}})}tokenizePaymentForVaultedInstrument(e){return Ae(this,void 0,void 0,function*(){const{methodId:t,paymentData:i={}}=e,n=this.paymentIntegrationService.getState(),{config:r}=n.getPaymentMethodOrThrow(t);if(!r.isVaultingEnabled)throw new w(\"Vaulting is disabled but a vaulted instrument was being used for this transaction\");return Te(i)?this.tokenizePayment(e):null})}preparePaymentData(e,t){return Ae(this,void 0,void 0,function*(){const{methodId:i,paymentData:n={}}=t;if(!Te(n))throw new C([\"payment.paymentData\"]);const{deviceData:r}=yield this.braintreeSdk.getDataCollectorOrThrow(),{shouldSaveInstrument:o,shouldSetAsDefaultInstrument:a,routingNumber:s,accountNumber:d}=n;return{methodId:i,paymentData:{deviceSessionId:r,shouldSetAsDefaultInstrument:a,shouldSaveInstrument:o,formattedPayload:{tokenized_bank_account:{issuer:s,masked_account_number:d.substr(-4),token:e}}}}})}preparePaymentDataForVaultedInstrument(e,t){return Ae(this,void 0,void 0,function*(){const{methodId:i,paymentData:n={}}=t;if(!Ie(n)||!ke(n))throw new C([\"payment.paymentData\"]);const{deviceData:r}=yield this.braintreeSdk.getDataCollectorOrThrow(),{instrumentId:o,shouldSetAsDefaultInstrument:a}=n;return{methodId:i,paymentData:Object.assign({deviceSessionId:r,instrumentId:o,shouldSetAsDefaultInstrument:a},e&&{nonce:e})}})}getBankDetails(e){const t=this.paymentIntegrationService.getState().getBillingAddressOrThrow(),i=e.ownershipType.toLowerCase(),n=e.accountType.toLowerCase();return Object.assign(Object.assign({accountNumber:e.accountNumber,routingNumber:e.routingNumber,ownershipType:i},\"personal\"===i?{firstName:e.firstName,lastName:e.lastName}:{businessName:e.businessName}),{accountType:n,billingAddress:{streetAddress:t.address1,extendedAddress:t.address2,locality:t.city,region:t.stateOrProvinceCode,postalCode:t.postalCode}})}getUsBankAccountOrThrow(){if(!this.usBankAccount)throw new I(P.PaymentNotInitialized);return this.usBankAccount}handleBraintreeError(e){if(!L(e))throw e;throw new Ee(e.message)}}const Ne=$(e=>new ze(e,(e=>{const i=new v(e),n=new q((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),window,i);return new ye(n)})(e)),[{id:\"braintreeach\"}]);class De{constructor(e){const{element:t,closeElement:i,mainElement:n}=this._createElements(e);this._element=t,this._closeElement=i,this._mainElement=n}show(e){this._mainElement.parentElement||(this._registerClick(e),document.body.appendChild(this._mainElement),setTimeout(()=>this._element.style.opacity=\"1\"))}remove(){this._mainElement.parentElement&&(this._unregisterClick&&this._unregisterClick(),this._removeAfterTransition(),setTimeout(()=>this._element.style.opacity=\"0\"))}_createElements(e){const t=document.createElement(\"div\"),{background:i=\"rgba(0, 0, 0, 0.8)\",id:n=\"checkoutOverlay\",transitionDuration:r=400,hasCloseButton:o=!1,innerHtml:a=null}=e||{};let s,d,l,c,u=t;if(n&&(t.id=n),a){const e=document.createElement(\"div\");c=`${n}--overlayText`,e.className=c,e.appendChild(a),t.appendChild(e)}return o&&(l=`${n}--close`,s=document.createElement(\"div\"),s.className=l,d=`${n}--layout`,u=document.createElement(\"div\"),u.className=d,u.appendChild(t),u.appendChild(s)),u.appendChild(function(e){const{id:t,background:i,transitionDuration:n,classLayout:r,classOverlayText:o,classClose:a}=e,s=document.createElement(\"style\"),d=r?`, .${r}`:\"\";return s.id=`${t}--styles`,s.type=\"text/css\",s.innerText=`\\n        #${t}${d} {\\n            display: block;\\n            height: 100%;\\n            width: 100%;\\n            left: 0;\\n            top: 0;\\n            position: fixed;\\n            z-index: 2147483647;\\n        }\\n        #${t} {\\n            transition: opacity ${n}ms ease-out;\\n            background: ${i};\\n            opacity: 0;\\n        }\\n    `,o&&(s.innerText+=`\\n             #${t} {\\n                display: flex;\\n                align-items: center;\\n                justify-content: center;\\n             }\\n             #${t} .${o} {\\n                color: white;\\n                max-width: 330px;\\n                font-size: 1.2em;\\n                text-align: center;\\n             }\\n        `),a&&(s.innerText+=`\\n            #${t} {\\n                opacity: 1;\\n            }\\n            .${r} .${a} {\\n                position: fixed;\\n                right: 16px;\\n                top: 16px;\\n                width: 16px;\\n                height: 16px;\\n                opacity: 0.6;\\n                cursor: pointer;\\n                z-index: 3147483647;\\n            }\\n            .${r} .${a}::after, .${r} .${a}::before {\\n                position: absolute;\\n                left: 8px;\\n                content: '';\\n                height: 16px;\\n                width: 2px;\\n                background-color: #fff;\\n            }\\n            .${r} .${a}::after {\\n                transform: rotate(-45deg);\\n            }\\n            .${r} .${a}::before {\\n                transform: rotate(45deg);\\n            }\\n        `),s}({id:n,background:i,transitionDuration:r,classLayout:d,classOverlayText:c,classClose:l})),{element:t,closeElement:s,mainElement:u}}_addEventListener(e,t){e&&t&&e.addEventListener(\"click\",t)}_removeEventListener(e,t){e&&t&&e.removeEventListener(\"click\",t)}_registerClick(e){if(this._unregisterClick&&this._unregisterClick(),e){const{onClick:t,onClickClose:i}=e;this._addEventListener(this._element,t),this._addEventListener(this._closeElement,i),this._unregisterClick=()=>{this._removeEventListener(this._element,t),this._removeEventListener(this._closeElement,i),this._unregisterClick=void 0}}}_removeAfterTransition(){const e=t=>{\"opacity\"===t.propertyName&&(this._mainElement.parentElement&&this._mainElement.remove(),this._element.removeEventListener(\"transitionend\",e))};this._element.addEventListener(\"transitionend\",e)}}const Me={size:70,color:\"#d9d9d9\",backgroundColor:\"#ffffff\"},_e=\"embedded-checkout-loading-indicator-rotation\";class Be{constructor(e){this.styles=Object.assign(Object.assign({},Me),e&&e.styles),this.containerStyles=Object.assign({},e&&e.containerStyles),this.defineAnimation(),this.container=this.buildContainer(),this.indicator=this.buildIndicator(),this.container.appendChild(this.indicator)}show(e){if(e){const t=document.getElementById(e);if(!t)throw new Error(\"Unable to attach the loading indicator because the parent ID is not valid.\");t.appendChild(this.container)}this.container.style.visibility=\"visible\",this.container.style.opacity=\"1\"}hide(){const e=()=>{this.container.style.visibility=\"hidden\",this.container.removeEventListener(\"transitionend\",e)};this.container.addEventListener(\"transitionend\",e),this.container.style.opacity=\"0\"}buildContainer(){const e=document.createElement(\"div\");return e.style.display=\"block\",e.style.bottom=\"0\",e.style.left=\"0\",e.style.height=\"100%\",e.style.width=\"100%\",e.style.position=\"absolute\",e.style.right=\"0\",e.style.top=\"0\",e.style.transition=\"all 250ms ease-out\",e.style.opacity=\"0\",this.setStyleAttribute(e,this.containerStyles),e}buildIndicator(){const e=document.createElement(\"div\");return e.style.display=\"block\",e.style.width=`${this.styles.size}px`,e.style.height=`${this.styles.size}px`,e.style.borderRadius=`${this.styles.size}px`,e.style.border=\"solid 1px\",e.style.borderColor=`${this.styles.backgroundColor} ${this.styles.backgroundColor} ${this.styles.color} ${this.styles.color}`,e.style.margin=\"0 auto\",e.style.position=\"absolute\",e.style.left=\"0\",e.style.right=\"0\",e.style.top=\"50%\",e.style.transform=\"translateY(-50%) rotate(0deg)\",e.style.transformStyle=\"preserve-3d\",e.style.animation=`${_e} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`,e}setStyleAttribute(e,t){Object.keys(t).forEach(i=>{e.style.setProperty(i,t[i])})}defineAnimation(){var e;if(document.getElementById(_e))return;const t=document.createElement(\"style\");t.id=_e,null===(e=document.head)||void 0===e||e.appendChild(t),t.sheet instanceof CSSStyleSheet&&t.sheet.insertRule(`\\n                @keyframes ${_e} {\\n                    0% { transform: translateY(-50%) rotate(0deg); }\\n                    100% { transform: translateY(-50%) rotate(360deg); }\\n                }\\n            `,0)}}const xe={\"background-color\":\"rgba(0, 0, 0, 0.4)\",\"z-index\":\"1000\"};var Fe=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Le{constructor(e,t,i,n){this.paymentIntegrationService=e,this.braintreeIntegrationService=t,this.braintreeMessages=i,this.loadingIndicator=n,this.braintreeHostWindow=window}initialize(e){return Fe(this,void 0,void 0,function*(){const{braintree:t,methodId:i}=e;if(this.braintree=t,this.paymentMethod&&this.paymentMethod.nonce||(this.paymentMethod=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(i)),this.paymentMethod.clientToken&&(null==t?void 0:t.bannerContainerId))return yield this.loadPaypal(),this.loadPaypalCheckoutInstance();if(this.paymentMethod.clientToken)return this.loadPaypal();const n=yield this.paymentIntegrationService.loadPaymentMethod(i);if(this.paymentMethod=n.getPaymentMethodOrThrow(i),null==t?void 0:t.bannerContainerId)return this.loadPaypalCheckoutInstance();if(!this.paymentMethod.clientToken)throw new G(H.MissingPaymentMethod);return this.loadPaypal()})}execute(e,t){var i;return Fe(this,void 0,void 0,function*(){const{payment:n}=e,r=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]),{onError:o}=this.braintree||{};if(!n)throw new C([\"payment\"]);try{const e=yield this.preparePaymentData(n,r.useStoreCredit);yield this.paymentIntegrationService.submitOrder(r,t),yield this.paymentIntegrationService.submitPayment(e)}catch(e){this.isProviderError(e)&&(yield this.loadPaypal(),null===(i=this.paypalButtonRender)||void 0===i||i.close(),yield this.loadPaypalCheckoutInstance(),yield new Promise((e,t)=>{o&&\"function\"==typeof o&&o(new Error(\"INSTRUMENT_DECLINED\")),t()})),this.handleError(e)}})}finalize(){return Promise.reject(new Oe)}deinitialize(){var e;return this.braintreeTokenizePayload=void 0,null===(e=this.paypalButtonRender)||void 0===e||e.close(),this.braintreeIntegrationService.teardown()}preparePaymentData(e,t){var i;return Fe(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState(),r=n.getOutstandingBalance(t),o=n.getStoreConfig();if(!r)throw new G(H.MissingCheckout);if(!o)throw new G(H.MissingCheckoutConfig);if(!this.paymentMethod)throw new I(P.PaymentNotInitialized);const{currency:a,storeProfile:{storeLanguage:s}}=o,{nonce:d,config:{isVaultingEnabled:l}}=this.paymentMethod,{methodId:c,paymentData:u={}}=e,h=(null===(i=this.braintreeTokenizePayload)||void 0===i?void 0:i.nonce)||d;if(h){const t=yield this.paymentIntegrationService.loadPaymentMethod(c);return this.paymentMethod=t.getPaymentMethod(c),Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(h)})}if(Ie(u)||(y=u,Boolean(y.instrumentId)&&!Object.prototype.hasOwnProperty.call(y,\"ccNumber\")&&!Object.prototype.hasOwnProperty.call(y,\"ccCvv\"))){if(!l)throw new w(\"Vaulting is disabled but a vaulted instrument was being used for this transaction\");return Promise.resolve(e)}var y;if(!ke(u))throw new G(H.MissingPayment);const{shouldSaveInstrument:m,shouldSetAsDefaultInstrument:p}=u;if(m&&!l)throw new w(\"Vaulting is disabled but shouldSaveInstrument is set to true\");const g=n.getShippingAddress(),v=g?X(g):void 0;return Promise.all([this.braintreeIntegrationService.paypal({amount:r,locale:s,currency:a.code,offerCredit:\"braintreepaypalcredit\"===this.paymentMethod.id,shippingAddressOverride:v,shouldSaveInstrument:m||!1,shippingAddressEditable:!1}),this.braintreeIntegrationService.getSessionId()]).then(([{nonce:t,details:i}={},n])=>Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(t,i&&i.email,n,m,p)}))})}formattedPayload(e,t,i,n,r){return{formattedPayload:{vault_payment_instrument:n||null,set_as_default_stored_instrument:r||null,device_info:i||null,paypal_account:{token:e,email:t||null}}}}loadPaypalCheckoutInstance(){return Fe(this,void 0,void 0,function*(){const{clientToken:e,initializationData:t,id:i}=this.paymentMethod||{};if(!e)throw new G(H.MissingPaymentMethod);try{this.braintreeIntegrationService.initialize(e);const n={currency:this.paymentIntegrationService.getState().getCartOrThrow().currency.code,intent:null==t?void 0:t.intent,isCreditEnabled:null==t?void 0:t.isCreditEnabled},r=\"braintreepaypalcredit\"===i||!(null==t?void 0:t.isCreditEnabled);yield this.braintreeIntegrationService.getPaypalCheckout(n,e=>{var t;r&&i&&(null===(t=this.braintree)||void 0===t?void 0:t.bannerContainerId)&&this.renderPayPalMessages(i,this.braintree.bannerContainerId),this.renderPayPalButton(e)},this.handleError)}catch(e){this.handleError(e)}})}renderPayPalMessages(e,t){this.braintreeMessages.render(e,t,_.PAYMENT)}renderPayPalButton(e){const{onPaymentError:t,submitForm:i,onRenderButton:n,containerId:r,onError:o}=this.braintree||{};if(!r)return;if(!this.paymentMethod)throw new I(P.PaymentNotInitialized);this.loadingIndicatorContainer=r.split(\"#\")[1];const{id:a,config:{testMode:s}}=this.paymentMethod,{paypal:d}=this.braintreeHostWindow,l=null==d?void 0:d.FUNDING.PAYPAL;d&&l?(this.paypalButtonRender=d.Buttons({env:s?\"sandbox\":\"production\",commit:!1,fundingSource:l,onClick:()=>{this.toggleLoadingIndicator(!0)},createOrder:()=>this.setupPayment(e,a,t),onApprove:t=>Fe(this,void 0,void 0,function*(){this.braintreeTokenizePayload=yield this.tokenizePaymentOrThrow(t,e),i&&\"function\"==typeof i&&i()}),onCancel:()=>{this.toggleLoadingIndicator(!1)},onError:e=>{this.toggleLoadingIndicator(!1),null==o||o(e)}}),n&&\"function\"==typeof n&&n(),this.paypalButtonRender.isEligible()&&this.paypalButtonRender.render(`${r}`)):this.removeElement(r.split(\"#\")[1])}setupPayment(e,t,i){return Fe(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState();try{const i=n.getCustomer(),r=n.getPaymentMethodOrThrow(t),o=n.getCheckoutOrThrow().outstandingBalance,a=n.getStoreConfigOrThrow().currency.code,s=n.getShippingAddress()||(null==i?void 0:i.addresses[0]),d=s?X(s):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:d,amount:o,currency:a,offerCredit:!1,intent:r.initializationData.intent})}catch(e){throw i&&(be(e)||e instanceof f)&&i(e),e}})}tokenizePaymentOrThrow(e,t,i){return Fe(this,void 0,void 0,function*(){try{return yield t.tokenizePayment(e)}catch(e){throw i&&(be(e)||e instanceof f)&&i(e),e}})}loadPaypal(){return Fe(this,void 0,void 0,function*(){const{clientToken:e,initializationData:t}=this.paymentMethod||{};if(!e||!t)throw new G(H.MissingPaymentMethod);try{this.braintreeIntegrationService.initialize(e),yield this.braintreeIntegrationService.getPaypal()}catch(e){this.handleError(e)}return Promise.resolve()})}handleError(e){if(!be(e))throw e;if(\"PAYPAL_POPUP_CLOSED\"===e.code)throw new O(e.message);throw new Ee(e.message)}isProviderError(e){var t,i,n;return!!function(e){return\"object\"==typeof e&&null!==e&&\"errors\"in e}(e)&&\"2046\"===(null===(n=null===(i=((null===(t=null==e?void 0:e.errors)||void 0===t?void 0:t.filter(e=>e.provider_error))||[])[0])||void 0===i?void 0:i.provider_error)||void 0===n?void 0:n.code)}removeElement(e){const t=e&&document.getElementById(e);t&&t.remove()}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}}const Ve=$(e=>{const i=window,n=new De,r=new v(e),o=new j(new q((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),i,r),i,n),a=new te(e);return new Le(e,o,a,new Be({containerStyles:xe}))},[{id:\"braintreepaypal\"},{id:\"braintreepaypalcredit\"}]);var je;!function(e){e.Json=\"application/json\",e.JsonV1=\"application/vnd.bc.v1+json\"}(je||(je={}));const Ue=je,Re={\"X-Checkout-SDK-Version\":\"1.867.0\"};class He{constructor(e){this.requestSender=e}getOrderStatus(e=\"braintreelocalmethods\",t){return i=this,n=void 0,o=function*(){const i=`/api/storefront/initialization/${e}`,n=Object.assign({\"X-API-INTERNAL\":\"This API endpoint is for internal use only and may change in the future\",\"Content-Type\":Ue.Json},Re);return(yield this.requestSender.get(i,Object.assign({headers:n},t))).body},new((r=void 0)||(r=Promise))(function(e,t){function a(e){try{d(o.next(e))}catch(e){t(e)}}function s(e){try{d(o.throw(e))}catch(e){t(e)}}function d(t){var i;t.done?e(t.value):(i=t.value,i instanceof r?i:new r(function(e){e(i)})).then(a,s)}d((o=o.apply(i,n||[])).next())});// removed by dead control flow\n var i, n, r, o; }}const We={body:{},headers:{},status:0};class qe extends f{constructor(e,{message:t,errors:i}={}){const{body:n,headers:r,status:o}=e||We;super(t||\"An unexpected error has occurred.\"),this.name=\"RequestError\",this.type=\"request\",this.body=n,this.headers=r,this.status=o,this.errors=i||[]}}class $e extends qe{constructor(e){super(e,{message:\"There is a problem processing your payment. Please try again later.\"}),this.name=\"PaymentMethodInvalidError\",this.type=\"payment_method_invalid\"}}class Ge extends qe{constructor(e){super(e,{message:\"The request has timed out or aborted.\"}),this.name=\"TimeoutError\",this.type=\"timeout\"}}var Ye=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Je{constructor(e,t,i,n,r=3e3,o=3e5){this.paymentIntegrationService=e,this.braintreeSdk=t,this.braintreeRequestSender=i,this.loadingIndicator=n,this.pollingInterval=r,this.maxPollingIntervalTime=o,this.isLPMsUpdateExperimentEnabled=!1,this.pollingTimer=0,this.stopPolling=lodash__WEBPACK_IMPORTED_MODULE_2__.noop,this.isPollingEnabled=!1}initialize(e){return Ye(this,void 0,void 0,function*(){const{gatewayId:t,methodId:i,braintreelocalmethods:n}=e;if(this.gatewayId=t,!i)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new w('Unable to initialize payment because \"options.gatewayId\" argument is not provided.');if(!n)throw new w('Unable to initialize payment because \"options.braintreelocalmethods\" argument is not provided.');this.braintreelocalmethods=n,this.loadingIndicatorContainer=n.container.split(\"#\")[1],yield this.paymentIntegrationService.loadPaymentMethod(t);const r=this.paymentIntegrationService.getState(),o=r.getPaymentMethodOrThrow(t),{clientToken:a,config:s,initializationData:d}=o,l=r.getStoreConfigOrThrow().checkoutSettings.features;if(this.isPollingEnabled=y(l,\"PAYPAL-5258.braintree_local_methods_polling\"),this.isLPMsUpdateExperimentEnabled=y(l,\"PAYPAL-4853.add_new_payment_flow_for_braintree_lpms\"),!a||!d||!s.merchantId)throw new G(H.MissingPaymentMethod);try{this.braintreeSdk.initialize(a),this.isNonInstantPaymentMethod(i)||(this.braintreeLocalPayment=yield this.braintreeSdk.getBraintreeLocalPayment(s.merchantId))}catch(e){this.handleError(e)}})}finalize(){return Promise.reject(new Oe)}deinitialize(){return Ye(this,void 0,void 0,function*(){return this.toggleLoadingIndicator(!1),Promise.resolve()})}execute(e,t){return Ye(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!i)throw new C([\"payment\"]);const{methodId:r}=i;this.toggleLoadingIndicator(!0),this.isNonInstantPaymentMethod(r)?yield this.executeWithNotInstantLPM(r):yield this.executeWithInstantLPM(r,n,t)})}executeWithNotInstantLPM(e){return Ye(this,void 0,void 0,function*(){try{const t=yield this.getLPMsBasicPaymentData();yield this.paymentIntegrationService.submitOrder(),yield this.paymentIntegrationService.submitPayment({methodId:e,paymentData:Object.assign(Object.assign({},t),{formattedPayload:{method:e}})})}catch(e){if(this.isBraintreeRedirectError(e)){const t=e.body.additional_action_required.data.redirect_url;return new Promise((e,i)=>{window.location.replace(t),this.toggleLoadingIndicator(!1),i()})}return this.handleError(e),Promise.reject(e)}})}executeWithInstantLPM(e,t,i){return Ye(this,void 0,void 0,function*(){if(!this.braintreeLocalPayment)throw new $e;yield new Promise((n,r)=>{var o;null===(o=this.braintreeLocalPayment)||void 0===o||o.startPayment(this.getInstantLPMConfig(e,t,i),this.getInstantLPMCallback(n,r,e,t,i))})})}getLPMsBasicPaymentData(){return Ye(this,void 0,void 0,function*(){const{deviceData:e}=yield this.braintreeSdk.getDataCollectorOrThrow();return{deviceSessionId:e}})}getInstantLPMConfig(e,t,i){const n=this.paymentIntegrationService.getState(),r=n.getCartOrThrow(),o=n.getBillingAddressOrThrow(),{firstName:a,lastName:s,countryCode:d}=o,{currency:l,email:c,lineItems:u}=r,h=u.physicalItems.length>0,y=n.getCheckoutOrThrow().outstandingBalance,m=n.getStoreConfigOrThrow().links.checkoutLink;return{paymentType:e,amount:y,fallback:{url:m,buttonText:\"Complete Payment\"},currencyCode:l.code,shippingAddressRequired:h,email:c,givenName:a,surname:s,address:{countryCode:d},onPaymentStart:(n,r)=>Ye(this,void 0,void 0,function*(){if(!this.isLPMsUpdateExperimentEnabled)return this.orderId=n.paymentId,void r();const o=yield this.getLPMsBasicPaymentData(),a=Object.assign(Object.assign({},o),{formattedPayload:{method:e,[`${e}_account`]:{order_id:n.paymentId}}});try{yield this.paymentIntegrationService.submitOrder(t,i),yield this.paymentIntegrationService.submitPayment({methodId:e,paymentData:a})}catch(t){if(this.isBraintreeOrderSavedResponse(t)&&t.body.additional_action_required.data.order_id_saved_successfully)return r(),this.isPollingEnabled?new Promise((t,i)=>{this.initializePollingMechanism(e,t,i,this.gatewayId)}):void 0;throw t}})}}getInstantLPMCallback(e,t,i,n,r){const o=this.paymentIntegrationService.getState().getCartOrThrow();return(a,s)=>Ye(this,void 0,void 0,function*(){if(a)return\"LOCAL_PAYMENT_WINDOW_CLOSED\"===a.code?(this.toggleLoadingIndicator(!1),this.resetPollingMechanism(),t()):(this.isPollingEnabled&&this.resetPollingMechanism(),this.toggleLoadingIndicator(!1),t(new $e));const d=yield this.getLPMsBasicPaymentData(),l=Object.assign(Object.assign({},d),{formattedPayload:{method:i,[`${i}_account`]:Object.assign({email:o.email,token:s.nonce},this.isLPMsUpdateExperimentEnabled?{}:{order_id:this.orderId})}});try{return this.isLPMsUpdateExperimentEnabled||(yield this.paymentIntegrationService.submitOrder(n,r)),yield this.paymentIntegrationService.submitPayment({methodId:i,paymentData:l}),e(void 0)}catch(e){return this.handleError(e),t(e)}})}toggleLoadingIndicator(e){e&&this.loadingIndicatorContainer?this.loadingIndicator.show(this.loadingIndicatorContainer):this.loadingIndicator.hide()}handleError(e){const{onError:t}=this.braintreelocalmethods||{};this.isPollingEnabled&&this.resetPollingMechanism(),this.toggleLoadingIndicator(!1),t&&\"function\"==typeof t&&t(e)}isNonInstantPaymentMethod(e){return e.toUpperCase()in se}isBraintreeRedirectError(e){var t;if(\"object\"!=typeof e||null===e)return!1;const{body:i}=e;return!!i&&!!(null===(t=i.additional_action_required)||void 0===t?void 0:t.data.redirect_url)}isBraintreeOrderSavedResponse(e){var t;if(\"object\"!=typeof e||null===e)return!1;const{body:i}=e;return!!i&&(null===(t=i.additional_action_required)||void 0===t?void 0:t.data.hasOwnProperty(\"order_id_saved_successfully\"))}initializePollingMechanism(e,t,i,n){return Ye(this,void 0,void 0,function*(){yield new Promise((e,t)=>{const i=setTimeout(e,this.pollingInterval);this.stopPolling=()=>(clearTimeout(i),this.toggleLoadingIndicator(!1),t())});try{this.pollingTimer+=this.pollingInterval;const r=yield this.braintreeRequestSender.getOrderStatus(n,{params:{useMetadata:!1}}),o=r.status===ae.Pending,a=r.status===ae.Completed,s=r.status===ae.Failed;if(a)return this.deinitializePollingMechanism(),t();if(s)return i();if(!a&&o&&this.pollingTimer<this.maxPollingIntervalTime)return yield this.initializePollingMechanism(e,t,i,n);yield this.reinitializeStrategy({methodId:e,gatewayId:n,braintreelocalmethods:this.braintreelocalmethods}),this.handleError(new Ge)}catch(e){i()}})}deinitializePollingMechanism(){this.stopPolling(),this.pollingTimer=0}resetPollingMechanism(){this.deinitializePollingMechanism()}reinitializeStrategy(e){return Ye(this,void 0,void 0,function*(){yield this.deinitialize(),yield this.initialize(e)})}}const Ke=$(e=>{const i=window,n=new v(e),r=new ye(new q((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),i,n)),o=(0,_bigcommerce_request_sender__WEBPACK_IMPORTED_MODULE_4__.createRequestSender)(),a=new He(o);return new Je(e,r,a,new Be({styles:{backgroundColor:\"black\"}}))},[{gateway:\"braintreelocalmethods\"}]);function Xe(e){return\"string\"!=typeof e}function Qe(e,t){if(t||e)return function(e){var t,i;const n={},r=(0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)(e.root,Xe),o=(0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)(e.input,Xe),a=(0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)(e.toggle,Xe),s=(0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)(null===(t=e.text)||void 0===t?void 0:t.body,Xe),l=(0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)(null===(i=e.text)||void 0===i?void 0:i.caption,Xe),c=e.branding;return Object.keys(r).length&&(n.root=r),Object.keys(o).length&&(n.input=o),Object.keys(a).length&&(n.toggle=a),Object.keys(s).length&&(n.text={},n.text.body=s),Object.keys(l).length&&(n.text=Object.assign({},n.text),n.text.caption=l),c&&(n.branding=c),n}(function(e,t){var i,n,r,o,a,s,d,l,c,u,h,y,m,p,g,v,f,b,w,C,S,P;return{root:{backgroundColorPrimary:(null==e?void 0:e.fastlaneRootSettingsBackgroundColor)||(null===(i=null==t?void 0:t.root)||void 0===i?void 0:i.backgroundColorPrimary),errorColor:(null==e?void 0:e.fastlaneRootSettingsErrorColor)||(null===(n=null==t?void 0:t.root)||void 0===n?void 0:n.errorColor),fontFamily:(null==e?void 0:e.fastlaneRootSettingsFontFamily)||(null===(r=null==t?void 0:t.root)||void 0===r?void 0:r.fontFamily),fontSizeBase:(null==e?void 0:e.fastlaneRootSettingsFontSize)||(null===(o=null==t?void 0:t.root)||void 0===o?void 0:o.fontSizeBase),padding:(null==e?void 0:e.fastlaneRootSettingsPadding)||(null===(a=null==t?void 0:t.root)||void 0===a?void 0:a.padding),primaryColor:(null==e?void 0:e.fastlaneRootSettingsPrimaryColor)||(null===(s=null==t?void 0:t.root)||void 0===s?void 0:s.primaryColor)},input:{borderRadius:(null==e?void 0:e.fastlaneInputSettingsBorderRadius)||(null===(d=null==t?void 0:t.input)||void 0===d?void 0:d.borderRadius),borderColor:(null==e?void 0:e.fastlaneInputSettingsBorderColor)||(null===(l=null==t?void 0:t.input)||void 0===l?void 0:l.borderColor),focusBorderColor:(null==e?void 0:e.fastlaneInputSettingsFocusBorderBase)||(null===(c=null==t?void 0:t.input)||void 0===c?void 0:c.focusBorderColor),backgroundColor:(null==e?void 0:e.fastlaneInputSettingsBackgroundColor)||(null===(u=null==t?void 0:t.input)||void 0===u?void 0:u.backgroundColor),borderWidth:(null==e?void 0:e.fastlaneInputSettingsBorderWidth)||(null===(h=null==t?void 0:t.input)||void 0===h?void 0:h.borderWidth),textColorBase:(null==e?void 0:e.fastlaneInputSettingsTextColorBase)||(null===(y=null==t?void 0:t.input)||void 0===y?void 0:y.textColorBase)},toggle:{colorPrimary:(null==e?void 0:e.fastlaneToggleSettingsColorPrimary)||(null===(m=null==t?void 0:t.toggle)||void 0===m?void 0:m.colorPrimary),colorSecondary:(null==e?void 0:e.fastlaneToggleSettingsColorSecondary)||(null===(p=null==t?void 0:t.toggle)||void 0===p?void 0:p.colorSecondary)},text:{body:{color:(null==e?void 0:e.fastlaneTextBodySettingsColor)||(null===(v=null===(g=null==t?void 0:t.text)||void 0===g?void 0:g.body)||void 0===v?void 0:v.color),fontSize:(null==e?void 0:e.fastlaneTextBodySettingsFontSize)||(null===(b=null===(f=null==t?void 0:t.text)||void 0===f?void 0:f.body)||void 0===b?void 0:b.fontSize)},caption:{color:(null==e?void 0:e.fastlaneTextCaptionSettingsColor)||(null===(C=null===(w=null==t?void 0:t.text)||void 0===w?void 0:w.caption)||void 0===C?void 0:C.color),fontSize:(null==e?void 0:e.fastlaneTextCaptionSettingsFontSize)||(null===(P=null===(S=null==t?void 0:t.text)||void 0===S?void 0:S.caption)||void 0===P?void 0:P.fontSize)}},branding:(null==e?void 0:e.fastlaneBrandingSettings)||(null==t?void 0:t.branding)}}(e,t))}function Ze(e){return!!e&&(\"authenticationState\"in e||\"addresses\"in e||\"instruments\"in e)}var et,tt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class it{constructor(e,t,i){this.paymentIntegrationService=e,this.braintreeFastlaneUtils=t,this.braintreeSdk=i}initialize(e){var t;return tt(this,void 0,void 0,function*(){const{methodId:i,braintreefastlane:n}=e;if(!i)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!n)throw new w('Unable to initialize payment because \"options.braintreefastlane\" argument is not provided.');if(!n.onInit||\"function\"!=typeof n.onInit)throw new w('Unable to initialize payment because \"options.braintreefastlane.onInit\" argument is not provided or it is not a function.');if(!n.onChange||\"function\"!=typeof n.onChange)throw new w('Unable to initialize payment because \"options.braintreefastlane.onChange\" argument is not provided or it is not a function.');yield this.paymentIntegrationService.loadPaymentMethod(i);const r=this.paymentIntegrationService.getState(),o=r.getPaymentMethodOrThrow(i),{initializationData:a,clientToken:s}=o||{},{isFastlaneStylingEnabled:d}=a||{},l=y(r.getStoreConfigOrThrow().checkoutSettings.features,\"PROJECT-7080.braintree_fastlane_three_ds\");this.is3DSEnabled=o.config.is3dsEnabled,s&&l&&this.braintreeSdk.initialize(s);const c=Qe(d?null===(t=o.initializationData)||void 0===t?void 0:t.fastlaneStyles:void 0,n.styles);yield this.braintreeFastlaneUtils.initializeBraintreeFastlaneOrThrow(i,c),this.shouldRunAuthenticationFlow()&&(yield this.braintreeFastlaneUtils.runPayPalAuthenticationFlowOrThrow()),yield this.initializeCardComponent(),this.onError=n.onError,n.onInit(e=>this.renderBraintreeCardComponent(e)),n.onChange(()=>this.handleBraintreeStoredInstrumentChange(i))})}execute(e,t){return tt(this,void 0,void 0,function*(){const{payment:i}=e,n=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!i)throw new C([\"payment\"]);yield this.paymentIntegrationService.submitOrder(n,t);const r=yield this.preparePaymentPayload(i.methodId);yield this.paymentIntegrationService.submitPayment(r),this.braintreeFastlaneUtils.removeSessionIdFromCookies()})}finalize(){return Promise.reject(new Oe)}deinitialize(){return tt(this,void 0,void 0,function*(){return this.braintreeCardComponent=void 0,Promise.resolve()})}initializeCardComponent(){return tt(this,void 0,void 0,function*(){const e=this.paymentIntegrationService.getState(),{phone:t,firstName:i,lastName:n}=e.getBillingAddressOrThrow(),r=`${i} ${n}`,o={styles:{},fields:Object.assign({cardholderName:{prefill:r,enabled:!0}},t&&{phoneNumber:{prefill:t}})},a=this.braintreeFastlaneUtils.getBraintreeFastlaneComponentOrThrow();this.braintreeCardComponent=yield a(o)})}renderBraintreeCardComponent(e){const t=this.getBraintreeCardComponentOrThrow();if(!e)throw new w('Unable to initialize payment because \"container\" argument is not provided.');t.render(e)}preparePaymentPayload(e){var t,i;return tt(this,void 0,void 0,function*(){const n=this.paymentIntegrationService.getState(),r=n.getBillingAddressOrThrow(),o=`${r.firstName} ${r.lastName}`,a=this.getPayPalInstruments()[0],s=yield this.braintreeFastlaneUtils.getDeviceSessionId(),d=y(n.getStoreConfigOrThrow().checkoutSettings.features,\"PROJECT-7080.braintree_fastlane_three_ds\");if(a){const t=this.is3DSEnabled&&d?yield this.get3DS(a.bigpayToken,(null==a?void 0:a.iin)||\"\"):void 0;return{methodId:e,paymentData:{deviceSessionId:s,formattedPayload:{paypal_fastlane_token:{token:t||a.bigpayToken}}}}}const{getPaymentToken:l}=this.getBraintreeCardComponentOrThrow(),c=yield l({name:{fullName:o},billingAddress:this.mapToPayPalAddress(r)}),u=(null===(i=null===(t=c.paymentSource.card)||void 0===t?void 0:t.binDetails)||void 0===i?void 0:i.bin)||\"\",h=this.is3DSEnabled&&d?yield this.get3DS(c.id,u):void 0;return{methodId:e,paymentData:{deviceSessionId:s,nonce:h||c.id}}})}get3DS(e,t){return tt(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState(),n=yield this.braintreeSdk.getBraintreeThreeDS(),r=i.getOrderOrThrow();return new Promise((i,o)=>{n.verifyCard({amount:null==r?void 0:r.orderAmount,nonce:e,bin:t,onLookupComplete:(e,t)=>{n.on(\"customer-canceled\",()=>{\"function\"==typeof this.onError&&this.onError(new O),o(new O)}),t()}},(e,t)=>(e&&\"THREEDS_VERIFY_CARD_CANCELED_BY_MERCHANT\"===e.code&&(\"function\"==typeof this.onError&&this.onError(new O),o(new O)),i(t.nonce)))})})}mapToPayPalAddress(e){return{streetAddress:(null==e?void 0:e.address1)||\"\",locality:(null==e?void 0:e.city)||\"\",region:(null==e?void 0:e.stateOrProvinceCode)||(null==e?void 0:e.stateOrProvince)||\"\",postalCode:(null==e?void 0:e.postalCode)||\"\",countryCodeAlpha2:(null==e?void 0:e.countryCode)||\"\"}}shouldRunAuthenticationFlow(){const e=this.paymentIntegrationService.getState(),t=e.getCartOrThrow(),i=e.getCustomerOrThrow(),n=e.getPaymentProviderCustomer(),r=Ze(n)?n:{},o=this.braintreeFastlaneUtils.getSessionIdFromCookies();return!(!i.isGuest||(null==r?void 0:r.authenticationState)===de.CANCELED||(null==r?void 0:r.authenticationState)||o!==t.id)}getBraintreeCardComponentOrThrow(){if(!this.braintreeCardComponent)throw new U;return this.braintreeCardComponent}getPayPalInstruments(){const e=this.paymentIntegrationService.getState().getPaymentProviderCustomerOrThrow();return(Ze(e)?e:{}).instruments||[]}handleBraintreeStoredInstrumentChange(e){return tt(this,void 0,void 0,function*(){const t=this.braintreeFastlaneUtils.getBraintreeFastlaneOrThrow(),{selectionChanged:i,selectedCard:n}=yield t.profile.showCardSelector();if(i){const t=this.paymentIntegrationService.getState().getPaymentProviderCustomer(),i=Ze(t)?t:{},r=this.braintreeFastlaneUtils.mapPayPalToBcInstrument(e,[n]);if(r&&r.length>0)return yield this.paymentIntegrationService.updatePaymentProviderCustomer(Object.assign(Object.assign({},i),{instruments:[...r]})),r[0]}})}}!function(e){e.CVV=\"cvv\",e.PAN=\"pan\"}(et||(et={}));class nt{static get(e){const t=`${encodeURIComponent(`${e}`)}=`,i=document.cookie;let n=null;const r=i.indexOf(t);if(r>-1){let e=i.indexOf(\";\",r);-1===e&&(e=i.length),n=decodeURIComponent(i.substring(r+t.length,e))}return n}static set(e,t,i={secure:!0}){let n=`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;const{expires:r,path:o,domain:a,secure:s}=i;if(r)n+=`; expires=${r.toUTCString()}`;else{const e=new Date,t=60;e.setTime(e.getTime()+60*t*1e3),n+=`; expires=${e.toUTCString()}`}o&&(n+=`; path=${o}`),a&&(n+=`; domain=${a}`),s&&(n+=\"; secure\"),document.cookie=n}static remove(e,t){nt.set(e,\"\",Object.assign({expires:new Date(0)},t))}}var rt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ot{constructor(e,t){this.paymentIntegrationService=e,this.braintreeIntegrationService=t}getDeviceSessionId(){return rt(this,void 0,void 0,function*(){const e=this.paymentIntegrationService.getState().getCart();return this.braintreeIntegrationService.getSessionId(null==e?void 0:e.id)})}initializeBraintreeFastlaneOrThrow(e,t){return rt(this,void 0,void 0,function*(){const i=this.paymentIntegrationService.getState(),n=i.getCart(),{clientToken:r,config:o}=i.getPaymentMethodOrThrow(e);if(!r)throw new G(H.MissingPaymentMethod);this.methodId=e,this.braintreeIntegrationService.initialize(r),this.braintreeFastlane=yield this.braintreeIntegrationService.getBraintreeFastlane(null==n?void 0:n.id,o.testMode,t)})}getBraintreeFastlaneOrThrow(){if(!this.braintreeFastlane)throw new U;return this.braintreeFastlane}getBraintreeFastlaneComponentOrThrow(){return this.getBraintreeFastlaneOrThrow().FastlaneCardComponent}runPayPalAuthenticationFlowOrThrow(e,t){var i;return rt(this,void 0,void 0,function*(){try{const n=this.getMethodIdOrThrow(),r=this.getBraintreeFastlaneOrThrow(),{lookupCustomerByEmail:o,triggerAuthenticationFlow:a}=r.identity,s=this.paymentIntegrationService.getState(),d=s.getCartOrThrow(),l=s.getCustomer(),c=s.getBillingAddress(),{isFastlaneShippingOptionAutoSelectEnabled:u}=s.getPaymentMethodOrThrow(n).initializationData||{},h=e||(null==l?void 0:l.email)||(null==c?void 0:c.email)||\"\",{customerContextId:y}=yield o(h);if(!y)return yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:de.UNRECOGNIZED,addresses:[],instruments:[]}),void this.saveSessionIdToCookies(d.id);const{authenticationState:m,profileData:p}=yield a(y),g=(null===(i=null==p?void 0:p.shippingAddress)||void 0===i?void 0:i.phoneNumber)||\"\";if(m===de.CANCELED)return yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:m,addresses:[],instruments:[]}),void this.removeSessionIdFromCookies();const v=this.mapPayPalToBcAddress([p.shippingAddress],[g])||[],f=this.getPayPalBillingAddresses(p),b=f?this.mapPayPalToBcAddress([f],[g]):[],w=p.card?this.mapPayPalToBcInstrument(n,[p.card]):[],C=this.mergeShippingAndBillingAddresses(v,b);if(this.saveSessionIdToCookies(d.id),yield this.paymentIntegrationService.updatePaymentProviderCustomer({authenticationState:m,addresses:C,instruments:w}),b.length>0&&d.lineItems.physicalItems.length>0&&(yield this.paymentIntegrationService.updateBillingAddress(b[0])),b.length>0&&d.lineItems.digitalItems.length>0&&0===d.lineItems.physicalItems.length){const{firstName:e,lastName:t}=C[0],i=Object.assign(Object.assign({},b[0]),{firstName:e,lastName:t});yield this.paymentIntegrationService.updateBillingAddress(i)}v.length>0&&d.lineItems.physicalItems.length>0&&(yield this.paymentIntegrationService.updateShippingAddress(v[0]),t&&u&&(yield this.setShippingOption()))}catch(e){}})}getSessionIdFromCookies(){return nt.get(\"bc-fastlane-sessionId\")||\"\"}saveSessionIdToCookies(e){const t=new Date;t.setDate(t.getDate()+14),nt.set(\"bc-fastlane-sessionId\",e,{expires:t,secure:!0})}removeSessionIdFromCookies(){nt.remove(\"bc-fastlane-sessionId\")}mapPayPalToBcInstrument(e,t){if(t)return t.map(t=>{const{id:i,paymentSource:n}=t,{brand:r,expiry:o,lastDigits:a,binDetails:s}=n.card,[d,l]=o.split(\"-\");return{bigpayToken:i,brand:r,defaultInstrument:!1,expiryMonth:l,expiryYear:d,iin:(null==s?void 0:s.bin)||\"\",last4:a,method:e,provider:e,trustedShippingAddress:!1,type:\"card\",untrustedShippingCardVerificationMode:et.PAN}})}mapPayPalToBcAddress(e,t){if(!e)return[];const i=this.paymentIntegrationService.getState().getCountries()||[],n=e=>{const t=i.find(t=>t.code===e);return(null==t?void 0:t.name)||\"\"};return e.map(e=>({id:Date.now(),type:\"paypal-address\",firstName:e.firstName||\"\",lastName:e.lastName||\"\",company:e.company||\"\",address1:e.streetAddress,address2:e.extendedAddress||\"\",city:e.locality,stateOrProvince:e.region,stateOrProvinceCode:e.region,country:n(e.countryCodeAlpha2),countryCode:e.countryCodeAlpha2,postalCode:e.postalCode,phone:t&&t[0]||\"\",customFields:[]}))}getPayPalBillingAddresses(e){const{card:t,name:i}=e||{};if(!t)return;const{firstName:n,lastName:o}=t.paymentSource.card.billingAddress,{firstName:a,lastName:s}=i||{},{shippingAddress:d}=e||{},l=Object.assign(Object.assign({},t.paymentSource.card.billingAddress),{firstName:n||a,lastName:o||s});return d&&(0,lodash__WEBPACK_IMPORTED_MODULE_2__.isEqual)(this.normalizeAddress(l),this.normalizeAddress(d))?d:l}normalizeAddress(e){return (0,lodash__WEBPACK_IMPORTED_MODULE_2__.omit)(e,[\"id\"])}mergeShippingAndBillingAddresses(e,t){const i=t.filter(t=>!e.some(e=>(0,lodash__WEBPACK_IMPORTED_MODULE_2__.isEqual)(this.normalizeAddress(e),this.normalizeAddress(t))));return[...e,...i]}getMethodIdOrThrow(){if(!this.methodId)throw new w('Unable to proceed because \"methodId\" argument is not provided.');return this.methodId}setShippingOption(){var e;return rt(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState().getConsignments()||[],i=(null===(e=t[0])||void 0===e?void 0:e.availableShippingOptions)||[],n=i.find(e=>e.isRecommended);if(n||i.length){const e=n||i[0];yield this.paymentIntegrationService.selectShippingOption(e.id)}})}}const at=$(e=>{const i=window,n=new v(e),r=new j(new q((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),i,n),i),o=new ot(e,r),a=new q((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),i,n),s=new ye(a);return new it(e,o,s)},[{id:\"braintreeacceleratedcheckout\"}]);var st=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class dt{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i}initialize(e){return st(this,void 0,void 0,function*(){const{braintreevisacheckout:t,methodId:i}=e;if(!t)throw new w('Unable to initialize payment because \"options.braintreevisacheckout\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(i);const n=this.paymentIntegrationService.getState();this.paymentMethod=n.getPaymentMethodOrThrow(i);const r=n.getCheckoutOrThrow(),o=n.getStoreConfigOrThrow(),{clientToken:s,config:d}=this.paymentMethod||{};if(!s)throw new G(H.MissingPaymentMethod);const{onError:l=lodash__WEBPACK_IMPORTED_MODULE_2__.noop,onPaymentSelect:c=lodash__WEBPACK_IMPORTED_MODULE_2__.noop}=t;this.braintreeSdk.initialize(s);const u=yield this.braintreeSdk.getBraintreeVisaCheckout(),h=yield this.braintreeSdk.getVisaCheckoutSdk(null==d?void 0:d.testMode),y=u.createInitOptions({settings:{locale:o.storeProfile.storeLanguage,shipping:{collectShipping:!1}},paymentRequest:{currencyCode:o.currency.code,subtotal:String(r.subtotal)}});yield h.init(y),h.on(\"payment.success\",e=>this.tokenizePayment(u,e).then(()=>Promise.all([this.paymentIntegrationService.loadCheckout(),this.paymentIntegrationService.loadPaymentMethod(i)])).then(()=>c()).catch(e=>l(e))),h.on(\"payment.error\",(e,t)=>l(t))})}execute(e,t){var i,n;return st(this,void 0,void 0,function*(){const{payment:r}=e,o=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!r)throw new w('Unable to submit payment because \"payload.payment\" argument is not provided.');if(!(null===(n=null===(i=this.paymentMethod)||void 0===i?void 0:i.initializationData)||void 0===n?void 0:n.nonce))throw new G(H.MissingPaymentMethod);const{nonce:a}=this.paymentMethod.initializationData;try{yield this.paymentIntegrationService.submitOrder(o,t),yield this.paymentIntegrationService.submitPayment(Object.assign(Object.assign({},r),{paymentData:{nonce:a}}))}catch(e){this.handleError(e)}})}finalize(){return Promise.reject(new Oe)}deinitialize(){return st(this,void 0,void 0,function*(){yield this.braintreeSdk.deinitialize()})}tokenizePayment(e,t){return st(this,void 0,void 0,function*(){return Promise.all([e.tokenize(t),this.braintreeSdk.getDataCollectorOrThrow()]).then(([e,t])=>{const i=this.paymentIntegrationService.getState(),n=i.getShippingAddress(),r=i.getBillingAddress(),{shippingAddress:o=this.mapToVisaCheckoutAddress(n),billingAddress:a=this.mapToVisaCheckoutAddress(r)}=e;return this.postForm(Object.assign(Object.assign({},e),{shippingAddress:o,billingAddress:a}),t)})})}mapToVisaCheckoutAddress(e){return e?{firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phone,streetAddress:e.address1,extendedAddress:e.address2,locality:e.city,region:e.stateOrProvinceCode,countryCode:e.countryCode,postalCode:e.postalCode}:{}}postForm(e,t){const{userData:i,billingAddress:n,shippingAddress:r,details:o}=e,{userEmail:a}=i,{deviceData:s}=t;return this.formPoster.postForm(\"/checkout.php\",{payment_type:e.type,nonce:e.nonce,provider:\"braintreevisacheckout\",action:\"set_external_checkout\",device_data:s,card_information:JSON.stringify({type:o.cardType,number:o.lastTwo}),billing_address:JSON.stringify(this.getAddress(a,n)),shipping_address:JSON.stringify(this.getAddress(a,r))})}getAddress(e,t={}){return{email:e,first_name:t.firstName,last_name:t.lastName,phone_number:t.phoneNumber,address_line_1:t.streetAddress,address_line_2:t.extendedAddress,city:t.locality,state:t.region,country_code:t.countryCode,postal_code:t.postalCode}}handleError(e){if(e instanceof Error&&\"BraintreeError\"===e.name)throw new Ee(e.message);throw e}}const lt=$(i=>{const n=window,r=new v(i),o=new ye(new q((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),n,r));return new dt(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),o)},[{id:\"braintreevisacheckout\"}]);var ct=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class ut{constructor(e,t){this.paymentIntegrationService=e,this.braintreeIntegrationService=t}initialize(e){return ct(this,void 0,void 0,function*(){const{methodId:t}=e;yield this.paymentIntegrationService.loadPaymentMethod(t);const i=this.paymentIntegrationService.getState();this.venmoOptions=e.braintreevenmo;const n=i.getPaymentMethodOrThrow(t);yield this.initializeBraintreeVenmo(n)})}execute(e){return ct(this,void 0,void 0,function*(){const{payment:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!t)throw new C([\"payment\"]);try{const e=yield this.preparePaymentData(t);yield this.paymentIntegrationService.submitOrder(i),yield this.paymentIntegrationService.submitPayment(e)}catch(e){this.handleError(e)}})}finalize(){return Promise.reject(new Oe)}deinitialize(){return ct(this,void 0,void 0,function*(){return yield this.braintreeIntegrationService.teardown(),Promise.resolve()})}handleError(e){if(!L(e))throw e;if(\"PAYPAL_POPUP_CLOSED\"===e.code)throw new O(e.message);throw new Ee(e.message)}initializeBraintreeVenmo(e){var t;return ct(this,void 0,void 0,function*(){const{clientToken:i}=e;if(!i)throw new G(H.MissingPaymentMethod);const n=y(this.paymentIntegrationService.getState().getStoreConfigOrThrow().checkoutSettings.features,\"PAYPAL-5406.braintree_venmo_web_fallback_support\");try{this.braintreeIntegrationService.initialize(i),this.braintreeVenmoCheckout=yield this.braintreeIntegrationService.getVenmoCheckout(Object.assign(Object.assign({},void 0!==(null===(t=this.venmoOptions)||void 0===t?void 0:t.allowDesktop)?{allowDesktop:this.venmoOptions.allowDesktop}:{}),n?{mobileWebFallBack:n}:{}))}catch(e){this.handleError(e)}})}preparePaymentData(e){return ct(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState(),{nonce:i}=t.getPaymentMethodOrThrow(e.methodId);if(i)return Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(i)});const n=yield this.braintreeVenmoTokenize(),r=yield this.braintreeIntegrationService.getSessionId();return Object.assign(Object.assign({},e),{paymentData:this.formattedPayload(n.nonce,n.details.email,r)})})}formattedPayload(e,t,i){return{formattedPayload:{vault_payment_instrument:null,set_as_default_stored_instrument:null,device_info:i||null,paypal_account:{token:e,email:t||null}}}}braintreeVenmoTokenize(){return new Promise((e,t)=>{var i;null===(i=this.braintreeVenmoCheckout)||void 0===i||i.tokenize((i,n)=>{if(i)return t(i);e(n)})})}}const ht=$(e=>{const i=window,n=(0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),r=new v(e),o=new q(n,i,r),a=new j(o,i);return new ut(e,a)},[{id:\"braintreevenmo\"}]);var yt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class mt{constructor(e,t,i){this.paymentIntegrationService=e,this.braintreeIntegrationService=t,this.braintreeHostedForm=i}initialize(e){return yt(this,void 0,void 0,function*(){const{methodId:t,gatewayId:i,braintree:n}=e;yield this.paymentIntegrationService.loadPaymentMethod(t);const r=this.paymentIntegrationService.getState();this.paymentMethod=r.getPaymentMethodOrThrow(t);const{clientToken:o}=this.paymentMethod;if(!o)throw new G(H.MissingPaymentMethod);this.threeDSecure=null==n?void 0:n.threeDSecure,this.onPaymentError=null==n?void 0:n.onPaymentError;try{this.braintreeIntegrationService.initialize(o,this.threeDSecure),this.isHostedPaymentFormEnabled(t,i)&&(null==n?void 0:n.form)&&(yield this.braintreeHostedForm.initialize(n.form,n.unsupportedCardBrands,o),this.isHostedFormInitialized=this.braintreeHostedForm.isInitialized()),this.is3dsEnabled=this.paymentMethod.config.is3dsEnabled,this.deviceSessionId=yield this.braintreeIntegrationService.getSessionId(),this.shouldInitializeBraintreeFastlane()&&(yield this.initializeBraintreeFastlaneOrThrow(t))}catch(e){return this.handleError(e,t)}})}execute(e){return yt(this,void 0,void 0,function*(){const{payment:t}=e,i=function(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&\"function\"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(e,n[r])&&(i[n[r]]=e[n[r]])}return i}(e,[\"payment\"]);if(!t)throw new C([\"payment\"]);this.isHostedFormInitialized&&this.braintreeHostedForm.validate(),yield this.paymentIntegrationService.submitOrder(i);const n=this.paymentIntegrationService.getState(),r=n.getBillingAddressOrThrow(),o=n.getOrderOrThrow().orderAmount;try{const e=this.isHostedFormInitialized?yield this.prepareHostedPaymentData(t,r,o):yield this.preparePaymentData(t,r,o);yield this.paymentIntegrationService.submitPayment(Object.assign(Object.assign({},t),{paymentData:e}))}catch(e){return this.processAdditionalAction(e,t,o)}})}finalize(){return Promise.reject(new Oe)}deinitialize(){return yt(this,void 0,void 0,function*(){return this.isHostedFormInitialized=!1,yield Promise.all([this.braintreeIntegrationService.teardown(),this.braintreeHostedForm.deinitialize()]),Promise.resolve()})}handleError(e,t){var i;if(be(e)){if(!(t&&this.paymentIntegrationService.getState().isPaymentMethodInitialized({methodId:t})||\"HOSTED_FIELDS_INVALID_FIELD_SELECTOR\"!==e.code))return;if(e.code.startsWith(\"THREEDS_\"))return null===(i=this.onPaymentError)||void 0===i||i.call(this,new Ee(\"THREEDS_VERIFICATION_FAILED\")),Promise.reject();throw new Ee(e.message)}throw e}preparePaymentData(e,t,i){return yt(this,void 0,void 0,function*(){const{paymentData:n}=e,r={deviceSessionId:this.deviceSessionId};if(this.isSubmittingWithStoredCard(e))return Object.assign(Object.assign({},r),n);const{shouldSaveInstrument:o=!1,shouldSetAsDefaultInstrument:a=!1}=ke(n)?n:{},{nonce:s}=this.shouldPerform3DSVerification(e)?yield this.braintreeIntegrationService.verifyCard(e,t,i):yield this.braintreeIntegrationService.tokenizeCard(e,t);return Object.assign(Object.assign({},r),{nonce:s,shouldSaveInstrument:o,shouldSetAsDefaultInstrument:a})})}prepareHostedPaymentData(e,t,i){return yt(this,void 0,void 0,function*(){const{paymentData:n}=e,r={deviceSessionId:this.deviceSessionId};if(this.isSubmittingWithStoredCard(e)){const{nonce:e}=yield this.braintreeHostedForm.tokenizeForStoredCardVerification();return Object.assign(Object.assign(Object.assign({},r),n),{nonce:e})}const{shouldSaveInstrument:o=!1,shouldSetAsDefaultInstrument:a=!1}=ke(n)?n:{},{nonce:s}=this.shouldPerform3DSVerification(e)?yield this.verifyCardWithHostedForm(t,i):yield this.braintreeHostedForm.tokenize(t);return Object.assign(Object.assign({},r),{shouldSaveInstrument:o,shouldSetAsDefaultInstrument:a,nonce:s})})}prepareAdditionalActionPaymentData(e,t){const{paymentData:i}=e,n={deviceSessionId:this.deviceSessionId,nonce:t},{shouldSaveInstrument:r=!1,shouldSetAsDefaultInstrument:o=!1}=ke(i)?i:{};return this.isSubmittingWithStoredCard(e)&&(r||o)?Object.assign(Object.assign({},i),n):Object.assign({},n)}verifyCardWithHostedForm(e,t){return yt(this,void 0,void 0,function*(){const i=yield this.braintreeHostedForm.tokenize(e);return this.braintreeIntegrationService.challenge3DSVerification(i,t)})}processAdditionalAction(e,t,i){return yt(this,void 0,void 0,function*(){if(!(e=>\"object\"==typeof e&&null!==e&&\"body\"in e)(e)||!(0,lodash__WEBPACK_IMPORTED_MODULE_2__.some)(e.body.errors,{code:\"three_d_secure_required\"}))return this.handleError(e);try{const{payer_auth_request:n}=function(e){return\"object\"==typeof e&&null!==e&&\"name\"in e&&\"body\"in e&&\"status\"in e.body&&\"three_ds_result\"in e.body&&\"payer_auth_request\"in e.body.three_ds_result&&\"errors\"in e.body}(e)&&e.body.three_ds_result||{},{paymentData:r}=t,o=this.paymentIntegrationService.getState();if(!r||!Ie(r))throw new C([\"instrumentId\"]);const a=o.getCardInstrumentOrThrow(r.instrumentId),{nonce:s}=yield this.braintreeIntegrationService.challenge3DSVerification({nonce:n||\"\",bin:a.iin},i),d=this.prepareAdditionalActionPaymentData(t,s);yield this.paymentIntegrationService.submitPayment(Object.assign(Object.assign({},t),{paymentData:d}))}catch(e){return this.handleError(e)}})}isHostedPaymentFormEnabled(e,t){return!!e&&!0===this.paymentIntegrationService.getState().getPaymentMethodOrThrow(e,t).config.isHostedFormEnabled}isSubmittingWithStoredCard(e){return!(!e.paymentData||!Ie(e.paymentData))}shouldPerform3DSVerification(e){return!(!this.is3dsEnabled||this.isSubmittingWithStoredCard(e))}shouldInitializeBraintreeFastlane(){var e;const t=this.paymentIntegrationService.getState().getPaymentProviderCustomerOrThrow(),i=Ze(t)?t:{};return(null===(e=this.paymentMethod)||void 0===e?void 0:e.initializationData.isAcceleratedCheckoutEnabled)&&!(null==i?void 0:i.authenticationState)}initializeBraintreeFastlaneOrThrow(e){return yt(this,void 0,void 0,function*(){const t=this.paymentIntegrationService.getState(),i=t.getCartOrThrow(),n=t.getPaymentMethodOrThrow(e),{clientToken:r,config:o}=n;if(!r)throw new G(H.MissingPaymentMethod);this.braintreeIntegrationService.initialize(r,this.threeDSecure),yield this.braintreeIntegrationService.getBraintreeFastlane(i.id,o.testMode)})}}function pt(e){return\"cardNumber\"in e}function gt(e){if(!L(e))return!1;const{details:t}=e;return void 0===t||\"object\"==typeof t&&null!==t&&void 0===t.invalidFieldKeys||(i=t,Array.isArray(i)&&i.every(e=>\"string\"==typeof e));// removed by dead control flow\n var i; }var vt,ft=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};!function(e){e[e.CreditCard=0]=\"CreditCard\",e[e.StoredCardVerification=1]=\"StoredCardVerification\"}(vt||(vt={}));class bt{constructor(e,t){this.braintreeScriptLoader=e,this.braintreeSDKVersionManager=t,this.isInitializedHostedForm=!1,this.handleBlur=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onBlur)||void 0===i||i.call(t,{fieldType:this.mapFieldType(e.emittedBy),errors:this.mapErrors(e.fields)})},this.handleFocus=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onFocus)||void 0===i||i.call(t,{fieldType:this.mapFieldType(e.emittedBy)})},this.handleCardTypeChange=e=>{var t,i;const n=1===e.cards.length?e.cards[0].type.replace(/^master-card$/,\"mastercard\"):void 0;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onCardTypeChange)||void 0===i||i.call(t,{cardType:n})},this.handleInputSubmitRequest=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onEnter)||void 0===i||i.call(t,{fieldType:this.mapFieldType(e.emittedBy)})},this.handleValidityChange=e=>{var t,i;null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onValidate)||void 0===i||i.call(t,{isValid:this.isValidForm(e),errors:this.mapValidationErrors(e.fields)})}}initialize(e,t,i){var r,o,a,s,d;return ft(this,void 0,void 0,function*(){this.clientToken=i,this.formOptions=e,this.type=pt(e.fields)?vt.CreditCard:vt.StoredCardVerification;const l=this.mapFieldOptions(e.fields,t);(0,lodash__WEBPACK_IMPORTED_MODULE_2__.isEmpty)(l)?this.isInitializedHostedForm=!1:(this.cardFields=yield this.createHostedFields({fields:l,styles:e.styles&&this.mapStyleOptions(e.styles)}),null===(r=this.cardFields)||void 0===r||r.on(\"blur\",this.handleBlur),null===(o=this.cardFields)||void 0===o||o.on(\"focus\",this.handleFocus),null===(a=this.cardFields)||void 0===a||a.on(\"cardTypeChange\",this.handleCardTypeChange),null===(s=this.cardFields)||void 0===s||s.on(\"validityChange\",this.handleValidityChange),null===(d=this.cardFields)||void 0===d||d.on(\"inputSubmitRequest\",this.handleInputSubmitRequest),this.isInitializedHostedForm=!0)})}isInitialized(){return!!this.isInitializedHostedForm}deinitialize(){var e;return ft(this,void 0,void 0,function*(){this.isInitializedHostedForm&&(this.isInitializedHostedForm=!1,yield null===(e=this.cardFields)||void 0===e?void 0:e.teardown())})}validate(){if(!this.cardFields)throw new I(P.PaymentNotInitialized);const e=this.cardFields.getState();if(!this.isValidForm(e)){this.handleValidityChange(e);const t=this.mapValidationErrors(e.fields);throw new S(t)}}tokenize(e){var t,i,n,r,a;return ft(this,void 0,void 0,function*(){if(!this.cardFields)throw new I(P.PaymentNotInitialized);try{const r=yield this.cardFields.tokenize((0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)({billingAddress:e&&this.mapBillingAddress(e)},lodash__WEBPACK_IMPORTED_MODULE_2__.isNil));return null===(i=null===(t=this.formOptions)||void 0===t?void 0:t.onValidate)||void 0===i||i.call(t,{isValid:!0,errors:{}}),{nonce:r.nonce,bin:null===(n=r.details)||void 0===n?void 0:n.bin}}catch(e){if(gt(e)){const t=this.mapTokenizeError(e);if(t)throw null===(a=null===(r=this.formOptions)||void 0===r?void 0:r.onValidate)||void 0===a||a.call(r,{isValid:!1,errors:t}),new S(t)}throw e}})}tokenizeForStoredCardVerification(){var e,t,i,n,r;return ft(this,void 0,void 0,function*(){if(!this.cardFields)throw new I(P.PaymentNotInitialized);try{const n=yield this.cardFields.tokenize();return null===(t=null===(e=this.formOptions)||void 0===e?void 0:e.onValidate)||void 0===t||t.call(e,{isValid:!0,errors:{}}),{nonce:n.nonce,bin:null===(i=n.details)||void 0===i?void 0:i.bin}}catch(e){if(gt(e)){const t=this.mapTokenizeError(e,!0);if(t)throw null===(r=null===(n=this.formOptions)||void 0===n?void 0:n.onValidate)||void 0===r||r.call(n,{isValid:!1,errors:t}),new S(t)}throw e}})}createHostedFields(e){return ft(this,void 0,void 0,function*(){const t=yield this.getClient(),i=yield this.braintreeScriptLoader.loadHostedFields(),n=this.braintreeSDKVersionManager.getSDKVersion()===m?Object.assign(Object.assign({},e),{preventCursorJumps:!0}):e;return i.create(Object.assign(Object.assign({},n),{client:t}))})}getClient(){return ft(this,void 0,void 0,function*(){if(!this.clientToken)throw new I(P.PaymentNotInitialized);if(!this.client){const e=yield this.braintreeScriptLoader.loadClient();this.client=e.create({authorization:this.clientToken})}return this.client})}mapBillingAddress(e){return{countryName:e.country,postalCode:e.postalCode,streetAddress:e.address2?`${e.address1} ${e.address2}`:e.address1}}mapFieldOptions(e,t){if(pt(e)){const i={};return null==t||t.forEach(e=>{(e=>Object.values(ue).includes(e))(e)&&(i[e]=!1)}),(0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)({number:Object.assign({container:`#${e.cardNumber.containerId}`,placeholder:e.cardNumber.placeholder,internalLabel:e.cardNumber.accessibilityLabel},Object.keys(i).length>0?{supportedCardBrands:i}:{}),expirationDate:{container:`#${e.cardExpiry.containerId}`,placeholder:e.cardExpiry.placeholder,internalLabel:e.cardExpiry.accessibilityLabel},cvv:e.cardCode&&{container:`#${e.cardCode.containerId}`,placeholder:e.cardCode.placeholder,internalLabel:e.cardCode.accessibilityLabel},cardholderName:{container:`#${e.cardName.containerId}`,placeholder:e.cardName.placeholder,internalLabel:e.cardName.accessibilityLabel}},lodash__WEBPACK_IMPORTED_MODULE_2__.isNil)}return (0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)({number:e.cardNumberVerification&&{container:`#${e.cardNumberVerification.containerId}`,placeholder:e.cardNumberVerification.placeholder},cvv:e.cardCodeVerification&&{container:`#${e.cardCodeVerification.containerId}`,placeholder:e.cardCodeVerification.placeholder}},lodash__WEBPACK_IMPORTED_MODULE_2__.isNil)}mapStyleOptions(e){const t=(e={})=>(0,lodash__WEBPACK_IMPORTED_MODULE_2__.omitBy)({color:e.color,\"font-family\":e.fontFamily,\"font-size\":e.fontSize,\"font-weight\":e.fontWeight},lodash__WEBPACK_IMPORTED_MODULE_2__.isNil);return{input:t(e.default),\".invalid\":t(e.error),\":focus\":t(e.focus)}}mapFieldType(e){switch(e){case\"number\":return this.type===vt.StoredCardVerification?F.CardNumberVerification:F.CardNumber;case\"expirationDate\":return F.CardExpiry;case\"cvv\":return this.type===vt.StoredCardVerification?F.CardCodeVerification:F.CardCode;case\"cardholderName\":return F.CardName;default:throw new Error(\"Unexpected field type\")}}mapErrors(e){const t={};if(e)for(const[i,n]of Object.entries(e))if(n&&this.isValidParam(i)){const{isValid:e,isEmpty:r,isPotentiallyValid:o}=n;t[i]={isValid:e,isEmpty:r,isPotentiallyValid:o}}return t}mapValidationErrors(e){return Object.keys(e).reduce((t,i)=>{var n;return Object.assign(Object.assign({},t),{[this.mapFieldType(i)]:(null===(n=e[i])||void 0===n?void 0:n.isValid)?void 0:[this.createInvalidError(this.mapFieldType(i))]})},{})}mapTokenizeError(e,t=!1){var i,n;if(\"HOSTED_FIELDS_FIELDS_EMPTY\"===e.code){const e=[this.createRequiredError(this.mapFieldType(\"cvv\"))];return t?{[this.mapFieldType(\"cvv\")]:e}:{[this.mapFieldType(\"cvv\")]:e,[this.mapFieldType(\"expirationDate\")]:[this.createRequiredError(this.mapFieldType(\"expirationDate\"))],[this.mapFieldType(\"number\")]:[this.createRequiredError(this.mapFieldType(\"number\"))],[this.mapFieldType(\"cardholderName\")]:[this.createRequiredError(this.mapFieldType(\"cardholderName\"))]}}return null===(n=null===(i=e.details)||void 0===i?void 0:i.invalidFieldKeys)||void 0===n?void 0:n.reduce((e,t)=>{const i=this.mapFieldType(t);return Object.assign(Object.assign({},e),{[i]:[this.createInvalidError(i)]})},{})}createRequiredError(e){var t;return{fieldType:e,message:null!==(t={[F.CardCode]:\"CVV is required\",[F.CardCodeVerification]:\"CVV is required\",[F.CardNumber]:\"Credit card number is required\",[F.CardNumberVerification]:\"Credit card number is required\",[F.CardExpiry]:\"Expiration date is required\",[F.CardName]:\"Full name is required\"}[e])&&void 0!==t?t:\"Field is required\",type:\"required\"}}createInvalidError(e){var t,i,n,r;const o={[F.CardCode]:{message:\"Invalid card code\",type:\"invalid_card_code\"},[F.CardCodeVerification]:{message:\"Invalid card code\",type:\"invalid_card_code\"},[F.CardNumber]:{message:\"Invalid card number\",type:\"invalid_card_number\"},[F.CardNumberVerification]:{message:\"Invalid card number\",type:\"invalid_card_number\"},[F.CardExpiry]:{message:\"Invalid card expiry\",type:\"invalid_card_expiry\"},[F.CardName]:{message:\"Invalid card name\",type:\"invalid_card_name\"}};return{fieldType:e,message:null!==(i=null===(t=o[e])||void 0===t?void 0:t.message)&&void 0!==i?i:\"Invalid field\",type:null!==(r=null===(n=o[e])||void 0===n?void 0:n.type)&&void 0!==r?r:\"invalid\"}}isValidForm(e){return Object.keys(e.fields).every(t=>{var i;return null===(i=e.fields[t])||void 0===i?void 0:i.isValid})}isValidParam(e){return[\"number\",\"cvv\",\"expirationDate\",\"postalCode\",\"cardholderName\",\"cardType\"].includes(e)}}const wt=$(e=>{const i=window,n=new v(e),r=new q((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),i,n),o=new j(r,i),a=new bt(r,n);return new mt(e,o,a)},[{id:\"braintree\"}]);var Ct=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class St{constructor(e,t,i,n){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeHostWindow=n}initialize(e){return Ct(this,void 0,void 0,function*(){const{braintreepaypal:t,methodId:i}=e,{container:n,onError:r}=t||{};if(!i)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new w('Unable to initialize payment because \"options.braintreepaypal\" argument is not provided.');if(!n)throw new w('Unable to initialize payment because \"options.braintreepaypal.container\" argument is not provided.');let o,a=this.paymentIntegrationService.getState();try{if(o=a.getPaymentMethodOrThrow(i),!o.clientToken)throw new G(H.MissingPaymentToken)}catch(e){a=yield this.paymentIntegrationService.loadPaymentMethod(i),o=a.getPaymentMethodOrThrow(i)}const{clientToken:s,config:d,initializationData:l}=o,{paymentButtonStyles:c}=l||{},{checkoutTopButtonStyles:u}=c||{};if(!s||!l)throw new G(H.MissingPaymentMethod);const h={currency:a.getCartOrThrow().currency.code,intent:l.intent,isCreditEnabled:l.isCreditEnabled,commit:!1};this.braintreeIntegrationService.initialize(s),yield this.braintreeIntegrationService.getPaypalCheckout(h,e=>{this.renderPayPalButton(e,t,i,Boolean(d.testMode),u)},e=>this.handleError(e,n,r))})}deinitialize(){return Ct(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}signIn(e,t){return Ct(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return Ct(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}renderPayPalButton(e,t,i,n,r){const{container:o,onClick:s=lodash__WEBPACK_IMPORTED_MODULE_2__.noop}=t,{paypal:d}=this.braintreeHostWindow,l=null==d?void 0:d.FUNDING.PAYPAL;if(d&&l){const a=d.Buttons({env:this.braintreeIntegrationService.getBraintreeEnv(n),fundingSource:l,style:Object.assign(Object.assign({},r),{height:40}),createOrder:()=>this.setupPayment(e,t,i),onApprove:n=>this.tokenizePayment(n,e,i,t),onClick:s});a.isEligible()&&a.render(`#${o}`)}else this.braintreeIntegrationService.removeElement(o)}setupPayment(e,t,i){var n;return Ct(this,void 0,void 0,function*(){try{yield this.paymentIntegrationService.loadDefaultCheckout();const t=this.paymentIntegrationService.getState(),r=t.getCheckoutOrThrow().outstandingBalance,o=t.getCartOrThrow().currency.code,a=t.getCustomer(),s=t.getPaymentMethodOrThrow(i),d=null==a?void 0:a.addresses[0],l=d?this.braintreeIntegrationService.mapToBraintreeShippingAddressOverride(d):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:l,amount:r,currency:o,offerCredit:!1,intent:null===(n=s.initializationData)||void 0===n?void 0:n.intent})}catch(e){const{container:i,onError:n}=t;this.handleError(e,i,n)}})}tokenizePayment(e,t,i,n){return Ct(this,void 0,void 0,function*(){try{const{deviceData:n}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),r=yield t.tokenizePayment(e),{details:o,nonce:a}=r,s=this.braintreeIntegrationService.mapToLegacyBillingAddress(o),d=this.braintreeIntegrationService.mapToLegacyShippingAddress(o);return this.formPoster.postForm(\"/checkout.php\",{payment_type:\"paypal\",provider:i,action:\"set_external_checkout\",nonce:a,device_data:n,billing_address:JSON.stringify(s),shipping_address:JSON.stringify(d)}),r}catch(e){const{container:t,onError:i}=n;this.handleError(e,t,i)}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!L(e))throw e;i(e)}}const Pt=$(i=>{const n=window,r=new v(i),o=new j(new q((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),n,r),n);return new St(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),o,n)},[{id:\"braintreepaypal\"}]);var It=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Ot{constructor(e,t,i,n){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeIntegrationService=i,this.braintreeHostWindow=n}initialize(e){return It(this,void 0,void 0,function*(){const{braintreepaypalcredit:t,methodId:i}=e,{container:n,onError:r}=t||{};if(!i)throw new w('Unable to initialize payment because \"options.methodId\" argument is not provided.');if(!t)throw new w('Unable to initialize payment because \"options.braintreepaypalcredit\" argument is not provided.');if(!n)throw new w('Unable to initialize payment because \"options.braintreepaypalcredit.container\" argument is not provided.');let o,a=this.paymentIntegrationService.getState();try{if(o=a.getPaymentMethodOrThrow(i),!o.clientToken)throw new G(H.MissingPaymentToken)}catch(e){a=yield this.paymentIntegrationService.loadPaymentMethod(i),o=a.getPaymentMethodOrThrow(i)}const{clientToken:s,config:d,initializationData:l}=o,{paymentButtonStyles:c}=l||{},{checkoutTopButtonStyles:u}=c||{};if(!s||!l)throw new G(H.MissingPaymentMethod);const h={currency:a.getCartOrThrow().currency.code,intent:l.intent,isCreditEnabled:l.isCreditEnabled,commit:!1};this.braintreeIntegrationService.initialize(s),yield this.braintreeIntegrationService.getPaypalCheckout(h,e=>{this.renderPayPalButton(e,t,i,Boolean(d.testMode),Object.assign(Object.assign({},u),{height:40}))},e=>this.handleError(e,n,r))})}deinitialize(){return It(this,void 0,void 0,function*(){yield this.braintreeIntegrationService.teardown()})}signIn(e,t){return It(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return It(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}renderPayPalButton(e,t,i,n,r){const{container:o,onClick:s=lodash__WEBPACK_IMPORTED_MODULE_2__.noop}=t,{paypal:d}=this.braintreeHostWindow;let l=!1;d&&[d.FUNDING.PAYLATER,d.FUNDING.CREDIT].forEach(a=>{if(!l){const c=d.Buttons({env:n?\"sandbox\":\"production\",fundingSource:a,style:r,createOrder:()=>this.setupPayment(e,t,i),onApprove:n=>this.tokenizePayment(n,e,i,t),onClick:s});c.isEligible()&&(c.render(`#${o}`),l=!0)}}),d&&l||this.braintreeIntegrationService.removeElement(o)}setupPayment(e,t,i){var n;return It(this,void 0,void 0,function*(){try{yield this.paymentIntegrationService.loadDefaultCheckout();const t=this.paymentIntegrationService.getState(),r=t.getCheckoutOrThrow().outstandingBalance,o=t.getCartOrThrow().currency.code,a=t.getCustomer(),s=t.getPaymentMethodOrThrow(i),d=null==a?void 0:a.addresses[0],l=d?this.braintreeIntegrationService.mapToBraintreeShippingAddressOverride(d):void 0;return yield e.createPayment({flow:\"checkout\",enableShippingAddress:!0,shippingAddressEditable:!1,shippingAddressOverride:l,amount:r,currency:o,offerCredit:!0,intent:null===(n=s.initializationData)||void 0===n?void 0:n.intent})}catch(e){const{container:i,onError:n}=t;this.handleError(e,i,n)}})}tokenizePayment(e,t,i,n){return It(this,void 0,void 0,function*(){try{const{deviceData:n}=yield this.braintreeIntegrationService.getDataCollector({paypal:!0}),r=yield t.tokenizePayment(e),{details:o,nonce:a}=r,s=this.braintreeIntegrationService.mapToLegacyBillingAddress(o),d=this.braintreeIntegrationService.mapToLegacyShippingAddress(o);return this.formPoster.postForm(\"/checkout.php\",{payment_type:\"paypal\",provider:i,action:\"set_external_checkout\",nonce:a,device_data:n,billing_address:JSON.stringify(s),shipping_address:JSON.stringify(d)}),r}catch(e){const{container:t,onError:i}=n;this.handleError(e,t,i)}})}handleError(e,t,i){if(this.braintreeIntegrationService.removeElement(t),!i||!L(e))throw e;i(e)}}const kt=$(i=>{const n=window,r=new v(i),o=new j(new q((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),n,r),n);return new Ot(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),o,n)},[{id:\"braintreepaypalcredit\"}]);var Et=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Tt{constructor(e,t){this.paymentIntegrationService=e,this.braintreeFastlaneUtils=t,this.isAcceleratedCheckoutEnabled=!1}initialize({methodId:e,braintreefastlane:t}){var i;return Et(this,void 0,void 0,function*(){if(!e)throw new w('Unable to proceed because \"methodId\" argument is not provided.');const n=yield this.getValidPaymentMethodOrThrow(e),{isAcceleratedCheckoutEnabled:r,isFastlaneStylingEnabled:o}=n.initializationData||{},a=o?null===(i=n.initializationData)||void 0===i?void 0:i.fastlaneStyles:void 0;this.isAcceleratedCheckoutEnabled=!!r;try{if(this.isAcceleratedCheckoutEnabled){const e=Qe(a,null==t?void 0:t.styles);yield this.braintreeFastlaneUtils.initializeBraintreeFastlaneOrThrow(n.id,e)}}catch(e){}return Promise.resolve()})}deinitialize(){return Et(this,void 0,void 0,function*(){return Promise.resolve()})}signIn(e,t){return Et(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signInCustomer(e,t)})}signOut(e){return Et(this,void 0,void 0,function*(){yield this.paymentIntegrationService.signOutCustomer(e)})}executePaymentMethodCheckout(e){return Et(this,void 0,void 0,function*(){const{checkoutPaymentMethodExecuted:t,continueWithCheckoutCallback:i}=e||{};if(\"function\"!=typeof i)throw new w('Unable to proceed because \"continueWithCheckoutCallback\" argument is not provided and it must be a function.');const n=this.paymentIntegrationService.getState().getCustomerOrThrow();if(this.isAcceleratedCheckoutEnabled&&n.isGuest){const e=yield this.shouldRunAuthenticationFlow();t&&\"function\"==typeof t&&t(),e&&(yield this.braintreeFastlaneUtils.runPayPalAuthenticationFlowOrThrow(void 0,!0))}i()})}shouldRunAuthenticationFlow(){var e;return Et(this,void 0,void 0,function*(){const t=\"braintreeacceleratedcheckout\";try{yield this.paymentIntegrationService.loadPaymentMethod(t);const i=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t);return(null===(e=i.initializationData)||void 0===e?void 0:e.shouldRunAcceleratedCheckout)||!1}catch(e){return!1}})}getValidPaymentMethodOrThrow(e){return Et(this,void 0,void 0,function*(){let t=e;try{yield this.paymentIntegrationService.loadPaymentMethod(t)}catch(i){t=\"braintree\"===e?\"braintreeacceleratedcheckout\":\"braintree\",yield this.paymentIntegrationService.loadPaymentMethod(t)}return this.paymentIntegrationService.getState().getPaymentMethodOrThrow(t)})}}const At=$(e=>{const i=window,n=new v(e),r=new j(new q((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),i,n),i),o=new ot(e,r);return new Tt(e,o)},[{id:\"braintreeacceleratedcheckout\"},{id:\"braintree\"}]);class zt extends f{constructor(e){super(e||\"Not implemented.\"),this.name=\"NotImplementedError\",this.type=\"not_implemented\"}}var Nt=function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,s)}d((n=n.apply(e,t||[])).next())})};class Dt{constructor(e,t,i){this.paymentIntegrationService=e,this.formPoster=t,this.braintreeSdk=i,this.buttonClassName=\"visa-checkout-wrapper\",this.onError=lodash__WEBPACK_IMPORTED_MODULE_2__.noop}initialize(e){return Nt(this,void 0,void 0,function*(){const{braintreevisacheckout:t,methodId:i}=e;if(!i)throw new w('Unable to proceed because \"methodId\" argument is not provided.');if(!t)throw new w('Unable to proceed because \"options.braintreevisacheckout\" argument is not provided.');yield this.paymentIntegrationService.loadPaymentMethod(i);const n=this.paymentIntegrationService.getState(),r=n.getCheckoutOrThrow(),{clientToken:o,config:s}=n.getPaymentMethodOrThrow(i),d=n.getStoreConfigOrThrow();if(!o)throw new G(H.MissingPaymentMethod);this.braintreeSdk.initialize(o);const l=yield this.braintreeSdk.getBraintreeVisaCheckout(),c=yield this.braintreeSdk.getVisaCheckoutSdk(s.testMode),{container:u,onError:h}=t;this.onError=h||lodash__WEBPACK_IMPORTED_MODULE_2__.noop;const y=l.createInitOptions({paymentRequest:{currencyCode:d.currency.code,subtotal:String(r.subtotal)},settings:{locale:d.storeProfile.storeLanguage,shipping:{collectShipping:!0}}}),m=this.createSignInButton(u,this.buttonClassName);yield c.init(y),c.on(\"payment.success\",e=>this.tokenizePayment(l,e).then(()=>this.paymentIntegrationService.loadCheckout()).catch(e=>this.handleError(e))),c.on(\"payment.error\",(e,t)=>this.handleError(t)),m.style.visibility=\"visible\"})}deinitialize(){return Nt(this,void 0,void 0,function*(){yield this.braintreeSdk.deinitialize()})}signIn(){throw new zt('In order to sign in via VisaCheckout, the shopper must click on \"Visa Checkout\" button.')}signOut(e){return Nt(this,void 0,void 0,function*(){return yield this.paymentIntegrationService.signOutCustomer(e),Promise.resolve()})}executePaymentMethodCheckout(e){var t;return null===(t=null==e?void 0:e.continueWithCheckoutCallback)||void 0===t||t.call(e),Promise.resolve()}tokenizePayment(e,t){return Nt(this,void 0,void 0,function*(){return Promise.all([e.tokenize(t),this.braintreeSdk.getDataCollectorOrThrow()]).then(([e,t])=>{const i=this.paymentIntegrationService.getState(),n=i.getShippingAddress(),r=i.getBillingAddress(),{shippingAddress:o=this.mapToVisaCheckoutAddress(n),billingAddress:a=this.mapToVisaCheckoutAddress(r)}=e;return this.postForm(Object.assign(Object.assign({},e),{shippingAddress:o,billingAddress:a}),t)})})}postForm(e,t){const{userData:i,billingAddress:n,shippingAddress:r,details:o}=e,{userEmail:a}=i,{deviceData:s}=t;return this.formPoster.postForm(\"/checkout.php\",{payment_type:e.type,nonce:e.nonce,provider:\"braintreevisacheckout\",action:\"set_external_checkout\",device_data:s,card_information:JSON.stringify({type:o.cardType,number:o.lastTwo}),billing_address:JSON.stringify(this.getAddress(a,n)),shipping_address:JSON.stringify(this.getAddress(a,r))})}mapToVisaCheckoutAddress(e){return e?{firstName:e.firstName,lastName:e.lastName,phoneNumber:e.phone,streetAddress:e.address1,extendedAddress:e.address2,locality:e.city,region:e.stateOrProvinceCode,countryCode:e.countryCode,postalCode:e.postalCode}:{}}getAddress(e,t={}){return{email:e,first_name:t.firstName,last_name:t.lastName,phone_number:t.phoneNumber,address_line_1:t.streetAddress,address_line_2:t.extendedAddress,city:t.locality,state:t.region,country_code:t.countryCode,postal_code:t.postalCode}}createSignInButton(e,t){const i=document.querySelector(`#${e}`);if(!i)throw new Error(\"Unable to proceed because the provided container ID is not valid.\");return this.insertVisaCheckoutButton(i,t)}insertVisaCheckoutButton(e,t){const i=document.createElement(\"div\");return i.style.display=\"flex\",i.style.flexDirection=\"column\",i.style.visibility=\"hidden\",i.style.width=\"max-content\",i.className=t,i.innerHTML='\\n            <img\\n                alt=\"Visa Checkout\"\\n                class=\"v-button\"\\n                role=\"button\"\\n                src=\"https://secure.checkout.visa.com/wallet-services-web/xo/button.png?acceptCanadianVisaDebit=false&cobrand=true&height=34&width=178\"\\n                />\\n            <a class=\"v-learn v-learn-default\" style=\"text-align: right; display: block; font-size: 10px; color: #003366;\" href=\"#\" data-locale=\"en_US\">Tell Me More</a>',e.appendChild(i),i}handleError(e){if(\"function\"!=typeof this.onError)throw e;this.onError(e)}}const Mt=$(i=>{const n=window,r=new v(i),o=new ye(new q((0,_bigcommerce_script_loader__WEBPACK_IMPORTED_MODULE_1__.getScriptLoader)(),n,r));return new Dt(i,(0,_bigcommerce_form_poster__WEBPACK_IMPORTED_MODULE_0__.createFormPoster)(),o)},[{id:\"braintreevisacheckout\"}]);\n//# sourceMappingURL=braintree.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi4vY2hlY2tvdXQtc2RrLWpzL2Rpc3QvZXNtL2ludGVncmF0aW9ucy9icmFpbnRyZWUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNXLFNBQVMscUJBQXFCLE1BQU0sdUNBQXVDLFlBQVksK0RBQStELHVCQUF1QixFQUFFLHNEQUFzRCwwQ0FBMEMsUUFBUSxlQUFlLDZEQUE2RCxnQkFBZ0Isc0hBQXNILHFKQUFxSix5QkFBeUIsdUNBQXVDLE1BQU0sUUFBUSw0Q0FBQyxrQ0FBa0Msa0NBQWtDLHNCQUFzQixlQUFlLE1BQU0sdVRBQXVULGtCQUFrQixlQUFlLDJHQUEyRyxrQkFBa0IsZUFBZSxpSEFBaUgsa0JBQWtCLGVBQWUsK0VBQStFLFNBQVMsR0FBRyx5REFBeUQsYUFBYSxzREFBc0Qsa0JBQWtCLGlCQUFpQixtS0FBbUssTUFBTSxhQUFhLHlTQUF5UyxTQUFTLEdBQUcsa0JBQWtCLGVBQWUsa0JBQWtCLFVBQVUsd0hBQXdILHNIQUFzSCx3SEFBd0gsNkhBQTZILDRGQUE0RixpRkFBaUYsa0JBQWtCLGVBQWUsa0hBQWtILFFBQVEsZUFBZSw0QkFBNEIsY0FBYyxFQUFFLGtDQUFrQyxXQUFXLCtCQUErQixzQkFBc0IsY0FBYyxzRkFBc0YsYUFBYSxnREFBZ0QsU0FBUyxlQUFlLDRFQUE0RSxTQUFTLGVBQWUsOEVBQThFLFNBQVMsZUFBZSx3RkFBd0YsU0FBUyxlQUFlLDRCQUE0QixTQUFTLGVBQWUsd0VBQXdFLFNBQVMsZUFBZSw4Q0FBOEMsU0FBUyxlQUFlLG9VQUFvVSxTQUFTLGVBQWUsZ01BQWdNLFNBQVMsR0FBRyx3QkFBd0IseUNBQXlDLGNBQWMsSUFBSSxhQUFhLFNBQVMsTUFBTSxjQUFjLElBQUksY0FBYyxTQUFTLE1BQU0sY0FBYyxNQUFNLGdFQUFnRSxLQUFLLGFBQWEsK0JBQStCLEdBQUcsUUFBUSxtQkFBbUIsOEZBQThGLGdCQUFnQiw4Q0FBOEMsNEJBQTRCLHdDQUF3QywwSkFBMEosZ0pBQWdKLE1BQU0sdUNB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YyxTQUFTLE1BQU0sY0FBYyxNQUFNLGdFQUFnRSxLQUFLLGFBQWEsK0JBQStCLEdBQUcsU0FBUyxtQkFBbUIsaUlBQWlJLHdDQUFDLENBQUMsY0FBYyx5Q0FBeUMsTUFBTSxtQ0FBbUMsR0FBRyxvRkFBb0YseUdBQXlHLDBEQUEwRCw0RUFBNEUsdUJBQXVCLDBEQUEwRCwwQ0FBMEMsZ0NBQWdDLHFIQUFxSCxzQkFBc0IsR0FBRyxnQkFBZ0Isd0NBQUMsQ0FBQyw2QkFBNkIsZ0JBQWdCLHlEQUF5RCxXQUFXLDhDQUE4QyxxQkFBcUIsb0RBQW9ELHlPQUF5TyxFQUFFLGVBQWUseUNBQXlDLHVDQUF1QyxFQUFFLFNBQVMsd0dBQXdHLFdBQVcseUNBQXlDLGlGQUFpRixFQUFFLGdDQUFnQyxNQUFNLHlHQUF5RyxxQkFBcUIseUNBQXlDLCtGQUErRixvR0FBb0cscUdBQXFHLEdBQUcsbURBQW1ELEtBQUssbUNBQW1DLEtBQUssRUFBRSxFQUFFLGNBQWMsTUFBTSx3REFBd0QsSUFBSSxZQUFZLElBQUksYUFBYSxHQUFHLGlEQUFpRCxpSkFBaUosaUNBQWlDLDZHQUE2RyxFQUFFLDRCQUE0QixVQUFVLGlOQUFpTixJQUFJLGlCQUFpQixFQUFFLE9BQU8sbU9BQW1PLHdCQUF3QixtQ0FBbUMsRUFBRSxHQUFHLDJGQUEyRiwwQ0FBMEMsOEJBQThCLHNDQUFzQyxnZ0JBQWdnQixnQkFBZ0IsaUJBQWlCLGVBQWUsb0VBQW9FLGVBQWUsMkNBQTJDLGlCQUFpQixlQUFlLHlDQUF5QywyRUFBQyxTQUFTLGdCQUFnQiwwRUFBQyxNQUFNLEdBQUcsMkJBQTJCLEdBQXVyQjtBQUN6ejZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2hlY2tvdXQvLi4vY2hlY2tvdXQtc2RrLWpzL2Rpc3QvZXNtL2ludGVncmF0aW9ucy9icmFpbnRyZWUuanM/YjkzNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnR7Y3JlYXRlRm9ybVBvc3RlciBhcyBlfWZyb21cIkBiaWdjb21tZXJjZS9mb3JtLXBvc3RlclwiO2ltcG9ydHtnZXRTY3JpcHRMb2FkZXIgYXMgdH1mcm9tXCJAYmlnY29tbWVyY2Uvc2NyaXB0LWxvYWRlclwiO2ltcG9ydHtmaW5kIGFzIGksaXNFbXB0eSBhcyBuLGlzRXF1YWwgYXMgcixpc05pbCBhcyBvLG5vb3AgYXMgYSxvbWl0IGFzIHMsb21pdEJ5IGFzIGQsc29tZSBhcyBsfWZyb21cImxvZGFzaFwiO2ltcG9ydHtzdXBwb3J0c1BvcHVwcyBhcyBjfWZyb21cIkBicmFpbnRyZWUvYnJvd3Nlci1kZXRlY3Rpb25cIjtpbXBvcnR7Y3JlYXRlUmVxdWVzdFNlbmRlciBhcyB1fWZyb21cIkBiaWdjb21tZXJjZS9yZXF1ZXN0LXNlbmRlclwiO3ZhciBoPXt9O2Z1bmN0aW9uIHkoZSx0LGk9ITApe3ZhciBuO3JldHVybiBudWxsIT09KG49ZVt0XSkmJnZvaWQgMCE9PW4/bjppfWguZD0oZSx0KT0+e2Zvcih2YXIgaSBpbiB0KWgubyh0LGkpJiYhaC5vKGUsaSkmJk9iamVjdC5kZWZpbmVQcm9wZXJ0eShlLGkse2VudW1lcmFibGU6ITAsZ2V0OnRbaV19KX0saC5vPShlLHQpPT5PYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSx0KTtjb25zdCBtPVwiMy4xMjguMFwiLHA9XCIzLjEyMy4yXCIsZz1cIjMuMTA2LjBcIjtjbGFzcyB2e2NvbnN0cnVjdG9yKGUpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYnJhaW50cmVlV2luZG93PXdpbmRvd31nZXRTREtWZXJzaW9uKCl7Y29uc3QgZT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRTdG9yZUNvbmZpZygpLHQ9KG51bGw9PWU/dm9pZCAwOmUuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlcyl8fHt9O3JldHVybiB0aGlzLmdldFByZWxvYWRlZFNES1ZlcnNpb24oKXx8KHkodCxcIlBBWVBBTC01ODA5LmJyYWludHJlZV9ob3N0ZWRfZmllbGRzX2ZpeF92ZXJzaW9uXCIpP206eSh0LFwiUEFZUEFMLTU2MzYudXBkYXRlX2JyYWludHJlZV9zZGtfdmVyc2lvblwiKT9wOmcpfWdldFByZWxvYWRlZFNES1ZlcnNpb24oKXtjb25zdCBlPXRoaXMuYnJhaW50cmVlV2luZG93LmJyYWludHJlZTtpZihlKXtjb25zdCB0PWkoT2JqZWN0LnZhbHVlcyhlKSxlPT4hIWUuVkVSU0lPTik7cmV0dXJuIG51bGw9PXQ/dm9pZCAwOnQuVkVSU0lPTn19fWNsYXNzIGYgZXh0ZW5kcyBFcnJvcntjb25zdHJ1Y3RvcihlKXt2YXIgdDtzdXBlcihlfHxcIkFuIHVuZXhwZWN0ZWQgZXJyb3IgaGFzIG9jY3VycmVkLlwiKSx0aGlzLm5hbWU9XCJTdGFuZGFyZEVycm9yXCIsdGhpcy50eXBlPVwic3RhbmRhcmRcIix0PW5ldy50YXJnZXQucHJvdG90eXBlLE9iamVjdC5zZXRQcm90b3R5cGVPZj9PYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcyx0KTp0aGlzLl9fcHJvdG9fXz10LFwiZnVuY3Rpb25cIj09dHlwZW9mIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlP0Vycm9yLmNhcHR1cmVTdGFja1RyYWNlKHRoaXMsbmV3LnRhcmdldCk6dGhpcy5zdGFjaz1uZXcgRXJyb3IodGhpcy5tZXNzYWdlKS5zdGFja319Y2xhc3MgYiBleHRlbmRzIGZ7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJVbnN1cHBvcnRlZCBicm93c2VyIGVycm9yXCIpLHRoaXMubmFtZT1cIlVuc3VwcG9ydGVkQnJvd3NlckVycm9yXCIsdGhpcy50eXBlPVwidW5zdXBwb3J0ZWRfYnJvd3NlclwifX1jbGFzcyB3IGV4dGVuZHMgZntjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIkludmFsaWQgYXJndW1lbnRzIGhhdmUgYmVlbiBwcm92aWRlZC5cIiksdGhpcy5uYW1lPVwiSW52YWxpZEFyZ3VtZW50RXJyb3JcIix0aGlzLnR5cGU9XCJpbnZhbGlkX2FyZ3VtZW50XCJ9fWNsYXNzIEMgZXh0ZW5kcyB3e2NvbnN0cnVjdG9yKGUpe2xldCB0PVwiVW5hYmxlIHRvIHN1Ym1pdCBwYXltZW50IGZvciB0aGUgb3JkZXIgYmVjYXVzZSB0aGUgcGF5bG9hZCBpcyBpbnZhbGlkLlwiO2UmJih0PWAke3R9IE1ha2Ugc3VyZSB0aGUgZm9sbG93aW5nIGZpZWxkcyBhcmUgcHJvdmlkZWQgY29ycmVjdGx5OiAke2Uuam9pbihcIiwgXCIpfS5gKSxzdXBlcih0KSx0aGlzLm5hbWU9XCJQYXltZW50QXJndW1lbnRJbnZhbGlkRXJyb3JcIn19Y2xhc3MgUyBleHRlbmRzIGZ7Y29uc3RydWN0b3IoZSx0KXtzdXBlcih0fHxcIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHBheW1lbnQgZm9ybSBjb250YWlucyBpbnZhbGlkIGRhdGEuXCIpLHRoaXMuZGV0YWlscz1lLHRoaXMubmFtZT1cIlBheW1lbnRJbnZhbGlkRm9ybUVycm9yXCIsdGhpcy50eXBlPVwicGF5bWVudF9pbnZhbGlkX2Zvcm1cIn19dmFyIFA7IWZ1bmN0aW9uKGUpe2VbZS5DaGVja291dEJ1dHRvbk5vdEluaXRpYWxpemVkPTBdPVwiQ2hlY2tvdXRCdXR0b25Ob3RJbml0aWFsaXplZFwiLGVbZS5DdXN0b21lck5vdEluaXRpYWxpemVkPTFdPVwiQ3VzdG9tZXJOb3RJbml0aWFsaXplZFwiLGVbZS5QYXltZW50Tm90SW5pdGlhbGl6ZWQ9Ml09XCJQYXltZW50Tm90SW5pdGlhbGl6ZWRcIixlW2UuU2hpcHBpbmdOb3RJbml0aWFsaXplZD0zXT1cIlNoaXBwaW5nTm90SW5pdGlhbGl6ZWRcIixlW2UuU3BhbVByb3RlY3Rpb25Ob3RJbml0aWFsaXplZD00XT1cIlNwYW1Qcm90ZWN0aW9uTm90SW5pdGlhbGl6ZWRcIn0oUHx8KFA9e30pKTtjbGFzcyBJIGV4dGVuZHMgZntjb25zdHJ1Y3RvcihlKXtzdXBlcihmdW5jdGlvbihlKXtzd2l0Y2goZSl7Y2FzZSBQLkN1c3RvbWVyTm90SW5pdGlhbGl6ZWQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBjdXN0b21lciBzdGVwIG9mIGNoZWNrb3V0IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIjtjYXNlIFAuUGF5bWVudE5vdEluaXRpYWxpemVkOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgcGF5bWVudCBzdGVwIG9mIGNoZWNrb3V0IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIjtjYXNlIFAuU2hpcHBpbmdOb3RJbml0aWFsaXplZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHNoaXBwaW5nIHN0ZXAgb2YgY2hlY2tvdXQgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkLlwiO2Nhc2UgUC5TcGFtUHJvdGVjdGlvbk5vdEluaXRpYWxpemVkOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgY2hlY2tvdXQgc3BhbSBwcm90ZWN0aW9uIGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIjtkZWZhdWx0OnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgcmVxdWlyZWQgY29tcG9uZW50IGhhcyBub3QgYmVlbiBpbml0aWFsaXplZC5cIn19KGUpKSx0aGlzLnN1YnR5cGU9ZSx0aGlzLm5hbWU9XCJOb3RJbml0aWFsaXplZEVycm9yXCIsdGhpcy50eXBlPVwibm90X2luaXRpYWxpemVkXCJ9fWNsYXNzIE8gZXh0ZW5kcyBme2NvbnN0cnVjdG9yKGUpe3N1cGVyKGV8fFwiUGF5bWVudCBwcm9jZXNzIHdhcyBjYW5jZWxsZWQuXCIpLHRoaXMubmFtZT1cIlBheW1lbnRNZXRob2RDYW5jZWxsZWRFcnJvclwiLHRoaXMudHlwZT1cInBheW1lbnRfY2FuY2VsbGVkXCJ9fWNsYXNzIGt7Y29uc3RydWN0b3IoZSl7Y29uc3QgdD1uZXcgUHJvbWlzZSgoZSx0KT0+e3RoaXMuY2FuY2VsPXR9KTt0aGlzLnByb21pc2U9UHJvbWlzZS5yYWNlKFtlLHRdKX19bGV0IEU9bnVsbDtjb25zdCBUPVtcImJ1dHRvbnNcIixcIm1lc3NhZ2VzXCJdO3ZhciBBLHosTixELE0sXyxCLHgsRjtmdW5jdGlvbiBMKGUpe3JldHVybiBCb29sZWFuKFwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmKFwidHlwZVwiaW4gZXx8XCJtZXNzYWdlXCJpbiBlfHxcImNvZGVcImluIGUpKX0hZnVuY3Rpb24oZSl7ZS5IT1JJWk9OVEFMPVwiaG9yaXpvbnRhbFwiLGUuVkVSVElDQUw9XCJ2ZXJ0aWNhbFwifShBfHwoQT17fSkpLGZ1bmN0aW9uKGUpe2UuU01BTEw9XCJzbWFsbFwiLGUuTUVESVVNPVwibWVkaXVtXCIsZS5MQVJHRT1cImxhcmdlXCIsZS5SRVNQT05TSVZFPVwicmVzcG9uc2l2ZVwifSh6fHwoej17fSkpLGZ1bmN0aW9uKGUpe2UuR09MRD1cImdvbGRcIixlLkJMVUU9XCJibHVlXCIsZS5TSWxWRVI9XCJzaWx2ZXJcIixlLkJMQUNLPVwiYmxhY2tcIixlLldISVRFPVwid2hpdGVcIn0oTnx8KE49e30pKSxmdW5jdGlvbihlKXtlLkNIRUNLT1VUPVwiY2hlY2tvdXRcIixlLlBBWT1cInBheVwiLGUuQlVZTk9XPVwiYnV5bm93XCIsZS5QQVlQQUw9XCJwYXlwYWxcIixlLkNSRURJVD1cImNyZWRpdFwifShEfHwoRD17fSkpLGZ1bmN0aW9uKGUpe2UuUElMTD1cInBpbGxcIixlLlJFQ1Q9XCJyZWN0XCJ9KE18fChNPXt9KSksZnVuY3Rpb24oZSl7ZS5DQVJUPVwiY2FydFwiLGUuSE9NRT1cImhvbWVwYWdlXCIsZS5QQVlNRU5UPVwicGF5bWVudFwiLGUuUFJPRFVDVD1cInByb2R1Y3RcIn0oX3x8KF89e30pKSxmdW5jdGlvbihlKXtlLlNhbmRib3g9XCJzYW5kYm94XCIsZS5Qcm9kdWN0aW9uPVwicHJvZHVjdGlvblwifShCfHwoQj17fSkpLGZ1bmN0aW9uKGUpe2UuQ2xpZW50PVwiY2xpZW50XCIsZS5EYXRhQ29sbGVjdG9yPVwiZGF0YUNvbGxlY3RvclwiLGUuRmFzdGxhbmU9XCJmYXN0bGFuZVwiLGUuR29vZ2xlUGF5bWVudD1cImdvb2dsZVBheW1lbnRcIixlLkhvc3RlZEZpZWxkcz1cImhvc3RlZEZpZWxkc1wiLGUuTG9jYWxQYXltZW50PVwibG9jYWxQYXltZW50XCIsZS5QYXlwYWw9XCJwYXlwYWxcIixlLlBheXBhbENoZWNrb3V0PVwicGF5cGFsQ2hlY2tvdXRcIixlLlRocmVlRFNlY3VyZT1cInRocmVlRFNlY3VyZVwiLGUuVXNCYW5rQWNjb3VudD1cInVzQmFua0FjY291bnRcIixlLlZlbm1vPVwidmVubW9cIixlLlZpc2FDaGVja291dD1cInZpc2FDaGVja291dFwifSh4fHwoeD17fSkpLGZ1bmN0aW9uKGUpe2UuQ2FyZENvZGU9XCJjYXJkQ29kZVwiLGUuQ2FyZENvZGVWZXJpZmljYXRpb249XCJjYXJkQ29kZVZlcmlmaWNhdGlvblwiLGUuQ2FyZEV4cGlyeT1cImNhcmRFeHBpcnlcIixlLkNhcmROYW1lPVwiY2FyZE5hbWVcIixlLkNhcmROdW1iZXI9XCJjYXJkTnVtYmVyXCIsZS5DYXJkTnVtYmVyVmVyaWZpY2F0aW9uPVwiY2FyZE51bWJlclZlcmlmaWNhdGlvblwifShGfHwoRj17fSkpO3ZhciBWPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIGp7Y29uc3RydWN0b3IoZSx0LGkpe3RoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyPWUsdGhpcy5icmFpbnRyZWVIb3N0V2luZG93PXQsdGhpcy5vdmVybGF5PWksdGhpcy5kYXRhQ29sbGVjdG9ycz17fX1pbml0aWFsaXplKGUsdCl7dGhpcy5jbGllbnRUb2tlbj1lLHRoaXMudGhyZWVEU2VjdXJlT3B0aW9ucz10fWdldEJyYWludHJlZUZhc3RsYW5lKGUsdCxpKXtyZXR1cm4gVih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYodCYmKHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShcImF4b0VudlwiLFwic2FuZGJveFwiKSx3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJmYXN0bGFuZUVudlwiLFwic2FuZGJveFwiKSksIXRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5icmFpbnRyZWVGYXN0bGFuZSl7Y29uc3QgdD10aGlzLmdldENsaWVudFRva2VuT3JUaHJvdygpLG49eWllbGQgdGhpcy5nZXRDbGllbnQoKSxyPXlpZWxkIHRoaXMuZ2V0U2Vzc2lvbklkKGUpLG89eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZEZhc3RsYW5lKCksYT17cm9vdDp7YmFja2dyb3VuZENvbG9yUHJpbWFyeTpcInRyYW5zcGFyZW50XCJ9fTt0aGlzLmJyYWludHJlZUhvc3RXaW5kb3cuYnJhaW50cmVlRmFzdGxhbmU9eWllbGQgby5jcmVhdGUoe2F1dGhvcml6YXRpb246dCxjbGllbnQ6bixkZXZpY2VEYXRhOnIsc3R5bGVzOml8fGF9KX1yZXR1cm4gdGhpcy5icmFpbnRyZWVIb3N0V2luZG93LmJyYWludHJlZUZhc3RsYW5lfSl9Z2V0Q2xpZW50KCl7cmV0dXJuIFYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLmNsaWVudCl7Y29uc3QgZT10aGlzLmdldENsaWVudFRva2VuT3JUaHJvdygpLHQ9eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZENsaWVudCgpO3RoaXMuY2xpZW50PXQuY3JlYXRlKHthdXRob3JpemF0aW9uOmV9KX1yZXR1cm4gdGhpcy5jbGllbnR9KX1nZXRQYXlwYWwoKXtyZXR1cm4gdGhpcy5icmFpbnRyZWVQYXlwYWx8fCh0aGlzLmJyYWludHJlZVBheXBhbD1Qcm9taXNlLmFsbChbdGhpcy5nZXRDbGllbnQoKSx0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkUGF5cGFsKCldKS50aGVuKChbZSx0XSk9PnQuY3JlYXRlKHtjbGllbnQ6ZX0pKSksdGhpcy5icmFpbnRyZWVQYXlwYWx9cGF5cGFsKGUpe3ZhcntzaG91bGRTYXZlSW5zdHJ1bWVudDp0fT1lLGk9ZnVuY3Rpb24oZSx0KXt2YXIgaT17fTtmb3IodmFyIG4gaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxuKSYmdC5pbmRleE9mKG4pPDAmJihpW25dPWVbbl0pO2lmKG51bGwhPWUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPTA7Zm9yKG49T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtyPG4ubGVuZ3RoO3IrKyl0LmluZGV4T2YobltyXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsbltyXSkmJihpW25bcl1dPWVbbltyXV0pfXJldHVybiBpfShlLFtcInNob3VsZFNhdmVJbnN0cnVtZW50XCJdKTtjb25zdCBuPWMoKTtyZXR1cm4gdGhpcy5nZXRQYXlwYWwoKS50aGVuKGU9Pnt2YXIgcjtyZXR1cm4gbiYmKG51bGw9PT0ocj10aGlzLm92ZXJsYXkpfHx2b2lkIDA9PT1yfHxyLnNob3coe29uQ2xpY2s6KCk9PmUuZm9jdXNXaW5kb3coKX0pKSxlLnRva2VuaXplKE9iamVjdC5hc3NpZ24oe2VuYWJsZVNoaXBwaW5nQWRkcmVzczohMCxmbG93OnQ/XCJ2YXVsdFwiOlwiY2hlY2tvdXRcIix1c2VyYWN0aW9uOlwiY29tbWl0XCJ9LGkpKX0pLnRoZW4oZT0+e3ZhciB0O3JldHVybiBudWxsPT09KHQ9dGhpcy5vdmVybGF5KXx8dm9pZCAwPT09dHx8dC5yZW1vdmUoKSxlfSkuY2F0Y2goZT0+e3ZhciB0O3Rocm93IG51bGw9PT0odD10aGlzLm92ZXJsYXkpfHx2b2lkIDA9PT10fHx0LnJlbW92ZSgpLGV9KX1nZXRQYXlwYWxDaGVja291dChlLHQsaSl7cmV0dXJuIFYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IG49eWllbGQgdGhpcy5nZXRDbGllbnQoKSxyPXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRQYXlwYWxDaGVja291dCgpLG89e2NsaWVudDpufTtyZXR1cm4gdGhpcy5wYXlwYWxDaGVja291dD15aWVsZCByLmNyZWF0ZShvLChuLHIpPT57dmFyIG87aWYobilyZXR1cm4gaShuKTtjb25zdCBhPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7Y3VycmVuY3k6ZS5jdXJyZW5jeX0sZS5pc0NyZWRpdEVuYWJsZWQmJntcImVuYWJsZS1mdW5kaW5nXCI6XCJwYXlsYXRlclwifSkse2NvbXBvbmVudHM6VC50b1N0cmluZygpLGludGVudDplLmludGVudCxjb21taXQ6bnVsbD09PShvPWUuY29tbWl0KXx8dm9pZCAwPT09b3x8b30pO3RoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5wYXlwYWw/dChyKTpmdW5jdGlvbihlLHQpe3JldHVybiBFfHwoRT1uZXcgUHJvbWlzZSgoaSxuKT0+e2UubG9hZFBheVBhbFNESyh0LHQ9Pnt0PyhFPW51bGwsbih0KSk6aShlKX0pfSkpLEV9KHIsYSkudGhlbigoKT0+dChyKSl9KSx0aGlzLnBheXBhbENoZWNrb3V0fSl9Z2V0RGF0YUNvbGxlY3RvcihlKXtyZXR1cm4gVih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD0obnVsbD09ZT92b2lkIDA6ZS5wYXlwYWwpP1wicGF5cGFsXCI6XCJkZWZhdWx0XCI7bGV0IGk9dGhpcy5kYXRhQ29sbGVjdG9yc1t0XTtpZighaSl7dHJ5e2NvbnN0IHQ9eWllbGQgdGhpcy5nZXRDbGllbnQoKSxuPXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWREYXRhQ29sbGVjdG9yKCkscj1PYmplY3QuYXNzaWduKHtjbGllbnQ6dCxrb3VudDohMH0sZSk7aT15aWVsZCBuLmNyZWF0ZShyKX1jYXRjaChlKXtpZighTChlKXx8XCJEQVRBX0NPTExFQ1RPUl9LT1VOVF9OT1RfRU5BQkxFRFwiIT09ZS5jb2RlKXRocm93IGU7aT17ZGV2aWNlRGF0YTp2b2lkIDAsdGVhcmRvd246KCk9PlByb21pc2UucmVzb2x2ZSgpfX10aGlzLmRhdGFDb2xsZWN0b3JzW3RdPWl9cmV0dXJuIGl9KX1nZXRCcmFpbnRyZWVFbnYoZT0hMSl7cmV0dXJuIGU/Qi5TYW5kYm94OkIuUHJvZHVjdGlvbn1tYXBUb0JyYWludHJlZVNoaXBwaW5nQWRkcmVzc092ZXJyaWRlKGUpe3JldHVybntyZWNpcGllbnROYW1lOmAke2UuZmlyc3ROYW1lfSAke2UubGFzdE5hbWV9YCxsaW5lMTplLmFkZHJlc3MxLGxpbmUyOmUuYWRkcmVzczIsY2l0eTplLmNpdHksc3RhdGU6ZS5zdGF0ZU9yUHJvdmluY2VDb2RlLHBvc3RhbENvZGU6ZS5wb3N0YWxDb2RlLGNvdW50cnlDb2RlOmUuY291bnRyeUNvZGUscGhvbmU6ZS5waG9uZX19bWFwVG9MZWdhY3lTaGlwcGluZ0FkZHJlc3MoZSl7Y29uc3R7ZW1haWw6dCxwaG9uZTppLHNoaXBwaW5nQWRkcmVzczpufT1lLHI9KG51bGw9PW4/dm9pZCAwOm4ucmVjaXBpZW50TmFtZSl8fFwiXCIsW28sYV09ci5zcGxpdChcIiBcIik7cmV0dXJue2VtYWlsOnQsZmlyc3RfbmFtZTpvfHxcIlwiLGxhc3RfbmFtZTphfHxcIlwiLHBob25lX251bWJlcjppLGFkZHJlc3NfbGluZV8xOm51bGw9PW4/dm9pZCAwOm4ubGluZTEsYWRkcmVzc19saW5lXzI6bnVsbD09bj92b2lkIDA6bi5saW5lMixjaXR5Om51bGw9PW4/dm9pZCAwOm4uY2l0eSxzdGF0ZTpudWxsPT1uP3ZvaWQgMDpuLnN0YXRlLGNvdW50cnlfY29kZTpudWxsPT1uP3ZvaWQgMDpuLmNvdW50cnlDb2RlLHBvc3RhbF9jb2RlOm51bGw9PW4/dm9pZCAwOm4ucG9zdGFsQ29kZX19bWFwVG9MZWdhY3lCaWxsaW5nQWRkcmVzcyhlKXtjb25zdHtiaWxsaW5nQWRkcmVzczp0LGVtYWlsOmksZmlyc3ROYW1lOm4sbGFzdE5hbWU6cixwaG9uZTpvLHNoaXBwaW5nQWRkcmVzczphfT1lLHM9dHx8YTtyZXR1cm57ZW1haWw6aSxmaXJzdF9uYW1lOm4sbGFzdF9uYW1lOnIscGhvbmVfbnVtYmVyOm8sYWRkcmVzc19saW5lXzE6bnVsbD09cz92b2lkIDA6cy5saW5lMSxhZGRyZXNzX2xpbmVfMjpudWxsPT1zP3ZvaWQgMDpzLmxpbmUyLGNpdHk6bnVsbD09cz92b2lkIDA6cy5jaXR5LHN0YXRlOm51bGw9PXM/dm9pZCAwOnMuc3RhdGUsY291bnRyeV9jb2RlOm51bGw9PXM/dm9pZCAwOnMuY291bnRyeUNvZGUscG9zdGFsX2NvZGU6bnVsbD09cz92b2lkIDA6cy5wb3N0YWxDb2RlfX1yZW1vdmVFbGVtZW50KGUpe2NvbnN0IHQ9ZSYmZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSk7dCYmdC5yZW1vdmUoKX1nZXRTZXNzaW9uSWQoZSl7cmV0dXJuIFYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2RldmljZURhdGE6dH09eWllbGQgdGhpcy5nZXREYXRhQ29sbGVjdG9yKHtyaXNrQ29ycmVsYXRpb25JZDplfSk7cmV0dXJuIHR9KX10ZWFyZG93bigpe3JldHVybiBWKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnRlYXJkb3duTW9kdWxlKHRoaXMuZGF0YUNvbGxlY3RvcnMuZGVmYXVsdCkseWllbGQgdGhpcy50ZWFyZG93bk1vZHVsZSh0aGlzLmRhdGFDb2xsZWN0b3JzLnBheXBhbCksdGhpcy5kYXRhQ29sbGVjdG9ycz17fSx5aWVsZCB0aGlzLnRlYXJkb3duTW9kdWxlKHRoaXMucGF5cGFsQ2hlY2tvdXQpLHRoaXMucGF5cGFsQ2hlY2tvdXQ9dm9pZCAwfSl9Z2V0M0RTKCl7cmV0dXJuIFYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLnRocmVlRFN8fCh0aGlzLnRocmVlRFM9UHJvbWlzZS5hbGwoW3RoaXMuZ2V0Q2xpZW50KCksdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZDNEUygpXSkudGhlbigoW2UsdF0pPT50LmNyZWF0ZSh7Y2xpZW50OmUsdmVyc2lvbjoyfSkpKSx0aGlzLnRocmVlRFN9KX1nZXRWZW5tb0NoZWNrb3V0KGUpe3JldHVybiBWKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy52ZW5tb0NoZWNrb3V0KXtjb25zdCB0PXlpZWxkIHRoaXMuZ2V0Q2xpZW50KCksaT15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkVmVubW9DaGVja291dCgpLG49T2JqZWN0LmFzc2lnbih7Y2xpZW50OnQsYWxsb3dEZXNrdG9wOiEwLHBheW1lbnRNZXRob2RVc2FnZTpcIm11bHRpX3VzZVwifSxlfHx7fSk7dGhpcy52ZW5tb0NoZWNrb3V0PXlpZWxkIG5ldyBQcm9taXNlKChlLHQpPT57aS5jcmVhdGUobiwoaSxuKT0+aT90KGkpOm4uaXNCcm93c2VyU3VwcG9ydGVkKCk/dm9pZCBlKG4pOnQobmV3IGIpKX0pfXJldHVybiB0aGlzLnZlbm1vQ2hlY2tvdXR9KX12ZXJpZnlDYXJkKGUsdCxpKXtyZXR1cm4gVih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgbj15aWVsZCB0aGlzLnRva2VuaXplQ2FyZChlLHQpO3JldHVybiB0aGlzLmNoYWxsZW5nZTNEU1ZlcmlmaWNhdGlvbihuLGkpfSl9dG9rZW5pemVDYXJkKGUsdCl7cmV0dXJuIFYodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnREYXRhOml9PWU7aWYoIWZ1bmN0aW9uKGUpe2lmKFwib2JqZWN0XCIhPXR5cGVvZiBlfHxudWxsPT09ZSlyZXR1cm4hMTtjb25zdCB0PWU7cmV0dXJuXCJvYmplY3RcIj09dHlwZW9mIHQuY2NFeHBpcnkmJm51bGwhPT10LmNjRXhwaXJ5JiZcInN0cmluZ1wiPT10eXBlb2YgdC5jY051bWJlciYmXCJzdHJpbmdcIj09dHlwZW9mIHQuY2NOYW1lfShpKSl0aHJvdyBuZXcgQyhbXCJwYXltZW50LnBheW1lbnREYXRhXCJdKTtjb25zdCByPXRoaXMuZ2V0RXJyb3JzUmVxdWlyZWRGaWVsZHMoaSk7aWYoIW4ocikpdGhyb3cgbmV3IFMocik7Y29uc3Qgbz10aGlzLm1hcFRvQ3JlZGl0Q2FyZChpLHQpLGE9eWllbGQgdGhpcy5nZXRDbGllbnQoKSx7Y3JlZGl0Q2FyZHM6c309eWllbGQgYS5yZXF1ZXN0KG8pO3JldHVybntub25jZTpzWzBdLm5vbmNlLGJpbjpzWzBdLmRldGFpbHMuYmlufX0pfWNoYWxsZW5nZTNEU1ZlcmlmaWNhdGlvbihlLHQpe3JldHVybiBWKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPXlpZWxkIHRoaXMuZ2V0M0RTKCk7cmV0dXJuIHRoaXMucHJlc2VudDNEU0NoYWxsZW5nZShpLHQsZSl9KX10ZWFyZG93bk1vZHVsZShlKXtyZXR1cm4gZT9lLnRlYXJkb3duKCk6UHJvbWlzZS5yZXNvbHZlKCl9Z2V0Q2xpZW50VG9rZW5PclRocm93KCl7aWYoIXRoaXMuY2xpZW50VG9rZW4pdGhyb3cgbmV3IEkoUC5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO3JldHVybiB0aGlzLmNsaWVudFRva2VufWdldEVycm9yc1JlcXVpcmVkRmllbGRzKGUpe2NvbnN0e2NjTnVtYmVyOnQsY2NFeHBpcnk6aX09ZSxuPXt9O3JldHVybiB0fHwobi5jY051bWJlcj1be21lc3NhZ2U6XCJDcmVkaXQgY2FyZCBudW1iZXIgaXMgcmVxdWlyZWRcIix0eXBlOlwicmVxdWlyZWRcIn1dKSxpfHwobi5jY0V4cGlyeT1be21lc3NhZ2U6XCJFeHBpcmF0aW9uIGRhdGUgaXMgcmVxdWlyZWRcIix0eXBlOlwicmVxdWlyZWRcIn1dKSxufW1hcFRvQ3JlZGl0Q2FyZChlLHQpe3JldHVybntkYXRhOntjcmVkaXRDYXJkOntjYXJkaG9sZGVyTmFtZTplLmNjTmFtZSxudW1iZXI6ZS5jY051bWJlcixjdnY6ZS5jY0N2dixleHBpcmF0aW9uRGF0ZTpgJHtlLmNjRXhwaXJ5Lm1vbnRofS8ke2UuY2NFeHBpcnkueWVhcn1gLG9wdGlvbnM6e3ZhbGlkYXRlOiExfSxiaWxsaW5nQWRkcmVzczp0JiZ7Y291bnRyeUNvZGVBbHBoYTI6dC5jb3VudHJ5Q29kZSxsb2NhbGl0eTp0LmNpdHksY291bnRyeU5hbWU6dC5jb3VudHJ5LHBvc3RhbENvZGU6dC5wb3N0YWxDb2RlLHN0cmVldEFkZHJlc3M6dC5hZGRyZXNzMj9gJHt0LmFkZHJlc3MxfSAke3QuYWRkcmVzczJ9YDp0LmFkZHJlc3MxfX19LGVuZHBvaW50OlwicGF5bWVudF9tZXRob2RzL2NyZWRpdF9jYXJkc1wiLG1ldGhvZDpcInBvc3RcIn19cHJlc2VudDNEU0NoYWxsZW5nZShlLHQsaSl7Y29uc3R7bm9uY2U6bixiaW46cn09aTtpZighdGhpcy50aHJlZURTZWN1cmVPcHRpb25zfHwhbil0aHJvdyBuZXcgSShQLlBheW1lbnROb3RJbml0aWFsaXplZCk7Y29uc3R7YWRkRnJhbWU6byxyZW1vdmVGcmFtZTphLGNoYWxsZW5nZVJlcXVlc3RlZDpzPSEwLGFkZGl0aW9uYWxJbmZvcm1hdGlvbjpkfT10aGlzLnRocmVlRFNlY3VyZU9wdGlvbnMsbD0oKT0+Vih0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD15aWVsZCBlLmNhbmNlbFZlcmlmeUNhcmQoKTtyZXR1cm4gdS5jYW5jZWwobmV3IE8pLHR9KSxjPXQudG9GaXhlZCgyKSx1PW5ldyBrKGUudmVyaWZ5Q2FyZCh7YWRkRnJhbWU6KGUsdCk9PntvJiZvKGUsdCxsKX0sYW1vdW50Ok51bWJlcihjKSxiaW46cixjaGFsbGVuZ2VSZXF1ZXN0ZWQ6cyxub25jZTpuLHJlbW92ZUZyYW1lOmEsb25Mb29rdXBDb21wbGV0ZTooZSx0KT0+e3QoKX0sY29sbGVjdERldmljZURhdGE6ITAsYWRkaXRpb25hbEluZm9ybWF0aW9uOmR9KSk7cmV0dXJuIHUucHJvbWlzZX19Y2xhc3MgVSBleHRlbmRzIGZ7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSBjbGllbnQgbGlicmFyeSBvZiBhIHBheW1lbnQgbWV0aG9kIGlzIG5vdCBsb2FkZWQgb3IgcmVhZHkgdG8gYmUgdXNlZC5cIiksdGhpcy5uYW1lPVwiUGF5bWVudE1ldGhvZENsaWVudFVuYXZhaWxhYmxlRXJyb3JcIix0aGlzLnR5cGU9XCJwYXltZW50X21ldGhvZF9jbGllbnRfdW5hdmFpbGFibGVcIn19Y29uc3QgUj17W2ddOntbeC5DbGllbnRdOlwic2hhMzg0LTI2QlhETm5KSTIzSllSeUZCajR4ZTRzVk5yVVNTaVNTdTExa3hWWE5NL3ZFUE9ObTRMdUwwMHc2WmFUZ1Fld3RcIixbeC5QYXlwYWxDaGVja291dF06XCJzaGEzODQtQit2emJad25RdHpXQnRocGtUNFRYS1VpYk82NXR5ZUs3ZUN4U3ZwYmxncHJUZXAyK0lBWEIyQ3h4anJuNzEwT1wiLFt4LlBheXBhbF06XCJzaGEzODQtdXlBR0wxLzMrWEpBSG5Hb055NGVDb1hkeko0ZjdJbHpwKzZ3OVBObkVqczZEQ0N6OVdNeUpqTU4xZ3pjNzhVK1wiLFt4LkxvY2FsUGF5bWVudF06XCJzaGEzODQtTEl2T0VNa0lWRXdWdVlCZFZPUWMxQUM1WWJHR2x3eWZVaGVTMEFDSzIxOEQyU1R1VllRbFo0RnlFUG93QUVmVFwiLFt4LkRhdGFDb2xsZWN0b3JdOlwic2hhMzg0LTFibzlKRHorS3NjdGhjMDg1Y0NLV3VyOENMd1VvQnBvTnl4c0RpNzkzMm1DbDB6RnEzQTVtditGUUx3OUdIcFZcIixbeC5Vc0JhbmtBY2NvdW50XTpcInNoYTM4NC14bUhCVmFVK3c3NFYrT2ViRDNBYVBPTkZ4SFVHTWYrUVJzOEcvSnhWUFhOTlA3TURhMmpMMElDV0hJZTJ0VGZKXCIsW3guR29vZ2xlUGF5bWVudF06XCJzaGEzODQtV0tESmw4bXFvUDgycVpwTUdINkFiWnhudlhuU1c4SUxWNE02NEN5TUxpdWdHTXd1N0x5UDg5d2pDa0hxc2lCZVwiLFt4LlRocmVlRFNlY3VyZV06XCJzaGEzODQtVlFVbHBHSHpzR3ZzNVhlaUdGaXA3RVhSc3ZvSFdFWERWbWdDYWNmYnlpZVpJOW1kQk9xcTNOU295bzI4T0NPQlwiLFt4LlZpc2FDaGVja291dF06XCJzaGEzODQteXg3bUFEZnpUTjBUNDNRNnJsSDQ5TElnMUVKMGlVWmdCcC9FY3pYOUxYc1VHa3lTZ3hyRCtuV0hRUkJreWZvVFwiLFt4LlZlbm1vXTpcInNoYTM4NC1RWDRyUGpvajFaRGh1RzBhU3lLczU2bEVLRHFUTVRjall4VUhZMVN6TzVWWkRzcUlFMk5Ua3FvdDdLTlNDeW92XCIsW3guSG9zdGVkRmllbGRzXTpcInNoYTM4NC1WdllCQUNmU3UwQ3IvSjMydUtteEc3QVhjTk9KRTFBeklJTDNrYmlreVM3WUtwNWZ6NUlzK056TlAvbHlhdU55XCIsW3guRmFzdGxhbmVdOlwic2hhMzg0LTlvR3NaTVJad3BHdERFRFlhL2RGdDc2ZEVDcWoxeEFuaTlnSUtnYzNLZk1JaVJuUjczbkVlZVVETGlCenhoRmFcIn0sW3BdOntbeC5DbGllbnRdOlwic2hhMzg0LW8rbmJRR2N3Tk54SUJlWGV1MytYbWJTcStDZzhSM0VOM04wbDVoWENnTU1VMlJHWTB0MXowTHJvU0VJQWJmQU9cIixbeC5QYXlwYWxDaGVja291dF06XCJzaGEzODQtV3JmYldQQlM0bUg4NkdBb3ljUFNnaUg4aFE4S0g3QTY3QzkzSGpodW52L3hoTmsyWXBCbjN3YkZBNEZoZzlVL1wiLFt4LlBheXBhbF06XCJzaGEzODQtVkYzODludnZyUlVnRHNUWE14VFlPUkR0VmVnQjlJUWEzQ3hyLy9EeUpuTFluejgvWDhWQ3pFdmNrMmMrTWVndFwiLFt4LkxvY2FsUGF5bWVudF06XCJzaGEzODQtdFpLeDJyRVFiZm1acG9QU1k1VlBtSkVoYXE0WDc1ZEx2d0hNczNWRTlVK0M4bFB5dytoV1RJTDErR1B2V0NJSFwiLFt4LkRhdGFDb2xsZWN0b3JdOlwic2hhMzg0LUU2azN3T3BQN3N5Q0REd2FSRExGMDY5NDJZMDBOa2J3SnZXaTJPUVh3d0t6R3dHNWZkM0U3UkZVdkNDZWNmdk9cIixbeC5Vc0JhbmtBY2NvdW50XTpcInNoYTM4NC0yNThGT044TFpHRzBXOVFhejRKaWo4M3BaSHUzMFluS2pKQTdnTnVsTEJoNkNjbGt1Y2dGK3RIRFF1WUZSWWZXXCIsW3guR29vZ2xlUGF5bWVudF06XCJzaGEzODQtdGFKMnAvMCtuMFZIMzI4UE9Bb0JpdUViTDN0bkhVVEU5UzQyaEsxVitUeHMzWCtRWWpaT3lLVzM1SmdIUkZmT1wiLFt4LlRocmVlRFNlY3VyZV06XCJzaGEzODQtK05TWkg0Wmozc081YmRXdlBLaFU1TjE2UUR4ZXVlVFZUblVWZWxlZUVTa2hMU2F6NE9iMWhoLzVteWVjYzlZbVwiLFt4LlZpc2FDaGVja291dF06XCJzaGEzODQtNjZEaUJqZ2h4azFPbUJqOGFrc044Z2JRK0N3b1FjeDF2UGZpWFVOMDhnMWlRVk0rQndld0YwcDd0b00zaTdTU1wiLFt4LlZlbm1vXTpcInNoYTM4NC1CNVV3WTQya0U0Um9Mb1diUTdZcHFvc1VsVWFkMi9EbEdXaXcwSGhvWmJTUGszMENRQWFTQTEwb2h5TERUa0RVXCIsW3guSG9zdGVkRmllbGRzXTpcInNoYTM4NC1BdzlFZXNTYVVlV3hlMzZQcUVIaU95T3lPcThNNkNJYjFndzcveUhOVlBSekd0RlhYY2QyT1E4cVhySWxPajJQXCIsW3guRmFzdGxhbmVdOlwic2hhMzg0LXJoQkwxaHBaNzFKcUcrMlRzVDBEaWg0N21iang4Y2pKQ3BlWmprOXR3M2RmMWdGTUtmQ1RtTXladW5ocjdINFlcIn0sW21dOntbeC5DbGllbnRdOlwic2hhMzg0LTBXTnhrc0lwUlArZllaaUlkcjEyZzZEQlVRZkxEellDUUpadFIvQzhLa2N3U0doUEhmY0ZwM3RUYUdjTXlGVHFcIixbeC5QYXlwYWxDaGVja291dF06XCJzaGEzODQtbFdNMWprNEJPeG9ETlY2S29wN3RWTnZRZ0lObG1FVnowYy9Pd00rSE5ISzNRQzh4cXdkNTRPdnJ0MlFSRFRqaFwiLFt4LlBheXBhbF06XCJzaGEzODQtZlhVbVZ4QzJFTVpCRFhaN2VUSFNUTC9MRkJySGVqL01TWFQvdlRCWHZyYTRsemdMTkd2UkVBcCt4MEdZT2J1SFwiLFt4LkxvY2FsUGF5bWVudF06XCJzaGEzODQtcGhhMXhHdUdTa21aSDV4OWFxSHZSYU80eExlYTdybVEvNzlQRmo5enhOenh1RmNPV1pnN2dPUDdGaWJ5Z09FQ1wiLFt4LkRhdGFDb2xsZWN0b3JdOlwic2hhMzg0LVE2UEkyRjllZWtXYkF4aHJveWJsK2FFY3ZxaGRvd04vRVFsR3dCVXlKT3pQRm45OTgydTl4bDZTVTZYZkdLemNcIixbeC5Vc0JhbmtBY2NvdW50XTpcInNoYTM4NC1XM1JMUVNLSkwxdFEzK1k3bVA2dG1rYW10WjhiVjRZdy9YeEw5Smo1SnRYSHJhRDhsb01GOGhBSUc1bTJ6SzdGXCIsW3guR29vZ2xlUGF5bWVudF06XCJzaGEzODQtVElUUU1zRldBM2VsRE5HUDJtV3oyb0tCbzRxanQrVGxxem92Y2FQb2VCaUFoL3dQQmk2bmFlNTBBRGRnVTEvaVwiLFt4LlRocmVlRFNlY3VyZV06XCJzaGEzODQtWWl5Y1lOODlabEwvRXZjYXE0eTFhalcxbWhkN0pZZlpCRHVPd0h0SW40L0pubTIwR0wrL1hDTSt6WUF3V0Q4RFwiLFt4LlZpc2FDaGVja291dF06XCJzaGEzODQtL09kYVR2OXFya0t6ak9idFVlNnl6ZkRoSG96RlcvK3VYbHJTbDczNnNPWlJKcGpHUUVUdnBZWHFNRkZnNjl4dlwiLFt4LlZlbm1vXTpcInNoYTM4NC1kQStvamRXOXZiSlM0SmF2Y1h5T3M5ZDV1WkhKZzVkTnRZdXBvUFNIMnpzWElpWURWUzVhbUxiL3U4cW1RNm96XCIsW3guSG9zdGVkRmllbGRzXTpcInNoYTM4NC0zMVprUzU4K2lhV3NXMDZmdFc1Mnp6VlpGcDQzV1BkN3BOWVJpZGRZeW5TTmc2T2g3V0diU0ZHb3JBVUg2VDF6XCIsW3guRmFzdGxhbmVdOlwic2hhMzg0LWpsYnJ3TnZMM0h2TEFVQ3RMU21yblEyR0gxdWRDVXJSUy9iVm1SZUFTNWZ1SVZ2Y1c4UGtvL0drZzgydGxndHJcIn19O3ZhciBILFc9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgcXtjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5zY3JpcHRMb2FkZXI9ZSx0aGlzLmJyYWludHJlZUhvc3RXaW5kb3c9dCx0aGlzLmJyYWludHJlZVNES1ZlcnNpb25NYW5hZ2VyPWl9bG9hZENsaWVudCgpe3JldHVybiBXKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyh4LkNsaWVudCxcImNsaWVudC5taW4uanNcIil9KX1sb2FkRmFzdGxhbmUoKXtyZXR1cm4gVyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coeC5GYXN0bGFuZSxcImZhc3RsYW5lLm1pbi5qc1wiKX0pfWxvYWRQYXlwYWxDaGVja291dCgpe3JldHVybiBXKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyh4LlBheXBhbENoZWNrb3V0LFwicGF5cGFsLWNoZWNrb3V0Lm1pbi5qc1wiKX0pfWxvYWRQYXlwYWwoKXtyZXR1cm4gVyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coeC5QYXlwYWwsXCJwYXlwYWwubWluLmpzXCIpfSl9bG9hZExvY2FsUGF5bWVudCgpe3JldHVybiBXKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyh4LkxvY2FsUGF5bWVudCxcImxvY2FsLXBheW1lbnQubWluLmpzXCIpfSl9bG9hZERhdGFDb2xsZWN0b3IoKXtyZXR1cm4gVyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coeC5EYXRhQ29sbGVjdG9yLFwiZGF0YS1jb2xsZWN0b3IubWluLmpzXCIpfSl9bG9hZFVzQmFua0FjY291bnQoKXtyZXR1cm4gVyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coeC5Vc0JhbmtBY2NvdW50LFwidXMtYmFuay1hY2NvdW50Lm1pbi5qc1wiKX0pfWxvYWRHb29nbGVQYXltZW50KCl7cmV0dXJuIFcodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHguR29vZ2xlUGF5bWVudCxcImdvb2dsZS1wYXltZW50Lm1pbi5qc1wiKX0pfWxvYWQzRFMoKXtyZXR1cm4gVyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coeC5UaHJlZURTZWN1cmUsXCJ0aHJlZS1kLXNlY3VyZS5taW4uanNcIil9KX1sb2FkVmlzYUNoZWNrb3V0KCl7cmV0dXJuIHRoaXMubG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coeC5WaXNhQ2hlY2tvdXQsXCJ2aXNhLWNoZWNrb3V0Lm1pbi5qc1wiKX1sb2FkVmVubW9DaGVja291dCgpe3JldHVybiB0aGlzLmxvYWRCcmFpbnRyZWVNb2R1bGVPclRocm93KHguVmVubW8sXCJ2ZW5tby5taW4uanNcIil9bG9hZEhvc3RlZEZpZWxkcygpe3JldHVybiBXKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy5sb2FkQnJhaW50cmVlTW9kdWxlT3JUaHJvdyh4Lkhvc3RlZEZpZWxkcyxcImhvc3RlZC1maWVsZHMubWluLmpzXCIpfSl9bG9hZFZpc2FDaGVja291dFNkayhlKXtyZXR1cm4gVyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYodGhpcy5icmFpbnRyZWVIb3N0V2luZG93LlYpcmV0dXJuIHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5WO2NvbnN0IHQ9ZT9cInNoYTM4NC0wZXUxczFHdHF6WGxMOUR0TGdtd3pDNVdXbEVIL0FEUk0wbjM4Y1ZRa3Z0VCtXL2dleTk2cmNiMUx3dVVPUERtXCI6XCJzaGEzODQtMWYxY3N2UDNaRnhnNGRJTEgxR2FZNExIbFowb1g3Ums4M3J4bUxsd2JuSWk0VE0wTll6WG9ldjFWb0VpVkRTNlwiO3JldHVybiB0aGlzLnNjcmlwdExvYWRlci5sb2FkU2NyaXB0KGAvLyR7ZT9cInNhbmRib3gtXCI6XCJcIn1hc3NldHMuc2VjdXJlLmNoZWNrb3V0LnZpc2EuY29tL2NoZWNrb3V0LXdpZGdldC9yZXNvdXJjZXMvanMvaW50ZWdyYXRpb24vdjEvc2RrLmpzYCx7YXN5bmM6ITAsYXR0cmlidXRlczp7aW50ZWdyaXR5OnQsY3Jvc3NvcmlnaW46XCJhbm9ueW1vdXNcIn19KS50aGVuKCgpPT57aWYoIXRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5WKXRocm93IG5ldyBVO3JldHVybiB0aGlzLmJyYWludHJlZUhvc3RXaW5kb3cuVn0pfSl9bG9hZEJyYWludHJlZU1vZHVsZU9yVGhyb3coZSx0KXtyZXR1cm4gVyh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7bGV0IGk9dGhpcy5nZXRCcmFpbnRyZWVNb2R1bGUoZSk7aWYoaSlyZXR1cm4gaTtjb25zdCBuPXRoaXMuYnJhaW50cmVlU0RLVmVyc2lvbk1hbmFnZXIuZ2V0U0RLVmVyc2lvbigpLHI9YC8vanMuYnJhaW50cmVlZ2F0ZXdheS5jb20vd2ViLyR7bn0vanMvJHt0fWAsbz1uIGluIFI/dGhpcy5nZXRJbnRlZ3JpdHlWYWx1ZXNCeU1vZHVsZU5hbWUoZSxuKTp2b2lkIDA7aWYoeWllbGQgdGhpcy5zY3JpcHRMb2FkZXIubG9hZFNjcmlwdChyLG8/e2FzeW5jOiEwLGF0dHJpYnV0ZXM6e2ludGVncml0eTpvLGNyb3Nzb3JpZ2luOlwiYW5vbnltb3VzXCJ9fTp2b2lkIDApLGk9dGhpcy5nZXRCcmFpbnRyZWVNb2R1bGUoZSksIWkpdGhyb3cgbmV3IFU7cmV0dXJuIGl9KX1nZXRCcmFpbnRyZWVNb2R1bGUoZSl7dmFyIHQ7cmV0dXJuIG51bGw9PT0odD10aGlzLmJyYWludHJlZUhvc3RXaW5kb3cuYnJhaW50cmVlKXx8dm9pZCAwPT09dD92b2lkIDA6dFtlXX1nZXRJbnRlZ3JpdHlWYWx1ZXNCeU1vZHVsZU5hbWUoZSx0KXtjb25zdCBpPVJbdF1bZV07aWYoIWkpdGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCBmaWxlTmFtZSB2YWx1ZVwiKTtyZXR1cm4gaX19ZnVuY3Rpb24gJChlLHQpe3JldHVybiBPYmplY3QuYXNzaWduKGUse3Jlc29sdmVJZHM6dH0pfSFmdW5jdGlvbihlKXtlW2UuTWlzc2luZ0JpbGxpbmdBZGRyZXNzPTBdPVwiTWlzc2luZ0JpbGxpbmdBZGRyZXNzXCIsZVtlLk1pc3NpbmdDYXJ0PTFdPVwiTWlzc2luZ0NhcnRcIixlW2UuTWlzc2luZ0NoZWNrb3V0PTJdPVwiTWlzc2luZ0NoZWNrb3V0XCIsZVtlLk1pc3NpbmdDb25zaWdubWVudHM9M109XCJNaXNzaW5nQ29uc2lnbm1lbnRzXCIsZVtlLk1pc3NpbmdDdXN0b21lcj00XT1cIk1pc3NpbmdDdXN0b21lclwiLGVbZS5NaXNzaW5nQ2hlY2tvdXRDb25maWc9NV09XCJNaXNzaW5nQ2hlY2tvdXRDb25maWdcIixlW2UuTWlzc2luZ09yZGVyPTZdPVwiTWlzc2luZ09yZGVyXCIsZVtlLk1pc3NpbmdPcmRlckNvbmZpZz03XT1cIk1pc3NpbmdPcmRlckNvbmZpZ1wiLGVbZS5NaXNzaW5nT3JkZXJJZD04XT1cIk1pc3NpbmdPcmRlcklkXCIsZVtlLk1pc3NpbmdQYXltZW50PTldPVwiTWlzc2luZ1BheW1lbnRcIixlW2UuTWlzc2luZ1BheW1lbnRJZD0xMF09XCJNaXNzaW5nUGF5bWVudElkXCIsZVtlLk1pc3NpbmdQYXltZW50SW5zdHJ1bWVudD0xMV09XCJNaXNzaW5nUGF5bWVudEluc3RydW1lbnRcIixlW2UuTWlzc2luZ1BheW1lbnRNZXRob2Q9MTJdPVwiTWlzc2luZ1BheW1lbnRNZXRob2RcIixlW2UuTWlzc2luZ1BheW1lbnRSZWRpcmVjdFVybD0xM109XCJNaXNzaW5nUGF5bWVudFJlZGlyZWN0VXJsXCIsZVtlLk1pc3NpbmdQYXltZW50U3RhdHVzPTE0XT1cIk1pc3NpbmdQYXltZW50U3RhdHVzXCIsZVtlLk1pc3NpbmdQYXltZW50VG9rZW49MTVdPVwiTWlzc2luZ1BheW1lbnRUb2tlblwiLGVbZS5NaXNzaW5nU2hpcHBpbmdBZGRyZXNzPTE2XT1cIk1pc3NpbmdTaGlwcGluZ0FkZHJlc3NcIn0oSHx8KEg9e30pKTtjbGFzcyBHIGV4dGVuZHMgZntjb25zdHJ1Y3RvcihlKXtzdXBlcihmdW5jdGlvbihlKXtzd2l0Y2goZSl7Y2FzZSBILk1pc3NpbmdCaWxsaW5nQWRkcmVzczpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgYmlsbGluZyBhZGRyZXNzIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBILk1pc3NpbmdDYXJ0OnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBjYXJ0IGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBILk1pc3NpbmdDb25zaWdubWVudHM6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGNvbnNpZ25tZW50cyBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgSC5NaXNzaW5nQ2hlY2tvdXQ6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGNoZWNrb3V0IGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBILk1pc3NpbmdDdXN0b21lcjpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgY3VzdG9tZXIgZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIEguTWlzc2luZ0NoZWNrb3V0Q29uZmlnOmNhc2UgSC5NaXNzaW5nT3JkZXJDb25maWc6cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIGNvbmZpZ3VyYXRpb24gZGF0YSBpcyB1bmF2YWlsYWJsZS5cIjtjYXNlIEguTWlzc2luZ09yZGVyOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBvcmRlciBkYXRhIGlzIHVuYXZhaWxhYmxlLlwiO2Nhc2UgSC5NaXNzaW5nT3JkZXJJZDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2Ugb3JkZXIgSUQgaXMgdW5hdmFpbGFibGUgb3Igbm90IGdlbmVyYXRlZCB5ZXQuXCI7Y2FzZSBILk1pc3NpbmdQYXltZW50OnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBwYXltZW50IGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7Y2FzZSBILk1pc3NpbmdQYXltZW50VG9rZW46cmV0dXJuXCJVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIHRoZSB0b2tlbiByZXF1aXJlZCB0byBzdWJtaXQgYSBwYXltZW50IGlzIG1pc3NpbmcuXCI7Y2FzZSBILk1pc3NpbmdQYXltZW50TWV0aG9kOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBwYXltZW50IG1ldGhvZCBkYXRhIGlzIHVuYXZhaWxhYmxlIG9yIG5vdCBwcm9wZXJseSBjb25maWd1cmVkLlwiO2Nhc2UgSC5NaXNzaW5nU2hpcHBpbmdBZGRyZXNzOnJldHVyblwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBzaGlwcGluZyBhZGRyZXNzIGRhdGEgaXMgdW5hdmFpbGFibGUuXCI7ZGVmYXVsdDpyZXR1cm5cIlVuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgdGhlIHJlcXVpcmVkIGRhdGEgaXMgdW5hdmFpbGFibGUuXCJ9fShlKSksdGhpcy5zdWJ0eXBlPWUsdGhpcy5uYW1lPVwiTWlzc2luZ0RhdGFFcnJvclwiLHRoaXMudHlwZT1cIm1pc3NpbmdfZGF0YVwifX1jbGFzcyBZIGV4dGVuZHMgZntjb25zdHJ1Y3RvcihlKXtzdXBlcihlfHxcIkFuIHVuZXhwZWN0ZWQgZXJyb3IgaGFzIG9jY3VycmVkIGR1cmluZyBidXkgbm93IGNhcnQgY3JlYXRpb24gcHJvY2Vzcy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiksdGhpcy5uYW1lPVwiQnV5Tm93Q2FydENyZWF0aW9uRXJyb3JcIix0aGlzLnR5cGU9XCJidXlfbm93X2NhcnRfY3JlYXRpb25fZXJyb3JcIn19ZnVuY3Rpb24gSihlKXtjb25zdHtjb2xvcjp0LGZ1bmRpbmdpY29uczppLGhlaWdodDpuPTQwLGxheW91dDpyLHNoYXBlOmEsc2l6ZTpzLHRhZ2xpbmU6bH09ZXx8e30sYz17Y29sb3I6dCxmdW5kaW5naWNvbnM6aSxoZWlnaHQ6SyhuKSxsYXlvdXQ6cixzaGFwZTphfHxcInJlY3RcIixzaXplOnMsdGFnbGluZTpsfTtyZXR1cm4gZChjLG8pfWZ1bmN0aW9uIEsoZSl7Y29uc3QgdD1OdW1iZXIoZSk7cmV0dXJuIXR8fE51bWJlci5pc05hTih0KT80MDp0PjU1PzU1OnQ8MjU/MjU6dH1mdW5jdGlvbiBYKGUpe3JldHVybntyZWNpcGllbnROYW1lOmAke2UuZmlyc3ROYW1lfSAke2UubGFzdE5hbWV9YCxsaW5lMTplLmFkZHJlc3MxLGxpbmUyOmUuYWRkcmVzczIsY2l0eTplLmNpdHksc3RhdGU6ZS5zdGF0ZU9yUHJvdmluY2VDb2RlLHBvc3RhbENvZGU6ZS5wb3N0YWxDb2RlLGNvdW50cnlDb2RlOmUuY291bnRyeUNvZGUscGhvbmU6ZS5waG9uZX19dmFyIFE9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgWntjb25zdHJ1Y3RvcihlLHQsaSxuKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmZvcm1Qb3N0ZXI9dCx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT1pLHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdz1ufWluaXRpYWxpemUoZSl7cmV0dXJuIFEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2JyYWludHJlZXBheXBhbDp0LGNvbnRhaW5lcklkOmksbWV0aG9kSWQ6bn09ZTtpZighbil0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighaSl0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5jb250YWluZXJJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdCl0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVwYXlwYWxcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7bGV0IHIsbz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTtpZih0LmJ1eU5vd0luaXRpYWxpemVPcHRpb25zKXtpZighdC5jdXJyZW5jeUNvZGUpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVlcGF5cGFsY3JlZGl0LmN1cnJlbmN5Q29kZVwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtyPXQuY3VycmVuY3lDb2RlfWVsc2UgeWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWREZWZhdWx0Q2hlY2tvdXQoKSxvPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHI9by5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGU7Y29uc3QgYT1vLmdldFBheW1lbnRNZXRob2RPclRocm93KG4pLHtjbGllbnRUb2tlbjpzLGNvbmZpZzpkLGluaXRpYWxpemF0aW9uRGF0YTpsfT1hO2lmKCFzfHwhbCl0aHJvdyBuZXcgRyhILk1pc3NpbmdQYXltZW50TWV0aG9kKTtjb25zdCBjPXtjdXJyZW5jeTpyLGludGVudDpsLmludGVudCxpc0NyZWRpdEVuYWJsZWQ6bC5pc0NyZWRpdEVuYWJsZWQsY29tbWl0OiExfTt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKHMpLHlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheXBhbENoZWNrb3V0KGMsZT0+e3RoaXMucmVuZGVyUGF5UGFsQnV0dG9uKGUsdCxpLG4sISFkLnRlc3RNb2RlKX0sZT0+dGhpcy5oYW5kbGVFcnJvcihlLGksdC5vbkVycm9yKSl9KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gUSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudGVhcmRvd24oKX0pfXJlbmRlclBheVBhbEJ1dHRvbihlLHQsaSxuLHIpe2NvbnN0e3N0eWxlOm8sc2hvdWxkUHJvY2Vzc1BheW1lbnQ6YSxvbkF1dGhvcml6ZUVycm9yOnMsb25FbGlnaWJpbGl0eUZhaWx1cmU6ZH09dCx7cGF5cGFsOmx9PXRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdztpZihsKXtjb25zdCBjPWwuQnV0dG9ucyh7ZW52OnI/XCJzYW5kYm94XCI6XCJwcm9kdWN0aW9uXCIsZnVuZGluZ1NvdXJjZTpsLkZVTkRJTkcuUEFZUEFMLHN0eWxlOkoobyksY3JlYXRlT3JkZXI6KCk9PnRoaXMuc2V0dXBQYXltZW50KGUsdCxuKSxvbkFwcHJvdmU6dD0+dGhpcy50b2tlbml6ZVBheW1lbnQodCxlLG4sYSxzKX0pO2MuaXNFbGlnaWJsZSgpP2MucmVuZGVyKGAjJHtpfWApOmQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGQmJmQoKX1lbHNlIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQoaSl9c2V0dXBQYXltZW50KGUsdCxpKXt2YXIgbjtyZXR1cm4gUSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7b25QYXltZW50RXJyb3I6cixzaGlwcGluZ0FkZHJlc3M6byxidXlOb3dJbml0aWFsaXplT3B0aW9uczphfT10O3RyeXtjb25zdCByPVwiZnVuY3Rpb25cIj09dHlwZW9mKG51bGw9PWE/dm9pZCAwOmEuZ2V0QnV5Tm93Q2FydFJlcXVlc3RCb2R5KT95aWVsZCB0aGlzLmNyZWF0ZUJ1eU5vd0NhcnQoYS5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkoKSk6dm9pZCAwO3RoaXMuYnV5Tm93Q2FydElkPW51bGw9PXI/dm9pZCAwOnIuaWQ7Y29uc3Qgcz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxkPXMuZ2V0Q3VzdG9tZXIoKSxsPXMuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSksYz1yP3IuY2FydEFtb3VudDpzLmdldENhcnRPclRocm93KCkuY2FydEFtb3VudCx1PXI/dC5jdXJyZW5jeUNvZGU6cy5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGUsaD1vfHwobnVsbD09ZD92b2lkIDA6ZC5hZGRyZXNzZXNbMF0pLHk9aD9YKGgpOnZvaWQgMDtyZXR1cm4geWllbGQgZS5jcmVhdGVQYXltZW50KHtmbG93OlwiY2hlY2tvdXRcIixlbmFibGVTaGlwcGluZ0FkZHJlc3M6ITAsc2hpcHBpbmdBZGRyZXNzRWRpdGFibGU6ITEsc2hpcHBpbmdBZGRyZXNzT3ZlcnJpZGU6eSxhbW91bnQ6YyxjdXJyZW5jeTp1LG9mZmVyQ3JlZGl0OiExLGludGVudDpudWxsPT09KG49bC5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmludGVudH0pfWNhdGNoKGUpe3Rocm93IHImJihMKGUpfHxlIGluc3RhbmNlb2YgZikmJnIoZSksZX19KX10b2tlbml6ZVBheW1lbnQoZSx0LGksbixyKXtyZXR1cm4gUSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e2NvbnN0e2RldmljZURhdGE6cn09eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0RGF0YUNvbGxlY3Rvcih7cGF5cGFsOiEwfSksbz15aWVsZCB0LnRva2VuaXplUGF5bWVudChlKSx7ZGV0YWlsczphLG5vbmNlOnN9PW8sZD10aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5tYXBUb0xlZ2FjeUJpbGxpbmdBZGRyZXNzKGEpLGw9dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UubWFwVG9MZWdhY3lTaGlwcGluZ0FkZHJlc3MoYSk7cmV0dXJuIHRoaXMuZm9ybVBvc3Rlci5wb3N0Rm9ybShcIi9jaGVja291dC5waHBcIixPYmplY3QuYXNzaWduKHtwYXltZW50X3R5cGU6XCJwYXlwYWxcIixwcm92aWRlcjppLGFjdGlvbjpuP1wicHJvY2Vzc19wYXltZW50XCI6XCJzZXRfZXh0ZXJuYWxfY2hlY2tvdXRcIixub25jZTpzLGRldmljZV9kYXRhOnIsYmlsbGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KGQpLHNoaXBwaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkobCl9LHRoaXMuYnV5Tm93Q2FydElkJiZ7Y2FydF9pZDp0aGlzLmJ1eU5vd0NhcnRJZH0pKSxvfWNhdGNoKGUpe3Rocm93IHImJihMKGUpfHxlIGluc3RhbmNlb2YgZikmJnIoZSksZX19KX1jcmVhdGVCdXlOb3dDYXJ0KGUpe3JldHVybiBRKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighZSl0aHJvdyBuZXcgRyhILk1pc3NpbmdDYXJ0KTt0cnl7cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5jcmVhdGVCdXlOb3dDYXJ0KGUpfWNhdGNoKGUpe3Rocm93IG5ldyBZfX0pfWhhbmRsZUVycm9yKGUsdCxpKXtpZih0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KHQpLCFpfHwhTChlKSl0aHJvdyBlO2koZSl9fWNvbnN0IGVlPSQoaT0+e2NvbnN0IG49d2luZG93LHI9bmV3IHYoaSksbz1uZXcgaihuZXcgcSh0KCksbixyKSxuKTtyZXR1cm4gbmV3IFooaSxlKCksbyxuKX0sW3tpZDpcImJyYWludHJlZXBheXBhbFwifV0pO2NsYXNzIHRle2NvbnN0cnVjdG9yKGUpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdz13aW5kb3d9cmVuZGVyKGUsdCxpKXtjb25zdCBuPXQmJmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHQpO2lmKHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5wYXlwYWwmJm4pe2NvbnN0IHI9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksbz1yLmdldENhcnRPclRocm93KCksYT1yLmdldEJpbGxpbmdBZGRyZXNzT3JUaHJvdygpLHM9ci5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKTtpZighcy5pbml0aWFsaXphdGlvbkRhdGEpcmV0dXJuO2NvbnN0e3BheXBhbEJOUExDb25maWd1cmF0aW9uOmQ9W119PXMuaW5pdGlhbGl6YXRpb25EYXRhLGw9aT09PV8uUEFZTUVOVD9cImNoZWNrb3V0XCI6aSxjPWQmJmQuZmluZCgoe2lkOmV9KT0+ZT09PWwpO2lmKCFjfHwhYy5zdGF0dXMpcmV0dXJuO2k9PT1fLkNBUlQmJihuLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcHAtc3R5bGUtbG9nby10eXBlXCIpLG4ucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcC1zdHlsZS1sb2dvLXBvc2l0aW9uXCIpLG4ucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcC1zdHlsZS10ZXh0LWNvbG9yXCIpLG4ucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1wcC1zdHlsZS10ZXh0LXNpemVcIikpLHRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdy5wYXlwYWwuTWVzc2FnZXMoe2Ftb3VudDpvLmNhcnRBbW91bnQsYnV5ZXJDb3VudHJ5OmEuY291bnRyeUNvZGUscGxhY2VtZW50Omksc3R5bGU6dGhpcy5nZXRQYXlwYWxNZXNzYWdlc1N0eWxlc0Zyb21CTlBMQ29uZmlnKGMpfSkucmVuZGVyKGAjJHt0fWApfX1nZXRQYXlwYWxNZXNzYWdlc1N0eWxlc0Zyb21CTlBMQ29uZmlnKHtzdHlsZXM6ZX0pe2NvbnN0IHQ9e307cmV0dXJuIGUuY29sb3ImJih0LmNvbG9yPWUuY29sb3IpLGUubGF5b3V0JiYodC5sYXlvdXQ9ZS5sYXlvdXQpLChlW1wibG9nby10eXBlXCJdfHxlW1wibG9nby1wb3NpdGlvblwiXSkmJih0LmxvZ289e30sZVtcImxvZ28tdHlwZVwiXSYmKHQubG9nby50eXBlPWVbXCJsb2dvLXR5cGVcIl0pLGVbXCJsb2dvLXBvc2l0aW9uXCJdJiYodC5sb2dvLnBvc2l0aW9uPWVbXCJsb2dvLXBvc2l0aW9uXCJdKSksZS5yYXRpbyYmKHQucmF0aW89ZS5yYXRpbyksKGVbXCJ0ZXh0LWNvbG9yXCJdfHxlW1widGV4dC1zaXplXCJdKSYmKHQudGV4dD17fSxlW1widGV4dC1jb2xvclwiXSYmKHQudGV4dC5jb2xvcj1lW1widGV4dC1jb2xvclwiXSksZVtcInRleHQtc2l6ZVwiXSYmKHQudGV4dC5zaXplPStlW1widGV4dC1zaXplXCJdKSksdH19dmFyIGllPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIG5le2NvbnN0cnVjdG9yKGUsdCxpLG4scil7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5mb3JtUG9zdGVyPXQsdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2U9aSx0aGlzLmJyYWludHJlZU1lc3NhZ2VzPW4sdGhpcy5icmFpbnRyZWVIb3N0V2luZG93PXJ9aW5pdGlhbGl6ZShlKXt2YXIgdCxpO3JldHVybiBpZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7YnJhaW50cmVlcGF5cGFsY3JlZGl0Om4sY29udGFpbmVySWQ6cixtZXRob2RJZDpvfT1lO2lmKCFvKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFyKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmNvbnRhaW5lcklkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXBheXBhbGNyZWRpdFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtsZXQgYSxzPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO2lmKG4uYnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnMpe2lmKCFuLmN1cnJlbmN5Q29kZSl0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVwYXlwYWxjcmVkaXQuY3VycmVuY3lDb2RlXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2E9bi5jdXJyZW5jeUNvZGV9ZWxzZSB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZERlZmF1bHRDaGVja291dCgpLHM9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksYT1zLmdldENhcnRPclRocm93KCkuY3VycmVuY3kuY29kZTtjb25zdCBkPXMuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3cobykse2NsaWVudFRva2VuOmwsY29uZmlnOmMsaW5pdGlhbGl6YXRpb25EYXRhOnV9PWQ7aWYoIWx8fCF1KXRocm93IG5ldyBHKEguTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0IGg9e2N1cnJlbmN5OmEsaW50ZW50OnUuaW50ZW50LGlzQ3JlZGl0RW5hYmxlZDp1LmlzQ3JlZGl0RW5hYmxlZCxjb21taXQ6ITF9LG09eShudWxsIT09KGk9bnVsbD09PSh0PXMuZ2V0U3RvcmVDb25maWcoKSl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlcykmJnZvaWQgMCE9PWk/aTp7fSxcIlBBWVBBTC01NjYzLmhpZGVfYnJhaW50cmVlX2NhcmRfYmFubmVyX2ltcGxlbWVudGF0aW9uX2luX2NoZWNrb3V0X3Nka1wiKTt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKGwpLHlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheXBhbENoZWNrb3V0KGgsZT0+eyFtJiZuLm1lc3NhZ2luZ0NvbnRhaW5lcklkJiZ0aGlzLnJlbmRlclBheVBhbE1lc3NhZ2VzKG8sbi5tZXNzYWdpbmdDb250YWluZXJJZCksdGhpcy5yZW5kZXJQYXlQYWxCdXR0b24oZSxuLHIsbywhIWMudGVzdE1vZGUpfSxlPT50aGlzLmhhbmRsZUVycm9yKGUscixuLm9uRXJyb3IpKX0pfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBpZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudGVhcmRvd24oKX0pfXJlbmRlclBheVBhbE1lc3NhZ2VzKGUsdCl7dGhpcy5icmFpbnRyZWVNZXNzYWdlcy5yZW5kZXIoZSx0LF8uQ0FSVCl9cmVuZGVyUGF5UGFsQnV0dG9uKGUsdCxpLG4scil7Y29uc3R7c3R5bGU6byxzaG91bGRQcm9jZXNzUGF5bWVudDphLG9uQXV0aG9yaXplRXJyb3I6cyxvbkVsaWdpYmlsaXR5RmFpbHVyZTpkfT10LHtwYXlwYWw6bH09dGhpcy5icmFpbnRyZWVIb3N0V2luZG93O2xldCBjPSExO2wmJltsLkZVTkRJTkcuUEFZTEFURVIsbC5GVU5ESU5HLkNSRURJVF0uZm9yRWFjaCh1PT57Y29uc3QgaD11PT09bC5GVU5ESU5HLkNSRURJVD9PYmplY3QuYXNzaWduKHtsYWJlbDpELkNSRURJVH0sSihvKSk6SihvKTtpZighYyl7Y29uc3Qgbz1sLkJ1dHRvbnMoe2VudjpyP1wic2FuZGJveFwiOlwicHJvZHVjdGlvblwiLGZ1bmRpbmdTb3VyY2U6dSxzdHlsZTpoLGNyZWF0ZU9yZGVyOigpPT50aGlzLnNldHVwUGF5bWVudChlLHQsbiksb25BcHByb3ZlOnQ9PnRoaXMudG9rZW5pemVQYXltZW50KHQsZSxuLGEscyl9KTtvLmlzRWxpZ2libGUoKT8oby5yZW5kZXIoYCMke2l9YCksYz0hMCk6bC5GVU5ESU5HLkNSRURJVCYmZCYmXCJmdW5jdGlvblwiPT10eXBlb2YgZCYmZCgpfX0pLGwmJmN8fHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQoaSl9c2V0dXBQYXltZW50KGUsdCxpKXt2YXIgbjtyZXR1cm4gaWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e29uUGF5bWVudEVycm9yOnIsc2hpcHBpbmdBZGRyZXNzOm8sYnV5Tm93SW5pdGlhbGl6ZU9wdGlvbnM6YX09dDt0cnl7Y29uc3Qgcj1cImZ1bmN0aW9uXCI9PXR5cGVvZihudWxsPT1hP3ZvaWQgMDphLmdldEJ1eU5vd0NhcnRSZXF1ZXN0Qm9keSk/eWllbGQgdGhpcy5jcmVhdGVCdXlOb3dDYXJ0KGEuZ2V0QnV5Tm93Q2FydFJlcXVlc3RCb2R5KCkpOnZvaWQgMDt0aGlzLmJ1eU5vd0NhcnRJZD1udWxsPT1yP3ZvaWQgMDpyLmlkO2NvbnN0IHM9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksZD1zLmdldEN1c3RvbWVyKCksbD1zLmdldFBheW1lbnRNZXRob2RPclRocm93KGkpLGM9cj9yLmNhcnRBbW91bnQ6cy5nZXRDYXJ0T3JUaHJvdygpLmNhcnRBbW91bnQsdT1yP3QuY3VycmVuY3lDb2RlOnMuZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlLGg9b3x8KG51bGw9PWQ/dm9pZCAwOmQuYWRkcmVzc2VzWzBdKSx5PWg/WChoKTp2b2lkIDA7cmV0dXJuIHlpZWxkIGUuY3JlYXRlUGF5bWVudCh7ZmxvdzpcImNoZWNrb3V0XCIsZW5hYmxlU2hpcHBpbmdBZGRyZXNzOiEwLHNoaXBwaW5nQWRkcmVzc0VkaXRhYmxlOiExLHNoaXBwaW5nQWRkcmVzc092ZXJyaWRlOnksYW1vdW50OmMsY3VycmVuY3k6dSxvZmZlckNyZWRpdDohMCxpbnRlbnQ6bnVsbD09PShuPWwuaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09bj92b2lkIDA6bi5pbnRlbnR9KX1jYXRjaChlKXt0aHJvdyByJiYoTChlKXx8ZSBpbnN0YW5jZW9mIGYpJiZyKGUpLGV9fSl9dG9rZW5pemVQYXltZW50KGUsdCxpLG4scil7cmV0dXJuIGllKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7Y29uc3R7ZGV2aWNlRGF0YTpyfT15aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXREYXRhQ29sbGVjdG9yKHtwYXlwYWw6ITB9KSxvPXlpZWxkIHQudG9rZW5pemVQYXltZW50KGUpLHtkZXRhaWxzOmEsbm9uY2U6c309byxkPXRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvTGVnYWN5QmlsbGluZ0FkZHJlc3MoYSksbD10aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5tYXBUb0xlZ2FjeVNoaXBwaW5nQWRkcmVzcyhhKTtyZXR1cm4gdGhpcy5mb3JtUG9zdGVyLnBvc3RGb3JtKFwiL2NoZWNrb3V0LnBocFwiLE9iamVjdC5hc3NpZ24oe3BheW1lbnRfdHlwZTpcInBheXBhbFwiLHByb3ZpZGVyOmksYWN0aW9uOm4/XCJwcm9jZXNzX3BheW1lbnRcIjpcInNldF9leHRlcm5hbF9jaGVja291dFwiLG5vbmNlOnMsZGV2aWNlX2RhdGE6cixiaWxsaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkoZCksc2hpcHBpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeShsKX0sdGhpcy5idXlOb3dDYXJ0SWQmJntjYXJ0X2lkOnRoaXMuYnV5Tm93Q2FydElkfSkpLG99Y2F0Y2goZSl7dGhyb3cgciYmKEwoZSl8fGUgaW5zdGFuY2VvZiBmKSYmcihlKSxlfX0pfWNyZWF0ZUJ1eU5vd0NhcnQoZSl7cmV0dXJuIGllKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighZSl0aHJvdyBuZXcgRyhILk1pc3NpbmdDYXJ0KTt0cnl7cmV0dXJuIHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5jcmVhdGVCdXlOb3dDYXJ0KGUpfWNhdGNoKGUpe3Rocm93IG5ldyBZfX0pfWhhbmRsZUVycm9yKGUsdCxpKXtpZih0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KHQpLCFpfHwhTChlKSl0aHJvdyBlO2koZSl9fWNvbnN0IHJlPSQoaT0+e2NvbnN0IG49d2luZG93LHI9bmV3IHYoaSksbz1uZXcgaihuZXcgcSh0KCksbixyKSxuKSxhPW5ldyB0ZShpKTtyZXR1cm4gbmV3IG5lKGksZSgpLG8sYSxuKX0sW3tpZDpcImJyYWludHJlZXBheXBhbGNyZWRpdFwifV0pO3ZhciBvZSxhZSxzZSxkZSxsZSxjZSx1ZTshZnVuY3Rpb24oZSl7ZS5FU1RJTUFURUQ9XCJFU1RJTUFURURcIixlLkZJTkFMPVwiRklOQUxcIixlLk5PVF9DVVJSRU5UTFlfS05PV049XCJOT1RfQ1VSUkVOVExZX0tOT1dOXCJ9KG9lfHwob2U9e30pKSxmdW5jdGlvbihlKXtlLkNvbXBsZXRlZD1cIkNPTVBMRVRFRFwiLGUuUGVuZGluZz1cIlBFTkRJTkdcIixlLkZhaWxlZD1cIkZBSUxFRFwifShhZXx8KGFlPXt9KSksZnVuY3Rpb24oZSl7ZS5UUlVTVExZPVwidHJ1c3RseVwifShzZXx8KHNlPXt9KSksZnVuY3Rpb24oZSl7ZS5TVUNDRUVERUQ9XCJzdWNjZWVkZWRcIixlLkZBSUxFRD1cImZhaWxlZFwiLGUuQ0FOQ0VMRUQ9XCJjYW5jZWxsZWRcIixlLlVOUkVDT0dOSVpFRD1cInVucmVjb2duaXplZFwifShkZXx8KGRlPXt9KSksZnVuY3Rpb24oZSl7ZS5DdXN0b21lcj1cIkNVU1RPTUVSXCIsZS5NZXJjaGFudD1cIk1FUkNIQU5UXCIsZS5OZXR3b3JrPVwiTkVUV09SS1wiLGUuSW50ZXJuYWw9XCJJTlRFUk5BTFwiLGUuVW5rbm93bj1cIlVOS05PV05cIn0obGV8fChsZT17fSkpLGZ1bmN0aW9uKGUpe2UuS291bnROb3RFbmFibGVkPVwiREFUQV9DT0xMRUNUT1JfS09VTlRfTk9UX0VOQUJMRURcIn0oY2V8fChjZT17fSkpLGZ1bmN0aW9uKGUpe2UuVmlzYT1cInZpc2FcIixlLk1hc3RlcmNhcmQ9XCJtYXN0ZXJjYXJkXCIsZS5BbWVyaWNhbkV4cHJlc3M9XCJhbWVyaWNhbi1leHByZXNzXCIsZS5EaW5lcnNDbHViPVwiZGluZXJzLWNsdWJcIixlLkRpc2NvdmVyPVwiZGlzY292ZXJcIixlLkpjYj1cImpjYlwiLGUuVW5pb25QYXk9XCJ1bmlvbi1wYXlcIixlLk1hZXN0cm89XCJtYWVzdHJvXCIsZS5FbG89XCJlbG9cIixlLk1pcj1cIm1pclwiLGUuSGlwZXI9XCJoaXBlclwiLGUuSGlwZXJjYXJkPVwiaGlwZXJjYXJkXCJ9KHVlfHwodWU9e30pKTt2YXIgaGU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgeWV7Y29uc3RydWN0b3IoZSl7dGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXI9ZX1pbml0aWFsaXplKGUpe3RoaXMuc2V0Q2xpZW50VG9rZW4oZSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIGhlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnRlYXJkb3duTW9kdWxlKHRoaXMuZGF0YUNvbGxlY3RvciksdGhpcy5kYXRhQ29sbGVjdG9yPXZvaWQgMH0pfWdldENsaWVudCgpe3JldHVybiBoZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuY2xpZW50KXtjb25zdCBlPXRoaXMuZ2V0Q2xpZW50VG9rZW5PclRocm93KCksdD15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkQ2xpZW50KCk7dGhpcy5jbGllbnQ9eWllbGQgdC5jcmVhdGUoe2F1dGhvcml6YXRpb246ZX0pfXJldHVybiB0aGlzLmNsaWVudH0pfWdldERhdGFDb2xsZWN0b3JPclRocm93KGUpe3JldHVybiBoZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD17ZGV2aWNlRGF0YTp2b2lkIDAsdGVhcmRvd246KCk9PlByb21pc2UucmVzb2x2ZSgpfTtpZighdGhpcy5kYXRhQ29sbGVjdG9yKXRyeXtjb25zdCB0PXlpZWxkIHRoaXMuZ2V0Q2xpZW50KCksaT15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkRGF0YUNvbGxlY3RvcigpLG49T2JqZWN0LmFzc2lnbih7Y2xpZW50OnQsa291bnQ6ITB9LGUpO3RoaXMuZGF0YUNvbGxlY3Rvcj15aWVsZCBpLmNyZWF0ZShuKX1jYXRjaChlKXtpZihMKGUpJiZlLmNvZGU9PT1jZS5Lb3VudE5vdEVuYWJsZWQpcmV0dXJuIHQ7dGhyb3cgZX1yZXR1cm4gdGhpcy5kYXRhQ29sbGVjdG9yfSl9Z2V0QnJhaW50cmVlR29vZ2xlUGF5bWVudCgpe3JldHVybiBoZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuZ29vZ2xlUGF5bWVudCl7Y29uc3RbZSx0XT15aWVsZCBQcm9taXNlLmFsbChbdGhpcy5nZXRDbGllbnQoKSx0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkR29vZ2xlUGF5bWVudCgpXSk7dGhpcy5nb29nbGVQYXltZW50PXlpZWxkIHQuY3JlYXRlKHtjbGllbnQ6ZX0pfXJldHVybiB0aGlzLmdvb2dsZVBheW1lbnR9KX1nZXRCcmFpbnRyZWVUaHJlZURTKCl7cmV0dXJuIGhlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy50aHJlZURTKXtjb25zdFtlLHRdPXlpZWxkIFByb21pc2UuYWxsKFt0aGlzLmdldENsaWVudCgpLHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWQzRFMoKV0pO3RoaXMudGhyZWVEUz15aWVsZCB0LmNyZWF0ZSh7Y2xpZW50OmUsdmVyc2lvbjoyfSl9cmV0dXJuIHRoaXMudGhyZWVEU30pfWdldEJyYWludHJlZUxvY2FsUGF5bWVudChlKXtyZXR1cm4gaGUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLmJyYWludHJlZUxvY2FsUGF5bWVudCl7Y29uc3RbdCxpXT15aWVsZCBQcm9taXNlLmFsbChbdGhpcy5nZXRDbGllbnQoKSx0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkTG9jYWxQYXltZW50KCldKTt0aGlzLmJyYWludHJlZUxvY2FsUGF5bWVudD15aWVsZCBuZXcgUHJvbWlzZSgobixyKT0+e2kuY3JlYXRlKHtjbGllbnQ6dCxtZXJjaGFudEFjY291bnRJZDplfSwoZSx0KT0+e2UmJnIoZSksbih0KX0pfSl9cmV0dXJuIHRoaXMuYnJhaW50cmVlTG9jYWxQYXltZW50fSl9Z2V0VXNCYW5rQWNjb3VudCgpe3JldHVybiBoZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMudXNCYW5rQWNjb3VudCl7Y29uc3QgZT15aWVsZCB0aGlzLmdldENsaWVudCgpLHQ9eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZFVzQmFua0FjY291bnQoKTt0aGlzLnVzQmFua0FjY291bnQ9eWllbGQgdC5jcmVhdGUoe2NsaWVudDplfSl9cmV0dXJuIHRoaXMudXNCYW5rQWNjb3VudH0pfWdldEJyYWludHJlZVZpc2FDaGVja291dCgpe3JldHVybiB0aGlzLnZpc2FDaGVja291dHx8KHRoaXMudmlzYUNoZWNrb3V0PVByb21pc2UuYWxsKFt0aGlzLmdldENsaWVudCgpLHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRWaXNhQ2hlY2tvdXQoKV0pLnRoZW4oKFtlLHRdKT0+dC5jcmVhdGUoe2NsaWVudDplfSkpKSx0aGlzLnZpc2FDaGVja291dH1nZXRWaXNhQ2hlY2tvdXRTZGsoZSl7cmV0dXJuIGhlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gdGhpcy52aXNhQ2hlY2tvdXRTREt8fCh0aGlzLnZpc2FDaGVja291dFNESz15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkVmlzYUNoZWNrb3V0U2RrKGUpKSx0aGlzLnZpc2FDaGVja291dFNES30pfWdldFZlbm1vQ2hlY2tvdXRPclRocm93KCl7cmV0dXJuIGhlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5icmFpbnRyZWVWZW5tbyl7Y29uc3QgZT15aWVsZCB0aGlzLmdldENsaWVudCgpLHQ9eWllbGQgdGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXIubG9hZFZlbm1vQ2hlY2tvdXQoKSxpPXtjbGllbnQ6ZSxhbGxvd0Rlc2t0b3A6ITAscGF5bWVudE1ldGhvZFVzYWdlOlwibXVsdGlfdXNlXCJ9LG49eWllbGQgdC5jcmVhdGUoaSk7aWYoIW4uaXNCcm93c2VyU3VwcG9ydGVkKCkpdGhyb3cgbmV3IGI7dGhpcy5icmFpbnRyZWVWZW5tbz1ufXJldHVybiB0aGlzLmJyYWludHJlZVZlbm1vfSl9c2V0Q2xpZW50VG9rZW4oZSl7dGhpcy5jbGllbnRUb2tlbj1lfWdldENsaWVudFRva2VuT3JUaHJvdygpe2lmKCF0aGlzLmNsaWVudFRva2VuKXRocm93IG5ldyBJKFAuUGF5bWVudE5vdEluaXRpYWxpemVkKTtyZXR1cm4gdGhpcy5jbGllbnRUb2tlbn10ZWFyZG93bk1vZHVsZShlKXtyZXR1cm4gZT9lLnRlYXJkb3duKCk6UHJvbWlzZS5yZXNvbHZlKCl9fXZhciBtZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBwZXtjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5mb3JtUG9zdGVyPXQsdGhpcy5icmFpbnRyZWVTZGs9aX1pbml0aWFsaXplKGUpe3JldHVybiBtZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7Y29udGFpbmVySWQ6dCxtZXRob2RJZDppfT1lO2lmKCFpKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCF0KXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmNvbnRhaW5lcklkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKTtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHtjbGllbnRUb2tlbjpyLGluaXRpYWxpemF0aW9uRGF0YTpvLGNvbmZpZzphfT1uLmdldFBheW1lbnRNZXRob2RPclRocm93KGkpO2lmKCFyfHwhbyl0aHJvdyBuZXcgRyhILk1pc3NpbmdQYXltZW50TWV0aG9kKTt0aGlzLmJyYWludHJlZVNkay5pbml0aWFsaXplKHIpO2NvbnN0IHM9eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0QnJhaW50cmVlVmlzYUNoZWNrb3V0KCkse2N1cnJlbmN5Ontjb2RlOmR9LGNhcnRBbW91bnQ6bH09bi5nZXRDYXJ0T3JUaHJvdygpLGM9eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0VmlzYUNoZWNrb3V0U2RrKGEudGVzdE1vZGUpLHU9cy5jcmVhdGVJbml0T3B0aW9ucyh7cGF5bWVudFJlcXVlc3Q6e2N1cnJlbmN5Q29kZTpkLHN1YnRvdGFsOlN0cmluZyhsKX0sc2V0dGluZ3M6e3NoaXBwaW5nOntjb2xsZWN0U2hpcHBpbmc6ITB9fX0pO3RoaXMuY3JlYXRlU2lnbkluQnV0dG9uKHQpLHlpZWxkIGMuaW5pdCh1KSxjLm9uKFwicGF5bWVudC5zdWNjZXNzXCIsZT0+bWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMucGF5bWVudFN1Y2Nlc3MocyxlKX0pKX0pfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlc29sdmUoKX1wYXltZW50U3VjY2VzcyhlLHQpe3JldHVybiBtZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIFByb21pc2UuYWxsKFtlLnRva2VuaXplKHQpLHRoaXMuYnJhaW50cmVlU2RrLmdldERhdGFDb2xsZWN0b3JPclRocm93KCldKS50aGVuKChbZSx0XSk9Pntjb25zdCBpPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG49aS5nZXRTaGlwcGluZ0FkZHJlc3MoKSxyPWkuZ2V0QmlsbGluZ0FkZHJlc3MoKSx7c2hpcHBpbmdBZGRyZXNzOm89dGhpcy50b1Zpc2FDaGVja291dEFkZHJlc3MobiksYmlsbGluZ0FkZHJlc3M6YT10aGlzLnRvVmlzYUNoZWNrb3V0QWRkcmVzcyhyKX09ZTtyZXR1cm4gdGhpcy5wb3N0Rm9ybShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3NoaXBwaW5nQWRkcmVzczpvLGJpbGxpbmdBZGRyZXNzOmF9KSx0KX0pfSl9cG9zdEZvcm0oZSx0KXtjb25zdHt1c2VyRGF0YTppLGJpbGxpbmdBZGRyZXNzOm4sc2hpcHBpbmdBZGRyZXNzOnIsZGV0YWlsczpvfT1lLHt1c2VyRW1haWw6YX09aSx7ZGV2aWNlRGF0YTpzfT10O3JldHVybiB0aGlzLmZvcm1Qb3N0ZXIucG9zdEZvcm0oXCIvY2hlY2tvdXQucGhwXCIse3BheW1lbnRfdHlwZTplLnR5cGUsbm9uY2U6ZS5ub25jZSxwcm92aWRlcjpcImJyYWludHJlZXZpc2FjaGVja291dFwiLGFjdGlvbjpcInNldF9leHRlcm5hbF9jaGVja291dFwiLGRldmljZV9kYXRhOnMsY2FyZF9pbmZvcm1hdGlvbjpKU09OLnN0cmluZ2lmeSh7dHlwZTpvLmNhcmRUeXBlLG51bWJlcjpvLmxhc3RUd299KSxiaWxsaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkodGhpcy5nZXRBZGRyZXNzKGEsbikpLHNoaXBwaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkodGhpcy5nZXRBZGRyZXNzKGEscikpfSl9dG9WaXNhQ2hlY2tvdXRBZGRyZXNzKGUpe3JldHVybiBlP3tmaXJzdE5hbWU6ZS5maXJzdE5hbWUsbGFzdE5hbWU6ZS5sYXN0TmFtZSxwaG9uZU51bWJlcjplLnBob25lLHN0cmVldEFkZHJlc3M6ZS5hZGRyZXNzMSxleHRlbmRlZEFkZHJlc3M6ZS5hZGRyZXNzMixsb2NhbGl0eTplLmNpdHkscmVnaW9uOmUuc3RhdGVPclByb3ZpbmNlQ29kZSxjb3VudHJ5Q29kZTplLmNvdW50cnlDb2RlLHBvc3RhbENvZGU6ZS5wb3N0YWxDb2RlfTp7fX1nZXRBZGRyZXNzKGUsdD17fSl7cmV0dXJue2VtYWlsOmUsZmlyc3RfbmFtZTp0LmZpcnN0TmFtZSxsYXN0X25hbWU6dC5sYXN0TmFtZSxwaG9uZV9udW1iZXI6dC5waG9uZU51bWJlcixhZGRyZXNzX2xpbmVfMTp0LnN0cmVldEFkZHJlc3MsYWRkcmVzc19saW5lXzI6dC5leHRlbmRlZEFkZHJlc3MsY2l0eTp0LmxvY2FsaXR5LHN0YXRlOnQucmVnaW9uLGNvdW50cnlfY29kZTp0LmNvdW50cnlDb2RlLHBvc3RhbF9jb2RlOnQucG9zdGFsQ29kZX19Y3JlYXRlU2lnbkluQnV0dG9uKGUpe2NvbnN0IHQ9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgIyR7ZX1gKTtpZighdCl0aHJvdyBuZXcgRXJyb3IoXCJOZWVkIGEgY29udGFpbmVyIHRvIHBsYWNlIHRoZSBidXR0b25cIik7cmV0dXJuIHRoaXMuaW5zZXJ0VmlzYUNoZWNrb3V0QnV0dG9uKHQpfWluc2VydFZpc2FDaGVja291dEJ1dHRvbihlKXtjb25zdCB0PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7cmV0dXJuIHQuc3R5bGUuZGlzcGxheT1cImZsZXhcIix0LnN0eWxlLmZsZXhEaXJlY3Rpb249XCJjb2x1bW5cIix0LnN0eWxlLmFsaWduSXRlbXM9XCJmbGV4LWVuZFwiLHQuaW5uZXJIVE1MPSdcXG4gICAgICAgICAgICA8aW1nXFxuICAgICAgICAgICAgICAgIGFsdD1cIlZpc2EgQ2hlY2tvdXRcIlxcbiAgICAgICAgICAgICAgICBjbGFzcz1cInYtYnV0dG9uXCJcXG4gICAgICAgICAgICAgICAgcm9sZT1cImJ1dHRvblwiXFxuICAgICAgICAgICAgICAgIHNyYz1cImh0dHBzOi8vc2VjdXJlLmNoZWNrb3V0LnZpc2EuY29tL3dhbGxldC1zZXJ2aWNlcy13ZWIveG8vYnV0dG9uLnBuZz9hY2NlcHRDYW5hZGlhblZpc2FEZWJpdD1mYWxzZSZjb2JyYW5kPXRydWUmaGVpZ2h0PTM0JndpZHRoPTE3OFwiXFxuICAgICAgICAgICAgICAgIC8+XFxuICAgICAgICAgICAgPGEgY2xhc3M9XCJ2LWxlYXJuIHYtbGVhcm4tZGVmYXVsdFwiIHN0eWxlPVwidGV4dC1hbGlnbjogcmlnaHQ7IGRpc3BsYXk6IGJsb2NrOyBmb250LXNpemU6IDEwcHg7IGNvbG9yOiAjMDAzMzY2O1wiIGhyZWY9XCIjXCIgZGF0YS1sb2NhbGU9XCJlbl9VU1wiPlRlbGwgTWUgTW9yZTwvYT4nLGUuYXBwZW5kQ2hpbGQodCksdH19Y29uc3QgZ2U9JChpPT57Y29uc3Qgbj13aW5kb3cscj1uZXcgdihpKSxvPW5ldyB5ZShuZXcgcSh0KCksbixyKSk7cmV0dXJuIG5ldyBwZShpLGUoKSxvKX0sW3tpZDpcImJyYWludHJlZXZpc2FjaGVja291dFwifV0pO2Z1bmN0aW9uIHZlKGUpe2NvbnN0e2JpbGxpbmdBZGRyZXNzOnQsZW1haWw6aSxmaXJzdE5hbWU6bixsYXN0TmFtZTpyLHBob25lOm8sc2hpcHBpbmdBZGRyZXNzOmF9PWUscz10fHxhO3JldHVybntlbWFpbDppLGZpcnN0X25hbWU6bixsYXN0X25hbWU6cixwaG9uZV9udW1iZXI6byxhZGRyZXNzX2xpbmVfMTpudWxsPT1zP3ZvaWQgMDpzLmxpbmUxLGFkZHJlc3NfbGluZV8yOm51bGw9PXM/dm9pZCAwOnMubGluZTIsY2l0eTpudWxsPT1zP3ZvaWQgMDpzLmNpdHksc3RhdGU6bnVsbD09cz92b2lkIDA6cy5zdGF0ZSxjb3VudHJ5X2NvZGU6bnVsbD09cz92b2lkIDA6cy5jb3VudHJ5Q29kZSxwb3N0YWxfY29kZTpudWxsPT1zP3ZvaWQgMDpzLnBvc3RhbENvZGV9fWZ1bmN0aW9uIGZlKGUpe2NvbnN0e2VtYWlsOnQscGhvbmU6aSxzaGlwcGluZ0FkZHJlc3M6bn09ZSxyPShudWxsPT1uP3ZvaWQgMDpuLnJlY2lwaWVudE5hbWUpfHxcIlwiLFtvLGFdPXIuc3BsaXQoXCIgXCIpO3JldHVybntlbWFpbDp0LGZpcnN0X25hbWU6b3x8XCJcIixsYXN0X25hbWU6YXx8XCJcIixwaG9uZV9udW1iZXI6aSxhZGRyZXNzX2xpbmVfMTpudWxsPT1uP3ZvaWQgMDpuLmxpbmUxLGFkZHJlc3NfbGluZV8yOm51bGw9PW4/dm9pZCAwOm4ubGluZTIsY2l0eTpudWxsPT1uP3ZvaWQgMDpuLmNpdHksc3RhdGU6bnVsbD09bj92b2lkIDA6bi5zdGF0ZSxjb3VudHJ5X2NvZGU6bnVsbD09bj92b2lkIDA6bi5jb3VudHJ5Q29kZSxwb3N0YWxfY29kZTpudWxsPT1uP3ZvaWQgMDpuLnBvc3RhbENvZGV9fWZ1bmN0aW9uIGJlKGUpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmXCJuYW1lXCJpbiBlJiZcIkJyYWludHJlZUVycm9yXCI9PT1lLm5hbWV9dmFyIHdlPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NvbnN0IENlPWU9Pntjb25zdHtjb2xvcjp0LGhlaWdodDppfT1lO3JldHVybntiYWNrZ3JvdW5kQ29sb3I6KG49dHx8XCJcIixuPT09Ti5XSElURT9cIiNGRkZGRkZcIjpcIiMzRDk1Q0VcIiksYmFja2dyb3VuZFBvc2l0aW9uOlwiNTAlIDUwJVwiLGJhY2tncm91bmRTaXplOlwiODBweCBhdXRvXCIsYmFja2dyb3VuZEltYWdlOmB1cmwoXCIvYXBwL2Fzc2V0cy9pbWcvcGF5bWVudC1wcm92aWRlcnMvdmVubW8tbG9nby0ke3Q9PT1OLldISVRFP04uQkxVRTpOLldISVRFfS5zdmdcIilgLGJhY2tncm91bmRSZXBlYXQ6XCJuby1yZXBlYXRcIixib3JkZXJSYWRpdXM6XCI0cHhcIixjdXJzb3I6XCJwb2ludGVyXCIsdHJhbnNpdGlvbjpcIjAuMnMgZWFzZVwiLG1pbkhlaWdodDpgJHtpfHw0MH1weGAsbWluV2lkdGg6XCIxNTBweFwiLGhlaWdodDpcIjEwMCVcIix3aWR0aDpcIjEwMCVcIixib3JkZXI6dD09PU4uV0hJVEU/XCIxcHggc29saWQgYmxhY2tcIjpcIm5vbmVcIn07dmFyIG59O2NsYXNzIFNle2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmZvcm1Qb3N0ZXI9dCx0aGlzLmJyYWludHJlZVNkaz1pLHRoaXMub25FcnJvcj1hfWluaXRpYWxpemUoZSl7cmV0dXJuIHdlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWV2ZW5tbzp0LGNvbnRhaW5lcklkOmksbWV0aG9kSWQ6bn09ZTtpZighbil0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtjb25zdCByPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KG4pLHtjbGllbnRUb2tlbjpvLGluaXRpYWxpemF0aW9uRGF0YTphfT1yLHtwYXltZW50QnV0dG9uU3R5bGVzOnN9PWEse2NhcnRCdXR0b25TdHlsZXM6ZH09c3x8e30sbD0obnVsbD09dD92b2lkIDA6dC5zdHlsZSl8fGQ7aWYoIW98fCFhKXRocm93IG5ldyBHKEguTWlzc2luZ1BheW1lbnRNZXRob2QpO2lmKCFpKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmNvbnRhaW5lcklkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCksdGhpcy5vbkVycm9yPShudWxsPT10P3ZvaWQgMDp0Lm9uRXJyb3IpfHx0aGlzLmhhbmRsZUVycm9yLHRoaXMuYnJhaW50cmVlU2RrLmluaXRpYWxpemUobyk7dHJ5e2NvbnN0IGU9eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0VmVubW9DaGVja291dE9yVGhyb3coKTt0aGlzLnJlbmRlclZlbm1vQnV0dG9uKGUsaSxudWxsPT10P3ZvaWQgMDp0LmJ1eU5vd0luaXRpYWxpemVPcHRpb25zLGwpfWNhdGNoKGUpeyhiZShlKXx8ZnVuY3Rpb24oZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBifShlKSkmJnRoaXMuaGFuZGxlSW5pdGlhbGl6YXRpb25WZW5tb0Vycm9yKGUsaSl9fSl9ZGVpbml0aWFsaXplKCl7cmV0dXJuIHdlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4geWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZGVpbml0aWFsaXplKCksUHJvbWlzZS5yZXNvbHZlKCl9KX1oYW5kbGVFcnJvcihlKXt0aHJvdyBuZXcgRXJyb3IoZS5tZXNzYWdlKX1jcmVhdGVCdXlOb3dDYXJ0KGUpe3JldHVybiB3ZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoXCJmdW5jdGlvblwiPT10eXBlb2YobnVsbD09ZT92b2lkIDA6ZS5nZXRCdXlOb3dDYXJ0UmVxdWVzdEJvZHkpKXtjb25zdCB0PW51bGw9PWU/dm9pZCAwOmUuZ2V0QnV5Tm93Q2FydFJlcXVlc3RCb2R5KCk7aWYoIXQpdGhyb3cgbmV3IEcoSC5NaXNzaW5nQ2FydCk7dHJ5e3JldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuY3JlYXRlQnV5Tm93Q2FydCh0KX1jYXRjaChlKXt0aHJvdyBuZXcgWX19fSl9aGFuZGxlSW5pdGlhbGl6YXRpb25WZW5tb0Vycm9yKGUsdCl7cmV0dXJuIHRoaXMucmVtb3ZlVmVubW9Db250YWluZXIodCksdGhpcy5vbkVycm9yKGUpfXJlbW92ZVZlbm1vQ29udGFpbmVyKGUpe2NvbnN0IHQ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSk7dCYmdC5yZW1vdmUoKX1yZW5kZXJWZW5tb0J1dHRvbihlLHQsaSxuKXtjb25zdCByPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHQpLHtjb2xvcjpvfT1ufHx7fTtpZighcil0aHJvdyBuZXcgdyhcIlVuYWJsZSB0byBjcmVhdGUgd2FsbGV0IGJ1dHRvbiB3aXRob3V0IHZhbGlkIGNvbnRhaW5lciBJRC5cIik7ci5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsXCJWZW5tb1wiKSxPYmplY3QuYXNzaWduKHIuc3R5bGUsQ2Uobnx8e30pKSxyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCgpPT53ZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7ci5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLFwidHJ1ZVwiKTtjb25zdCB0PXlpZWxkIHRoaXMuY3JlYXRlQnV5Tm93Q2FydChpKTtlLnRva2VuaXplJiZlLnRva2VuaXplKChlLGkpPT53ZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7ci5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKSxlJiZ0aGlzLm9uRXJyb3IoZSkseWllbGQgdGhpcy5oYW5kbGVQb3N0Rm9ybShpLG51bGw9PXQ/dm9pZCAwOnQuaWQpfSkpfSkpLG89PT1OLkJMVUUmJihyLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWVudGVyXCIsKCk9PntyLnN0eWxlLmJhY2tncm91bmRDb2xvcj1cIiMwYTdmYzJcIn0pLHIuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlbGVhdmVcIiwoKT0+e3Iuc3R5bGUuYmFja2dyb3VuZENvbG9yPUNlKG58fHt9KS5iYWNrZ3JvdW5kQ29sb3J9KSl9aGFuZGxlUG9zdEZvcm0oZSx0KXtyZXR1cm4gd2UodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2RldmljZURhdGE6aX09eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0RGF0YUNvbGxlY3Rvck9yVGhyb3coKSx7bm9uY2U6bixkZXRhaWxzOnJ9PWU7dGhpcy5mb3JtUG9zdGVyLnBvc3RGb3JtKFwiL2NoZWNrb3V0LnBocFwiLE9iamVjdC5hc3NpZ24oe25vbmNlOm4scHJvdmlkZXI6XCJicmFpbnRyZWV2ZW5tb1wiLHBheW1lbnRfdHlwZTpcInBheXBhbFwiLGRldmljZV9kYXRhOmksYWN0aW9uOlwic2V0X2V4dGVybmFsX2NoZWNrb3V0XCIsYmlsbGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KHZlKHIpKSxzaGlwcGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KGZlKHIpKX0sdCYme2NhcnRfaWQ6dH0pKX0pfX1jb25zdCBQZT0kKGk9Pntjb25zdCBuPXdpbmRvdyxyPXQoKSxvPW5ldyB2KGkpLGE9bmV3IHEocixuLG8pLHM9bmV3IHllKGEpO3JldHVybiBuZXcgU2UoaSxlKCkscyl9LFt7aWQ6XCJicmFpbnRyZWV2ZW5tb1wifV0pO2Z1bmN0aW9uIEllKGUpe3JldHVybiBCb29sZWFuKGUuaW5zdHJ1bWVudElkKX1jbGFzcyBPZSBleHRlbmRzIGZ7Y29uc3RydWN0b3IoKXtzdXBlcihcIlRoZSBjdXJyZW50IG9yZGVyIGRvZXMgbm90IG5lZWQgdG8gYmUgZmluYWxpemVkIGF0IHRoaXMgc3RhZ2UuXCIpLHRoaXMubmFtZT1cIk9yZGVyRmluYWxpemF0aW9uTm90UmVxdWlyZWRFcnJvclwiLHRoaXMudHlwZT1cIm9yZGVyX2ZpbmFsaXphdGlvbl9ub3RfcmVxdWlyZWRcIn19ZnVuY3Rpb24ga2UoZSl7cmV0dXJuIShcIm9iamVjdFwiIT10eXBlb2YgZXx8bnVsbD09PWV8fHZvaWQgMCE9PWUuc2hvdWxkU2F2ZUluc3RydW1lbnQmJlwiYm9vbGVhblwiIT10eXBlb2YgZS5zaG91bGRTYXZlSW5zdHJ1bWVudHx8dm9pZCAwIT09ZS5zaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50JiZcImJvb2xlYW5cIiE9dHlwZW9mIGUuc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudCl9Y2xhc3MgRWUgZXh0ZW5kcyBme2NvbnN0cnVjdG9yKGUpe3N1cGVyKGV8fFwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgY2xpZW50IGxpYnJhcnkgb2YgYSBwYXltZW50IG1ldGhvZCBoYXMgdGhyb3duIGFuIHVuZXhwZWN0ZWQgZXJyb3IuXCIpLHRoaXMubmFtZT1cIlBheW1lbnRNZXRob2RGYWlsZWRFcnJvclwiLHRoaXMudHlwZT1cInBheW1lbnRfbWV0aG9kX2NsaWVudF9pbnZhbGlkXCJ9fWZ1bmN0aW9uIFRlKGUpe3JldHVybiEhZSYmXCJhY2NvdW50TnVtYmVyXCJpbiBlJiZcInJvdXRpbmdOdW1iZXJcImluIGUmJlwib3duZXJzaGlwVHlwZVwiaW4gZSYmXCJhY2NvdW50VHlwZVwiaW4gZX12YXIgQWU9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgemV7Y29uc3RydWN0b3IoZSx0KXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJyYWludHJlZVNkaz10fWluaXRpYWxpemUoZSl7cmV0dXJuIEFlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHttZXRob2RJZDp0LGJyYWludHJlZWFjaDppfT1lfHx7fTtpZighdCl0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt0aGlzLmdldE1hbmRhdGVUZXh0PW51bGw9PWk/dm9pZCAwOmkuZ2V0TWFuZGF0ZVRleHQseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKHQpO2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCkse2NsaWVudFRva2VuOnIsaW5pdGlhbGl6YXRpb25EYXRhOm99PW47aWYoIXJ8fCFvKXRocm93IG5ldyBHKEguTWlzc2luZ1BheW1lbnRNZXRob2QpO3RoaXMuYnJhaW50cmVlU2RrLmluaXRpYWxpemUocik7dHJ5e3RoaXMudXNCYW5rQWNjb3VudD15aWVsZCB0aGlzLmJyYWludHJlZVNkay5nZXRVc0JhbmtBY2NvdW50KCl9Y2F0Y2goZSl7dGhpcy5oYW5kbGVCcmFpbnRyZWVFcnJvcihlKX19KX1leGVjdXRlKGUsdCl7cmV0dXJuIEFlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Oml9PWUsbj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSk7aWYoIWkpdGhyb3cgbmV3IEMoW1wicGF5bWVudFwiXSk7Y29uc3Qgcj1JZShpLnBheW1lbnREYXRhfHx7fSksbz1yP3lpZWxkIHRoaXMudG9rZW5pemVQYXltZW50Rm9yVmF1bHRlZEluc3RydW1lbnQoaSk6eWllbGQgdGhpcy50b2tlbml6ZVBheW1lbnQoaSksYT1yP3lpZWxkIHRoaXMucHJlcGFyZVBheW1lbnREYXRhRm9yVmF1bHRlZEluc3RydW1lbnQobyxpKTp5aWVsZCB0aGlzLnByZXBhcmVQYXltZW50RGF0YShvLGkpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihuLHQpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGEpfSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IE9lKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gQWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB5aWVsZCB0aGlzLmJyYWludHJlZVNkay5kZWluaXRpYWxpemUoKSxQcm9taXNlLnJlc29sdmUoKX0pfXRva2VuaXplUGF5bWVudCh7cGF5bWVudERhdGE6ZX0pe3JldHVybiBBZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLmdldFVzQmFua0FjY291bnRPclRocm93KCk7aWYoIVRlKGUpKXRocm93IG5ldyBDKFtcInBheW1lbnQucGF5bWVudERhdGFcIl0pO2NvbnN0IGk9SWUoZSk/XCJUaGUgZGF0YSBhcmUgdXNlZCBmb3Igc3RvcmVkIGluc3RydW1lbnQgdmVyaWZpY2F0aW9uXCI6XCJmdW5jdGlvblwiPT10eXBlb2YgdGhpcy5nZXRNYW5kYXRlVGV4dCYmdGhpcy5nZXRNYW5kYXRlVGV4dCgpO2lmKCFpKXRocm93IG5ldyB3KFwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBnZXRNYW5kYXRlVGV4dCBpcyBub3QgcHJvdmlkZWQgb3IgcmV0dXJuZWQgdW5kZWZpbmVkIHZhbHVlLlwiKTt0cnl7Y29uc3R7bm9uY2U6bn09eWllbGQgdC50b2tlbml6ZSh7YmFua0RldGFpbHM6dGhpcy5nZXRCYW5rRGV0YWlscyhlKSxtYW5kYXRlVGV4dDppfSk7cmV0dXJuIG59Y2F0Y2goZSl7dGhpcy5oYW5kbGVCcmFpbnRyZWVFcnJvcihlKX19KX10b2tlbml6ZVBheW1lbnRGb3JWYXVsdGVkSW5zdHJ1bWVudChlKXtyZXR1cm4gQWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e21ldGhvZElkOnQscGF5bWVudERhdGE6aT17fX09ZSxuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHtjb25maWc6cn09bi5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyh0KTtpZighci5pc1ZhdWx0aW5nRW5hYmxlZCl0aHJvdyBuZXcgdyhcIlZhdWx0aW5nIGlzIGRpc2FibGVkIGJ1dCBhIHZhdWx0ZWQgaW5zdHJ1bWVudCB3YXMgYmVpbmcgdXNlZCBmb3IgdGhpcyB0cmFuc2FjdGlvblwiKTtyZXR1cm4gVGUoaSk/dGhpcy50b2tlbml6ZVBheW1lbnQoZSk6bnVsbH0pfXByZXBhcmVQYXltZW50RGF0YShlLHQpe3JldHVybiBBZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6aSxwYXltZW50RGF0YTpuPXt9fT10O2lmKCFUZShuKSl0aHJvdyBuZXcgQyhbXCJwYXltZW50LnBheW1lbnREYXRhXCJdKTtjb25zdHtkZXZpY2VEYXRhOnJ9PXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldERhdGFDb2xsZWN0b3JPclRocm93KCkse3Nob3VsZFNhdmVJbnN0cnVtZW50Om8sc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDphLHJvdXRpbmdOdW1iZXI6cyxhY2NvdW50TnVtYmVyOmR9PW47cmV0dXJue21ldGhvZElkOmkscGF5bWVudERhdGE6e2RldmljZVNlc3Npb25JZDpyLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6YSxzaG91bGRTYXZlSW5zdHJ1bWVudDpvLGZvcm1hdHRlZFBheWxvYWQ6e3Rva2VuaXplZF9iYW5rX2FjY291bnQ6e2lzc3VlcjpzLG1hc2tlZF9hY2NvdW50X251bWJlcjpkLnN1YnN0cigtNCksdG9rZW46ZX19fX19KX1wcmVwYXJlUGF5bWVudERhdGFGb3JWYXVsdGVkSW5zdHJ1bWVudChlLHQpe3JldHVybiBBZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6aSxwYXltZW50RGF0YTpuPXt9fT10O2lmKCFJZShuKXx8IWtlKG4pKXRocm93IG5ldyBDKFtcInBheW1lbnQucGF5bWVudERhdGFcIl0pO2NvbnN0e2RldmljZURhdGE6cn09eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0RGF0YUNvbGxlY3Rvck9yVGhyb3coKSx7aW5zdHJ1bWVudElkOm8sc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDphfT1uO3JldHVybnttZXRob2RJZDppLHBheW1lbnREYXRhOk9iamVjdC5hc3NpZ24oe2RldmljZVNlc3Npb25JZDpyLGluc3RydW1lbnRJZDpvLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6YX0sZSYme25vbmNlOmV9KX19KX1nZXRCYW5rRGV0YWlscyhlKXtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldEJpbGxpbmdBZGRyZXNzT3JUaHJvdygpLGk9ZS5vd25lcnNoaXBUeXBlLnRvTG93ZXJDYXNlKCksbj1lLmFjY291bnRUeXBlLnRvTG93ZXJDYXNlKCk7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7YWNjb3VudE51bWJlcjplLmFjY291bnROdW1iZXIscm91dGluZ051bWJlcjplLnJvdXRpbmdOdW1iZXIsb3duZXJzaGlwVHlwZTppfSxcInBlcnNvbmFsXCI9PT1pP3tmaXJzdE5hbWU6ZS5maXJzdE5hbWUsbGFzdE5hbWU6ZS5sYXN0TmFtZX06e2J1c2luZXNzTmFtZTplLmJ1c2luZXNzTmFtZX0pLHthY2NvdW50VHlwZTpuLGJpbGxpbmdBZGRyZXNzOntzdHJlZXRBZGRyZXNzOnQuYWRkcmVzczEsZXh0ZW5kZWRBZGRyZXNzOnQuYWRkcmVzczIsbG9jYWxpdHk6dC5jaXR5LHJlZ2lvbjp0LnN0YXRlT3JQcm92aW5jZUNvZGUscG9zdGFsQ29kZTp0LnBvc3RhbENvZGV9fSl9Z2V0VXNCYW5rQWNjb3VudE9yVGhyb3coKXtpZighdGhpcy51c0JhbmtBY2NvdW50KXRocm93IG5ldyBJKFAuUGF5bWVudE5vdEluaXRpYWxpemVkKTtyZXR1cm4gdGhpcy51c0JhbmtBY2NvdW50fWhhbmRsZUJyYWludHJlZUVycm9yKGUpe2lmKCFMKGUpKXRocm93IGU7dGhyb3cgbmV3IEVlKGUubWVzc2FnZSl9fWNvbnN0IE5lPSQoZT0+bmV3IHplKGUsKGU9Pntjb25zdCBpPW5ldyB2KGUpLG49bmV3IHEodCgpLHdpbmRvdyxpKTtyZXR1cm4gbmV3IHllKG4pfSkoZSkpLFt7aWQ6XCJicmFpbnRyZWVhY2hcIn1dKTtjbGFzcyBEZXtjb25zdHJ1Y3RvcihlKXtjb25zdHtlbGVtZW50OnQsY2xvc2VFbGVtZW50OmksbWFpbkVsZW1lbnQ6bn09dGhpcy5fY3JlYXRlRWxlbWVudHMoZSk7dGhpcy5fZWxlbWVudD10LHRoaXMuX2Nsb3NlRWxlbWVudD1pLHRoaXMuX21haW5FbGVtZW50PW59c2hvdyhlKXt0aGlzLl9tYWluRWxlbWVudC5wYXJlbnRFbGVtZW50fHwodGhpcy5fcmVnaXN0ZXJDbGljayhlKSxkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuX21haW5FbGVtZW50KSxzZXRUaW1lb3V0KCgpPT50aGlzLl9lbGVtZW50LnN0eWxlLm9wYWNpdHk9XCIxXCIpKX1yZW1vdmUoKXt0aGlzLl9tYWluRWxlbWVudC5wYXJlbnRFbGVtZW50JiYodGhpcy5fdW5yZWdpc3RlckNsaWNrJiZ0aGlzLl91bnJlZ2lzdGVyQ2xpY2soKSx0aGlzLl9yZW1vdmVBZnRlclRyYW5zaXRpb24oKSxzZXRUaW1lb3V0KCgpPT50aGlzLl9lbGVtZW50LnN0eWxlLm9wYWNpdHk9XCIwXCIpKX1fY3JlYXRlRWxlbWVudHMoZSl7Y29uc3QgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHtiYWNrZ3JvdW5kOmk9XCJyZ2JhKDAsIDAsIDAsIDAuOClcIixpZDpuPVwiY2hlY2tvdXRPdmVybGF5XCIsdHJhbnNpdGlvbkR1cmF0aW9uOnI9NDAwLGhhc0Nsb3NlQnV0dG9uOm89ITEsaW5uZXJIdG1sOmE9bnVsbH09ZXx8e307bGV0IHMsZCxsLGMsdT10O2lmKG4mJih0LmlkPW4pLGEpe2NvbnN0IGU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtjPWAke259LS1vdmVybGF5VGV4dGAsZS5jbGFzc05hbWU9YyxlLmFwcGVuZENoaWxkKGEpLHQuYXBwZW5kQ2hpbGQoZSl9cmV0dXJuIG8mJihsPWAke259LS1jbG9zZWAscz1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLHMuY2xhc3NOYW1lPWwsZD1gJHtufS0tbGF5b3V0YCx1PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksdS5jbGFzc05hbWU9ZCx1LmFwcGVuZENoaWxkKHQpLHUuYXBwZW5kQ2hpbGQocykpLHUuYXBwZW5kQ2hpbGQoZnVuY3Rpb24oZSl7Y29uc3R7aWQ6dCxiYWNrZ3JvdW5kOmksdHJhbnNpdGlvbkR1cmF0aW9uOm4sY2xhc3NMYXlvdXQ6cixjbGFzc092ZXJsYXlUZXh0Om8sY2xhc3NDbG9zZTphfT1lLHM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpLGQ9cj9gLCAuJHtyfWA6XCJcIjtyZXR1cm4gcy5pZD1gJHt0fS0tc3R5bGVzYCxzLnR5cGU9XCJ0ZXh0L2Nzc1wiLHMuaW5uZXJUZXh0PWBcXG4gICAgICAgICMke3R9JHtkfSB7XFxuICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XFxuICAgICAgICAgICAgaGVpZ2h0OiAxMDAlO1xcbiAgICAgICAgICAgIHdpZHRoOiAxMDAlO1xcbiAgICAgICAgICAgIGxlZnQ6IDA7XFxuICAgICAgICAgICAgdG9wOiAwO1xcbiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcXG4gICAgICAgICAgICB6LWluZGV4OiAyMTQ3NDgzNjQ3O1xcbiAgICAgICAgfVxcbiAgICAgICAgIyR7dH0ge1xcbiAgICAgICAgICAgIHRyYW5zaXRpb246IG9wYWNpdHkgJHtufW1zIGVhc2Utb3V0O1xcbiAgICAgICAgICAgIGJhY2tncm91bmQ6ICR7aX07XFxuICAgICAgICAgICAgb3BhY2l0eTogMDtcXG4gICAgICAgIH1cXG4gICAgYCxvJiYocy5pbm5lclRleHQrPWBcXG4gICAgICAgICAgICAgIyR7dH0ge1xcbiAgICAgICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xcbiAgICAgICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xcbiAgICAgICAgICAgICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjtcXG4gICAgICAgICAgICAgfVxcbiAgICAgICAgICAgICAjJHt0fSAuJHtvfSB7XFxuICAgICAgICAgICAgICAgIGNvbG9yOiB3aGl0ZTtcXG4gICAgICAgICAgICAgICAgbWF4LXdpZHRoOiAzMzBweDtcXG4gICAgICAgICAgICAgICAgZm9udC1zaXplOiAxLjJlbTtcXG4gICAgICAgICAgICAgICAgdGV4dC1hbGlnbjogY2VudGVyO1xcbiAgICAgICAgICAgICB9XFxuICAgICAgICBgKSxhJiYocy5pbm5lclRleHQrPWBcXG4gICAgICAgICAgICAjJHt0fSB7XFxuICAgICAgICAgICAgICAgIG9wYWNpdHk6IDE7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIC4ke3J9IC4ke2F9IHtcXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGZpeGVkO1xcbiAgICAgICAgICAgICAgICByaWdodDogMTZweDtcXG4gICAgICAgICAgICAgICAgdG9wOiAxNnB4O1xcbiAgICAgICAgICAgICAgICB3aWR0aDogMTZweDtcXG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAxNnB4O1xcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAwLjY7XFxuICAgICAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjtcXG4gICAgICAgICAgICAgICAgei1pbmRleDogMzE0NzQ4MzY0NztcXG4gICAgICAgICAgICB9XFxuICAgICAgICAgICAgLiR7cn0gLiR7YX06OmFmdGVyLCAuJHtyfSAuJHthfTo6YmVmb3JlIHtcXG4gICAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlO1xcbiAgICAgICAgICAgICAgICBsZWZ0OiA4cHg7XFxuICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnO1xcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IDE2cHg7XFxuICAgICAgICAgICAgICAgIHdpZHRoOiAycHg7XFxuICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIC4ke3J9IC4ke2F9OjphZnRlciB7XFxuICAgICAgICAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKC00NWRlZyk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgICAgIC4ke3J9IC4ke2F9OjpiZWZvcmUge1xcbiAgICAgICAgICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZSg0NWRlZyk7XFxuICAgICAgICAgICAgfVxcbiAgICAgICAgYCksc30oe2lkOm4sYmFja2dyb3VuZDppLHRyYW5zaXRpb25EdXJhdGlvbjpyLGNsYXNzTGF5b3V0OmQsY2xhc3NPdmVybGF5VGV4dDpjLGNsYXNzQ2xvc2U6bH0pKSx7ZWxlbWVudDp0LGNsb3NlRWxlbWVudDpzLG1haW5FbGVtZW50OnV9fV9hZGRFdmVudExpc3RlbmVyKGUsdCl7ZSYmdCYmZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIix0KX1fcmVtb3ZlRXZlbnRMaXN0ZW5lcihlLHQpe2UmJnQmJmUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsdCl9X3JlZ2lzdGVyQ2xpY2soZSl7aWYodGhpcy5fdW5yZWdpc3RlckNsaWNrJiZ0aGlzLl91bnJlZ2lzdGVyQ2xpY2soKSxlKXtjb25zdHtvbkNsaWNrOnQsb25DbGlja0Nsb3NlOml9PWU7dGhpcy5fYWRkRXZlbnRMaXN0ZW5lcih0aGlzLl9lbGVtZW50LHQpLHRoaXMuX2FkZEV2ZW50TGlzdGVuZXIodGhpcy5fY2xvc2VFbGVtZW50LGkpLHRoaXMuX3VucmVnaXN0ZXJDbGljaz0oKT0+e3RoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXIodGhpcy5fZWxlbWVudCx0KSx0aGlzLl9yZW1vdmVFdmVudExpc3RlbmVyKHRoaXMuX2Nsb3NlRWxlbWVudCxpKSx0aGlzLl91bnJlZ2lzdGVyQ2xpY2s9dm9pZCAwfX19X3JlbW92ZUFmdGVyVHJhbnNpdGlvbigpe2NvbnN0IGU9dD0+e1wib3BhY2l0eVwiPT09dC5wcm9wZXJ0eU5hbWUmJih0aGlzLl9tYWluRWxlbWVudC5wYXJlbnRFbGVtZW50JiZ0aGlzLl9tYWluRWxlbWVudC5yZW1vdmUoKSx0aGlzLl9lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsZSkpfTt0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0cmFuc2l0aW9uZW5kXCIsZSl9fWNvbnN0IE1lPXtzaXplOjcwLGNvbG9yOlwiI2Q5ZDlkOVwiLGJhY2tncm91bmRDb2xvcjpcIiNmZmZmZmZcIn0sX2U9XCJlbWJlZGRlZC1jaGVja291dC1sb2FkaW5nLWluZGljYXRvci1yb3RhdGlvblwiO2NsYXNzIEJle2NvbnN0cnVjdG9yKGUpe3RoaXMuc3R5bGVzPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxNZSksZSYmZS5zdHlsZXMpLHRoaXMuY29udGFpbmVyU3R5bGVzPU9iamVjdC5hc3NpZ24oe30sZSYmZS5jb250YWluZXJTdHlsZXMpLHRoaXMuZGVmaW5lQW5pbWF0aW9uKCksdGhpcy5jb250YWluZXI9dGhpcy5idWlsZENvbnRhaW5lcigpLHRoaXMuaW5kaWNhdG9yPXRoaXMuYnVpbGRJbmRpY2F0b3IoKSx0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLmluZGljYXRvcil9c2hvdyhlKXtpZihlKXtjb25zdCB0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGUpO2lmKCF0KXRocm93IG5ldyBFcnJvcihcIlVuYWJsZSB0byBhdHRhY2ggdGhlIGxvYWRpbmcgaW5kaWNhdG9yIGJlY2F1c2UgdGhlIHBhcmVudCBJRCBpcyBub3QgdmFsaWQuXCIpO3QuYXBwZW5kQ2hpbGQodGhpcy5jb250YWluZXIpfXRoaXMuY29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHk9XCJ2aXNpYmxlXCIsdGhpcy5jb250YWluZXIuc3R5bGUub3BhY2l0eT1cIjFcIn1oaWRlKCl7Y29uc3QgZT0oKT0+e3RoaXMuY29udGFpbmVyLnN0eWxlLnZpc2liaWxpdHk9XCJoaWRkZW5cIix0aGlzLmNvbnRhaW5lci5yZW1vdmVFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLGUpfTt0aGlzLmNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKFwidHJhbnNpdGlvbmVuZFwiLGUpLHRoaXMuY29udGFpbmVyLnN0eWxlLm9wYWNpdHk9XCIwXCJ9YnVpbGRDb250YWluZXIoKXtjb25zdCBlPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7cmV0dXJuIGUuc3R5bGUuZGlzcGxheT1cImJsb2NrXCIsZS5zdHlsZS5ib3R0b209XCIwXCIsZS5zdHlsZS5sZWZ0PVwiMFwiLGUuc3R5bGUuaGVpZ2h0PVwiMTAwJVwiLGUuc3R5bGUud2lkdGg9XCIxMDAlXCIsZS5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCIsZS5zdHlsZS5yaWdodD1cIjBcIixlLnN0eWxlLnRvcD1cIjBcIixlLnN0eWxlLnRyYW5zaXRpb249XCJhbGwgMjUwbXMgZWFzZS1vdXRcIixlLnN0eWxlLm9wYWNpdHk9XCIwXCIsdGhpcy5zZXRTdHlsZUF0dHJpYnV0ZShlLHRoaXMuY29udGFpbmVyU3R5bGVzKSxlfWJ1aWxkSW5kaWNhdG9yKCl7Y29uc3QgZT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3JldHVybiBlLnN0eWxlLmRpc3BsYXk9XCJibG9ja1wiLGUuc3R5bGUud2lkdGg9YCR7dGhpcy5zdHlsZXMuc2l6ZX1weGAsZS5zdHlsZS5oZWlnaHQ9YCR7dGhpcy5zdHlsZXMuc2l6ZX1weGAsZS5zdHlsZS5ib3JkZXJSYWRpdXM9YCR7dGhpcy5zdHlsZXMuc2l6ZX1weGAsZS5zdHlsZS5ib3JkZXI9XCJzb2xpZCAxcHhcIixlLnN0eWxlLmJvcmRlckNvbG9yPWAke3RoaXMuc3R5bGVzLmJhY2tncm91bmRDb2xvcn0gJHt0aGlzLnN0eWxlcy5iYWNrZ3JvdW5kQ29sb3J9ICR7dGhpcy5zdHlsZXMuY29sb3J9ICR7dGhpcy5zdHlsZXMuY29sb3J9YCxlLnN0eWxlLm1hcmdpbj1cIjAgYXV0b1wiLGUuc3R5bGUucG9zaXRpb249XCJhYnNvbHV0ZVwiLGUuc3R5bGUubGVmdD1cIjBcIixlLnN0eWxlLnJpZ2h0PVwiMFwiLGUuc3R5bGUudG9wPVwiNTAlXCIsZS5zdHlsZS50cmFuc2Zvcm09XCJ0cmFuc2xhdGVZKC01MCUpIHJvdGF0ZSgwZGVnKVwiLGUuc3R5bGUudHJhbnNmb3JtU3R5bGU9XCJwcmVzZXJ2ZS0zZFwiLGUuc3R5bGUuYW5pbWF0aW9uPWAke19lfSA1MDBtcyBpbmZpbml0ZSBjdWJpYy1iZXppZXIoMC42OSwgMC4zMSwgMC41NiwgMC44MylgLGV9c2V0U3R5bGVBdHRyaWJ1dGUoZSx0KXtPYmplY3Qua2V5cyh0KS5mb3JFYWNoKGk9PntlLnN0eWxlLnNldFByb3BlcnR5KGksdFtpXSl9KX1kZWZpbmVBbmltYXRpb24oKXt2YXIgZTtpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChfZSkpcmV0dXJuO2NvbnN0IHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO3QuaWQ9X2UsbnVsbD09PShlPWRvY3VtZW50LmhlYWQpfHx2b2lkIDA9PT1lfHxlLmFwcGVuZENoaWxkKHQpLHQuc2hlZXQgaW5zdGFuY2VvZiBDU1NTdHlsZVNoZWV0JiZ0LnNoZWV0Lmluc2VydFJ1bGUoYFxcbiAgICAgICAgICAgICAgICBAa2V5ZnJhbWVzICR7X2V9IHtcXG4gICAgICAgICAgICAgICAgICAgIDAlIHsgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpIHJvdGF0ZSgwZGVnKTsgfVxcbiAgICAgICAgICAgICAgICAgICAgMTAwJSB7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKSByb3RhdGUoMzYwZGVnKTsgfVxcbiAgICAgICAgICAgICAgICB9XFxuICAgICAgICAgICAgYCwwKX19Y29uc3QgeGU9e1wiYmFja2dyb3VuZC1jb2xvclwiOlwicmdiYSgwLCAwLCAwLCAwLjQpXCIsXCJ6LWluZGV4XCI6XCIxMDAwXCJ9O3ZhciBGZT1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBMZXtjb25zdHJ1Y3RvcihlLHQsaSxuKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT10LHRoaXMuYnJhaW50cmVlTWVzc2FnZXM9aSx0aGlzLmxvYWRpbmdJbmRpY2F0b3I9bix0aGlzLmJyYWludHJlZUhvc3RXaW5kb3c9d2luZG93fWluaXRpYWxpemUoZSl7cmV0dXJuIEZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWU6dCxtZXRob2RJZDppfT1lO2lmKHRoaXMuYnJhaW50cmVlPXQsdGhpcy5wYXltZW50TWV0aG9kJiZ0aGlzLnBheW1lbnRNZXRob2Qubm9uY2V8fCh0aGlzLnBheW1lbnRNZXRob2Q9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSkpLHRoaXMucGF5bWVudE1ldGhvZC5jbGllbnRUb2tlbiYmKG51bGw9PXQ/dm9pZCAwOnQuYmFubmVyQ29udGFpbmVySWQpKXJldHVybiB5aWVsZCB0aGlzLmxvYWRQYXlwYWwoKSx0aGlzLmxvYWRQYXlwYWxDaGVja291dEluc3RhbmNlKCk7aWYodGhpcy5wYXltZW50TWV0aG9kLmNsaWVudFRva2VuKXJldHVybiB0aGlzLmxvYWRQYXlwYWwoKTtjb25zdCBuPXlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKTtpZih0aGlzLnBheW1lbnRNZXRob2Q9bi5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSxudWxsPT10P3ZvaWQgMDp0LmJhbm5lckNvbnRhaW5lcklkKXJldHVybiB0aGlzLmxvYWRQYXlwYWxDaGVja291dEluc3RhbmNlKCk7aWYoIXRoaXMucGF5bWVudE1ldGhvZC5jbGllbnRUb2tlbil0aHJvdyBuZXcgRyhILk1pc3NpbmdQYXltZW50TWV0aG9kKTtyZXR1cm4gdGhpcy5sb2FkUGF5cGFsKCl9KX1leGVjdXRlKGUsdCl7dmFyIGk7cmV0dXJuIEZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50Om59PWUscj1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSkse29uRXJyb3I6b309dGhpcy5icmFpbnRyZWV8fHt9O2lmKCFuKXRocm93IG5ldyBDKFtcInBheW1lbnRcIl0pO3RyeXtjb25zdCBlPXlpZWxkIHRoaXMucHJlcGFyZVBheW1lbnREYXRhKG4sci51c2VTdG9yZUNyZWRpdCk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKHIsdCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoZSl9Y2F0Y2goZSl7dGhpcy5pc1Byb3ZpZGVyRXJyb3IoZSkmJih5aWVsZCB0aGlzLmxvYWRQYXlwYWwoKSxudWxsPT09KGk9dGhpcy5wYXlwYWxCdXR0b25SZW5kZXIpfHx2b2lkIDA9PT1pfHxpLmNsb3NlKCkseWllbGQgdGhpcy5sb2FkUGF5cGFsQ2hlY2tvdXRJbnN0YW5jZSgpLHlpZWxkIG5ldyBQcm9taXNlKChlLHQpPT57byYmXCJmdW5jdGlvblwiPT10eXBlb2YgbyYmbyhuZXcgRXJyb3IoXCJJTlNUUlVNRU5UX0RFQ0xJTkVEXCIpKSx0KCl9KSksdGhpcy5oYW5kbGVFcnJvcihlKX19KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgT2UpfWRlaW5pdGlhbGl6ZSgpe3ZhciBlO3JldHVybiB0aGlzLmJyYWludHJlZVRva2VuaXplUGF5bG9hZD12b2lkIDAsbnVsbD09PShlPXRoaXMucGF5cGFsQnV0dG9uUmVuZGVyKXx8dm9pZCAwPT09ZXx8ZS5jbG9zZSgpLHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRlYXJkb3duKCl9cHJlcGFyZVBheW1lbnREYXRhKGUsdCl7dmFyIGk7cmV0dXJuIEZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHI9bi5nZXRPdXRzdGFuZGluZ0JhbGFuY2UodCksbz1uLmdldFN0b3JlQ29uZmlnKCk7aWYoIXIpdGhyb3cgbmV3IEcoSC5NaXNzaW5nQ2hlY2tvdXQpO2lmKCFvKXRocm93IG5ldyBHKEguTWlzc2luZ0NoZWNrb3V0Q29uZmlnKTtpZighdGhpcy5wYXltZW50TWV0aG9kKXRocm93IG5ldyBJKFAuUGF5bWVudE5vdEluaXRpYWxpemVkKTtjb25zdHtjdXJyZW5jeTphLHN0b3JlUHJvZmlsZTp7c3RvcmVMYW5ndWFnZTpzfX09byx7bm9uY2U6ZCxjb25maWc6e2lzVmF1bHRpbmdFbmFibGVkOmx9fT10aGlzLnBheW1lbnRNZXRob2Qse21ldGhvZElkOmMscGF5bWVudERhdGE6dT17fX09ZSxoPShudWxsPT09KGk9dGhpcy5icmFpbnRyZWVUb2tlbml6ZVBheWxvYWQpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLm5vbmNlKXx8ZDtpZihoKXtjb25zdCB0PXlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChjKTtyZXR1cm4gdGhpcy5wYXltZW50TWV0aG9kPXQuZ2V0UGF5bWVudE1ldGhvZChjKSxPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3BheW1lbnREYXRhOnRoaXMuZm9ybWF0dGVkUGF5bG9hZChoKX0pfWlmKEllKHUpfHwoeT11LEJvb2xlYW4oeS5pbnN0cnVtZW50SWQpJiYhT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHksXCJjY051bWJlclwiKSYmIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh5LFwiY2NDdnZcIikpKXtpZighbCl0aHJvdyBuZXcgdyhcIlZhdWx0aW5nIGlzIGRpc2FibGVkIGJ1dCBhIHZhdWx0ZWQgaW5zdHJ1bWVudCB3YXMgYmVpbmcgdXNlZCBmb3IgdGhpcyB0cmFuc2FjdGlvblwiKTtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGUpfXZhciB5O2lmKCFrZSh1KSl0aHJvdyBuZXcgRyhILk1pc3NpbmdQYXltZW50KTtjb25zdHtzaG91bGRTYXZlSW5zdHJ1bWVudDptLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6cH09dTtpZihtJiYhbCl0aHJvdyBuZXcgdyhcIlZhdWx0aW5nIGlzIGRpc2FibGVkIGJ1dCBzaG91bGRTYXZlSW5zdHJ1bWVudCBpcyBzZXQgdG8gdHJ1ZVwiKTtjb25zdCBnPW4uZ2V0U2hpcHBpbmdBZGRyZXNzKCksdj1nP1goZyk6dm9pZCAwO3JldHVybiBQcm9taXNlLmFsbChbdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UucGF5cGFsKHthbW91bnQ6cixsb2NhbGU6cyxjdXJyZW5jeTphLmNvZGUsb2ZmZXJDcmVkaXQ6XCJicmFpbnRyZWVwYXlwYWxjcmVkaXRcIj09PXRoaXMucGF5bWVudE1ldGhvZC5pZCxzaGlwcGluZ0FkZHJlc3NPdmVycmlkZTp2LHNob3VsZFNhdmVJbnN0cnVtZW50Om18fCExLHNoaXBwaW5nQWRkcmVzc0VkaXRhYmxlOiExfSksdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U2Vzc2lvbklkKCldKS50aGVuKChbe25vbmNlOnQsZGV0YWlsczppfT17fSxuXSk9Pk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7cGF5bWVudERhdGE6dGhpcy5mb3JtYXR0ZWRQYXlsb2FkKHQsaSYmaS5lbWFpbCxuLG0scCl9KSl9KX1mb3JtYXR0ZWRQYXlsb2FkKGUsdCxpLG4scil7cmV0dXJue2Zvcm1hdHRlZFBheWxvYWQ6e3ZhdWx0X3BheW1lbnRfaW5zdHJ1bWVudDpufHxudWxsLHNldF9hc19kZWZhdWx0X3N0b3JlZF9pbnN0cnVtZW50OnJ8fG51bGwsZGV2aWNlX2luZm86aXx8bnVsbCxwYXlwYWxfYWNjb3VudDp7dG9rZW46ZSxlbWFpbDp0fHxudWxsfX19fWxvYWRQYXlwYWxDaGVja291dEluc3RhbmNlKCl7cmV0dXJuIEZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtjbGllbnRUb2tlbjplLGluaXRpYWxpemF0aW9uRGF0YTp0LGlkOml9PXRoaXMucGF5bWVudE1ldGhvZHx8e307aWYoIWUpdGhyb3cgbmV3IEcoSC5NaXNzaW5nUGF5bWVudE1ldGhvZCk7dHJ5e3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmluaXRpYWxpemUoZSk7Y29uc3Qgbj17Y3VycmVuY3k6dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlLGludGVudDpudWxsPT10P3ZvaWQgMDp0LmludGVudCxpc0NyZWRpdEVuYWJsZWQ6bnVsbD09dD92b2lkIDA6dC5pc0NyZWRpdEVuYWJsZWR9LHI9XCJicmFpbnRyZWVwYXlwYWxjcmVkaXRcIj09PWl8fCEobnVsbD09dD92b2lkIDA6dC5pc0NyZWRpdEVuYWJsZWQpO3lpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheXBhbENoZWNrb3V0KG4sZT0+e3ZhciB0O3ImJmkmJihudWxsPT09KHQ9dGhpcy5icmFpbnRyZWUpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmJhbm5lckNvbnRhaW5lcklkKSYmdGhpcy5yZW5kZXJQYXlQYWxNZXNzYWdlcyhpLHRoaXMuYnJhaW50cmVlLmJhbm5lckNvbnRhaW5lcklkKSx0aGlzLnJlbmRlclBheVBhbEJ1dHRvbihlKX0sdGhpcy5oYW5kbGVFcnJvcil9Y2F0Y2goZSl7dGhpcy5oYW5kbGVFcnJvcihlKX19KX1yZW5kZXJQYXlQYWxNZXNzYWdlcyhlLHQpe3RoaXMuYnJhaW50cmVlTWVzc2FnZXMucmVuZGVyKGUsdCxfLlBBWU1FTlQpfXJlbmRlclBheVBhbEJ1dHRvbihlKXtjb25zdHtvblBheW1lbnRFcnJvcjp0LHN1Ym1pdEZvcm06aSxvblJlbmRlckJ1dHRvbjpuLGNvbnRhaW5lcklkOnIsb25FcnJvcjpvfT10aGlzLmJyYWludHJlZXx8e307aWYoIXIpcmV0dXJuO2lmKCF0aGlzLnBheW1lbnRNZXRob2QpdGhyb3cgbmV3IEkoUC5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO3RoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj1yLnNwbGl0KFwiI1wiKVsxXTtjb25zdHtpZDphLGNvbmZpZzp7dGVzdE1vZGU6c319PXRoaXMucGF5bWVudE1ldGhvZCx7cGF5cGFsOmR9PXRoaXMuYnJhaW50cmVlSG9zdFdpbmRvdyxsPW51bGw9PWQ/dm9pZCAwOmQuRlVORElORy5QQVlQQUw7ZCYmbD8odGhpcy5wYXlwYWxCdXR0b25SZW5kZXI9ZC5CdXR0b25zKHtlbnY6cz9cInNhbmRib3hcIjpcInByb2R1Y3Rpb25cIixjb21taXQ6ITEsZnVuZGluZ1NvdXJjZTpsLG9uQ2xpY2s6KCk9Pnt0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITApfSxjcmVhdGVPcmRlcjooKT0+dGhpcy5zZXR1cFBheW1lbnQoZSxhLHQpLG9uQXBwcm92ZTp0PT5GZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dGhpcy5icmFpbnRyZWVUb2tlbml6ZVBheWxvYWQ9eWllbGQgdGhpcy50b2tlbml6ZVBheW1lbnRPclRocm93KHQsZSksaSYmXCJmdW5jdGlvblwiPT10eXBlb2YgaSYmaSgpfSksb25DYW5jZWw6KCk9Pnt0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpfSxvbkVycm9yOmU9Pnt0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLG51bGw9PW98fG8oZSl9fSksbiYmXCJmdW5jdGlvblwiPT10eXBlb2YgbiYmbigpLHRoaXMucGF5cGFsQnV0dG9uUmVuZGVyLmlzRWxpZ2libGUoKSYmdGhpcy5wYXlwYWxCdXR0b25SZW5kZXIucmVuZGVyKGAke3J9YCkpOnRoaXMucmVtb3ZlRWxlbWVudChyLnNwbGl0KFwiI1wiKVsxXSl9c2V0dXBQYXltZW50KGUsdCxpKXtyZXR1cm4gRmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCk7dHJ5e2NvbnN0IGk9bi5nZXRDdXN0b21lcigpLHI9bi5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyh0KSxvPW4uZ2V0Q2hlY2tvdXRPclRocm93KCkub3V0c3RhbmRpbmdCYWxhbmNlLGE9bi5nZXRTdG9yZUNvbmZpZ09yVGhyb3coKS5jdXJyZW5jeS5jb2RlLHM9bi5nZXRTaGlwcGluZ0FkZHJlc3MoKXx8KG51bGw9PWk/dm9pZCAwOmkuYWRkcmVzc2VzWzBdKSxkPXM/WChzKTp2b2lkIDA7cmV0dXJuIHlpZWxkIGUuY3JlYXRlUGF5bWVudCh7ZmxvdzpcImNoZWNrb3V0XCIsZW5hYmxlU2hpcHBpbmdBZGRyZXNzOiEwLHNoaXBwaW5nQWRkcmVzc0VkaXRhYmxlOiExLHNoaXBwaW5nQWRkcmVzc092ZXJyaWRlOmQsYW1vdW50Om8sY3VycmVuY3k6YSxvZmZlckNyZWRpdDohMSxpbnRlbnQ6ci5pbml0aWFsaXphdGlvbkRhdGEuaW50ZW50fSl9Y2F0Y2goZSl7dGhyb3cgaSYmKGJlKGUpfHxlIGluc3RhbmNlb2YgZikmJmkoZSksZX19KX10b2tlbml6ZVBheW1lbnRPclRocm93KGUsdCxpKXtyZXR1cm4gRmUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtyZXR1cm4geWllbGQgdC50b2tlbml6ZVBheW1lbnQoZSl9Y2F0Y2goZSl7dGhyb3cgaSYmKGJlKGUpfHxlIGluc3RhbmNlb2YgZikmJmkoZSksZX19KX1sb2FkUGF5cGFsKCl7cmV0dXJuIEZlKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtjbGllbnRUb2tlbjplLGluaXRpYWxpemF0aW9uRGF0YTp0fT10aGlzLnBheW1lbnRNZXRob2R8fHt9O2lmKCFlfHwhdCl0aHJvdyBuZXcgRyhILk1pc3NpbmdQYXltZW50TWV0aG9kKTt0cnl7dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuaW5pdGlhbGl6ZShlKSx5aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRQYXlwYWwoKX1jYXRjaChlKXt0aGlzLmhhbmRsZUVycm9yKGUpfXJldHVybiBQcm9taXNlLnJlc29sdmUoKX0pfWhhbmRsZUVycm9yKGUpe2lmKCFiZShlKSl0aHJvdyBlO2lmKFwiUEFZUEFMX1BPUFVQX0NMT1NFRFwiPT09ZS5jb2RlKXRocm93IG5ldyBPKGUubWVzc2FnZSk7dGhyb3cgbmV3IEVlKGUubWVzc2FnZSl9aXNQcm92aWRlckVycm9yKGUpe3ZhciB0LGksbjtyZXR1cm4hIWZ1bmN0aW9uKGUpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmXCJlcnJvcnNcImluIGV9KGUpJiZcIjIwNDZcIj09PShudWxsPT09KG49bnVsbD09PShpPSgobnVsbD09PSh0PW51bGw9PWU/dm9pZCAwOmUuZXJyb3JzKXx8dm9pZCAwPT09dD92b2lkIDA6dC5maWx0ZXIoZT0+ZS5wcm92aWRlcl9lcnJvcikpfHxbXSlbMF0pfHx2b2lkIDA9PT1pP3ZvaWQgMDppLnByb3ZpZGVyX2Vycm9yKXx8dm9pZCAwPT09bj92b2lkIDA6bi5jb2RlKX1yZW1vdmVFbGVtZW50KGUpe2NvbnN0IHQ9ZSYmZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZSk7dCYmdC5yZW1vdmUoKX10b2dnbGVMb2FkaW5nSW5kaWNhdG9yKGUpe2UmJnRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcj90aGlzLmxvYWRpbmdJbmRpY2F0b3Iuc2hvdyh0aGlzLmxvYWRpbmdJbmRpY2F0b3JDb250YWluZXIpOnRoaXMubG9hZGluZ0luZGljYXRvci5oaWRlKCl9fWNvbnN0IFZlPSQoZT0+e2NvbnN0IGk9d2luZG93LG49bmV3IERlLHI9bmV3IHYoZSksbz1uZXcgaihuZXcgcSh0KCksaSxyKSxpLG4pLGE9bmV3IHRlKGUpO3JldHVybiBuZXcgTGUoZSxvLGEsbmV3IEJlKHtjb250YWluZXJTdHlsZXM6eGV9KSl9LFt7aWQ6XCJicmFpbnRyZWVwYXlwYWxcIn0se2lkOlwiYnJhaW50cmVlcGF5cGFsY3JlZGl0XCJ9XSk7dmFyIGplOyFmdW5jdGlvbihlKXtlLkpzb249XCJhcHBsaWNhdGlvbi9qc29uXCIsZS5Kc29uVjE9XCJhcHBsaWNhdGlvbi92bmQuYmMudjEranNvblwifShqZXx8KGplPXt9KSk7Y29uc3QgVWU9amUsUmU9e1wiWC1DaGVja291dC1TREstVmVyc2lvblwiOlwiMS44NjcuMFwifTtjbGFzcyBIZXtjb25zdHJ1Y3RvcihlKXt0aGlzLnJlcXVlc3RTZW5kZXI9ZX1nZXRPcmRlclN0YXR1cyhlPVwiYnJhaW50cmVlbG9jYWxtZXRob2RzXCIsdCl7cmV0dXJuIGk9dGhpcyxuPXZvaWQgMCxvPWZ1bmN0aW9uKigpe2NvbnN0IGk9YC9hcGkvc3RvcmVmcm9udC9pbml0aWFsaXphdGlvbi8ke2V9YCxuPU9iamVjdC5hc3NpZ24oe1wiWC1BUEktSU5URVJOQUxcIjpcIlRoaXMgQVBJIGVuZHBvaW50IGlzIGZvciBpbnRlcm5hbCB1c2Ugb25seSBhbmQgbWF5IGNoYW5nZSBpbiB0aGUgZnV0dXJlXCIsXCJDb250ZW50LVR5cGVcIjpVZS5Kc29ufSxSZSk7cmV0dXJuKHlpZWxkIHRoaXMucmVxdWVzdFNlbmRlci5nZXQoaSxPYmplY3QuYXNzaWduKHtoZWFkZXJzOm59LHQpKSkuYm9keX0sbmV3KChyPXZvaWQgMCl8fChyPVByb21pc2UpKShmdW5jdGlvbihlLHQpe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qoby5uZXh0KGUpKX1jYXRjaChlKXt0KGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG8udGhyb3coZSkpfWNhdGNoKGUpe3QoZSl9fWZ1bmN0aW9uIGQodCl7dmFyIGk7dC5kb25lP2UodC52YWx1ZSk6KGk9dC52YWx1ZSxpIGluc3RhbmNlb2Ygcj9pOm5ldyByKGZ1bmN0aW9uKGUpe2UoaSl9KSkudGhlbihhLHMpfWQoKG89by5hcHBseShpLG58fFtdKSkubmV4dCgpKX0pO3ZhciBpLG4scixvfX1jb25zdCBXZT17Ym9keTp7fSxoZWFkZXJzOnt9LHN0YXR1czowfTtjbGFzcyBxZSBleHRlbmRzIGZ7Y29uc3RydWN0b3IoZSx7bWVzc2FnZTp0LGVycm9yczppfT17fSl7Y29uc3R7Ym9keTpuLGhlYWRlcnM6cixzdGF0dXM6b309ZXx8V2U7c3VwZXIodHx8XCJBbiB1bmV4cGVjdGVkIGVycm9yIGhhcyBvY2N1cnJlZC5cIiksdGhpcy5uYW1lPVwiUmVxdWVzdEVycm9yXCIsdGhpcy50eXBlPVwicmVxdWVzdFwiLHRoaXMuYm9keT1uLHRoaXMuaGVhZGVycz1yLHRoaXMuc3RhdHVzPW8sdGhpcy5lcnJvcnM9aXx8W119fWNsYXNzICRlIGV4dGVuZHMgcWV7Y29uc3RydWN0b3IoZSl7c3VwZXIoZSx7bWVzc2FnZTpcIlRoZXJlIGlzIGEgcHJvYmxlbSBwcm9jZXNzaW5nIHlvdXIgcGF5bWVudC4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIn0pLHRoaXMubmFtZT1cIlBheW1lbnRNZXRob2RJbnZhbGlkRXJyb3JcIix0aGlzLnR5cGU9XCJwYXltZW50X21ldGhvZF9pbnZhbGlkXCJ9fWNsYXNzIEdlIGV4dGVuZHMgcWV7Y29uc3RydWN0b3IoZSl7c3VwZXIoZSx7bWVzc2FnZTpcIlRoZSByZXF1ZXN0IGhhcyB0aW1lZCBvdXQgb3IgYWJvcnRlZC5cIn0pLHRoaXMubmFtZT1cIlRpbWVvdXRFcnJvclwiLHRoaXMudHlwZT1cInRpbWVvdXRcIn19dmFyIFllPWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIEple2NvbnN0cnVjdG9yKGUsdCxpLG4scj0zZTMsbz0zZTUpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYnJhaW50cmVlU2RrPXQsdGhpcy5icmFpbnRyZWVSZXF1ZXN0U2VuZGVyPWksdGhpcy5sb2FkaW5nSW5kaWNhdG9yPW4sdGhpcy5wb2xsaW5nSW50ZXJ2YWw9cix0aGlzLm1heFBvbGxpbmdJbnRlcnZhbFRpbWU9byx0aGlzLmlzTFBNc1VwZGF0ZUV4cGVyaW1lbnRFbmFibGVkPSExLHRoaXMucG9sbGluZ1RpbWVyPTAsdGhpcy5zdG9wUG9sbGluZz1hLHRoaXMuaXNQb2xsaW5nRW5hYmxlZD0hMX1pbml0aWFsaXplKGUpe3JldHVybiBZZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7Z2F0ZXdheUlkOnQsbWV0aG9kSWQ6aSxicmFpbnRyZWVsb2NhbG1ldGhvZHM6bn09ZTtpZih0aGlzLmdhdGV3YXlJZD10LCFpKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCF0KXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmdhdGV3YXlJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighbil0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVsb2NhbG1ldGhvZHNcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7dGhpcy5icmFpbnRyZWVsb2NhbG1ldGhvZHM9bix0aGlzLmxvYWRpbmdJbmRpY2F0b3JDb250YWluZXI9bi5jb250YWluZXIuc3BsaXQoXCIjXCIpWzFdLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZCh0KTtjb25zdCByPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG89ci5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyh0KSx7Y2xpZW50VG9rZW46YSxjb25maWc6cyxpbml0aWFsaXphdGlvbkRhdGE6ZH09byxsPXIuZ2V0U3RvcmVDb25maWdPclRocm93KCkuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlcztpZih0aGlzLmlzUG9sbGluZ0VuYWJsZWQ9eShsLFwiUEFZUEFMLTUyNTguYnJhaW50cmVlX2xvY2FsX21ldGhvZHNfcG9sbGluZ1wiKSx0aGlzLmlzTFBNc1VwZGF0ZUV4cGVyaW1lbnRFbmFibGVkPXkobCxcIlBBWVBBTC00ODUzLmFkZF9uZXdfcGF5bWVudF9mbG93X2Zvcl9icmFpbnRyZWVfbHBtc1wiKSwhYXx8IWR8fCFzLm1lcmNoYW50SWQpdGhyb3cgbmV3IEcoSC5NaXNzaW5nUGF5bWVudE1ldGhvZCk7dHJ5e3RoaXMuYnJhaW50cmVlU2RrLmluaXRpYWxpemUoYSksdGhpcy5pc05vbkluc3RhbnRQYXltZW50TWV0aG9kKGkpfHwodGhpcy5icmFpbnRyZWVMb2NhbFBheW1lbnQ9eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0QnJhaW50cmVlTG9jYWxQYXltZW50KHMubWVyY2hhbnRJZCkpfWNhdGNoKGUpe3RoaXMuaGFuZGxlRXJyb3IoZSl9fSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IE9lKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gWWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLFByb21pc2UucmVzb2x2ZSgpfSl9ZXhlY3V0ZShlLHQpe3JldHVybiBZZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7cGF5bWVudDppfT1lLG49ZnVuY3Rpb24oZSx0KXt2YXIgaT17fTtmb3IodmFyIG4gaW4gZSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZSxuKSYmdC5pbmRleE9mKG4pPDAmJihpW25dPWVbbl0pO2lmKG51bGwhPWUmJlwiZnVuY3Rpb25cIj09dHlwZW9mIE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpe3ZhciByPTA7Zm9yKG49T2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhlKTtyPG4ubGVuZ3RoO3IrKyl0LmluZGV4T2YobltyXSk8MCYmT2JqZWN0LnByb3RvdHlwZS5wcm9wZXJ0eUlzRW51bWVyYWJsZS5jYWxsKGUsbltyXSkmJihpW25bcl1dPWVbbltyXV0pfXJldHVybiBpfShlLFtcInBheW1lbnRcIl0pO2lmKCFpKXRocm93IG5ldyBDKFtcInBheW1lbnRcIl0pO2NvbnN0e21ldGhvZElkOnJ9PWk7dGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCEwKSx0aGlzLmlzTm9uSW5zdGFudFBheW1lbnRNZXRob2Qocik/eWllbGQgdGhpcy5leGVjdXRlV2l0aE5vdEluc3RhbnRMUE0ocik6eWllbGQgdGhpcy5leGVjdXRlV2l0aEluc3RhbnRMUE0ocixuLHQpfSl9ZXhlY3V0ZVdpdGhOb3RJbnN0YW50TFBNKGUpe3JldHVybiBZZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e2NvbnN0IHQ9eWllbGQgdGhpcy5nZXRMUE1zQmFzaWNQYXltZW50RGF0YSgpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcigpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KHttZXRob2RJZDplLHBheW1lbnREYXRhOk9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7Zm9ybWF0dGVkUGF5bG9hZDp7bWV0aG9kOmV9fSl9KX1jYXRjaChlKXtpZih0aGlzLmlzQnJhaW50cmVlUmVkaXJlY3RFcnJvcihlKSl7Y29uc3QgdD1lLmJvZHkuYWRkaXRpb25hbF9hY3Rpb25fcmVxdWlyZWQuZGF0YS5yZWRpcmVjdF91cmw7cmV0dXJuIG5ldyBQcm9taXNlKChlLGkpPT57d2luZG93LmxvY2F0aW9uLnJlcGxhY2UodCksdGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKSxpKCl9KX1yZXR1cm4gdGhpcy5oYW5kbGVFcnJvcihlKSxQcm9taXNlLnJlamVjdChlKX19KX1leGVjdXRlV2l0aEluc3RhbnRMUE0oZSx0LGkpe3JldHVybiBZZSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuYnJhaW50cmVlTG9jYWxQYXltZW50KXRocm93IG5ldyAkZTt5aWVsZCBuZXcgUHJvbWlzZSgobixyKT0+e3ZhciBvO251bGw9PT0obz10aGlzLmJyYWludHJlZUxvY2FsUGF5bWVudCl8fHZvaWQgMD09PW98fG8uc3RhcnRQYXltZW50KHRoaXMuZ2V0SW5zdGFudExQTUNvbmZpZyhlLHQsaSksdGhpcy5nZXRJbnN0YW50TFBNQ2FsbGJhY2sobixyLGUsdCxpKSl9KX0pfWdldExQTXNCYXNpY1BheW1lbnREYXRhKCl7cmV0dXJuIFllKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtkZXZpY2VEYXRhOmV9PXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldERhdGFDb2xsZWN0b3JPclRocm93KCk7cmV0dXJue2RldmljZVNlc3Npb25JZDplfX0pfWdldEluc3RhbnRMUE1Db25maWcoZSx0LGkpe2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkscj1uLmdldENhcnRPclRocm93KCksbz1uLmdldEJpbGxpbmdBZGRyZXNzT3JUaHJvdygpLHtmaXJzdE5hbWU6YSxsYXN0TmFtZTpzLGNvdW50cnlDb2RlOmR9PW8se2N1cnJlbmN5OmwsZW1haWw6YyxsaW5lSXRlbXM6dX09cixoPXUucGh5c2ljYWxJdGVtcy5sZW5ndGg+MCx5PW4uZ2V0Q2hlY2tvdXRPclRocm93KCkub3V0c3RhbmRpbmdCYWxhbmNlLG09bi5nZXRTdG9yZUNvbmZpZ09yVGhyb3coKS5saW5rcy5jaGVja291dExpbms7cmV0dXJue3BheW1lbnRUeXBlOmUsYW1vdW50OnksZmFsbGJhY2s6e3VybDptLGJ1dHRvblRleHQ6XCJDb21wbGV0ZSBQYXltZW50XCJ9LGN1cnJlbmN5Q29kZTpsLmNvZGUsc2hpcHBpbmdBZGRyZXNzUmVxdWlyZWQ6aCxlbWFpbDpjLGdpdmVuTmFtZTphLHN1cm5hbWU6cyxhZGRyZXNzOntjb3VudHJ5Q29kZTpkfSxvblBheW1lbnRTdGFydDoobixyKT0+WWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLmlzTFBNc1VwZGF0ZUV4cGVyaW1lbnRFbmFibGVkKXJldHVybiB0aGlzLm9yZGVySWQ9bi5wYXltZW50SWQsdm9pZCByKCk7Y29uc3Qgbz15aWVsZCB0aGlzLmdldExQTXNCYXNpY1BheW1lbnREYXRhKCksYT1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sbykse2Zvcm1hdHRlZFBheWxvYWQ6e21ldGhvZDplLFtgJHtlfV9hY2NvdW50YF06e29yZGVyX2lkOm4ucGF5bWVudElkfX19KTt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKHQsaSkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoe21ldGhvZElkOmUscGF5bWVudERhdGE6YX0pfWNhdGNoKHQpe2lmKHRoaXMuaXNCcmFpbnRyZWVPcmRlclNhdmVkUmVzcG9uc2UodCkmJnQuYm9keS5hZGRpdGlvbmFsX2FjdGlvbl9yZXF1aXJlZC5kYXRhLm9yZGVyX2lkX3NhdmVkX3N1Y2Nlc3NmdWxseSlyZXR1cm4gcigpLHRoaXMuaXNQb2xsaW5nRW5hYmxlZD9uZXcgUHJvbWlzZSgodCxpKT0+e3RoaXMuaW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oZSx0LGksdGhpcy5nYXRld2F5SWQpfSk6dm9pZCAwO3Rocm93IHR9fSl9fWdldEluc3RhbnRMUE1DYWxsYmFjayhlLHQsaSxuLHIpe2NvbnN0IG89dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q2FydE9yVGhyb3coKTtyZXR1cm4oYSxzKT0+WWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKGEpcmV0dXJuXCJMT0NBTF9QQVlNRU5UX1dJTkRPV19DTE9TRURcIj09PWEuY29kZT8odGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKSx0aGlzLnJlc2V0UG9sbGluZ01lY2hhbmlzbSgpLHQoKSk6KHRoaXMuaXNQb2xsaW5nRW5hYmxlZCYmdGhpcy5yZXNldFBvbGxpbmdNZWNoYW5pc20oKSx0aGlzLnRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoITEpLHQobmV3ICRlKSk7Y29uc3QgZD15aWVsZCB0aGlzLmdldExQTXNCYXNpY1BheW1lbnREYXRhKCksbD1PYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZCkse2Zvcm1hdHRlZFBheWxvYWQ6e21ldGhvZDppLFtgJHtpfV9hY2NvdW50YF06T2JqZWN0LmFzc2lnbih7ZW1haWw6by5lbWFpbCx0b2tlbjpzLm5vbmNlfSx0aGlzLmlzTFBNc1VwZGF0ZUV4cGVyaW1lbnRFbmFibGVkP3t9OntvcmRlcl9pZDp0aGlzLm9yZGVySWR9KX19KTt0cnl7cmV0dXJuIHRoaXMuaXNMUE1zVXBkYXRlRXhwZXJpbWVudEVuYWJsZWR8fCh5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIobixyKSkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoe21ldGhvZElkOmkscGF5bWVudERhdGE6bH0pLGUodm9pZCAwKX1jYXRjaChlKXtyZXR1cm4gdGhpcy5oYW5kbGVFcnJvcihlKSx0KGUpfX0pfXRvZ2dsZUxvYWRpbmdJbmRpY2F0b3IoZSl7ZSYmdGhpcy5sb2FkaW5nSW5kaWNhdG9yQ29udGFpbmVyP3RoaXMubG9hZGluZ0luZGljYXRvci5zaG93KHRoaXMubG9hZGluZ0luZGljYXRvckNvbnRhaW5lcik6dGhpcy5sb2FkaW5nSW5kaWNhdG9yLmhpZGUoKX1oYW5kbGVFcnJvcihlKXtjb25zdHtvbkVycm9yOnR9PXRoaXMuYnJhaW50cmVlbG9jYWxtZXRob2RzfHx7fTt0aGlzLmlzUG9sbGluZ0VuYWJsZWQmJnRoaXMucmVzZXRQb2xsaW5nTWVjaGFuaXNtKCksdGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKSx0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0JiZ0KGUpfWlzTm9uSW5zdGFudFBheW1lbnRNZXRob2QoZSl7cmV0dXJuIGUudG9VcHBlckNhc2UoKWluIHNlfWlzQnJhaW50cmVlUmVkaXJlY3RFcnJvcihlKXt2YXIgdDtpZihcIm9iamVjdFwiIT10eXBlb2YgZXx8bnVsbD09PWUpcmV0dXJuITE7Y29uc3R7Ym9keTppfT1lO3JldHVybiEhaSYmISEobnVsbD09PSh0PWkuYWRkaXRpb25hbF9hY3Rpb25fcmVxdWlyZWQpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmRhdGEucmVkaXJlY3RfdXJsKX1pc0JyYWludHJlZU9yZGVyU2F2ZWRSZXNwb25zZShlKXt2YXIgdDtpZihcIm9iamVjdFwiIT10eXBlb2YgZXx8bnVsbD09PWUpcmV0dXJuITE7Y29uc3R7Ym9keTppfT1lO3JldHVybiEhaSYmKG51bGw9PT0odD1pLmFkZGl0aW9uYWxfYWN0aW9uX3JlcXVpcmVkKXx8dm9pZCAwPT09dD92b2lkIDA6dC5kYXRhLmhhc093blByb3BlcnR5KFwib3JkZXJfaWRfc2F2ZWRfc3VjY2Vzc2Z1bGx5XCIpKX1pbml0aWFsaXplUG9sbGluZ01lY2hhbmlzbShlLHQsaSxuKXtyZXR1cm4gWWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIG5ldyBQcm9taXNlKChlLHQpPT57Y29uc3QgaT1zZXRUaW1lb3V0KGUsdGhpcy5wb2xsaW5nSW50ZXJ2YWwpO3RoaXMuc3RvcFBvbGxpbmc9KCk9PihjbGVhclRpbWVvdXQoaSksdGhpcy50b2dnbGVMb2FkaW5nSW5kaWNhdG9yKCExKSx0KCkpfSk7dHJ5e3RoaXMucG9sbGluZ1RpbWVyKz10aGlzLnBvbGxpbmdJbnRlcnZhbDtjb25zdCByPXlpZWxkIHRoaXMuYnJhaW50cmVlUmVxdWVzdFNlbmRlci5nZXRPcmRlclN0YXR1cyhuLHtwYXJhbXM6e3VzZU1ldGFkYXRhOiExfX0pLG89ci5zdGF0dXM9PT1hZS5QZW5kaW5nLGE9ci5zdGF0dXM9PT1hZS5Db21wbGV0ZWQscz1yLnN0YXR1cz09PWFlLkZhaWxlZDtpZihhKXJldHVybiB0aGlzLmRlaW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oKSx0KCk7aWYocylyZXR1cm4gaSgpO2lmKCFhJiZvJiZ0aGlzLnBvbGxpbmdUaW1lcjx0aGlzLm1heFBvbGxpbmdJbnRlcnZhbFRpbWUpcmV0dXJuIHlpZWxkIHRoaXMuaW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oZSx0LGksbik7eWllbGQgdGhpcy5yZWluaXRpYWxpemVTdHJhdGVneSh7bWV0aG9kSWQ6ZSxnYXRld2F5SWQ6bixicmFpbnRyZWVsb2NhbG1ldGhvZHM6dGhpcy5icmFpbnRyZWVsb2NhbG1ldGhvZHN9KSx0aGlzLmhhbmRsZUVycm9yKG5ldyBHZSl9Y2F0Y2goZSl7aSgpfX0pfWRlaW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oKXt0aGlzLnN0b3BQb2xsaW5nKCksdGhpcy5wb2xsaW5nVGltZXI9MH1yZXNldFBvbGxpbmdNZWNoYW5pc20oKXt0aGlzLmRlaW5pdGlhbGl6ZVBvbGxpbmdNZWNoYW5pc20oKX1yZWluaXRpYWxpemVTdHJhdGVneShlKXtyZXR1cm4gWWUodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMuZGVpbml0aWFsaXplKCkseWllbGQgdGhpcy5pbml0aWFsaXplKGUpfSl9fWNvbnN0IEtlPSQoZT0+e2NvbnN0IGk9d2luZG93LG49bmV3IHYoZSkscj1uZXcgeWUobmV3IHEodCgpLGksbikpLG89dSgpLGE9bmV3IEhlKG8pO3JldHVybiBuZXcgSmUoZSxyLGEsbmV3IEJlKHtzdHlsZXM6e2JhY2tncm91bmRDb2xvcjpcImJsYWNrXCJ9fSkpfSxbe2dhdGV3YXk6XCJicmFpbnRyZWVsb2NhbG1ldGhvZHNcIn1dKTtmdW5jdGlvbiBYZShlKXtyZXR1cm5cInN0cmluZ1wiIT10eXBlb2YgZX1mdW5jdGlvbiBRZShlLHQpe2lmKHR8fGUpcmV0dXJuIGZ1bmN0aW9uKGUpe3ZhciB0LGk7Y29uc3Qgbj17fSxyPWQoZS5yb290LFhlKSxvPWQoZS5pbnB1dCxYZSksYT1kKGUudG9nZ2xlLFhlKSxzPWQobnVsbD09PSh0PWUudGV4dCl8fHZvaWQgMD09PXQ/dm9pZCAwOnQuYm9keSxYZSksbD1kKG51bGw9PT0oaT1lLnRleHQpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmNhcHRpb24sWGUpLGM9ZS5icmFuZGluZztyZXR1cm4gT2JqZWN0LmtleXMocikubGVuZ3RoJiYobi5yb290PXIpLE9iamVjdC5rZXlzKG8pLmxlbmd0aCYmKG4uaW5wdXQ9byksT2JqZWN0LmtleXMoYSkubGVuZ3RoJiYobi50b2dnbGU9YSksT2JqZWN0LmtleXMocykubGVuZ3RoJiYobi50ZXh0PXt9LG4udGV4dC5ib2R5PXMpLE9iamVjdC5rZXlzKGwpLmxlbmd0aCYmKG4udGV4dD1PYmplY3QuYXNzaWduKHt9LG4udGV4dCksbi50ZXh0LmNhcHRpb249bCksYyYmKG4uYnJhbmRpbmc9Yyksbn0oZnVuY3Rpb24oZSx0KXt2YXIgaSxuLHIsbyxhLHMsZCxsLGMsdSxoLHksbSxwLGcsdixmLGIsdyxDLFMsUDtyZXR1cm57cm9vdDp7YmFja2dyb3VuZENvbG9yUHJpbWFyeToobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVJvb3RTZXR0aW5nc0JhY2tncm91bmRDb2xvcil8fChudWxsPT09KGk9bnVsbD09dD92b2lkIDA6dC5yb290KXx8dm9pZCAwPT09aT92b2lkIDA6aS5iYWNrZ3JvdW5kQ29sb3JQcmltYXJ5KSxlcnJvckNvbG9yOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lUm9vdFNldHRpbmdzRXJyb3JDb2xvcil8fChudWxsPT09KG49bnVsbD09dD92b2lkIDA6dC5yb290KXx8dm9pZCAwPT09bj92b2lkIDA6bi5lcnJvckNvbG9yKSxmb250RmFtaWx5OihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lUm9vdFNldHRpbmdzRm9udEZhbWlseSl8fChudWxsPT09KHI9bnVsbD09dD92b2lkIDA6dC5yb290KXx8dm9pZCAwPT09cj92b2lkIDA6ci5mb250RmFtaWx5KSxmb250U2l6ZUJhc2U6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVSb290U2V0dGluZ3NGb250U2l6ZSl8fChudWxsPT09KG89bnVsbD09dD92b2lkIDA6dC5yb290KXx8dm9pZCAwPT09bz92b2lkIDA6by5mb250U2l6ZUJhc2UpLHBhZGRpbmc6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVSb290U2V0dGluZ3NQYWRkaW5nKXx8KG51bGw9PT0oYT1udWxsPT10P3ZvaWQgMDp0LnJvb3QpfHx2b2lkIDA9PT1hP3ZvaWQgMDphLnBhZGRpbmcpLHByaW1hcnlDb2xvcjoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVJvb3RTZXR0aW5nc1ByaW1hcnlDb2xvcil8fChudWxsPT09KHM9bnVsbD09dD92b2lkIDA6dC5yb290KXx8dm9pZCAwPT09cz92b2lkIDA6cy5wcmltYXJ5Q29sb3IpfSxpbnB1dDp7Ym9yZGVyUmFkaXVzOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lSW5wdXRTZXR0aW5nc0JvcmRlclJhZGl1cyl8fChudWxsPT09KGQ9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PWQ/dm9pZCAwOmQuYm9yZGVyUmFkaXVzKSxib3JkZXJDb2xvcjoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUlucHV0U2V0dGluZ3NCb3JkZXJDb2xvcil8fChudWxsPT09KGw9bnVsbD09dD92b2lkIDA6dC5pbnB1dCl8fHZvaWQgMD09PWw/dm9pZCAwOmwuYm9yZGVyQ29sb3IpLGZvY3VzQm9yZGVyQ29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVJbnB1dFNldHRpbmdzRm9jdXNCb3JkZXJCYXNlKXx8KG51bGw9PT0oYz1udWxsPT10P3ZvaWQgMDp0LmlucHV0KXx8dm9pZCAwPT09Yz92b2lkIDA6Yy5mb2N1c0JvcmRlckNvbG9yKSxiYWNrZ3JvdW5kQ29sb3I6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVJbnB1dFNldHRpbmdzQmFja2dyb3VuZENvbG9yKXx8KG51bGw9PT0odT1udWxsPT10P3ZvaWQgMDp0LmlucHV0KXx8dm9pZCAwPT09dT92b2lkIDA6dS5iYWNrZ3JvdW5kQ29sb3IpLGJvcmRlcldpZHRoOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lSW5wdXRTZXR0aW5nc0JvcmRlcldpZHRoKXx8KG51bGw9PT0oaD1udWxsPT10P3ZvaWQgMDp0LmlucHV0KXx8dm9pZCAwPT09aD92b2lkIDA6aC5ib3JkZXJXaWR0aCksdGV4dENvbG9yQmFzZToobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZUlucHV0U2V0dGluZ3NUZXh0Q29sb3JCYXNlKXx8KG51bGw9PT0oeT1udWxsPT10P3ZvaWQgMDp0LmlucHV0KXx8dm9pZCAwPT09eT92b2lkIDA6eS50ZXh0Q29sb3JCYXNlKX0sdG9nZ2xlOntjb2xvclByaW1hcnk6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVUb2dnbGVTZXR0aW5nc0NvbG9yUHJpbWFyeSl8fChudWxsPT09KG09bnVsbD09dD92b2lkIDA6dC50b2dnbGUpfHx2b2lkIDA9PT1tP3ZvaWQgMDptLmNvbG9yUHJpbWFyeSksY29sb3JTZWNvbmRhcnk6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVUb2dnbGVTZXR0aW5nc0NvbG9yU2Vjb25kYXJ5KXx8KG51bGw9PT0ocD1udWxsPT10P3ZvaWQgMDp0LnRvZ2dsZSl8fHZvaWQgMD09PXA/dm9pZCAwOnAuY29sb3JTZWNvbmRhcnkpfSx0ZXh0Ontib2R5Ontjb2xvcjoobnVsbD09ZT92b2lkIDA6ZS5mYXN0bGFuZVRleHRCb2R5U2V0dGluZ3NDb2xvcil8fChudWxsPT09KHY9bnVsbD09PShnPW51bGw9PXQ/dm9pZCAwOnQudGV4dCl8fHZvaWQgMD09PWc/dm9pZCAwOmcuYm9keSl8fHZvaWQgMD09PXY/dm9pZCAwOnYuY29sb3IpLGZvbnRTaXplOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lVGV4dEJvZHlTZXR0aW5nc0ZvbnRTaXplKXx8KG51bGw9PT0oYj1udWxsPT09KGY9bnVsbD09dD92b2lkIDA6dC50ZXh0KXx8dm9pZCAwPT09Zj92b2lkIDA6Zi5ib2R5KXx8dm9pZCAwPT09Yj92b2lkIDA6Yi5mb250U2l6ZSl9LGNhcHRpb246e2NvbG9yOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lVGV4dENhcHRpb25TZXR0aW5nc0NvbG9yKXx8KG51bGw9PT0oQz1udWxsPT09KHc9bnVsbD09dD92b2lkIDA6dC50ZXh0KXx8dm9pZCAwPT09dz92b2lkIDA6dy5jYXB0aW9uKXx8dm9pZCAwPT09Qz92b2lkIDA6Qy5jb2xvciksZm9udFNpemU6KG51bGw9PWU/dm9pZCAwOmUuZmFzdGxhbmVUZXh0Q2FwdGlvblNldHRpbmdzRm9udFNpemUpfHwobnVsbD09PShQPW51bGw9PT0oUz1udWxsPT10P3ZvaWQgMDp0LnRleHQpfHx2b2lkIDA9PT1TP3ZvaWQgMDpTLmNhcHRpb24pfHx2b2lkIDA9PT1QP3ZvaWQgMDpQLmZvbnRTaXplKX19LGJyYW5kaW5nOihudWxsPT1lP3ZvaWQgMDplLmZhc3RsYW5lQnJhbmRpbmdTZXR0aW5ncyl8fChudWxsPT10P3ZvaWQgMDp0LmJyYW5kaW5nKX19KGUsdCkpfWZ1bmN0aW9uIFplKGUpe3JldHVybiEhZSYmKFwiYXV0aGVudGljYXRpb25TdGF0ZVwiaW4gZXx8XCJhZGRyZXNzZXNcImluIGV8fFwiaW5zdHJ1bWVudHNcImluIGUpfXZhciBldCx0dD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBpdHtjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVGYXN0bGFuZVV0aWxzPXQsdGhpcy5icmFpbnRyZWVTZGs9aX1pbml0aWFsaXplKGUpe3ZhciB0O3JldHVybiB0dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6aSxicmFpbnRyZWVmYXN0bGFuZTpufT1lO2lmKCFpKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLm1ldGhvZElkXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZWZhc3RsYW5lXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCFuLm9uSW5pdHx8XCJmdW5jdGlvblwiIT10eXBlb2Ygbi5vbkluaXQpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVlZmFzdGxhbmUub25Jbml0XCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkIG9yIGl0IGlzIG5vdCBhIGZ1bmN0aW9uLicpO2lmKCFuLm9uQ2hhbmdlfHxcImZ1bmN0aW9uXCIhPXR5cGVvZiBuLm9uQ2hhbmdlKXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZWZhc3RsYW5lLm9uQ2hhbmdlXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkIG9yIGl0IGlzIG5vdCBhIGZ1bmN0aW9uLicpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKTtjb25zdCByPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLG89ci5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSx7aW5pdGlhbGl6YXRpb25EYXRhOmEsY2xpZW50VG9rZW46c309b3x8e30se2lzRmFzdGxhbmVTdHlsaW5nRW5hYmxlZDpkfT1hfHx7fSxsPXkoci5nZXRTdG9yZUNvbmZpZ09yVGhyb3coKS5jaGVja291dFNldHRpbmdzLmZlYXR1cmVzLFwiUFJPSkVDVC03MDgwLmJyYWludHJlZV9mYXN0bGFuZV90aHJlZV9kc1wiKTt0aGlzLmlzM0RTRW5hYmxlZD1vLmNvbmZpZy5pczNkc0VuYWJsZWQscyYmbCYmdGhpcy5icmFpbnRyZWVTZGsuaW5pdGlhbGl6ZShzKTtjb25zdCBjPVFlKGQ/bnVsbD09PSh0PW8uaW5pdGlhbGl6YXRpb25EYXRhKXx8dm9pZCAwPT09dD92b2lkIDA6dC5mYXN0bGFuZVN0eWxlczp2b2lkIDAsbi5zdHlsZXMpO3lpZWxkIHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5pbml0aWFsaXplQnJhaW50cmVlRmFzdGxhbmVPclRocm93KGksYyksdGhpcy5zaG91bGRSdW5BdXRoZW50aWNhdGlvbkZsb3coKSYmKHlpZWxkIHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5ydW5QYXlQYWxBdXRoZW50aWNhdGlvbkZsb3dPclRocm93KCkpLHlpZWxkIHRoaXMuaW5pdGlhbGl6ZUNhcmRDb21wb25lbnQoKSx0aGlzLm9uRXJyb3I9bi5vbkVycm9yLG4ub25Jbml0KGU9PnRoaXMucmVuZGVyQnJhaW50cmVlQ2FyZENvbXBvbmVudChlKSksbi5vbkNoYW5nZSgoKT0+dGhpcy5oYW5kbGVCcmFpbnRyZWVTdG9yZWRJbnN0cnVtZW50Q2hhbmdlKGkpKX0pfWV4ZWN1dGUoZSx0KXtyZXR1cm4gdHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnQ6aX09ZSxuPWZ1bmN0aW9uKGUsdCl7dmFyIGk9e307Zm9yKHZhciBuIGluIGUpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGUsbikmJnQuaW5kZXhPZihuKTwwJiYoaVtuXT1lW25dKTtpZihudWxsIT1lJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKXt2YXIgcj0wO2ZvcihuPU9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMoZSk7cjxuLmxlbmd0aDtyKyspdC5pbmRleE9mKG5bcl0pPDAmJk9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChlLG5bcl0pJiYoaVtuW3JdXT1lW25bcl1dKX1yZXR1cm4gaX0oZSxbXCJwYXltZW50XCJdKTtpZighaSl0aHJvdyBuZXcgQyhbXCJwYXltZW50XCJdKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc3VibWl0T3JkZXIobix0KTtjb25zdCByPXlpZWxkIHRoaXMucHJlcGFyZVBheW1lbnRQYXlsb2FkKGkubWV0aG9kSWQpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KHIpLHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5yZW1vdmVTZXNzaW9uSWRGcm9tQ29va2llcygpfSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IE9lKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gdHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB0aGlzLmJyYWludHJlZUNhcmRDb21wb25lbnQ9dm9pZCAwLFByb21pc2UucmVzb2x2ZSgpfSl9aW5pdGlhbGl6ZUNhcmRDb21wb25lbnQoKXtyZXR1cm4gdHQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGU9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkse3Bob25lOnQsZmlyc3ROYW1lOmksbGFzdE5hbWU6bn09ZS5nZXRCaWxsaW5nQWRkcmVzc09yVGhyb3coKSxyPWAke2l9ICR7bn1gLG89e3N0eWxlczp7fSxmaWVsZHM6T2JqZWN0LmFzc2lnbih7Y2FyZGhvbGRlck5hbWU6e3ByZWZpbGw6cixlbmFibGVkOiEwfX0sdCYme3Bob25lTnVtYmVyOntwcmVmaWxsOnR9fSl9LGE9dGhpcy5icmFpbnRyZWVGYXN0bGFuZVV0aWxzLmdldEJyYWludHJlZUZhc3RsYW5lQ29tcG9uZW50T3JUaHJvdygpO3RoaXMuYnJhaW50cmVlQ2FyZENvbXBvbmVudD15aWVsZCBhKG8pfSl9cmVuZGVyQnJhaW50cmVlQ2FyZENvbXBvbmVudChlKXtjb25zdCB0PXRoaXMuZ2V0QnJhaW50cmVlQ2FyZENvbXBvbmVudE9yVGhyb3coKTtpZighZSl0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwiY29udGFpbmVyXCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3QucmVuZGVyKGUpfXByZXBhcmVQYXltZW50UGF5bG9hZChlKXt2YXIgdCxpO3JldHVybiB0dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPW4uZ2V0QmlsbGluZ0FkZHJlc3NPclRocm93KCksbz1gJHtyLmZpcnN0TmFtZX0gJHtyLmxhc3ROYW1lfWAsYT10aGlzLmdldFBheVBhbEluc3RydW1lbnRzKClbMF0scz15aWVsZCB0aGlzLmJyYWludHJlZUZhc3RsYW5lVXRpbHMuZ2V0RGV2aWNlU2Vzc2lvbklkKCksZD15KG4uZ2V0U3RvcmVDb25maWdPclRocm93KCkuY2hlY2tvdXRTZXR0aW5ncy5mZWF0dXJlcyxcIlBST0pFQ1QtNzA4MC5icmFpbnRyZWVfZmFzdGxhbmVfdGhyZWVfZHNcIik7aWYoYSl7Y29uc3QgdD10aGlzLmlzM0RTRW5hYmxlZCYmZD95aWVsZCB0aGlzLmdldDNEUyhhLmJpZ3BheVRva2VuLChudWxsPT1hP3ZvaWQgMDphLmlpbil8fFwiXCIpOnZvaWQgMDtyZXR1cm57bWV0aG9kSWQ6ZSxwYXltZW50RGF0YTp7ZGV2aWNlU2Vzc2lvbklkOnMsZm9ybWF0dGVkUGF5bG9hZDp7cGF5cGFsX2Zhc3RsYW5lX3Rva2VuOnt0b2tlbjp0fHxhLmJpZ3BheVRva2VufX19fX1jb25zdHtnZXRQYXltZW50VG9rZW46bH09dGhpcy5nZXRCcmFpbnRyZWVDYXJkQ29tcG9uZW50T3JUaHJvdygpLGM9eWllbGQgbCh7bmFtZTp7ZnVsbE5hbWU6b30sYmlsbGluZ0FkZHJlc3M6dGhpcy5tYXBUb1BheVBhbEFkZHJlc3Mocil9KSx1PShudWxsPT09KGk9bnVsbD09PSh0PWMucGF5bWVudFNvdXJjZS5jYXJkKXx8dm9pZCAwPT09dD92b2lkIDA6dC5iaW5EZXRhaWxzKXx8dm9pZCAwPT09aT92b2lkIDA6aS5iaW4pfHxcIlwiLGg9dGhpcy5pczNEU0VuYWJsZWQmJmQ/eWllbGQgdGhpcy5nZXQzRFMoYy5pZCx1KTp2b2lkIDA7cmV0dXJue21ldGhvZElkOmUscGF5bWVudERhdGE6e2RldmljZVNlc3Npb25JZDpzLG5vbmNlOmh8fGMuaWR9fX0pfWdldDNEUyhlLHQpe3JldHVybiB0dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxuPXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldEJyYWludHJlZVRocmVlRFMoKSxyPWkuZ2V0T3JkZXJPclRocm93KCk7cmV0dXJuIG5ldyBQcm9taXNlKChpLG8pPT57bi52ZXJpZnlDYXJkKHthbW91bnQ6bnVsbD09cj92b2lkIDA6ci5vcmRlckFtb3VudCxub25jZTplLGJpbjp0LG9uTG9va3VwQ29tcGxldGU6KGUsdCk9PntuLm9uKFwiY3VzdG9tZXItY2FuY2VsZWRcIiwoKT0+e1wiZnVuY3Rpb25cIj09dHlwZW9mIHRoaXMub25FcnJvciYmdGhpcy5vbkVycm9yKG5ldyBPKSxvKG5ldyBPKX0pLHQoKX19LChlLHQpPT4oZSYmXCJUSFJFRURTX1ZFUklGWV9DQVJEX0NBTkNFTEVEX0JZX01FUkNIQU5UXCI9PT1lLmNvZGUmJihcImZ1bmN0aW9uXCI9PXR5cGVvZiB0aGlzLm9uRXJyb3ImJnRoaXMub25FcnJvcihuZXcgTyksbyhuZXcgTykpLGkodC5ub25jZSkpKX0pfSl9bWFwVG9QYXlQYWxBZGRyZXNzKGUpe3JldHVybntzdHJlZXRBZGRyZXNzOihudWxsPT1lP3ZvaWQgMDplLmFkZHJlc3MxKXx8XCJcIixsb2NhbGl0eToobnVsbD09ZT92b2lkIDA6ZS5jaXR5KXx8XCJcIixyZWdpb246KG51bGw9PWU/dm9pZCAwOmUuc3RhdGVPclByb3ZpbmNlQ29kZSl8fChudWxsPT1lP3ZvaWQgMDplLnN0YXRlT3JQcm92aW5jZSl8fFwiXCIscG9zdGFsQ29kZToobnVsbD09ZT92b2lkIDA6ZS5wb3N0YWxDb2RlKXx8XCJcIixjb3VudHJ5Q29kZUFscGhhMjoobnVsbD09ZT92b2lkIDA6ZS5jb3VudHJ5Q29kZSl8fFwiXCJ9fXNob3VsZFJ1bkF1dGhlbnRpY2F0aW9uRmxvdygpe2NvbnN0IGU9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksdD1lLmdldENhcnRPclRocm93KCksaT1lLmdldEN1c3RvbWVyT3JUaHJvdygpLG49ZS5nZXRQYXltZW50UHJvdmlkZXJDdXN0b21lcigpLHI9WmUobik/bjp7fSxvPXRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5nZXRTZXNzaW9uSWRGcm9tQ29va2llcygpO3JldHVybiEoIWkuaXNHdWVzdHx8KG51bGw9PXI/dm9pZCAwOnIuYXV0aGVudGljYXRpb25TdGF0ZSk9PT1kZS5DQU5DRUxFRHx8KG51bGw9PXI/dm9pZCAwOnIuYXV0aGVudGljYXRpb25TdGF0ZSl8fG8hPT10LmlkKX1nZXRCcmFpbnRyZWVDYXJkQ29tcG9uZW50T3JUaHJvdygpe2lmKCF0aGlzLmJyYWludHJlZUNhcmRDb21wb25lbnQpdGhyb3cgbmV3IFU7cmV0dXJuIHRoaXMuYnJhaW50cmVlQ2FyZENvbXBvbmVudH1nZXRQYXlQYWxJbnN0cnVtZW50cygpe2NvbnN0IGU9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudFByb3ZpZGVyQ3VzdG9tZXJPclRocm93KCk7cmV0dXJuKFplKGUpP2U6e30pLmluc3RydW1lbnRzfHxbXX1oYW5kbGVCcmFpbnRyZWVTdG9yZWRJbnN0cnVtZW50Q2hhbmdlKGUpe3JldHVybiB0dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLmJyYWludHJlZUZhc3RsYW5lVXRpbHMuZ2V0QnJhaW50cmVlRmFzdGxhbmVPclRocm93KCkse3NlbGVjdGlvbkNoYW5nZWQ6aSxzZWxlY3RlZENhcmQ6bn09eWllbGQgdC5wcm9maWxlLnNob3dDYXJkU2VsZWN0b3IoKTtpZihpKXtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRQcm92aWRlckN1c3RvbWVyKCksaT1aZSh0KT90Ont9LHI9dGhpcy5icmFpbnRyZWVGYXN0bGFuZVV0aWxzLm1hcFBheVBhbFRvQmNJbnN0cnVtZW50KGUsW25dKTtpZihyJiZyLmxlbmd0aD4wKXJldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlUGF5bWVudFByb3ZpZGVyQ3VzdG9tZXIoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGkpLHtpbnN0cnVtZW50czpbLi4ucl19KSksclswXX19KX19IWZ1bmN0aW9uKGUpe2UuQ1ZWPVwiY3Z2XCIsZS5QQU49XCJwYW5cIn0oZXR8fChldD17fSkpO2NsYXNzIG50e3N0YXRpYyBnZXQoZSl7Y29uc3QgdD1gJHtlbmNvZGVVUklDb21wb25lbnQoYCR7ZX1gKX09YCxpPWRvY3VtZW50LmNvb2tpZTtsZXQgbj1udWxsO2NvbnN0IHI9aS5pbmRleE9mKHQpO2lmKHI+LTEpe2xldCBlPWkuaW5kZXhPZihcIjtcIixyKTstMT09PWUmJihlPWkubGVuZ3RoKSxuPWRlY29kZVVSSUNvbXBvbmVudChpLnN1YnN0cmluZyhyK3QubGVuZ3RoLGUpKX1yZXR1cm4gbn1zdGF0aWMgc2V0KGUsdCxpPXtzZWN1cmU6ITB9KXtsZXQgbj1gJHtlbmNvZGVVUklDb21wb25lbnQoZSl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KHQpfWA7Y29uc3R7ZXhwaXJlczpyLHBhdGg6byxkb21haW46YSxzZWN1cmU6c309aTtpZihyKW4rPWA7IGV4cGlyZXM9JHtyLnRvVVRDU3RyaW5nKCl9YDtlbHNle2NvbnN0IGU9bmV3IERhdGUsdD02MDtlLnNldFRpbWUoZS5nZXRUaW1lKCkrNjAqdCoxZTMpLG4rPWA7IGV4cGlyZXM9JHtlLnRvVVRDU3RyaW5nKCl9YH1vJiYobis9YDsgcGF0aD0ke299YCksYSYmKG4rPWA7IGRvbWFpbj0ke2F9YCkscyYmKG4rPVwiOyBzZWN1cmVcIiksZG9jdW1lbnQuY29va2llPW59c3RhdGljIHJlbW92ZShlLHQpe250LnNldChlLFwiXCIsT2JqZWN0LmFzc2lnbih7ZXhwaXJlczpuZXcgRGF0ZSgwKX0sdCkpfX12YXIgcnQ9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3Mgb3R7Y29uc3RydWN0b3IoZSx0KXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZT10fWdldERldmljZVNlc3Npb25JZCgpe3JldHVybiBydCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgZT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDYXJ0KCk7cmV0dXJuIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFNlc3Npb25JZChudWxsPT1lP3ZvaWQgMDplLmlkKX0pfWluaXRpYWxpemVCcmFpbnRyZWVGYXN0bGFuZU9yVGhyb3coZSx0KXtyZXR1cm4gcnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IGk9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksbj1pLmdldENhcnQoKSx7Y2xpZW50VG9rZW46cixjb25maWc6b309aS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlKTtpZighcil0aHJvdyBuZXcgRyhILk1pc3NpbmdQYXltZW50TWV0aG9kKTt0aGlzLm1ldGhvZElkPWUsdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuaW5pdGlhbGl6ZShyKSx0aGlzLmJyYWludHJlZUZhc3RsYW5lPXlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldEJyYWludHJlZUZhc3RsYW5lKG51bGw9PW4/dm9pZCAwOm4uaWQsby50ZXN0TW9kZSx0KX0pfWdldEJyYWludHJlZUZhc3RsYW5lT3JUaHJvdygpe2lmKCF0aGlzLmJyYWludHJlZUZhc3RsYW5lKXRocm93IG5ldyBVO3JldHVybiB0aGlzLmJyYWludHJlZUZhc3RsYW5lfWdldEJyYWludHJlZUZhc3RsYW5lQ29tcG9uZW50T3JUaHJvdygpe3JldHVybiB0aGlzLmdldEJyYWludHJlZUZhc3RsYW5lT3JUaHJvdygpLkZhc3RsYW5lQ2FyZENvbXBvbmVudH1ydW5QYXlQYWxBdXRoZW50aWNhdGlvbkZsb3dPclRocm93KGUsdCl7dmFyIGk7cmV0dXJuIHJ0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7Y29uc3Qgbj10aGlzLmdldE1ldGhvZElkT3JUaHJvdygpLHI9dGhpcy5nZXRCcmFpbnRyZWVGYXN0bGFuZU9yVGhyb3coKSx7bG9va3VwQ3VzdG9tZXJCeUVtYWlsOm8sdHJpZ2dlckF1dGhlbnRpY2F0aW9uRmxvdzphfT1yLmlkZW50aXR5LHM9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksZD1zLmdldENhcnRPclRocm93KCksbD1zLmdldEN1c3RvbWVyKCksYz1zLmdldEJpbGxpbmdBZGRyZXNzKCkse2lzRmFzdGxhbmVTaGlwcGluZ09wdGlvbkF1dG9TZWxlY3RFbmFibGVkOnV9PXMuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3cobikuaW5pdGlhbGl6YXRpb25EYXRhfHx7fSxoPWV8fChudWxsPT1sP3ZvaWQgMDpsLmVtYWlsKXx8KG51bGw9PWM/dm9pZCAwOmMuZW1haWwpfHxcIlwiLHtjdXN0b21lckNvbnRleHRJZDp5fT15aWVsZCBvKGgpO2lmKCF5KXJldHVybiB5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlUGF5bWVudFByb3ZpZGVyQ3VzdG9tZXIoe2F1dGhlbnRpY2F0aW9uU3RhdGU6ZGUuVU5SRUNPR05JWkVELGFkZHJlc3NlczpbXSxpbnN0cnVtZW50czpbXX0pLHZvaWQgdGhpcy5zYXZlU2Vzc2lvbklkVG9Db29raWVzKGQuaWQpO2NvbnN0e2F1dGhlbnRpY2F0aW9uU3RhdGU6bSxwcm9maWxlRGF0YTpwfT15aWVsZCBhKHkpLGc9KG51bGw9PT0oaT1udWxsPT1wP3ZvaWQgMDpwLnNoaXBwaW5nQWRkcmVzcyl8fHZvaWQgMD09PWk/dm9pZCAwOmkucGhvbmVOdW1iZXIpfHxcIlwiO2lmKG09PT1kZS5DQU5DRUxFRClyZXR1cm4geWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVBheW1lbnRQcm92aWRlckN1c3RvbWVyKHthdXRoZW50aWNhdGlvblN0YXRlOm0sYWRkcmVzc2VzOltdLGluc3RydW1lbnRzOltdfSksdm9pZCB0aGlzLnJlbW92ZVNlc3Npb25JZEZyb21Db29raWVzKCk7Y29uc3Qgdj10aGlzLm1hcFBheVBhbFRvQmNBZGRyZXNzKFtwLnNoaXBwaW5nQWRkcmVzc10sW2ddKXx8W10sZj10aGlzLmdldFBheVBhbEJpbGxpbmdBZGRyZXNzZXMocCksYj1mP3RoaXMubWFwUGF5UGFsVG9CY0FkZHJlc3MoW2ZdLFtnXSk6W10sdz1wLmNhcmQ/dGhpcy5tYXBQYXlQYWxUb0JjSW5zdHJ1bWVudChuLFtwLmNhcmRdKTpbXSxDPXRoaXMubWVyZ2VTaGlwcGluZ0FuZEJpbGxpbmdBZGRyZXNzZXModixiKTtpZih0aGlzLnNhdmVTZXNzaW9uSWRUb0Nvb2tpZXMoZC5pZCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZVBheW1lbnRQcm92aWRlckN1c3RvbWVyKHthdXRoZW50aWNhdGlvblN0YXRlOm0sYWRkcmVzc2VzOkMsaW5zdHJ1bWVudHM6d30pLGIubGVuZ3RoPjAmJmQubGluZUl0ZW1zLnBoeXNpY2FsSXRlbXMubGVuZ3RoPjAmJih5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlQmlsbGluZ0FkZHJlc3MoYlswXSkpLGIubGVuZ3RoPjAmJmQubGluZUl0ZW1zLmRpZ2l0YWxJdGVtcy5sZW5ndGg+MCYmMD09PWQubGluZUl0ZW1zLnBoeXNpY2FsSXRlbXMubGVuZ3RoKXtjb25zdHtmaXJzdE5hbWU6ZSxsYXN0TmFtZTp0fT1DWzBdLGk9T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGJbMF0pLHtmaXJzdE5hbWU6ZSxsYXN0TmFtZTp0fSk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnVwZGF0ZUJpbGxpbmdBZGRyZXNzKGkpfXYubGVuZ3RoPjAmJmQubGluZUl0ZW1zLnBoeXNpY2FsSXRlbXMubGVuZ3RoPjAmJih5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UudXBkYXRlU2hpcHBpbmdBZGRyZXNzKHZbMF0pLHQmJnUmJih5aWVsZCB0aGlzLnNldFNoaXBwaW5nT3B0aW9uKCkpKX1jYXRjaChlKXt9fSl9Z2V0U2Vzc2lvbklkRnJvbUNvb2tpZXMoKXtyZXR1cm4gbnQuZ2V0KFwiYmMtZmFzdGxhbmUtc2Vzc2lvbklkXCIpfHxcIlwifXNhdmVTZXNzaW9uSWRUb0Nvb2tpZXMoZSl7Y29uc3QgdD1uZXcgRGF0ZTt0LnNldERhdGUodC5nZXREYXRlKCkrMTQpLG50LnNldChcImJjLWZhc3RsYW5lLXNlc3Npb25JZFwiLGUse2V4cGlyZXM6dCxzZWN1cmU6ITB9KX1yZW1vdmVTZXNzaW9uSWRGcm9tQ29va2llcygpe250LnJlbW92ZShcImJjLWZhc3RsYW5lLXNlc3Npb25JZFwiKX1tYXBQYXlQYWxUb0JjSW5zdHJ1bWVudChlLHQpe2lmKHQpcmV0dXJuIHQubWFwKHQ9Pntjb25zdHtpZDppLHBheW1lbnRTb3VyY2U6bn09dCx7YnJhbmQ6cixleHBpcnk6byxsYXN0RGlnaXRzOmEsYmluRGV0YWlsczpzfT1uLmNhcmQsW2QsbF09by5zcGxpdChcIi1cIik7cmV0dXJue2JpZ3BheVRva2VuOmksYnJhbmQ6cixkZWZhdWx0SW5zdHJ1bWVudDohMSxleHBpcnlNb250aDpsLGV4cGlyeVllYXI6ZCxpaW46KG51bGw9PXM/dm9pZCAwOnMuYmluKXx8XCJcIixsYXN0NDphLG1ldGhvZDplLHByb3ZpZGVyOmUsdHJ1c3RlZFNoaXBwaW5nQWRkcmVzczohMSx0eXBlOlwiY2FyZFwiLHVudHJ1c3RlZFNoaXBwaW5nQ2FyZFZlcmlmaWNhdGlvbk1vZGU6ZXQuUEFOfX0pfW1hcFBheVBhbFRvQmNBZGRyZXNzKGUsdCl7aWYoIWUpcmV0dXJuW107Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDb3VudHJpZXMoKXx8W10sbj1lPT57Y29uc3QgdD1pLmZpbmQodD0+dC5jb2RlPT09ZSk7cmV0dXJuKG51bGw9PXQ/dm9pZCAwOnQubmFtZSl8fFwiXCJ9O3JldHVybiBlLm1hcChlPT4oe2lkOkRhdGUubm93KCksdHlwZTpcInBheXBhbC1hZGRyZXNzXCIsZmlyc3ROYW1lOmUuZmlyc3ROYW1lfHxcIlwiLGxhc3ROYW1lOmUubGFzdE5hbWV8fFwiXCIsY29tcGFueTplLmNvbXBhbnl8fFwiXCIsYWRkcmVzczE6ZS5zdHJlZXRBZGRyZXNzLGFkZHJlc3MyOmUuZXh0ZW5kZWRBZGRyZXNzfHxcIlwiLGNpdHk6ZS5sb2NhbGl0eSxzdGF0ZU9yUHJvdmluY2U6ZS5yZWdpb24sc3RhdGVPclByb3ZpbmNlQ29kZTplLnJlZ2lvbixjb3VudHJ5Om4oZS5jb3VudHJ5Q29kZUFscGhhMiksY291bnRyeUNvZGU6ZS5jb3VudHJ5Q29kZUFscGhhMixwb3N0YWxDb2RlOmUucG9zdGFsQ29kZSxwaG9uZTp0JiZ0WzBdfHxcIlwiLGN1c3RvbUZpZWxkczpbXX0pKX1nZXRQYXlQYWxCaWxsaW5nQWRkcmVzc2VzKGUpe2NvbnN0e2NhcmQ6dCxuYW1lOml9PWV8fHt9O2lmKCF0KXJldHVybjtjb25zdHtmaXJzdE5hbWU6bixsYXN0TmFtZTpvfT10LnBheW1lbnRTb3VyY2UuY2FyZC5iaWxsaW5nQWRkcmVzcyx7Zmlyc3ROYW1lOmEsbGFzdE5hbWU6c309aXx8e30se3NoaXBwaW5nQWRkcmVzczpkfT1lfHx7fSxsPU9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0LnBheW1lbnRTb3VyY2UuY2FyZC5iaWxsaW5nQWRkcmVzcykse2ZpcnN0TmFtZTpufHxhLGxhc3ROYW1lOm98fHN9KTtyZXR1cm4gZCYmcih0aGlzLm5vcm1hbGl6ZUFkZHJlc3MobCksdGhpcy5ub3JtYWxpemVBZGRyZXNzKGQpKT9kOmx9bm9ybWFsaXplQWRkcmVzcyhlKXtyZXR1cm4gcyhlLFtcImlkXCJdKX1tZXJnZVNoaXBwaW5nQW5kQmlsbGluZ0FkZHJlc3NlcyhlLHQpe2NvbnN0IGk9dC5maWx0ZXIodD0+IWUuc29tZShlPT5yKHRoaXMubm9ybWFsaXplQWRkcmVzcyhlKSx0aGlzLm5vcm1hbGl6ZUFkZHJlc3ModCkpKSk7cmV0dXJuWy4uLmUsLi4uaV19Z2V0TWV0aG9kSWRPclRocm93KCl7aWYoIXRoaXMubWV0aG9kSWQpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgXCJtZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtyZXR1cm4gdGhpcy5tZXRob2RJZH1zZXRTaGlwcGluZ09wdGlvbigpe3ZhciBlO3JldHVybiBydCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKS5nZXRDb25zaWdubWVudHMoKXx8W10saT0obnVsbD09PShlPXRbMF0pfHx2b2lkIDA9PT1lP3ZvaWQgMDplLmF2YWlsYWJsZVNoaXBwaW5nT3B0aW9ucyl8fFtdLG49aS5maW5kKGU9PmUuaXNSZWNvbW1lbmRlZCk7aWYobnx8aS5sZW5ndGgpe2NvbnN0IGU9bnx8aVswXTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2VsZWN0U2hpcHBpbmdPcHRpb24oZS5pZCl9fSl9fWNvbnN0IGF0PSQoZT0+e2NvbnN0IGk9d2luZG93LG49bmV3IHYoZSkscj1uZXcgaihuZXcgcSh0KCksaSxuKSxpKSxvPW5ldyBvdChlLHIpLGE9bmV3IHEodCgpLGksbikscz1uZXcgeWUoYSk7cmV0dXJuIG5ldyBpdChlLG8scyl9LFt7aWQ6XCJicmFpbnRyZWVhY2NlbGVyYXRlZGNoZWNrb3V0XCJ9XSk7dmFyIHN0PWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIGR0e2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmZvcm1Qb3N0ZXI9dCx0aGlzLmJyYWludHJlZVNkaz1pfWluaXRpYWxpemUoZSl7cmV0dXJuIHN0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHticmFpbnRyZWV2aXNhY2hlY2tvdXQ6dCxtZXRob2RJZDppfT1lO2lmKCF0KXRocm93IG5ldyB3KCdVbmFibGUgdG8gaW5pdGlhbGl6ZSBwYXltZW50IGJlY2F1c2UgXCJvcHRpb25zLmJyYWludHJlZXZpc2FjaGVja291dFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QoaSk7Y29uc3Qgbj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTt0aGlzLnBheW1lbnRNZXRob2Q9bi5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKTtjb25zdCByPW4uZ2V0Q2hlY2tvdXRPclRocm93KCksbz1uLmdldFN0b3JlQ29uZmlnT3JUaHJvdygpLHtjbGllbnRUb2tlbjpzLGNvbmZpZzpkfT10aGlzLnBheW1lbnRNZXRob2R8fHt9O2lmKCFzKXRocm93IG5ldyBHKEguTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0e29uRXJyb3I6bD1hLG9uUGF5bWVudFNlbGVjdDpjPWF9PXQ7dGhpcy5icmFpbnRyZWVTZGsuaW5pdGlhbGl6ZShzKTtjb25zdCB1PXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldEJyYWludHJlZVZpc2FDaGVja291dCgpLGg9eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0VmlzYUNoZWNrb3V0U2RrKG51bGw9PWQ/dm9pZCAwOmQudGVzdE1vZGUpLHk9dS5jcmVhdGVJbml0T3B0aW9ucyh7c2V0dGluZ3M6e2xvY2FsZTpvLnN0b3JlUHJvZmlsZS5zdG9yZUxhbmd1YWdlLHNoaXBwaW5nOntjb2xsZWN0U2hpcHBpbmc6ITF9fSxwYXltZW50UmVxdWVzdDp7Y3VycmVuY3lDb2RlOm8uY3VycmVuY3kuY29kZSxzdWJ0b3RhbDpTdHJpbmcoci5zdWJ0b3RhbCl9fSk7eWllbGQgaC5pbml0KHkpLGgub24oXCJwYXltZW50LnN1Y2Nlc3NcIixlPT50aGlzLnRva2VuaXplUGF5bWVudCh1LGUpLnRoZW4oKCk9PlByb21pc2UuYWxsKFt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZENoZWNrb3V0KCksdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKGkpXSkpLnRoZW4oKCk9PmMoKSkuY2F0Y2goZT0+bChlKSkpLGgub24oXCJwYXltZW50LmVycm9yXCIsKGUsdCk9PmwodCkpfSl9ZXhlY3V0ZShlLHQpe3ZhciBpLG47cmV0dXJuIHN0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50OnJ9PWUsbz1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSk7aWYoIXIpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBzdWJtaXQgcGF5bWVudCBiZWNhdXNlIFwicGF5bG9hZC5wYXltZW50XCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO2lmKCEobnVsbD09PShuPW51bGw9PT0oaT10aGlzLnBheW1lbnRNZXRob2QpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PW4/dm9pZCAwOm4ubm9uY2UpKXRocm93IG5ldyBHKEguTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0e25vbmNlOmF9PXRoaXMucGF5bWVudE1ldGhvZC5pbml0aWFsaXphdGlvbkRhdGE7dHJ5e3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRPcmRlcihvLHQpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7cGF5bWVudERhdGE6e25vbmNlOmF9fSkpfWNhdGNoKGUpe3RoaXMuaGFuZGxlRXJyb3IoZSl9fSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IE9lKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gc3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmRlaW5pdGlhbGl6ZSgpfSl9dG9rZW5pemVQYXltZW50KGUsdCl7cmV0dXJuIHN0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gUHJvbWlzZS5hbGwoW2UudG9rZW5pemUodCksdGhpcy5icmFpbnRyZWVTZGsuZ2V0RGF0YUNvbGxlY3Rvck9yVGhyb3coKV0pLnRoZW4oKFtlLHRdKT0+e2NvbnN0IGk9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksbj1pLmdldFNoaXBwaW5nQWRkcmVzcygpLHI9aS5nZXRCaWxsaW5nQWRkcmVzcygpLHtzaGlwcGluZ0FkZHJlc3M6bz10aGlzLm1hcFRvVmlzYUNoZWNrb3V0QWRkcmVzcyhuKSxiaWxsaW5nQWRkcmVzczphPXRoaXMubWFwVG9WaXNhQ2hlY2tvdXRBZGRyZXNzKHIpfT1lO3JldHVybiB0aGlzLnBvc3RGb3JtKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7c2hpcHBpbmdBZGRyZXNzOm8sYmlsbGluZ0FkZHJlc3M6YX0pLHQpfSl9KX1tYXBUb1Zpc2FDaGVja291dEFkZHJlc3MoZSl7cmV0dXJuIGU/e2ZpcnN0TmFtZTplLmZpcnN0TmFtZSxsYXN0TmFtZTplLmxhc3ROYW1lLHBob25lTnVtYmVyOmUucGhvbmUsc3RyZWV0QWRkcmVzczplLmFkZHJlc3MxLGV4dGVuZGVkQWRkcmVzczplLmFkZHJlc3MyLGxvY2FsaXR5OmUuY2l0eSxyZWdpb246ZS5zdGF0ZU9yUHJvdmluY2VDb2RlLGNvdW50cnlDb2RlOmUuY291bnRyeUNvZGUscG9zdGFsQ29kZTplLnBvc3RhbENvZGV9Ont9fXBvc3RGb3JtKGUsdCl7Y29uc3R7dXNlckRhdGE6aSxiaWxsaW5nQWRkcmVzczpuLHNoaXBwaW5nQWRkcmVzczpyLGRldGFpbHM6b309ZSx7dXNlckVtYWlsOmF9PWkse2RldmljZURhdGE6c309dDtyZXR1cm4gdGhpcy5mb3JtUG9zdGVyLnBvc3RGb3JtKFwiL2NoZWNrb3V0LnBocFwiLHtwYXltZW50X3R5cGU6ZS50eXBlLG5vbmNlOmUubm9uY2UscHJvdmlkZXI6XCJicmFpbnRyZWV2aXNhY2hlY2tvdXRcIixhY3Rpb246XCJzZXRfZXh0ZXJuYWxfY2hlY2tvdXRcIixkZXZpY2VfZGF0YTpzLGNhcmRfaW5mb3JtYXRpb246SlNPTi5zdHJpbmdpZnkoe3R5cGU6by5jYXJkVHlwZSxudW1iZXI6by5sYXN0VHdvfSksYmlsbGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0QWRkcmVzcyhhLG4pKSxzaGlwcGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KHRoaXMuZ2V0QWRkcmVzcyhhLHIpKX0pfWdldEFkZHJlc3MoZSx0PXt9KXtyZXR1cm57ZW1haWw6ZSxmaXJzdF9uYW1lOnQuZmlyc3ROYW1lLGxhc3RfbmFtZTp0Lmxhc3ROYW1lLHBob25lX251bWJlcjp0LnBob25lTnVtYmVyLGFkZHJlc3NfbGluZV8xOnQuc3RyZWV0QWRkcmVzcyxhZGRyZXNzX2xpbmVfMjp0LmV4dGVuZGVkQWRkcmVzcyxjaXR5OnQubG9jYWxpdHksc3RhdGU6dC5yZWdpb24sY291bnRyeV9jb2RlOnQuY291bnRyeUNvZGUscG9zdGFsX2NvZGU6dC5wb3N0YWxDb2RlfX1oYW5kbGVFcnJvcihlKXtpZihlIGluc3RhbmNlb2YgRXJyb3ImJlwiQnJhaW50cmVlRXJyb3JcIj09PWUubmFtZSl0aHJvdyBuZXcgRWUoZS5tZXNzYWdlKTt0aHJvdyBlfX1jb25zdCBsdD0kKGk9Pntjb25zdCBuPXdpbmRvdyxyPW5ldyB2KGkpLG89bmV3IHllKG5ldyBxKHQoKSxuLHIpKTtyZXR1cm4gbmV3IGR0KGksZSgpLG8pfSxbe2lkOlwiYnJhaW50cmVldmlzYWNoZWNrb3V0XCJ9XSk7dmFyIGN0PWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIHV0e2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2U9dH1pbml0aWFsaXplKGUpe3JldHVybiBjdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6dH09ZTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QodCk7Y29uc3QgaT10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTt0aGlzLnZlbm1vT3B0aW9ucz1lLmJyYWludHJlZXZlbm1vO2NvbnN0IG49aS5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyh0KTt5aWVsZCB0aGlzLmluaXRpYWxpemVCcmFpbnRyZWVWZW5tbyhuKX0pfWV4ZWN1dGUoZSl7cmV0dXJuIGN0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50OnR9PWUsaT1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSk7aWYoIXQpdGhyb3cgbmV3IEMoW1wicGF5bWVudFwiXSk7dHJ5e2NvbnN0IGU9eWllbGQgdGhpcy5wcmVwYXJlUGF5bWVudERhdGEodCk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKGkpLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5zdWJtaXRQYXltZW50KGUpfWNhdGNoKGUpe3RoaXMuaGFuZGxlRXJyb3IoZSl9fSl9ZmluYWxpemUoKXtyZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IE9lKX1kZWluaXRpYWxpemUoKXtyZXR1cm4gY3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3JldHVybiB5aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS50ZWFyZG93bigpLFByb21pc2UucmVzb2x2ZSgpfSl9aGFuZGxlRXJyb3IoZSl7aWYoIUwoZSkpdGhyb3cgZTtpZihcIlBBWVBBTF9QT1BVUF9DTE9TRURcIj09PWUuY29kZSl0aHJvdyBuZXcgTyhlLm1lc3NhZ2UpO3Rocm93IG5ldyBFZShlLm1lc3NhZ2UpfWluaXRpYWxpemVCcmFpbnRyZWVWZW5tbyhlKXt2YXIgdDtyZXR1cm4gY3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2NsaWVudFRva2VuOml9PWU7aWYoIWkpdGhyb3cgbmV3IEcoSC5NaXNzaW5nUGF5bWVudE1ldGhvZCk7Y29uc3Qgbj15KHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFN0b3JlQ29uZmlnT3JUaHJvdygpLmNoZWNrb3V0U2V0dGluZ3MuZmVhdHVyZXMsXCJQQVlQQUwtNTQwNi5icmFpbnRyZWVfdmVubW9fd2ViX2ZhbGxiYWNrX3N1cHBvcnRcIik7dHJ5e3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmluaXRpYWxpemUoaSksdGhpcy5icmFpbnRyZWVWZW5tb0NoZWNrb3V0PXlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFZlbm1vQ2hlY2tvdXQoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHZvaWQgMCE9PShudWxsPT09KHQ9dGhpcy52ZW5tb09wdGlvbnMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0LmFsbG93RGVza3RvcCk/e2FsbG93RGVza3RvcDp0aGlzLnZlbm1vT3B0aW9ucy5hbGxvd0Rlc2t0b3B9Ont9KSxuP3ttb2JpbGVXZWJGYWxsQmFjazpufTp7fSkpfWNhdGNoKGUpe3RoaXMuaGFuZGxlRXJyb3IoZSl9fSl9cHJlcGFyZVBheW1lbnREYXRhKGUpe3JldHVybiBjdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSx7bm9uY2U6aX09dC5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhlLm1ldGhvZElkKTtpZihpKXJldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sZSkse3BheW1lbnREYXRhOnRoaXMuZm9ybWF0dGVkUGF5bG9hZChpKX0pO2NvbnN0IG49eWllbGQgdGhpcy5icmFpbnRyZWVWZW5tb1Rva2VuaXplKCkscj15aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRTZXNzaW9uSWQoKTtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHtwYXltZW50RGF0YTp0aGlzLmZvcm1hdHRlZFBheWxvYWQobi5ub25jZSxuLmRldGFpbHMuZW1haWwscil9KX0pfWZvcm1hdHRlZFBheWxvYWQoZSx0LGkpe3JldHVybntmb3JtYXR0ZWRQYXlsb2FkOnt2YXVsdF9wYXltZW50X2luc3RydW1lbnQ6bnVsbCxzZXRfYXNfZGVmYXVsdF9zdG9yZWRfaW5zdHJ1bWVudDpudWxsLGRldmljZV9pbmZvOml8fG51bGwscGF5cGFsX2FjY291bnQ6e3Rva2VuOmUsZW1haWw6dHx8bnVsbH19fX1icmFpbnRyZWVWZW5tb1Rva2VuaXplKCl7cmV0dXJuIG5ldyBQcm9taXNlKChlLHQpPT57dmFyIGk7bnVsbD09PShpPXRoaXMuYnJhaW50cmVlVmVubW9DaGVja291dCl8fHZvaWQgMD09PWl8fGkudG9rZW5pemUoKGksbik9PntpZihpKXJldHVybiB0KGkpO2Uobil9KX0pfX1jb25zdCBodD0kKGU9Pntjb25zdCBpPXdpbmRvdyxuPXQoKSxyPW5ldyB2KGUpLG89bmV3IHEobixpLHIpLGE9bmV3IGoobyxpKTtyZXR1cm4gbmV3IHV0KGUsYSl9LFt7aWQ6XCJicmFpbnRyZWV2ZW5tb1wifV0pO3ZhciB5dD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBtdHtjb25zdHJ1Y3RvcihlLHQsaSl7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2U9dCx0aGlzLmJyYWludHJlZUhvc3RlZEZvcm09aX1pbml0aWFsaXplKGUpe3JldHVybiB5dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7bWV0aG9kSWQ6dCxnYXRld2F5SWQ6aSxicmFpbnRyZWU6bn09ZTt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QodCk7Y29uc3Qgcj10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTt0aGlzLnBheW1lbnRNZXRob2Q9ci5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyh0KTtjb25zdHtjbGllbnRUb2tlbjpvfT10aGlzLnBheW1lbnRNZXRob2Q7aWYoIW8pdGhyb3cgbmV3IEcoSC5NaXNzaW5nUGF5bWVudE1ldGhvZCk7dGhpcy50aHJlZURTZWN1cmU9bnVsbD09bj92b2lkIDA6bi50aHJlZURTZWN1cmUsdGhpcy5vblBheW1lbnRFcnJvcj1udWxsPT1uP3ZvaWQgMDpuLm9uUGF5bWVudEVycm9yO3RyeXt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKG8sdGhpcy50aHJlZURTZWN1cmUpLHRoaXMuaXNIb3N0ZWRQYXltZW50Rm9ybUVuYWJsZWQodCxpKSYmKG51bGw9PW4/dm9pZCAwOm4uZm9ybSkmJih5aWVsZCB0aGlzLmJyYWludHJlZUhvc3RlZEZvcm0uaW5pdGlhbGl6ZShuLmZvcm0sbi51bnN1cHBvcnRlZENhcmRCcmFuZHMsbyksdGhpcy5pc0hvc3RlZEZvcm1Jbml0aWFsaXplZD10aGlzLmJyYWludHJlZUhvc3RlZEZvcm0uaXNJbml0aWFsaXplZCgpKSx0aGlzLmlzM2RzRW5hYmxlZD10aGlzLnBheW1lbnRNZXRob2QuY29uZmlnLmlzM2RzRW5hYmxlZCx0aGlzLmRldmljZVNlc3Npb25JZD15aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXRTZXNzaW9uSWQoKSx0aGlzLnNob3VsZEluaXRpYWxpemVCcmFpbnRyZWVGYXN0bGFuZSgpJiYoeWllbGQgdGhpcy5pbml0aWFsaXplQnJhaW50cmVlRmFzdGxhbmVPclRocm93KHQpKX1jYXRjaChlKXtyZXR1cm4gdGhpcy5oYW5kbGVFcnJvcihlLHQpfX0pfWV4ZWN1dGUoZSl7cmV0dXJuIHl0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50OnR9PWUsaT1mdW5jdGlvbihlLHQpe3ZhciBpPXt9O2Zvcih2YXIgbiBpbiBlKU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChlLG4pJiZ0LmluZGV4T2Yobik8MCYmKGlbbl09ZVtuXSk7aWYobnVsbCE9ZSYmXCJmdW5jdGlvblwiPT10eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyl7dmFyIHI9MDtmb3Iobj1PYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKGUpO3I8bi5sZW5ndGg7cisrKXQuaW5kZXhPZihuW3JdKTwwJiZPYmplY3QucHJvdG90eXBlLnByb3BlcnR5SXNFbnVtZXJhYmxlLmNhbGwoZSxuW3JdKSYmKGlbbltyXV09ZVtuW3JdXSl9cmV0dXJuIGl9KGUsW1wicGF5bWVudFwiXSk7aWYoIXQpdGhyb3cgbmV3IEMoW1wicGF5bWVudFwiXSk7dGhpcy5pc0hvc3RlZEZvcm1Jbml0aWFsaXplZCYmdGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtLnZhbGlkYXRlKCkseWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdE9yZGVyKGkpO2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkscj1uLmdldEJpbGxpbmdBZGRyZXNzT3JUaHJvdygpLG89bi5nZXRPcmRlck9yVGhyb3coKS5vcmRlckFtb3VudDt0cnl7Y29uc3QgZT10aGlzLmlzSG9zdGVkRm9ybUluaXRpYWxpemVkP3lpZWxkIHRoaXMucHJlcGFyZUhvc3RlZFBheW1lbnREYXRhKHQscixvKTp5aWVsZCB0aGlzLnByZXBhcmVQYXltZW50RGF0YSh0LHIsbyk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHQpLHtwYXltZW50RGF0YTplfSkpfWNhdGNoKGUpe3JldHVybiB0aGlzLnByb2Nlc3NBZGRpdGlvbmFsQWN0aW9uKGUsdCxvKX19KX1maW5hbGl6ZSgpe3JldHVybiBQcm9taXNlLnJlamVjdChuZXcgT2UpfWRlaW5pdGlhbGl6ZSgpe3JldHVybiB5dCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIHRoaXMuaXNIb3N0ZWRGb3JtSW5pdGlhbGl6ZWQ9ITEseWllbGQgUHJvbWlzZS5hbGwoW3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnRlYXJkb3duKCksdGhpcy5icmFpbnRyZWVIb3N0ZWRGb3JtLmRlaW5pdGlhbGl6ZSgpXSksUHJvbWlzZS5yZXNvbHZlKCl9KX1oYW5kbGVFcnJvcihlLHQpe3ZhciBpO2lmKGJlKGUpKXtpZighKHQmJnRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmlzUGF5bWVudE1ldGhvZEluaXRpYWxpemVkKHttZXRob2RJZDp0fSl8fFwiSE9TVEVEX0ZJRUxEU19JTlZBTElEX0ZJRUxEX1NFTEVDVE9SXCIhPT1lLmNvZGUpKXJldHVybjtpZihlLmNvZGUuc3RhcnRzV2l0aChcIlRIUkVFRFNfXCIpKXJldHVybiBudWxsPT09KGk9dGhpcy5vblBheW1lbnRFcnJvcil8fHZvaWQgMD09PWl8fGkuY2FsbCh0aGlzLG5ldyBFZShcIlRIUkVFRFNfVkVSSUZJQ0FUSU9OX0ZBSUxFRFwiKSksUHJvbWlzZS5yZWplY3QoKTt0aHJvdyBuZXcgRWUoZS5tZXNzYWdlKX10aHJvdyBlfXByZXBhcmVQYXltZW50RGF0YShlLHQsaSl7cmV0dXJuIHl0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdHtwYXltZW50RGF0YTpufT1lLHI9e2RldmljZVNlc3Npb25JZDp0aGlzLmRldmljZVNlc3Npb25JZH07aWYodGhpcy5pc1N1Ym1pdHRpbmdXaXRoU3RvcmVkQ2FyZChlKSlyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHIpLG4pO2NvbnN0e3Nob3VsZFNhdmVJbnN0cnVtZW50Om89ITEsc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDphPSExfT1rZShuKT9uOnt9LHtub25jZTpzfT10aGlzLnNob3VsZFBlcmZvcm0zRFNWZXJpZmljYXRpb24oZSk/eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudmVyaWZ5Q2FyZChlLHQsaSk6eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudG9rZW5pemVDYXJkKGUsdCk7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxyKSx7bm9uY2U6cyxzaG91bGRTYXZlSW5zdHJ1bWVudDpvLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6YX0pfSl9cHJlcGFyZUhvc3RlZFBheW1lbnREYXRhKGUsdCxpKXtyZXR1cm4geXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e3BheW1lbnREYXRhOm59PWUscj17ZGV2aWNlU2Vzc2lvbklkOnRoaXMuZGV2aWNlU2Vzc2lvbklkfTtpZih0aGlzLmlzU3VibWl0dGluZ1dpdGhTdG9yZWRDYXJkKGUpKXtjb25zdHtub25jZTplfT15aWVsZCB0aGlzLmJyYWludHJlZUhvc3RlZEZvcm0udG9rZW5pemVGb3JTdG9yZWRDYXJkVmVyaWZpY2F0aW9uKCk7cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHIpLG4pLHtub25jZTplfSl9Y29uc3R7c2hvdWxkU2F2ZUluc3RydW1lbnQ6bz0hMSxzaG91bGRTZXRBc0RlZmF1bHRJbnN0cnVtZW50OmE9ITF9PWtlKG4pP246e30se25vbmNlOnN9PXRoaXMuc2hvdWxkUGVyZm9ybTNEU1ZlcmlmaWNhdGlvbihlKT95aWVsZCB0aGlzLnZlcmlmeUNhcmRXaXRoSG9zdGVkRm9ybSh0LGkpOnlpZWxkIHRoaXMuYnJhaW50cmVlSG9zdGVkRm9ybS50b2tlbml6ZSh0KTtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHIpLHtzaG91bGRTYXZlSW5zdHJ1bWVudDpvLHNob3VsZFNldEFzRGVmYXVsdEluc3RydW1lbnQ6YSxub25jZTpzfSl9KX1wcmVwYXJlQWRkaXRpb25hbEFjdGlvblBheW1lbnREYXRhKGUsdCl7Y29uc3R7cGF5bWVudERhdGE6aX09ZSxuPXtkZXZpY2VTZXNzaW9uSWQ6dGhpcy5kZXZpY2VTZXNzaW9uSWQsbm9uY2U6dH0se3Nob3VsZFNhdmVJbnN0cnVtZW50OnI9ITEsc2hvdWxkU2V0QXNEZWZhdWx0SW5zdHJ1bWVudDpvPSExfT1rZShpKT9pOnt9O3JldHVybiB0aGlzLmlzU3VibWl0dGluZ1dpdGhTdG9yZWRDYXJkKGUpJiYocnx8byk/T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGkpLG4pOk9iamVjdC5hc3NpZ24oe30sbil9dmVyaWZ5Q2FyZFdpdGhIb3N0ZWRGb3JtKGUsdCl7cmV0dXJuIHl0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCBpPXlpZWxkIHRoaXMuYnJhaW50cmVlSG9zdGVkRm9ybS50b2tlbml6ZShlKTtyZXR1cm4gdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuY2hhbGxlbmdlM0RTVmVyaWZpY2F0aW9uKGksdCl9KX1wcm9jZXNzQWRkaXRpb25hbEFjdGlvbihlLHQsaSl7cmV0dXJuIHl0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighKGU9Plwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmXCJib2R5XCJpbiBlKShlKXx8IWwoZS5ib2R5LmVycm9ycyx7Y29kZTpcInRocmVlX2Rfc2VjdXJlX3JlcXVpcmVkXCJ9KSlyZXR1cm4gdGhpcy5oYW5kbGVFcnJvcihlKTt0cnl7Y29uc3R7cGF5ZXJfYXV0aF9yZXF1ZXN0Om59PWZ1bmN0aW9uKGUpe3JldHVyblwib2JqZWN0XCI9PXR5cGVvZiBlJiZudWxsIT09ZSYmXCJuYW1lXCJpbiBlJiZcImJvZHlcImluIGUmJlwic3RhdHVzXCJpbiBlLmJvZHkmJlwidGhyZWVfZHNfcmVzdWx0XCJpbiBlLmJvZHkmJlwicGF5ZXJfYXV0aF9yZXF1ZXN0XCJpbiBlLmJvZHkudGhyZWVfZHNfcmVzdWx0JiZcImVycm9yc1wiaW4gZS5ib2R5fShlKSYmZS5ib2R5LnRocmVlX2RzX3Jlc3VsdHx8e30se3BheW1lbnREYXRhOnJ9PXQsbz10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKTtpZighcnx8IUllKHIpKXRocm93IG5ldyBDKFtcImluc3RydW1lbnRJZFwiXSk7Y29uc3QgYT1vLmdldENhcmRJbnN0cnVtZW50T3JUaHJvdyhyLmluc3RydW1lbnRJZCkse25vbmNlOnN9PXlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmNoYWxsZW5nZTNEU1ZlcmlmaWNhdGlvbih7bm9uY2U6bnx8XCJcIixiaW46YS5paW59LGkpLGQ9dGhpcy5wcmVwYXJlQWRkaXRpb25hbEFjdGlvblBheW1lbnREYXRhKHQscyk7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnN1Ym1pdFBheW1lbnQoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHQpLHtwYXltZW50RGF0YTpkfSkpfWNhdGNoKGUpe3JldHVybiB0aGlzLmhhbmRsZUVycm9yKGUpfX0pfWlzSG9zdGVkUGF5bWVudEZvcm1FbmFibGVkKGUsdCl7cmV0dXJuISFlJiYhMD09PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRNZXRob2RPclRocm93KGUsdCkuY29uZmlnLmlzSG9zdGVkRm9ybUVuYWJsZWR9aXNTdWJtaXR0aW5nV2l0aFN0b3JlZENhcmQoZSl7cmV0dXJuISghZS5wYXltZW50RGF0YXx8IUllKGUucGF5bWVudERhdGEpKX1zaG91bGRQZXJmb3JtM0RTVmVyaWZpY2F0aW9uKGUpe3JldHVybiEoIXRoaXMuaXMzZHNFbmFibGVkfHx0aGlzLmlzU3VibWl0dGluZ1dpdGhTdG9yZWRDYXJkKGUpKX1zaG91bGRJbml0aWFsaXplQnJhaW50cmVlRmFzdGxhbmUoKXt2YXIgZTtjb25zdCB0PXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLmdldFBheW1lbnRQcm92aWRlckN1c3RvbWVyT3JUaHJvdygpLGk9WmUodCk/dDp7fTtyZXR1cm4obnVsbD09PShlPXRoaXMucGF5bWVudE1ldGhvZCl8fHZvaWQgMD09PWU/dm9pZCAwOmUuaW5pdGlhbGl6YXRpb25EYXRhLmlzQWNjZWxlcmF0ZWRDaGVja291dEVuYWJsZWQpJiYhKG51bGw9PWk/dm9pZCAwOmkuYXV0aGVudGljYXRpb25TdGF0ZSl9aW5pdGlhbGl6ZUJyYWludHJlZUZhc3RsYW5lT3JUaHJvdyhlKXtyZXR1cm4geXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksaT10LmdldENhcnRPclRocm93KCksbj10LmdldFBheW1lbnRNZXRob2RPclRocm93KGUpLHtjbGllbnRUb2tlbjpyLGNvbmZpZzpvfT1uO2lmKCFyKXRocm93IG5ldyBHKEguTWlzc2luZ1BheW1lbnRNZXRob2QpO3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmluaXRpYWxpemUocix0aGlzLnRocmVlRFNlY3VyZSkseWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0QnJhaW50cmVlRmFzdGxhbmUoaS5pZCxvLnRlc3RNb2RlKX0pfX1mdW5jdGlvbiBwdChlKXtyZXR1cm5cImNhcmROdW1iZXJcImluIGV9ZnVuY3Rpb24gZ3QoZSl7aWYoIUwoZSkpcmV0dXJuITE7Y29uc3R7ZGV0YWlsczp0fT1lO3JldHVybiB2b2lkIDA9PT10fHxcIm9iamVjdFwiPT10eXBlb2YgdCYmbnVsbCE9PXQmJnZvaWQgMD09PXQuaW52YWxpZEZpZWxkS2V5c3x8KGk9dCxBcnJheS5pc0FycmF5KGkpJiZpLmV2ZXJ5KGU9Plwic3RyaW5nXCI9PXR5cGVvZiBlKSk7dmFyIGl9dmFyIHZ0LGZ0PWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9OyFmdW5jdGlvbihlKXtlW2UuQ3JlZGl0Q2FyZD0wXT1cIkNyZWRpdENhcmRcIixlW2UuU3RvcmVkQ2FyZFZlcmlmaWNhdGlvbj0xXT1cIlN0b3JlZENhcmRWZXJpZmljYXRpb25cIn0odnR8fCh2dD17fSkpO2NsYXNzIGJ0e2NvbnN0cnVjdG9yKGUsdCl7dGhpcy5icmFpbnRyZWVTY3JpcHRMb2FkZXI9ZSx0aGlzLmJyYWludHJlZVNES1ZlcnNpb25NYW5hZ2VyPXQsdGhpcy5pc0luaXRpYWxpemVkSG9zdGVkRm9ybT0hMSx0aGlzLmhhbmRsZUJsdXI9ZT0+e3ZhciB0LGk7bnVsbD09PShpPW51bGw9PT0odD10aGlzLmZvcm1PcHRpb25zKXx8dm9pZCAwPT09dD92b2lkIDA6dC5vbkJsdXIpfHx2b2lkIDA9PT1pfHxpLmNhbGwodCx7ZmllbGRUeXBlOnRoaXMubWFwRmllbGRUeXBlKGUuZW1pdHRlZEJ5KSxlcnJvcnM6dGhpcy5tYXBFcnJvcnMoZS5maWVsZHMpfSl9LHRoaXMuaGFuZGxlRm9jdXM9ZT0+e3ZhciB0LGk7bnVsbD09PShpPW51bGw9PT0odD10aGlzLmZvcm1PcHRpb25zKXx8dm9pZCAwPT09dD92b2lkIDA6dC5vbkZvY3VzKXx8dm9pZCAwPT09aXx8aS5jYWxsKHQse2ZpZWxkVHlwZTp0aGlzLm1hcEZpZWxkVHlwZShlLmVtaXR0ZWRCeSl9KX0sdGhpcy5oYW5kbGVDYXJkVHlwZUNoYW5nZT1lPT57dmFyIHQsaTtjb25zdCBuPTE9PT1lLmNhcmRzLmxlbmd0aD9lLmNhcmRzWzBdLnR5cGUucmVwbGFjZSgvXm1hc3Rlci1jYXJkJC8sXCJtYXN0ZXJjYXJkXCIpOnZvaWQgMDtudWxsPT09KGk9bnVsbD09PSh0PXRoaXMuZm9ybU9wdGlvbnMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0Lm9uQ2FyZFR5cGVDaGFuZ2UpfHx2b2lkIDA9PT1pfHxpLmNhbGwodCx7Y2FyZFR5cGU6bn0pfSx0aGlzLmhhbmRsZUlucHV0U3VibWl0UmVxdWVzdD1lPT57dmFyIHQsaTtudWxsPT09KGk9bnVsbD09PSh0PXRoaXMuZm9ybU9wdGlvbnMpfHx2b2lkIDA9PT10P3ZvaWQgMDp0Lm9uRW50ZXIpfHx2b2lkIDA9PT1pfHxpLmNhbGwodCx7ZmllbGRUeXBlOnRoaXMubWFwRmllbGRUeXBlKGUuZW1pdHRlZEJ5KX0pfSx0aGlzLmhhbmRsZVZhbGlkaXR5Q2hhbmdlPWU9Pnt2YXIgdCxpO251bGw9PT0oaT1udWxsPT09KHQ9dGhpcy5mb3JtT3B0aW9ucyl8fHZvaWQgMD09PXQ/dm9pZCAwOnQub25WYWxpZGF0ZSl8fHZvaWQgMD09PWl8fGkuY2FsbCh0LHtpc1ZhbGlkOnRoaXMuaXNWYWxpZEZvcm0oZSksZXJyb3JzOnRoaXMubWFwVmFsaWRhdGlvbkVycm9ycyhlLmZpZWxkcyl9KX19aW5pdGlhbGl6ZShlLHQsaSl7dmFyIHIsbyxhLHMsZDtyZXR1cm4gZnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RoaXMuY2xpZW50VG9rZW49aSx0aGlzLmZvcm1PcHRpb25zPWUsdGhpcy50eXBlPXB0KGUuZmllbGRzKT92dC5DcmVkaXRDYXJkOnZ0LlN0b3JlZENhcmRWZXJpZmljYXRpb247Y29uc3QgbD10aGlzLm1hcEZpZWxkT3B0aW9ucyhlLmZpZWxkcyx0KTtuKGwpP3RoaXMuaXNJbml0aWFsaXplZEhvc3RlZEZvcm09ITE6KHRoaXMuY2FyZEZpZWxkcz15aWVsZCB0aGlzLmNyZWF0ZUhvc3RlZEZpZWxkcyh7ZmllbGRzOmwsc3R5bGVzOmUuc3R5bGVzJiZ0aGlzLm1hcFN0eWxlT3B0aW9ucyhlLnN0eWxlcyl9KSxudWxsPT09KHI9dGhpcy5jYXJkRmllbGRzKXx8dm9pZCAwPT09cnx8ci5vbihcImJsdXJcIix0aGlzLmhhbmRsZUJsdXIpLG51bGw9PT0obz10aGlzLmNhcmRGaWVsZHMpfHx2b2lkIDA9PT1vfHxvLm9uKFwiZm9jdXNcIix0aGlzLmhhbmRsZUZvY3VzKSxudWxsPT09KGE9dGhpcy5jYXJkRmllbGRzKXx8dm9pZCAwPT09YXx8YS5vbihcImNhcmRUeXBlQ2hhbmdlXCIsdGhpcy5oYW5kbGVDYXJkVHlwZUNoYW5nZSksbnVsbD09PShzPXRoaXMuY2FyZEZpZWxkcyl8fHZvaWQgMD09PXN8fHMub24oXCJ2YWxpZGl0eUNoYW5nZVwiLHRoaXMuaGFuZGxlVmFsaWRpdHlDaGFuZ2UpLG51bGw9PT0oZD10aGlzLmNhcmRGaWVsZHMpfHx2b2lkIDA9PT1kfHxkLm9uKFwiaW5wdXRTdWJtaXRSZXF1ZXN0XCIsdGhpcy5oYW5kbGVJbnB1dFN1Ym1pdFJlcXVlc3QpLHRoaXMuaXNJbml0aWFsaXplZEhvc3RlZEZvcm09ITApfSl9aXNJbml0aWFsaXplZCgpe3JldHVybiEhdGhpcy5pc0luaXRpYWxpemVkSG9zdGVkRm9ybX1kZWluaXRpYWxpemUoKXt2YXIgZTtyZXR1cm4gZnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RoaXMuaXNJbml0aWFsaXplZEhvc3RlZEZvcm0mJih0aGlzLmlzSW5pdGlhbGl6ZWRIb3N0ZWRGb3JtPSExLHlpZWxkIG51bGw9PT0oZT10aGlzLmNhcmRGaWVsZHMpfHx2b2lkIDA9PT1lP3ZvaWQgMDplLnRlYXJkb3duKCkpfSl9dmFsaWRhdGUoKXtpZighdGhpcy5jYXJkRmllbGRzKXRocm93IG5ldyBJKFAuUGF5bWVudE5vdEluaXRpYWxpemVkKTtjb25zdCBlPXRoaXMuY2FyZEZpZWxkcy5nZXRTdGF0ZSgpO2lmKCF0aGlzLmlzVmFsaWRGb3JtKGUpKXt0aGlzLmhhbmRsZVZhbGlkaXR5Q2hhbmdlKGUpO2NvbnN0IHQ9dGhpcy5tYXBWYWxpZGF0aW9uRXJyb3JzKGUuZmllbGRzKTt0aHJvdyBuZXcgUyh0KX19dG9rZW5pemUoZSl7dmFyIHQsaSxuLHIsYTtyZXR1cm4gZnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCF0aGlzLmNhcmRGaWVsZHMpdGhyb3cgbmV3IEkoUC5QYXltZW50Tm90SW5pdGlhbGl6ZWQpO3RyeXtjb25zdCByPXlpZWxkIHRoaXMuY2FyZEZpZWxkcy50b2tlbml6ZShkKHtiaWxsaW5nQWRkcmVzczplJiZ0aGlzLm1hcEJpbGxpbmdBZGRyZXNzKGUpfSxvKSk7cmV0dXJuIG51bGw9PT0oaT1udWxsPT09KHQ9dGhpcy5mb3JtT3B0aW9ucyl8fHZvaWQgMD09PXQ/dm9pZCAwOnQub25WYWxpZGF0ZSl8fHZvaWQgMD09PWl8fGkuY2FsbCh0LHtpc1ZhbGlkOiEwLGVycm9yczp7fX0pLHtub25jZTpyLm5vbmNlLGJpbjpudWxsPT09KG49ci5kZXRhaWxzKXx8dm9pZCAwPT09bj92b2lkIDA6bi5iaW59fWNhdGNoKGUpe2lmKGd0KGUpKXtjb25zdCB0PXRoaXMubWFwVG9rZW5pemVFcnJvcihlKTtpZih0KXRocm93IG51bGw9PT0oYT1udWxsPT09KHI9dGhpcy5mb3JtT3B0aW9ucyl8fHZvaWQgMD09PXI/dm9pZCAwOnIub25WYWxpZGF0ZSl8fHZvaWQgMD09PWF8fGEuY2FsbChyLHtpc1ZhbGlkOiExLGVycm9yczp0fSksbmV3IFModCl9dGhyb3cgZX19KX10b2tlbml6ZUZvclN0b3JlZENhcmRWZXJpZmljYXRpb24oKXt2YXIgZSx0LGksbixyO3JldHVybiBmdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7aWYoIXRoaXMuY2FyZEZpZWxkcyl0aHJvdyBuZXcgSShQLlBheW1lbnROb3RJbml0aWFsaXplZCk7dHJ5e2NvbnN0IG49eWllbGQgdGhpcy5jYXJkRmllbGRzLnRva2VuaXplKCk7cmV0dXJuIG51bGw9PT0odD1udWxsPT09KGU9dGhpcy5mb3JtT3B0aW9ucyl8fHZvaWQgMD09PWU/dm9pZCAwOmUub25WYWxpZGF0ZSl8fHZvaWQgMD09PXR8fHQuY2FsbChlLHtpc1ZhbGlkOiEwLGVycm9yczp7fX0pLHtub25jZTpuLm5vbmNlLGJpbjpudWxsPT09KGk9bi5kZXRhaWxzKXx8dm9pZCAwPT09aT92b2lkIDA6aS5iaW59fWNhdGNoKGUpe2lmKGd0KGUpKXtjb25zdCB0PXRoaXMubWFwVG9rZW5pemVFcnJvcihlLCEwKTtpZih0KXRocm93IG51bGw9PT0ocj1udWxsPT09KG49dGhpcy5mb3JtT3B0aW9ucyl8fHZvaWQgMD09PW4/dm9pZCAwOm4ub25WYWxpZGF0ZSl8fHZvaWQgMD09PXJ8fHIuY2FsbChuLHtpc1ZhbGlkOiExLGVycm9yczp0fSksbmV3IFModCl9dGhyb3cgZX19KX1jcmVhdGVIb3N0ZWRGaWVsZHMoZSl7cmV0dXJuIGZ0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtjb25zdCB0PXlpZWxkIHRoaXMuZ2V0Q2xpZW50KCksaT15aWVsZCB0aGlzLmJyYWludHJlZVNjcmlwdExvYWRlci5sb2FkSG9zdGVkRmllbGRzKCksbj10aGlzLmJyYWludHJlZVNES1ZlcnNpb25NYW5hZ2VyLmdldFNES1ZlcnNpb24oKT09PW0/T2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHtwcmV2ZW50Q3Vyc29ySnVtcHM6ITB9KTplO3JldHVybiBpLmNyZWF0ZShPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sbikse2NsaWVudDp0fSkpfSl9Z2V0Q2xpZW50KCl7cmV0dXJuIGZ0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtpZighdGhpcy5jbGllbnRUb2tlbil0aHJvdyBuZXcgSShQLlBheW1lbnROb3RJbml0aWFsaXplZCk7aWYoIXRoaXMuY2xpZW50KXtjb25zdCBlPXlpZWxkIHRoaXMuYnJhaW50cmVlU2NyaXB0TG9hZGVyLmxvYWRDbGllbnQoKTt0aGlzLmNsaWVudD1lLmNyZWF0ZSh7YXV0aG9yaXphdGlvbjp0aGlzLmNsaWVudFRva2VufSl9cmV0dXJuIHRoaXMuY2xpZW50fSl9bWFwQmlsbGluZ0FkZHJlc3MoZSl7cmV0dXJue2NvdW50cnlOYW1lOmUuY291bnRyeSxwb3N0YWxDb2RlOmUucG9zdGFsQ29kZSxzdHJlZXRBZGRyZXNzOmUuYWRkcmVzczI/YCR7ZS5hZGRyZXNzMX0gJHtlLmFkZHJlc3MyfWA6ZS5hZGRyZXNzMX19bWFwRmllbGRPcHRpb25zKGUsdCl7aWYocHQoZSkpe2NvbnN0IGk9e307cmV0dXJuIG51bGw9PXR8fHQuZm9yRWFjaChlPT57KGU9Pk9iamVjdC52YWx1ZXModWUpLmluY2x1ZGVzKGUpKShlKSYmKGlbZV09ITEpfSksZCh7bnVtYmVyOk9iamVjdC5hc3NpZ24oe2NvbnRhaW5lcjpgIyR7ZS5jYXJkTnVtYmVyLmNvbnRhaW5lcklkfWAscGxhY2Vob2xkZXI6ZS5jYXJkTnVtYmVyLnBsYWNlaG9sZGVyLGludGVybmFsTGFiZWw6ZS5jYXJkTnVtYmVyLmFjY2Vzc2liaWxpdHlMYWJlbH0sT2JqZWN0LmtleXMoaSkubGVuZ3RoPjA/e3N1cHBvcnRlZENhcmRCcmFuZHM6aX06e30pLGV4cGlyYXRpb25EYXRlOntjb250YWluZXI6YCMke2UuY2FyZEV4cGlyeS5jb250YWluZXJJZH1gLHBsYWNlaG9sZGVyOmUuY2FyZEV4cGlyeS5wbGFjZWhvbGRlcixpbnRlcm5hbExhYmVsOmUuY2FyZEV4cGlyeS5hY2Nlc3NpYmlsaXR5TGFiZWx9LGN2djplLmNhcmRDb2RlJiZ7Y29udGFpbmVyOmAjJHtlLmNhcmRDb2RlLmNvbnRhaW5lcklkfWAscGxhY2Vob2xkZXI6ZS5jYXJkQ29kZS5wbGFjZWhvbGRlcixpbnRlcm5hbExhYmVsOmUuY2FyZENvZGUuYWNjZXNzaWJpbGl0eUxhYmVsfSxjYXJkaG9sZGVyTmFtZTp7Y29udGFpbmVyOmAjJHtlLmNhcmROYW1lLmNvbnRhaW5lcklkfWAscGxhY2Vob2xkZXI6ZS5jYXJkTmFtZS5wbGFjZWhvbGRlcixpbnRlcm5hbExhYmVsOmUuY2FyZE5hbWUuYWNjZXNzaWJpbGl0eUxhYmVsfX0sbyl9cmV0dXJuIGQoe251bWJlcjplLmNhcmROdW1iZXJWZXJpZmljYXRpb24mJntjb250YWluZXI6YCMke2UuY2FyZE51bWJlclZlcmlmaWNhdGlvbi5jb250YWluZXJJZH1gLHBsYWNlaG9sZGVyOmUuY2FyZE51bWJlclZlcmlmaWNhdGlvbi5wbGFjZWhvbGRlcn0sY3Z2OmUuY2FyZENvZGVWZXJpZmljYXRpb24mJntjb250YWluZXI6YCMke2UuY2FyZENvZGVWZXJpZmljYXRpb24uY29udGFpbmVySWR9YCxwbGFjZWhvbGRlcjplLmNhcmRDb2RlVmVyaWZpY2F0aW9uLnBsYWNlaG9sZGVyfX0sbyl9bWFwU3R5bGVPcHRpb25zKGUpe2NvbnN0IHQ9KGU9e30pPT5kKHtjb2xvcjplLmNvbG9yLFwiZm9udC1mYW1pbHlcIjplLmZvbnRGYW1pbHksXCJmb250LXNpemVcIjplLmZvbnRTaXplLFwiZm9udC13ZWlnaHRcIjplLmZvbnRXZWlnaHR9LG8pO3JldHVybntpbnB1dDp0KGUuZGVmYXVsdCksXCIuaW52YWxpZFwiOnQoZS5lcnJvciksXCI6Zm9jdXNcIjp0KGUuZm9jdXMpfX1tYXBGaWVsZFR5cGUoZSl7c3dpdGNoKGUpe2Nhc2VcIm51bWJlclwiOnJldHVybiB0aGlzLnR5cGU9PT12dC5TdG9yZWRDYXJkVmVyaWZpY2F0aW9uP0YuQ2FyZE51bWJlclZlcmlmaWNhdGlvbjpGLkNhcmROdW1iZXI7Y2FzZVwiZXhwaXJhdGlvbkRhdGVcIjpyZXR1cm4gRi5DYXJkRXhwaXJ5O2Nhc2VcImN2dlwiOnJldHVybiB0aGlzLnR5cGU9PT12dC5TdG9yZWRDYXJkVmVyaWZpY2F0aW9uP0YuQ2FyZENvZGVWZXJpZmljYXRpb246Ri5DYXJkQ29kZTtjYXNlXCJjYXJkaG9sZGVyTmFtZVwiOnJldHVybiBGLkNhcmROYW1lO2RlZmF1bHQ6dGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCBmaWVsZCB0eXBlXCIpfX1tYXBFcnJvcnMoZSl7Y29uc3QgdD17fTtpZihlKWZvcihjb25zdFtpLG5db2YgT2JqZWN0LmVudHJpZXMoZSkpaWYobiYmdGhpcy5pc1ZhbGlkUGFyYW0oaSkpe2NvbnN0e2lzVmFsaWQ6ZSxpc0VtcHR5OnIsaXNQb3RlbnRpYWxseVZhbGlkOm99PW47dFtpXT17aXNWYWxpZDplLGlzRW1wdHk6cixpc1BvdGVudGlhbGx5VmFsaWQ6b319cmV0dXJuIHR9bWFwVmFsaWRhdGlvbkVycm9ycyhlKXtyZXR1cm4gT2JqZWN0LmtleXMoZSkucmVkdWNlKCh0LGkpPT57dmFyIG47cmV0dXJuIE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSx0KSx7W3RoaXMubWFwRmllbGRUeXBlKGkpXToobnVsbD09PShuPWVbaV0pfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmlzVmFsaWQpP3ZvaWQgMDpbdGhpcy5jcmVhdGVJbnZhbGlkRXJyb3IodGhpcy5tYXBGaWVsZFR5cGUoaSkpXX0pfSx7fSl9bWFwVG9rZW5pemVFcnJvcihlLHQ9ITEpe3ZhciBpLG47aWYoXCJIT1NURURfRklFTERTX0ZJRUxEU19FTVBUWVwiPT09ZS5jb2RlKXtjb25zdCBlPVt0aGlzLmNyZWF0ZVJlcXVpcmVkRXJyb3IodGhpcy5tYXBGaWVsZFR5cGUoXCJjdnZcIikpXTtyZXR1cm4gdD97W3RoaXMubWFwRmllbGRUeXBlKFwiY3Z2XCIpXTplfTp7W3RoaXMubWFwRmllbGRUeXBlKFwiY3Z2XCIpXTplLFt0aGlzLm1hcEZpZWxkVHlwZShcImV4cGlyYXRpb25EYXRlXCIpXTpbdGhpcy5jcmVhdGVSZXF1aXJlZEVycm9yKHRoaXMubWFwRmllbGRUeXBlKFwiZXhwaXJhdGlvbkRhdGVcIikpXSxbdGhpcy5tYXBGaWVsZFR5cGUoXCJudW1iZXJcIildOlt0aGlzLmNyZWF0ZVJlcXVpcmVkRXJyb3IodGhpcy5tYXBGaWVsZFR5cGUoXCJudW1iZXJcIikpXSxbdGhpcy5tYXBGaWVsZFR5cGUoXCJjYXJkaG9sZGVyTmFtZVwiKV06W3RoaXMuY3JlYXRlUmVxdWlyZWRFcnJvcih0aGlzLm1hcEZpZWxkVHlwZShcImNhcmRob2xkZXJOYW1lXCIpKV19fXJldHVybiBudWxsPT09KG49bnVsbD09PShpPWUuZGV0YWlscyl8fHZvaWQgMD09PWk/dm9pZCAwOmkuaW52YWxpZEZpZWxkS2V5cyl8fHZvaWQgMD09PW4/dm9pZCAwOm4ucmVkdWNlKChlLHQpPT57Y29uc3QgaT10aGlzLm1hcEZpZWxkVHlwZSh0KTtyZXR1cm4gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LGUpLHtbaV06W3RoaXMuY3JlYXRlSW52YWxpZEVycm9yKGkpXX0pfSx7fSl9Y3JlYXRlUmVxdWlyZWRFcnJvcihlKXt2YXIgdDtyZXR1cm57ZmllbGRUeXBlOmUsbWVzc2FnZTpudWxsIT09KHQ9e1tGLkNhcmRDb2RlXTpcIkNWViBpcyByZXF1aXJlZFwiLFtGLkNhcmRDb2RlVmVyaWZpY2F0aW9uXTpcIkNWViBpcyByZXF1aXJlZFwiLFtGLkNhcmROdW1iZXJdOlwiQ3JlZGl0IGNhcmQgbnVtYmVyIGlzIHJlcXVpcmVkXCIsW0YuQ2FyZE51bWJlclZlcmlmaWNhdGlvbl06XCJDcmVkaXQgY2FyZCBudW1iZXIgaXMgcmVxdWlyZWRcIixbRi5DYXJkRXhwaXJ5XTpcIkV4cGlyYXRpb24gZGF0ZSBpcyByZXF1aXJlZFwiLFtGLkNhcmROYW1lXTpcIkZ1bGwgbmFtZSBpcyByZXF1aXJlZFwifVtlXSkmJnZvaWQgMCE9PXQ/dDpcIkZpZWxkIGlzIHJlcXVpcmVkXCIsdHlwZTpcInJlcXVpcmVkXCJ9fWNyZWF0ZUludmFsaWRFcnJvcihlKXt2YXIgdCxpLG4scjtjb25zdCBvPXtbRi5DYXJkQ29kZV06e21lc3NhZ2U6XCJJbnZhbGlkIGNhcmQgY29kZVwiLHR5cGU6XCJpbnZhbGlkX2NhcmRfY29kZVwifSxbRi5DYXJkQ29kZVZlcmlmaWNhdGlvbl06e21lc3NhZ2U6XCJJbnZhbGlkIGNhcmQgY29kZVwiLHR5cGU6XCJpbnZhbGlkX2NhcmRfY29kZVwifSxbRi5DYXJkTnVtYmVyXTp7bWVzc2FnZTpcIkludmFsaWQgY2FyZCBudW1iZXJcIix0eXBlOlwiaW52YWxpZF9jYXJkX251bWJlclwifSxbRi5DYXJkTnVtYmVyVmVyaWZpY2F0aW9uXTp7bWVzc2FnZTpcIkludmFsaWQgY2FyZCBudW1iZXJcIix0eXBlOlwiaW52YWxpZF9jYXJkX251bWJlclwifSxbRi5DYXJkRXhwaXJ5XTp7bWVzc2FnZTpcIkludmFsaWQgY2FyZCBleHBpcnlcIix0eXBlOlwiaW52YWxpZF9jYXJkX2V4cGlyeVwifSxbRi5DYXJkTmFtZV06e21lc3NhZ2U6XCJJbnZhbGlkIGNhcmQgbmFtZVwiLHR5cGU6XCJpbnZhbGlkX2NhcmRfbmFtZVwifX07cmV0dXJue2ZpZWxkVHlwZTplLG1lc3NhZ2U6bnVsbCE9PShpPW51bGw9PT0odD1vW2VdKXx8dm9pZCAwPT09dD92b2lkIDA6dC5tZXNzYWdlKSYmdm9pZCAwIT09aT9pOlwiSW52YWxpZCBmaWVsZFwiLHR5cGU6bnVsbCE9PShyPW51bGw9PT0obj1vW2VdKXx8dm9pZCAwPT09bj92b2lkIDA6bi50eXBlKSYmdm9pZCAwIT09cj9yOlwiaW52YWxpZFwifX1pc1ZhbGlkRm9ybShlKXtyZXR1cm4gT2JqZWN0LmtleXMoZS5maWVsZHMpLmV2ZXJ5KHQ9Pnt2YXIgaTtyZXR1cm4gbnVsbD09PShpPWUuZmllbGRzW3RdKXx8dm9pZCAwPT09aT92b2lkIDA6aS5pc1ZhbGlkfSl9aXNWYWxpZFBhcmFtKGUpe3JldHVybltcIm51bWJlclwiLFwiY3Z2XCIsXCJleHBpcmF0aW9uRGF0ZVwiLFwicG9zdGFsQ29kZVwiLFwiY2FyZGhvbGRlck5hbWVcIixcImNhcmRUeXBlXCJdLmluY2x1ZGVzKGUpfX1jb25zdCB3dD0kKGU9Pntjb25zdCBpPXdpbmRvdyxuPW5ldyB2KGUpLHI9bmV3IHEodCgpLGksbiksbz1uZXcgaihyLGkpLGE9bmV3IGJ0KHIsbik7cmV0dXJuIG5ldyBtdChlLG8sYSl9LFt7aWQ6XCJicmFpbnRyZWVcIn1dKTt2YXIgQ3Q9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgU3R7Y29uc3RydWN0b3IoZSx0LGksbil7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5mb3JtUG9zdGVyPXQsdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2U9aSx0aGlzLmJyYWludHJlZUhvc3RXaW5kb3c9bn1pbml0aWFsaXplKGUpe3JldHVybiBDdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7YnJhaW50cmVlcGF5cGFsOnQsbWV0aG9kSWQ6aX09ZSx7Y29udGFpbmVyOm4sb25FcnJvcjpyfT10fHx7fTtpZighaSl0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdCl0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVwYXlwYWxcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIW4pdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVlcGF5cGFsLmNvbnRhaW5lclwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtsZXQgbyxhPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO3RyeXtpZihvPWEuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSksIW8uY2xpZW50VG9rZW4pdGhyb3cgbmV3IEcoSC5NaXNzaW5nUGF5bWVudFRva2VuKX1jYXRjaChlKXthPXlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKSxvPWEuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSl9Y29uc3R7Y2xpZW50VG9rZW46cyxjb25maWc6ZCxpbml0aWFsaXphdGlvbkRhdGE6bH09byx7cGF5bWVudEJ1dHRvblN0eWxlczpjfT1sfHx7fSx7Y2hlY2tvdXRUb3BCdXR0b25TdHlsZXM6dX09Y3x8e307aWYoIXN8fCFsKXRocm93IG5ldyBHKEguTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0IGg9e2N1cnJlbmN5OmEuZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlLGludGVudDpsLmludGVudCxpc0NyZWRpdEVuYWJsZWQ6bC5pc0NyZWRpdEVuYWJsZWQsY29tbWl0OiExfTt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKHMpLHlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheXBhbENoZWNrb3V0KGgsZT0+e3RoaXMucmVuZGVyUGF5UGFsQnV0dG9uKGUsdCxpLEJvb2xlYW4oZC50ZXN0TW9kZSksdSl9LGU9PnRoaXMuaGFuZGxlRXJyb3IoZSxuLHIpKX0pfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBDdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudGVhcmRvd24oKX0pfXNpZ25JbihlLHQpe3JldHVybiBDdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25JbkN1c3RvbWVyKGUsdCl9KX1zaWduT3V0KGUpe3JldHVybiBDdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25PdXRDdXN0b21lcihlKX0pfWV4ZWN1dGVQYXltZW50TWV0aG9kQ2hlY2tvdXQoZSl7dmFyIHQ7cmV0dXJuIG51bGw9PT0odD1udWxsPT1lP3ZvaWQgMDplLmNvbnRpbnVlV2l0aENoZWNrb3V0Q2FsbGJhY2spfHx2b2lkIDA9PT10fHx0LmNhbGwoZSksUHJvbWlzZS5yZXNvbHZlKCl9cmVuZGVyUGF5UGFsQnV0dG9uKGUsdCxpLG4scil7Y29uc3R7Y29udGFpbmVyOm8sb25DbGljazpzPWF9PXQse3BheXBhbDpkfT10aGlzLmJyYWludHJlZUhvc3RXaW5kb3csbD1udWxsPT1kP3ZvaWQgMDpkLkZVTkRJTkcuUEFZUEFMO2lmKGQmJmwpe2NvbnN0IGE9ZC5CdXR0b25zKHtlbnY6dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0QnJhaW50cmVlRW52KG4pLGZ1bmRpbmdTb3VyY2U6bCxzdHlsZTpPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30scikse2hlaWdodDo0MH0pLGNyZWF0ZU9yZGVyOigpPT50aGlzLnNldHVwUGF5bWVudChlLHQsaSksb25BcHByb3ZlOm49PnRoaXMudG9rZW5pemVQYXltZW50KG4sZSxpLHQpLG9uQ2xpY2s6c30pO2EuaXNFbGlnaWJsZSgpJiZhLnJlbmRlcihgIyR7b31gKX1lbHNlIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQobyl9c2V0dXBQYXltZW50KGUsdCxpKXt2YXIgbjtyZXR1cm4gQ3QodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZERlZmF1bHRDaGVja291dCgpO2NvbnN0IHQ9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkscj10LmdldENoZWNrb3V0T3JUaHJvdygpLm91dHN0YW5kaW5nQmFsYW5jZSxvPXQuZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlLGE9dC5nZXRDdXN0b21lcigpLHM9dC5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSxkPW51bGw9PWE/dm9pZCAwOmEuYWRkcmVzc2VzWzBdLGw9ZD90aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5tYXBUb0JyYWludHJlZVNoaXBwaW5nQWRkcmVzc092ZXJyaWRlKGQpOnZvaWQgMDtyZXR1cm4geWllbGQgZS5jcmVhdGVQYXltZW50KHtmbG93OlwiY2hlY2tvdXRcIixlbmFibGVTaGlwcGluZ0FkZHJlc3M6ITAsc2hpcHBpbmdBZGRyZXNzRWRpdGFibGU6ITEsc2hpcHBpbmdBZGRyZXNzT3ZlcnJpZGU6bCxhbW91bnQ6cixjdXJyZW5jeTpvLG9mZmVyQ3JlZGl0OiExLGludGVudDpudWxsPT09KG49cy5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT1uP3ZvaWQgMDpuLmludGVudH0pfWNhdGNoKGUpe2NvbnN0e2NvbnRhaW5lcjppLG9uRXJyb3I6bn09dDt0aGlzLmhhbmRsZUVycm9yKGUsaSxuKX19KX10b2tlbml6ZVBheW1lbnQoZSx0LGksbil7cmV0dXJuIEN0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt0cnl7Y29uc3R7ZGV2aWNlRGF0YTpufT15aWVsZCB0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5nZXREYXRhQ29sbGVjdG9yKHtwYXlwYWw6ITB9KSxyPXlpZWxkIHQudG9rZW5pemVQYXltZW50KGUpLHtkZXRhaWxzOm8sbm9uY2U6YX09cixzPXRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvTGVnYWN5QmlsbGluZ0FkZHJlc3MobyksZD10aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5tYXBUb0xlZ2FjeVNoaXBwaW5nQWRkcmVzcyhvKTtyZXR1cm4gdGhpcy5mb3JtUG9zdGVyLnBvc3RGb3JtKFwiL2NoZWNrb3V0LnBocFwiLHtwYXltZW50X3R5cGU6XCJwYXlwYWxcIixwcm92aWRlcjppLGFjdGlvbjpcInNldF9leHRlcm5hbF9jaGVja291dFwiLG5vbmNlOmEsZGV2aWNlX2RhdGE6bixiaWxsaW5nX2FkZHJlc3M6SlNPTi5zdHJpbmdpZnkocyksc2hpcHBpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeShkKX0pLHJ9Y2F0Y2goZSl7Y29uc3R7Y29udGFpbmVyOnQsb25FcnJvcjppfT1uO3RoaXMuaGFuZGxlRXJyb3IoZSx0LGkpfX0pfWhhbmRsZUVycm9yKGUsdCxpKXtpZih0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5yZW1vdmVFbGVtZW50KHQpLCFpfHwhTChlKSl0aHJvdyBlO2koZSl9fWNvbnN0IFB0PSQoaT0+e2NvbnN0IG49d2luZG93LHI9bmV3IHYoaSksbz1uZXcgaihuZXcgcSh0KCksbixyKSxuKTtyZXR1cm4gbmV3IFN0KGksZSgpLG8sbil9LFt7aWQ6XCJicmFpbnRyZWVwYXlwYWxcIn1dKTt2YXIgSXQ9ZnVuY3Rpb24oZSx0LGksbil7cmV0dXJuIG5ldyhpfHwoaT1Qcm9taXNlKSkoZnVuY3Rpb24ocixvKXtmdW5jdGlvbiBhKGUpe3RyeXtkKG4ubmV4dChlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gcyhlKXt0cnl7ZChuLnRocm93KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBkKGUpe3ZhciB0O2UuZG9uZT9yKGUudmFsdWUpOih0PWUudmFsdWUsdCBpbnN0YW5jZW9mIGk/dDpuZXcgaShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4oYSxzKX1kKChuPW4uYXBwbHkoZSx0fHxbXSkpLm5leHQoKSl9KX07Y2xhc3MgT3R7Y29uc3RydWN0b3IoZSx0LGksbil7dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlPWUsdGhpcy5mb3JtUG9zdGVyPXQsdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2U9aSx0aGlzLmJyYWludHJlZUhvc3RXaW5kb3c9bn1pbml0aWFsaXplKGUpe3JldHVybiBJdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3R7YnJhaW50cmVlcGF5cGFsY3JlZGl0OnQsbWV0aG9kSWQ6aX09ZSx7Y29udGFpbmVyOm4sb25FcnJvcjpyfT10fHx7fTtpZighaSl0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5tZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdCl0aHJvdyBuZXcgdygnVW5hYmxlIHRvIGluaXRpYWxpemUgcGF5bWVudCBiZWNhdXNlIFwib3B0aW9ucy5icmFpbnRyZWVwYXlwYWxjcmVkaXRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7aWYoIW4pdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBpbml0aWFsaXplIHBheW1lbnQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVlcGF5cGFsY3JlZGl0LmNvbnRhaW5lclwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtsZXQgbyxhPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpO3RyeXtpZihvPWEuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSksIW8uY2xpZW50VG9rZW4pdGhyb3cgbmV3IEcoSC5NaXNzaW5nUGF5bWVudFRva2VuKX1jYXRjaChlKXthPXlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKSxvPWEuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3coaSl9Y29uc3R7Y2xpZW50VG9rZW46cyxjb25maWc6ZCxpbml0aWFsaXphdGlvbkRhdGE6bH09byx7cGF5bWVudEJ1dHRvblN0eWxlczpjfT1sfHx7fSx7Y2hlY2tvdXRUb3BCdXR0b25TdHlsZXM6dX09Y3x8e307aWYoIXN8fCFsKXRocm93IG5ldyBHKEguTWlzc2luZ1BheW1lbnRNZXRob2QpO2NvbnN0IGg9e2N1cnJlbmN5OmEuZ2V0Q2FydE9yVGhyb3coKS5jdXJyZW5jeS5jb2RlLGludGVudDpsLmludGVudCxpc0NyZWRpdEVuYWJsZWQ6bC5pc0NyZWRpdEVuYWJsZWQsY29tbWl0OiExfTt0aGlzLmJyYWludHJlZUludGVncmF0aW9uU2VydmljZS5pbml0aWFsaXplKHMpLHlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldFBheXBhbENoZWNrb3V0KGgsZT0+e3RoaXMucmVuZGVyUGF5UGFsQnV0dG9uKGUsdCxpLEJvb2xlYW4oZC50ZXN0TW9kZSksT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LHUpLHtoZWlnaHQ6NDB9KSl9LGU9PnRoaXMuaGFuZGxlRXJyb3IoZSxuLHIpKX0pfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBJdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UudGVhcmRvd24oKX0pfXNpZ25JbihlLHQpe3JldHVybiBJdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25JbkN1c3RvbWVyKGUsdCl9KX1zaWduT3V0KGUpe3JldHVybiBJdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25PdXRDdXN0b21lcihlKX0pfWV4ZWN1dGVQYXltZW50TWV0aG9kQ2hlY2tvdXQoZSl7dmFyIHQ7cmV0dXJuIG51bGw9PT0odD1udWxsPT1lP3ZvaWQgMDplLmNvbnRpbnVlV2l0aENoZWNrb3V0Q2FsbGJhY2spfHx2b2lkIDA9PT10fHx0LmNhbGwoZSksUHJvbWlzZS5yZXNvbHZlKCl9cmVuZGVyUGF5UGFsQnV0dG9uKGUsdCxpLG4scil7Y29uc3R7Y29udGFpbmVyOm8sb25DbGljazpzPWF9PXQse3BheXBhbDpkfT10aGlzLmJyYWludHJlZUhvc3RXaW5kb3c7bGV0IGw9ITE7ZCYmW2QuRlVORElORy5QQVlMQVRFUixkLkZVTkRJTkcuQ1JFRElUXS5mb3JFYWNoKGE9PntpZighbCl7Y29uc3QgYz1kLkJ1dHRvbnMoe2VudjpuP1wic2FuZGJveFwiOlwicHJvZHVjdGlvblwiLGZ1bmRpbmdTb3VyY2U6YSxzdHlsZTpyLGNyZWF0ZU9yZGVyOigpPT50aGlzLnNldHVwUGF5bWVudChlLHQsaSksb25BcHByb3ZlOm49PnRoaXMudG9rZW5pemVQYXltZW50KG4sZSxpLHQpLG9uQ2xpY2s6c30pO2MuaXNFbGlnaWJsZSgpJiYoYy5yZW5kZXIoYCMke299YCksbD0hMCl9fSksZCYmbHx8dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UucmVtb3ZlRWxlbWVudChvKX1zZXR1cFBheW1lbnQoZSx0LGkpe3ZhciBuO3JldHVybiBJdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7dHJ5e3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkRGVmYXVsdENoZWNrb3V0KCk7Y29uc3QgdD10aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UuZ2V0U3RhdGUoKSxyPXQuZ2V0Q2hlY2tvdXRPclRocm93KCkub3V0c3RhbmRpbmdCYWxhbmNlLG89dC5nZXRDYXJ0T3JUaHJvdygpLmN1cnJlbmN5LmNvZGUsYT10LmdldEN1c3RvbWVyKCkscz10LmdldFBheW1lbnRNZXRob2RPclRocm93KGkpLGQ9bnVsbD09YT92b2lkIDA6YS5hZGRyZXNzZXNbMF0sbD1kP3RoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvQnJhaW50cmVlU2hpcHBpbmdBZGRyZXNzT3ZlcnJpZGUoZCk6dm9pZCAwO3JldHVybiB5aWVsZCBlLmNyZWF0ZVBheW1lbnQoe2Zsb3c6XCJjaGVja291dFwiLGVuYWJsZVNoaXBwaW5nQWRkcmVzczohMCxzaGlwcGluZ0FkZHJlc3NFZGl0YWJsZTohMSxzaGlwcGluZ0FkZHJlc3NPdmVycmlkZTpsLGFtb3VudDpyLGN1cnJlbmN5Om8sb2ZmZXJDcmVkaXQ6ITAsaW50ZW50Om51bGw9PT0obj1zLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PW4/dm9pZCAwOm4uaW50ZW50fSl9Y2F0Y2goZSl7Y29uc3R7Y29udGFpbmVyOmksb25FcnJvcjpufT10O3RoaXMuaGFuZGxlRXJyb3IoZSxpLG4pfX0pfXRva2VuaXplUGF5bWVudChlLHQsaSxuKXtyZXR1cm4gSXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3RyeXtjb25zdHtkZXZpY2VEYXRhOm59PXlpZWxkIHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLmdldERhdGFDb2xsZWN0b3Ioe3BheXBhbDohMH0pLHI9eWllbGQgdC50b2tlbml6ZVBheW1lbnQoZSkse2RldGFpbHM6byxub25jZTphfT1yLHM9dGhpcy5icmFpbnRyZWVJbnRlZ3JhdGlvblNlcnZpY2UubWFwVG9MZWdhY3lCaWxsaW5nQWRkcmVzcyhvKSxkPXRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLm1hcFRvTGVnYWN5U2hpcHBpbmdBZGRyZXNzKG8pO3JldHVybiB0aGlzLmZvcm1Qb3N0ZXIucG9zdEZvcm0oXCIvY2hlY2tvdXQucGhwXCIse3BheW1lbnRfdHlwZTpcInBheXBhbFwiLHByb3ZpZGVyOmksYWN0aW9uOlwic2V0X2V4dGVybmFsX2NoZWNrb3V0XCIsbm9uY2U6YSxkZXZpY2VfZGF0YTpuLGJpbGxpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeShzKSxzaGlwcGluZ19hZGRyZXNzOkpTT04uc3RyaW5naWZ5KGQpfSkscn1jYXRjaChlKXtjb25zdHtjb250YWluZXI6dCxvbkVycm9yOml9PW47dGhpcy5oYW5kbGVFcnJvcihlLHQsaSl9fSl9aGFuZGxlRXJyb3IoZSx0LGkpe2lmKHRoaXMuYnJhaW50cmVlSW50ZWdyYXRpb25TZXJ2aWNlLnJlbW92ZUVsZW1lbnQodCksIWl8fCFMKGUpKXRocm93IGU7aShlKX19Y29uc3Qga3Q9JChpPT57Y29uc3Qgbj13aW5kb3cscj1uZXcgdihpKSxvPW5ldyBqKG5ldyBxKHQoKSxuLHIpLG4pO3JldHVybiBuZXcgT3QoaSxlKCksbyxuKX0sW3tpZDpcImJyYWludHJlZXBheXBhbGNyZWRpdFwifV0pO3ZhciBFdD1mdW5jdGlvbihlLHQsaSxuKXtyZXR1cm4gbmV3KGl8fChpPVByb21pc2UpKShmdW5jdGlvbihyLG8pe2Z1bmN0aW9uIGEoZSl7dHJ5e2Qobi5uZXh0KGUpKX1jYXRjaChlKXtvKGUpfX1mdW5jdGlvbiBzKGUpe3RyeXtkKG4udGhyb3coZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIGQoZSl7dmFyIHQ7ZS5kb25lP3IoZS52YWx1ZSk6KHQ9ZS52YWx1ZSx0IGluc3RhbmNlb2YgaT90Om5ldyBpKGZ1bmN0aW9uKGUpe2UodCl9KSkudGhlbihhLHMpfWQoKG49bi5hcHBseShlLHR8fFtdKSkubmV4dCgpKX0pfTtjbGFzcyBUdHtjb25zdHJ1Y3RvcihlLHQpe3RoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZT1lLHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscz10LHRoaXMuaXNBY2NlbGVyYXRlZENoZWNrb3V0RW5hYmxlZD0hMX1pbml0aWFsaXplKHttZXRob2RJZDplLGJyYWludHJlZWZhc3RsYW5lOnR9KXt2YXIgaTtyZXR1cm4gRXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2lmKCFlKXRocm93IG5ldyB3KCdVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIFwibWV0aG9kSWRcIiBhcmd1bWVudCBpcyBub3QgcHJvdmlkZWQuJyk7Y29uc3Qgbj15aWVsZCB0aGlzLmdldFZhbGlkUGF5bWVudE1ldGhvZE9yVGhyb3coZSkse2lzQWNjZWxlcmF0ZWRDaGVja291dEVuYWJsZWQ6cixpc0Zhc3RsYW5lU3R5bGluZ0VuYWJsZWQ6b309bi5pbml0aWFsaXphdGlvbkRhdGF8fHt9LGE9bz9udWxsPT09KGk9bi5pbml0aWFsaXphdGlvbkRhdGEpfHx2b2lkIDA9PT1pP3ZvaWQgMDppLmZhc3RsYW5lU3R5bGVzOnZvaWQgMDt0aGlzLmlzQWNjZWxlcmF0ZWRDaGVja291dEVuYWJsZWQ9ISFyO3RyeXtpZih0aGlzLmlzQWNjZWxlcmF0ZWRDaGVja291dEVuYWJsZWQpe2NvbnN0IGU9UWUoYSxudWxsPT10P3ZvaWQgMDp0LnN0eWxlcyk7eWllbGQgdGhpcy5icmFpbnRyZWVGYXN0bGFuZVV0aWxzLmluaXRpYWxpemVCcmFpbnRyZWVGYXN0bGFuZU9yVGhyb3cobi5pZCxlKX19Y2F0Y2goZSl7fXJldHVybiBQcm9taXNlLnJlc29sdmUoKX0pfWRlaW5pdGlhbGl6ZSgpe3JldHVybiBFdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7cmV0dXJuIFByb21pc2UucmVzb2x2ZSgpfSl9c2lnbkluKGUsdCl7cmV0dXJuIEV0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbkluQ3VzdG9tZXIoZSx0KX0pfXNpZ25PdXQoZSl7cmV0dXJuIEV0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2Uuc2lnbk91dEN1c3RvbWVyKGUpfSl9ZXhlY3V0ZVBheW1lbnRNZXRob2RDaGVja291dChlKXtyZXR1cm4gRXQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2NoZWNrb3V0UGF5bWVudE1ldGhvZEV4ZWN1dGVkOnQsY29udGludWVXaXRoQ2hlY2tvdXRDYWxsYmFjazppfT1lfHx7fTtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiBpKXRocm93IG5ldyB3KCdVbmFibGUgdG8gcHJvY2VlZCBiZWNhdXNlIFwiY29udGludWVXaXRoQ2hlY2tvdXRDYWxsYmFja1wiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZCBhbmQgaXQgbXVzdCBiZSBhIGZ1bmN0aW9uLicpO2NvbnN0IG49dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0Q3VzdG9tZXJPclRocm93KCk7aWYodGhpcy5pc0FjY2VsZXJhdGVkQ2hlY2tvdXRFbmFibGVkJiZuLmlzR3Vlc3Qpe2NvbnN0IGU9eWllbGQgdGhpcy5zaG91bGRSdW5BdXRoZW50aWNhdGlvbkZsb3coKTt0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiB0JiZ0KCksZSYmKHlpZWxkIHRoaXMuYnJhaW50cmVlRmFzdGxhbmVVdGlscy5ydW5QYXlQYWxBdXRoZW50aWNhdGlvbkZsb3dPclRocm93KHZvaWQgMCwhMCkpfWkoKX0pfXNob3VsZFJ1bkF1dGhlbnRpY2F0aW9uRmxvdygpe3ZhciBlO3JldHVybiBFdCh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24qKCl7Y29uc3QgdD1cImJyYWludHJlZWFjY2VsZXJhdGVkY2hlY2tvdXRcIjt0cnl7eWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmxvYWRQYXltZW50TWV0aG9kKHQpO2NvbnN0IGk9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCk7cmV0dXJuKG51bGw9PT0oZT1pLmluaXRpYWxpemF0aW9uRGF0YSl8fHZvaWQgMD09PWU/dm9pZCAwOmUuc2hvdWxkUnVuQWNjZWxlcmF0ZWRDaGVja291dCl8fCExfWNhdGNoKGUpe3JldHVybiExfX0pfWdldFZhbGlkUGF5bWVudE1ldGhvZE9yVGhyb3coZSl7cmV0dXJuIEV0KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtsZXQgdD1lO3RyeXt5aWVsZCB0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZFBheW1lbnRNZXRob2QodCl9Y2F0Y2goaSl7dD1cImJyYWludHJlZVwiPT09ZT9cImJyYWludHJlZWFjY2VsZXJhdGVkY2hlY2tvdXRcIjpcImJyYWludHJlZVwiLHlpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZCh0KX1yZXR1cm4gdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCkuZ2V0UGF5bWVudE1ldGhvZE9yVGhyb3codCl9KX19Y29uc3QgQXQ9JChlPT57Y29uc3QgaT13aW5kb3csbj1uZXcgdihlKSxyPW5ldyBqKG5ldyBxKHQoKSxpLG4pLGkpLG89bmV3IG90KGUscik7cmV0dXJuIG5ldyBUdChlLG8pfSxbe2lkOlwiYnJhaW50cmVlYWNjZWxlcmF0ZWRjaGVja291dFwifSx7aWQ6XCJicmFpbnRyZWVcIn1dKTtjbGFzcyB6dCBleHRlbmRzIGZ7Y29uc3RydWN0b3IoZSl7c3VwZXIoZXx8XCJOb3QgaW1wbGVtZW50ZWQuXCIpLHRoaXMubmFtZT1cIk5vdEltcGxlbWVudGVkRXJyb3JcIix0aGlzLnR5cGU9XCJub3RfaW1wbGVtZW50ZWRcIn19dmFyIE50PWZ1bmN0aW9uKGUsdCxpLG4pe3JldHVybiBuZXcoaXx8KGk9UHJvbWlzZSkpKGZ1bmN0aW9uKHIsbyl7ZnVuY3Rpb24gYShlKXt0cnl7ZChuLm5leHQoZSkpfWNhdGNoKGUpe28oZSl9fWZ1bmN0aW9uIHMoZSl7dHJ5e2Qobi50aHJvdyhlKSl9Y2F0Y2goZSl7byhlKX19ZnVuY3Rpb24gZChlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKToodD1lLnZhbHVlLHQgaW5zdGFuY2VvZiBpP3Q6bmV3IGkoZnVuY3Rpb24oZSl7ZSh0KX0pKS50aGVuKGEscyl9ZCgobj1uLmFwcGx5KGUsdHx8W10pKS5uZXh0KCkpfSl9O2NsYXNzIER0e2NvbnN0cnVjdG9yKGUsdCxpKXt0aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2U9ZSx0aGlzLmZvcm1Qb3N0ZXI9dCx0aGlzLmJyYWludHJlZVNkaz1pLHRoaXMuYnV0dG9uQ2xhc3NOYW1lPVwidmlzYS1jaGVja291dC13cmFwcGVyXCIsdGhpcy5vbkVycm9yPWF9aW5pdGlhbGl6ZShlKXtyZXR1cm4gTnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe2NvbnN0e2JyYWludHJlZXZpc2FjaGVja291dDp0LG1ldGhvZElkOml9PWU7aWYoIWkpdGhyb3cgbmV3IHcoJ1VuYWJsZSB0byBwcm9jZWVkIGJlY2F1c2UgXCJtZXRob2RJZFwiIGFyZ3VtZW50IGlzIG5vdCBwcm92aWRlZC4nKTtpZighdCl0aHJvdyBuZXcgdygnVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSBcIm9wdGlvbnMuYnJhaW50cmVldmlzYWNoZWNrb3V0XCIgYXJndW1lbnQgaXMgbm90IHByb3ZpZGVkLicpO3lpZWxkIHRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5sb2FkUGF5bWVudE1ldGhvZChpKTtjb25zdCBuPXRoaXMucGF5bWVudEludGVncmF0aW9uU2VydmljZS5nZXRTdGF0ZSgpLHI9bi5nZXRDaGVja291dE9yVGhyb3coKSx7Y2xpZW50VG9rZW46byxjb25maWc6c309bi5nZXRQYXltZW50TWV0aG9kT3JUaHJvdyhpKSxkPW4uZ2V0U3RvcmVDb25maWdPclRocm93KCk7aWYoIW8pdGhyb3cgbmV3IEcoSC5NaXNzaW5nUGF5bWVudE1ldGhvZCk7dGhpcy5icmFpbnRyZWVTZGsuaW5pdGlhbGl6ZShvKTtjb25zdCBsPXlpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmdldEJyYWludHJlZVZpc2FDaGVja291dCgpLGM9eWllbGQgdGhpcy5icmFpbnRyZWVTZGsuZ2V0VmlzYUNoZWNrb3V0U2RrKHMudGVzdE1vZGUpLHtjb250YWluZXI6dSxvbkVycm9yOmh9PXQ7dGhpcy5vbkVycm9yPWh8fGE7Y29uc3QgeT1sLmNyZWF0ZUluaXRPcHRpb25zKHtwYXltZW50UmVxdWVzdDp7Y3VycmVuY3lDb2RlOmQuY3VycmVuY3kuY29kZSxzdWJ0b3RhbDpTdHJpbmcoci5zdWJ0b3RhbCl9LHNldHRpbmdzOntsb2NhbGU6ZC5zdG9yZVByb2ZpbGUuc3RvcmVMYW5ndWFnZSxzaGlwcGluZzp7Y29sbGVjdFNoaXBwaW5nOiEwfX19KSxtPXRoaXMuY3JlYXRlU2lnbkluQnV0dG9uKHUsdGhpcy5idXR0b25DbGFzc05hbWUpO3lpZWxkIGMuaW5pdCh5KSxjLm9uKFwicGF5bWVudC5zdWNjZXNzXCIsZT0+dGhpcy50b2tlbml6ZVBheW1lbnQobCxlKS50aGVuKCgpPT50aGlzLnBheW1lbnRJbnRlZ3JhdGlvblNlcnZpY2UubG9hZENoZWNrb3V0KCkpLmNhdGNoKGU9PnRoaXMuaGFuZGxlRXJyb3IoZSkpKSxjLm9uKFwicGF5bWVudC5lcnJvclwiLChlLHQpPT50aGlzLmhhbmRsZUVycm9yKHQpKSxtLnN0eWxlLnZpc2liaWxpdHk9XCJ2aXNpYmxlXCJ9KX1kZWluaXRpYWxpemUoKXtyZXR1cm4gTnQodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKigpe3lpZWxkIHRoaXMuYnJhaW50cmVlU2RrLmRlaW5pdGlhbGl6ZSgpfSl9c2lnbkluKCl7dGhyb3cgbmV3IHp0KCdJbiBvcmRlciB0byBzaWduIGluIHZpYSBWaXNhQ2hlY2tvdXQsIHRoZSBzaG9wcGVyIG11c3QgY2xpY2sgb24gXCJWaXNhIENoZWNrb3V0XCIgYnV0dG9uLicpfXNpZ25PdXQoZSl7cmV0dXJuIE50KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4geWllbGQgdGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLnNpZ25PdXRDdXN0b21lcihlKSxQcm9taXNlLnJlc29sdmUoKX0pfWV4ZWN1dGVQYXltZW50TWV0aG9kQ2hlY2tvdXQoZSl7dmFyIHQ7cmV0dXJuIG51bGw9PT0odD1udWxsPT1lP3ZvaWQgMDplLmNvbnRpbnVlV2l0aENoZWNrb3V0Q2FsbGJhY2spfHx2b2lkIDA9PT10fHx0LmNhbGwoZSksUHJvbWlzZS5yZXNvbHZlKCl9dG9rZW5pemVQYXltZW50KGUsdCl7cmV0dXJuIE50KHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbiooKXtyZXR1cm4gUHJvbWlzZS5hbGwoW2UudG9rZW5pemUodCksdGhpcy5icmFpbnRyZWVTZGsuZ2V0RGF0YUNvbGxlY3Rvck9yVGhyb3coKV0pLnRoZW4oKFtlLHRdKT0+e2NvbnN0IGk9dGhpcy5wYXltZW50SW50ZWdyYXRpb25TZXJ2aWNlLmdldFN0YXRlKCksbj1pLmdldFNoaXBwaW5nQWRkcmVzcygpLHI9aS5nZXRCaWxsaW5nQWRkcmVzcygpLHtzaGlwcGluZ0FkZHJlc3M6bz10aGlzLm1hcFRvVmlzYUNoZWNrb3V0QWRkcmVzcyhuKSxiaWxsaW5nQWRkcmVzczphPXRoaXMubWFwVG9WaXNhQ2hlY2tvdXRBZGRyZXNzKHIpfT1lO3JldHVybiB0aGlzLnBvc3RGb3JtKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSxlKSx7c2hpcHBpbmdBZGRyZXNzOm8sYmlsbGluZ0FkZHJlc3M6YX0pLHQpfSl9KX1wb3N0Rm9ybShlLHQpe2NvbnN0e3VzZXJEYXRhOmksYmlsbGluZ0FkZHJlc3M6bixzaGlwcGluZ0FkZHJlc3M6cixkZXRhaWxzOm99PWUse3VzZXJFbWFpbDphfT1pLHtkZXZpY2VEYXRhOnN9PXQ7cmV0dXJuIHRoaXMuZm9ybVBvc3Rlci5wb3N0Rm9ybShcIi9jaGVja291dC5waHBcIix7cGF5bWVudF90eXBlOmUudHlwZSxub25jZTplLm5vbmNlLHByb3ZpZGVyOlwiYnJhaW50cmVldmlzYWNoZWNrb3V0XCIsYWN0aW9uOlwic2V0X2V4dGVybmFsX2NoZWNrb3V0XCIsZGV2aWNlX2RhdGE6cyxjYXJkX2luZm9ybWF0aW9uOkpTT04uc3RyaW5naWZ5KHt0eXBlOm8uY2FyZFR5cGUsbnVtYmVyOm8ubGFzdFR3b30pLGJpbGxpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeSh0aGlzLmdldEFkZHJlc3MoYSxuKSksc2hpcHBpbmdfYWRkcmVzczpKU09OLnN0cmluZ2lmeSh0aGlzLmdldEFkZHJlc3MoYSxyKSl9KX1tYXBUb1Zpc2FDaGVja291dEFkZHJlc3MoZSl7cmV0dXJuIGU/e2ZpcnN0TmFtZTplLmZpcnN0TmFtZSxsYXN0TmFtZTplLmxhc3ROYW1lLHBob25lTnVtYmVyOmUucGhvbmUsc3RyZWV0QWRkcmVzczplLmFkZHJlc3MxLGV4dGVuZGVkQWRkcmVzczplLmFkZHJlc3MyLGxvY2FsaXR5OmUuY2l0eSxyZWdpb246ZS5zdGF0ZU9yUHJvdmluY2VDb2RlLGNvdW50cnlDb2RlOmUuY291bnRyeUNvZGUscG9zdGFsQ29kZTplLnBvc3RhbENvZGV9Ont9fWdldEFkZHJlc3MoZSx0PXt9KXtyZXR1cm57ZW1haWw6ZSxmaXJzdF9uYW1lOnQuZmlyc3ROYW1lLGxhc3RfbmFtZTp0Lmxhc3ROYW1lLHBob25lX251bWJlcjp0LnBob25lTnVtYmVyLGFkZHJlc3NfbGluZV8xOnQuc3RyZWV0QWRkcmVzcyxhZGRyZXNzX2xpbmVfMjp0LmV4dGVuZGVkQWRkcmVzcyxjaXR5OnQubG9jYWxpdHksc3RhdGU6dC5yZWdpb24sY291bnRyeV9jb2RlOnQuY291bnRyeUNvZGUscG9zdGFsX2NvZGU6dC5wb3N0YWxDb2RlfX1jcmVhdGVTaWduSW5CdXR0b24oZSx0KXtjb25zdCBpPWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2V9YCk7aWYoIWkpdGhyb3cgbmV3IEVycm9yKFwiVW5hYmxlIHRvIHByb2NlZWQgYmVjYXVzZSB0aGUgcHJvdmlkZWQgY29udGFpbmVyIElEIGlzIG5vdCB2YWxpZC5cIik7cmV0dXJuIHRoaXMuaW5zZXJ0VmlzYUNoZWNrb3V0QnV0dG9uKGksdCl9aW5zZXJ0VmlzYUNoZWNrb3V0QnV0dG9uKGUsdCl7Y29uc3QgaT1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3JldHVybiBpLnN0eWxlLmRpc3BsYXk9XCJmbGV4XCIsaS5zdHlsZS5mbGV4RGlyZWN0aW9uPVwiY29sdW1uXCIsaS5zdHlsZS52aXNpYmlsaXR5PVwiaGlkZGVuXCIsaS5zdHlsZS53aWR0aD1cIm1heC1jb250ZW50XCIsaS5jbGFzc05hbWU9dCxpLmlubmVySFRNTD0nXFxuICAgICAgICAgICAgPGltZ1xcbiAgICAgICAgICAgICAgICBhbHQ9XCJWaXNhIENoZWNrb3V0XCJcXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJ2LWJ1dHRvblwiXFxuICAgICAgICAgICAgICAgIHJvbGU9XCJidXR0b25cIlxcbiAgICAgICAgICAgICAgICBzcmM9XCJodHRwczovL3NlY3VyZS5jaGVja291dC52aXNhLmNvbS93YWxsZXQtc2VydmljZXMtd2ViL3hvL2J1dHRvbi5wbmc/YWNjZXB0Q2FuYWRpYW5WaXNhRGViaXQ9ZmFsc2UmY29icmFuZD10cnVlJmhlaWdodD0zNCZ3aWR0aD0xNzhcIlxcbiAgICAgICAgICAgICAgICAvPlxcbiAgICAgICAgICAgIDxhIGNsYXNzPVwidi1sZWFybiB2LWxlYXJuLWRlZmF1bHRcIiBzdHlsZT1cInRleHQtYWxpZ246IHJpZ2h0OyBkaXNwbGF5OiBibG9jazsgZm9udC1zaXplOiAxMHB4OyBjb2xvcjogIzAwMzM2NjtcIiBocmVmPVwiI1wiIGRhdGEtbG9jYWxlPVwiZW5fVVNcIj5UZWxsIE1lIE1vcmU8L2E+JyxlLmFwcGVuZENoaWxkKGkpLGl9aGFuZGxlRXJyb3IoZSl7aWYoXCJmdW5jdGlvblwiIT10eXBlb2YgdGhpcy5vbkVycm9yKXRocm93IGU7dGhpcy5vbkVycm9yKGUpfX1jb25zdCBNdD0kKGk9Pntjb25zdCBuPXdpbmRvdyxyPW5ldyB2KGkpLG89bmV3IHllKG5ldyBxKHQoKSxuLHIpKTtyZXR1cm4gbmV3IER0KGksZSgpLG8pfSxbe2lkOlwiYnJhaW50cmVldmlzYWNoZWNrb3V0XCJ9XSk7ZXhwb3J0e05lIGFzIGNyZWF0ZUJyYWludHJlZUFjaFBheW1lbnRTdHJhdGVneSx3dCBhcyBjcmVhdGVCcmFpbnRyZWVDcmVkaXRDYXJkUGF5bWVudFN0cmF0ZWd5LEF0IGFzIGNyZWF0ZUJyYWludHJlZUZhc3RsYW5lQ3VzdG9tZXJTdHJhdGVneSxhdCBhcyBjcmVhdGVCcmFpbnRyZWVGYXN0bGFuZVBheW1lbnRTdHJhdGVneSxLZSBhcyBjcmVhdGVCcmFpbnRyZWVMb2NhbE1ldGhvZHNQYXltZW50U3RyYXRlZ3ksZWUgYXMgY3JlYXRlQnJhaW50cmVlUGF5cGFsQnV0dG9uU3RyYXRlZ3kscmUgYXMgY3JlYXRlQnJhaW50cmVlUGF5cGFsQ3JlZGl0QnV0dG9uU3RyYXRlZ3ksa3QgYXMgY3JlYXRlQnJhaW50cmVlUGF5cGFsQ3JlZGl0Q3VzdG9tZXJTdHJhdGVneSxQdCBhcyBjcmVhdGVCcmFpbnRyZWVQYXlwYWxDdXN0b21lclN0cmF0ZWd5LFZlIGFzIGNyZWF0ZUJyYWludHJlZVBheXBhbFBheW1lbnRTdHJhdGVneSxQZSBhcyBjcmVhdGVCcmFpbnRyZWVWZW5tb0J1dHRvblN0cmF0ZWd5LGh0IGFzIGNyZWF0ZUJyYWludHJlZVZlbm1vUGF5bWVudFN0cmF0ZWd5LGdlIGFzIGNyZWF0ZUJyYWludHJlZVZpc2FDaGVja291dEJ1dHRvblN0cmF0ZWd5LE10IGFzIGNyZWF0ZUJyYWludHJlZVZpc2FDaGVja291dEN1c3RvbWVyU3RyYXRlZ3ksbHQgYXMgY3JlYXRlQnJhaW50cmVlVmlzYUNoZWNrb3V0UGF5bWVudFN0cmF0ZWd5fTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJyYWludHJlZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///../checkout-sdk-js/dist/esm/integrations/braintree.js\n\n}");

/***/ })

}]);